cscope 15 $HOME/repos/legacy -q 0000005939 0002270651
	@src/.cproject

1 <?
xml
 
	gv”siÚ
="1.0" 
’codšg
="UTF-8" 
¡ªd®Úe
="no"?>

2 <?
feV”siÚ
 4.0.0?><
ırojeù
 
¡Üage_ty³_id
="org.eclipse.cdt.core.XmlProjectDescriptionStorage">

3 <
¡ÜageModuË
 
moduËId
="org.eclipse.cdt.core.settings">

4 <
ccÚfigu¿tiÚ
 
id
="0.1381401351">

5 <
¡ÜageModuË
 
budSy¡emId
="Üg.eş£.cdt.mªagedbud”.cÜe.cÚfigu¿tiÚD©aProvid”" 
id
="0.1381401351" 
moduËId
="Üg.eş£.cdt.cÜe.£‰šgs" 
Çme
="Default">

6 <
ex‹º®S‘tšgs
/>

7 <
ex‹nsiÚs
>

8 <
ex‹nsiÚ
 
id
="Üg.eş£.cdt.cÜe.GASE¼ÜP¬£r" 
pošt
="org.eclipse.cdt.core.ErrorParser"/>

9 <
ex‹nsiÚ
 
id
="Üg.eş£.cdt.cÜe.GmakeE¼ÜP¬£r" 
pošt
="org.eclipse.cdt.core.ErrorParser"/>

10 <
ex‹nsiÚ
 
id
="Üg.eş£.cdt.cÜe.GLDE¼ÜP¬£r" 
pošt
="org.eclipse.cdt.core.ErrorParser"/>

11 <
ex‹nsiÚ
 
id
="Üg.eş£.cdt.cÜe.VCE¼ÜP¬£r" 
pošt
="org.eclipse.cdt.core.ErrorParser"/>

12 <
ex‹nsiÚ
 
id
="Üg.eş£.cdt.cÜe.CWDLoÿtÜ" 
pošt
="org.eclipse.cdt.core.ErrorParser"/>

13 <
ex‹nsiÚ
 
id
="Üg.eş£.cdt.cÜe.GCCE¼ÜP¬£r" 
pošt
="org.eclipse.cdt.core.ErrorParser"/>

14 </
ex‹nsiÚs
>

15 </
¡ÜageModuË
>

16 <
¡ÜageModuË
 
moduËId
="cdtBudSy¡em" 
v”siÚ
="4.0.0">

17 <
cÚfigu¿tiÚ
 
¬tiçùName
="${ProjName}" 
budPrİ”t›s
="" 
desütiÚ
="" 
id
="0.1381401351" 
Çme
="DeçuÉ" 
·»Á
="org.eclipse.cdt.build.core.prefbase.cfg">

18 <
fŞd”Info
 
id
="0.1381401351." 
Çme
="/" 
»sourûP©h
="">

19 <
toŞChaš
 
id
="Üg.eş£.cdt.bud.cÜe.´efba£.toŞchaš.1775528936" 
Çme
="NØToŞChaš" 
»sourûTy³Ba£dDiscov”y
="çl£" 
su³rCÏss
="org.eclipse.cdt.build.core.prefbase.toolchain">

20 <
rg‘PÏtfÜm
 
id
="Üg.eş£.cdt.bud.cÜe.´efba£.toŞchaš.1775528936.1338182607" 
Çme
=""/>

21 <
bud”
 
id
="Üg.eş£.cdt.bud.cÜe.£‰šgs.deçuÉ.bud”.2037348579" 
k“pEnvœÚm’tInBudfe
="çl£" 
mªagedBudOn
="çl£" 
Çme
="Gnu MakBud”" 
su³rCÏss
="org.eclipse.cdt.build.core.settings.default.builder"/>

22 <
toŞ
 
id
="Üg.eş£.cdt.bud.cÜe.£‰šgs.hŞd”.libs.1494908066" 
Çme
="hŞd” fÜ†ib¿ry s‘tšgs" 
su³rCÏss
="org.eclipse.cdt.build.core.settings.holder.libs"/>

23 <
toŞ
 
id
="Üg.eş£.cdt.bud.cÜe.£‰šgs.hŞd”.1077896510" 
Çme
="As£mbly" 
su³rCÏss
="org.eclipse.cdt.build.core.settings.holder">

24 <
šputTy³
 
id
="Üg.eş£.cdt.bud.cÜe.£‰šgs.hŞd”.šTy³.1211848323" 
ÏnguageId
="Üg.eş£.cdt.cÜe.as£mbly" 
ÏnguageName
="As£mbly" 
sourûCÚ‹ÁTy³
="Üg.eş£.cdt.cÜe.asmSourû" 
su³rCÏss
="org.eclipse.cdt.build.core.settings.holder.inType"/>

25 </
toŞ
>

26 <
toŞ
 
id
="Üg.eş£.cdt.bud.cÜe.£‰šgs.hŞd”.1683602073" 
Çme
="GNU C++" 
su³rCÏss
="org.eclipse.cdt.build.core.settings.holder">

27 <
İtiÚ
 
id
="Üg.eş£.cdt.bud.cÜe.£‰šgs.hŞd”.šı©hs.630069197" 
Çme
="InşudP©hs" 
su³rCÏss
="Üg.eş£.cdt.bud.cÜe.£‰šgs.hŞd”.šı©hs" 
v®ueTy³
="includePath">

28 <
li¡O±iÚV®ue
 
butIn
="çl£" 
v®ue
="/usr/include"/>

29 </
İtiÚ
>

30 <
šputTy³
 
id
="Üg.eş£.cdt.bud.cÜe.£‰šgs.hŞd”.šTy³.836714347" 
ÏnguageId
="Üg.eş£.cdt.cÜe.g++" 
ÏnguageName
="GNU C++" 
sourûCÚ‹ÁTy³
="Üg.eş£.cdt.cÜe.cxxSourû,Üg.eş£.cdt.cÜe.cxxH—d”" 
su³rCÏss
="org.eclipse.cdt.build.core.settings.holder.inType"/>

31 </
toŞ
>

32 <
toŞ
 
id
="Üg.eş£.cdt.bud.cÜe.£‰šgs.hŞd”.1871113060" 
Çme
="GNU C" 
su³rCÏss
="org.eclipse.cdt.build.core.settings.holder">

33 <
šputTy³
 
id
="Üg.eş£.cdt.bud.cÜe.£‰šgs.hŞd”.šTy³.1695830856" 
ÏnguageId
="Üg.eş£.cdt.cÜe.gcc" 
ÏnguageName
="GNU C" 
sourûCÚ‹ÁTy³
="Üg.eş£.cdt.cÜe.cSourû,Üg.eş£.cdt.cÜe.cH—d”" 
su³rCÏss
="org.eclipse.cdt.build.core.settings.holder.inType"/>

34 </
toŞ
>

35 </
toŞChaš
>

36 </
fŞd”Info
>

37 </
cÚfigu¿tiÚ
>

38 </
¡ÜageModuË
>

39 <
¡ÜageModuË
 
moduËId
="org.eclipse.cdt.core.externalSettings"/>

40 </
ccÚfigu¿tiÚ
>

41 </
¡ÜageModuË
>

42 <
¡ÜageModuË
 
moduËId
="cdtBudSy¡em" 
v”siÚ
="4.0.0">

43 <
´ojeù
 
id
="Legacy.nuÎ.1125779160" 
Çme
="Legacy"/>

44 </
¡ÜageModuË
>

45 <
¡ÜageModuË
 
moduËId
="scannerConfiguration">

46 <
autodiscov”y
 
’abËd
="Œue" 
´obËmR•ÜtšgEÇbËd
="Œue" 
£ËùedProfeId
=""/>

47 <
sÿÂ”CÚfigBudInfo
 
š¡ªûId
="0.1381401351">

48 <
autodiscov”y
 
’abËd
="Œue" 
´obËmR•ÜtšgEÇbËd
="Œue" 
£ËùedProfeId
=""/>

49 </
sÿÂ”CÚfigBudInfo
>

50 </
¡ÜageModuË
>

51 <
¡ÜageModuË
 
moduËId
="org.eclipse.cdt.core.LanguageSettingsProviders"/>

52 <
¡ÜageModuË
 
moduËId
="»äeshScİe" 
v”siÚNumb”
="2">

53 <
cÚfigu¿tiÚ
 
cÚfigu¿tiÚName
="Default">

54 <
»sourû
 
»sourûTy³
="PROJECT" 
wÜk¥aûP©h
="/Legacy"/>

55 </
cÚfigu¿tiÚ
>

56 </
¡ÜageModuË
>

57 <
¡ÜageModuË
 
moduËId
="org.eclipse.cdt.internal.ui.text.commentOwnerProjectMappings"/>

58 </
ırojeù
>

	@src/Area.cc

1 
	~"A»a.hh
"

3 
	~"¬gum’t.hh
"

4 
	~"chªÃls.hh
"

5 
	~"Ch¬aù”.hh
"

6 
	~"Ex™.hh
"

7 
	~"fe.hh
"

8 
	~"FÏgs.hh
"

9 
	~"FÜm©.hh
"

10 
	~"Game.hh
"

11 
	~"Loggšg.hh
"

12 
	~"m”c.hh
"

13 
	~"MobePrÙÙy³.hh
"

14 
	~"Objeù.hh
"

15 
	~"ObjeùPrÙÙy³.hh
"

16 
	~"ObjeùV®ue.hh
"

17 
	~"¿ndom.hh
"

18 
	~"Re£t.hh
"

19 
	~"Room.hh
"

20 
	~"RoomPrÙÙy³.hh
"

21 
	~"wÜldm­/RegiÚ.hh
"

22 
	~"Shİ.hh
"

23 
	~"WÜld.hh
"

25 
	gA»a
::

26 
	$A»a
(
WÜld
& 
w
, cÚ¡ 
SŒšg
& 
fe_Çme
è: 
	`wÜld
(w), 
	$fe_Çme
(
fe_Çme
) {

29 
åA»a
 = 
	`fİ’
(
	`SŒšg
(SŒšg(
AREA_DIR
è+ 
fe_Çme
).
	`c_¡r
(), "r");

31 ià(
åA»a
 =ğ
nuÎ±r
) {

32 
	`³¼Ü
(
fe_Çme
.
	`c_¡r
());

33 
	`ex™
(1);

36 
FÜm©
::
	`´štf
("Now†ßdšg‡»a: %s\n", 
fe_Çme
);

38 ià(
	`ä—d_Ë‰”
(
åA»a
) != '#') {

39 
Loggšg
::
	`fe_bug
(
åA»a
, "Load_area: #‚ot found.", 0);

40 
	`ex™
(1);

43 
SŒšg
 
wÜd
 = 
	`ä—d_wÜd
(
åA»a
);

45 ià(
wÜd
 != "AREA") {

46 
Loggšg
::
	`fe_bug
(
åA»a
, "Load_area: AREA section‚ot seen yet", 0);

47 
	`ex™
(1);

50 
	`lßd_h—d”
(
åA»a
);

51 
	}
}

53 
	gA»a
::

54 
	$lßd
() {

56 ià(
	`ä—d_Ë‰”
(
åA»a
) != '#') {

57 
Loggšg
::
	`fe_bug
(
åA»a
, "Load_area: #‚ot found.", 0);

58 
	`ex™
(1);

61 
SŒšg
 
wÜd
 = 
	`ä—d_wÜd
(
åA»a
);

63 ià(
wÜd
[0] == '$') ;

64 ià(
wÜd
 =ğ"REGION"è
	`lßd_»giÚ
(
åA»a
);

65 ià(
wÜd
 =ğ"MOBILES"è
	`lßd_mobes
(
åA»a
);

66 ià(
wÜd
 =ğ"OBJECTS"è
	`lßd_objeùs
(
åA»a
);

67 ià(
wÜd
 =ğ"RESETS"è
	`lßd_»£ts
(
åA»a
);

68 ià(
wÜd
 =ğ"ROOMS"è
	`lßd_rooms
(
åA»a
);

69 ià(
wÜd
 =ğ"SHOPS"è
	`lßd_shİs
(
åA»a
);

70 ià(
wÜd
 =ğ"SPECIALS"è
	`lßd_¥ecŸls
(
åA»a
);

74 
Loggšg
::
	`fe_bug
(
åA»a
, "Load_area: bad section‚ame.", 0);

75 
	`ex™
(1);

79 
	`fşo£
(
åA»a
);

80 
	}
}

82 
	gA»a
::

83 ~
	$A»a
() {

84 
Re£t
 *
»£t
: 
»£ts
)

85 
d–‘e
 
»£t
;

87 autØ
·œ
 : 
room_´ÙÙy³s
)

88 
d–‘e
 
·œ
.
£cÚd
;

90 autØ
·œ
 : 
mob_´ÙÙy³s
)

91 
d–‘e
 
·œ
.
£cÚd
;

93 autØ
·œ
 : 
obj_´ÙÙy³s
)

94 
d–‘e
 
·œ
.
£cÚd
;

96 ià(
»giÚ
 !ğ
nuÎ±r
)

97 
d–‘e
 
»giÚ
;

99 auto& 
’Œy
 : 
rooms
)

100 
d–‘e
 
’Œy
.
£cÚd
;

101 
	}
}

103 
	gA»a
::

104 
	$lßd_h—d”
(
FILE
 *
å
) {

105 
	`ä—d_¡ršg
(
å
);

106 
Çme
 = 
	`ä—d_¡ršg
(
å
);

107 
üed™s
 = 
	`ä—d_¡ršg
(
å
);

108 
mš_vnum
 = 
	`Vnum
(
	`ä—d_numb”
(
å
));

109 
max_vnum
 = 
	`Vnum
(
	`ä—d_numb”
(
å
));

111 
SŒšg
 
lše
 = 
fe_Çme
;

112 
SŒšg
 
num
;

113 
lše
 = 
	`Úe_¬gum’t
Öše, 
num
);

115 ià(
num
.
	`is_numb”
()) {

116 
v”siÚ
 = 
	`©oi
(
num
);

117 
fe_Çme
 = 
lše
;

121 cÚ¡‡uto& 
·œ
 : 
Game
::
	`wÜld
().
¬—s
) {

122 cÚ¡‡uto& 
¿nge
 = 
·œ
.
fœ¡
;

124 ià((
mš_vnum
 >ğ
¿nge
.
mš
 && mš_vnum <ğ¿nge.
max
)

125 || (
max_vnum
 >ğ
¿nge
.
mš
 && max_vnum <ğ¿nge.
max
)

126 || (
¿nge
.
mš
 >ğ
mš_vnum
 &&„ªge.mš <ğ
max_vnum
)

127 || (
¿nge
.
max
 >ğ
mš_vnum
 &&„ªge.max <ğ
max_vnum
)) {

128 
Loggšg
::
	`fe_bug
(
å
, 
FÜm©
::
	`fÜm©
("Lßd_¬—: vnum„ªgov”Ïp w™h‡»¨f'%s'", 
·œ
.
£cÚd
->
fe_Çme
), 0);

129 
	`ex™
(1);

133 
	`sÿn_üed™s
();

134 
	}
}

136 
	gA»a
::

137 
	$lßd_»giÚ
(
FILE
 *
å
) {

138 ià(
»giÚ
 !ğ
nuÎ±r
)

139 
d–‘e
 
»giÚ
;

141 
»giÚ
 = 
Ãw
 
wÜldm­
::
	`RegiÚ
(*
this
, 
å
);

142 
	}
}

144 
	gA»a
::

145 
	$lßd_rooms
(
FILE
 *
å
) {

146 
Œue
) {

147 
Ë‰”
 = 
	`ä—d_Ë‰”
(
å
);

149 ià(
Ë‰”
 != '#') {

150 
Loggšg
::
	`fe_bug
(
å
, "Load_rooms: #‚ot found.", 0);

151 
	`ex™
(1);

154 
Vnum
 
vnum
 = 
	`ä—d_numb”
(
å
);

156 ià(
vnum
.
	`v®ue
() == 0)

159 ià(
vnum
 < 
mš_vnum
 || vnum > 
max_vnum
) {

160 
Loggšg
::
	`fe_bug
(
å
, "Lßd_rooms:„oom vnum %d ouˆoà¿nge.", 
vnum
);

161 
	`ex™
(1);

164 ià(
room_´ÙÙy³s
.
	`fšd
(
vnum
è!ğroom_´ÙÙy³s.
	`’d
()) {

165 
Loggšg
::
	`fe_bug
(
å
, "Lßd_rooms: vnum %d du¶iÿ‹d.", 
vnum
);

166 
	`ex™
(1);

169 
room_´ÙÙy³s
[
vnum
] = 
Ãw
 
	`RoomPrÙÙy³
(*
this
, vnum, 
å
);

170 
tİ_room
++;

172 
	}
}

174 
	gA»a
::

175 
	$lßd_mobes
(
FILE
 *
å
)

177 
Œue
) {

178 
Ë‰”
 = 
	`ä—d_Ë‰”
(
å
);

180 ià(
Ë‰”
 != '#') {

181 
Loggšg
::
	`fe_bug
(
å
, "Load_mobiles: #‚ot found.", 0);

182 
	`ex™
(1);

185 
Vnum
 
vnum
 = 
	`ä—d_numb”
(
å
);

187 ià(
vnum
.
	`v®ue
() == 0)

190 ià(
vnum
 < 
mš_vnum
 || vnum > 
max_vnum
) {

191 
Loggšg
::
	`fe_bug
(
å
, "Lßd_mobes:„oom vnum %d ouˆoà¿nge.", 
vnum
);

192 
	`ex™
(1);

195 ià(
mob_´ÙÙy³s
.
	`fšd
(
vnum
è!ğmob_´ÙÙy³s.
	`’d
()) {

196 
Loggšg
::
	`fe_bug
(
å
, "Lßd_mobes: vnum %d du¶iÿ‹d.", 
vnum
);

197 
	`ex™
(1);

200 
mob_´ÙÙy³s
[
vnum
] = 
Ãw
 
	`MobePrÙÙy³
(*
this
, vnum, 
å
);

201 
tİ_mob_šdex
++;

203 
	}
}

205 
	gA»a
::

206 
	$lßd_objeùs
(
FILE
 *
å
)

208 
Œue
) {

209 
Ë‰”
 = 
	`ä—d_Ë‰”
(
å
);

211 ià(
Ë‰”
 != '#') {

212 
Loggšg
::
	`fe_bug
(
å
, "Load_objects: #‚ot found.", 0);

213 
	`ex™
(1);

216 
Vnum
 
vnum
 = 
	`ä—d_numb”
(
å
);

218 ià(
vnum
.
	`v®ue
() == 0)

221 ià(
vnum
 < 
mš_vnum
 || vnum > 
max_vnum
) {

222 
Loggšg
::
	`fe_bug
(
å
, "Lßd_objeùs:„oom vnum %d ouˆoà¿nge.", 
vnum
);

223 
	`ex™
(1);

226 ià(
obj_´ÙÙy³s
.
	`fšd
(
vnum
è!ğobj_´ÙÙy³s.
	`’d
()) {

227 
Loggšg
::
	`fe_bug
(
å
, "Lßd_objeùs: vnum %d du¶iÿ‹d.", 
vnum
);

228 
	`ex™
(1);

231 
obj_´ÙÙy³s
[
vnum
] = 
Ãw
 
	`ObjeùPrÙÙy³
(*
this
, vnum, 
å
);

232 
tİ_obj_šdex
++;

234 
	}
}

236 
	gA»a
::

237 
	$lßd_shİs
(
FILE
 *
å
)

240 
shİk“³r
 = 
	`ä—d_numb”
(
å
);

242 ià(
shİk“³r
 == 0)

245 
MobePrÙÙy³
 *
pMobIndex
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
shİk“³r
);

247 ià(
pMobIndex
 =ğ
nuÎ±r
) {

248 
Loggšg
::
	`fe_bug
(
å
, "Lßd_shİs: NULL mob index %d", 
shİk“³r
);

249 
	`ex™
(1);

252 
pMobIndex
->
pShİ
 = 
Ãw
 
	`Shİ
(
å
);

253 
tİ_shİ
++;

257 
	}
}

259 
	gA»a
::

260 
	$lßd_»£ts
(
FILE
 *
å
)

263 
Ë‰”
 = 
	`ä—d_Ë‰”
(
å
);

265 ià(
Ë‰”
 == 'S')

268 ià(
Ë‰”
 == '*') {

269 
	`ä—d_to_eŞ
(
å
);

273 
	`ung‘c
(
Ë‰”
, 
å
);

274 
Re£t
 *
pRe£t
 = 
Ãw
 
	`Re£t
(
å
);

275 
»£ts
.
	`push_back
(
pRe£t
);

277 
	}
}

314 
	gA»a
::

315 
	$lßd_¥ecŸls
(
FILE
 *
å
)

317 
MobePrÙÙy³
 *
pMobIndex
;

318 
Ë‰”
;

321 
Ë‰”
 = 
	`ä—d_Ë‰”
(
å
)) {

323 
Loggšg
::
	`fe_bug
(
å
, "Lßd_¥ecŸls:†‘‹¸'%c'‚Ù *MS.", 
Ë‰”
);

324 
	`ex™
(1);

333 
pMobIndex
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
	`ä—d_numb”
(
å
));

335 ià(!
pMobIndex
) {

336 
Loggšg
::
	`fe_bug
(
å
, "Lßd_¥ecŸls: 'M': vnum %d.", 
pMobIndex
->
vnum
);

337 
	`ex™
(1);

340 
pMobIndex
->
¥ec_fun
 = 
	`¥ec_lookup
(
	`ä—d_wÜd
(
å
));

342 ià(
pMobIndex
->
¥ec_fun
 == 0) {

343 
Loggšg
::
	`fe_bug
(
å
, "Lßd_¥ecŸls: 'M': vnum %d.", 
pMobIndex
->
vnum
);

344 
	`ex™
(1);

350 
	`ä—d_to_eŞ
(
å
);

352 
	}
}

354 
MobePrÙÙy³
 * 
	gA»a
::

355 
	$g‘_mob_´ÙÙy³
(cÚ¡ 
Vnum
& 
vnum
) {

356 cÚ¡‡uto& 
·œ
 = 
mob_´ÙÙy³s
.
	`fšd
(
vnum
);

358 ià(
·œ
 !ğ
mob_´ÙÙy³s
.
	`ûnd
())

359  
·œ
->
£cÚd
;

361  
nuÎ±r
;

362 
	}
}

364 
ObjeùPrÙÙy³
 * 
	gA»a
::

365 
	$g‘_obj_´ÙÙy³
(cÚ¡ 
Vnum
& 
vnum
) {

366 cÚ¡‡uto& 
·œ
 = 
obj_´ÙÙy³s
.
	`fšd
(
vnum
);

368 ià(
·œ
 !ğ
obj_´ÙÙy³s
.
	`ûnd
())

369  
·œ
->
£cÚd
;

371  
nuÎ±r
;

372 
	}
}

374 
RoomPrÙÙy³
 * 
	gA»a
::

375 
	$g‘_room_´ÙÙy³
(cÚ¡ 
Vnum
& 
vnum
) {

376 cÚ¡‡uto& 
·œ
 = 
room_´ÙÙy³s
.
	`fšd
(
vnum
);

378 ià(
·œ
 !ğ
room_´ÙÙy³s
.
	`ûnd
())

379  
·œ
->
£cÚd
;

381  
nuÎ±r
;

382 
	}
}

384 
	gA»a
::

385 
	$upd©e
() {

387 ià(--
age
 <= 0) {

388 
	`»£t
();

389 
age
 = 
	`numb”_¿nge
(3, 5);

391 
	}
}

393 
	gA»a
::

394 
	$»£t
() {

395 
Ch¬aù”
 *
mob
;

396 
boŞ
 
Ï¡
;

397 
Ëv–
;

398 
mob
 = 
nuÎ±r
;

399 
Ï¡
 = 
Œue
;

400 
Ëv–
 = 0;

401 
boŞ
 
em±y
 = 
	`num_¶ay”s
() == 0;

403 cÚ¡ 
Re£t
 *
pRe£t
: 
»£ts
) {

404 
Room
 *
room
;

405 
MobePrÙÙy³
 *
pMobIndex
;

406 
ObjeùPrÙÙy³
 *
pObjIndex
;

407 
ObjeùPrÙÙy³
 *
pObjToIndex
;

408 
Ex™
 *
³x™
;

409 
Objeù
 *
obj
;

410 
Objeù
 *
obj_to
;

411 
couÁ
, 
lim™
;

413 
pRe£t
->
commªd
) {

415 
Loggšg
::
	`bugf
("(%sèRe£t_¬—: bad commªd %c.", 
fe_Çme
, 
pRe£t
->
commªd
);

419 ià((
pMobIndex
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
pRe£t
->
¬g1
)è=ğ
nuÎ±r
) {

420 
Loggšg
::
	`bugf
("(%sèRe£t_¬—: 'M': bad vnum %d.", 
fe_Çme
, 
pRe£t
->
¬g1
);

424 ià(
pMobIndex
->
couÁ
 >ğ
pRe£t
->
¬g2
) {

425 
Ï¡
 = 
çl£
;

429 ià(
pRe£t
->
¬g3
 == 0) {

430 ià(!
	`rŞl_chªû
(
pRe£t
->
¬g4
))

433 ià((
room
 = 
	`g‘_¿ndom_»£t_room
(
pMobIndex
)è=ğ
nuÎ±r
) {

434 
Loggšg
::
	`bugf
("(%sèRe£t_¬—: 'M':‚Ø¿ndom„oom found fÜ mob %d.", 
fe_Çme
, 
pRe£t
->
¬g1
);

439 ià((
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
pRe£t
->
¬g3
))è=ğ
nuÎ±r
) {

440 
Loggšg
::
	`bugf
("(%sèRe£t_¬—: 'M': bad†oÿtiÚ %s.", 
fe_Çme
, 
	`LoÿtiÚ
(
pRe£t
->
¬g3
));

444 
mob
 = 
room
->
³İË
, 
couÁ
 = 0; mob !ğ
nuÎ±r
; mob = mob->
Ãxt_š_room
)

445 ià(
mob
->
pIndexD©a
 =ğ
pMobIndex
) {

446 
couÁ
++;

448 ià(
couÁ
 >ğ
pRe£t
->
¬g4
) {

449 
Ï¡
 = 
çl£
;

454 ià(
couÁ
 >ğ
pRe£t
->
¬g4
)

458 
mob
 = 
	`ü—‹_mobe
(
pMobIndex
);

459 
mob
->
»£t
 = 
pRe£t
;

462 
Room
 *
roomP»v
;

463 
roomP»v
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
room
->
´ÙÙy³
.
vnum
.
	`v®ue
() - 1)));

465 ià(
roomP»v
 !ğ
nuÎ±r


466 && 
roomP»v
->
	`æags
().
	`has
(
ROOM_PET_SHOP
))

467 
mob
->
aù_æags
 +ğ
ACT_PET
;

470 
	`ch¬_to_room
(
mob
, 
room
);

471 
Ëv–
 = 
	`URANGE
(0, 
mob
->Ëv– - 2, 
LEVEL_HERO
 - 1);

472 
Ï¡
 = 
Œue
;

477 ià(
pRe£t
->
¬g1
 =ğ
OBJ_VNUM_PIT
 && 
Game
::
	`wÜld
().
dÚ©iÚ_p™
 !ğ
nuÎ±r
) {

478 
Ï¡
 = 
çl£
;

482 ià(!
em±y
 && 
pRe£t
->
¬g1
 !ğ
OBJ_VNUM_PIT
) {

483 
Ï¡
 = 
çl£
;

487 ià((
pObjIndex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
pRe£t
->
¬g1
)è=ğ
nuÎ±r
) {

488 
Loggšg
::
	`bugf
("(%sèRe£t_¬—: 'O': bad vnum %d.", 
fe_Çme
, 
pRe£t
->
¬g1
);

492 ià((
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
pRe£t
->
¬g3
))è=ğ
nuÎ±r
) {

493 
Loggšg
::
	`bugf
("(%sèRe£t_¬—: 'O': bad†oÿtiÚ %s.", 
fe_Çme
, 
	`LoÿtiÚ
(
pRe£t
->
¬g3
));

497 ià(
	`couÁ_obj_li¡
(
pObjIndex
, 
room
->
cÚ‹Ás
) > 0) {

498 
Ï¡
 = 
çl£
;

502 
obj
 = 
	`ü—‹_objeù
(
pObjIndex
, 
¡d
::
	`mš
(
	`numb”_fuzzy
(
Ëv–
), 
LEVEL_HERO
 - 1));

503 
obj
->
»£t
 = 
pRe£t
;

504 
	`obj_to_room
(
obj
, 
room
);

506 ià(
pObjIndex
->
vnum
 =ğ
OBJ_VNUM_PIT
)

507 
Game
::
	`wÜld
().
dÚ©iÚ_p™
 = 
obj
;

509 
	`unique_™em
(
obj
);

511 
Ï¡
 = 
Œue
;

515 ià((
pObjIndex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
pRe£t
->
¬g1
)è=ğ
nuÎ±r
) {

516 
Loggšg
::
	`bugf
("(%sèRe£t_¬—: 'P': bad vnum %d.", 
fe_Çme
, 
pRe£t
->
¬g1
);

520 ià((
pObjToIndex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
pRe£t
->
¬g3
)è=ğ
nuÎ±r
) {

521 
Loggšg
::
	`bugf
("(%sèRe£t_¬—: 'P': bad vnum %d.", 
fe_Çme
, 
pRe£t
->
¬g3
);

525 ià(
pRe£t
->
¬g2
 > 50)

526 
lim™
 = 6;

527 ià(
pRe£t
->
¬g2
 == -1)

528 
lim™
 = 999;

530 
lim™
 = 
pRe£t
->
¬g2
;

532 ià(!
em±y


533 || (
obj_to
 = 
	`g‘_obj_ty³
(
pObjToIndex
)è=ğ
nuÎ±r


534 || (
obj_to
->
š_room
 =ğ
nuÎ±r
 && !
Ï¡
)

535 || (
pObjIndex
->
couÁ
 >ğ
lim™
 && 
	`rŞl_chªû
(80))

536 || (
couÁ
 = 
	`couÁ_obj_li¡
(
pObjIndex
, 
obj_to
->
cÚšs
))

537 > 
pRe£t
->
¬g4
) {

538 
Ï¡
 = 
çl£
;

542 
couÁ
 < 
pRe£t
->
¬g4
) {

543 
obj
 = 
	`ü—‹_objeù
(
pObjIndex
, 
	`numb”_fuzzy
(
obj_to
->
Ëv–
));

544 
obj
->
»£t
 = 
pRe£t
;

545 
	`unique_™em
(
obj
);

546 
	`obj_to_obj
(
obj
, 
obj_to
);

547 
couÁ
++;

549 ià(
pObjIndex
->
couÁ
 >ğ
lim™
)

554 
obj_to
->
v®ue
[1] = obj_to->
pIndexD©a
->value[1];

555 
Ï¡
 = 
Œue
;

560 ià((
pObjIndex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
pRe£t
->
¬g1
)è=ğ
nuÎ±r
) {

561 
Loggšg
::
	`bugf
("(%sèRe£t_¬—: '%c': bad vnum %d.", 
fe_Çme
, 
pRe£t
->
commªd
,…Re£t->
¬g1
);

565 ià(!
Ï¡
)

568 ià(
mob
 =ğ
nuÎ±r
) {

569 
Loggšg
::
	`bugf
("(%s) Reset_area: '%c':‚ull mob for vnum %d.",

570 
fe_Çme
, 
pRe£t
->
commªd
,…Re£t->
¬g1
);

571 
Ï¡
 = 
çl£
;

575 ià(
mob
->
pIndexD©a
->
pShİ
 !ğ
nuÎ±r
) {

576 
Şev–
 = 0;

577 
obj
 = 
	`ü—‹_objeù
(
pObjIndex
, 
Şev–
);

578 
obj
->
exŒa_æags
 +ğ
ITEM_INVENTORY
;

581 ià(
pRe£t
->
¬g2
 == -1)

582 
lim™
 = 999;

584 
lim™
 = 
pRe£t
->
¬g2
;

586 ià(
pObjIndex
->
couÁ
 < 
lim™
 || 
	`rŞl_chªû
(20)) {

587 
obj
 = 
	`ü—‹_objeù
(
pObjIndex
, 
¡d
::
	`mš
(
	`numb”_fuzzy
(
Ëv–
),

588 
LEVEL_HERO
 - 1));

590 
	`unique_™em
(
obj
);

593 ià(
obj
->
Ëv–
 > 
mob
->level + 3)

594 
Loggšg
::
	`bugf
("(%s) Reset_area: '%c': obj %s (%d) -- %d, mob %s (%d) -- %d\n",

595 
fe_Çme
, 
pRe£t
->
commªd
, 
obj
->
shÜt_desü
, obj->
pIndexD©a
->
vnum
, obj->
Ëv–
,

596 
mob
->
shÜt_desü
, mob->
pIndexD©a
->
vnum
, mob->
Ëv–
);

602 
obj
->
»£t
 = 
pRe£t
;

603 
	`obj_to_ch¬
(
obj
, 
mob
);

605 ià(
pRe£t
->
commªd
 == 'E')

606 
	`equ_ch¬
(
mob
, 
obj
, 
pRe£t
->
¬g3
);

608 
Ï¡
 = 
Œue
;

613 ià(
	`num_¶ay”s
() > 0)

616 ià((
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
pRe£t
->
¬g1
))è=ğ
nuÎ±r
) {

617 
Loggšg
::
	`bugf
("(%sèRe£t_¬—: 'D': bad†oÿtiÚ %s.", 
fe_Çme
, 
	`LoÿtiÚ
(
pRe£t
->
¬g1
));

621 ià((
³x™
 = 
room
->
ex™
[
pRe£t
->
¬g2
]è=ğ
nuÎ±r


622 || !
³x™
->
ex™_æags
.
	`has
(
EX_ISDOOR
)) {

628 
pRe£t
->
¬g3
) {

630 
³x™
->
ex™_æags
 -ğ
EX_CLOSED
;

631 
³x™
->
ex™_æags
 -ğ
EX_LOCKED
;

635 
³x™
->
ex™_æags
 +ğ
EX_CLOSED
;

636 
³x™
->
ex™_æags
 -ğ
EX_LOCKED
;

640 
³x™
->
ex™_æags
 +ğ
EX_CLOSED
;

641 
³x™
->
ex™_æags
 +ğ
EX_LOCKED
;

645 
Ï¡
 = 
Œue
;

649 ià((
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
pRe£t
->
¬g1
))è=ğ
nuÎ±r
) {

650 
Loggšg
::
	`bugf
("(%sèRe£t_¬—: 'R': bad†oÿtiÚ %s.", 
fe_Çme
, 
	`LoÿtiÚ
(
pRe£t
->
¬g1
));

655 
d0
;

656 
d1
;

658 
d0
 = 0; d0 < 
pRe£t
->
¬g2
 - 1; d0++) {

659 
d1
 = 
	`numb”_¿nge
(
d0
, 
pRe£t
->
¬g2
 - 1);

660 
³x™
 = 
room
->
ex™
[
d0
];

661 
room
->
ex™
[
d0
] =„oom->ex™[
d1
];

662 
room
->
ex™
[
d1
] = 
³x™
;

670 
SŒšg
 
buf
 = 
FÜm©
::
	`fÜm©
("% ha ju¡ b“À»£t.", 
Çme
);

671 
	`wizÃt
(
buf
, 
nuÎ±r
,‚uÎ±r, 
WIZ_RESETS
, 0, 0);

672 
	}
}

680 
	gA»a
::

681 
	$sÿn_üed™s
()

683 
lše
[
MIL
], 
buf
[MIL];

684 
SŒšg
 
keywÜds
;

685 *
p
, *
Ëv–s
, *
authÜ
, *
t™Ë
;

686 
nbÏnks
;

688 ià(
üed™s
.
	`em±y
()) {

689 
Loggšg
::
	`log
("scan_credits: No credits‡vailable.\n");

694 
¬—_ty³
 = 
AREA_TYPE_NORM
;

695 
low_¿nge
 = 1;

696 
high_¿nge
 = 
LEVEL_HERO
;

699 
	`¡rıy
(
lše
, 
üed™s
);

702 
p
 = 
	`¡rchr
(
lše
, '}');

704 ià(
p
 =ğ
nuÎ±r
) {

705 
Loggšg
::
	`log
("Missing '}' in credits†ine\n");

709 *
p
 = '\0';

710 
authÜ
 = 
p
 + 1;

712 
Ëv–s
 = 
lše
;

714 (
p
 = 
	`¡rchr
(
Ëv–s
, '{')è!ğ
nuÎ±r
)†evels =… + 1;

716 
	`i§scii
(*
Ëv–s
è&& 
	`is¥aû
(*levels))†evels++;

719 
nbÏnks
 = 0;

721 
p
 = 
Ëv–s
; *p;…++) {

722 ià(!
	`i§scii
(*
p
))

723 
nbÏnks
 = 0;

724 ià(
	`is¥aû
(*
p
))

725 
nbÏnks
++;

727 *
p
 = 
	`touµ”
(*p);

728 
nbÏnks
 = 0;

732 *(
p
 -ğ
nbÏnks
) = '\0';

734 ià(*
Ëv–s
 == '\0') {

735 
Loggšg
::
	`log
("scan_credits: Empty†evel„ange string\n");

739 ià(!
	`¡rcmp
(
Ëv–s
, "ALL")) {

740 
¬—_ty³
 = 
AREA_TYPE_ALL
;

741 
keywÜds
 = "ALL ";

743 ià(!
	`¡rcmp
(
Ëv–s
, "CLANS") || !strcmp(levels, "CLAN")) {

744 
low_¿nge
 = 15;

745 
¬—_ty³
 = 
AREA_TYPE_CLAN
;

746 
keywÜds
 = "CLAN ";

748 ià(!
	`¡rcmp
(
Ëv–s
, "IMM") || !strcmp(levels, "IMMS")) {

749 
low_¿nge
 = 
LEVEL_IMMORTAL
;

750 
high_¿nge
 = 
MAX_LEVEL
;

751 
¬—_ty³
 = 
AREA_TYPE_IMMS
;

752 
keywÜds
 = "IMMS ";

754 ià(!
	`¡rcmp
(
Ëv–s
, "HRO") || !strcmp(levels, "HERO")) {

755 
low_¿nge
 = 
LEVEL_HERO
;

756 
high_¿nge
 = 
MAX_LEVEL
;

757 
¬—_ty³
 = 
AREA_TYPE_HERO
;

758 
keywÜds
 = "HRO HERO ";

760 ià(!
	`¡rcmp
(
Ëv–s
, "ARENA")) {

761 
low_¿nge
 = 1;

762 
high_¿nge
 = 
MAX_LEVEL
;

763 
¬—_ty³
 = 
AREA_TYPE_ARENA
;

764 
keywÜds
 = "ARENA ";

766 ià(!
	`¡rcmp
(
Ëv–s
, "XXX")) {

767 
low_¿nge
 = 
MAX_LEVEL
;

768 
high_¿nge
 = 
MAX_LEVEL
;

769 
¬—_ty³
 = 
AREA_TYPE_XXX
;

770 
keywÜds
 = "XXX ";

772 ià(!
	`i§scii
(*
Ëv–s
è|| !
	`isdig™
(*levels)) {

773 
FÜm©
::
	`¥rštf
(
buf
, "sÿn_üed™s: UÄecognized†ev–„ªge: '%s'\n", 
Ëv–s
);

774 
Loggšg
::
	`log
(
buf
);

778 
ow
, 
ihigh
;

779 
¬—_ty³
 = 
AREA_TYPE_NORM
;

780 
ow
 = 
	`©oi
(
Ëv–s
);

782 ià(
ow
 < 0) {

783 
FÜm©
::
	`¥rštf
(
buf
, "sÿn_üed™s: Bad s¹†ev–: %d\n", 
ow
);

784 
Loggšg
::
	`log
(
buf
);

788 
low_¿nge
 = 
ow
;

791 
	`i§scii
(*
Ëv–s
è&& 
	`isdig™
(*levels))†evels++;

793 
	`i§scii
(*
Ëv–s
è&& 
	`is¥aû
(*levels))†evels++;

795 ià(!
	`i§scii
(*
Ëv–s
è|| !
	`isdig™
(*levels)) {

796 
Loggšg
::
	`log
("scan_credits: Missing second‚umber of„ange\n");

800 
ihigh
 = 
	`©oi
(
Ëv–s
);

802 ià(
ihigh
 < 
ow
 || ihigh > 100) {

803 
FÜm©
::
	`¥rštf
(
buf
, "sÿn_üed™s: Badƒndšg†ev– :†ow : %d High : %d\n", 
ow
, 
ihigh
);

804 
Loggšg
::
	`log
(
buf
);

808 
high_¿nge
 = 
ihigh
;

813 *
authÜ
 == ' ')‡uthor++;

815 
p
 = 
authÜ
; *p && *p != ' ';…++);

817 ià(*
p
 == '\0') {

818 
t™Ë
 = 
authÜ
;

819 
authÜ
 = "anonymous";

822 *
p
 = '\0';

824 
t™Ë
 = 
p
 + 1; *title == ' ';itle++);

827 
this
->
authÜ
 =‡uthor;

828 
keywÜds
 +ğ
	`SŒšg
(
authÜ
).
	`uncŞÜ
();

829 
keywÜds
 += " ";

831 
this
->
t™Ë
 =itle;

832 
keywÜds
 +ğ
	`SŒšg
(
t™Ë
).
	`uncŞÜ
();

834 &
c
: 
keywÜds
)

835 
c
 = 
	`tŞow”
(c);

837 
this
->
keywÜds
 = keywords;

838  
¬—_ty³
;

839 
	}
}

841 
	gA»a
::

842 
	$ü—‹_rooms
() {

843 cÚ¡‡uto& 
·œ
 : 
room_´ÙÙy³s
) {

844 cÚ¡‡uto& 
vnum
 = 
·œ
.
fœ¡
;

845 cÚ¡‡utØ
´ÙÙy³
 = 
·œ
.
£cÚd
;

848 ià(
»giÚ
 !ğ
nuÎ±r


849 && 
»giÚ
->
	`vnum_to_cŞÜ
(
vnum
è!ğ
wÜldm­
::
M­CŞÜ
::
uncŞÜed
)

852 
Room
 *
room
 = 
Ãw
 
	`Room
(*
´ÙÙy³
);

854 ià(
room
 =ğ
nuÎ±r
) {

855 
Loggšg
::
	`bugf
("C»©e_rooms: uÇbËØü—‹„oom from…rÙÙy³ %d.", 
vnum
);

856 
	`ex™
(1);

859 
rooms
.
	`em¶aû
(
room
->
loÿtiÚ
.
room_id
,„oom);

863 ià(
»giÚ
 !ğ
nuÎ±r
)

864 
»giÚ
->
	`ü—‹_rooms
();

865 
	}
}

867 
	gA»a
::

868 
	$add_ch¬
(
Ch¬aù”
 *
ch
) {

869 ià(
ch
->
	`is_Åc
())

872 ià(
	`IS_IMMORTAL
(
ch
))

873 
_num_imms
++;

875 
_num_¶ay”s
++;

876 
	}
}

878 
	gA»a
::

879 
	$»move_ch¬
(
Ch¬aù”
 *
ch
) {

880 ià(
ch
->
	`is_Åc
())

887 ià(
	`IS_IMMORTAL
(
ch
))

888 
_num_imms
 = 
¡d
::
	`max
(0, _num_imms-1);

890 
_num_¶ay”s
 = 
¡d
::
	`max
(0, _num_players-1);

891 
	}
}

895 
Room
 * 
	gA»a
::

896 
	$g‘_¿ndom_»£t_room
(cÚ¡ 
MobePrÙÙy³
 *
mob
)

898 ià(
»giÚ
 =ğ
nuÎ±r


899 || 
»giÚ
->
®lowed_mob_»£ts
.
	`couÁ
(
mob
->
vnum
) == 0)

900  
nuÎ±r
;

902 
pick
 = 0, 
·ss
 = 1;

904 
·ss
 <= 2) {

905 
couÁ
 = 0;

907 auto& 
’Œy
 : 
rooms
) {

909 
Room
 *
room
 = 
’Œy
.
£cÚd
;

911 ià(
»giÚ
->
®lowed_room_»£ts
.
	`couÁ
(
room
->
´ÙÙy³
.
vnum
) == 0)

914 ià(
room
->
	`æags
().
	`has_ªy_of
(
ROOM_NO_MOB


915 | 
ROOM_PRIVATE


916 | 
ROOM_SAFE


917 | 
ROOM_SOLITARY


918 | 
ROOM_PET_SHOP


919 | 
ROOM_IMP_ONLY


920 | 
ROOM_GODS_ONLY


921 | 
ROOM_LEADER_ONLY


922 | 
ROOM_TELEPORT


923 | 
ROOM_NORANDOMRESET
))

926 ià(
·ss
 =ğ2 && 
couÁ
 =ğ
pick
)

927  
room
;

929 
couÁ
++;

932 ià(
·ss
++ =ğ2 || 
couÁ
 == 0)

935 
pick
 = 
	`numb”_¿nge
(0, 
couÁ
-1);

938  
nuÎ±r
;

939 
	}
}

	@src/Auction.cc

1 
	~"AuùiÚ.hh
"

3 
	~"aù.hh
"

4 
	~"¬gum’t.hh
"

5 
	~"chªÃls.hh
"

6 
	~"Ch¬aù”.hh
"

7 
	~"CÏn.hh
"

8 
	~"fšd.hh
"

9 
	~"FÏgs.hh
"

10 
	~"FÜm©.hh
"

11 
	~"Objeù.hh
"

12 
	~"ObjeùPrÙÙy³.hh
"

13 
	~"PÏy”.hh
"

14 
	~"SŒšg.hh
"

15 
	~"ty³Çme.hh
"

18 
AuùiÚ
 
	gauùiÚ
;

20 
	gAuùiÚ
::

21 
	$š™
() {

22 
™em
 = 
nuÎ±r
;

23 
buy”
 = 
nuÎ±r
;

24 
£Î”
 = 
nuÎ±r
;

25 
	}
}

27 
boŞ
 
	gAuùiÚ
::

28 
	$is_·¹icªt
(
Objeù
 *
obj
) const {

29  
™em
 !ğ
nuÎ±r
 && 
obj
 == item;

30 
	}
}

32 
boŞ
 
	gAuùiÚ
::

33 
	$is_·¹icªt
(
Ch¬aù”
 *
ch
) const {

34  
™em
 !ğ
nuÎ±r
 && 
ch
 !ğnuÎ±¸&& ((ch =ğ
buy”
è|| (ch =ğ
£Î”
));

35 
	}
}

37 
	gAuùiÚ
::

38 
	$upd©e
() {

39 ià(
™em
 =ğ
nuÎ±r
) {

44 ià(--
pul£
 <= 0) {

45 
SŒšg
 
buf
;

46 
pul£
 = 
PULSE_AUCTION
;

48 ++
gošg
) {

51 ià(
b‘
 > 0)

52 
FÜm©
::
	`¥rštf
(
buf
, "%s: going %s for %d gold.\n",

53 
™em
->
shÜt_desü
,

54 ((
gošg
 =ğ1è? "Úû" : "twiû"), 
b‘
);

56 
FÜm©
::
	`¥rštf
(
buf
, "%s: going %s (no bet„eceived yet).\n",

57 
™em
->
shÜt_desü
,

58 ((
gošg
 == 1) ? "once" : "twice"));

60 
	`lk_auùiÚ
(
buf
);

64 ià(
b‘
 > 0) {

65 
FÜm©
::
	`¥rštf
(
buf
, "AUCTION: %s soldo $n for %d gold.\n",

66 
™em
->
shÜt_desü
, 
b‘
);

67 
	`glob®_aù
(
buy”
, 
buf
, 
Œue
,

68 
YELLOW
, 
COMM_NOAUCTION
 | 
COMM_QUIET
);

69 
FÜm©
::
	`¥rštf
(
buf
, "AUCTION: %s soldo $N for %d gold.\n",

70 
™em
->
shÜt_desü
, 
b‘
);

71 
	`wizÃt
(
buf
, 
buy”
, 
nuÎ±r
, 
WIZ_AUCTION
, 0,

72 
	`GET_RANK
(
buy”
));

73 
	`obj_to_ch¬
(
™em
, 
buy”
);

74 
	`aù
("The‡uctioneer‡ppears before you in‡…uff of smoke‡nd hands you $p.",

75 
buy”
, 
™em
, 
nuÎ±r
, 
TO_CHAR
);

76 
	`aù
("The‡uctioneer‡ppears before $n,‡nd hands $m $p",

77 
buy”
, 
™em
, 
nuÎ±r
, 
TO_ROOM
);

79 
£Î”
->
gŞd
 +ğ
b‘
;

80 
™em
 = 
nuÎ±r
;

83 
FÜm©
::
	`¥rštf
(
buf
,

85 
™em
->
shÜt_desü
);

86 
	`lk_auùiÚ
(
buf
);

87 
	`aù
("The‡uctioneer‡ppears before youo„eturn $po you.",

88 
£Î”
, 
™em
, 
nuÎ±r
, 
TO_CHAR
);

89 
	`aù
("The‡uctioneer‡ppears before $no„eturn $po $m.",

90 
£Î”
, 
™em
, 
nuÎ±r
, 
TO_ROOM
);

91 
	`obj_to_ch¬
(
™em
, 
£Î”
);

92 
™em
 = 
nuÎ±r
;

96 
	}
}

99 
	$do_auùiÚ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

101 
Objeù
 *
obj
;

102 
buf
[
MSL
];

103 
CÏn
 *
şª
;

104 
mš
 = 0;

107 ià(
ch
->
	`is_Åc
()) {

108 
	`¡c
("Mobe ÿn'ˆauùiÚ!\n", 
ch
);

112 ià(
¬gum’t
.
	`em±y
()) {

113 
	`chªÃl
(
ch
, 
¬gum’t
, 
CHAN_AUCTION
);

118 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_AUCTION
)) {

119 
	`¡c
("Thgod hav»voked you¸ab™yØauùiÚ.\n", 
ch
);

123 ià(
ch
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

124 
	`¡c
("You mu¡uº ofàqu›ˆmodfœ¡.\n", 
ch
);

128 
SŒšg
 
¬g1
;

129 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

131 ià(
¬g1
 == "who") {

132 
	`chªÃl_who
(
ch
, "AuùiÚ", 
COMM_NOAUCTION
, 
CSLOT_CHAN_AUCTION
);

136 ià(
¬g1
 == "status") {

137 ià(
auùiÚ
.
™em
 =ğ
nuÎ±r
) {

138 
	`¡c
("NØ™em i u°fÜ‡uùiÚ.\n", 
ch
);

142 
	`±c
(
ch
, "Name (%s) Type (%s) Wear (%s)\n"

144 
auùiÚ
.
™em
->
shÜt_desü
,

145 
	`™em_ty³_Çme
(
auùiÚ
.
™em
),

146 
	`w—r_b™_Çme
(
auùiÚ
.
™em
->
w—r_æags
),

147 
auùiÚ
.
™em
->
Ëv–
,

148 
auùiÚ
.
™em
->
co¡
,

149 
auùiÚ
.
™em
->
cÚd™iÚ
);

151 ià(
auùiÚ
.
b‘
 > 0)

152 
	`±c
(
ch
, "Cu¼’ˆbid oÀthi ™em i %d gŞd.\n", 
auùiÚ
.
b‘
);

154 
	`¡c
("NØbid Úhi ™em havb“À»ûived.\n", 
ch
);

156 ià(
auùiÚ
.
mš
 > 0)

157 
	`±c
(
ch
, "Thmšimum bid oÀthi ™em i %d gŞd.\n", 
auùiÚ
.
mš
);

159 
	`¡c
("Th”i nØmšimum bid oÀthi ™em.\n", 
ch
);

161 ià(
	`IS_IMMORTAL
(
ch
))

162 
	`±c
(
ch
, "Seller: %s\n"

164 (
auùiÚ
.
£Î”
 =ğ
nuÎ±r
è? "(NÚe)" :‡uùiÚ.£Î”->
Çme
,

165 (
auùiÚ
.
buy”
 =ğ
nuÎ±r
è? "(NÚe)" :‡uùiÚ.buy”->
Çme
);

170 ià(
	`IS_IMMORTAL
(
ch
è&& 
¬g1
 == "stop") {

171 ià(
auùiÚ
.
™em
 =ğ
nuÎ±r
) {

172 
	`¡c
("Th”i nØauùiÚ gošg oÀyou cª stİ.\n", 
ch
);

176 
FÜm©
::
	`¥rštf
(
buf
, "Sale of %s has been stopped byhe Imms. Item confiscated.\n",

177 
auùiÚ
.
™em
->
shÜt_desü
);

178 
	`lk_auùiÚ
(
buf
);

179 
FÜm©
::
	`¥rštf
(
buf
, "% ha ¡İ³dhauùiÚ oà%s.", 
ch
->
Çme
, 
auùiÚ
.
™em
->
shÜt_desü
);

180 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_AUCTION
, 0, 
	`GET_RANK
(ch));

181 
	`obj_to_ch¬
(
auùiÚ
.
™em
, 
ch
);

182 
auùiÚ
.
™em
 = 
nuÎ±r
;

184 ià(
auùiÚ
.
buy”
 !ğ
nuÎ±r
) {

185 
auùiÚ
.
buy”
->
gŞd
 +ğauùiÚ.
b‘
;

186 
	`¡c
("You¸mÚey ha b“À»tuºed.\n", 
auùiÚ
.
buy”
);

192 ià(
¬g1
 == "bet" ||‡rg1 == "bid") {

193 
Ãwb‘
;

195 ià(
auùiÚ
.
™em
 =ğ
nuÎ±r
) {

196 
	`¡c
("Th”i¢'ˆªythšg bešg‡uùiÚed„ighˆnow.\n", 
ch
);

200 ià(
auùiÚ
.
£Î”
 =ğ
ch
) {

201 
	`¡c
("You may‚Ù bid oÀyou¸owÀ™ems.\n", 
ch
);

205 ià(
auùiÚ
.
buy”
 =ğ
ch
) {

206 
	`¡c
("You hav®»ady bid oÀ™!\n", 
ch
);

210 ià(
	`IS_IMMORTAL
(
ch
)) {

211 
	`¡c
("ImmÜl may‚Ù bid oÀauùiÚs.\n", 
ch
);

218 ià(
¬gum’t
.
	`em±y
())

219 
Ãwb‘
 = 
auùiÚ
.
b‘
 + 
¡d
::
	`max
(auction.bet / 10, 1);

221 ià(!
¬gum’t
.
	`is_numb”
()) {

222 
	`¡c
("You¸bid mu¡ bnum”ic.\n", 
ch
);

226 
Ãwb‘
 = 
	`©oi
(
¬gum’t
);

228 ià((
Ãwb‘
 - 
auùiÚ
.
b‘
è< 
¡d
::
	`max
(auction.bet / 10, 1)) {

229 
	`¡c
("You mu¡ bid‡ˆËa¡ 10% ov”hcu¼’ˆbid.\n", 
ch
);

234 ià((
Ãwb‘
 < 
auùiÚ
.
mš
) && (auction.min > 0)) {

235 
	`±c
(
ch
, "Thmšimum bid fÜh© i‹m i %d gŞd.\n", 
auùiÚ
.
mš
);

239 ià(!
	`deduù_co¡
(
ch
, 
Ãwb‘
 * 100)) {

240 
	`¡c
("You dÚ'ˆhavth© much mÚey!\n", 
ch
);

245 ià(
auùiÚ
.
buy”
 !ğ
nuÎ±r
)

246 
	`deduù_co¡
(
auùiÚ
.
buy”
, -×uùiÚ.
b‘
 * 100));

249 ià(
¬gum’t
.
	`em±y
())

250 
	`WAIT_STATE
(
ch
, 
PULSE_PER_SECOND
);

252 
auùiÚ
.
buy”
 = 
ch
;

253 
auùiÚ
.
b‘
 = 
Ãwb‘
;

254 
auùiÚ
.
gošg
 = 0;

255 
auùiÚ
.
pul£
 = 
PULSE_AUCTION
;

256 
FÜm©
::
	`¥rštf
(
buf
, "A bid of %d gold has been„eceived on %s.\n",

257 
Ãwb‘
, 
auùiÚ
.
™em
->
shÜt_desü
);

258 
	`lk_auùiÚ
(
buf
);

259 
FÜm©
::
	`¥rštf
(
buf
, "% ha bid %d gŞd.", 
ch
->
Çme
, 
Ãwb‘
);

260 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_AUCTION
, 0, 
	`GET_RANK
(ch));

264 ià(
auùiÚ
.
™em
 !ğ
nuÎ±r
) {

265 
	`aù
("Try‡gaš†©” - $°i bešg‡uùiÚed„ighˆnow!", 
ch
, 
auùiÚ
.
™em
, 
nuÎ±r
, 
TO_CHAR
);

271 
SŒšg
 
¬g2
;

272 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

275 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g1
)è=ğ
nuÎ±r
) {

276 
	`¡c
("You‡»n'ˆÿ¼yšgh©.\n", 
ch
);

281 ià(
obj
->
pIndexD©a
->
vnum
 =ğ
GEN_OBJ_FOOD
) {

282 
	`¡c
("Iˆlook toØd–iciou tØju¡‡uùiÚ‡way. :)\n", 
ch
);

287 
şª
 = 
şª_bË_h—d
->
Ãxt
;

289 
şª
 !ğ
şª_bË_
) {

290 ià(
obj
->
pIndexD©a
->
vnum
 >ğ
şª
->
¬—_mšvnum


291 && 
obj
->
pIndexD©a
->
vnum
 <ğ
şª
->
¬—_maxvnum
) {

292 
	`±c
(
ch
, "You‡ttempto‡uction %s, which belongso %s.\n"

295 
obj
->
shÜt_desü
,

296 
şª
->
şªÇme
,

297 
obj
->
shÜt_desü
);

298 
	`obj_äom_ch¬
(
obj
);

299 
	`exŒaù_obj
(
obj
);

303 
şª
 = cÏn->
Ãxt
;

306 ià(!
	`ÿn_drİ_obj
(
ch
, 
obj
)) {

307 
	`¡c
("Hah, you cª'ˆg‘„id oà™h©ƒasy!\n", 
ch
);

311 ià(
obj
->
pIndexD©a
->
vnum
 =ğ
OBJ_VNUM_NEWBIEBAG


312 || 
obj
->
pIndexD©a
->
vnum
 =ğ
OBJ_VNUM_TOKEN
) {

313 
	`¡c
("I'm sÜry, you cª'ˆauùiÚ‚ewb› i‹ms.\n", 
ch
);

317 ià(!
¬g2
.
	`em±y
()) {

318 ià(!
¬g2
.
	`is_numb”
()) {

319 
	`¡c
("Mšimum bid v®umu¡ bnum”ic.\n", 
ch
);

323 
mš
 = 
	`©oi
(
¬g2
);

325 ià(
mš
 < 1 || min > 10000) {

326 
	`¡c
("Thmšimum bid mu¡ bb‘w“À1‡nd 10000 gŞd.\n", 
ch
);

331 
obj
->
™em_ty³
) {

333 
	`aù
("You cªnÙ‡uùiÚ $Ts.", 
ch
, 
nuÎ±r
, 
	`™em_ty³_Çme
(
obj
), 
TO_CHAR
);

336 
ITEM_WEAPON
:

337 
ITEM_LIGHT
:

338 
ITEM_ARMOR
:

339 
ITEM_WAND
:

340 
ITEM_FOOD
:

341 
ITEM_STAFF
:

342 
ITEM_POTION
:

343 
ITEM_CONTAINER
:

344 
ITEM_DRINK_CON
:

345 
ITEM_BOAT
:

346 
ITEM_PILL
:

347 
ITEM_MAP
:

348 
ITEM_WARP_STONE
:

349 
ITEM_JEWELRY
:

350 
ITEM_SCROLL
:

351 
ITEM_TOKEN
:

352 
	`obj_äom_ch¬
(
obj
);

353 
auùiÚ
.
™em
 = 
obj
;

354 
auùiÚ
.
b‘
 = 0;

355 
auùiÚ
.
buy”
 = 
nuÎ±r
;

356 
auùiÚ
.
£Î”
 = 
ch
;

357 
auùiÚ
.
pul£
 = 
PULSE_AUCTION
;

358 
auùiÚ
.
gošg
 = 0;

359 
auùiÚ
.
mš
 = min;

361 ià(
auùiÚ
.
mš
 > 0)

362 
FÜm©
::
	`¥rštf
(
buf
, "The‡uctioneer„eceives %s‡nd‡nnounces‡ minimum bid of %d gold.\n",

363 
obj
->
shÜt_desü
, 
auùiÚ
.
mš
);

365 
FÜm©
::
	`¥rštf
(
buf
, "The‡uctioneer„eceives %s‡nd…laces it onhe‡uction block.\n",

366 
obj
->
shÜt_desü
);

368 
	`lk_auùiÚ
(
buf
);

369 
FÜm©
::
	`¥rštf
(
buf
, "% i auùiÚšg %s.", 
ch
->
Çme
, 
obj
->
shÜt_desü
);

370 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_AUCTION
, 0, 
	`GET_RANK
(ch));

373 
	}
}

	@src/Battle.cc

1 
	~"B©e.hh
"

3 
B©e
 
	gb©e
;

	@src/Character.cc

1 
	~"Ch¬aù”.hh
"

3 
	~"aù.hh
"

4 
	~"afãù/afãù_li¡.hh
"

5 
	~"afãù/Afãù.hh
"

6 
	~"A»a.hh
"

7 
	~"Ed™.hh
"

8 
	~"Ex™.hh
"

9 
	~"Game.hh
"

10 
	~"memÜy.hh
"

11 
	~"m”c.hh
"

12 
	~"MobePrÙÙy³.hh
"

13 
	~"Objeù.hh
"

14 
	~"¿ndom.hh
"

15 
	~"Room.hh
"

16 
	~"Ta.hh
"

17 
	~"MobProg.hh
"

19 
	gCh¬aù”
::
	$Ch¬aù”
() {

20 
logÚ
 = 
Game
::
cu¼’t_time
;

21 
lšes
 = 
PAGELEN
;

23 
i
 = 0; i < 4; i++)

24 
¬mÜ_ba£
[
i
] = 100;

26 
pos™iÚ
 = 
POS_STANDING
;

27 
h™
 = 
	`ATTR_BASE
(
this
, 
APPLY_HIT
) = 20;

28 
mªa
 = 
	`ATTR_BASE
(
this
, 
APPLY_MANA
) = 100;

29 
mªa
 = 
	`ATTR_BASE
(
this
, 
APPLY_STAM
) = 100;

31 
¡©
 = 0; sˆ< 
MAX_STATS
; stat++)

32 
	`ATTR_BASE
(
this
, 
	`¡©_to_©Œ
(
¡©
)) = 13;

33 
	}
}

35 
	gCh¬aù”
::~
	$Ch¬aù”
() {

36 
Objeù
 *
obj
, *
obj_Ãxt
;

37 
obj
 = 
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

38 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

39 
	`exŒaù_obj
(
obj
);

42 ià(
pcd©a
) {

43 
obj
 = 
pcd©a
->
lock”
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

44 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

45 
	`exŒaù_obj
(
obj
);

48 
obj
 = 
pcd©a
->
¡rÚgbox
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

49 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

50 
	`exŒaù_obj
(
obj
);

54 
afãù
::
	`ş—r_li¡
(&
afãùed
);

57 ià(!
this
->
	`is_Åc
(è&& 
pcd©a
 &&…cd©a->
šg
)

58 
	`£t_
(
this
, 
nuÎ±r
, 
TAIL_NONE
);

61 
Ta
 *
td
 = 

;d !ğ
nuÎ±r
;d =ail) {

62 

 = 
td
->
Ãxt
;

63 
	`aù
("You stİašg $n", 
this
, 
nuÎ±r
, 
td
->
ed_by
, 
TO_VICT
, 
POS_SLEEPING
, 
çl£
);

64 
d–‘e
 
td
;

67 

 = 
nuÎ±r
;

69 ià(
ed™
 !ğ
nuÎ±r
) {

70 
d–‘e
 
ed™
;

71 
ed™
 = 
nuÎ±r
;

74 ià(
pcd©a
 !ğ
nuÎ±r
)

75 
d–‘e
 
pcd©a
;

76 ià(
­¶y_ÿche
)

77 
d–‘e
[] 
­¶y_ÿche
;

78 ià(
deãn£_mod
)

79 
d–‘e
[] 
deãn£_mod
;

80 ià(
afãù_ÿche
)

81 
afãù
::
	`ä“_ÿche
(
this
);

82 
	}
}

84 
	gCh¬aù”
::
	$upd©e
() {

85 
Ch¬aù”
 *
ch
 = 
this
;

87 ià(!
ch
->
	`is_Åc
(è|| ch->
š_room
 =ğ
nuÎ±r
 || 
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
ch¬m_³rsÚ
))

90 ià(
	`g‘_pos™iÚ
(
ch
è<ğ
POS_SITTING
)

95 ià(
ch
->
š_room
->
	`¬—
().
	`num_¶ay”s
() == 0

96 && 
ch
->
š_room
->
	`¬—
().
	`num_imms
() == 0)

101 ià(
ch
->
¥ec_fun
 != 0) {

102 ià((*
ch
->
¥ec_fun
)(ch))

106 ià(
ch
->
pIndexD©a
->
pShİ
 !ğ
nuÎ±r
)

107 ià((
ch
->
gŞd
 * 100 + ch->
sv”
è< ch->
pIndexD©a
->
w—Éh
) {

108 
ch
->
gŞd
 +ğch->
pIndexD©a
->
w—Éh
 * 
	`numb”_¿nge
(1, 20) / 5000000;

109 
ch
->
sv”
 +ğch->
pIndexD©a
->
w—Éh
 * 
	`numb”_¿nge
(1, 20) / 50000;

114 
	`m´og_¿ndom_Œigg”
(
ch
);

119 ià(
ch
->
	`is_g¬bage
())

122 
	`m´og_¿ndom_¬—_Œigg”
(
ch
);

124 ià(
ch
->
	`is_g¬bage
())

129 ià(
	`g‘_pos™iÚ
(
ch
è!ğ
POS_STANDING
)

133 ià(
ch
->
aù_æags
.
	`has
(
ACT_SCAVENGER
)

134 && 
ch
->
š_room
->
cÚ‹Ás
 !ğ
nuÎ±r


135 && 
	`numb”_b™s
(6) == 0) {

136 
Ch¬aù”
 *
gch
;

137 
Objeù
 *
obj
;

138 
Objeù
 *
obj_be¡
 = 0;

139 
boŞ
 
nÙ_u£d
;

140 
max
 = 1;

142 
obj
 = 
ch
->
š_room
->
cÚ‹Ás
; obj; obj = obj->
Ãxt_cÚ‹Á
) {

143 
nÙ_u£d
 = 
Œue
;

145 
gch
 = 
obj
->
š_room
->
³İË
; gch !ğ
nuÎ±r
; gch = gch->
Ãxt_š_room
)

146 ià(
gch
->
Ú
 =ğ
obj
)

147 
nÙ_u£d
 = 
çl£
;

149 ià(
	`CAN_WEAR
(
obj
, 
ITEM_TAKE
è&& 
	`ÿn_loÙ
(
ch
, objè&& obj->
co¡
 > 
max
 && 
nÙ_u£d
) {

150 
obj_be¡
 = 
obj
;

151 
max
 = 
obj
->
co¡
;

155 ià(
obj_be¡
) {

156 
	`obj_äom_room
(
obj_be¡
);

157 
	`obj_to_ch¬
(
obj_be¡
, 
ch
);

158 
	`aù
("$Àg‘ $p.", 
ch
, 
obj_be¡
, 
nuÎ±r
, 
TO_ROOM
);

162 
doÜ
;

163 
Ex™
 *
³x™
;

166 ià(!
ch
->
aù_æags
.
	`has
(
ACT_SENTINEL
)

167 && 
	`numb”_b™s
(3) == 0

168 && (
doÜ
 = 
	`numb”_b™s
(5)) <= 5

169 && (
³x™
 = 
ch
->
š_room
->
ex™
[
doÜ
]è!ğ
nuÎ±r


170 && 
³x™
->
to_room
 !ğ
nuÎ±r


171 && !
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
)

172 && !
³x™
->
to_room
->
	`æags
().
	`has
(
ROOM_NO_MOB
)

173 && (!
ch
->
aù_æags
.
	`has
(
ACT_STAY_AREA
)

174 || 
³x™
->
to_room
->
	`¬—
(è=ğ
ch
->
š_room
->area())

175 && (!
ch
->
aù_æags
.
	`has
(
ACT_OUTDOORS
)

176 || !
³x™
->
to_room
->
	`æags
().
	`has
(
ROOM_INDOORS
))

177 && (!
ch
->
aù_æags
.
	`has
(
ACT_INDOORS
)

178 || 
³x™
->
to_room
->
	`æags
().
	`has
(
ROOM_INDOORS
))) {

179 
	`move_ch¬
(
ch
, 
doÜ
, 
çl£
);

185 ià(
	`g‘_pos™iÚ
(
ch
è< 
POS_STANDING
)

188 
	}
}

190 
boŞ
 
	gCh¬aù”
::

191 
	$has_cgroup
(cÚ¡ 
FÏgs
& 
cg
) const {

192  
this
->
	`is_Åc
(è? 
çl£
 : 
pcd©a
->
cgroup_æags
.
	`has_ªy_of
(
cg
);

193 
	}
}

195 
	gCh¬aù”
::

196 
	$add_cgroup
(cÚ¡ 
FÏgs
& 
cg
) {

197 ià(!
this
->
	`is_Åc
())

198 
pcd©a
->
cgroup_æags
 +ğ
cg
;

199 
	}
}

201 
	gCh¬aù”
::

202 
	$»move_cgroup
(cÚ¡ 
FÏgs
& 
cg
) {

203 ià(!
this
->
	`is_Åc
())

204 
pcd©a
->
cgroup_æags
 -ğ
cg
;

205 
	}
}

208 
	$GET_MAX_HIT
(
Ch¬aù”
 *
ch
)

210 
»suÉ
 = 0;

211 
ba£
 = (
	`GET_ATTR
(
ch
, 
APPLY_HIT
));

213 ià(
	`GET_ATTR
(
ch
, 
APPLY_HIT
) < 1){

214 
»suÉ
 = 1;

215  
»suÉ
;

217 ià(
	`GET_ATTR
(
ch
, 
APPLY_HIT
) > 30000){

218 
»suÉ
 = 30000;

219  
»suÉ
;

221 ià(
	`GET_ATTR
(
ch
, 
SET_PALADIN_GRACE
) >= 4){

222 
»suÉ
 = (
ba£
 + (base * 20 / 100));

223 ià(
»suÉ
 > 30000)

224 
»suÉ
 = 30000;

225  
»suÉ
;

228  
ba£
;

229 
	}
}

231 
	$GET_MAX_MANA
(
Ch¬aù”
 *
ch
)

233 
»suÉ
 = 0;

234 
ba£
 = (
	`GET_ATTR
(
ch
, 
APPLY_MANA
));

236 ià(
	`GET_ATTR
(
ch
, 
APPLY_MANA
) < 1){

237 
»suÉ
 = 1;

238  
»suÉ
;

240 ià(
	`GET_ATTR
(
ch
, 
APPLY_MANA
) > 30000){

241 
»suÉ
 = 30000;

242  
»suÉ
;

245  
ba£
;

246 
	}
}

248 
	$GET_MAX_STAM
(
Ch¬aù”
 *
ch
)

250 
»suÉ
 = 0;

251 
ba£
 = (
	`GET_ATTR
(
ch
, 
APPLY_STAM
));

253 ià(
	`GET_ATTR
(
ch
, 
APPLY_STAM
) < 1){

254 
»suÉ
 = 1;

255  
»suÉ
;

257 ià(
	`GET_ATTR
(
ch
, 
APPLY_STAM
) > 30000){

258 
»suÉ
 = 30000;

259  
»suÉ
;

262  
ba£
;

263 
	}
}

265 
	$GET_ATTR_AC
(
Ch¬aù”
 *
ch
)

267 
ba£
 = 
	`GET_ATTR
(
ch
, 
APPLY_AC
);

268 
mod
 = 0;

270 ià(
	`IS_AWAKE
(
ch
))

271 
ba£
 +ğ
dex_­p
[
	`GET_ATTR_DEX
(
ch
)].
deãnsive
;

272 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
»mÜt_couÁ
 > 0)

273 
ba£
 -ğ(
ch
->
pcd©a
->
»mÜt_couÁ
 * ch->
Ëv–
 / 50);

274 ià(!
ch
->
	`is_Åc
(è&& 
	`GET_ATTR
(ch, 
SET_PALADIN_GRACE
) >= 3)

275 
ba£
 += (base * 20 / 100 );

277  
ba£
;

278 
	}
}

280 
	$GET_AC
(
Ch¬aù”
 *
ch
, 
ty³
)

282  
ch
->
¬mÜ_ba£
[
ty³
] + 
	`GET_ATTR_AC
(ch);

283 
	}
}

	@src/Descriptor.cc

1 
	~"DesütÜ.hh
"

2 
	~"cÚn/S‹.hh
"

4 
	gDesütÜ
::

5 
	$DesütÜ
(è: 
	$¡©e
(&
cÚn
::
S‹
::
g‘Name
)

6 {
	}
}

8 
boŞ
 
DesütÜ
::

9 
	$is_¶ayšg
() const {

10  
¡©e
 =ğ&
cÚn
::
S‹
::
¶ayšg


11 && 
ch¬aù”
 !ğ
nuÎ±r
;

12 
	}
}

	@src/Disabled.cc

1 
	~"Di§bËd.hh
"

3 
	~"¬gum’t.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"š‹½.hh
"

6 
	~"Loggšg.hh
"

7 
	~"sql.hh
"

9 
Di§bËd
 *
	gdi§bËd_fœ¡
;

15 
boŞ
 
	$check_di§bËd
(cÚ¡ 
cmd_ty³
 *
commªd
)

17 
Di§bËd
 *
p
;

19 
p
 = 
di§bËd_fœ¡
;… ;… =…->
Ãxt
)

20 ià(
p
->
commªd
->
do_fun
 == command->do_fun)

21  
Œue
;

23  
çl£
;

24 
	}
}

26 
	$lßd_di§bËd
()

28 
Di§bËd
 *
p
;

29 
i
;

30 
di§bËd_fœ¡
 = 
nuÎ±r
;

32 ià(
	`db_qu”y
("lßd_di§bËd", "SELECT commªd, immÜl,„—sÚ FROM di§bËd"è!ğ
SQL_OK
)

35 
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

36 
i
 = 0; i < 
cmd_bË
.
	`size
(); i++)

37 ià(
cmd_bË
[
i
].
Çme
 =ğ
	`db_g‘_cŞumn_¡r
(0))

40 ià(
i
 >ğ
cmd_bË
.
	`size
()) {

41 
Loggšg
::
	`bug
("load_disabled: skipping uknown command", 0);

45 
p
 = 
Ãw
 
Di§bËd
;

46 
p
->
commªd
 = &
cmd_bË
[
i
];

47 
p
->
di§bËd_by
 = 
	`db_g‘_cŞumn_¡r
(1);

48 
p
->
»asÚ
 = 
	`db_g‘_cŞumn_¡r
(2);

49 
p
->
Ãxt
 = 
di§bËd_fœ¡
;

50 
di§bËd_fœ¡
 = 
p
;

52 
	}
}

54 
	$do_di§bË
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

56 
Di§bËd
 *
p
;

57 
i
;

59 
SŒšg
 
cmd
;

60 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
cmd
);

62 ià(
cmd
.
	`em±y
()) {

63 ià(!
di§bËd_fœ¡
) {

64 
	`¡c
("Th”¬nØcommªd di§bËd.\n", 
ch
);

68 
	`¡c
("Command {T|{xDisabled by {T|{xReason\n"

69 "{T--------------------|---------------|-----------------------------------------------{x\n", 
ch
);

71 
p
 = 
di§bËd_fœ¡
;…;… =…->
Ãxt
)

72 
	`±c
(
ch
, "%-20s{T|{x%-15s{T|{x%s\n", 
p
->
commªd
->
Çme
,…->
di§bËd_by
,…->
»asÚ
);

78 
p
 = 
di§bËd_fœ¡
;… ;… =…->
Ãxt
)

79 ià(
cmd
 =ğ
p
->
commªd
->
Çme
)

82 ià(
p
) {

83 ià(
di§bËd_fœ¡
 =ğ
p
)

84 
di§bËd_fœ¡
 = 
p
->
Ãxt
;

86 
Di§bËd
 *
q
;

88 
q
 = 
di§bËd_fœ¡
; q && q->
Ãxt
; q = q->next)

89 ià(
q
->
Ãxt
 =ğ
p
)

90 
q
->
Ãxt
 = 
p
->next;

94 
	`db_commªdf
("do_di§bË", "DELETE FROM di§bËd WHERE commªd LIKE '%s'", 
	`db_esc
(
p
->
commªd
->
Çme
));

95 
d–‘e
 
p
;

96 
	`¡c
("CommªdƒÇbËd.\n", 
ch
);

101 ià(
cmd
 == "disable") {

102 
	`¡c
("You cªnÙ di§bËhdi§bË commªd.\n", 
ch
);

106 ià(
¬gum’t
.
	`em±y
()) {

107 
	`¡c
("You mu¡…rovid¨»asÚ.\n", 
ch
);

111 ià(
	`¡¾’
(
¬gum’t
) > 45) {

112 
	`¡c
("PËa£†im™h»asÚØ45 ch¬aù” Ü†ess.\n", 
ch
);

116 
i
 = 0; i < 
cmd_bË
.
	`size
(); i++)

117 ià(
cmd
 =ğ
cmd_bË
[
i
].
Çme
)

120 ià(
cmd_bË
[
i
].
Çme
.
	`em±y
()) {

121 
	`¡c
("NØsuch commªd.\n", 
ch
);

126 
p
 = 
Ãw
 
Di§bËd
;

127 
p
->
commªd
 = &
cmd_bË
[
i
];

128 
p
->
di§bËd_by
 = 
ch
->
Çme
;

129 
p
->
»asÚ
 = 
¬gum’t
;

130 
p
->
Ãxt
 = 
di§bËd_fœ¡
;

131 
di§bËd_fœ¡
 = 
p
;

133 
	`db_commªdf
("do_disable", "INSERT INTO disabled VALUES('%s','%s','%s')",

134 
	`db_esc
(
p
->
commªd
->
Çme
), db_escÕ->
di§bËd_by
), db_escÕ->
»asÚ
));

135 
	`¡c
("Commªd di§bËd.\n", 
ch
);

136 
	}
}

	@src/Exit.cc

1 
	~"Ex™.hh
"

2 
	~"Ex™PrÙÙy³.hh
"

4 
	gEx™
::

5 
	$Ex™
(cÚ¡ 
Ex™PrÙÙy³
& 
´Ùo
, 
Room
 *
to_room
) :

6 
	`´ÙÙy³
(
´Ùo
),

7 
	`ex™_æags
(
´Ùo
.
ex™_æags
),

8 
	$to_room
(
to_room
)

10 
	}
}

12 
	gEx™
::

13 
	$key
() const {

14  
´ÙÙy³
.
key
;

15 
	}
}

17 cÚ¡ 
	gSŒšg
& 
	gEx™
::

18 
	$keywÜd
() const {

19  
´ÙÙy³
.
keywÜd
;

20 
	}
}

22 cÚ¡ 
	gSŒšg
& 
	gEx™
::

23 
	$desütiÚ
() const {

24  
´ÙÙy³
.
desütiÚ
;

25 
	}
}

	@src/ExitPrototype.cc

1 
	~"Ex™PrÙÙy³.hh
"

2 
	~"cÚ¡ªts.hh
"

3 
	~"fe.hh
"

5 
	gEx™PrÙÙy³
::

6 
	$Ex™PrÙÙy³
(
FILE
 *
å
) :

7 
	`desütiÚ
(
	`ä—d_¡ršg
(
å
)),

8 
	`keywÜd
(
	$ä—d_¡ršg
(
å
)) {

10 
locks
 = 
	`ä—d_numb”
(
å
);

11 
key
 = 
	`ä—d_numb”
(
å
);

12 
to_vnum
 = 
	`ä—d_numb”
(
å
);

14 
locks
) {

15 1: 
ex™_æags
 = 
EX_ISDOOR
; ;

16 2: 
ex™_æags
 = 
EX_ISDOOR
 | 
EX_PICKPROOF
; ;

17 3: 
ex™_æags
 = 
EX_ISDOOR
 | 
EX_NOPASS
; ;

18 4: 
ex™_æags
 = 
EX_ISDOOR
 | 
EX_NOPASS
 | 
EX_PICKPROOF
; ;

20 
	}
}

	@src/Flags.cc

1 
	~"FÏgs.hh
"

3 
	~"Loggšg.hh
"

4 
	~"SŒšg.hh
"

6 
	gFÏgs
::

7 
	$FÏgs
(cÚ¡ *
¡r
è: 
	`FÏgs
(
	$SŒšg
(
¡r
)è{
	}
}

9 
FÏgs
::

10 
	$FÏgs
(cÚ¡ 
SŒšg
& 
¡r
) {

11 cÚ¡ *
p
 = 
¡r
.
	`c_¡r
(); *p;…++) {

12 
c
 = *
p
;

14 ià(
c
 == '|') {

15 *
this
 +ğ
	`FÏgs
(
	`SŒšg
(
p
 + 1));

19 ià(
	`isdig™
(
c
)) {

20 
numb”
 = 0;

22 *
p
 && 
	`isdig™
(*p)) {

23 
numb”
 =‚umb” * 10 + *
p
 - '0';

24 
p
++;

28 
p
--;

30 *
this
 +ğ
	`FÏgs
(
numb”
);

35 ià(
c
 >ğ'A' && c <ğ'Z' && (ø- 'A'è< ()
b™s
.
	`size
()) {

36 
b™s
.
	`£t
(
c
 - 'A');

41 ià(
c
 >ğ'a' && c <ğ'z' && (ø- 'a'è< ()
b™s
.
	`size
() - 26) {

42 
b™s
.
	`£t
((
c
 - 'a') + 26);

46 
Loggšg
::
	`bugf
("FÏgs::FÏgs(SŒšg): unknowÀsymbŞ '%c' iÀ¡ršg", *
p
);

49 
	}
}

51 cÚ¡ 
SŒšg
 
	gFÏgs
::

52 
	$to_¡ršg
() const {

53 
SŒšg
 
buf
;

55 
i
 = 0; i < 
b™s
.
	`size
(); i++) {

56 ià(
b™s
[
i
]) {

57 ià(
i
 < 26)

58 
buf
 +ğ'A' + 
i
;

60 
buf
 +ğ'a' + (
i
 - 26);

65 ià(
buf
.
	`em±y
())

66 
buf
 = '0';

68  
buf
;

69 
	}
}

	@src/Game.cc

1 
	~"Game.hh
"

2 
	~"skl/skl.hh
"

3 
	~"Loggšg.hh
"

4 
	~"CÏn.hh
"

5 
	~"AuùiÚ.hh
"

6 
	~"Di§bËd.hh
"

7 
	~"NÙe.hh
"

8 
	~"MobProg.hh
"

9 
	~"music.hh
"

10 
	~"sql.hh
"

11 
	~"WÜld.hh
"

12 
	~"afãù/Afãù.hh
"

15 
	gGame
::
pÜt
;

16 
SŒšg
 
	gGame
::
mÙd
;

17 
SŒšg
 
	gGame
::
h–p_g»‘šg
;

18 
boŞ
 
	gGame
::
boÙšg
 = 
çl£
;

19 
time_t
 
	gGame
::
cu¼’t_time
 = 0;

20 
boŞ
 
	gGame
::
log_®l
 = 
çl£
;

21 
	gGame
::
»cÜd_logšs
 = 0;

22 
	gGame
::
»cÜd_¶ay”s
 = 0;

23 
	gGame
::
»cÜd_¶ay”s_sšû_boÙ
 = 0;

24 
	gGame
::
que¡_doubË
 = 
çl£
;

25 
boŞ
 
	gGame
::
wizlock
 = 
çl£
;

26 
boŞ
 
	gGame
::
Ãwlock
 = 
çl£
;

29 
	gWÜld
& 
	gGame
::

30 
	$wÜld
() {

31 
WÜld
 
w
;

32  
w
;

33 
	}
}

36 
	gGame
::

37 
	$boÙ
() {

38 
Game
::
boÙšg
 = 
Œue
;

41 
	`š™_mm
();

42 
	`š™_mm
();

45 
i
 = ()
skl
::
ty³
::
fœ¡
; i < ()skl::ty³::
size
; i++) {

46 cÚ¡‡utØ
unknown
 = 
skl
::
	`lookup
(skl::
ty³
::unknown);

48 ià(
skl
::
	`lookup
((skl::
ty³
)
i
).
Çme
 =ğ
unknown
.name) {

49 
Loggšg
::
	`bug
("Game::boÙ: uÇbËØfšd defš™iÚ fÜ skÈ’um %d.", 
i
);

50 
	`ex™
(1);

54 
i
 = ()
afãù
::
ty³
::
fœ¡
; i < (ïfãù::ty³::
size
; i++) {

55 cÚ¡‡utØ
unknown
 = 
afãù
::
	`lookup
×fãù::
ty³
::unknown);

57 ià(
afãù
::
	`lookup
(×fãù::
ty³
)
i
).
Çme
 =ğ
unknown
.name) {

58 
Loggšg
::
	`bug
("Game::boÙ: uÇbËØfšd defš™iÚ fÜ‡fãùƒnum %d.", 
i
);

59 
	`ex™
(1);

64 ià(!
	`wÜld
().
	`v®id
()) {

65 
	`ex™
(1);

69 
	`lßd_şª_bË
();

70 
FÜm©
::
	`´štf
("survived†oad_clan_table\n");

73 
auùiÚ
.
	`š™
();

76 
	`wÜld
().
	`lßd_¬—s
();

78 
	`wÜld
().
	`ü—‹_rooms
();

79 
FÜm©
::
	`´štf
("survived create_rooms\n");

81 
	`wÜld
().
	`ü—‹_ex™s
();

82 
FÜm©
::
	`´štf
("survived create_exits\n");

85 
	`wÜld
().
que¡
.
	`š™
();

87 
™em¦ßded
 = 
	`obj¡©e_lßd_™ems
();

88 
FÜm©
::
	`´štf
("survived obj¡©e_lßd_™em (%d)\n", 
™em¦ßded
);

91 
	`lßd_w¬_bË
();

92 
FÜm©
::
	`´štf
("survived†oad_war_table\n");

93 
	`lßd_w¬_ev’ts
();

94 
FÜm©
::
	`´štf
("survived†oad_war_events\n");

95 
	`lßd_¬’a_bË
();

96 
FÜm©
::
	`´štf
("survived†oad_arena_table\n");

98 
boÙšg
 = 
çl£
;

100 
	`wÜld
().
	`upd©e
();

101 
FÜm©
::
	`´štf
("survived‡rea_update\n");

102 
	`lßd_nÙes
();

103 
FÜm©
::
	`´štf
("survived†oad_notes\n");

104 
	`lßd_di§bËd
();

105 
FÜm©
::
	`´štf
("survived†oad_disabled\n");

106 
MOBŒigg”
 = 
Œue
;

107 
	`lßd_sÚgs
();

108 
FÜm©
::
	`´štf
("survived†oad_songs\n");

109 
	`lßd_socŸl_bË
();

110 
FÜm©
::
	`´štf
("survived†oad_social_table\n");

111 
	`lßd_¡Üage_li¡
();

112 
FÜm©
::
	`´štf
("survived†oad_storage_list\n");

113 
	`lßd_d•¬‹d_li¡
();

114 
FÜm©
::
	`´štf
("survived†oad_departed_list\n");

117 ià(
	`db_qu”y
("Game::boÙ", "SELECT†ogšs,…Ïy” FROM„ecÜds"è=ğ
SQL_OK
) {

118 ià(
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

119 
Game
::
»cÜd_logšs
 = 
	`db_g‘_cŞumn_št
(0);

120 
Game
::
»cÜd_¶ay”s
 = 
	`db_g‘_cŞumn_št
(1);

123 
Loggšg
::
	`bug
("Game::boot: failedo fetch„ecord†ogins‡nd…layers", 0);

127 ià(
	`db_qu”y
("Game::boÙ", "SELECTexˆFROM h–p WHERE keywÜds='GREETING'"è=ğ
SQL_OK
) {

128 ià(
	`db_Ãxt_row
(è=ğ
SQL_OK
)

129 
Game
::
h–p_g»‘šg
 = 
	`db_g‘_cŞumn_¡r
(0);

131 
Loggšg
::
	`bug
("Game::boot: failedo fetch greeting", 0);

132 
	`ex™
(1);

136 ià(
Game
::
h–p_g»‘šg
.
	`em±y
())

137 
Game
::
h–p_g»‘šg
 = "need‡ greeting!ƒnter your‚ame: ";

138 
	}
}

	@src/GameTime.cc

1 
	~"GameTime.hh
"

3 
	~"Ch¬aù”.hh
"

4 
	~"FÏgs.hh
"

5 
	~"FÜm©.hh
"

6 
	~"Game.hh
"

7 
	~"m”c.hh
"

8 
	~"Room.hh
"

9 
	~"SŒšg.hh
"

10 
	~"WÜld.hh
"

12 
	gGameTime
::

13 
	$GameTime
(
¡d
::
time_t
 
sy¡em_time
) {

14 
lhour
, 
lday
, 
lmÚth
;

15 
lhour
 = (
sy¡em_time
 - 650336715è/ (
PULSE_TICK
 / 
PULSE_PER_SECOND
);

16 
hour
 = 
lhour
 % 
MUD_DAY
;

17 
lday
 = 
lhour
 / 
MUD_DAY
;

18 
day
 = 
lday
 % 
MUD_MONTH
;

19 
lmÚth
 = 
lday
 / 
MUD_MONTH
;

20 
mÚth
 = 
lmÚth
 % 
MUD_YEAR
;

21 
y—r
 = 
lmÚth
 / 
MUD_YEAR
;

23 ià(
hour
 < 5è
suÆight
 = 
Night
;

24 ià(
hour
 < 6è
suÆight
 = 
SuÄi£
;

25 ià(
hour
 < 19è
suÆight
 = 
Day
;

26 ià(
hour
 < 20è
suÆight
 = 
Sun£t
;

27 
suÆight
 = 
Night
;

28 
	}
}

30 cÚ¡ 
	gSŒšg
& 
	gGameTime
::

31 
	$day_Çme
() const {

32 cÚ¡ 
SŒšg
 
days
[] = {

42  
days
[
day
 % 7];

43 
	}
}

45 cÚ¡ 
	gSŒšg
& 
	gGameTime
::

46 
	$mÚth_Çme
() const {

47 cÚ¡ 
SŒšg
 
mÚths
[] = {

56  
mÚths
[
mÚth
];

57 
	}
}

59 cÚ¡ 
SŒšg
 
	gGameTime
::

60 
	$day_¡ršg
() const {

61 
SŒšg
 
suffix
;

62 
iday
 = 
day
+1;

64 ià(
iday
 > 3 && iday < 20è
suffix
 = "th";

65 ià(
iday
 % 10 =ğ1è
suffix
 = "st";

66 ià(
iday
 % 10 =ğ2è
suffix
 = "nd";

67 ià(
iday
 % 10 =ğ3è
suffix
 = "rd";

68 
suffix
 = "th";

70  
FÜm©
::
	`fÜm©
("%d%s", 
iday
, 
suffix
);

71 
	}
}

73 
	gGameTime
::

74 
	$upd©e
() {

75 ++
hour
;

77 ià(
hour
 >ğ
MUD_DAY
) {

78 
hour
 = 0;

79 
day
++;

82 ià(
day
 >ğ
MUD_MONTH
) {

83 
day
 = 0;

84 
mÚth
++;

87 ià(
mÚth
 >ğ
MUD_YEAR
) {

88 
mÚth
 = 0;

89 
y—r
++;

92 
SŒšg
 
buf
;

94 
hour
) {

96 
suÆight
 = 
Day
;

97 
buf
 = 
FÜm©
::
	`fÜm©
("{BThera wakesohe Day of %s,\n%s ofhe Month of %s.{x\n",

98 
	`day_Çme
(), 
	`day_¡ršg
(), 
	`mÚth_Çme
());

99 
buf
 += "The Clocktower Bell„ings‡s‡nother day begins.\n";

103 
suÆight
 = 
SuÄi£
;

104 
buf
 = "The sun„ises inheƒast.\n";

108 
buf
 = "The Clocktower Bell signalshe midday.\n";

112 
suÆight
 = 
Sun£t
;

113 
buf
 = "The sun slowly disappears inhe west.\n";

117 
suÆight
 = 
Night
;

118 
buf
 = "The‚ight has begun.\n";

121 
MUD_DAY
:

122 
buf
 = "The Clocktower Bellolls, declaring midnight.\n";

126 autØ
ch
 : 
Game
::
	`wÜld
().
ch¬_li¡
)

128 ià(!
ch
->
	`is_Åc
()

129 && 
	`IS_OUTSIDE
(
ch
)

130 && 
	`IS_AWAKE
(
ch
)

131 && 
ch
->
aù_æags
.
	`has
(
PLR_TICKS
))

132 
	`¡c
(
buf
, 
ch
);

133 
	}
}

	@src/JSON/cJSON.cc

2 
	~"../d•s/cJSON/cJSON.h
"

3 
	~"JSON/cJSON.hh
"

5 
	~"Loggšg.hh
"

7 
cJSON
 * 
	gJSON
::
	$»ad_fe
(cÚ¡ 
SŒšg
& 
f’ame
) {

8 
FILE
 *
cf
;

9 
fsize
;

10 *
¡r
;

12 ià((
cf
 = 
	`fİ’
(
f’ame
.
	`c_¡r
(), "rb")è=ğ
nuÎ±r
) {

13 
Loggšg
::
	`bugf
("JSON::»ad_fe: Could‚Ù o³Àf'%s' fÜ„—dšg.", 
f’ame
);

14  
nuÎ±r
;

18 ià(
	`f£ek
(
cf
, 0, 
SEEK_END
è!ğ0 || (
fsize
 = 
	`á–l
(cf)) < 0) {

19 
Loggšg
::
	`bugf
("JSON::»ad_fe: E¼Ü iÀcomputšg sizoàf'%s'.", 
f’ame
);

20 
	`fşo£
(
cf
);

21  
nuÎ±r
;

24 
	`»wšd
(
cf
);

27 ià((
¡r
 = (*)
	`m®loc
(
fsize
 + 1)è=ğ
nuÎ±r
) {

28 
Loggšg
::
	`bugf
("JSON::»ad_fe: Could‚Ù‡Îoÿ‹ memÜyØ·r£ f'%s'.", 
f’ame
);

29 
	`fşo£
(
cf
);

30  
nuÎ±r
;

34 ià(
	`ä—d
(
¡r
, 1, 
fsize
, 
cf
) != ()fsize) {

35 
Loggšg
::
	`bugf
("JSON::»ad_fe: E¼Ü iÀ»adšg f'%s'.", 
f’ame
);

36 
	`fşo£
(
cf
);

37 
	`ä“
(
¡r
);

38  
nuÎ±r
;

41 
¡r
[
fsize
] = 0;

42 
	`fşo£
(
cf
);

44 
cJSON
 *
jsÚ
 = 
	`cJSON_P¬£
(
¡r
);

45 
	`ä“
(
¡r
);

48 ià(
jsÚ
 =ğ
nuÎ±r
) {

49 
Loggšg
::
	`bugf
("JSON::»ad_fe: F'%s',ƒ¼Ü befÜe: [%s]", 
f’ame
, 
	`cJSON_G‘E¼ÜPŒ
());

50  
nuÎ±r
;

53  
jsÚ
;

54 
	}
}

	@src/Logging.cc

1 
	~"Loggšg.hh
"

3 
	~"chªÃls.hh
"

4 
	~"FÏgs.hh
"

5 
	~"Game.hh
"

6 
	~"m”c.hh
"

7 
	~"SŒšg.hh
"

12 
	gLoggšg
::

13 
	$bug
(cÚ¡ 
SŒšg
& 
¡r
, 
·¿m
)

15 
SŒšg
 
buf
 = 
FÜm©
::
	`fÜm©
(
	`SŒšg
("[*****] BUG: "è+ 
¡r
, 
·¿m
);

16 
Loggšg
::
	`log
(
buf
);

17 
	`wizÃt
(
buf
, 
nuÎ±r
,‚uÎ±r, 
WIZ_BUGS
, 0, 0);

19 
	}
}

24 
	gLoggšg
::

25 
	$log
(cÚ¡ 
SŒšg
& 
¡r
)

27 *
¡¹ime
;

28 
¡¹ime
 = 
	`ùime
(&
Game
::
cu¼’t_time
);

29 
¡¹ime
[
	`¡¾’
(strtime) - 1] = '\0';

30 
FÜm©
::
	`årštf
(
¡d”r
, "% :: %s\n", 
¡¹ime
, 
¡r
);

32 
	}
}

34 
	gLoggšg
::

35 
	$fe_bug
(
FILE
 *
å
, cÚ¡ 
SŒšg
& 
¡r
, 
·¿m
)

37 ià(
å
 !ğ
nuÎ±r
) {

38 
iLše
 = 0;

39 
iCh¬
 = 0;

41 ià(
å
 !ğ
¡dš
) {

42 
iCh¬
 = 
	`á–l
(
å
);

43 
	`f£ek
(
å
, 0, 0);

45 
iLše
 = 0; 
	`á–l
(
å
è< 
iCh¬
; iLine++) {

46 
	`g‘c
(
å
) != '\n')

50 
	`f£ek
(
å
, 
iCh¬
, 0);

53 
Loggšg
::
	`bugf
("[*****] LINE: %d", 
iLše
);

56 
Loggšg
::
	`bugf
(
¡r
, 
·¿m
);

57 
	}
}

59 
	gLoggšg
::

60 
	$fe_bug
(
FILE
 *
å
, cÚ¡ 
SŒšg
& 
¡r
, cÚ¡ 
Vnum
& 
vnum
) {

61 
	`fe_bug
(
å
, 
¡r
, 
vnum
.
	`v®ue
());

62 
	}
}

	@src/MobProg.cc

1 
	~"MobProg.hh
"

2 
	~"fe.hh
"

4 
	gMobProg
::

5 
	$MobProg
(
FILE
 *
å
) {

6 
ty³
 = 
	`Çme_to_ty³
(
	`ä—d_wÜd
(
å
));

8 
ty³
) {

9 
ERROR_PROG
:

13 
¬gli¡
 = 
	`ä—d_¡ršg
(
å
);

14 
	`ä—d_to_eŞ
(
å
);

15 
comli¡
 = 
	`ä—d_¡ršg
(
å
);

16 
	`ä—d_to_eŞ
(
å
);

19 
	}
}

25 
	gFÏgs
::
B™
 
MobProg
::

26 
	$Çme_to_ty³
(cÚ¡ 
SŒšg
& 
Çme
) {

28 ià(
Çme
 =ğ"aù_´og"è 
ACT_PROG
;

29 ià(
Çme
 =ğ"¥“ch_´og"è 
SPEECH_PROG
;

30 ià(
Çme
 =ğ"¿nd_´og"è 
RAND_PROG
;

31 ià(
Çme
 =ğ"¿nd_¬—_´og"è 
RAND_AREA_PROG
;

32 ià(
Çme
 =ğ"boÙ_´og"è 
BOOT_PROG
;

33 ià(
Çme
 =ğ"fight_´og"è 
FIGHT_PROG
;

34 ià(
Çme
 =ğ"buy_´og"è 
BUY_PROG
;

35 ià(
Çme
 =ğ"h™´út_´og"è 
HITPRCNT_PROG
;

36 ià(
Çme
 =ğ"d—th_´og"è 
DEATH_PROG
;

37 ià(
Çme
 =ğ"’Œy_´og"è 
ENTRY_PROG
;

38 ià(
Çme
 =ğ"g»‘_´og"è 
GREET_PROG
;

39 ià(
Çme
 =ğ"®l_g»‘_´og"è 
ALL_GREET_PROG
;

40 ià(
Çme
 =ğ"give_´og"è 
GIVE_PROG
;

41 ià(
Çme
 =ğ"bribe_´og"è 
BRIBE_PROG
;

42 ià(
Çme
 =ğ"tick_´og"è 
TICK_PROG
;

44  (
ERROR_PROG
);

45 
	}
}

47 cÚ¡ 
SŒšg
 
	gMobProg
::

48 
	$ty³_to_Çme
(
FÏgs
::
B™
 
ty³
) {

49 
ty³
) {

51 
ACT_PROG
:  "act_prog";

52 
SPEECH_PROG
:  "speech_prog";

53 
RAND_PROG
:  "rand_prog";

54 
RAND_AREA_PROG
:  "rand_area_prog";

55 
BOOT_PROG
:  "boot_prog";

56 
FIGHT_PROG
:  "fight_prog";

57 
BUY_PROG
:  "buy_prog";

58 
HITPRCNT_PROG
:  "hitprcnt_prog";

59 
DEATH_PROG
:  "death_prog";

60 
ENTRY_PROG
:  "entry_prog";

61 
GREET_PROG
:  "greet_prog";

62 
ALL_GREET_PROG
:  "all_greet_prog";

63 
GIVE_PROG
:  "give_prog";

64 
BRIBE_PROG
:  "bribe_prog";

65 
TICK_PROG
:  "tick_prog";

68 
	}
}

	@src/MobilePrototype.cc

1 
	~"MobePrÙÙy³.hh
"

3 
	~"fe.hh
"

4 
	~"A»a.hh
"

5 
	~"lookup.hh
"

6 
	~"Loggšg.hh
"

7 
	~"m”c.hh
"

8 
	~"MobProg.hh
"

10 
	gMobePrÙÙy³
::

11 
	$MobePrÙÙy³
(
A»a
& 
¬—
, cÚ¡ 
Vnum
& 
vnum
, 
FILE
 *
å
) :

12 
	`¬—
(
¬—
),

13 
	$vnum
(
vnum
)

15 
¶ay”_Çme
 = 
	`ä—d_¡ršg
(
å
);

16 
shÜt_desü
 = 
	`ä—d_¡ršg
(
å
);

17 
lÚg_desü
 = 
	`ä—d_¡ršg
(
å
).
	`ÿp™®ize
();

18 
desütiÚ
 = 
	`ä—d_¡ršg
(
å
).
	`ÿp™®ize
();

19 
¿û
 = 
	`¿û_lookup
(
	`ä—d_¡ršg
(
å
));

20 
aù_æags
 = 
	`ä—d_æag
(
å
è+ 
¿û_bË
[
¿û
].
aù
;

23 
afãù_æags
 = 
	`ä—d_æag
(
å
è- 
¿û_bË
[
¿û
].
aff
;

25 
®ignm’t
 = 
	`ä—d_numb”
(
å
);

26 
group_æags
 = 
	`ä—d_æag
(
å
);

27 
Ëv–
 = 
	`ä—d_numb”
(
å
);

28 
h™rŞl
 = 
	`ä—d_numb”
(
å
);

30 
h™
[
DICE_NUMBER
] = 
	`ä—d_numb”
(
å
);

31  
	`ä—d_Ë‰”
(
å
);

32 
h™
[
DICE_TYPE
] = 
	`ä—d_numb”
(
å
);

33  
	`ä—d_Ë‰”
(
å
);

34 
h™
[
DICE_BONUS
] = 
	`ä—d_numb”
(
å
);

36 
mªa
[
DICE_NUMBER
] = 
	`ä—d_numb”
(
å
);

37 
	`ä—d_Ë‰”
(
å
);

38 
mªa
[
DICE_TYPE
] = 
	`ä—d_numb”
(
å
);

39 
	`ä—d_Ë‰”
(
å
);

40 
mªa
[
DICE_BONUS
] = 
	`ä—d_numb”
(
å
);

42 
damage
[
DICE_NUMBER
] = 
	`ä—d_numb”
(
å
);

43 
	`ä—d_Ë‰”
(
å
);

44 
damage
[
DICE_TYPE
] = 
	`ä—d_numb”
(
å
);

45 
	`ä—d_Ë‰”
(
å
);

46 
damage
[
DICE_BONUS
] = 
	`ä—d_numb”
(
å
);

47 
dam_ty³
 = 
	`©ck_lookup
(
	`ä—d_wÜd
(
å
));

49 
ac
[
AC_PIERCE
] = 
	`ä—d_numb”
(
å
) * 10;

50 
ac
[
AC_BASH
] = 
	`ä—d_numb”
(
å
) * 10;

51 
ac
[
AC_SLASH
] = 
	`ä—d_numb”
(
å
) * 10;

52 
ac
[
AC_EXOTIC
] = 
	`ä—d_numb”
(
å
) * 10;

54 
off_æags
 = 
	`ä—d_æag
(
å
è+ 
¿û_bË
[
¿û
].
off
;

57 
absÜb_æags
 = 0;

58 
imm_æags
 = 
	`ä—d_æag
(
å
è- 
¿û_bË
[
¿û
].
imm
;

59 
»s_æags
 = 
	`ä—d_æag
(
å
è- 
¿û_bË
[
¿û
].
»s
;

60 
vuÊ_æags
 = 
	`ä—d_æag
(
å
è- 
¿û_bË
[
¿û
].
vuÊ
;

63 
aù_æags
 -ğ
FÏgs
::
A
;

66 ià(
imm_æags
.
	`has
(
FÏgs
::
A
))

67 
aù_æags
 +ğ
ACT_NOSUMMON
;

68 
imm_æags
 -ğ
FÏgs
::
A
;

69 
»s_æags
 -ğ
FÏgs
::
A
;

70 
vuÊ_æags
 -ğ
FÏgs
::
A
;

73 
¡¬t_pos
 = 
	`pos™iÚ_lookup
(
	`ä—d_wÜd
(
å
));

75 ià(
¡¬t_pos
 =ğ
POS_STANDING
 && 
afãù_æags
.
	`has
(
AFF_FLYING
))

76 
¡¬t_pos
 = 
POS_FLYING
;

78 
deçuÉ_pos
 = 
	`pos™iÚ_lookup
(
	`ä—d_wÜd
(
å
));

80 ià(
deçuÉ_pos
 =ğ
POS_STANDING
 && 
afãù_æags
.
	`has
(
AFF_FLYING
))

81 
deçuÉ_pos
 = 
POS_FLYING
;

83 
£x
 = 
	`£x_lookup
(
	`ä—d_wÜd
(
å
));

85 ià(
£x
 < 0) {

86 
Loggšg
::
	`bugf
("Lßd_mobes: bad sex fÜ vnum %d.", 
vnum
);

87 
	`ex™
(1);

90 
w—Éh
 = 
	`ä—d_numb”
(
å
);

91 
fÜm_æags
 = 
	`ä—d_æag
(
å
è+ 
¿û_bË
[
¿û
].
fÜm
;

92 
·¹s_æags
 = 
	`ä—d_æag
(
å
è+ 
¿û_bË
[
¿û
].
·¹s
;

94 
size
 = 
	`size_lookup
(
	`ä—d_wÜd
(
å
));

96 ià(
size
 < 0) {

97 
Loggšg
::
	`bugf
("Lßd_mobes: bad sizfÜ vnum %d.", 
vnum
);

98 
	`ex™
(1);

101 
m©”Ÿl
 = 
	`ä—d_wÜd
(
å
);

104 
Ë‰”
 = 
	`ä—d_Ë‰”
(
å
);

106 ià(
Ë‰”
 == 'F') {

107 
SŒšg
 
wÜd
 = 
	`ä—d_wÜd
(
å
);

108 
FÏgs
 
veùÜ
 = 
	`ä—d_æag
(
å
);

110 ià(
wÜd
.
	`is_´efix_of
("aù")è
aù_æags
 -ğ
veùÜ
;

111 ià(
wÜd
.
	`is_´efix_of
("aff")è
afãù_æags
 -ğ
veùÜ
;

112 ià(
wÜd
.
	`is_´efix_of
("off")è
off_æags
 -ğ
veùÜ
;

113 ià(
wÜd
.
	`is_´efix_of
("dº")è
absÜb_æags
 -ğ
veùÜ
;

114 ià(
wÜd
.
	`is_´efix_of
("imm")è
imm_æags
 -ğ
veùÜ
;

115 ià(
wÜd
.
	`is_´efix_of
("»s")è
»s_æags
 -ğ
veùÜ
;

116 ià(
wÜd
.
	`is_´efix_of
("vul")è
vuÊ_æags
 -ğ
veùÜ
;

117 ià(
wÜd
.
	`is_´efix_of
("fÜ")è
fÜm_æags
 -ğ
veùÜ
;

118 ià(
wÜd
.
	`is_´efix_of
("·r")è
·¹s_æags
 -ğ
veùÜ
;

120 
Loggšg
::
	`fe_bug
(
å
, "Flag„emove: flag‚ot found.", 0);

121 
	`ex™
(1);

125 
	`ung‘c
(
Ë‰”
, 
å
);

130 
	`»ad_mob´ogs
(
å
);

131 
	}
}

133 
	gMobePrÙÙy³
::

134 ~
	$MobePrÙÙy³
() {

135 autØ
mob´og
 : 
mob´ogs
)

136 
d–‘e
 
mob´og
;

137 
	}
}

139 
	gMobePrÙÙy³
::

140 
	$»ad_mob´ogs
(
FILE
 *
å
) {

141 
Œue
) {

142 
Ë‰”
 = 
	`ä—d_Ë‰”
(
å
);

144 ià(
Ë‰”
 != '>') {

145 ià(
Ë‰”
 != '|')

146 
	`ung‘c
(
Ë‰”
, 
å
);

151 
MobProg
 *
m´g
 = 
Ãw
 
	`MobProg
(
å
);

153 ià(
m´g
->
ty³
 =ğ
ERROR_PROG
) {

154 
Loggšg
::
	`fe_bug
(
å
, "Lßd_mobes: vnum %d inv®id MOBPROGy³.", 
vnum
);

155 
	`ex™
(1);

158 
mob´ogs
.
	`push_back
(
m´g
);

159 
´ogty³_æags
 +ğ
m´g
->
ty³
;

161 
	}
}

	@src/Note.cc

28 
	~"NÙe.hh
"

30 
	~<c¡ršg
>

31 
	~<veùÜ
>

33 
	~"¬gum’t.hh
"

34 
	~"chªÃls.hh
"

35 
	~"Ch¬aù”.hh
"

36 
	~"CÏn.hh
"

37 
	~"fe.hh
"

38 
	~"FÏgs.hh
"

39 
	~"FÜm©.hh
"

40 
	~"Game.hh
"

41 
	~"Loggšg.hh
"

42 
	~"memÜy.hh
"

43 
	~"m”c.hh
"

44 
	~"PÏy”.hh
"

45 
	~"WÜld.hh
"

49 
lßd_th»ad
(*
Çme
, 
NÙe
 **
li¡
, 
ty³
, 
time_t
 
ä“_time
);

50 
·r£_nÙe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
, 
ty³
);

51 
boŞ
 
hide_nÙe
(
Ch¬aù”
 *
ch
, 
NÙe
 *
²Ùe
);

53 
NÙe
 *
	gnÙe_li¡
;

54 
NÙe
 *
	gid—_li¡
;

55 
NÙe
 *
	grŞ•Ïy_li¡
;

56 
NÙe
 *
	gimmque¡_li¡
;

57 
NÙe
 *
	gchªges_li¡
;

58 
NÙe
 *
	g³rsÚ®_li¡
;

59 
NÙe
 *
	gŒade_li¡
;

63 cÚ¡ 
	g¡d
::
veùÜ
<
bßrd_šdex_¡ruù
> 
bßrd_šdex
 = {

64 { "{PN", &
nÙe_li¡
, "note", "notes", "note" },

65 { "{YI", &
id—_li¡
, "idea", "ideas", "idea" },

66 { "{VR", &
rŞ•Ïy_li¡
, "roleplay", "roleplays", "roleplaying‚ote" },

67 { "{BQ", &
immque¡_li¡
, "immquest", "immquests", "quest‚ote" },

68 { "{GC", &
chªges_li¡
, "change", "changes", "change" },

69 { "{CP", &
³rsÚ®_li¡
, "personal message", "personal messages", "personal message" },

70 { "{bT", &
Œade_li¡
, "trade‚ote", "trade‚otes", "trade‚ote" },

74 
	$couÁ_¥oŞ
(
Ch¬aù”
 *
ch
, 
NÙe
 *
¥oŞ
)

76 
couÁ
 = 0;

77 
NÙe
 *
²Ùe
;

79 
²Ùe
 = 
¥oŞ
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
)

80 ià(!
	`hide_nÙe
(
ch
, 
²Ùe
))

81 
couÁ
++;

83  
couÁ
;

84 
	}
}

87 
	$do_uÄ—d
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

89 
couÁ
;

90 
boŞ
 
found
 = 
çl£
;

92 ià(
ch
->
	`is_Åc
()) {

93 
	`¡c
("SÜry, oÆy…Ïy” ÿÀ»ad‚Ùes!\n", 
ch
);

97 ià((
couÁ
 = 
	`couÁ_¥oŞ
(
ch
, 
immque¡_li¡
)) > 0) {

98 
found
 = 
Œue
;

99 
	`±c
(
ch
, "There %s %d‚ew {Bimmquest{x‚ote%s waiting.\n",

100 
couÁ
 > 1 ? "are" : "is",

101 
couÁ
,

102 
couÁ
 > 1 ? "s" : "");

105 ià((
couÁ
 = 
	`couÁ_¥oŞ
(
ch
, 
chªges_li¡
)) > 0) {

106 
found
 = 
Œue
;

107 
	`±c
(
ch
, "There %s %d {Gchange%s{x waitingo be„ead.\n",

108 
couÁ
 > 1 ? "are" : "is",

109 
couÁ
,

110 
couÁ
 > 1 ? "s" : "");

113 ià((
couÁ
 = 
	`couÁ_¥oŞ
(
ch
, 
nÙe_li¡
)) > 0) {

114 
found
 = 
Œue
;

115 
	`±c
(
ch
, "You have %d‚ew {Pnote%s{x waiting.\n",

116 
couÁ
,

117 
couÁ
 > 1 ? "s" : "");

120 ià((
couÁ
 = 
	`couÁ_¥oŞ
(
ch
, 
id—_li¡
)) > 0) {

121 
found
 = 
Œue
;

122 
	`±c
(
ch
, "You have %d unread {Yidea%s{xo…ursue.\n",

123 
couÁ
,

124 
couÁ
 > 1 ? "s" : "");

127 ià((
couÁ
 = 
	`couÁ_¥oŞ
(
ch
, 
rŞ•Ïy_li¡
)) > 0) {

128 
found
 = 
Œue
;

129 
	`±c
(
ch
, "%d {Vroleplay%s been‡dded.\n",

130 
couÁ
,

131 
couÁ
 > 1 ? "ing{x‚otes have" : "{x‚ote has");

134 ià((
couÁ
 = 
	`couÁ_¥oŞ
(
ch
, 
³rsÚ®_li¡
)) > 0) {

135 
found
 = 
Œue
;

136 
	`±c
(
ch
, "You have %d {Cpersonal{x message%so„ead.\n",

137 
couÁ
,

138 
couÁ
 > 1 ? "s" : "");

141 ià((
couÁ
 = 
	`couÁ_¥oŞ
(
ch
, 
Œade_li¡
)) > 0) {

142 
found
 = 
Œue
;

143 
	`±c
(
ch
, "You have %d {btrade{x‚ote%so„ead.\n",

144 
couÁ
,

145 
couÁ
 > 1 ? "s" : "");

148 ià(!
found
)

149 
	`¡c
("You havnØuÄ—d‚Ùes.\n", 
ch
);

151 
	`¡c
("Ty³: {Y<Ãxt>{xØsüŞÈthrough you¸mes§ges.\n", 
ch
);

152 
	`¡c
("Ty³: {Y<nÙwe>{xØem±y‡Î mes§gbßrds.\n", 
ch
);

154 
	}
}

156 
	$do_nÙe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

158 
	`·r£_nÙe
(
ch
, 
¬gum’t
, 
NOTE_NOTE
);

159 
	}
}

161 
	$do_id—
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

163 
	`·r£_nÙe
(
ch
, 
¬gum’t
, 
NOTE_IDEA
);

164 
	}
}

166 
	$do_³rsÚ®
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

168 
	`·r£_nÙe
(
ch
, 
¬gum’t
, 
NOTE_PERSONAL
);

169 
	}
}

171 
	$do_rŞ•Ïy
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

173 
	`·r£_nÙe
(
ch
, 
¬gum’t
, 
NOTE_ROLEPLAY
);

174 
	}
}

176 
	$do_immque¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

178 
	`·r£_nÙe
(
ch
, 
¬gum’t
, 
NOTE_IMMQUEST
);

179 
	}
}

181 
	$do_chªges
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

183 
	`·r£_nÙe
(
ch
, 
¬gum’t
, 
NOTE_CHANGES
);

184 
	}
}

186 
	$do_Œade
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

188 
	`·r£_nÙe
(
ch
, 
¬gum’t
, 
NOTE_TRADE
);

189 
	}
}

191 
	$§ve_nÙes
(
ty³
)

193 
FILE
 *
å
;

194 *
Çme
;

195 
NÙe
 *
²Ùe
;

197 
ty³
) {

201 
NOTE_NOTE
:

202 
Çme
 = 
NOTE_FILE
;

203 
²Ùe
 = 
nÙe_li¡
;

206 
NOTE_IDEA
:

207 
Çme
 = 
IDEA_FILE
;

208 
²Ùe
 = 
id—_li¡
;

211 
NOTE_ROLEPLAY
:

212 
Çme
 = 
ROLEPLAY_FILE
;

213 
²Ùe
 = 
rŞ•Ïy_li¡
;

216 
NOTE_IMMQUEST
:

217 
Çme
 = 
IMMQUEST_FILE
;

218 
²Ùe
 = 
immque¡_li¡
;

221 
NOTE_CHANGES
:

222 
Çme
 = 
CHANGES_FILE
;

223 
²Ùe
 = 
chªges_li¡
;

226 
NOTE_PERSONAL
:

227 
Çme
 = 
PERSONAL_FILE
;

228 
²Ùe
 = 
³rsÚ®_li¡
;

231 
NOTE_TRADE
:

232 
Çme
 = 
TRADE_FILE
;

233 
²Ùe
 = 
Œade_li¡
;

237 ià((
å
 = 
	`fİ’
(
Çme
, "w")è=ğ
nuÎ±r
)

238 
	`³¼Ü
(
Çme
);

240 ; 
²Ùe
 !ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

241 
FÜm©
::
	`årštf
(
å
, "S’d” %s~\n", 
²Ùe
->
£nd”
);

242 
FÜm©
::
	`årštf
(
å
, "D© %s~\n", 
²Ùe
->
d©e
);

243 
FÜm©
::
	`årštf
(
å
, "Sm° %ld\n", 
²Ùe
->
d©e_¡amp
);

244 
FÜm©
::
	`årštf
(
å
, "TØ %s~\n", 
²Ùe
->
to_li¡
);

245 
FÜm©
::
	`årštf
(
å
, "Subjeù %s~\n", 
²Ùe
->
subjeù
);

246 
FÜm©
::
	`årštf
(
å
, "Text\n%s~\n", 
²Ùe
->
‹xt
);

249 
	`fşo£
(
å
);

252 
	}
}

254 
	$lßd_nÙes
()

265 
	`lßd_th»ad
(
NOTE_FILE
, &
nÙe_li¡
, 
NOTE_NOTE
, 0);

266 
	`lßd_th»ad
(
IDEA_FILE
, &
id—_li¡
, 
NOTE_IDEA
, 0);

267 
	`lßd_th»ad
(
ROLEPLAY_FILE
, &
rŞ•Ïy_li¡
, 
NOTE_ROLEPLAY
, 0);

268 
	`lßd_th»ad
(
IMMQUEST_FILE
, &
immque¡_li¡
, 
NOTE_IMMQUEST
, 0);

269 
	`lßd_th»ad
(
CHANGES_FILE
, &
chªges_li¡
, 
NOTE_CHANGES
, 0);

270 
	`lßd_th»ad
(
PERSONAL_FILE
, &
³rsÚ®_li¡
, 
NOTE_PERSONAL
, 0);

271 
	`lßd_th»ad
(
TRADE_FILE
, &
Œade_li¡
, 
NOTE_TRADE
, 0);

272 
	}
}

274 
	$lßd_th»ad
(*
Çme
, 
NÙe
 **
li¡
, 
ty³
, 
time_t
 
ä“_time
)

276 
FILE
 *
å
;

277 
NÙe
 *
²Ùe
, *
²Ù–a¡
;

279 ià((
å
 = 
	`fİ’
(
Çme
, "r")è=ğ
nuÎ±r
)

282 
²Ù–a¡
 = 
nuÎ±r
;

285 
Ë‰”
;

288 
Ë‰”
 = 
	`g‘c
(
å
);

290 ià(
	`ãof
(
å
)) {

291 
	`fşo£
(
å
);

295 
	`is¥aû
(
Ë‰”
));

297 
	`ung‘c
(
Ë‰”
, 
å
);

298 
²Ùe
 = 
Ãw
 
	`NÙe
();

300 ià(
	`ä—d_wÜd
(
å
) != "sender")

303 
²Ùe
->
£nd”
 = 
	`ä—d_¡ršg
(
å
);

305 ià(
	`ä—d_wÜd
(
å
) != "date")

308 
²Ùe
->
d©e
 = 
	`ä—d_¡ršg
(
å
);

310 ià(
	`ä—d_wÜd
(
å
) != "stamp")

313 
²Ùe
->
d©e_¡amp
 = 
	`ä—d_numb”
(
å
);

315 ià(
	`ä—d_wÜd
(
å
) != "to")

318 
²Ùe
->
to_li¡
 = 
	`ä—d_¡ršg
(
å
);

320 ià(
	`ä—d_wÜd
(
å
) != "subject")

323 
²Ùe
->
subjeù
 = 
	`ä—d_¡ršg
(
å
);

325 ià(
	`ä—d_wÜd
(
å
) != "text")

328 
²Ùe
->
‹xt
 = 
	`ä—d_¡ršg
(
å
);

330 ià(
ä“_time
 && (
²Ùe
->
d©e_¡amp
 < 
Game
::
cu¼’t_time
 - free_time)) {

331 
d–‘e
 
²Ùe
;

335 
²Ùe
->
ty³
 =ype;

337 ià(*
li¡
 =ğ
nuÎ±r
)

338 *
li¡
 = 
²Ùe
;

340 
²Ù–a¡
->
Ãxt
 = 
²Ùe
;

342 
²Ù–a¡
 = 
²Ùe
;

346 
d–‘e
 
²Ùe
;

348 
Loggšg
::
	`fe_bug
(
å
, "Load_notes: bad key word.", 0);

349 
	`ex™
( 1 );

351 
	}
}

353 
	$­³nd_nÙe
(
NÙe
 *
²Ùe
)

355 
FILE
 *
å
;

356 *
Çme
;

357 
NÙe
 **
li¡
;

358 
NÙe
 *
Ï¡
;

360 
²Ùe
->
ty³
) {

364 
NOTE_NOTE
:

365 
Çme
 = 
NOTE_FILE
;

366 
li¡
 = &
nÙe_li¡
;

369 
NOTE_IDEA
:

370 
Çme
 = 
IDEA_FILE
;

371 
li¡
 = &
id—_li¡
;

374 
NOTE_ROLEPLAY
:

375 
Çme
 = 
ROLEPLAY_FILE
;

376 
li¡
 = &
rŞ•Ïy_li¡
;

379 
NOTE_IMMQUEST
:

380 
Çme
 = 
IMMQUEST_FILE
;

381 
li¡
 = &
immque¡_li¡
;

384 
NOTE_CHANGES
:

385 
Çme
 = 
CHANGES_FILE
;

386 
li¡
 = &
chªges_li¡
;

389 
NOTE_PERSONAL
:

390 
Çme
 = 
PERSONAL_FILE
;

391 
li¡
 = &
³rsÚ®_li¡
;

394 
NOTE_TRADE
:

395 
Çme
 = 
TRADE_FILE
;

396 
li¡
 = &
Œade_li¡
;

400 ià(*
li¡
 =ğ
nuÎ±r
)

401 *
li¡
 = 
²Ùe
;

403 
Ï¡
 = *
li¡
;†a¡->
Ãxt
 !ğ
nuÎ±r
;†ast =†ast->next);

405 
Ï¡
->
Ãxt
 = 
²Ùe
;

408 ià((
å
 = 
	`fİ’
(
Çme
, "a")è=ğ
nuÎ±r
)

409 
	`³¼Ü
(
Çme
);

411 
FÜm©
::
	`årštf
(
å
, "S’d” %s~\n", 
²Ùe
->
£nd”
.
	`»¶aû
("~", "-"));

412 
FÜm©
::
	`årštf
(
å
, "D© %s~\n", 
²Ùe
->
d©e
);

413 
FÜm©
::
	`årštf
(
å
, "Sm° %ld\n", 
²Ùe
->
d©e_¡amp
);

414 
FÜm©
::
	`årštf
(
å
, "TØ %s~\n", 
²Ùe
->
to_li¡
.
	`»¶aû
("~", "-"));

415 
FÜm©
::
	`årštf
(
å
, "Subjeù %s~\n", 
²Ùe
->
subjeù
.
	`»¶aû
("~", "-"));

416 
FÜm©
::
	`årštf
(
å
, "Text\n%s~\n", 
²Ùe
->
‹xt
.
	`»¶aû
("~", "-"));

417 
	`fşo£
(
å
);

420 
	}
}

422 
boŞ
 
	$is_nÙe_to
(
Ch¬aù”
 *
ch
, 
NÙe
 *
²Ùe
)

424 
buf
[
MSL
];

426 
FÜm©
::
	`¥rštf
(
buf
, "FORWARD(%s)", 
ch
->
Çme
);

428 ià(
¡d
::
	`¡r¡r
(
buf
, 
²Ùe
->
subjeù
.
	`uncŞÜ
().
	`c_¡r
()))

429  
çl£
;

432 ià(
²Ùe
->
to_li¡
.
	`has_wÜds
("followers")) {

433 
i
 = 
	`·r£_de™y
(
ch
->
pcd©a
->
de™y
);

435 ià(
i
 >ğ0 && 
²Ùe
->
£nd”
 =ğ
de™y_bË
[i].
Çme
)

436  
Œue
;

439 ià(
ch
->
Çme
 =ğ
²Ùe
->
£nd”
)

440  
Œue
;

442 ià(
²Ùe
->
to_li¡
.
	`has_wÜds
("spam")) {

443 ià(
ch
->
ûnsÜ_æags
.
	`has
(
CENSOR_SPAM
))

444  
çl£
;

446  
Œue
;

449 ià(
²Ùe
->
to_li¡
.
	`has_exaù_wÜds
("all"))

450  
Œue
;

452 ià(
	`IS_IMP
(
ch
è&& 
²Ùe
->
to_li¡
.
	`has_wÜds
("imp"))

453  
Œue
;

455 ià(
	`IS_HEAD
(
ch
è&& 
²Ùe
->
to_li¡
.
	`has_wÜds
("head"))

456  
Œue
;

458 ià(
	`IS_IMMORTAL
(
ch
)

459 && (
²Ùe
->
to_li¡
.
	`has_wÜds
("immortal")

460 || 
²Ùe
->
to_li¡
.
	`has_wÜds
("imm")))

461  
Œue
;

463 ià(
²Ùe
->
to_li¡
.
	`has_exaù_wÜds
(
ch
->
Çme
))

464  
Œue
;

467 ià(
ch
->
şª


468 && (
²Ùe
->
to_li¡
.
	`has_exaù_wÜds
(
ch
->
şª
->
Çme
)

469 || 
²Ùe
->
to_li¡
.
	`has_wÜds
("clan"))) {

470 ià(
²Ùe
->
to_li¡
.
	`has_wÜds
("leader"))

471 ià(!
ch
->
	`has_cgroup
(
GROUP_LEADER
))

472  
çl£
;

474 ià(
²Ùe
->
to_li¡
.
	`has_wÜds
("deputy")

475 || 
²Ùe
->
to_li¡
.
	`has_wÜds
("deputies"))

476 ià(!
ch
->
	`has_cgroup
(
GROUP_LEADER
)

477 && !
ch
->
	`has_cgroup
(
GROUP_DEPUTY
))

478  
çl£
;

480  
Œue
;

483  
çl£
;

484 
	}
}

486 
	$nÙe_©ch
(
Ch¬aù”
 *
ch
, 
ty³
)

488 
NÙe
 *
²Ùe
;

490 ià(
ch
->
²Ùe
 !ğ
nuÎ±r
)

493 
²Ùe
 = 
Ãw
 
	`NÙe
();

494 
²Ùe
->
£nd”
 = 
ch
->
	`is_Åc
(è? ch->
shÜt_desü
 : ch->
Çme
;

495 
²Ùe
->
ty³
 =ype;

496 
ch
->
²Ùe
 =…note;

498 
	}
}

500 
	$nÙe_»move
(
Ch¬aù”
 *
ch
, 
NÙe
 *
²Ùe
, 
boŞ
 
d–
)

502 
NÙe
 *
´ev
;

503 
NÙe
 **
li¡
;

505 ià(!
d–
) {

507 
SŒšg
 
to_Ãw
, 
to_li¡
 = 
²Ùe
->to_list;

509 !
to_li¡
.
	`em±y
()) {

510 
SŒšg
 
to_Úe
;

511 
to_li¡
 = 
	`Úe_¬gum’t
Ño_li¡, 
to_Úe
);

513 ià(!
to_Úe
.
	`em±y
(è&& 
ch
->
Çme
 !=o_one) {

514 
to_Ãw
 += " ";

515 
to_Ãw
 +ğ
to_Úe
;

520 ià(
ch
->
Çme
 !ğ
²Ùe
->
£nd”
 && !
to_Ãw
.
	`em±y
()) {

521 
²Ùe
->
to_li¡
 = 
to_Ãw
.
	`sub¡r
(1);

528 
²Ùe
->
ty³
) {

532 
NOTE_NOTE
:

533 
li¡
 = &
nÙe_li¡
;

536 
NOTE_IDEA
:

537 
li¡
 = &
id—_li¡
;

540 
NOTE_ROLEPLAY
:

541 
li¡
 = &
rŞ•Ïy_li¡
;

544 
NOTE_IMMQUEST
:

545 
li¡
 = &
immque¡_li¡
;

548 
NOTE_CHANGES
:

549 
li¡
 = &
chªges_li¡
;

552 
NOTE_PERSONAL
:

553 
li¡
 = &
³rsÚ®_li¡
;

556 
NOTE_TRADE
:

557 
li¡
 = &
Œade_li¡
;

564 ià(
²Ùe
 =ğ*
li¡
)

565 *
li¡
 = 
²Ùe
->
Ãxt
;

567 
´ev
 = *
li¡
;…»v !ğ
nuÎ±r
;…»v =…»v->
Ãxt
) {

568 ià(
´ev
->
Ãxt
 =ğ
²Ùe
)

572 ià(
´ev
 =ğ
nuÎ±r
) {

573 
Loggšg
::
	`bug
("Note_remove:…note‚ot found.", 0);

577 
´ev
->
Ãxt
 = 
²Ùe
->next;

580 
	`§ve_nÙes
(
²Ùe
->
ty³
);

581 
d–‘e
 
²Ùe
;

583 
	}
}

585 
boŞ
 
	$hide_nÙe
(
Ch¬aù”
 *
ch
, 
NÙe
 *
²Ùe
)

587 
time_t
 
Ï¡_»ad
;

593 
²Ùe
->
ty³
) {

595  
Œue
;

597 
NOTE_NOTE
:

598 
Ï¡_»ad
 = 
ch
->
pcd©a
->
Ï¡_nÙe
;

601 
NOTE_IDEA
:

602 
Ï¡_»ad
 = 
ch
->
pcd©a
->
Ï¡_id—
;

605 
NOTE_ROLEPLAY
:

606 
Ï¡_»ad
 = 
ch
->
pcd©a
->
Ï¡_rŞ•Ïy
;

609 
NOTE_IMMQUEST
:

610 
Ï¡_»ad
 = 
ch
->
pcd©a
->
Ï¡_immque¡
;

613 
NOTE_CHANGES
:

614 
Ï¡_»ad
 = 
ch
->
pcd©a
->
Ï¡_chªges
;

617 
NOTE_PERSONAL
:

618 
Ï¡_»ad
 = 
ch
->
pcd©a
->
Ï¡_³rsÚ®
;

621 
NOTE_TRADE
:

622 
Ï¡_»ad
 = 
ch
->
pcd©a
->
Ï¡_Œade
;

626 ià(
²Ùe
->
d©e_¡amp
 <ğ
Ï¡_»ad
)

627  
Œue
;

629 ià(
ch
->
Çme
 =ğ
²Ùe
->
£nd”
)

630  
Œue
;

632 ià(!
	`is_nÙe_to
(
ch
, 
²Ùe
))

633  
Œue
;

635  
çl£
;

636 
	}
}

638 
	$upd©e_»ad
(
Ch¬aù”
 *
ch
, 
NÙe
 *
²Ùe
)

640 
time_t
 
¡amp
;

645 
¡amp
 = 
²Ùe
->
d©e_¡amp
;

647 
²Ùe
->
ty³
) {

651 
NOTE_NOTE
:

652 
ch
->
pcd©a
->
Ï¡_nÙe
 = 
¡d
::
	`max
(ch->pcd©a->Ï¡_nÙe, 
¡amp
);

655 
NOTE_IDEA
:

656 
ch
->
pcd©a
->
Ï¡_id—
 = 
¡d
::
	`max
(ch->pcd©a->Ï¡_id—, 
¡amp
);

659 
NOTE_ROLEPLAY
:

660 
ch
->
pcd©a
->
Ï¡_rŞ•Ïy
 = 
¡d
::
	`max
(ch->pcd©a->Ï¡_rŞ•Ïy, 
¡amp
);

663 
NOTE_IMMQUEST
:

664 
ch
->
pcd©a
->
Ï¡_immque¡
 = 
¡d
::
	`max
(ch->pcd©a->Ï¡_immque¡, 
¡amp
);

667 
NOTE_CHANGES
:

668 
ch
->
pcd©a
->
Ï¡_chªges
 = 
¡d
::
	`max
(ch->pcd©a->Ï¡_chªges, 
¡amp
);

671 
NOTE_PERSONAL
:

672 
ch
->
pcd©a
->
Ï¡_³rsÚ®
 = 
¡d
::
	`max
(ch->pcd©a->Ï¡_³rsÚ®, 
¡amp
);

675 
NOTE_TRADE
:

676 
ch
->
pcd©a
->
Ï¡_Œade
 = 
¡d
::
	`max
(ch->pcd©a->Ï¡_Œade, 
¡amp
);

679 
	}
}

681 
	$nÙify_nÙe_po¡
(
NÙe
 *
²Ùe
, 
Ch¬aù”
 *
vch
, 
ty³
)

683 
SŒšg
 
buf
;

684 cÚ¡ 
SŒšg
& 
li¡_Çme
 = 
bßrd_šdex
[
ty³
].
bßrd_lÚg
;

686 autØ
ch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

687 ià(
ch
->
	`is_Åc
())

690 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
)) {

691 
FÜm©
::
	`¥rštf
(
buf
, "{W[FYI] New %s from %s. Subject: [%s]. ",

692 
li¡_Çme
, 
²Ùe
->
£nd”
,…nÙe->
subjeù
);

694 ià(
ch
->
şª
 && 
²Ùe
->
to_li¡
.
	`has_wÜds
(ch->şª->
Çme
))

695 
buf
 += "Guild‚ote.{x\n";

696 ià(
²Ùe
->
to_li¡
.
	`has_exaù_wÜds
(
ch
->
Çme
))

697 
buf
 += "Personal‚ote.{x\n";

698 ià(
²Ùe
->
to_li¡
.
	`has_wÜds
("all"))

699 
buf
 += "Global‚ote.{x\n";

700 ià(
	`IS_IMMORTAL
(
ch
è&& 
²Ùe
->
to_li¡
.
	`has_wÜds
("immortal"))

701 
buf
 += "Immortal‚ote.{x\n";

703 
buf
 += "{x\n";

705 ià(
ch
 !ğ
vch


707 && 
	`¡rcmp
(
²Ùe
->
£nd”
, 
ch
->
Çme
)

708 && !
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_NONOTIFY
))

709 
	`¡c
(
buf
, 
ch
);

712 
	}
}

714 
	$·r£_nÙe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
, 
ty³
)

716 
SŒšg
 
bufãr
;

717 
buf
[
MSL
];

718 
NÙe
 *
²Ùe
;

719 
NÙe
 **
li¡
;

721 
vnum
 = 0, 
ªum
 = 0;

723 
li¡
 = 
bßrd_šdex
[
ty³
].
bßrd_li¡
;

724 cÚ¡ 
SŒšg
& 
li¡_Çme
 = 
bßrd_šdex
[
ty³
].
bßrd_¶u¿l
;

726 
SŒšg
 
¬g
;

727 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

729 ià(
¬g
.
	`em±y
(è||‡rg.
	`is_´efix_of
("read")) {

730 
boŞ
 
fAÎ
 = 
çl£
;

732 ià(
ch
->
	`is_Åc
()) {

733 
	`¡c
("SÜry, mobe ÿn'ˆ»ad‚Ùes.\n", 
ch
);

738 ià(
¬gum’t
.
	`em±y
(è||‡rgum’t.
	`is_´efix_of
("next")) {

739 
²Ùe
 = *
li¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

740 ià(!
	`hide_nÙe
(
ch
, 
²Ùe
)) {

741 
	`±c
(
ch
, "{W[%3d] From: {x%s\n"

746 
vnum
,

747 
²Ùe
->
£nd”
,

748 
²Ùe
->
to_li¡
,

749 
²Ùe
->
d©e
,

750 
²Ùe
->
subjeù
);

751 
	`·ge_to_ch¬
(
²Ùe
->
‹xt
, 
ch
);

752 
	`upd©e_»ad
(
ch
, 
²Ùe
);

755 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
))

756 
vnum
++;

759 
	`±c
(
ch
, "You havnØuÄ—d %s.\n", 
li¡_Çme
);

762 ià(
¬gum’t
.
	`is_numb”
())

763 
ªum
 = 
	`©oi
(
¬gum’t
);

764 ià(
¬gum’t
 == "all")

765 
fAÎ
 = 
Œue
;

767 
	`¡c
("R—d which‚umb”?\n", 
ch
);

771 
²Ùe
 = *
li¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

772 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
è&& (
vnum
++ =ğ
ªum
 || 
fAÎ
)) {

773 
	`±c
(
ch
, "{W[%3d] From: {x%s\n"

778 
vnum
 - 1,

779 
²Ùe
->
£nd”
,

780 
²Ùe
->
to_li¡
,

781 
²Ùe
->
d©e
,

782 
²Ùe
->
subjeù
);

783 
	`·ge_to_ch¬
(
²Ùe
->
‹xt
, 
ch
);

784 
	`upd©e_»ad
(
ch
, 
²Ùe
);

789 
	`±c
(
ch
, "Th”¬’'ˆth© mªy %s.\n", 
li¡_Çme
);

793 ià(
¬g
.
	`is_´efix_of
("list")) {

794 
boŞ
 
£¬ch
 = 
çl£
, 
nw
 = f®£, 
found
 = f®£, 
®l
 = false;

796 ià(
ch
->
	`is_Åc
()) {

797 
	`¡c
("SÜry, mobe ÿn'ˆ»ad‚Ùes.\n", 
ch
);

801 ià(
¬gum’t
 == "new")

802 
nw
 = 
Œue
;

803 ià(
¬gum’t
 == "all")

804 
®l
 = 
Œue
;

805 ià(!
¬gum’t
.
	`em±y
())

806 
£¬ch
 = 
Œue
;

809 
²Ùe
 = *
li¡
, 
vnum
 = -1;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

810 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
)) {

811 
vnum
++;

813 ià((
£¬ch
è&& !
¬gum’t
.
	`is_´efix_of
(
²Ùe
->
£nd”
))

816 ià((
nw
è&& 
	`hide_nÙe
(
ch
, 
²Ùe
))

819 
FÜm©
::
	`¥rštf
(
buf
, "{W[{x%3d%s{W][{x%12s{W]{x %s{x\n",

820 
vnum
,

821 
	`hide_nÙe
(
ch
, 
²Ùe
) ? " " : "N",

822 
²Ùe
->
£nd”
,

823 
²Ùe
->
subjeù
);

825 ià(
®l
)

826 
	`¡c
(
buf
, 
ch
);

828 
bufãr
 +ğ
buf
;

830 
found
 = 
Œue
;

834 ià(!
found
)

835 
	`¡c
("Th”¬nØmes§ge th© m©chh© cr™”Ÿ.\n", 
ch
);

837 ià(!
®l
)

838 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

843 ià(
¬g
.
	`is_´efix_of
("remove")) {

844 ià(!
¬gum’t
.
	`is_numb”
()) {

845 
	`¡c
("NÙ»movwhich‚umb”?\n", 
ch
);

849 
ªum
 = 
	`©oi
(
¬gum’t
);

850 
vnum
 = 0;

852 
²Ùe
 = *
li¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

853 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
è&& 
vnum
++ =ğ
ªum
) {

854 
	`nÙe_»move
(
ch
, 
²Ùe
, 
çl£
);

855 
	`¡c
("Mes§g»moved.\n", 
ch
);

860 
FÜm©
::
	`¥rštf
(
buf
, "Th”¬’'ˆth© mªy %s.", 
li¡_Çme
);

861 
	`¡c
(
buf
, 
ch
);

865 ià(
¬g
.
	`is_´efix_of
("d–‘e"è&& 
	`IS_IMP
(
ch
)) {

866 ià(!
¬gum’t
.
	`is_numb”
()) {

867 
	`¡c
("Mes§gd–‘which‚umb”?\n", 
ch
);

871 
ªum
 = 
	`©oi
(
¬gum’t
);

872 
vnum
 = 0;

874 
²Ùe
 = *
li¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

875 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
è&& 
vnum
++ =ğ
ªum
) {

876 
	`nÙe_»move
(
ch
, 
²Ùe
, 
Œue
);

877 
	`¡c
("Mes§gd–‘ed.\n", 
ch
);

882 
FÜm©
::
	`¥rštf
(
buf
, "Th”¬’'ˆth© mªy %s.\n", 
li¡_Çme
);

883 
	`¡c
(
buf
, 
ch
);

887 ià(
¬g
.
	`is_´efix_of
("forward")) {

888 
NÙe
 *
ÃwnÙe
;

890 ià(
ch
->
	`is_Åc
()) {

891 
	`¡c
("Mob ÿn'ˆfÜw¬d‚Ùes.\n", 
ch
);

895 
SŒšg
 
fÜw¬d
;

896 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
fÜw¬d
);

898 ià(
fÜw¬d
.
	`em±y
()) {

899 
	`¡c
("Fow¬d‚ÙtØwho?\n", 
ch
);

903 ià(!
¬gum’t
.
	`is_numb”
()) {

904 
	`¡c
("NÙfÜw¬d which‚umb”?\n", 
ch
);

908 
ªum
 = 
	`©oi
(
¬gum’t
);

909 
vnum
 = 0;

911 
²Ùe
 = *
li¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

912 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
è&& 
vnum
++ =ğ
ªum
) {

913 
ÃwnÙe
 = 
Ãw
 
	`NÙe
();

914 
ÃwnÙe
->
£nd”
 = 
²Ùe
->sender;

915 
ÃwnÙe
->
d©e
 = 
²Ùe
->date;

916 
ÃwnÙe
->
d©e_¡amp
 = 
Game
::
cu¼’t_time
;

917 
ÃwnÙe
->
to_li¡
 = 
fÜw¬d
;

922 
FÜm©
::
	`¥rštf
(
buf
, "{VFORWARD{W({V%s{W){x: %s", 
ch
->
Çme
.
	`uncŞÜ
(), 
²Ùe
->
subjeù
);

923 
ÃwnÙe
->
subjeù
 = 
buf
;

924 
ÃwnÙe
->
‹xt
 = 
²Ùe
->text;

925 
ÃwnÙe
->
ty³
 = 
²Ùe
->type;

926 
	`­³nd_nÙe
(
ÃwnÙe
);

927 
	`¡c
("NÙFÜw¬ded.\n", 
ch
);

928 
	`nÙify_nÙe_po¡
(
ÃwnÙe
, 
ch
, 
ty³
);

933 
FÜm©
::
	`¥rštf
(
buf
, "Th”¬’'ˆth© mªy %s.", 
li¡_Çme
);

934 
	`¡c
(
buf
, 
ch
);

938 ià(
¬g
.
	`is_´efix_of
("»po¡"è&& 
	`IS_IMMORTAL
(
ch
)) {

939 
NÙe
 *
ÃwnÙe
;

941 ià(!
¬gum’t
.
	`is_numb”
()) {

942 
	`¡c
("NÙ»po¡ which‚umb”?\n", 
ch
);

946 
ªum
 = 
	`©oi
(
¬gum’t
);

947 
vnum
 = 0;

949 
²Ùe
 = *
li¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

950 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
è&& 
vnum
++ =ğ
ªum
) {

951 
ÃwnÙe
 = 
Ãw
 
	`NÙe
();

952 
ÃwnÙe
->
£nd”
 = 
²Ùe
->sender;

953 
ÃwnÙe
->
d©e
 = 
²Ùe
->date;

954 
ÃwnÙe
->
d©e_¡amp
 = 
Game
::
cu¼’t_time
;

955 
ÃwnÙe
->
to_li¡
 = "Immortal";

956 
FÜm©
::
	`¥rštf
(
buf
, "{PIMM REPOST{W({P%s{W){x: %s", 
ch
->
Çme
,

957 
²Ùe
->
subjeù
);

958 
ÃwnÙe
->
subjeù
 = 
buf
;

959 
ÃwnÙe
->
‹xt
 = 
²Ùe
->text;

960 
ÃwnÙe
->
ty³
 = 
²Ùe
->type;

961 
	`­³nd_nÙe
(
ÃwnÙe
);

962 
	`nÙe_»move
(
ch
, 
²Ùe
, 
Œue
);

963 
	`¡c
("NÙR•o¡ed.\n", 
ch
);

964 
	`nÙify_nÙe_po¡
(
ÃwnÙe
, 
ch
, 
ty³
);

969 
FÜm©
::
	`¥rštf
(
buf
, "Th”¬’'ˆth© mªy %s.", 
li¡_Çme
);

970 
	`¡c
(
buf
, 
ch
);

974 ià(
¬g
.
	`is_´efix_of
("wipe")) {

975 
ch
->
pcd©a
->
Ï¡_nÙe
 = 
Game
::
cu¼’t_time
;

976 
ch
->
pcd©a
->
Ï¡_id—
 = 
Game
::
cu¼’t_time
;

977 
ch
->
pcd©a
->
Ï¡_rŞ•Ïy
 = 
Game
::
cu¼’t_time
;

978 
ch
->
pcd©a
->
Ï¡_chªges
 = 
Game
::
cu¼’t_time
;

979 
ch
->
pcd©a
->
Ï¡_immque¡
 = 
Game
::
cu¼’t_time
;

980 
ch
->
pcd©a
->
Ï¡_³rsÚ®
 = 
Game
::
cu¼’t_time
;

981 
ch
->
pcd©a
->
Ï¡_Œade
 = 
Game
::
cu¼’t_time
;

982 
	`¡c
("You‡»‚ow caughˆu°Ú‡Î mes§ges.\n", 
ch
);

986 ià(
¬g
.
	`is_´efix_of
("catchup")) {

987 
ty³
) {

988 
NOTE_NOTE
:

989 
ch
->
pcd©a
->
Ï¡_nÙe
 = 
Game
::
cu¼’t_time
;

990 
	`¡c
("You‡»‚ow caughˆu°Ú‚Ùes.\n", 
ch
);

993 
NOTE_IDEA
:

994 
ch
->
pcd©a
->
Ï¡_id—
 = 
Game
::
cu¼’t_time
;

995 
	`¡c
("You‡»‚ow caughˆu°Ú id—s.\n", 
ch
);

998 
NOTE_ROLEPLAY
:

999 
ch
->
pcd©a
->
Ï¡_rŞ•Ïy
 = 
Game
::
cu¼’t_time
;

1000 
	`¡c
("You‡»‚ow caughˆu°Ú„Ş•Ïy‚Ùes.\n", 
ch
);

1003 
NOTE_IMMQUEST
:

1004 
ch
->
pcd©a
->
Ï¡_immque¡
 = 
Game
::
cu¼’t_time
;

1005 
	`¡c
("You‡»‚ow caughˆu°Ú que¡‚Ùes.\n", 
ch
);

1008 
NOTE_CHANGES
:

1009 
ch
->
pcd©a
->
Ï¡_chªges
 = 
Game
::
cu¼’t_time
;

1010 
	`¡c
("You‡»‚ow caughˆu°Ú chªges.\n", 
ch
);

1013 
NOTE_PERSONAL
:

1014 
ch
->
pcd©a
->
Ï¡_³rsÚ®
 = 
Game
::
cu¼’t_time
;

1015 
	`¡c
("You‡»‚ow caughˆu°Ú…”sÚ® mes§ges.\n", 
ch
);

1018 
NOTE_TRADE
:

1019 
ch
->
pcd©a
->
Ï¡_Œade
 = 
Game
::
cu¼’t_time
;

1020 
	`¡c
("You‡»‚ow caughˆu°Ú¿dnÙes.\n", 
ch
);

1028 ià(
¬g
.
	`is_´efix_of
("move")) {

1029 
NÙe
 *
th’Ùe
, *
ÃwnÙe
, *
Ãwli¡
;

1030 
Ãwty³
 = 0;

1032 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1034 ià(
¬g
.
	`em±y
(è|| !¬g.
	`is_numb”
()) {

1035 
	`±c
(
ch
, "Movwhich % numb”?\n", 
bßrd_šdex
[
ty³
].
bßrd_shÜt
);

1039 
ªum
 = 
	`©oi
(
¬g
);

1041 
vnum
 = 0;

1042 
th’Ùe
 = 
nuÎ±r
;

1044 
²Ùe
 = *
li¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

1045 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
è&& 
vnum
++ =ğ
ªum
) {

1046 
th’Ùe
 = 
²Ùe
;

1051 ià(
th’Ùe
 =ğ
nuÎ±r
) {

1052 
	`±c
(
ch
, "Th”¬’'ˆth© mªy %s.", 
bßrd_šdex
[
ty³
].
bßrd_lÚg
);

1056 ià(
	`¡rcmp
(
th’Ùe
->
£nd”
, 
ch
->
Çme
è&& !
	`IS_IMMORTAL
(ch)) {

1057 
	`±c
(
ch
, "You‡re‚othe‡uthor ofhis %s, so you can't move it!\n",

1058 
bßrd_šdex
[
ty³
].
bßrd_shÜt
);

1063 
Ãwli¡
 = 
nuÎ±r
;

1064 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1066 
j
 = 0; j < 
bßrd_šdex
.
	`size
(); j++) {

1067 ià(
¬g
.
	`is_´efix_of
(
bßrd_šdex
[
j
].
bßrd_¶u¿l
)) {

1068 
Ãwty³
 = 
j
;

1069 
Ãwli¡
 = *(
bßrd_šdex
[
j
].
bßrd_li¡
);

1074 ià(
Ãwli¡
 =ğ
nuÎ±r
) {

1075 
	`±c
(
ch
, "Th”e' nØsuch bßrd‚ama '%s'\n", 
¬g
);

1079 ià(
Ãwty³
 =ğ
NOTE_IMMQUEST
 && !
	`IS_IMMORTAL
(
ch
)) {

1080 
	`¡c
("You‡»n'ˆ®lowedØmov¨mes§gtØIMMQUEST, sÜry!\n", 
ch
);

1084 ià(
Ãwty³
 =ğ
NOTE_CHANGES
 && !
	`IS_IMMORTAL
(
ch
)) {

1085 
	`¡c
("You‡»n'ˆ®lowedØmov¨mes§gtØCHANGES, sÜry!\n", 
ch
);

1090 
ÃwnÙe
 = 
Ãw
 
	`NÙe
();

1091 
ÃwnÙe
->
£nd”
 = 
²Ùe
->sender;

1092 
ÃwnÙe
->
d©e
 = 
²Ùe
->date;

1093 
ÃwnÙe
->
d©e_¡amp
 = 
Game
::
cu¼’t_time
;

1094 
ÃwnÙe
->
to_li¡
 = 
²Ùe
->to_list;

1095 
ÃwnÙe
->
subjeù
 = 
²Ùe
->subject;

1096 
ÃwnÙe
->
‹xt
 = 
²Ùe
->text;

1097 
ÃwnÙe
->
ty³
 = 
Ãwty³
;

1098 
	`­³nd_nÙe
(
ÃwnÙe
);

1099 
	`nÙe_»move
(
ch
, 
²Ùe
, 
Œue
);

1100 
	`±c
(
ch
, "OK, %s %d movedo %s.\n",

1101 
bßrd_šdex
[
ty³
].
bßrd_shÜt
,

1102 
ªum
,

1103 
bßrd_šdex
[
Ãwty³
].
bßrd_¶u¿l
);

1104 
	`nÙify_nÙe_po¡
(
ÃwnÙe
, 
ch
, 
Ãwty³
);

1108 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_NOTE
)) {

1109 
	`¡c
("You¸nÙwr™šg…rivedge havb“À»voked.\n", 
ch
);

1114 ià((
ty³
 =ğ
NOTE_IMMQUEST
 ||y³ =ğ
NOTE_CHANGES
)

1115 && !
	`IS_IMMORTAL
(
ch
)) {

1116 
	`±c
(
ch
, "You‡»n'ˆhighƒnough†ev–Øwr™%s.\n", 
li¡_Çme
);

1120 ià(
¬g
 == "+") {

1121 
	`nÙe_©ch
(
ch
, 
ty³
);

1123 ià(
ch
->
²Ùe
->
ty³
 !=ype) {

1124 
	`¡c
(

1125 "You‡Ì—dy hav¨difã»Á‚Ùš…rog»ss.\n", 
ch
);

1130 ià(
	`¡¾’
(
ch
->
²Ùe
->
‹xt
è+ sŒËn(
¬gum’t
) >= 4096) {

1131 
	`¡c
("NÙtoØlÚg.\n", 
ch
);

1133 ià(!
ch
->
	`is_Åc
()èch->
pcd©a
->
¶r_æags
 +ğ
PLR_STOPCRASH
;

1138 
bufãr
 +ğ
ch
->
²Ùe
->
‹xt
;

1139 
bufãr
 +ğ
¬gum’t
;

1140 
bufãr
 += "\n";

1141 
ch
->
²Ùe
->
‹xt
 = 
bufãr
;

1142 
	`¡c
("Lšadded.\n", 
ch
);

1146 ià(
¬g
 == "replace") {

1147 
SŒšg
 
Şd
, 
nw
;

1148 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
Şd
);

1149 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
nw
);

1151 ià((
Şd
.
	`em±y
()è|| (
nw
.empty())) {

1152 
	`¡c
("Usage:‚ote„eplace 'old string' 'new string'\n",

1153 
ch
);

1157 ià(
ch
->
²Ùe
 =ğ
nuÎ±r
) {

1158 
	`¡c
("You havnØnÙš…rog»ss.\n", 
ch
);

1162 ià(
ch
->
²Ùe
->
‹xt
.
	`em±y
()) {

1163 
	`¡c
("You havnÙƒÁ”ed‡nyext.\n", 
ch
);

1167 
SŒšg
 
‹mp
 = 
ch
->
²Ùe
->
‹xt
;

1168 
ch
->
²Ùe
->
‹xt
 = 
‹mp
.
	`»¶aû
(
Şd
, 
nw
);

1169 
FÜm©
::
	`¥rštf
(
buf
, "'%s'„•Ïûd w™h '%s'.\n", 
Şd
, 
nw
);

1170 
	`¡c
(
buf
, 
ch
);

1174 ià(
¬g
 == "format") {

1175 ià(
ch
->
²Ùe
 =ğ
nuÎ±r
) {

1176 
	`¡c
("You havnØnÙš…rog»ss.\n", 
ch
);

1180 ià(
ch
->
²Ùe
->
‹xt
.
	`em±y
()) {

1181 
	`¡c
("You havnÙƒÁ”ed‡nyext.\n", 
ch
);

1185 
ch
->
²Ùe
->
‹xt
 = 
	`fÜm©_¡ršg
(ch->pnote->text);

1186 
	`¡c
("NÙfÜm©‹d.\n", 
ch
);

1190 ià(
¬g
 == "-") {

1191 
	`nÙe_©ch
(
ch
, 
ty³
);

1193 ià(
ch
->
²Ùe
->
ty³
 !=ype) {

1194 
	`¡c
("You‡Ì—dy hav¨difã»Á‚Ùš…rog»ss.\n", 
ch
);

1198 ià(
ch
->
²Ùe
->
‹xt
.
	`em±y
()) {

1199 
	`¡c
("NØlše ËáØ»move.\n", 
ch
);

1203 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
¶r_æags
.
	`has
(
PLR_STOPCRASH
)) {

1204 
	`¡c
("You cªnÙƒd™hi nÙªy fu¹h”.\n", 
ch
);

1205 
	`¡c
("PËa£ƒ™h”…o¡ o¸ş—¸thi nÙe.\n", 
ch
);

1209 
	`¡rıy
(
buf
, 
ch
->
²Ùe
->
‹xt
);

1210 
boŞ
 
found
 = 
çl£
;

1213 
Ën
 = 
	`¡¾’
(
buf
);†en > 0;†en--) {

1214 ià(
buf
[
Ën
] == '\n') {

1215 ià(
found
) {

1216 
buf
[
Ën
 + 1] = '\0';

1217 
ch
->
²Ùe
->
‹xt
 = 
buf
;

1218 
	`¡c
("Lš»moved.\n", 
ch
);

1222 
found
 = 
Œue
;

1226 
buf
[0] = '\0';

1227 
ch
->
²Ùe
->
‹xt
 = 
buf
;

1228 
	`¡c
("Lš»moved.\n", 
ch
);

1232 ià(
¬g
.
	`is_´efix_of
("subject")) {

1233 
	`nÙe_©ch
(
ch
, 
ty³
);

1235 ià(
ch
->
²Ùe
->
ty³
 !=ype) {

1236 
	`¡c
(

1237 "You‡Ì—dy hav¨difã»Á‚Ùš…rog»ss.\n", 
ch
);

1241 
ch
->
²Ùe
->
subjeù
 = 
¬gum’t
;

1242 
	`¡c
("Subjeù s‘.\n", 
ch
);

1246 ià(
¬g
.
	`is_´efix_of
("to")) {

1247 ià(
ch
->
comm_æags
.
	`has
(
COMM_NOCHANNELS
) &&

1248 
	`¡rcmp
(
¬gum’t
, "immortal")) {

1249 
	`¡c
("You cª cu¼’y s’d‚Ùe ÚlyØimmÜl.\n", 
ch
);

1253 
	`nÙe_©ch
(
ch
, 
ty³
);

1255 ià(
ch
->
²Ùe
->
ty³
 !=ype) {

1256 
	`¡c
(

1257 "You‡Ì—dy hav¨difã»Á‚Ùš…rog»ss.\n", 
ch
);

1261 ià(
¬gum’t
.
	`em±y
()) {

1262 
	`¡c
("Whom dØyou wishØadd»s ™o?\n", 
ch
);

1268 ià(!
	`IS_IMMORTAL
(
ch
è&& ch->
şª
 && 
¬gum’t
.
	`has_exaù_wÜds
("clan")) {

1269 
lše
[
MSL
], *
p
;

1271 
	`¡rıy
(
lše
, 
¬gum’t
);

1272 
p
 = 
¡d
::
	`¡r¡r
(
lše
, "clan");

1274 *(
p
 + 4) != ' ' && *(p + 4) != '\0')

1275 
p
 = 
¡d
::
	`¡r¡r
(p + 4, "clan");

1277 *
p
 = '\0';

1278 
p
 += 4;

1279 
FÜm©
::
	`¥rštf
(
buf
, "%s%s%s", 
lše
, 
ch
->
şª
->
Çme
.
	`ÿp™®ize
(), 
p
);

1280 
ch
->
²Ùe
->
to_li¡
 = 
buf
;

1283 
ch
->
²Ùe
->
to_li¡
 = 
¬gum’t
;

1285 
	`¡c
("Rec›Á†i¡ s‘.\n", 
ch
);

1289 ià(
¬g
.
	`is_´efix_of
("clear")) {

1290 ià(
ch
->
²Ùe
 !ğ
nuÎ±r
) {

1291 
d–‘e
 
ch
->
²Ùe
;

1292 
ch
->
²Ùe
 = 
nuÎ±r
;

1295 
	`¡c
("NÙş—»d.\n", 
ch
);

1297 ià(!
ch
->
	`is_Åc
()èch->
pcd©a
->
¶r_æags
 -ğ
PLR_STOPCRASH
;

1302 ià(
¬g
.
	`is_´efix_of
("show")) {

1303 ià(
ch
->
²Ùe
 =ğ
nuÎ±r
) {

1304 
	`¡c
("You havnØnÙš…rog»ss.\n", 
ch
);

1308 ià(
ch
->
²Ùe
->
ty³
 !=ype) {

1309 
	`¡c
("You‡»n'ˆwÜkšg oÀth© kšd oànÙe.\n", 
ch
);

1313 
FÜm©
::
	`¥rštf
(
buf
, " {WFrom: {x%s\n {WTo: {x%s\n{WSubject: {x%s\n",

1314 
ch
->
²Ùe
->
£nd”
,

1315 
ch
->
²Ùe
->
to_li¡
,

1316 
ch
->
²Ùe
->
subjeù


1318 
	`¡c
(
buf
, 
ch
);

1319 
	`¡c
("{W================================================================================{x\n", 
ch
);

1320 
	`¡c
(
ch
->
²Ùe
->
‹xt
, ch);

1324 ià(
¬g
.
	`is_´efix_of
("post") ||‡rg.is_prefix_of("send")) {

1325 *
¡¹ime
;

1326 
buf2
[
MAX_STRING_LENGTH
];

1328 ià(
ch
->
²Ùe
 =ğ
nuÎ±r
) {

1329 
	`¡c
("You havnØnÙš…rog»ss.\n", 
ch
);

1333 ià(
ch
->
²Ùe
->
ty³
 !=ype) {

1334 
	`¡c
("You‡»n'ˆwÜkšg oÀth© kšd oànÙe.\n", 
ch
);

1338 ià(
ch
->
²Ùe
->
to_li¡
 == "") {

1339 
	`¡c
(

1341 
ch
);

1345 ià(
ch
->
²Ùe
->
subjeù
 == "") {

1346 
	`¡c
("You‚“dØ´ovid¨subjeù.\n", 
ch
);

1351 ià((
ch
->
²Ùe
->
ty³
 =ğ
NOTE_NOTE
) &&

1352 ((!
ch
->
²Ùe
->
to_li¡
.
	`has_exaù_wÜds
("all"))

1353 || (!
ch
->
²Ùe
->
to_li¡
.
	`has_exaù_wÜds
("spam")))) {

1354 
ch
->
²Ùe
->
ty³
 = 
NOTE_PERSONAL
;

1355 
ty³
 = 
NOTE_PERSONAL
;

1359 ià((
ch
->
²Ùe
->
ty³
 =ğ
NOTE_PERSONAL
) &&

1360 (
ch
->
²Ùe
->
to_li¡
.
	`has_exaù_wÜds
("all") ||

1361 
ch
->
²Ùe
->
to_li¡
.
	`has_exaù_wÜds
("spam"))) {

1362 
ch
->
²Ùe
->
ty³
 = 
NOTE_NOTE
;

1363 
ty³
 = 
NOTE_NOTE
;

1366 
ch
->
²Ùe
->
Ãxt
 = 
nuÎ±r
;

1367 
¡¹ime
 = 
	`ùime
(&
Game
::
cu¼’t_time
);

1368 
¡¹ime
[
	`¡¾’
(strtime) - 1] = '\0';

1369 
ch
->
²Ùe
->
d©e
 = 
¡¹ime
;

1370 
ch
->
²Ùe
->
d©e_¡amp
 = 
Game
::
cu¼’t_time
;

1371 
FÜm©
::
	`¥rštf
(
buf2
, "% ha ju¡…o¡ed‡ % to: %s", 
ch
->
Çme
,

1372 
bßrd_šdex
[
ty³
].
bßrd_lÚg
, 
ch
->
²Ùe
->
to_li¡
);

1373 
	`wizÃt
(
buf2
, 
ch
, 
nuÎ±r
, 
WIZ_MAIL
, 0, 
	`GET_RANK
(ch));

1374 
	`­³nd_nÙe
(
ch
->
²Ùe
);

1375 
	`nÙify_nÙe_po¡
(
ch
->
²Ùe
, ch, 
ty³
);

1376 
ch
->
²Ùe
 = 
nuÎ±r
;

1377 
FÜm©
::
	`¥rštf
(
buf2
, "You¸% ha b“Àpo¡ed.\n", 
bßrd_šdex
[
ty³
].
bßrd_lÚg
);

1378 
	`¡c
(
buf2
, 
ch
);

1380 ià(!
ch
->
	`is_Åc
()èch->
pcd©a
->
¶r_æags
 -ğ
PLR_STOPCRASH
;

1385 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

1387 
	}
}

1389 
	$do_Şd_Ãxt
(
Ch¬aù”
 *
ch
)

1391 
buf
[
MAX_STRING_LENGTH
];

1392 
NÙe
 *
²Ùe
;

1393 
NÙe
 **
li¡
;

1394 
vnum
;

1396 ià(
ch
->
	`is_Åc
()) {

1397 
	`¡c
("SÜry, mobe ÿn'ˆ»ad‚Ùes.\n" , 
ch
);

1401 
li¡
 = &
nÙe_li¡
;

1402 
²Ùe
 = *
li¡
;

1404 ià(
²Ùe
 !ğ
nuÎ±r
) {

1405 
vnum
 = 0;

1407 
²Ùe
 = *
li¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

1408 ià(!
	`hide_nÙe
(
ch
, 
²Ùe
)) {

1409 
FÜm©
::
	`¥rštf
(
buf
,

1411 
vnum
,

1412 
²Ùe
->
£nd”
,

1413 
²Ùe
->
to_li¡
,

1414 
²Ùe
->
d©e
,

1415 
²Ùe
->
subjeù
);

1416 
	`¡c
(
buf
, 
ch
);

1417 
	`¡c
("{W================================================================================{x\n", 
ch
);

1418 
	`·ge_to_ch¬
(
²Ùe
->
‹xt
, 
ch
);

1419 
	`upd©e_»ad
(
ch
, 
²Ùe
);

1422 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
))

1423 
vnum
++;

1427 
li¡
 = &
id—_li¡
;

1428 
²Ùe
 = *
li¡
;

1430 ià(
²Ùe
 !ğ
nuÎ±r
) {

1431 
vnum
 = 0;

1433 
²Ùe
 = *
li¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

1434 ià(!
	`hide_nÙe
(
ch
, 
²Ùe
)) {

1435 
FÜm©
::
	`¥rštf
(
buf
,

1437 
vnum
,

1438 
²Ùe
->
£nd”
,

1439 
²Ùe
->
to_li¡
,

1440 
²Ùe
->
d©e
,

1441 
²Ùe
->
subjeù
);

1442 
	`¡c
(
buf
, 
ch
);

1443 
	`¡c
("{W================================================================================{x\n", 
ch
);

1444 
	`·ge_to_ch¬
(
²Ùe
->
‹xt
, 
ch
);

1445 
	`upd©e_»ad
(
ch
, 
²Ùe
);

1448 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
))

1449 
vnum
++;

1453 
li¡
 = &
chªges_li¡
;

1454 
²Ùe
 = *
li¡
;

1456 ià(
²Ùe
 !ğ
nuÎ±r
) {

1457 
vnum
 = 0;

1459 
²Ùe
 = *
li¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

1460 ià(!
	`hide_nÙe
(
ch
, 
²Ùe
)) {

1461 
FÜm©
::
	`¥rštf
(
buf
,

1463 
vnum
,

1464 
²Ùe
->
£nd”
,

1465 
²Ùe
->
to_li¡
,

1466 
²Ùe
->
d©e
,

1467 
²Ùe
->
subjeù
);

1468 
	`¡c
(
buf
, 
ch
);

1469 
	`¡c
("{W================================================================================{x\n", 
ch
);

1470 
	`·ge_to_ch¬
(
²Ùe
->
‹xt
, 
ch
);

1471 
	`upd©e_»ad
(
ch
, 
²Ùe
);

1474 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
))

1475 
vnum
++;

1479 
li¡
 = &
immque¡_li¡
;

1480 
²Ùe
 = *
li¡
;

1482 ià(
²Ùe
 !ğ
nuÎ±r
) {

1483 
vnum
 = 0;

1485 
²Ùe
 = *
li¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

1486 ià(!
	`hide_nÙe
(
ch
, 
²Ùe
)) {

1487 
FÜm©
::
	`¥rštf
(
buf
,

1489 
vnum
,

1490 
²Ùe
->
£nd”
,

1491 
²Ùe
->
to_li¡
,

1492 
²Ùe
->
d©e
,

1493 
²Ùe
->
subjeù
);

1494 
	`¡c
(
buf
, 
ch
);

1495 
	`¡c
("{W================================================================================{x\n", 
ch
);

1496 
	`·ge_to_ch¬
(
²Ùe
->
‹xt
, 
ch
);

1497 
	`upd©e_»ad
(
ch
, 
²Ùe
);

1500 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
))

1501 
vnum
++;

1505 
li¡
 = &
rŞ•Ïy_li¡
;

1506 
²Ùe
 = *
li¡
;

1508 ià(
²Ùe
 !ğ
nuÎ±r
) {

1509 
vnum
 = 0;

1511 
²Ùe
 = *
li¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

1512 ià(!
	`hide_nÙe
(
ch
, 
²Ùe
)) {

1513 
FÜm©
::
	`¥rštf
(
buf
,

1515 
vnum
,

1516 
²Ùe
->
£nd”
,

1517 
²Ùe
->
to_li¡
,

1518 
²Ùe
->
d©e
,

1519 
²Ùe
->
subjeù
);

1520 
	`¡c
(
buf
, 
ch
);

1521 
	`¡c
("{W================================================================================{x\n", 
ch
);

1522 
	`·ge_to_ch¬
(
²Ùe
->
‹xt
, 
ch
);

1523 
	`upd©e_»ad
(
ch
, 
²Ùe
);

1526 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
))

1527 
vnum
++;

1531 
li¡
 = &
³rsÚ®_li¡
;

1532 
²Ùe
 = *
li¡
;

1534 ià(
²Ùe
 !ğ
nuÎ±r
) {

1535 
vnum
 = 0;

1537 
²Ùe
 = *
li¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

1538 ià(!
	`hide_nÙe
(
ch
, 
²Ùe
)) {

1539 
FÜm©
::
	`¥rštf
(
buf
,

1541 
vnum
,

1542 
²Ùe
->
£nd”
,

1543 
²Ùe
->
to_li¡
,

1544 
²Ùe
->
d©e
,

1545 
²Ùe
->
subjeù
);

1546 
	`¡c
(
buf
, 
ch
);

1547 
	`¡c
("{W================================================================================{x\n", 
ch
);

1548 
	`·ge_to_ch¬
(
²Ùe
->
‹xt
, 
ch
);

1549 
	`upd©e_»ad
(
ch
, 
²Ùe
);

1552 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
))

1553 
vnum
++;

1557 
li¡
 = &
Œade_li¡
;

1558 
²Ùe
 = *
li¡
;

1560 ià(
²Ùe
 !ğ
nuÎ±r
) {

1561 
vnum
 = 0;

1563 
²Ùe
 = *
li¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

1564 ià(!
	`hide_nÙe
(
ch
, 
²Ùe
)) {

1565 
FÜm©
::
	`¥rštf
(
buf
,

1567 
vnum
,

1568 
²Ùe
->
£nd”
,

1569 
²Ùe
->
to_li¡
,

1570 
²Ùe
->
d©e
,

1571 
²Ùe
->
subjeù
);

1572 
	`¡c
(
buf
, 
ch
);

1573 
	`¡c
("{W================================================================================{x\n", 
ch
);

1574 
	`·ge_to_ch¬
(
²Ùe
->
‹xt
, 
ch
);

1575 
	`upd©e_»ad
(
ch
, 
²Ùe
);

1578 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
))

1579 
vnum
++;

1583 
	`¡c
("Th©' ®ÈfŞks!\n", 
ch
);

1585 
	}
}

1588 
	$do_Ãxt
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1590 cÚ¡ 
bßrd_šdex_¡ruù
 *
obis
 = 
nuÎ±r
;

1591 
time_t
 
o¡amp
 = (time_t) 0;

1592 
NÙe
 *
²Ùe
, *
ÚÙe
 = 
nuÎ±r
;

1593 
NÙe
 **
¶i¡
;

1594 
Âum
, 
Úum
 = 0;

1596 ià(
ch
->
	`is_Åc
()) {

1597 
	`¡c
("SÜry, mobe ÿn'ˆ»ad‚Ùes.\n", 
ch
);

1602 ià(!
¬gum’t
.
	`em±y
()) {

1603 
	`do_Şd_Ãxt
(
ch
);

1608 autØ
™
 = 
bßrd_šdex
.
	`begš
(); iˆ!ğbßrd_šdex.
	`’d
(); ++it) {

1609 
¶i¡
 = 
™
->
bßrd_li¡
;

1610 
Âum
 = 0;

1613 
²Ùe
 = *
¶i¡
;…nÙ!ğ
nuÎ±r
;…nÙğ²Ùe->
Ãxt
) {

1614 ià(!
	`hide_nÙe
(
ch
, 
²Ùe
)) {

1615 ià(
ÚÙe
 =ğ
nuÎ±r
 || 
²Ùe
->
d©e_¡amp
 <ğ
o¡amp
) {

1616 
obis
 = &*
™
;

1617 
Úum
 = 
Âum
;

1618 
ÚÙe
 = 
²Ùe
;

1619 
o¡amp
 = 
²Ùe
->
d©e_¡amp
;

1624 ià(
	`is_nÙe_to
(
ch
, 
²Ùe
))

1625 
Âum
++;

1630 ià(
ÚÙe
 =ğ
nuÎ±r
) {

1631 
	`¡c
("Th©' ®ÈfŞks!\n", 
ch
);

1636 
	`±c
(
ch
, "{W[%s{W: {x%3d{W] From:{x %s\n"

1640 
obis
->
bßrd_hdr
,

1641 
Úum
,

1642 
ÚÙe
->
£nd”
,

1643 
ÚÙe
->
to_li¡
,

1644 
ÚÙe
->
d©e
,

1645 
ÚÙe
->
subjeù
);

1646 
	`¡c
("{W================================================================================{x\n", 
ch
);

1647 
	`·ge_to_ch¬
(
ÚÙe
->
‹xt
, 
ch
);

1648 
	`upd©e_»ad
(
ch
, 
ÚÙe
);

1649 
	}
}

1652 cÚ¡ 
SŒšg
 
	$w¿p_¡ršg
(cÚ¡ 
SŒšg
& 
s
, 
w¿p_Ën
) {

1653 
SŒšg
 
	`¡r
(
s
), 
ouut
;

1654 
cŞÜ_pos
 = 0, 
uncŞÜ_pos
 = 0, 
Ï¡_¥aû_pos
 = 0;

1656 
cŞÜ_pos
 < 
¡r
.
	`size
()) {

1657 
¡r
[
cŞÜ_pos
]) {

1659 ià(
cŞÜ_pos
 < 
¡r
.
	`size
()-1

1660 && 
¡r
[
cŞÜ_pos
+1] == '{')

1661 
uncŞÜ_pos
++;

1663 
cŞÜ_pos
 += 2;

1666 
Ï¡_¥aû_pos
 = 
cŞÜ_pos
;

1669 
uncŞÜ_pos
++;

1670 
cŞÜ_pos
++;

1674 ià(
uncŞÜ_pos
 > 
w¿p_Ën
) {

1675 
ouut
 +ğ
¡r
.
	`sub¡r
(0, 
Ï¡_¥aû_pos
);

1676 
ouut
 += '\n';

1677 
¡r
 = sŒ.
	`sub¡r
(
Ï¡_¥aû_pos
+1);

1678 
cŞÜ_pos
 = 
uncŞÜ_pos
 = 
Ï¡_¥aû_pos
 = 0;

1682 
ouut
 +ğ
¡r
;

1683  
ouut
;

1684 
	}
}

1687 cÚ¡ 
SŒšg
 
	$fÜm©_·¿g¿ph
(cÚ¡ 
SŒšg
& 
Üig_·¿g¿ph
) {

1689 
SŒšg
 
·¿g¿ph
 = 
Üig_·¿g¿ph
.
	`»¶aû
("\n", " ").
	`¡r
();

1691 ià(
·¿g¿ph
.
	`em±y
())

1694 
SŒšg
 
buf
;

1695 
pos
;

1698 (
pos
 = 
·¿g¿ph
.
	`fšd
(" ")è!ğ
¡d
::
¡ršg
::
Åos
)

1699 
·¿g¿ph
 =…¬ag¿ph.
	`sub¡r
(0, 
pos
) +…aragraph.substr(pos+1);

1702 
·¿g¿ph
 =…¬ag¿ph.
	`»¶aû
(". )", ".)");

1703 
·¿g¿ph
 =…¬ag¿ph.
	`»¶aû
("! )", "!)");

1704 
·¿g¿ph
 =…¬ag¿ph.
	`»¶aû
("? )", "?)");

1707 
pos
 = 0;…o < 
·¿g¿ph
.
	`size
()-2;…os++)

1708 ià(
·¿g¿ph
[
pos
+1] == ' '

1709 && (
·¿g¿ph
[
pos
] == '.'

1710 || 
·¿g¿ph
[
pos
] == '!'

1711 || 
·¿g¿ph
[
pos
] == '?'))

1712 
·¿g¿ph
[
pos
+2] = 
	`touµ”
(paragraph[pos+2]);

1715 
·¿g¿ph
 =…¬ag¿ph.
	`»¶aû
(". ", ". ");

1716 
·¿g¿ph
 =…¬ag¿ph.
	`»¶aû
("! ", "! ");

1717 
·¿g¿ph
 =…¬ag¿ph.
	`»¶aû
("? ", "? ");

1719  
	`SŒšg
(" "è+ 
·¿g¿ph
;

1720 
	}
}

1723 cÚ¡ 
SŒšg
 
	$fÜm©_·ge
(cÚ¡ 
SŒšg
& 
Üig_·ge
, 
w¿p_Ën
) {

1724 
SŒšg
 
	`·ge
(
Üig_·ge
), 
·¿g¿ph
;

1725 
¡d
::
veùÜ
<
SŒšg
> 
·¿g¿phs
;

1728 !
·ge
.
	`em±y
(è&&…age.
	`äÚt
() == '\n') {

1729 
·ge
.
	`”a£
(0, 1);

1730 
·¿g¿phs
.
	`push_back
("");

1734 !
·ge
.
	`em±y
()) {

1735 
pos
 = 
·ge
.
	`fšd
("\n\n");

1737 ià(
pos
 =ğ
¡d
::
¡ršg
::
Åos
) {

1738 
·¿g¿ph
 = 
·ge
;

1739 
·ge
.
	`ş—r
();

1742 
·¿g¿ph
 = 
·ge
.
	`sub¡r
(0, 
pos
);

1744 ià(
pos
 < 
·ge
.
	`size
()-1)

1745 
·ge
 =…age.
	`sub¡r
(
pos
+1);

1747 
·ge
.
	`ş—r
();

1750 
·¿g¿phs
.
	`push_back
(
	`w¿p_¡ršg
(
	`fÜm©_·¿g¿ph
(
·¿g¿ph
), 
w¿p_Ën
));

1753 !
·ge
.
	`em±y
(è&&…age.
	`äÚt
() == '\n') {

1754 
·ge
.
	`”a£
(0, 1);

1755 
·¿g¿phs
.
	`push_back
("");

1759 
SŒšg
 
ouut
;

1761 
SŒšg
& 
·¿g¿ph
: 
·¿g¿phs
) {

1762 
ouut
 +ğ
·¿g¿ph
;

1763 
ouut
 += '\n';

1766  
ouut
;

1767 
	}
}

1769 
SŒšg
 
	$fÜm©_¡ršg
(cÚ¡ 
SŒšg
& 
s
) {

1770  
	`fÜm©_·ge
(
s
, 77);

1771 
	}
}

1777 
SŒšg
 
	$fÜm©_¡ršg_Şd
(cÚ¡ 
SŒšg
& 
Şd¡ršg
)

1779 
SŒšg
 
xbuf
;

1780 
xbuf2
[
MAX_STRING_LENGTH
];

1781 *
rdesc
;

1782 
i
 = 0, 
j
;

1783 
boŞ
 
ÿp
 = 
Œue
, 
bÏnklše
 = 
çl£
;

1784 
xbuf2
[0] = '\0';

1786 
Şdbuf
[
MSL
];

1787 
	`¡rıy
(
Şdbuf
, 
Şd¡ršg
);

1789 
rdesc
 = 
Şdbuf
; *rdesc;„desc++) {

1793 ià(*
rdesc
 == '\n') {

1794 ià(
bÏnklše
) {

1795 
xbuf
[
i
] = '\n';

1796 
ÿp
 = 
Œue
;

1797 
i
++;

1799 ià(
xbuf
[
i
 - 1] != ' ') {

1800 
xbuf
[
i
] = ' ';

1801 
i
++;

1804 
bÏnklše
 = 
Œue
;

1809 ià(*
rdesc
 == '\r')

1813 ià(*
rdesc
 == ' ') {

1814 ià(
xbuf
[
i
 - 1] != ' ') {

1815 
xbuf
[
i
] = ' ';

1816 
i
++;

1823 
bÏnklše
 = 
çl£
;

1826 ià(*
rdesc
 == ')') {

1827 ià(
xbuf
[
i
 - 1] == ' '

1828 && 
xbuf
[
i
 - 2] == ' '

1829 && (
xbuf
[
i
 - 3] == '.'

1830 || 
xbuf
[
i
 - 3] == '?'

1831 || 
xbuf
[
i
 - 3] == '!')) {

1832 
xbuf
[
i
 - 2] = *
rdesc
;

1833 
xbuf
[
i
 - 1] = ' ';

1834 
xbuf
[
i
] = ' ';

1835 
i
++;

1838 
xbuf
[
i
] = *
rdesc
;

1839 
i
++;

1844 ià(*
rdesc
 == '.' || *rdesc == '?' || *rdesc == '!') {

1846 ià(
xbuf
[
i
 - 1] == ' '

1847 && 
xbuf
[
i
 - 2] == ' '

1848 && (
xbuf
[
i
 - 3] == '.'

1849 || 
xbuf
[
i
 - 3] == '?'

1850 || 
xbuf
[
i
 - 3] == '!')) {

1853 
xbuf
[
i
 - 2] = *
rdesc
;

1855 ià(*(
rdesc
 + 1) != '\"') {

1856 
xbuf
[
i
 - 1] = ' ';

1857 
xbuf
[
i
] = ' ';

1858 
i
++;

1861 
xbuf
[
i
 - 1] = '\"';

1862 
xbuf
[
i
] = ' ';

1863 
xbuf
[
i
 + 1] = ' ';

1864 
i
 += 2;

1865 
rdesc
++;

1869 
xbuf
[
i
] = *
rdesc
;

1871 ià(*(
rdesc
 + 1) != '\"') {

1872 
xbuf
[
i
 + 1] = ' ';

1873 
xbuf
[
i
 + 2] = ' ';

1874 
i
 += 3;

1877 
xbuf
[
i
 + 1] = '\"';

1878 
xbuf
[
i
 + 2] = ' ';

1879 
xbuf
[
i
 + 3] = ' ';

1880 
i
 += 4;

1881 
rdesc
++;

1885 
ÿp
 = 
Œue
;

1889 
xbuf
[
i
] = *
rdesc
;

1891 ià(
ÿp
) {

1892 
ÿp
 = 
çl£
;

1893 
xbuf
[
i
] = 
	`touµ”
(xbuf[i]);

1896 
i
++;

1902 
	`¡rıy
(
xbuf2
, 
xbuf
);

1903 
rdesc
 = 
xbuf2
;

1904 
xbuf
.
	`ş—r
();

1905 
bÏnklše
 = 
çl£
;

1911 
i
 = 0, 
j
 = 0; * (
rdesc
 + i) && j < 77; i++) {

1914 ià(*(
rdesc
 + 
i
) == '\n')

1916 ià(*(
rdesc
 + 
i
) == '{') {

1917 ià(*(
rdesc
 + 
i
 + 1) == '{')

1918 
j
++;

1920 
i
++;

1923 
j
++;

1927 ià(*(
rdesc
 + 
i
) == '\n') {

1928 *(
rdesc
 + 
i
) = 0;

1929 
xbuf
 +ğ
rdesc
;

1931 ià(!
bÏnklše
)

1932 
xbuf
 += "\n";

1934 
xbuf
 += "\n";

1935 
bÏnklše
 = 
Œue
;

1936 
rdesc
 +ğ
i
 + 1;

1938 *
rdesc
 == ' ')

1939 
rdesc
++;

1944 
bÏnklše
 = 
çl£
;

1946 ià(
j
 < 77)

1950 ; 
i
; i--)

1951 ià(*(
rdesc
 + 
i
) == ' ')

1954 ià(
i
) {

1955 *(
rdesc
 + 
i
) = 0;

1956 
xbuf
 +ğ
rdesc
;

1957 
xbuf
 += "\n";

1958 
rdesc
 +ğ
i
 + 1;

1960 *
rdesc
 == ' ')

1961 
rdesc
++;

1965 *(
rdesc
 + 75) = 0;

1966 
xbuf
 +ğ
rdesc
;

1967 
xbuf
 += "-\n";

1968 
rdesc
 += 76;

1973 *(
rdesc
 + 
i
) && (*(rdesc + i) == ' '

1974 || *(
rdesc
 + 
i
) == '\n'

1975 || *(
rdesc
 + 
i
) == '\r'))

1976 
i
--;

1978 *(
rdesc
 + 
i
 + 1) = 0;

1979 
xbuf
 +ğ
rdesc
;

1981 ià(
xbuf
[
	`¡¾’
(xbuf) - 2] != '\n')

1982 
xbuf
 += "\n";

1984  
xbuf
;

1985 
	}
}

	@src/Object.cc

1 
	~"Objeù.hh
"

3 
	~"afãù/afãù_li¡.hh
"

4 
	~"afãù/Afãù.hh
"

5 
	~"ExŒaDesü.hh
"

6 
	~"¿ndom.hh
"

7 
	~"cÚ¡ªts.hh
"

9 
	gObjeù
::~
	$Objeù
() {

11 
afãù
::
	`ş—r_li¡
(&
this
->
afãùed
);

12 
afãù
::
	`ş—r_li¡
(&
this
->
gem_afãùed
);

14 
ExŒaDesü
 *
ed
, *
ed_Ãxt
;

15 
ed
 = 
this
->
exŒa_desü
;ƒd !ğ
nuÎ±r
;ƒd = 
ed_Ãxt
) {

16 
ed_Ãxt
 = 
ed
->
Ãxt
;

17 
d–‘e
 
ed
;

21 
	}
}

23 
	$unique_™em
(
Objeù
 *
™em
)

25 
boŞ
 
added
 = 
çl£
;

27 ià(!
	`rŞl_chªû
(2))

31 ià(
™em
->
™em_ty³
 =ğ
ITEM_ANVIL


33 || 
™em
->
™em_ty³
 =ğ
ITEM_FOOD


34 || 
™em
->
™em_ty³
 =ğ
ITEM_BOAT


35 || 
™em
->
™em_ty³
 =ğ
ITEM_CORPSE_NPC


36 || 
™em
->
™em_ty³
 =ğ
ITEM_CORPSE_PC


37 || 
™em
->
™em_ty³
 =ğ
ITEM_FOUNTAIN


38 || 
™em
->
™em_ty³
 =ğ
ITEM_MAP


39 || 
™em
->
™em_ty³
 =ğ
ITEM_PBTUBE


40 || 
™em
->
™em_ty³
 =ğ
ITEM_PBGUN


41 || 
™em
->
™em_ty³
 =ğ
ITEM_PORTAL


42 || 
™em
->
™em_ty³
 =ğ
ITEM_TRASH


43 || 
™em
->
™em_ty³
 =ğ
ITEM_KEY


44 || 
™em
->
™em_ty³
 =ğ
ITEM_WEDDINGRING


45 || 
™em
->
™em_ty³
 =ğ
ITEM_TOKEN


46 || 
™em
->
™em_ty³
 =ğ
ITEM_JUKEBOX


47 || 
™em
->
™em_ty³
 =ğ
ITEM_WARP_CRYSTAL
)

51 ià(
™em
->
™em_ty³
 !ğ
ITEM_FURNITURE


52 && !
	`CAN_WEAR
(
™em
, 
ITEM_TAKE
))

56 ià(
™em
->
™em_ty³
 !ğ
ITEM_FURNITURE


57 && 
™em
->
™em_ty³
 !ğ
ITEM_CONTAINER


58 && 
™em
->
™em_ty³
 !ğ
ITEM_MATERIAL


59 && 
™em
->
™em_ty³
 !ğ
ITEM_TREASURE


60 && 
™em
->
™em_ty³
 !ğ
ITEM_GEM


61 && 
™em
->
™em_ty³
 !ğ
ITEM_JEWELRY


62 && 
™em
->
™em_ty³
 !ğ
ITEM_SCROLL


63 && 
™em
->
™em_ty³
 !ğ
ITEM_POTION


64 && 
™em
->
™em_ty³
 !ğ
ITEM_PILL


65 && 
™em
->
™em_ty³
 !ğ
ITEM_MONEY


66 && 
™em
->
w—r_æags
.
	`to_ulÚg
(è<
ITEM_WEAR_FINGER
)

70 ià(
	`rŞl_chªû
(40)) {

71 
loc
 = 0, 
mod
 = 0;

73 
	`numb”_¿nge
(1, 14)) {

75 
loc
 = 
APPLY_STR
;

76 
mod
 = 
	`numb”_¿nge
(-1 * ((
™em
->
Ëv–
 / 50) + 1), ((item->level / 50) + 1));

80 
loc
 = 
APPLY_DEX
;

81 
mod
 = 
	`numb”_¿nge
(-1 * ((
™em
->
Ëv–
 / 50) + 1), ((item->level / 50) + 1));

85 
loc
 = 
APPLY_INT
;

86 
mod
 = 
	`numb”_¿nge
(-1 * ((
™em
->
Ëv–
 / 50) + 1), ((item->level / 50) + 1));

90 
loc
 = 
APPLY_WIS
;

91 
mod
 = 
	`numb”_¿nge
(-1 * ((
™em
->
Ëv–
 / 50) + 1), ((item->level / 50) + 1));

95 
loc
 = 
APPLY_CON
;

96 
mod
 = 
	`numb”_¿nge
(-1 * ((
™em
->
Ëv–
 / 50) + 1), ((item->level / 50) + 1));

100 
loc
 = 
APPLY_CHR
;

101 
mod
 = 
	`numb”_¿nge
(-1 * ((
™em
->
Ëv–
 / 50) + 1), ((item->level / 50) + 1));

105 
loc
 = 
APPLY_AGE
;

106 
mod
 = 
	`numb”_¿nge
(-1 * ((
™em
->
Ëv–
 / 20) + 1), ((item->level / 20) + 1));

110 
loc
 = 
APPLY_HIT
;

111 
mod
 = 
	`numb”_¿nge
(-1 * ((
™em
->
Ëv–
 / 2) + 1), ((item->level / 2) + 1));

115 
loc
 = 
APPLY_MANA
;

116 
mod
 = 
	`numb”_¿nge
(-1 * ((
™em
->
Ëv–
 / 2) + 1), ((item->level / 2) + 1));

120 
loc
 = 
APPLY_STAM
;

121 
mod
 = 
	`numb”_¿nge
(-1 * ((
™em
->
Ëv–
 / 2) + 1), ((item->level / 2) + 1));

125 
loc
 = 
APPLY_AC
;

126 
mod
 = 
	`numb”_¿nge
(-1 * ((
™em
->
Ëv–
 / 30) + 1), ((item->level / 30) + 1));

130 
loc
 = 
APPLY_HITROLL
;

131 
mod
 = 
	`numb”_¿nge
(-1 * ((
™em
->
Ëv–
 / 30) + 1), ((item->level / 30) + 1));

135 
loc
 = 
APPLY_DAMROLL
;

136 
mod
 = 
	`numb”_¿nge
(-1 * ((
™em
->
Ëv–
 / 30) + 1), ((item->level / 30) + 1));

140 
loc
 = 
APPLY_SAVES
;

141 
mod
 = 
	`numb”_¿nge
(-1 * ((
™em
->
Ëv–
 / 30) + 1), ((item->level / 30) + 1));

145 ià(
mod
 == 0) {

146 ià(
	`rŞl_chªû
(50))

147 
mod
 = 1;

149 
mod
 = -1;

152 
afãù
::
Afãù
 
af
;

153 
af
.
wh”e
 = 
TO_OBJECT
;

154 
af
.
ty³
 = 
afãù
::ty³::
nÚe
;

155 
af
.
Ëv–
 = 
™em
->level;

156 
af
.
du¿tiÚ
 = -1;

157 
af
.
loÿtiÚ
 = 
loc
;

158 
af
.
modif›r
 = 
mod
;

159 
af
.
	`b™veùÜ
(0);

160 
af
.
evŞutiÚ
 = 1;

161 
afãù
::
	`još_to_obj
(
™em
, &
af
);

163 
added
 = 
Œue
;

166 ià(
	`rŞl_chªû
(50)) {

167 
x
;

168 
added
 = 
Œue
;

170 
™em
->
™em_ty³
) {

172 
ITEM_LIGHT
:

173 
ITEM_CLOTHING
:

174 
ITEM_TREASURE
:

175 
ITEM_WARP_STONE
:

176 
ITEM_GEM
:

177 
ITEM_JEWELRY
:

178 
added
 = 
çl£
;

181 
ITEM_MONEY
:

182 ià(
	`rŞl_chªû
(50))

183 
™em
->
v®ue
[0] = 
	`numb”_¿nge
(item->value[0] * 1 / 2, item->value[0] * 3 / 2);

185 
™em
->
v®ue
[1] = 
	`numb”_¿nge
(item->value[1] * 1 / 2, item->value[1] * 3 / 2);

189 
ITEM_FURNITURE
:

190 ià(
	`rŞl_chªû
(50))

191 
™em
->
v®ue
[3] = 
	`numb”_¿nge
(item->value[3] * 3 / 4, item->value[3] * 5 / 4);

193 
™em
->
v®ue
[4] = 
	`numb”_¿nge
(item->value[4] * 3 / 4, item->value[4] * 5 / 4);

197 
ITEM_CONTAINER
:

198 ià(
	`rŞl_chªû
(33))

199 
™em
->
v®ue
[0] = 
	`numb”_¿nge
(item->value[0] * 3 / 4, item->value[0] * 5 / 4);

200 ià(
	`rŞl_chªû
(50))

201 
™em
->
v®ue
[3] = 
	`numb”_¿nge
(item->value[3] * 3 / 4, item->value[3] * 5 / 4);

203 
™em
->
v®ue
[4] = 
	`numb”_¿nge
(item->value[4] * 3 / 4, item->value[4] * 5 / 4);

207 
ITEM_DRINK_CON
:

208 
™em
->
v®ue
[3] = 
	`numb”_¿nge
(0, 1);

211 
ITEM_MATERIAL
:

212 ià(
	`rŞl_chªû
(33))

213 
™em
->
v®ue
[0] = 
	`numb”_¿nge
(item->value[0] * 3 / 4, item->value[0] * 5 / 4);

214 ià(
	`rŞl_chªû
(50)) {

215 ià(
	`rŞl_chªû
(50))

216 ++
™em
->
v®ue
[1];

218 --
™em
->
v®ue
[1];

221 ià(
	`rŞl_chªû
(50))

222 ++
™em
->
v®ue
[2];

224 --
™em
->
v®ue
[2];

229 
ITEM_SCROLL
:

230 
ITEM_POTION
:

231 
ITEM_PILL
:

232 
™em
->
v®ue
[0] = 
	`numb”_¿nge
(item->value[0] * 5 / 6, item->value[0] * 7 / 6);

235 
ITEM_WAND
:

236 
ITEM_STAFF
:

237 ià(
	`rŞl_chªû
(33))

238 
™em
->
v®ue
[0] = 
	`numb”_¿nge
(item->value[0] * 9 / 10, item->value[0] * 11 / 10);

239 ià(
	`rŞl_chªû
(50))

240 
™em
->
v®ue
[1] = 
	`numb”_¿nge
(item->value[1] * 3 / 4, item->value[1] * 3 / 4);

242 
™em
->
v®ue
[2] = 
	`numb”_¿nge
(item->value[2] * 3 / 4, item->value[2] * 3 / 4);

244 ià(
™em
->
v®ue
[2] > item->value[1])

245 
™em
->
v®ue
[1] = item->value[2];

249 
ITEM_ARMOR
:

250 
x
 = 
	`numb”_¿nge
(0, 3);

251 
™em
->
v®ue
[
x
] = 
	`numb”_¿nge
(item->value[x] * 4 / 5, item->value[x] * 6 / 5);

254 
ITEM_WEAPON
:

255 ià(
	`rŞl_chªû
(40)) {

256 ià(
	`rŞl_chªû
(50))

257 ++
™em
->
v®ue
[1];

259 --
™em
->
v®ue
[1];

261 ià(
	`rŞl_chªû
(66)) {

262 ià(
	`rŞl_chªû
(50))

263 ++
™em
->
v®ue
[2];

265 --
™em
->
v®ue
[2];

268 
afãù
::
ty³
ype;

270 
	`numb”_¿nge
(1, 8)) {

272 1: 
ty³
 = 
afãù
::ty³::
w—pÚ_æamšg
; ;

273 2: 
ty³
 = 
afãù
::ty³::
w—pÚ_äo¡
; ;

274 3: 
ty³
 = 
afãù
::ty³::
w—pÚ_vampœic
; ;

275 4: 
ty³
 = 
afãù
::ty³::
w—pÚ_sh¬p
; ;

276 5: 
ty³
 = 
afãù
::ty³::
w—pÚ_vÜ·l
; ;

277 6: 
ty³
 = 
afãù
::ty³::
w—pÚ_two_hªds
; ;

278 7: 
ty³
 = 
afãù
::ty³::
w—pÚ_shockšg
; ;

279 8: 
ty³
 = 
afãù
::ty³::
poisÚ
; ;

282 ià(!
afãù
::
	`exi¡s_Ú_obj
(
™em
, 
ty³
)) {

283 
afãù
::
Afãù
 
af
;

284 
af
.
wh”e
 = 
TO_WEAPON
;

285 
af
.
ty³
 =ype;

286 
af
.
Ëv–
 = 
™em
->level;

287 
af
.
du¿tiÚ
 = -1;

288 
af
.
loÿtiÚ
 = 0;

289 
af
.
modif›r
 = 0;

290 
af
.
	`b™veùÜ
(0);

291 
af
.
evŞutiÚ
 = 1;

292 
afãù
::
	`cİy_to_obj
(
™em
, &
af
);

300 ià(
	`rŞl_chªû
(66)) {

301 
	`numb”_¿nge
(1, 3)) {

303 ià(
	`rŞl_chªû
(50)) {

304 
™em
->
co¡
 = 
	`numb”_¿nge
(item->cost, (item->cost * 2) + 1);

305 
added
 = 
Œue
;

307 ià(
™em
->
co¡
 > 0) {

308 
™em
->
co¡
 = 
	`numb”_¿nge
(0, item->cost);

309 
added
 = 
Œue
;

312 
added
 = 
çl£
;

317 ià(
	`rŞl_chªû
(50)) {

318 
™em
->
weight
 = 
	`numb”_¿nge
(item->weight, (item->weight * 2) + 1);

319 
™em
->
weight
 = 
¡d
::
	`mš
(item->weight, 30000);

320 
added
 = 
Œue
;

322 ià(
™em
->
weight
 > 0) {

323 
™em
->
weight
 = 
	`numb”_¿nge
(0, item->weight);

324 
added
 = 
Œue
;

327 
added
 = 
çl£
;

332 ià(
	`rŞl_chªû
(1))

333 
™em
->
cÚd™iÚ
 = -1;

335 
™em
->
cÚd™iÚ
 = 
	`numb”_¿nge
(1, 100);

337 
added
 = 
Œue
;

344 ià(
™em
->
Ëv–
 > 
LEVEL_IMMORTAL
) {

345 ià(
	`rŞl_chªû
(75))

346 
™em
->
Ëv–
--;

348 
™em
->
Ëv–
 -= 2;

350 ià(
™em
->
Ëv–
 < 
LEVEL_IMMORTAL
)

351 
™em
->
Ëv–
 = 
LEVEL_IMMORTAL
;

353 
added
 = 
Œue
;

355 ià(
™em
->
Ëv–
 < 
LEVEL_IMMORTAL
 && item->level > 0) {

356 ià(
	`rŞl_chªû
(50))

357 
™em
->
Ëv–
 --;

358 ià(
	`rŞl_chªû
(60))

359 
™em
->
Ëv–
 -= 2;

361 
™em
->
Ëv–
 -= 3;

363 ià(
™em
->
Ëv–
 < 0)

364 
™em
->
Ëv–
 = 0;

366 
added
 = 
Œue
;

369 
added
 = 
çl£
;

372 ià(
added
) {

396 
	}
}

	@src/ObjectPrototype.cc

1 
	~"ObjeùPrÙÙy³.hh
"

2 
	~"A»a.hh
"

3 
	~"fe.hh
"

4 
	~"lookup.hh
"

5 
	~"skl/skl.hh
"

6 
	~"afãù/afãù_li¡.hh
"

7 
	~"ExŒaDesü.hh
"

8 
	~"LoÿtiÚ.hh
"

9 
	~"Loggšg.hh
"

11 
	gObjeùPrÙÙy³
::

12 
	$ObjeùPrÙÙy³
(
A»a
& 
¬—
, cÚ¡ 
Vnum
& 
vnum
, 
FILE
 *
å
) :

13 
	`¬—
(
¬—
),

14 
	$vnum
(
vnum
)

16 
»£t_num
 = 0;

17 
Çme
 = 
	`ä—d_¡ršg
(
å
);

18 
shÜt_desü
 = 
	`ä—d_¡ršg
(
å
);

19 
desütiÚ
 = 
	`ä—d_¡ršg
(
å
);

20 
m©”Ÿl
 = 
	`ä—d_¡ršg
(
å
);

21 
™em_ty³
 = 
	`™em_lookup
(
	`ä—d_wÜd
(
å
));

22 
exŒa_æags
 = 
	`ä—d_æag
(
å
);

23 
w—r_æags
 = 
	`ä—d_æag
(
å
);

24 
num_£‰šgs
 = 0;

27 
v®
 = 0;

28 
™em_ty³
) {

29 
ITEM_WEAPON
:

30 
v®ue
[
v®
] = 
	`ObjeùV®ue
(
	`g‘_w—pÚ_ty³
(
	`ä—d_wÜd
(
å
)));

33 
ITEM_KEY
:

34 
v®ue
[
v®
] = 
	`ObjeùV®ue
(
	`ä—d_æag
(
å
));

38 
v®ue
[
v®
] = 
	`ObjeùV®ue
(
	`ä—d_numb”
(
å
));

43 
v®
 = 1;

44 
™em_ty³
) {

45 
ITEM_CONTAINER
:

46 
ITEM_CORPSE_NPC
:

47 
ITEM_CORPSE_PC
:

48 
ITEM_PORTAL
:

49 
v®ue
[
v®
] = 
	`ObjeùV®ue
(
	`ä—d_æag
(
å
));

52 
ITEM_POTION
:

53 
ITEM_PILL
:

54 
ITEM_SCROLL
:

55 
v®ue
[
v®
] = 
	`ObjeùV®ue
(()
skl
::
	`lookup
(
	`ä—d_wÜd
(
å
)));

59 
v®ue
[
v®
] = 
	`ObjeùV®ue
(
	`ä—d_numb”
(
å
));

64 
v®
 = 2;

65 
™em_ty³
) {

66 
ITEM_DRINK_CON
:

67 
ITEM_FOUNTAIN
:

68 
v®ue
[
v®
] = 
	`ObjeùV®ue
(
	`liq_lookup
(
	`ä—d_wÜd
(
å
)));

70 ià(
v®ue
[
v®
] == -1) {

71 
v®ue
[
v®
] = 0;

72 
Loggšg
::
	`fe_bug
(
å
, "Unknown†iquidype", 0);

77 
ITEM_POTION
:

78 
ITEM_PILL
:

79 
ITEM_SCROLL
:

80 
v®ue
[
v®
] = 
	`ObjeùV®ue
(()
skl
::
	`lookup
(
	`ä—d_wÜd
(
å
)));

83 
ITEM_FURNITURE
:

84 
ITEM_PORTAL
:

85 
ITEM_ANVIL
:

86 
v®ue
[
v®
] = 
	`ObjeùV®ue
(
	`ä—d_æag
(
å
));

90 
v®ue
[
v®
] = 
	`ObjeùV®ue
(
	`ä—d_numb”
(
å
));

95 
v®
 = 3;

96 
™em_ty³
) {

97 
ITEM_WEAPON
:

98 
v®ue
[
v®
] = 
	`ObjeùV®ue
(
	`©ck_lookup
(
	`ä—d_wÜd
(
å
)));

101 
ITEM_WAND
:

102 
ITEM_STAFF
:

103 
ITEM_POTION
:

104 
ITEM_PILL
:

105 
ITEM_SCROLL
:

106 
v®ue
[
v®
] = 
	`ObjeùV®ue
(()
skl
::
	`lookup
(
	`ä—d_wÜd
(
å
)));

109 
ITEM_DRINK_CON
:

110 
ITEM_FOUNTAIN
:

111 
ITEM_FOOD
:

112 
v®ue
[
v®
] = 
	`ObjeùV®ue
(
	`ä—d_æag
(
å
));

115 
ITEM_PORTAL
:

116 
v®ue
[
v®
] = 
	`ObjeùV®ue
(
	`LoÿtiÚ
(
	`ä—d_wÜd
(
å
)).
	`to_št
());

120 
v®ue
[
v®
] = 
	`ObjeùV®ue
(
	`ä—d_numb”
(
å
));

125 
v®
 = 4;

126 
™em_ty³
) {

127 
ITEM_WEAPON
: {

128 
FÏgs
 
b™veùÜ
 = 
	`ä—d_æag
(
å
);

131 
v®ue
[
v®
] = 
	`ObjeùV®ue
(
b™veùÜ
);

133 
afãù
::
Afãù
 
af
;

134 
af
.
Ëv–
 =†evel;

135 
af
.
du¿tiÚ
 = -1;

136 
af
.
evŞutiÚ
 = 1;

137 
af
.
³rmª’t
 = 
Œue
;

138 
af
.
loÿtiÚ
 = 0;

139 
af
.
modif›r
 = 0;

141 !
b™veùÜ
.
	`em±y
()) {

142 
af
.
ty³
 = 
afãù
::ty³::
nÚe
;

144 ià(
afãù
::
	`·r£_æags
('W', &
af
, 
b™veùÜ
))

145 
afãù
::
	`cİy_to_li¡
(&
afãùed
, &
af
);

151 
ITEM_POTION
:

152 
ITEM_PILL
:

153 
ITEM_SCROLL
:

154 
v®ue
[
v®
] = 
	`ObjeùV®ue
(()
skl
::
	`lookup
(
	`ä—d_wÜd
(
å
)));

158 
v®ue
[
v®
] = 
	`ObjeùV®ue
(
	`ä—d_numb”
(
å
));

163 
Ëv–
 = 
	`ä—d_numb”
(
å
);

168 
afãù
::
â_·¿ms
 
·¿ms
;

169 
·¿ms
.
owÃr
 = 
nuÎ±r
;

170 
·¿ms
.
d©a
 = &
Ëv–
;

172 
afãù
::
	`™”©e_ov”_li¡
(

173 &
afãùed
,

174 
afãù
::
â_£t_Ëv–
,

175 &
·¿ms


178 
weight
 = 
	`ä—d_numb”
(
å
);

179 
co¡
 = 
	`ä—d_numb”
(
å
);

181 
Ë‰”
 = 
	`ä—d_Ë‰”
(
å
);

183 
Ë‰”
) {

184 ('P'è: 
cÚd™iÚ
 = 100; ;

186 ('G'è: 
cÚd™iÚ
 = 90; ;

188 ('A'è: 
cÚd™iÚ
 = 75; ;

190 ('W'è: 
cÚd™iÚ
 = 50; ;

192 ('D'è: 
cÚd™iÚ
 = 25; ;

194 ('B'è: 
cÚd™iÚ
 = 10; ;

196 ('R'è: 
cÚd™iÚ
 = 5; ;

198 ('I'è: 
cÚd™iÚ
 = -1; ;

200 : 
cÚd™iÚ
 = 100; ;

204 
Ë‰”
;

205 
Ë‰”
 = 
	`ä—d_Ë‰”
(
å
);

207 ià(
Ë‰”
 == 'A') {

208 
afãù
::
Afãù
 
af
;

209 
af
.
ty³
 = 
afãù
::ty³::
nÚe
;

210 
af
.
Ëv–
 =†evel;

211 
af
.
du¿tiÚ
 = -1;

212 
af
.
loÿtiÚ
 = 
	`ä—d_numb”
(
å
);

213 
af
.
modif›r
 = 
	`ä—d_numb”
(
å
);

214 
af
.
evŞutiÚ
 = 1;

215 
af
.
	`b™veùÜ
(0);

216 
af
.
³rmª’t
 = 
Œue
;

218 
FÏgs
 
b™veùÜ
 = 0;

219 ià(
afãù
::
	`·r£_æags
('O', &
af
, 
b™veùÜ
)) {

220 
afãù
::
	`cİy_to_li¡
(&
afãùed
, &
af
);

223 ià(
Ë‰”
 == 'F') {

224 
afãù
::
Afãù
 
af
;

225 
af
.
ty³
 = 
afãù
::ty³::
nÚe
;

226 
af
.
Ëv–
 =†evel;

227 
af
.
du¿tiÚ
 = -1;

228 
af
.
evŞutiÚ
 = 1;

229 
af
.
³rmª’t
 = 
Œue
;

231 
Ë‰”
 = 
	`ä—d_Ë‰”
(
å
);

232 
af
.
loÿtiÚ
 = 
	`ä—d_numb”
(
å
);

233 
af
.
modif›r
 = 
	`ä—d_numb”
(
å
);

235 
FÏgs
 
b™veùÜ
 = 
	`ä—d_æag
(
å
);

239 ià(
afãù
::
	`·r£_æags
(
Ë‰”
, &
af
, 
b™veùÜ
)) {

240 
afãù
::
	`cİy_to_li¡
(&
afãùed
, &
af
);

243 
af
.
loÿtiÚ
 = 0;

244 
af
.
modif›r
 = 0;

247 
af
.
ty³
 = 
afãù
::ty³::
nÚe
;

248 } !
b™veùÜ
.
	`em±y
());

250 ià(
Ë‰”
 == 'E') {

251 
ExŒaDesü
 *
ed
 = 
Ãw
 
	`ExŒaDesü
(
	`ä—d_¡ršg
(
å
), fread_string(fp));

252 
ed
->
Ãxt
 = 
exŒa_desü
;

253 
exŒa_desü
 = 
ed
;

255 ià(
Ë‰”
 == 'S') {

256 
num_£‰šgs
 = 
	`ä—d_numb”
(
å
);

258 ià(
Ë‰”
 == 'G'){

261 ià((
gud
 = 
	`gud_lookup
(
	`ä—d_¡ršg
(
å
))è=ğ
Gud
::
nÚe
) {

262 
Loggšg
::
	`fe_bug
(
å
, "Load_rooms: invalid class in guild", 0);

263 ::
	`ex™
(1);

267 
	`ung‘c
(
Ë‰”
, 
å
);

273 
afãù_checksum
 = 
afãù
::
	`checksum_li¡
(&
afãùed
);

275 
	}
}

	@src/ObjectValue.cc

1 
	~"ObjeùV®ue.hh
"

3 
	~"FÏgs.hh
"

5 
	gObjeùV®ue
::

6 
	$ObjeùV®ue
(cÚ¡ 
FÏgs
& 
v
è: 
	`_v®ue
(v.
	`to_ulÚg
()), 
	$_as_æags
(
Œue
è{
	}
}

8 
	gObjeùV®ue
::

9 
İ”©Ü
 
	$FÏgs
() const {

10  
	`FÏgs
(
_v®ue
);

11 
	}
}

13 cÚ¡ 
FÏgs
 
	gObjeùV®ue
::

14 
	$æags
() const {

15  
	`FÏgs
(
_v®ue
);

16 
	}
}

18 
	gObjeùV®ue
& ObjectValue::

19 
İ”©Ü
=(cÚ¡ 
FÏgs
& 
rhs
) {

20 
this
->
_v®ue
 = 
rhs
.
to_ulÚg
();

21  *
	gthis
;

24 
	gObjeùV®ue
& ObjectValue::

25 
İ”©Ü
+=(cÚ¡ 
ObjeùV®ue
 &
rhs
) {

26 ià(
_as_æags
)

27 
_v®ue
 = (
FÏgs
(_v®ueè+ğFÏgs(
rhs
._v®ue)).
to_ulÚg
();

29 
	g_v®ue
 +ğ
rhs
.
_v®ue
;

31  *
	gthis
;

35 
	gObjeùV®ue
& ObjectValue::

36 
İ”©Ü
-=(cÚ¡ 
ObjeùV®ue
 &
rhs
) {

37 ià(
_as_æags
)

38 
_v®ue
 = (
FÏgs
(_v®ueè-ğFÏgs(
rhs
._v®ue)).
to_ulÚg
();

40 
	g_v®ue
 -ğ
rhs
.
_v®ue
;

42  *
	gthis
;

45 
	gObjeùV®ue
& ObjectValue::

46 
İ”©Ü
^=(cÚ¡ 
FÏgs
& 
rhs
) {

47 ià(
_as_æags
)

48 
_v®ue
 = (
FÏgs
(_v®ueè^ğ
rhs
).
to_ulÚg
();

50  *
	gthis
;

	@src/Player.cc

1 
	~"PÏy”.hh
"

3 
	~"Game.hh
"

4 
	~"m”c.hh
"

6 
	gPÏy”
::
	$PÏy”
(
Ch¬aù”
 &
ch
) :

7 
	`ch
(
ch
),

8 
	`Ë¬Ãd
(
skl
::
	`num_skls
(), 0),

9 
	`evŞutiÚ
(
skl
::
	`num_skls
(), 0),

10 
	`group_known
(
group_bË
.
	`size
(), 
çl£
)

12 
Ï¡_id
;

13 
Ï¡_id
 = 
¡d
::
	`max
(
Game
::
cu¼’t_time
,†ast_id+1);

14 
id
 = 
Ï¡_id
;

15 
	}
}

	@src/QuestArea.cc

1 
	~"Que¡A»a.hh
"

3 
	~"Loggšg.hh
"

4 
	~"m”c.hh
"

5 
	~"Room.hh
"

6 
	~"Game.hh
"

7 
	~"WÜld.hh
"

10 
	#QUEST_STARTROOM
 12000

	)

12 
	gQue¡A»a
::

13 
	$š™
() {

14 
¡¬Œoom
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
QUEST_STARTROOM
)));

16 ià(
¡¬Œoom
 =ğ
nuÎ±r
)

17 
Loggšg
::
	`bug
("que¡_š™: Cª'ˆfšd que¡ s¹„oom %d.", 
QUEST_STARTROOM
);

20 
	}
}

22 cÚ¡ 
	gA»a
& 
	gQue¡A»a
::

23 
	$¬—
() const {

24  
¡¬Œoom
->
	`¬—
();

25 
	}
}

	@src/Reset.cc

1 
	~"Re£t.hh
"

3 
	~"A»a.hh
"

4 
	~"Ex™.hh
"

5 
	~"fe.hh
"

6 
	~"FÏgs.hh
"

7 
	~"m”c.hh
"

8 
	~"ObjeùPrÙÙy³.hh
"

9 
	~"Room.hh
"

10 
	~"Game.hh
"

11 
	~"Loggšg.hh
"

12 
	~"Ex™PrÙÙy³.hh
"

13 
	~"WÜld.hh
"

14 
	~"RoomPrÙÙy³.hh
"

16 
	gRe£t
::

17 
	$Re£t
(
FILE
 *
å
) {

18 
ObjeùPrÙÙy³
 *
‹mp_šdex
;

19 
SŒšg
 
tmp_buf
;

21 
commªd
 = 
	`ä—d_Ë‰”
(
å
);

22 
	`ä—d_numb”
(
å
);

32 
commªd
) {

34 
Loggšg
::
	`fe_bug
(
å
, "Lßd_»£ts: bad commªd '%c'.", 
commªd
);

35 
	`ex™
(1);

40 
¬g1
 = 
	`ä—d_numb”
(
å
);

41 
¬g2
 = 
	`ä—d_numb”
(
å
);

43 
tmp_buf
 = 
	`ä—d_wÜd
(
å
);

44 
¬g3
 = 
	`©oi
(
tmp_buf
);

45 
¬g4
 = 
	`ä—d_numb”
(
å
);

48 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
¬g1
);

59 ià(
¬g3
 != 0)

60 
¬g3
 = 
	`LoÿtiÚ
(
tmp_buf
).
	`to_št
();

63 ià(
¬g3
 == 0)

64 
¬g4
 = 
	`URANGE
(0,‡rg4, 100);

69 
¬g1
 = 
	`ä—d_numb”
(
å
);

70 
¬g2
 = 
	`ä—d_numb”
(
å
);

71 
tmp_buf
 = 
	`ä—d_wÜd
(
å
);

73 
¬g4
 = 0;

75 
‹mp_šdex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
¬g1
);

76 
‹mp_šdex
->
»£t_num
++;

77 
¬g3
 = 
	`LoÿtiÚ
(
tmp_buf
).
	`to_št
();

81 
¬g1
 = 
	`ä—d_numb”
(
å
);

82 
¬g2
 = 
	`ä—d_numb”
(
å
);

83 
¬g3
 = 
	`ä—d_numb”
(
å
);

84 
¬g4
 = 
	`ä—d_numb”
(
å
);

86 
‹mp_šdex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
¬g1
);

87 
‹mp_šdex
->
»£t_num
++;

88 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
¬g3
);

99 
¬g1
 = 
	`ä—d_numb”
(
å
);

100 
¬g2
 = 
	`ä—d_numb”
(
å
);

101 
¬g3
 = 0;

102 
¬g4
 = 0;

104 
‹mp_šdex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
¬g1
);

105 
‹mp_šdex
->
»£t_num
++;

109 
¬g1
 = 
	`ä—d_numb”
(
å
);

110 
¬g2
 = 
	`ä—d_numb”
(
å
);

111 
¬g3
 = 
	`ä—d_numb”
(
å
);

112 
¬g4
 = 0;

114 
‹mp_šdex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
¬g1
);

115 
‹mp_šdex
->
»£t_num
++;

119 
tmp_buf
 = 
	`ä—d_wÜd
(
å
);

121 
¬g2
 = 
	`ä—d_numb”
(
å
);

122 
¬g3
 = 
	`ä—d_numb”
(
å
);

123 
¬g4
 = 0;

125 ià(
¬g2
 < 0 ||‡rg2 > 5) {

126 
Loggšg
::
	`fe_bug
(
å
, "Lßd_»£ts: 'D':ƒx™ %d‚Ù doÜ.", 
¬g2
);

127 
	`ex™
(1);

130 ià(
¬g3
 < 0 ||‡rg3 > 2) {

131 
Loggšg
::
	`fe_bug
(
å
, "Lßd_»£ts: 'D': bad 'locks': %d.", 
¬g3
);

132 
	`ex™
(1);

138 
LoÿtiÚ
 
	`loc
(
tmp_buf
);

139 
¬g1
 = 
loc
.
	`to_št
();

141 ià(
loc
.
room_id
.
	`is_v®id
()) {

142 
RoomPrÙÙy³
 *
room
 = 
Game
::
	`wÜld
().
	`g‘_room_´ÙÙy³
(
loc
.
room_id
.
	`g‘_vnum
());

143 
Ex™PrÙÙy³
 *
³x™
;

145 ià(
room
 =ğ
nuÎ±r
) {

146 
Loggšg
::
	`fe_bug
(
å
, "Lßd_»£ts: 'D':‚Øsuch„oom %d.", 
¬g1
);

147 
	`ex™
(1);

150 ià((
³x™
 = 
room
->
ex™
[
¬g2
]è=ğ
nuÎ±r


151 || !
³x™
->
ex™_æags
.
	`has
(
EX_ISDOOR
)) {

152 
Loggšg
::
	`fe_bug
(
å
, "Lßd_»£ts: 'D':ƒx™ %d‚Ù doÜ.", 
¬g2
);

153 
	`ex™
(1);

161 
tmp_buf
 = 
	`ä—d_wÜd
(
å
);

163 
¬g2
 = 
	`ä—d_numb”
(
å
);

164 
¬g3
 = 0;

165 
¬g4
 = 0;

167 
¬g1
 = 
	`LoÿtiÚ
(
tmp_buf
).
	`to_št
();

169 ià(
¬g2
 < 0 ||‡rg2 > 6) {

170 
Loggšg
::
	`fe_bug
(
å
, "Lßd_»£ts: 'R': badƒx™ %d.", 
¬g2
);

171 
	`ex™
(1);

178 
	`ä—d_to_eŞ
(
å
);

179 
	}
}

	@src/Room.cc

1 
	~"Room.hh
"

2 
	~"Ch¬aù”.hh
"

3 
	~"A»a.hh
"

4 
	~"Objeù.hh
"

5 
	~"Loggšg.hh
"

6 
	~"RoomPrÙÙy³.hh
"

7 
	~"Game.hh
"

8 
	~"GameTime.hh
"

9 
	~"WÜld.hh
"

11 
	gRoom
::

12 
	$Room
(
RoomPrÙÙy³
& 
p
) :

13 
	`´ÙÙy³
(
p
),

14 
	`room_æags
(
p
.
room_æags
),

15 
	`loÿtiÚ
(
	`RoomID
(
p
.
vnum
, ++p.
couÁ
))

16 {
	}
}

18 
	gA»a
& 
	gRoom
::
	$¬—
(ècÚ¡ {  
´ÙÙy³
.
¬—
; 
	}
}

19 cÚ¡ 
	gSŒšg
& 
	gRoom
::
	$Çme
(ècÚ¡ {  
´ÙÙy³
.
Çme
; 
	}
}

20 cÚ¡ 
	gSŒšg
& 
	gRoom
::
	$desütiÚ
(ècÚ¡ {  
´ÙÙy³
.
desütiÚ
; 
	}
}

21 cÚ¡ 
ExŒaDesü
 *
	gRoom
::
	$exŒa_desü
(ècÚ¡ {  
´ÙÙy³
.
exŒa_desü
; 
	}
}

22 cÚ¡ 
FÏgs
 
	gRoom
::
	$æags
(ècÚ¡ {  
ÿched_room_æags
 + 
room_æags
; 
	}
}

23 
SeùÜ
 
	gRoom
::
	$£ùÜ_ty³
(ècÚ¡ {  
´ÙÙy³
.
£ùÜ_ty³
; 
	}
}

24 
	gRoom
::
	$gud
(ècÚ¡ {  
´ÙÙy³
.
gud
; 
	}
}

25 cÚ¡ 
	gSŒšg
& 
	gRoom
::
	$owÃr
(ècÚ¡ {  
´ÙÙy³
.
owÃr
; 
	}
}

26 cÚ¡ 
CÏn
 *
	gRoom
::
	$şª
(ècÚ¡ {  
´ÙÙy³
.
şª
; 
	}
}

27 
	gRoom
::
	$h—l_¿‹
(ècÚ¡ {  
´ÙÙy³
.
h—l_¿‹
; 
	}
}

28 
	gRoom
::
	$mªa_¿‹
(ècÚ¡ {  
´ÙÙy³
.
mªa_¿‹
; 
	}
}

29 cÚ¡ 
	gLoÿtiÚ
& 
	gRoom
::
	$‹Ë_de¡
(ècÚ¡ {  
´ÙÙy³
.
‹Ë_de¡
; 
	}
}

31 
boŞ
 
	gRoom
::
	$is_Ú_m­
(ècÚ¡ {  
loÿtiÚ
.
coÜd
.
	`is_v®id
(); 
	}
}

33 
	gRoom
::

34 
	$add_ch¬
(
Ch¬aù”
 *
ch
) {

35 
ch
->
š_room
 = 
this
;

36 
ch
->
Ãxt_š_room
 = 
this
->
³İË
;

37 
this
->
³İË
 = 
ch
;

39 
	`¬—
().
	`add_ch¬
(
ch
);

41 
Objeù
 *
obj
;

42 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_LIGHT
)è!ğ
nuÎ±r


43 && 
obj
->
™em_ty³
 =ğ
ITEM_LIGHT


44 && 
obj
->
v®ue
[2] != 0)

45 ++
this
->
light
;

47 cÚ¡ 
afãù
::
Afãù
 *
¶ague
 =‡fãù::
	`fšd_Ú_ch¬
(
ch
,‡fãù::
ty³
::plague);

48 ià(
¶ague
)

49 
	`¥»ad_¶ague
(
this
, 
¶ague
, 6);

50 
	}
}

52 
	gRoom
::

53 
	$»move_ch¬
(
Ch¬aù”
 *
ch
) {

58 autØ
rch
 = 
³İË
; 
Œue
;„ch =„ch->
Ãxt_š_room
) {

61 ià(
rch
 =ğ
nuÎ±r
)

64 ià(
rch
 =ğ
ch
)

68 
Objeù
 *
obj
;

69 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_LIGHT
)è!ğ
nuÎ±r


70 && 
obj
->
™em_ty³
 =ğ
ITEM_LIGHT


71 && 
obj
->
v®ue
[2] != 0

72 && 
this
->
light
 > 0)

73 --
this
->
light
;

75 
	`¬—
().
	`»move_ch¬
(
ch
);

77 ià(
ch
 =ğ
this
->
³İË
)

78 
this
->
³İË
 = 
ch
->
Ãxt_š_room
;

80 
Ch¬aù”
 *
´ev
;

82 
´ev
 = 
this
->
³İË
;…»v;…»v =…»v->
Ãxt_š_room
) {

83 ià(
´ev
->
Ãxt_š_room
 =ğ
ch
) {

84 
´ev
->
Ãxt_š_room
 = 
ch
->next_in_room;

89 ià(
´ev
 =ğ
nuÎ±r
) {

90 
Loggšg
::
	`bug
("Char_from_room: ch‚ot found.", 0);

91 
Loggšg
::
	`bug
(
ch
->
Çme
, 0);

95 
ch
->
š_room
 = 
nuÎ±r
;

96 
ch
->
Ãxt_š_room
 = 
nuÎ±r
;

97 
ch
->
Ú
 = 
nuÎ±r
;

98 
	}
}

100 
boŞ
 
	gRoom
::

101 
	$is_d¬k
() const {

102 ià(
	`is_v”y_d¬k
())

103  
Œue
;

105 ià(
light
 > 0)

106  
çl£
;

108 ià(
	`æags
().
	`has
(
ROOM_DARK
))

109  
Œue
;

111 ià(
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
šside


112 || 
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
c™y
)

113  
çl£
;

115 ià(
Game
::
	`wÜld
().
time
.
suÆight
 =ğ
GameTime
::
Night
)

116  
Œue
;

118  
çl£
;

119 
	}
}

121 
boŞ
 
	gRoom
::

122 
	$is_v”y_d¬k
() const {

123 ià(
	`æags
().
	`has
(
ROOM_NOLIGHT
))

124  
Œue
;

126  
çl£
;

127 
	}
}

129 
boŞ
 
	gRoom
::

130 
	$is_´iv©e
() const {

131 ià(!
	`owÃr
().
	`em±y
())

132  
Œue
;

134 
couÁ
 = 0;

136 
Ch¬aù”
 *
rch
 = 
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
)

137 
couÁ
++;

139 ià(
	`æags
().
	`has
(
ROOM_PRIVATE
è&& 
couÁ
 >= 2)

140  
Œue
;

142 ià(
	`æags
().
	`has
(
ROOM_SOLITARY
è&& 
couÁ
 >= 1)

143  
Œue
;

145  
çl£
;

146 
	}
}

	@src/RoomID.cc

1 
	~"RoomID.hh
"

2 
	~"SŒšg.hh
"

3 
	~"FÜm©.hh
"

4 
	~"Vnum.hh
"

6 
	gRoomID
::

7 
	$RoomID
(cÚ¡ 
Vnum
& 
vnum
, 
numb”
è: 
	$RoomID
() {

8 ià(
numb”
 < 1 || (numb” >> 
	`num_b™s_numb”
()) > 0)

11 ià(
vnum
.
	`v®ue
(è< 1 || (vnum.v®ue(è>> 
	`num_b™s_vnum
()) > 0)

14 
numb”_d©a
 = ()
numb”
-1;

15 
vnum_d©a
 = ()
vnum
.
	`v®ue
();

16 
	}
}

18 
	gRoomID
::

19 
	$RoomID
(cÚ¡ 
SŒšg
& 
s
è: 
	$RoomID
() {

20 
SŒšg
 
	`¡r
(
s
.
	`¡r
());

22 
num
 = 1;

24 ià(
¡r
.
	`has_šfix
(".")) {

25 
SŒšg
 
num_¡r
;

26 
¡r
 = sŒ.
	`l¥l™
(
num_¡r
, ".");

28 ià(
num_¡r
.
	`is_numb”
())

29 
num
 = 
	`©oi
(
num_¡r
);

32 
vnum
 = 0;

34 ià(
¡r
.
	`is_numb”
())

35 
vnum
 = 
	`©oi
(
¡r
);

37 *
this
 = 
	`RoomID
(
	`Vnum
(
vnum
), 
num
);

38 
	}
}

40 cÚ¡ 
Vnum
 
	gRoomID
::

41 
	$g‘_vnum
() const {

42 ià(!
	`is_v®id
())

43  
	`Vnum
(0);

45  
	`Vnum
(
vnum_d©a
);

46 
	}
}

48 cÚ¡ 
	gRoomID
::

49 
	$g‘_numb”
() const {

50 ià(!
	`is_v®id
())

53  ((
numb”_d©a
 << 2) >> 2)+1;

54 
	}
}

56 cÚ¡ 
SŒšg
 
	gRoomID
::

57 
	$to_¡ršg
(
boŞ
 
shÜt_loc
) const {

58 ià(!
	`is_v®id
())

61 
SŒšg
 
buf
;

63 
Vnum
 
vnum
 = 
	`g‘_vnum
();

64 
num
 = 
	`g‘_numb”
();

66 ià(
num
 > 1) {

67 ià(
shÜt_loc
)

68 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d.", 
num
);

70 
buf
 +ğ
FÜm©
::
	`fÜm©
("%3d.", 
num
);

73 ià(
shÜt_loc
)

74 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
vnum
);

76 
buf
 +ğ
FÜm©
::
	`fÜm©
("%5d", 
vnum
);

78  
buf
;

79 
	}
}

	@src/RoomPrototype.cc

1 
	~"RoomPrÙÙy³.hh
"

2 
	~"A»a.hh
"

3 
	~"Ex™.hh
"

4 
	~"ExŒaDesü.hh
"

5 
	~"fe.hh
"

6 
	~"FÜm©.hh
"

7 
	~"Loggšg.hh
"

8 
	~"lookup.hh
"

9 
	~"Room.hh
"

10 
	~"Ex™PrÙÙy³.hh
"

12 
	gRoomPrÙÙy³
::

13 
	$RoomPrÙÙy³
(
A»a
& 
a
, cÚ¡ 
Vnum
& 
v
, 
FILE
 *
å
) :

14 
	`¬—
(
a
),

15 
	`vnum
(
v
),

16 
	`Çme
(
	`ä—d_¡ršg
(
å
)),

17 
	`desütiÚ
(
	`ä—d_¡ršg
(
å
)),

18 
	`‹Ë_de¡
(
	`Vnum
(
	`ä—d_numb”
(
å
))),

19 
	`room_æags
(
	$ä—d_æag
(
å
)) {

21 
Şd_£ùÜ_ty³
 = 
	`ä—d_numb”
(
å
);

23 
Şd_£ùÜ_ty³
) {

24 0: 
£ùÜ_ty³
 = 
SeùÜ
::
šside
; ;

25 1: 
£ùÜ_ty³
 = 
SeùÜ
::
c™y
; ;

26 2: 
£ùÜ_ty³
 = 
SeùÜ
::
f›ld
; ;

27 3: 
£ùÜ_ty³
 = 
SeùÜ
::
fÜe¡_¥¬£
; ;

28 4: 
£ùÜ_ty³
 = 
SeùÜ
::
hls
; ;

29 5: 
£ùÜ_ty³
 = 
SeùÜ
::
mouÁaš
; ;

30 6: 
£ùÜ_ty³
 = 
SeùÜ
::
w©”_swim
; ;

31 7: 
£ùÜ_ty³
 = 
SeùÜ
::
w©”_noswim
; ;

32 9: 
£ùÜ_ty³
 = 
SeùÜ
::
aœ
; ;

33 10: 
£ùÜ_ty³
 = 
SeùÜ
::
de£¹
; ;

34 20: 
£ùÜ_ty³
 = 
SeùÜ
::
¬’a
; ;

35 21: 
£ùÜ_ty³
 = 
SeùÜ
::
şª¬’a
; ;

37 
Loggšg
::
	`fe_bug
(
å
, "Lßd_rooms(): unknowÀ£ùÜy³ %d.", 
Şd_£ùÜ_ty³
);

38 
£ùÜ_ty³
 = 
SeùÜ
::
nÚe
;

42 ià(3000 <ğ
vnum
 && vnum < 3400)

43 
room_æags
 +ğ
ROOM_LAW
;

45 ià(
room_æags
.
	`has
(
ROOM_FEMALE_ONLY
)) {

46 
Loggšg
::
	`logf
("Room %d i FEMALE_ONLY", 
vnum
);

49 ià(
room_æags
.
	`has
(
ROOM_MALE_ONLY
)) {

50 
Loggšg
::
	`logf
("Room %d i MALE_ONLY", 
vnum
);

53 ià(
room_æags
.
	`has
(
ROOM_LOCKER
)) {

54 
Loggšg
::
	`logf
("Room %d i LOCKER", 
vnum
);

58 
Ë‰”
 = 
	`ä—d_Ë‰”
(
å
);

60 ià(
Ë‰”
 == 'S')

63 
Ë‰”
) {

65 
h—l_¿‹
 = 
	`ä—d_numb”
(
å
);

69 
mªa_¿‹
 = 
	`ä—d_numb”
(
å
);

73 
şª
 = 
	`şª_lookup
(
	`ä—d_¡ršg
(
å
));

77 ià((
gud
 = 
	`gud_lookup
(
	`ä—d_¡ršg
(
å
))è=ğ
Gud
::
nÚe
) {

78 
Loggšg
::
	`fe_bug
(
å
, "Load_rooms: invalid class in guild", 0);

79 ::
	`ex™
(1);

85 
doÜ
 = 
	`ä—d_numb”
(
å
);

87 ià(
doÜ
 < 0 || door > 5) {

88 
Loggšg
::
	`fe_bug
(
å
, "F»ad_rooms: vnum %d ha bad doÜ‚umb”.", 
vnum
);

89 ::
	`ex™
(1);

92 ià(
ex™
[
doÜ
] !ğ
nuÎ±r
) {

93 
Loggšg
::
	`fe_bug
(
å
, "F»ad_rooms: vnum %d ha twØex™ š samdœeùiÚ.", 
vnum
);

94 ::
	`ex™
(1);

97 
ex™
[
doÜ
] = 
Ãw
 
	`Ex™PrÙÙy³
(
å
);

98 
tİ_ex™
++;

103 
ExŒaDesü
 *
ed
 = 
Ãw
 
	`ExŒaDesü
(
	`ä—d_¡ršg
(
å
), fread_string(fp));

104 
ed
->
Ãxt
 = 
exŒa_desü
;

105 
exŒa_desü
 = 
ed
;

110 
owÃr
 = 
	`ä—d_¡ršg
(
å
);

114 
Loggšg
::
	`fe_bug
(
å
, "Lßd_rooms: vnum %d ha æag‚Ù 'CDEHMOS'.", 
vnum
);

115 ::
	`ex™
(1);

119 
	}
}

121 
	gRoomPrÙÙy³
::

122 ~
	$RoomPrÙÙy³
() {

123 
exŒa_desü
 !ğ
nuÎ±r
) {

124 
ExŒaDesü
 *
exŒa
 = 
exŒa_desü
;

125 
exŒa_desü
 = 
exŒa
->
Ãxt
;

126 
d–‘e
 
exŒa
;

129 
doÜ
 = 0; door < 6; door++)

130 ià(
ex™
[
doÜ
] !ğ
nuÎ±r
)

131 
d–‘e
 
ex™
[
doÜ
];

132 
	}
}

	@src/Shop.cc

1 
	~"Shİ.hh
"

2 
	~"fe.hh
"

4 
	gShİ
::

5 
	$Shİ
(
FILE
 *
å
) {

6 
i
 = 0; i < 
MAX_TRADE
; i++)

7 
buy_ty³
[
i
] = 
	`ä—d_numb”
(
å
);

9 
´of™_buy
 = 
	`ä—d_numb”
(
å
);

10 
´of™_£Î
 = 
	`ä—d_numb”
(
å
);

11 
İ’_hour
 = 
	`ä—d_numb”
(
å
);

12 
şo£_hour
 = 
	`ä—d_numb”
(
å
);

13 
	`ä—d_to_eŞ
(
å
);

14 
	}
}

	@src/String.cc

4 
	~"SŒšg.hh
"

6 
	~<¡ršgs.h
>

7 
	~<®gÜ™hm
>

9 
	~"¬gum’t.hh
"

12 
	sÿ£_š£ns™ive_equ®
 {

13 
boŞ
 
İ”©Ü
(è(
	mlhs
, 
	mrhs
) {

14  
touµ”
(
lhs
è=ğtouµ”(
rhs
);

18 
boŞ
 
	gİ”©Ü
=ğ(cÚ¡ 
SŒšg
 &
lhs
, cÚ¡ 
	gSŒšg
 &
	grhs
) {

20  
¡rÿ£cmp
(
lhs
.
c_¡r
(), 
rhs
.c_str()) == 0;

23 
boŞ
 
	gİ”©Ü
=ğ(cÚ¡ 
SŒšg
 &
lhs
, cÚ¡ *
	grhs
) {

24 ià(
	grhs
)

25  
	glhs
 =ğ
SŒšg
(
rhs
);

27  
	gçl£
;

30 
boŞ
 
	gİ”©Ü
!ğ(cÚ¡ 
SŒšg
 &
lhs
, cÚ¡ 
	gSŒšg
 &
	grhs
) {

31  !(
	glhs
 =ğ
rhs
);

34 
boŞ
 
	gİ”©Ü
!ğ(cÚ¡ 
SŒšg
 &
lhs
, cÚ¡ *
	grhs
) {

35  !(
	glhs
 =ğ
rhs
);

38 
	g¡d
::
size_t
 
SŒšg
::

39 
	$fšd
(cÚ¡ 
SŒšg
& 
¡r
, 
¡d
::
size_t
 
¡¬t_pos
) const {

40 ià(
¡¬t_pos
 > 
	`size
(è- 
¡r
.size())

41  
¡d
::
¡ršg
::
Åos
;

43 ià(
¡r
.
	`size
() == 0)

46 autØ
™
 = 
¡d
::
	`£¬ch
(

47 
	`cbegš
(è+ 
¡¬t_pos
, 
	`ûnd
(),

48 
¡r
.
	`cbegš
(), sŒ.
	`ûnd
(),

49 
	`ÿ£_š£ns™ive_equ®
()

52 ià(
™
 =ğ
	`ûnd
())

53  
¡d
::
¡ršg
::
Åos
;

55  
™
 - 
	`cbegš
();

56 
	}
}

58 
	g¡d
::
size_t
 
SŒšg
::

59 
	$fšd_Áh
(
¡d
::
size_t
 
Áh
, cÚ¡ 
SŒšg
& 
¡r
, std::size_ˆ
¡¬t_pos
) const {

60 
¡d
::
size_t
 
pos
 = 
	`fšd
(
¡r
, 
¡¬t_pos
);

62 ià(
pos
 =ğ
¡d
::
¡ršg
::
Åos
)

63  
pos
;

65 ià(
Áh
 > 1)

66 
pos
 = 
	`fšd_Áh
(
Áh
 - 1, 
¡r
,…o + sŒ.
	`size
());

68  
pos
;

69 
	}
}

71 
boŞ
 
	gSŒšg
::

72 
	$has_´efix
(cÚ¡ 
SŒšg
& 
¡r
, 
¡d
::
size_t
 
mš_ch¬s
) const {

73  
¡r
.
	`is_´efix_of
(*
this
, 
mš_ch¬s
);

74 
	}
}

76 
boŞ
 
	gSŒšg
::

77 
	$is_´efix_of
(cÚ¡ 
SŒšg
& 
¡r
, 
¡d
::
size_t
 
mš_ch¬s
) const {

78 ià(
	`size
(è< 
mš_ch¬s
 || 
¡r
.size() < size())

79  
çl£
;

81  *
this
 =ğ
¡r
.
	`sub¡r
(0, 
	`size
());

82 
	}
}

84 
boŞ
 
	gSŒšg
::

85 
	$has_šfix
(cÚ¡ 
SŒšg
& 
¡r
, 
¡d
::
size_t
 
mš_ch¬s
) const {

86  
¡r
.
	`is_šfix_of
(*
this
, 
mš_ch¬s
);

87 
	}
}

89 
boŞ
 
	gSŒšg
::

90 
	$is_šfix_of
(cÚ¡ 
SŒšg
& 
¡r
, 
¡d
::
size_t
 
mš_ch¬s
) const {

91 ià(
	`size
(è< 
mš_ch¬s
 || 
¡r
.size() < size())

92  
çl£
;

94  
¡r
.
	`fšd
(*
this
è!ğ
¡d
::
¡ršg
::
Åos
;

95 
	}
}

97 
boŞ
 
	gSŒšg
::

98 
	$has_suffix
(cÚ¡ 
SŒšg
& 
¡r
, 
¡d
::
size_t
 
mš_ch¬s
) const {

99  
¡r
.
	`is_suffix_of
(*
this
, 
mš_ch¬s
);

100 
	}
}

102 
boŞ
 
	gSŒšg
::

103 
	$is_suffix_of
(cÚ¡ 
SŒšg
& 
¡r
, 
¡d
::
size_t
 
mš_ch¬s
) const {

104 ià(
	`size
(è< 
mš_ch¬s
 || 
¡r
.size() < size())

105  
çl£
;

107  *
this
 =ğ
¡r
.
	`sub¡r
(¡r.
	`size
() - size());

108 
	}
}

110 
boŞ
 
	gSŒšg
::

111 
	$has_wÜds
(cÚ¡ 
SŒšg
& 
wÜdli¡
, 
boŞ
 
exaù
) const {

112 
SŒšg
 
wÜds
 = 
wÜdli¡
.
	`¡r
();

113 
SŒšg
 
¡r
 = 
this
->
	`¡r
();

116 ià(
wÜds
.
	`em±y
())

117  
çl£
;

120 
Œue
) {

121 
SŒšg
 
wÜd
;

122 
wÜds
 = 
	`Úe_¬gum’t
(wÜds, 
wÜd
);

125 ià(
wÜd
.
	`em±y
())

126  
Œue
;

129 
SŒšg
 
	`thi¦i¡
(
¡r
);

131 
Œue
) {

132 
SŒšg
 
·¹
;

133 
thi¦i¡
 = 
	`Úe_¬gum’t
Ñhi¦i¡, 
·¹
);

135 ià(
·¹
.
	`em±y
())

136  
çl£
;

138 ià(
exaù
) {

139 ià(
wÜd
 =ğ
·¹
)

143 ià(
wÜd
.
	`is_´efix_of
(
·¹
))

148 
	}
}

150 
boŞ
 
	gSŒšg
::

151 
	$has_exaù_wÜds
(cÚ¡ 
SŒšg
& 
wÜdli¡
) const {

152  
	`has_wÜds
(
wÜdli¡
, 
Œue
);

153 
	}
}

155 
boŞ
 
	gSŒšg
::

156 
	$is_numb”
() const {

157 ià(
	`em±y
())

158  
çl£
;

160 cÚ¡ *
c
 = 
this
->
	`c_¡r
();

162 ià(
c
[0] == '+' || c[0] == '-')

163 
c
++;

165 ; *
c
; c++) {

166 ià(!
	`isdig™
(*
c
))

167  
çl£
;

170  
Œue
;

171 
	}
}

178 cÚ¡ 
SŒšg
 
	gSŒšg
::

179 
	$sub¡r
(
¡d
::
size_t
 
pos
, std::size_ˆ
couÁ
) const {

180  
¡d
::
¡ršg
::
	`sub¡r
(
pos
, 
couÁ
);

181 
	}
}

183 cÚ¡ 
SŒšg
 
	gSŒšg
::

184 
	$l¡r
(cÚ¡ 
SŒšg
& 
ch¬s
) const {

185 
¡d
::
size_t
 
pos
 = 
	`fšd_fœ¡_nÙ_of
(
ch¬s
);

186  
pos
 =ğ
¡d
::
¡ršg
::
Åos
 ? "" : 
	`sub¡r
(pos);

187 
	}
}

189 cÚ¡ 
SŒšg
 
	gSŒšg
::

190 
	$r¡r
(cÚ¡ 
SŒšg
& 
ch¬s
) const {

191 
¡d
::
size_t
 
pos
 = 
	`fšd_Ï¡_nÙ_of
(
ch¬s
);

192  
pos
 =ğ
¡d
::
¡ršg
::
Åos
 ? "" : 
	`sub¡r
(0,…os+1);

193 
	}
}

195 cÚ¡ 
SŒšg
 
	gSŒšg
::

196 
	$¡r
(cÚ¡ 
SŒšg
& 
ch¬s
) const {

197  
	`l¡r
(
ch¬s
).
	`r¡r
(chars);

198 
	}
}

200 cÚ¡ 
SŒšg
 
	gSŒšg
::

201 
	$ÿp™®ize
() const {

202 
SŒšg
 
	`¡r
(*
this
);

203 
¡d
::
size_t
 
pos
 = 
¡r
.
	`fšd_fœ¡_nÙ_of
(" \t\r\n");

205 ià(
pos
 !ğ
¡d
::
¡ršg
::
Åos
)

206 
¡r
[
pos
] = 
	`touµ”
(str[pos]);

208  
¡r
;

209 
	}
}

211 cÚ¡ 
SŒšg
 
	gSŒšg
::

212 
	$uµ”ÿ£
() const {

213 
SŒšg
 
	`¡r
(*
this
);

215 
¡d
::
size_t
 
pos
 = 0;…o < 
¡r
.
	`Ëngth
();…os++)

216 ià(
¡r
[
pos
] >= 'a' && str[pos] <= 'z')

217 
¡r
[
pos
] = 
	`touµ”
(str[pos]);

219  
¡r
;

220 
	}
}

222 cÚ¡ 
SŒšg
 
	gSŒšg
::

223 
	$low”ÿ£
() const {

224 
SŒšg
 
	`¡r
(*
this
);

226 
¡d
::
size_t
 
pos
 = 0;…o < 
¡r
.
	`Ëngth
();…os++)

227 ià(
¡r
[
pos
] >= 'A' && str[pos] <= 'Z')

228 
¡r
[
pos
] = 
	`tŞow”
(str[pos]);

230  
¡r
;

231 
	}
}

233 cÚ¡ 
SŒšg
 
	gSŒšg
::

234 
	$uncŞÜ
() const {

235 
SŒšg
 
buf
;

237 autØ
™
 = 
	`cbegš
(); iˆ!ğ
	`ûnd
(); it++) {

238 ià(*
™
 != '{') {

239 
buf
 +ğ*
™
;

243 ià(++
™
 =ğ
	`ûnd
())

246 ià(*
™
 == '{')

247 
buf
 += '{';

252  
buf
;

253 
	}
}

255 cÚ¡ 
SŒšg
 
	gSŒšg
::

256 
	$l¥l™
(cÚ¡ 
SŒšg
& 
ch¬s
) const {

257 
SŒšg
 
wÜd
;

258 
	`l¥l™
(
wÜd
, 
ch¬s
);

259  
wÜd
;

260 
	}
}

262 cÚ¡ 
SŒšg
 
	gSŒšg
::

263 
	$r¥l™
(cÚ¡ 
SŒšg
& 
ch¬s
) const {

264 
SŒšg
 
wÜd
;

265 
	`r¥l™
(
wÜd
, 
ch¬s
);

266  
wÜd
;

267 
	}
}

269 cÚ¡ 
SŒšg
 
	gSŒšg
::

270 
	$l¥l™
(
SŒšg
& 
wÜd
, cÚ¡ SŒšg& 
ch¬s
) const {

271 
¡d
::
size_t
 
¡¬t_pos
 = 
	`fšd_fœ¡_nÙ_of
(
ch¬s
);

273 ià(
¡¬t_pos
 =ğ
¡d
::
¡ršg
::
Åos
) {

274 
wÜd
.
	`ş—r
();

278 
¡d
::
size_t
 
’d_pos
 = 
	`fšd_fœ¡_of
(
ch¬s
, 
¡¬t_pos
);

280 ià(
’d_pos
 =ğ
¡d
::
¡ršg
::
Åos
) {

281 
wÜd
.
	`assign
(
	`sub¡r
(
¡¬t_pos
));

285 
wÜd
.
	`assign
(
	`sub¡r
(
¡¬t_pos
, 
’d_pos
 - start_pos));

286  
	`sub¡r
(
’d_pos
).
	`l¡r
(
ch¬s
);

287 
	}
}

289 cÚ¡ 
SŒšg
 
	gSŒšg
::

290 
	$r¥l™
(
SŒšg
& 
wÜd
, cÚ¡ SŒšg& 
ch¬s
) const {

291 
¡d
::
size_t
 
’d_pos
 = 
	`fšd_Ï¡_nÙ_of
(
ch¬s
);

293 ià(
’d_pos
 =ğ
¡d
::
¡ršg
::
Åos
) {

294 
wÜd
.
	`ş—r
();

298 
¡d
::
size_t
 
¡¬t_pos
 = 
	`fšd_Ï¡_of
(
ch¬s
, 
’d_pos
);

300 ià(
¡¬t_pos
 =ğ
¡d
::
¡ršg
::
Åos
) {

301 
wÜd
.
	`assign
(
	`sub¡r
(0, 
’d_pos
 + 1));

305 
wÜd
.
	`assign
(
	`sub¡r
(
¡¬t_pos
 + 1, 
’d_pos
 - start_pos));

306  
	`sub¡r
(0, 
¡¬t_pos
 + 1).
	`r¡r
();

307 
	}
}

309 
	gSŒšg
& String::

310 
	$”a£
(
size_t
 
pos
, size_ˆ
Ën
) {

311 ià(
pos
 < (*
this
).
	`size
())

312 (*
this
).
¡d
::
¡ršg
::
	`”a£
(
pos
, 
Ën
);

314  *
this
;

315 
	}
}

317 cÚ¡ 
SŒšg
 
	gSŒšg
::

318 
	$»¶aû
(cÚ¡ 
SŒšg
& 
wh©
, cÚ¡ SŒšg& 
w™h
, 
times
) const {

319 ià(
wh©
.
	`em±y
())

320  *
this
;

322 
¡d
::
size_t
 
pos
 = 0;

323 
SŒšg
 
	`¡r
(*
this
);

325 
times
-- !ğ0 && (
pos
 = 
¡r
.
	`fšd
(
wh©
,…os)è!ğ
¡d
::
¡ršg
::
Åos
) {

326 
¡r
.
¡d
::
¡ršg
::
	`»¶aû
(
pos
, 
wh©
.
	`size
(), 
w™h
);

327 
pos
 +ğ
w™h
.
	`size
();

330  
¡r
;

331 
	}
}

333 cÚ¡ 
SŒšg
 
	gSŒšg
::

334 
	$š£¹
(cÚ¡ 
SŒšg
& 
wh©
, 
¡d
::
size_t
 
pos
) const {

335 ià(
pos
 > 
	`size
())

336 
pos
 = 
	`size
();

338  
	`sub¡r
(0, 
pos
è+ 
wh©
 + substr(pos);

339 
	}
}

341 cÚ¡ 
SŒšg
 
	gSŒšg
::

342 
	$ûÁ”
(
¡d
::
size_t
 
tÙ®_Ën
) const {

343 
SŒšg
 
	`¡r
(*
this
), 
¥aû
;

345 
¡r
.
	`uncŞÜ
().
	`size
(è> 
tÙ®_Ën
)

346 
¡r
.
	`pİ_back
();

348 
Ën
 = 
tÙ®_Ën
 - 
¡r
.
	`uncŞÜ
().
	`size
();†en > 0;†en--)

349 
¥aû
 += " ";

351  
¥aû
.
	`š£¹
(
¡r
, s·û.
	`size
()/2);

352 
	}
}

	@src/War.cc

6 
	~"W¬.hh
"

8 
	~<veùÜ
>

10 
	~"¬gum’t.hh
"

11 
	~"Ch¬aù”.hh
"

12 
	~"CÏn.hh
"

13 
	~"DesütÜ.hh
"

14 
	~"fe.hh
"

15 
	~"FÏgs.hh
"

16 
	~"FÜm©.hh
"

17 
	~"Game.hh
"

18 
	~"š‹½.hh
"

19 
	~"lookup.hh
"

20 
	~"Loggšg.hh
"

21 
	~"m”c.hh
"

22 
	~"PÏy”.hh
"

23 
	~"SŒšg.hh
"

25 
	#WAR_DIR
 "../w¬/"

	)

26 
	#EVENT_DIR
 "../w¬/ev’ts/"

	)

27 
	#WAR_FILE
 "w¬.txt"

	)

28 
	#EVENT_TMP
 "ev’‰mp"

	)

30 
W¬
 *
g‘_§me_w¬
(
CÏn
 *
şªA
, CÏÀ*
şªB
);

31 
w¬_wš
(
W¬
 *
w¬
, 
Ch¬aù”
 *
ch
);

32 
g‘_w¬_šdex
(
W¬
 *
w¬
);

33 
»c_ev’t
(
W¬
 *
w¬
, 
ty³
, cÚ¡ 
SŒšg
& 
a¡r
, cÚ¡ SŒšg& 
b¡r
, 
numb”
);

35 
W¬
 *
	gw¬_bË_h—d
;

36 
W¬
 *
	gw¬_bË_
;

38 
	gW¬
::
	$W¬
() {

39 
i
 = 0; i < 4; i++) {

40 
ch®
[
i
] = 
Ãw
 
	`OµÚ’t
();

41 
def
[
i
] = 
Ãw
 
	`OµÚ’t
();

43 
	}
}

45 
	gW¬
::~
	$W¬
() {

46 
i
 = 0; i < 4; i++) {

47 
d–‘e
 
ch®
[
i
];

48 
d–‘e
 
def
[
i
];

51 
W¬
::
Ev’t
 *
ev’t
, *
ev’t_Ãxt
;

52 
ev’t
 = 
ev’ts
;ƒv’ˆ!ğ
nuÎ±r
;ƒv’ˆğ
ev’t_Ãxt
) {

53 
ev’t_Ãxt
 = 
ev’t
->
Ãxt
;

54 
d–‘e
 
ev’t
;

56 
	}
}

58 
	$­³nd_w¬
(
W¬
 *
w¬
)

60 
w¬
->
´evious
 = 
w¬_bË_
->previous;

61 
w¬
->
´evious
->
Ãxt
 = war;

62 
w¬
->
Ãxt
 = 
w¬_bË_
;

63 
w¬_bË_
->
´evious
 = 
w¬
;

64 
	}
}

66 
	$lßd_w¬_ev’ts
()

68 
¡r§ve
[
MIL
];

69 
FILE
 *
å
;

70 
W¬
 *
w¬
;

71 
W¬
::
Ev’t
 *
ev’t
, *
n_ev’t
;

72 
w¬
 = 
w¬_bË_h—d
->
Ãxt
;

74 
w¬
 !ğ
w¬_bË_
) {

75 
FÜm©
::
	`¥rštf
(
¡r§ve
, "%sW¬Ev’ts%d", 
EVENT_DIR
, 
	`g‘_w¬_šdex
(
w¬
));

77 ià((
å
 = 
	`fİ’
(
¡r§ve
, "r")è!ğ
nuÎ±r
) {

79 ià(
	`ä—d_wÜd
(
å
) == "END")

82 
n_ev’t
 = 
Ãw
 
W¬
::
	`Ev’t
();

83 
n_ev’t
->
ty³
 = 
	`©oi
(
	`ä—d_¡ršg
(
å
));

84 
n_ev’t
->
a¡r
 = 
	`ä—d_¡ršg
(
å
);

85 
n_ev’t
->
b¡r
 = 
	`ä—d_¡ršg
(
å
);

86 
n_ev’t
->
numb”
 = 
	`©oi
(
	`ä—d_¡ršg
(
å
));

87 
n_ev’t
->
time
 = 
	`dizzy_sÿÁime
(
	`ä—d_¡ršg
(
å
));

89 ià(
w¬
->
ev’ts
 =ğ
nuÎ±r
)

90 
w¬
->
ev’ts
 = 
n_ev’t
;

92 
ev’t
 = 
w¬
->
ev’ts
;ƒv’ˆ!ğ
nuÎ±r
;ƒv’ˆğev’t->
Ãxt
)

93 ià(
ev’t
->
Ãxt
 =ğ
nuÎ±r
) {

94 
ev’t
->
Ãxt
 = 
n_ev’t
;

99 
	`fşo£
(
å
);

102 
Loggšg
::
	`bug
("Could‚ot openƒvent file for„eading!", 0);

104 
w¬
 = w¬->
Ãxt
;

106 
	}
}

108 
	$§ve_w¬_ev’ts
()

110 
¡r§ve
[
MIL
];

111 
FILE
 *
å
;

112 
W¬
::
Ev’t
 *
ev’t
;

113 
W¬
 *
w¬
;

114 
w¬
 = 
w¬_bË_h—d
->
Ãxt
;

116 
w¬
 !ğ
w¬_bË_
) {

117 
FÜm©
::
	`¥rštf
(
¡r§ve
, "%sW¬Ev’ts%d", 
EVENT_DIR
, 
	`g‘_w¬_šdex
(
w¬
));

119 ià((
å
 = 
	`fİ’
(
EVENT_TMP
, "w")è!ğ
nuÎ±r
) {

120 
ev’t
 = 
w¬
->
ev’ts
;

122 
ev’t
 !ğ
nuÎ±r
) {

123 
FÜm©
::
	`årštf
(
å
, "NOTEND\n");

124 
FÜm©
::
	`årštf
(
å
, "%d~\n", 
ev’t
->
ty³
);

125 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
ev’t
->
a¡r
);

126 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
ev’t
->
b¡r
);

127 
FÜm©
::
	`årštf
(
å
, "%d~\n", 
ev’t
->
numb”
);

128 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
	`dizzy_ùime
(&
ev’t
->
time
));

129 
ev’t
 =ƒv’t->
Ãxt
;

132 
FÜm©
::
	`årštf
(
å
, "END\n");

133 
	`fşo£
(
å
);

134 
	`»Çme
(
EVENT_TMP
, 
¡r§ve
);

137 
Loggšg
::
	`bug
("Could‚Ù o³À" 
EVENT_TMP
 " for writing!", 0);

139 
w¬
 = w¬->
Ãxt
;

141 
	}
}

143 
	$lßd_w¬_bË
()

145 
FILE
 *
å
;

146 
W¬
 *
w¬
;

147 
i
, 
couÁ
 = 0;

148 
w¬_bË_h—d
 = 
Ãw
 
	`W¬
();

149 
w¬_bË_
 = 
Ãw
 
	`W¬
();

150 
w¬_bË_h—d
->
Ãxt
 = 
w¬_bË_
;

151 
w¬_bË_
->
´evious
 = 
w¬_bË_h—d
;

153 ià((
å
 = 
	`fİ’
(
WAR_DIR
 
WAR_FILE
, "r")è!ğ
nuÎ±r
) {

155 ià(
	`ä—d_wÜd
(
å
) == "END")

158 
w¬
 = 
Ãw
 
	`W¬
();

160 
i
 = 0; i < 4; i++) {

161 
w¬
->
ch®
[
i
]->
Çme
 = 
	`ä—d_¡ršg
(
å
);

162 
w¬
->
ch®
[
i
]->
şªÇme
 = 
	`ä—d_¡ršg
(
å
);

163 
w¬
->
ch®
[
i
]->
šw¬
 = 
	`©oi
(
	`ä—d_¡ršg
(
å
));

164 
w¬
->
ch®
[
i
]->
¡¬t_scÜe
 = 
	`©oi
(
	`ä—d_¡ršg
(
å
));

165 
w¬
->
ch®
[
i
]->
fš®_scÜe
 = 
	`©oi
(
	`ä—d_¡ršg
(
å
));

168 
i
 = 0; i < 4; i++) {

169 
w¬
->
def
[
i
]->
Çme
 = 
	`ä—d_¡ršg
(
å
);

170 
w¬
->
def
[
i
]->
şªÇme
 = 
	`ä—d_¡ršg
(
å
);

171 
w¬
->
def
[
i
]->
šw¬
 = 
	`©oi
(
	`ä—d_¡ršg
(
å
));

172 
w¬
->
def
[
i
]->
¡¬t_scÜe
 = 
	`©oi
(
	`ä—d_¡ršg
(
å
));

173 
w¬
->
def
[
i
]->
fš®_scÜe
 = 
	`©oi
(
	`ä—d_¡ršg
(
å
));

176 
w¬
->
Úgošg
 = 
	`©oi
(
	`ä—d_¡ršg
(
å
));

177 
	`­³nd_w¬
(
w¬
);

178 
couÁ
++;

181 
	`fşo£
(
å
);

184 
Loggšg
::
	`bug
("Could‚Ù o³À" 
WAR_FILE
 " for„eading!", 0);

185 
	}
}

187 
	$§ve_w¬_bË
()

189 
FILE
 *
å
;

190 
W¬
 *
w¬
;

191 
i
;

193 ià((
å
 = 
	`fİ’
(
WAR_DIR
 
WAR_FILE
, "w")è!ğ
nuÎ±r
) {

194 
w¬
 = 
w¬_bË_h—d
->
Ãxt
;

196 
w¬
 !ğ
w¬_bË_
) {

197 
FÜm©
::
	`årštf
(
å
, "NOTEND\n");

199 
i
 = 0; i < 4; i++) {

200 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
w¬
->
ch®
[
i
]->
Çme
);

201 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
w¬
->
ch®
[
i
]->
şªÇme
);

202 
FÜm©
::
	`årštf
(
å
, "%d~\n", 
w¬
->
ch®
[
i
]->
šw¬
);

203 
FÜm©
::
	`årštf
(
å
, "%d~\n", 
w¬
->
ch®
[
i
]->
¡¬t_scÜe
);

204 
FÜm©
::
	`årštf
(
å
, "%d~\n", 
w¬
->
ch®
[
i
]->
fš®_scÜe
);

207 
i
 = 0; i < 4; i++) {

208 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
w¬
->
def
[
i
]->
Çme
);

209 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
w¬
->
def
[
i
]->
şªÇme
);

210 
FÜm©
::
	`årštf
(
å
, "%d~\n", 
w¬
->
def
[
i
]->
šw¬
);

211 
FÜm©
::
	`årštf
(
å
, "%d~\n", 
w¬
->
def
[
i
]->
¡¬t_scÜe
);

212 
FÜm©
::
	`årštf
(
å
, "%d~\n", 
w¬
->
def
[
i
]->
fš®_scÜe
);

215 
FÜm©
::
	`årštf
(
å
, "%d~\n", 
w¬
->
Úgošg
);

216 
w¬
 = w¬->
Ãxt
;

219 
FÜm©
::
	`årštf
(
å
, "END\n");

220 
	`fşo£
(
å
);

223 
Loggšg
::
	`bug
("Could‚Ù o³À" 
WAR_FILE
 " for writing!", 0);

224 
	}
}

226 
	$fix_w¬
(
W¬
 *
w¬
)

228 
W¬
 *
fixed_w¬
 = 
Ãw
 
	`W¬
();

229 
i
, 
c
 = 0, 
d
 = 0;

231 
i
 = 0; i < 4; i++) {

232 ià(!
w¬
->
ch®
[
i
]->
Çme
.
	`em±y
()) {

233 
fixed_w¬
->
ch®
[
c
]->
Çme
 = 
w¬
->ch®[
i
]->name;

234 
fixed_w¬
->
ch®
[
c
]->
şªÇme
 = 
w¬
->ch®[
i
]->clanname;

235 
fixed_w¬
->
ch®
[
c
]->
šw¬
 = 
w¬
->ch®[
i
]->inwar;

236 
fixed_w¬
->
ch®
[
c
]->
¡¬t_scÜe
 = 
w¬
->ch®[
i
]->start_score;

237 
fixed_w¬
->
ch®
[
c
]->
fš®_scÜe
 = 
w¬
->ch®[
i
]->final_score;

238 
c
++;

241 ià(!
w¬
->
def
[
i
]->
Çme
.
	`em±y
()) {

242 
fixed_w¬
->
def
[
d
]->
Çme
 = 
w¬
->def[
i
]->name;

243 
fixed_w¬
->
def
[
d
]->
şªÇme
 = 
w¬
->def[
i
]->clanname;

244 
fixed_w¬
->
def
[
d
]->
šw¬
 = 
w¬
->def[
i
]->inwar;

245 
fixed_w¬
->
def
[
d
]->
¡¬t_scÜe
 = 
w¬
->def[
i
]->start_score;

246 
fixed_w¬
->
def
[
d
]->
fš®_scÜe
 = 
w¬
->def[
i
]->final_score;

247 
d
++;

251 
fixed_w¬
->
ev’ts
 = 
w¬
->events;

252 
w¬
->
ev’ts
 = 
nuÎ±r
;

253 
fixed_w¬
->
Úgošg
 = 
w¬
->ongoing;

254 
fixed_w¬
->
´evious
 = 
w¬
->previous;

255 
fixed_w¬
->
Ãxt
 = 
w¬
->next;

256 
fixed_w¬
->
´evious
->
Ãxt
 = fixed_war;

257 
fixed_w¬
->
Ãxt
->
´evious
 = fixed_war;

258 
d–‘e
 
w¬
;

259 
	}
}

261 
boŞ
 
	$şª_š_w¬
(
CÏn
 *
şª
, 
W¬
 *
w¬
, 
boŞ
 
Úlycu¼’t
)

263 
i
;

265 
i
 = 0; i < 4; i++) {

266 ià(
şª
->
Çme
 =ğ
w¬
->
ch®
[
i
]->name) {

267 ià(
Úlycu¼’t
) {

268 ià(
w¬
->
ch®
[
i
]->
šw¬
)

269  
Œue
;

272  
Œue
;

275 ià(
şª
->
Çme
 =ğ
w¬
->
def
[
i
]->name) {

276 ià(
Úlycu¼’t
) {

277 ià(
w¬
->
def
[
i
]->
šw¬
)

278  
Œue
;

281  
Œue
;

285  
çl£
;

286 
	}
}

288 
boŞ
 
	$şª_©_w¬
(
CÏn
 *
şª
)

290 
W¬
 *
w¬
;

291 
w¬
 = 
w¬_bË_h—d
->
Ãxt
;

293 
w¬
 !ğ
w¬_bË_
) {

294 ià(
w¬
->
Úgošg
)

295 ià(
	`şª_š_w¬
(
şª
, 
w¬
, 
Œue
))

296  
Œue
;

298 
w¬
 = w¬->
Ãxt
;

301  
çl£
;

302 
	}
}

304 
boŞ
 
	$şª_is_ch®Ëng”
(
CÏn
 *
şª
, 
W¬
 *
w¬
)

306 
i
;

308 
i
 = 0; i < 4; i++) {

309 ià(
şª
->
Çme
 =ğ
w¬
->
ch®
[
i
]->Çm&& w¬->ch®[i]->
šw¬
)

310  
Œue
;

311 ià(
şª
->
Çme
 =ğ
w¬
->
def
[
i
]->Çm&& w¬->def[i]->
šw¬
)

312  
çl£
;

315 
Loggšg
::
	`bug
("clan_is_challenger: clan‚ot in war", 0);

316  
çl£
;

317 
	}
}

319 
boŞ
 
	$şª_İpÚ’ts
(
CÏn
 *
şªA
, CÏÀ*
şªB
)

321 
W¬
 *
w¬
 = 
nuÎ±r
;

323 ià((
w¬
 = 
	`g‘_§me_w¬
(
şªA
, 
şªB
)))

324 ià(
	`şª_is_ch®Ëng”
(
şªA
, 
w¬
è!ğşª_is_ch®Ëng”(
şªB
, war))

325  
Œue
;

327  
çl£
;

328 
	}
}

330 
boŞ
 
	$ch¬_©_w¬
(
Ch¬aù”
 *
ch
)

332 ià(
ch
->
	`is_Åc
())

333  
çl£
;

335 ià(!
ch
->
şª
)

336  
çl£
;

338 ià(
	`şª_©_w¬
(
ch
->
şª
))

339  
Œue
;

341  
çl£
;

342 
	}
}

344 
boŞ
 
	$ch¬_İpÚ’ts
(
Ch¬aù”
 *
ch¬A
, Ch¬aù” *
ch¬B
)

347 ià(!
	`ch¬_©_w¬
(
ch¬A
è|| !ch¬_©_w¬(
ch¬B
))

348  
çl£
;

350 ià(
	`şª_İpÚ’ts
(
ch¬A
->
şª
, 
ch¬B
->clan))

351  
Œue
;

353  
çl£
;

354 
	}
}

356 
boŞ
 
	$w¬_is_fuÎ
(
W¬
 *
w¬
, 
boŞ
 
ch®Ëng”
)

358 
i
;

360 
i
 = 0; i < 4; i++) {

361 ià(
ch®Ëng”
) {

362 ià(
w¬
->
ch®
[
i
]->
Çme
.
	`em±y
())

363  
çl£
;

366 ià(
w¬
->
def
[
i
]->
Çme
.
	`em±y
())

367  
çl£
;

371  
Œue
;

372 
	}
}

374 
	$g‘_w¬_šdex
(
W¬
 *
w¬
)

376 
W¬
 *
iW¬
;

377 
couÁ
 = 1;

378 
iW¬
 = 
w¬_bË_h—d
->
Ãxt
;

380 
iW¬
 !ğ
w¬_bË_
) {

381 ià(
w¬
 =ğ
iW¬
)

382  
couÁ
;

384 
iW¬
 = iW¬->
Ãxt
;

385 
couÁ
++;

389 
	}
}

391 
W¬
 *
	$w¬_lookup
(
numb”
)

393 
W¬
 *
w¬
;

394 
couÁ
 = 1;

395 
w¬
 = 
w¬_bË_h—d
->
Ãxt
;

397 
w¬
 !ğ
w¬_bË_
) {

398 ià(
couÁ
 =ğ
numb”
)

399  
w¬
;

401 
w¬
 = w¬->
Ãxt
;

402 
couÁ
++;

405  
nuÎ±r
;

406 
	}
}

408 
W¬
 *
	$g‘_w¬
(
CÏn
 *
şª
)

410 
W¬
 *
w¬
;

411 
w¬
 = 
w¬_bË_h—d
->
Ãxt
;

413 
w¬
 !ğ
w¬_bË_
) {

414 ià(
w¬
->
Úgošg
 && 
	`şª_š_w¬
(
şª
, w¬, 
Œue
))

415  
w¬
;

417 
w¬
 = w¬->
Ãxt
;

420  
nuÎ±r
;

421 
	}
}

423 
W¬
 *
	$g‘_§me_w¬
(
CÏn
 *
şªA
, CÏÀ*
şªB
)

425 
W¬
 *
w¬
;

426 
w¬
 = 
w¬_bË_h—d
->
Ãxt
;

428 ià(
şªA
 =ğ
şªB
)

429  
nuÎ±r
;

431 
w¬
 !ğ
w¬_bË_
) {

432 ià(
w¬
->
Úgošg
)

433 ià(
	`şª_š_w¬
(
şªA
, 
w¬
, 
Œue
)

434 && 
	`şª_š_w¬
(
şªB
, 
w¬
, 
Œue
))

435  
w¬
;

437 
w¬
 = w¬->
Ãxt
;

440  
nuÎ±r
;

441 
	}
}

443 
	$deã©_şª
(
W¬
 *
w¬
, 
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

445 
boŞ
 
ch®
 = 
çl£
, 
def
 = false;

446 
i
;

448 
i
 = 0; i < 4; i++) {

449 ià(
viùim
->
şª
->
Çme
 =ğ
w¬
->
ch®
[
i
]->name) {

450 
w¬
->
ch®
[
i
]->
šw¬
 = 
çl£
;

451 
w¬
->
ch®
[
i
]->
fš®_scÜe
 = 0;

454 ià(
viùim
->
şª
->
Çme
 =ğ
w¬
->
def
[
i
]->name) {

455 
w¬
->
def
[
i
]->
šw¬
 = 
çl£
;

456 
w¬
->
def
[
i
]->
fš®_scÜe
 = 0;

459 ià(!
w¬
->
ch®
[
i
]->
Çme
.
	`em±y
(è&& w¬->ch®[i]->
šw¬
)

460 
ch®
 = 
Œue
;

462 ià(!
w¬
->
def
[
i
]->
Çme
.
	`em±y
(è&& w¬->def[i]->
šw¬
)

463 
def
 = 
Œue
;

466 
	`»c_ev’t
(
w¬
, 
EVENT_CLAN_DEFEAT
, 
viùim
->
şª
->
şªÇme
, 
ch
->clan->clanname, 0);

468 ià(!
ch®
 && !
def
) {

469 
Loggšg
::
	`bug
("No„emaining clans in war!", 0);

473 ià(
ch®
 && 
def
)

477 
	`w¬_wš
(
w¬
, 
ch
);

478 
	}
}

480 
	$w¬_pow”_adju¡
(
CÏn
 *
vşª
, 
boŞ
 
su¼’d”
)

482 
buf
[
MSL
];

483 
CÏn
 *
tşª
;

484 
W¬
 *
w¬
;

485 
W¬
::
Ev’t
 *
ev’t
;

486 
d—É
 = 0, 
loss
, 
highe¡
, 
aw¬d
, 
numpow”
, 
ı
 = 0, 
q¶oss
, 
q·w¬d
;

487 
boŞ
 
found
;

488 
	scÚq
 {

489 
SŒšg
 
şªÇme
;

490 
scÜed
;

492 
¡d
::
veùÜ
<
cÚq
> 
cÚqli¡
;

493 
w¬
 = 
w¬_bË_h—d
;

496 
w¬
->
Ãxt
 !ğ
w¬_bË_
) {

497 
w¬
 = w¬->
Ãxt
;

499 ià(!
w¬
->
Úgošg
)

503 
ev’t
 = 
w¬
->
ev’ts
;ƒv’ˆ!ğ
nuÎ±r
;ƒv’ˆğev’t->
Ãxt
) {

504 ià(
ev’t
->
ty³
 !ğ
EVENT_ADJUST_SCORE
)

507 ià(
ev’t
->
a¡r
 =ğ
vşª
->
şªÇme
) {

509 
d—É
 +ğ
ev’t
->
numb”
;

513 ià(
ev’t
->
b¡r
 !ğ
vşª
->
şªÇme
)

516 
found
 = 
çl£
;

519 
tşª
 = 
şª_bË_h—d
->
Ãxt
;şª !ğ
şª_bË_
;clan =clan->next) {

520 ià(!
	`şª_š_w¬
(
tşª
, 
w¬
, 
Œue
))

523 ià(
ev’t
->
a¡r
 =ğ
tşª
->
şªÇme
) {

527 auto& 
’Œy
 : 
cÚqli¡
) {

528 ià(
’Œy
.
şªÇme
 =ğ
tşª
->clanname) {

529 
’Œy
.
scÜed
 +ğ
ev’t
->
numb”
;

530 
found
 = 
Œue
;

536 ià(!
found
) {

537 
cÚq
 
c
;

538 
c
.
şªÇme
 = 
tşª
->clanname;

539 
c
.
scÜed
 = 
ev’t
->
numb”
;

540 
cÚqli¡
.
	`push_back
(
c
);

550 ià(
cÚqli¡
.
	`em±y
())

554 
ı
 = 
	`ÿlc_ı
(
vşª
, 
çl£
);

556 
loss
 = 
¡d
::
	`mš
(3 + std::
	`max
((
ı
 / 5), 1), cp);

558 ià(!
su¼’d”
)

559 
loss
 = 
	`URANGE
(1, 
ı
 - 
d—É
,†oss);

561 
numpow”
 = 
ı
;

562 
q¶oss
 = 
su¼’d”
 ? 0 : 
vşª
->
şªqp
 / 10;

563 
vşª
->
şªqp
 -ğ
q¶oss
;

564 
vşª
->
w¬ımod
 -ğ
loss
;

565 
ı
 -ğ
loss
;

567 ià(!
ı
) {

568 
DesütÜ
 *
d
;

569 
Ch¬aù”
 *
viùim
;

571 
w¬
 = 
w¬_bË_h—d
->
Ãxt
; w¬ !ğ
w¬_bË_
; war = war->next)

572 ià(
w¬
->
Úgošg
 && 
	`şª_š_w¬
(
vşª
, w¬, 
Œue
))

573 
	`»c_ev’t
(
w¬
, 
EVENT_CLAN_WIPEOUT
, 
vşª
->
şªÇme
, "", 0);

575 
FÜm©
::
	`¥rštf
(
buf
, "[FYI] % ha b“Àwed out!", 
vşª
->
şªÇme
);

577 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

578 
viùim
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

580 ià(
d
->
	`is_¶ayšg
()

581 && !
viùim
->
comm_æags
.
	`has
(
COMM_NOANNOUNCE
)

582 && !
viùim
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

583 
	`Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_ANNOUNCE
);

584 
	`¡c
(
buf
, 
viùim
);

585 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

592 
i
 = 0; i < 
cÚqli¡
.
	`size
(); i++) {

593 
highe¡
 = 0;

596 cÚ¡‡uto& 
’Œy
 : 
cÚqli¡
)

597 ià(
’Œy
.
scÜed
 > 
highe¡
)

598 
highe¡
 = 
’Œy
.
scÜed
;

600 
x
 = 0; x < 
cÚqli¡
.
	`size
(); x++) {

601 ià(
loss
 <= 0)

604 ià(
cÚqli¡
[
x
].
scÜed
 =ğ
highe¡
) {

605 ià(
x
 =ğ
cÚqli¡
.
	`size
()-1) {

606 
q·w¬d
 = 
q¶oss
;

607 
aw¬d
 = 
loss
;

610 
aw¬d
 = 
	`URANGE
(1, ((((
cÚqli¡
[
x
].
scÜed
 * 100è/ 
numpow”
)

611 * 
loss
) / 100),†oss);

612 
q·w¬d
 = 
	`URANGE
(0, ((((
cÚqli¡
[
x
].
scÜed
 * 100è/ 
numpow”
)

613 * 
q¶oss
) / 100), qploss);

616 
tşª
 = 
şª_bË_h—d
->
Ãxt
;

617 
tşª
 !ğ
şª_bË_
;

618 
tşª
 =şª->
Ãxt
)

619 ià(
cÚqli¡
[
x
].
şªÇme
 =ğ
tşª
->clanname)

622 
w¬
 = 
w¬_bË_h—d
->
Ãxt
; w¬ !ğ
w¬_bË_
; war = war->next) {

623 ià(!
w¬
->
Úgošg
 || !
	`şª_š_w¬
(
vşª
, w¬, 
Œue
))

626 
	`»c_ev’t
(
w¬
, 
EVENT_ADJUST_POWER
, 
vşª
->
şªÇme
,

627 
tşª
->
şªÇme
, 
aw¬d
);

629 ià(
q·w¬d
 > 0)

630 
	`»c_ev’t
(
w¬
, 
EVENT_ADJUST_CLANQP
, 
vşª
->
şªÇme
,

631 
tşª
->
şªÇme
, 
q·w¬d
);

634 
tşª
->
w¬ımod
 +ğ
aw¬d
;

636 ià(
q·w¬d
 > 0)

637 
tşª
->
şªqp
 +ğ
q·w¬d
;

641 
loss
 -ğ
aw¬d
;

642 
q¶oss
 -ğ
q·w¬d
;

643 
cÚqli¡
[
x
].
scÜed
 = 0;

648 
	}
}

650 
	$w¬_scÜe_adju¡
(
W¬
 *
w¬
, 
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
amouÁ
)

652 
W¬
 *
™”
;

653 
buf
[
MSL
];

654 
viùim
->
şª
->
scÜe
 -ğ
amouÁ
;

655 
	`»c_ev’t
(
w¬
, 
EVENT_ADJUST_SCORE
, 
ch
->
şª
->
şªÇme
, 
viùim
->şª->şªÇme, 
amouÁ
);

657 ià(
viùim
->
şª
->
scÜe
 < 1) {

658 
FÜm©
::
	`¥rštf
(
buf
, "%s has defeated %s!",

659 
ch
->
şª
->
şªÇme
, 
viùim
->clan->clanname);

660 
	`do_£nd_ªnounû
(
ch
, 
buf
);

661 
	`±c
(
ch
, "You havdeã©ed %s!\n", 
viùim
->
şª
->
şªÇme
);

662 
	`w¬_pow”_adju¡
(
viùim
->
şª
, 
çl£
);

664 
™”
 = 
w¬_bË_h—d
->
Ãxt
; i‹¸!ğ
w¬_bË_
; iter = iter->next)

665 ià(
™”
->
Úgošg
 && 
	`şª_š_w¬
(
viùim
->
şª
, i‹r, 
Œue
))

666 
	`deã©_şª
(
w¬
, 
ch
, 
viùim
);

668 
viùim
->
şª
->
scÜe
 = 0;

670 ià(!
w¬
->
Úgošg
)

671 
	`¡c
("You havwÚhw¬!!\n", 
ch
);

674 
	`§ve_şª_bË
();

675 
	`§ve_w¬_bË
();

676 
	}
}

678 
	$w¬_kl
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

680 
W¬
 *
w¬
;

681 
pošts
 = 3;

683 
w¬
 = 
	`g‘_§me_w¬
(
ch
->
şª
, 
viùim
->clan);

684 
	`»c_ev’t
(
w¬
, 
EVENT_KILL
, 
ch
->
Çme
, 
viùim
->name, 0);

686 ià(
ch
->
pcd©a
->
pk¿nk
 - 
viùim
->pcd©a->pk¿nk > 3è
pošts
 = 1;

687 ià(
ch
->
pcd©a
->
pk¿nk
 - 
viùim
->pcd©a->pk¿nk > 1è
pošts
 = 2;

688 ià(
viùim
->
pcd©a
->
pk¿nk
 - 
ch
->pcd©a->pk¿nk > 3è
pošts
 = 4;

689 ià(
viùim
->
pcd©a
->
pk¿nk
 - 
ch
->pcd©a->pk¿nk > 1è
pošts
 = 5;

691 
	`w¬_scÜe_adju¡
(
w¬
, 
ch
, 
viùim
, 
pošts
);

692 
	}
}

694 
	$»c_ev’t
(
W¬
 *
w¬
, 
ty³
, cÚ¡ 
SŒšg
& 
a¡r
, cÚ¡ SŒšg& 
b¡r
, 
numb”
)

696 
W¬
::
Ev’t
 *
ev’t
, *
n_ev’t
;

697 
n_ev’t
 = 
Ãw
 
W¬
::
	`Ev’t
();

698 
n_ev’t
->
ty³
 =ype;

700 
n_ev’t
->
a¡r
 =‡str;

701 
n_ev’t
->
b¡r
 = bstr;

703 
n_ev’t
->
numb”
 =‚umber;

704 
n_ev’t
->
time
 = 
Game
::
cu¼’t_time
;

706 ià(
w¬
->
ev’ts
 =ğ
nuÎ±r
)

707 
w¬
->
ev’ts
 = 
n_ev’t
;

709 
ev’t
 = 
w¬
->
ev’ts
;ƒv’ˆ!ğ
nuÎ±r
;ƒv’ˆğev’t->
Ãxt
)

710 ià(
ev’t
->
Ãxt
 =ğ
nuÎ±r
) {

711 
ev’t
->
Ãxt
 = 
n_ev’t
;

716 
	`§ve_w¬_ev’ts
();

717 
	}
}

719 
W¬
 *
	$w¬_¡¬t
(
CÏn
 *
ch®
, CÏÀ*
def
)

721 
W¬
 *
w¬
 = 
Ãw
 
	`W¬
();

723 ià(
ch®
->
scÜe
 <= 0)

724 
ch®
->
scÜe
 = 
	`ÿlc_ı
(ch®, 
Œue
);

726 ià(
def
->
scÜe
 <= 0)

727 
def
->
scÜe
 = 
	`ÿlc_ı
(def, 
Œue
);

729 
w¬
->
ch®
[0]->
Çme
 = chal->name;

730 
w¬
->
ch®
[0]->
şªÇme
 = chal->clanname;

731 
w¬
->
ch®
[0]->
šw¬
 = 
Œue
;

732 
w¬
->
ch®
[0]->
¡¬t_scÜe
 = ch®->
scÜe
;

733 
w¬
->
ch®
[0]->
fš®_scÜe
 = 0;

734 
w¬
->
def
[0]->
Çme
 = def->name;

735 
w¬
->
def
[0]->
şªÇme
 = def->clanname;

736 
w¬
->
def
[0]->
šw¬
 = 
Œue
;

737 
w¬
->
def
[0]->
¡¬t_scÜe
 = def->
scÜe
;

738 
w¬
->
def
[0]->
fš®_scÜe
 = 0;

739 
w¬
->
Úgošg
 = 
Œue
;

740 
	`»c_ev’t
(
w¬
, 
EVENT_WAR_START
, "", "", 0);

741 
	`­³nd_w¬
(
w¬
);

742  
w¬
;

743 
	}
}

745 
	$w¬_¡İ
(
W¬
 *
w¬
)

747 
i
;

748 
CÏn
 *
şª
;

749 
w¬
->
Úgošg
 = 
çl£
;

751 
i
 = 0; i < 4; i++) {

752 ià(!
w¬
->
ch®
[
i
]->
Çme
.
	`em±y
()) {

753 ià((
şª
 = 
	`şª_lookup
(
w¬
->
ch®
[
i
]->
Çme
)è!ğ
nuÎ±r
) {

754 ià(
w¬
->
ch®
[
i
]->
šw¬
)

755 
w¬
->
ch®
[
i
]->
fš®_scÜe
 = 
şª
->
scÜe
;

757 ià(!
	`şª_©_w¬
(
şª
))

758 
şª
->
scÜe
 = 0;

762 ià(!
w¬
->
def
[
i
]->
Çme
.
	`em±y
()) {

763 ià((
şª
 = 
	`şª_lookup
(
w¬
->
def
[
i
]->
Çme
)è!ğ
nuÎ±r
) {

764 ià(
w¬
->
def
[
i
]->
šw¬
)

765 
w¬
->
def
[
i
]->
fš®_scÜe
 = 
şª
->
scÜe
;

767 ià(!
	`şª_©_w¬
(
şª
))

768 
şª
->
scÜe
 = 0;

772 
	}
}

774 
	$w¬_wš
(
W¬
 *
w¬
, 
Ch¬aù”
 *
ch
)

776 
	`»c_ev’t
(
w¬
, 
EVENT_WAR_STOP_WIN
, "", "", 
	`şª_is_ch®Ëng”
(
ch
->
şª
, war));

777 
	`w¬_¡İ
(
w¬
);

778 
	}
}

780 
	$w¬_još
(
CÏn
 *
şª
, 
W¬
 *
w¬
, 
boŞ
 
ch®Ëng”
)

782 
i
;

784 
i
 = 0; i < 4; i++) {

785 ià(
ch®Ëng”
) {

786 ià(
w¬
->
ch®
[
i
]->
Çme
.
	`em±y
())

790 ià(
w¬
->
def
[
i
]->
Çme
.
	`em±y
())

795 ià(
şª
->
scÜe
 <= 0)

796 
şª
->
scÜe
 = 
	`ÿlc_ı
(şª, 
Œue
);

798 ià(
ch®Ëng”
) {

799 
w¬
->
ch®
[
i
]->
Çme
 = 
şª
->name;

800 
w¬
->
ch®
[
i
]->
şªÇme
 = 
şª
->clanname;

801 
w¬
->
ch®
[
i
]->
šw¬
 = 
Œue
;

802 
w¬
->
ch®
[
i
]->
¡¬t_scÜe
 = 
şª
->
scÜe
;

803 
w¬
->
ch®
[
i
]->
fš®_scÜe
 = 0;

806 
w¬
->
def
[
i
]->
Çme
 = 
şª
->name;

807 
w¬
->
def
[
i
]->
şªÇme
 = 
şª
->clanname;

808 
w¬
->
def
[
i
]->
šw¬
 = 
Œue
;

809 
w¬
->
def
[
i
]->
¡¬t_scÜe
 = 
şª
->
scÜe
;

810 
w¬
->
def
[
i
]->
fš®_scÜe
 = 0;

812 
	}
}

814 
	$w¬_unjoš
(
CÏn
 *
şª
, 
W¬
 *
w¬
, 
boŞ
 
»move
)

816 
i
;

818 
i
 = 0; i < 4; i++) {

819 ià(
w¬
->
ch®
[
i
]->
Çme
 =ğ
şª
->name) {

820 ià(
»move
) {

821 
w¬
->
ch®
[
i
]->
Çme
.
	`”a£
();

822 
w¬
->
ch®
[
i
]->
şªÇme
.
	`”a£
();

823 
w¬
->
ch®
[
i
]->
fš®_scÜe
 = 0;

826 
w¬
->
ch®
[
i
]->
fš®_scÜe
 = 
şª
->
scÜe
;

828 
w¬
->
ch®
[
i
]->
šw¬
 = 
çl£
;

832 ià(
w¬
->
def
[
i
]->
Çme
 =ğ
şª
->name) {

833 ià(
»move
) {

834 
w¬
->
def
[
i
]->
Çme
.
	`”a£
();

835 
w¬
->
def
[
i
]->
şªÇme
.
	`”a£
();

836 
w¬
->
def
[
i
]->
fš®_scÜe
 = 0;

839 
w¬
->
def
[
i
]->
fš®_scÜe
 = 
şª
->
scÜe
;

841 
w¬
->
def
[
i
]->
šw¬
 = 
çl£
;

846 ià(
»move
)

847 
	`fix_w¬
(
w¬
);

849 ià(!
	`şª_©_w¬
(
şª
))

850 
şª
->
scÜe
 = 0;

851 
	}
}

853 
	$fÜm©_w¬_li¡
(
Ch¬aù”
 *
ch
, 
W¬
 *
w¬
, 
boŞ
 
cu¼’t
)

855 
CÏn
 *
şª
;

856 
chblock
[
MSL
], 
defblock
[MSL], 
buf
[MSL], *
vsblock
;

857 
i
, 
x
, 
chcouÁ
 = 0, 
defcouÁ
 = 0, 
c
 = 0, 
d
 = 0, 
chËad
, 
deæ—d
, 
lšes
;

858 
SŒšg
 
ouut
;

859 
	sİp_li¡
 {

860 
SŒšg
 
Çme
;

861 
boŞ
 
šw¬
;

862 
¡_scÜe
;

863 
scÜe
;

865 
İp_li¡
 
ch®_li¡
[4];

866 
İp_li¡
 
def_li¡
[4];

869 
i
 = 0; i < 4; i++) {

870 ià(!
w¬
->
ch®
[
i
]->
Çme
.
	`em±y
()) {

871 
ch®_li¡
[
chcouÁ
].
Çme
 = 
w¬
->
ch®
[
i
]->
şªÇme
;

872 
ch®_li¡
[
chcouÁ
].
šw¬
 = 
w¬
->
ch®
[
i
]->inwar;

873 
ch®_li¡
[
chcouÁ
].
¡_scÜe
 = 
w¬
->
ch®
[
i
]->
¡¬t_scÜe
;

875 ià((
şª
 = 
	`şª_lookup
(
w¬
->
ch®
[
i
]->
Çme
)è!ğ
nuÎ±r


876 && 
w¬
->
ch®
[
i
]->
šw¬
 && 
cu¼’t
)

877 
ch®_li¡
[
chcouÁ
].
scÜe
 = 
şª
->score;

879 
ch®_li¡
[
chcouÁ
].
scÜe
 = 
w¬
->
ch®
[
i
]->
fš®_scÜe
;

881 
chcouÁ
++;

884 ià(!
w¬
->
def
[
i
]->
Çme
.
	`em±y
()) {

885 
def_li¡
[
defcouÁ
].
Çme
 = 
w¬
->
def
[
i
]->
şªÇme
;

886 
def_li¡
[
defcouÁ
].
šw¬
 = 
w¬
->
def
[
i
]->inwar;

887 
def_li¡
[
defcouÁ
].
¡_scÜe
 = 
w¬
->
def
[
i
]->
¡¬t_scÜe
;

889 ià((
şª
 = 
	`şª_lookup
(
w¬
->
def
[
i
]->
Çme
)è!ğ
nuÎ±r


890 && 
w¬
->
def
[
i
]->
šw¬
 && 
cu¼’t
)

891 
def_li¡
[
defcouÁ
].
scÜe
 = 
şª
->score;

893 
def_li¡
[
defcouÁ
].
scÜe
 = 
w¬
->
def
[
i
]->
fš®_scÜe
;

895 
defcouÁ
++;

899 ià(
chcouÁ
 < 1 || 
defcouÁ
 < 1) {

900 
Loggšg
::
	`bug
("war status: war is one sided!", 0);

904 ià(
chcouÁ
 > 4 || 
defcouÁ
 > 4) {

905 
Loggšg
::
	`bug
("war status: war hasoo many clans on one side!", 0);

909 
FÜm©
::
	`¥rštf
(
chblock
, " ");

910 
FÜm©
::
	`¥rštf
(
defblock
, " ");

911 
vsblock
 = "";

912 
chËad
 = (
chcouÁ
 - 
defcouÁ
);

913 
deæ—d
 = (
defcouÁ
 - 
chcouÁ
);

914 
lšes
 = (
chcouÁ
 > 
defcouÁ
 ? chcount : defcount);

915 
ouut
 += "\n";

917 
x
 = 1; x < (
lšes
 + 1); x++) {

918 ià((
deæ—d
 > 1 && 
x
 =ğ1è|| 
c
 >ğ
chcouÁ
)

919 
FÜm©
::
	`¥rštf
(
chblock
, " ");

920 ià(
c
 < 
chcouÁ
) {

921 
FÜm©
::
	`¥rštf
(
chblock
, "%s%30s %s(%s%2d{c/%s%2d%s)",

922 
ch®_li¡
[
c
].
šw¬
 ? "" : "{c",

923 
ch®_li¡
[
c
].
šw¬
 ? ch®_li¡[c].
Çme
 : ch®_li¡[c].Çme.
	`uncŞÜ
(),

924 
ch®_li¡
[
c
].
šw¬
 ? "{g" : "{c",

925 
ch®_li¡
[
c
].
šw¬
 ? "{G" : "{P",

926 
ch®_li¡
[
c
].
scÜe
,

927 
ch®_li¡
[
c
].
šw¬
 ? "{G" : "{P",

928 
ch®_li¡
[
c
].
¡_scÜe
,

929 
ch®_li¡
[
c
].
šw¬
 ? "{g" : "{c");

930 
c
++;

933 ià(
chËad
 <ğ1 && 
deæ—d
 <ğ1 && 
chcouÁ
 < 3 && 
defcouÁ
 < 3) {

934 ià(
x
 == 1)

935 
vsblock
 = "vs";

937 
vsblock
 = " ";

940 ià(
x
 == 2)

941 
vsblock
 = "vs";

943 
vsblock
 = " ";

946 ià((
chËad
 > 1 && 
x
 =ğ1è|| 
d
 >ğ
defcouÁ
)

947 
FÜm©
::
	`¥rštf
(
defblock
, " ");

948 ià(
d
 < 
defcouÁ
) {

949 
FÜm©
::
	`¥rštf
(
defblock
, "%s(%s%2d{c/%s%2d%s) %s%-30s",

950 
def_li¡
[
d
].
šw¬
 ? "{g" : "{c",

951 
def_li¡
[
d
].
šw¬
 ? "{G" : "{P",

952 
def_li¡
[
d
].
scÜe
,

953 
def_li¡
[
d
].
šw¬
 ? "{G" : "{P",

954 
def_li¡
[
d
].
¡_scÜe
,

955 
def_li¡
[
d
].
šw¬
 ? "{g" : "{c",

956 
def_li¡
[
d
].
šw¬
 ? "{x" : "",

957 
def_li¡
[
d
].
šw¬
 ? def_li¡[d].
Çme
 : def_li¡[d].Çme.
	`uncŞÜ
());

958 
d
++;

961 
FÜm©
::
	`¥rštf
(
buf
, "%s{x %s{x %s{x\n", 
chblock
, 
vsblock
, 
defblock
);

962 
ouut
 +ğ
buf
;

965 
ouut
 += "\n";

966 
	`·ge_to_ch¬
(
ouut
, 
ch
);

967 
	}
}

969 
	$fÜm©_w¬_ev’ts
(
Ch¬aù”
 *
ch
, 
W¬
 *
w¬
)

971 
buf
[
MSL
];

972 
SŒšg
 
ouut
;

973 
W¬
::
Ev’t
 *
ev’t
;

974 
	`fÜm©_w¬_li¡
(
ch
, 
w¬
, w¬->
Úgošg
);

976 
ev’t
 = 
w¬
->
ev’ts
;ƒv’ˆ!ğ
nuÎ±r
;ƒv’ˆğev’t->
Ãxt
) {

977 
FÜm©
::
	`¥rštf
(
buf
, "{Punknownƒventype{x");

979 
ev’t
->
ty³
) {

980 
EVENT_WAR_START
:

981 
FÜm©
::
	`¥rštf
(
buf
, "W¬ s¹ed oÀ%s\n", 
	`dizzy_ùime
(&
ev’t
->
time
));

984 
EVENT_WAR_STOP_WIN
:

985 
FÜm©
::
	`¥rštf
(
buf
, "The %s wonhe war on %s\n",

986 
ev’t
->
numb”
 ? "challengers" : "defenders",

987 
	`dizzy_ùime
(&
ev’t
->
time
));

990 
EVENT_WAR_STOP_IMM
:

991 
FÜm©
::
	`¥rštf
(
buf
, "War was stopped byhe Immortals on %s\n",

992 
	`dizzy_ùime
(&
ev’t
->
time
));

995 
EVENT_WAR_DECLARE
:

996 
FÜm©
::
	`¥rštf
(
buf
, "%s has declared war on %s!\n",

997 
ev’t
->
a¡r
,ƒv’t->
b¡r
);

1000 
EVENT_WAR_JOIN
:

1001 
FÜm©
::
	`¥rštf
(
buf
, "%s has joinedhe war onhe %s side!\n",

1002 
ev’t
->
a¡r
,ƒv’t->
numb”
 ? "challenging" : "defending");

1005 
EVENT_KILL
:

1006 
FÜm©
::
	`¥rštf
(
buf
, "% ha b“ÀkËd by %s!\n", 
ev’t
->
b¡r
,ƒv’t->
a¡r
);

1009 
EVENT_CLAN_DEFEAT
:

1010 
FÜm©
::
	`¥rštf
(
buf
, "% ha b“Àdeã©ed by %s!\n", 
ev’t
->
a¡r
,ƒv’t->
b¡r
);

1013 
EVENT_CLAN_WIPEOUT
:

1014 
FÜm©
::
	`¥rštf
(
buf
, "% ha b“Àwed ouˆš w¬!\n", 
ev’t
->
a¡r
);

1017 
EVENT_CLAN_SURRENDER
:

1018 
FÜm©
::
	`¥rštf
(
buf
, "% ha su¼’d”ed.\n", 
ev’t
->
a¡r
);

1021 
EVENT_CLAN_INVADE
:

1024 
EVENT_ADJUST_SCORE
:

1025 
FÜm©
::
	`¥rštf
(
buf
, "%s has†ost %d…oints‡the hands of %s!\n",

1026 
ev’t
->
b¡r
,ƒv’t->
numb”
,ƒv’t->
a¡r
);

1029 
EVENT_ADJUST_POWER
:

1030 
FÜm©
::
	`¥rštf
(
buf
, "%s†ost %d clanpowero %s.\n",

1031 
ev’t
->
a¡r
,ƒv’t->
numb”
,ƒv’t->
b¡r
);

1034 
EVENT_ADJUST_CLANQP
:

1035 
FÜm©
::
	`¥rštf
(
buf
, "%surned over %d questpointso %s.\n",

1036 
ev’t
->
a¡r
,ƒv’t->
numb”
,ƒv’t->
b¡r
);

1040 
Loggšg
::
	`bug
("format_war_events: Eventype unknown", 0);

1044 
ouut
 +ğ
buf
;

1047 
	`·ge_to_ch¬
(
ouut
, 
ch
);

1048 
	}
}

1051 
	$do_w¬
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1053 
buf
[
MSL
];

1054 
CÏn
 *
şªA
, *
şªB
;

1055 
W¬
 *
w¬
 = 
nuÎ±r
;

1056 
couÁ
 = 0, 
numb”
 = 0;

1057 
boŞ
 
ch®Ëng”
 = 
çl£
;

1059 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
;

1060 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

1061 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

1062 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g3
);

1065 ià(
¬g1
.
	`is_´efix_of
("history")) {

1066 
boŞ
 
found
 = 
çl£
;

1067 
w¬
 = 
w¬_bË_h—d
->
Ãxt
;

1069 
w¬
 !ğ
w¬_bË_
) {

1070 
couÁ
++;

1072 ià(!
w¬
->
Úgošg
) {

1073 
	`±c
(
ch
, "{PW¬ %d:{x", 
couÁ
);

1074 
	`fÜm©_w¬_li¡
(
ch
, 
w¬
, 
çl£
);

1075 
found
 = 
Œue
;

1078 
w¬
 = w¬->
Ãxt
;

1081 ià(!
found
)

1082 
	`¡c
("NØw¬ hav’ded y‘.\n", 
ch
);

1088 ià(
¬g1
.
	`is_´efix_of
("list")) {

1089 
boŞ
 
³aû
 = 
Œue
;

1090 
w¬
 = 
w¬_bË_h—d
->
Ãxt
;

1092 
w¬
 !ğ
w¬_bË_
) {

1093 
couÁ
++;

1095 ià(
w¬
->
Úgošg
) {

1096 
	`±c
(
ch
, "{PW¬ %d:{x", 
couÁ
);

1097 
	`fÜm©_w¬_li¡
(
ch
, 
w¬
, 
Œue
);

1098 
³aû
 = 
çl£
;

1101 
w¬
 = w¬->
Ãxt
;

1104 ià(
³aû
)

1105 
	`¡c
("Legacy i cu¼’y‡ˆ³aû.\n", 
ch
);

1111 ià(
¬g1
.
	`is_´efix_of
("events")) {

1112 ià(
¬g2
.
	`em±y
()) {

1113 
	`¡c
("SyÁax: w¬ƒv’t <w¬‚umb”>\n", 
ch
);

1117 ià(!
¬g2
.
	`is_numb”
()) {

1118 
	`¡c
("U£hnumb” oàthw¬.\n", 
ch
);

1122 
numb”
 = 
	`©oi
(
¬g2
);

1124 ià((
w¬
 = 
	`w¬_lookup
(
numb”
)è=ğ
nuÎ±r
) {

1125 
	`¡c
("Th© i nÙ‡ v®id w¬.\n", 
ch
);

1129 
	`fÜm©_w¬_ev’ts
(
ch
, 
w¬
);

1134 ià(
¬g1
 =ğ"deş¬e" && 
	`IS_IMMORTAL
(
ch
)) {

1135 ià(
¬g2
.
	`em±y
(è|| 
¬g3
.empty()) {

1136 
	`¡c
("SyÁax: w¬ deş¬<ch®Ëng”> <deãnd”>\n", 
ch
);

1140 ià((
şªA
 = 
	`şª_lookup
(
¬g2
)è=ğ
nuÎ±r
) {

1141 
	`±c
(
ch
, "'%s' i nÙ‡ cÏn.\n", 
¬g2
);

1145 ià((
şªB
 = 
	`şª_lookup
(
¬g3
)è=ğ
nuÎ±r
) {

1146 
	`±c
(
ch
, "'%s' i nÙ‡ cÏn.\n", 
¬g3
);

1150 ià(
şªA
 =ğ
şªB
) {

1151 
	`¡c
("They cªnÙ deş¬w¬ oÀthem£lves.\n", 
ch
);

1155 ià(
şªA
->
šd•’d’t
 || 
şªB
->independent) {

1156 
	`¡c
("Ind•’d’ˆşª ÿÂÙ w¬.\n", 
ch
);

1160 ià(
	`ÿlc_ı
(
şªA
, 
çl£
) < 1) {

1161 
	`¡c
("Thch®Ëng” i nÙ sŒÚgƒnoughØwagw¬.\n", 
ch
);

1165 ià(
	`ÿlc_ı
(
şªB
, 
çl£
) < 1) {

1166 
	`¡c
("Thdeãnd” i ®»ady deã©ed.\n", 
ch
);

1170 ià(
	`şª_İpÚ’ts
(
şªA
, 
şªB
)) {

1171 
	`¡c
("They‡»‡Ì—dy‡ˆw¬ w™hƒachÙh”.\n", 
ch
);

1175 ià(
	`şª_©_w¬
(
şªA
è|| cÏn_©_w¬(
şªB
)) {

1176 
boŞ
 
w¬_found
 = 
çl£
;

1179 
w¬
 = 
w¬_bË_h—d
->
Ãxt
; w¬ !ğ
w¬_bË_
; war = war->next) {

1180 ià(!
w¬
->
Úgošg
)

1183 ià(!
	`şª_š_w¬
(
şªB
, 
w¬
, 
Œue
))

1186 ià(
	`şª_š_w¬
(
şªA
, 
w¬
, 
çl£
))

1189 
	`w¬_još
(
şªA
, 
w¬
, !
	`şª_is_ch®Ëng”
(
şªB
, war));

1190 
w¬_found
 = 
Œue
;

1195 ià(!
w¬_found
)

1196 
w¬
 = 
w¬_bË_h—d
->
Ãxt
; w¬ !ğ
w¬_bË_
; war = war->next) {

1197 ià(!
w¬
->
Úgošg
)

1200 ià(!
	`şª_š_w¬
(
şªB
, 
w¬
, 
Œue
))

1203 ià(
	`şª_š_w¬
(
şªA
, 
w¬
, 
çl£
))

1206 
	`w¬_još
(
şªA
, 
w¬
, !
	`şª_is_ch®Ëng”
(
şªB
, war));

1207 
w¬_found
 = 
Œue
;

1212 ià(!
w¬_found
)

1213 
w¬
 = 
	`w¬_¡¬t
(
şªA
, 
şªB
);

1216 
w¬
 = 
	`w¬_¡¬t
(
şªA
, 
şªB
);

1218 
	`»c_ev’t
(
w¬
, 
EVENT_WAR_DECLARE
, 
şªA
->
şªÇme
, 
şªB
->clanname, 0);

1219 
	`§ve_şª_bË
();

1220 
	`§ve_w¬_bË
();

1221 
	`±c
(
ch
, "%s is‚ow‡t war with %s.\n",

1222 
şªA
->
şªÇme
, 
şªB
->clanname);

1223 
FÜm©
::
	`¥rštf
(
buf
, "%s has declared war on %s!",

1224 
şªA
->
şªÇme
, 
şªB
->clanname);

1225 
	`do_£nd_ªnounû
(
ch
, 
buf
);

1230 ià(
¬g1
 =ğ"još" && 
	`IS_IMMORTAL
(
ch
)) {

1231 ià(
¬g2
.
	`em±y
(è|| 
¬g3
.em±y(è|| 
¬gum’t
.empty()) {

1232 
	`¡c
("SyÁax: w¬ još <şª> <w¬‚umb”> <ch®Ëng”|deãnd”>\n", 
ch
);

1236 ià((
şªA
 = 
	`şª_lookup
(
¬g2
)è=ğ
nuÎ±r
) {

1237 
	`±c
(
ch
, "'%s' i nÙ‡ cÏn.\n", 
¬g2
);

1241 ià(!
¬g3
.
	`is_numb”
()) {

1242 
	`¡c
("U£‡‚umb” fÜhw¬.\n", 
ch
);

1246 
numb”
 = 
	`©oi
(
¬g3
);

1248 ià((
w¬
 = 
	`w¬_lookup
(
numb”
)è=ğ
nuÎ±r
) {

1249 
	`¡c
("Th© i nÙ‡ v®id w¬.\n", 
ch
);

1253 ià(
¬gum’t
.
	`is_´efix_of
("challenger"))

1254 
ch®Ëng”
 = 
Œue
;

1255 ià(
¬gum’t
.
	`is_´efix_of
("defender"))

1256 
ch®Ëng”
 = 
çl£
;

1258 
	`¡c
("U£ 'ch®Ëng”' o¸'deãnd”'‡á”hw¬‚umb”.\n", 
ch
);

1262 ià(
şªA
->
šd•’d’t
) {

1263 
	`¡c
("Ind•’d’ˆşª ÿÂÙ w¬.\n", 
ch
);

1267 ià(
	`ÿlc_ı
(
şªA
, 
çl£
) < 1) {

1268 
	`¡c
("Thşª i nÙ sŒÚgƒnoughØwagw¬.\n", 
ch
);

1272 ià(
	`şª_š_w¬
(
şªA
, 
w¬
, 
çl£
)) {

1273 
	`¡c
("They‡»‡Ì—dy…¬ˆoàth© w¬.\n", 
ch
);

1277 ià(
	`w¬_is_fuÎ
(
w¬
, 
ch®Ëng”
)) {

1278 
	`¡c
("Th© w¬ i fuÎ.\n", 
ch
);

1282 
	`w¬_još
(
şªA
, 
w¬
, 
ch®Ëng”
);

1283 
	`»c_ev’t
(
w¬
, 
EVENT_WAR_JOIN
, 
şªA
->
şªÇme
, "", 
ch®Ëng”
);

1284 
	`§ve_şª_bË
();

1285 
	`§ve_w¬_bË
();

1286 
	`±c
(
ch
, "%s is‚ow‡ %s in War %d.\n",

1287 
şªA
->
şªÇme
, 
ch®Ëng”
 ? "ch®Ëng”" : "deãnd”", 
numb”
);

1288 
FÜm©
::
	`¥rštf
(
buf
, "%s has joined war %d!",

1289 
şªA
->
şªÇme
, 
numb”
);

1290 
	`do_£nd_ªnounû
(
ch
, 
buf
);

1295 ià(
¬g1
 =ğ"unjoš" && 
	`IS_IMMORTAL
(
ch
)) {

1296 
boŞ
 
»move
 = 
çl£
;

1298 ià(
¬g2
.
	`em±y
(è|| 
¬g3
.em±y(è|| 
¬gum’t
.empty()) {

1299 
	`¡c
("SyÁax: w¬ unjoš <şª> <w¬‚umb”> <»move|¡İ>\n", 
ch
);

1303 ià((
şªA
 = 
	`şª_lookup
(
¬g2
)è=ğ
nuÎ±r
) {

1304 
	`±c
(
ch
, "'%s' i nÙ‡ cÏn.\n", 
¬g2
);

1308 ià(!
¬g3
.
	`is_numb”
()) {

1309 
	`¡c
("U£hnumb” oàthw¬.\n", 
ch
);

1313 
numb”
 = 
	`©oi
(
¬g3
);

1315 ià((
w¬
 = 
	`w¬_lookup
(
numb”
)è=ğ
nuÎ±r
) {

1316 
	`¡c
("Th© i nÙ‡ v®id w¬.\n", 
ch
);

1320 ià(
¬gum’t
.
	`is_´efix_of
("remove"))

1321 
»move
 = 
Œue
;

1322 ià(
¬gum’t
.
	`is_´efix_of
("stop"))

1323 
»move
 = 
çl£
;

1325 
	`¡c
("U£ '»move' o¸'¡İ'‡á”hw¬‚umb”.\n", 
ch
);

1329 ià(!
w¬
->
Úgošg
) {

1330 
	`¡c
("Th© w¬ ha ¡İ³d.\n", 
ch
);

1334 
	`w¬_unjoš
(
şªA
, 
w¬
, 
»move
);

1335 
	`§ve_şª_bË
();

1336 
	`§ve_w¬_bË
();

1338 ià(
»move
)

1339 
	`¡c
("You„emovthem fromhw¬.\n", 
ch
);

1341 
	`¡c
("You stİheœ‡ùiv™y iÀthw¬.\n", 
ch
);

1379 ià(
¬g1
 =ğ"¡İ" && 
	`IS_IMMORTAL
(
ch
)) {

1380 ià(
¬g2
.
	`em±y
()) {

1381 
	`¡c
("SyÁax: w¬ stİ <w¬‚umb”>\n", 
ch
);

1385 ià(!
¬g2
.
	`is_numb”
()) {

1386 
	`¡c
("U£hnumb” oàthw¬.\n", 
ch
);

1390 ià((
numb”
 = 
	`©oi
(
¬g2
)) < 1) {

1391 
	`¡c
("Numb” mu¡ bg»©”hª 0.\n", 
ch
);

1395 ià((
w¬
 = 
	`w¬_lookup
(
numb”
)è=ğ
nuÎ±r
) {

1396 
	`¡c
("Th© i nÙ‡ v®id w¬.\n", 
ch
);

1400 ià(!
w¬
->
Úgošg
) {

1401 
	`¡c
("Thw¬ ha ®»ady stİ³d.\n", 
ch
);

1405 
	`»c_ev’t
(
w¬
, 
EVENT_WAR_STOP_IMM
, "", "", 0);

1406 
	`w¬_¡İ
(
w¬
);

1407 
	`§ve_şª_bË
();

1408 
	`§ve_w¬_bË
();

1409 
	`¡c
("You stİhw¬.\n", 
ch
);

1414 ià(
¬g1
 =ğ"»lßd" && 
	`IS_IMP
(
ch
)) {

1415 
W¬
 *
w¬_Ãxt
;

1416 
w¬
 = 
w¬_bË_h—d
;

1418 
w¬
 !ğ
nuÎ±r
) {

1419 
w¬_Ãxt
 = 
w¬
->
Ãxt
;

1420 
d–‘e
 
w¬
;

1421 
w¬
 = 
w¬_Ãxt
;

1424 
	`lßd_w¬_bË
();

1425 
	`lßd_w¬_ev’ts
();

1426 
	`¡c
("W¬abË„–ßded.\n", 
ch
);

1462 
	`¡c
("SyÁax:\n", 
ch
);

1463 
	`¡c
(" w¬†i¡\n", 
ch
);

1464 
	`¡c
(" w¬ hi¡Üy\n", 
ch
);

1465 
	`¡c
(" w¬ƒv’t  <w¬‚umb”>\n", 
ch
);

1467 ià(
	`IS_IMMORTAL
(
ch
)) {

1468 
	`¡c
(" w¬ deş¬ <ch®Ëng”> <deãnd”>\n", 
ch
);

1469 
	`¡c
(" w¬ još <şª> <w¬‚umb”> <ch®Ëng”|deãnd”>\n", 
ch
);

1470 
	`¡c
(" w¬ unjoš <şª> <w¬‚umb”> <»move|¡İ>\n", 
ch
);

1472 
	`¡c
(" w¬ stİ <w¬‚umb”>\n", 
ch
);

1477 
	}
}

	@src/Weather.cc

1 
	~"W—th”.hh
"

3 
	~"Ch¬aù”.hh
"

4 
	~"FÏgs.hh
"

5 
	~"FÜm©.hh
"

6 
	~"Game.hh
"

7 
	~"GameTime.hh
"

8 
	~"Loggšg.hh
"

9 
	~"m”c.hh
"

10 
	~"¿ndom.hh
"

11 
	~"Room.hh
"

12 
	~"WÜld.hh
"

14 
	gW—th”
::

15 
	$W—th”
(cÚ¡ 
GameTime
& 
t
) :

16 
	$time
(
t
)

18 ià(
time
.
mÚth
 >= 7 &&ime.month <= 12)

19 
mmhg
 +ğ
	`numb”_¿nge
(1, 50);

21 
mmhg
 +ğ
	`numb”_¿nge
(1, 80);

23 ià(
mmhg
 <ğ980è
sky
 = 
LighŠšg
;

24 ià(
mmhg
 <ğ1000è
sky
 = 
Raššg
;

25 ià(
mmhg
 <ğ1020è
sky
 = 
Cloudy
;

26 
sky
 = 
CloudËss
;

27 
	}
}

29 cÚ¡ 
SŒšg
 
	gW—th”
::

30 
	$desüibe
() const {

31 cÚ¡ 
SŒšg
 
sky_look
[4] = {

34 #ifdeà
SEASON_CHRISTMAS


42 
SŒšg
 
buf
 = 
FÜm©
::
	`fÜm©
("The sky is %s‡nd %s.\n",

43 
sky_look
[
sky
],

44 
chªge
 >= 0

45 #ifdeà
SEASON_CHRISTMAS


54  
buf
;

55 
	}
}

57 
	gW—th”
::

58 
	$upd©e
()

60 
SŒšg
 
buf
;

61 
diff
;

66 ià(
time
.
mÚth
 >= 9 &&ime.month <= 16)

67 
diff
 = 
mmhg
 > 985 ? -2 : 2;

69 
diff
 = 
mmhg
 > 1015 ? -2 : 2;

71 
chªge
 +ğ
diff
 * 
	`diû
(1, 4) + dice(2, 6) - dice(2, 6);

72 
chªge
 = 
¡d
::
	`max
(change, -12);

73 
chªge
 = 
¡d
::
	`mš
(change, 12);

74 
mmhg
 +ğ
chªge
;

75 
mmhg
 = 
¡d
::
	`max
(mmhg, 960);

76 
mmhg
 = 
¡d
::
	`mš
(mmhg, 1040);

78 
sky
) {

80 
Loggšg
::
	`bug
("W—th”_upd©e: bad sky %d.", 
sky
);

81 
sky
 = 
CloudËss
;

84 
CloudËss
:

85 ià(
mmhg
 < 990 || (mmhg < 1010 && 
	`numb”_b™s
(2) == 0)) {

86 
buf
 += "The sky grows dark with„olling grey clouds.\n";

87 
sky
 = 
Cloudy
;

92 
Cloudy
:

93 ià(
mmhg
 < 970 || (mmhg < 990 && 
	`numb”_b™s
(2) == 0)) {

94 #ifdeà
SEASON_CHRISTMAS


95 
buf
 += "Snow startso fall fromhe sky.\n";

97 
buf
 += "It startso„ain‡ heavy downpour.\n";

99 
sky
 = 
Raššg
;

102 ià(
mmhg
 > 1030 && 
	`numb”_b™s
(2) == 0) {

103 
buf
 += "Shafts of†ight cuthroughhe dense clouds‡bove.\n";

104 
sky
 = 
CloudËss
;

109 
Raššg
:

110 ià(
mmhg
 < 970 && 
	`numb”_b™s
(2) == 0) {

111 
buf
 += "Lightning flashes inhe sky.\n";

112 
sky
 = 
LighŠšg
;

115 ià(
mmhg
 > 1030 || (mmhg > 1010 && 
	`numb”_b™s
(2) == 0)) {

116 #ifdeà
SEASON_CHRISTMAS


117 
buf
 += "The snow slowso‡ few flakes,‡nd finally stops.\n";

119 
buf
 += "The„ain stopped.\n";

121 
sky
 = 
Cloudy
;

126 
LighŠšg
:

127 ià(
mmhg
 > 1010 || (mmhg > 990 && 
	`numb”_b™s
(2) == 0)) {

128 
buf
 += "The†ightning has stopped.\n";

129 
sky
 = 
Raššg
;

136 ià(!
buf
.
	`em±y
()) {

137 autØ
ch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

139 ià(!
ch
->
	`is_Åc
()

140 && 
	`IS_OUTSIDE
(
ch
)

141 && 
	`IS_AWAKE
(
ch
)

142 && 
ch
->
aù_æags
.
	`has
(
PLR_TICKS
))

143 
	`¡c
(
buf
, 
ch
);

146 
	}
}

	@src/World.cc

1 
	~"WÜld.hh
"

3 
	~"A»a.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"wÜldm­/CoÜdš©e.hh
"

6 
	~"Game.hh
"

7 
	~"Loggšg.hh
"

8 
	~"fe.hh
"

9 
	~"Ex™.hh
"

10 
	~"Ex™PrÙÙy³.hh
"

11 
	~"RoomPrÙÙy³.hh
"

12 
	~"Room.hh
"

14 
	gWÜld
::

15 
	$WÜld
() :

16 
	`time
(
Game
::
cu¼’t_time
),

17 
	`w—th”
(
time
),

18 
	`ov”wÜld
(),

19 
	`m­Œ“
(
ov”wÜld
.
	$width
())

20 {
	}
}

22 
	gWÜld
::

23 ~
	$WÜld
() {

24 auto& 
·œ
 : 
¬—s
)

25 
d–‘e
 
·œ
.
£cÚd
;

26 
	}
}

28 
	gWÜld
::

29 
	$upd©e
() {

30 
pul£_¬—
 = 0;

32 ià(--
pul£_¬—
 <= 0) {

33 
pul£_¬—
 = 
PULSE_AREA
;

35 auto& 
·œ
 : 
¬—s
)

36 
·œ
.
£cÚd
->
	`upd©e
();

39 
ch¬_li¡
.
	`d–‘e_g¬bage
();

40 
	}
}

42 
	gWÜld
::

43 
	$add_ch¬
(
Ch¬aù”
 *
ch
) {

44 
ch¬_li¡
.
	`add
(
ch
);

45 
	}
}

47 
	gWÜld
::

48 
	$»move_ch¬
(
Ch¬aù”
 *
ch
) {

49 
ch¬_li¡
.
	`»move
(
ch
);

50 
	}
}

52 
A»a
 * 
	gWÜld
::

53 
	$g‘_¬—
(cÚ¡ 
Vnum
& 
vnum
) const {

57 autØ
·œ
 = 
¬—s
.
	`fšd
(
	`VnumRªge
(
vnum
, vnum));

59 ià(
·œ
 =ğ
¬—s
.
	`’d
())

60  
nuÎ±r
;

62  
·œ
->
£cÚd
;

63 
	}
}

65 
MobePrÙÙy³
 * 
	gWÜld
::

66 
	$g‘_mob_´ÙÙy³
(cÚ¡ 
Vnum
& 
vnum
)

68 
A»a
 *
¬—
 = 
	`g‘_¬—
(
vnum
);

69 
MobePrÙÙy³
 *
´Ùo
 = 
nuÎ±r
;

71 ià(
¬—
 !ğ
nuÎ±r
)

72 
´Ùo
 = 
¬—
->
	`g‘_mob_´ÙÙy³
(
vnum
);

74 ià(
´Ùo
 =ğ
nuÎ±r
 && 
Game
::
boÙšg
) {

75 
Loggšg
::
	`bugf
("G‘_mob_šdex: bad vnum %d.", 
vnum
);

78  
´Ùo
;

79 
	}
}

81 
ObjeùPrÙÙy³
 * 
	gWÜld
::

82 
	$g‘_obj_´ÙÙy³
(cÚ¡ 
Vnum
& 
vnum
)

84 
A»a
 *
¬—
 = 
	`g‘_¬—
(
vnum
);

85 
ObjeùPrÙÙy³
 *
´Ùo
 = 
nuÎ±r
;

87 ià(
¬—
 !ğ
nuÎ±r
)

88 
´Ùo
 = 
¬—
->
	`g‘_obj_´ÙÙy³
(
vnum
);

90 ià(
´Ùo
 =ğ
nuÎ±r
 && 
Game
::
boÙšg
) {

91 
Loggšg
::
	`bugf
("G‘_obj_šdex: bad vnum %d.", 
vnum
);

94  
´Ùo
;

95 
	}
}

97 
RoomPrÙÙy³
 * 
	gWÜld
::

98 
	$g‘_room_´ÙÙy³
(cÚ¡ 
Vnum
& 
vnum
) {

99 
A»a
 *
¬—
 = 
	`g‘_¬—
(
vnum
);

100 
RoomPrÙÙy³
 *
´Ùo
 = 
nuÎ±r
;

102 ià(
¬—
 !ğ
nuÎ±r
)

103 
´Ùo
 = 
¬—
->
	`g‘_room_´ÙÙy³
(
vnum
);

105 ià(
´Ùo
 =ğ
nuÎ±r
 && 
Game
::
boÙšg
) {

106 
Loggšg
::
	`bugf
("Game::wÜld().g‘_room_´ÙÙy³: bad vnum %d.", 
vnum
);

109  
´Ùo
;

110 
	}
}

112 
Room
 * 
	gWÜld
::

113 
	$g‘_room
(cÚ¡ 
LoÿtiÚ
& 
loÿtiÚ
)

115 ià(
loÿtiÚ
.
coÜd
.
	`is_v®id
())

116  
m­Œ“
.
	`g‘
(
loÿtiÚ
.
coÜd
);

118 ià(!
loÿtiÚ
.
room_id
.
	`is_v®id
())

119  
nuÎ±r
;

123 auto& 
·œ
 : 
¬—s
) {

124 
Room
 *
room
 = 
·œ
.
£cÚd
->
	`g‘_room
(
loÿtiÚ
.
room_id
);

126 ià(
room
 !ğ
nuÎ±r
)

127  
room
;

130  
nuÎ±r
;

131 
	}
}

133 
	gWÜld
::

134 
g‘_mšim­
(
Ch¬aù”
 *
ch
, 
¡d
::
veùÜ
<
SŒšg
>& 
vec
) const {

135 cÚ¡ 
m­_width
 = 30;

136 cÚ¡ 
	gm­_height
 = 22;

138 ià(!
	gch
->
	gš_room
->
is_Ú_m­
())

141 
	gwÜldm­
::
CoÜdš©e
 
¡¬t_coÜd
 = 
ch
->
š_room
->
loÿtiÚ
.
coÜd
;

144 
	gy
 = 
¡¬t_coÜd
.
y
 - 
m­_height
/2; y < ()(
	g¡¬t_coÜd
.y + 
	gm­_height
/2); y++) {

145 
SŒšg
 
	gbuf
;

148 
	gx
 = 
¡¬t_coÜd
.
x
 - 
m­_width
/2; x < ()(
	g¡¬t_coÜd
.x + 
	gm­_width
/2); x++) {

150 ià(
	gx
 < 0 || ()x >ğ
ov”wÜld
.
width
()

151 || 
y
 < 0 || ()y >ğ
ov”wÜld
.
height
()) {

152 
buf
 += ' ';

156 
	gwÜldm­
::
CoÜdš©e
 
this_coÜd
(
x
, 
y
);

158 ià(
	gthis_coÜd
 =ğ
¡¬t_coÜd
) {

159 
buf
 += "{PX";

163 cÚ¡ 
Room
 *
	groom
 = 
m­Œ“
.
g‘
(
this_coÜd
);

164 
Ch¬aù”
 *
	g’emy
 = 
nuÎ±r
;

166 ià(
	groom
 !ğ
nuÎ±r
) {

167 
’emy
 = 
room
->
³İË
; 
	g’emy
;ƒÃmy =ƒÃmy->
Ãxt_š_room
)

168 ià(
ÿn_£e_ch¬
(
ch
, 
’emy
))

172 ià(
	g’emy
 =ğ
nuÎ±r
) {

173 
SeùÜ
 
‹¼aš
 = 
ov”wÜld
.
g‘_£ùÜ
(
this_coÜd
);

175 
	g‹¼aš
) {

176 
	gSeùÜ
::
fÜe¡_¥¬£
:

177 
SeùÜ
::
f›ld
: 
buf
 += "{G."; ;

179 
	gSeùÜ
::
fÜe¡_medium
: 
buf
 += "{GI"; ;

180 
	gSeùÜ
::
fÜe¡_d’£
: 
buf
 += "{HI"; ;

181 
	gSeùÜ
::
rßd
: 
buf
 += "{b%"; ;

182 
	gSeùÜ
::
¬—_’Œªû
: 
buf
 += "{Y#"; ;

183 
	gSeùÜ
::
c™y
: 
buf
 += "{gM"; ;

184 : 
buf
 += " "; ;

188 ià(
	g’emy
->
is_Åc
())

189 
	gbuf
 += "{R+";

191 
	gbuf
 += "{CP";

195 
	gbuf
 += "{x";

196 
	gvec
.
push_back
(
buf
);

200 
	gWÜld
::

201 
	$lßd_¬—s
() {

203 
FILE
 *
åLi¡
 = 
	`fİ’
(
AREA_LIST
, "r");

205 ià(
åLi¡
 =ğ
nuÎ±r
) {

206 
	`³¼Ü
(
AREA_LIST
);

207 
	`ex™
(1);

211 
SŒšg
 
fe_Çme
 = 
	`ä—d_wÜd
(
åLi¡
);

213 ià(
fe_Çme
[0] == '$')

216 ià(
fe_Çme
[0] == '#')

219 
A»a
 *
¬—
 = 
Ãw
 
	`A»a
(*
this
, 
fe_Çme
);

220 
¬—s
.
	`em¶aû
(
	`VnumRªge
(
¬—
->
mš_vnum
,‡»a->
max_vnum
),‡rea);

222 
¬—
->
	`lßd
();

225 
	`fşo£
(
åLi¡
);

226 
	}
}

233 
	gWÜld
::

234 
	$ü—‹_rooms
() {

235 auto& 
·œ
 : 
¬—s
) {

236 
·œ
.
£cÚd
->
	`ü—‹_rooms
();

238 
	}
}

245 
	gWÜld
::

246 
	$ü—‹_ex™s
()

248 cÚ¡‡uto& 
¬—_·œ
 : 
¬—s
) {

249 cÚ¡‡uto& 
·œ
 : 
¬—_·œ
.
£cÚd
->
rooms
) {

250 cÚ¡‡uto& 
loÿtiÚ
 = 
·œ
.
fœ¡
;

251 
Room
* 
room
 = 
·œ
.
£cÚd
;

253 
boŞ
 
found_ex™
 = 
çl£
;

255 
doÜ
 = 0; door <= 5; door++) {

256 ià(
room
->
´ÙÙy³
.
ex™
[
doÜ
] =ğ
nuÎ±r
)

259 ià(
room
->
	`is_Ú_m­
(è&&„oom->
´ÙÙy³
.
ex™
[
doÜ
]->
to_vnum
 == 0) {

261 
wÜldm­
::
CoÜdš©e
 
äom
 = 
room
->
loÿtiÚ
.
coÜd
;

262 
to_x
, 
to_y
;

264 
doÜ
) {

265 0: 
to_x
 = 
äom
.
x
; 
to_y
 = from.
y
-1; ;

266 1: 
to_x
 = 
äom
.
x
+1; 
to_y
 = from.
y
; ;

267 2: 
to_x
 = 
äom
.
x
; 
to_y
 = from.
y
+1; ;

268 3: 
to_x
 = 
äom
.
x
-1; 
to_y
 = from.
y
; ;

270 
Loggšg
::
	`bugf
("fix_exits:„oom‡t %s has bad‡uto-exit in direction %d",

271 
loÿtiÚ
.
	`to_¡ršg
(), 
doÜ
);

275 
Room
 *
de¡
 = 
¬—_·œ
.
£cÚd
->
wÜld
.
m­Œ“
.
	`g‘
(
wÜldm­
::
	`CoÜdš©e
(
to_x
, 
to_y
));

277 ià(
de¡
 =ğ
nuÎ±r
) {

281 
Game
::
boÙšg
 = 
çl£
;

282 
room
->
ex™
[
doÜ
] = 
Ãw
 
	`Ex™
(*room->
´ÙÙy³
.ex™[doÜ], 
de¡
);

283 
Game
::
boÙšg
 = 
Œue
;

284 
found_ex™
 = 
Œue
;

288 
Room
 *
de¡
 = 
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
room
->
´ÙÙy³
.
ex™
[
doÜ
]->
to_vnum
)));

289 
room
->
ex™
[
doÜ
] = 
Ãw
 
	`Ex™
(*room->
´ÙÙy³
.ex™[doÜ], 
de¡
);

291 ià(
room
->
ex™
[
doÜ
]->
to_room
 =ğ
nuÎ±r
) {

292 
d–‘e
 
room
->
ex™
[
doÜ
]->
to_room
;

293 
room
->
ex™
[
doÜ
] = 
nuÎ±r
;

294 
Loggšg
::
	`bugf
("fix_exits:„oom‡t %s has unknownƒxit vnum %d.",

295 
loÿtiÚ
.
	`to_¡ršg
(), 
room
->
´ÙÙy³
.
ex™
[
doÜ
]->
to_vnum
);

298 ià(
room
->
ex™
[
doÜ
])

299 
found_ex™
 = 
Œue
;

302 ià(!
found_ex™
)

303 
room
->
room_æags
 +ğ
ROOM_NO_MOB
;

306 
	}
}

	@src/act.cc

1 
	~"¬gum’t.hh
"

2 
	~"A»a.hh
"

3 
	~"Ch¬aù”.hh
"

4 
	~"Du–.hh
"

5 
	~"Loggšg.hh
"

6 
	~"MobProg.hh
"

7 
	~"Objeù.hh
"

8 
	~"Room.hh
"

9 
	~"SŒšg.hh
"

10 
	~"Ta.hh
"

11 
	~"RoomPrÙÙy³.hh
"

12 
	~"Game.hh
"

14 
	$aù_bug
(cÚ¡ 
SŒšg
& 
v¬
, 
Ë‰”
, cÚ¡ SŒšg 
fmt
) {

16 
Loggšg
::
	`bugf
("Missing %s for '$$%c' in format string '%s'",

17 
v¬
, 
Ë‰”
, 
fmt
.
	`»¶aû
("$", "$$"));

18 
	}
}

21 
	$aù_fÜm©
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
,

22 cÚ¡ 
Ch¬aù”
 *
vch1
, cÚ¡ Ch¬aù” *
vch2
,

23 cÚ¡ 
SŒšg
 *
¡r1
, cÚ¡ SŒšg *
¡r2
,

24 cÚ¡ 
Objeù
 *
obj1
, cÚ¡ Objeù *
obj2
,

25 
Ch¬aù”
 *
ob£rv”
, 
boŞ
 
¢oİ”
, 
vis
)

27 *cÚ¡ 
he_she
 [] = { "it", "he", "she" };

28 *cÚ¡ 
him_h”
 [] = { "it", "him", "her" };

29 *cÚ¡ 
his_h”
 [] = { "its", "his", "her" };

31 
SŒšg
 
buf
, 
i
;

33 ià(
¢oİ”
) {

34 
buf
 += "{n[T] ";

37 autØ
¡r
 = 
fÜm©
.
	`cbegš
();

39 
¡r
 !ğ
fÜm©
.
	`ûnd
()) {

40 ià(*
¡r
 != '$') {

41 
buf
 +ğ*
¡r
++;

46 ++
¡r
;

47 
i
 = 
FÜm©
::
	`fÜm©
("$%c", *
¡r
);

49 *
¡r
) {

55 ià(
aùÜ
 =ğ
nuÎ±r
)

56 
	`aù_bug
("aùÜ", *
¡r
, 
fÜm©
);

58 
i
 = 
	`PERS
(
aùÜ
, 
ob£rv”
, 
vis
);

63 ià(
aùÜ
 =ğ
nuÎ±r
)

64 
	`aù_bug
("aùÜ", *
¡r
, 
fÜm©
);

66 
i
 = 
he_she
[
	`GET_ATTR_SEX
(
aùÜ
)];

71 ià(
aùÜ
 =ğ
nuÎ±r
)

72 
	`aù_bug
("aùÜ", *
¡r
, 
fÜm©
);

74 
i
 = 
him_h”
[
	`GET_ATTR_SEX
(
aùÜ
)];

79 ià(
aùÜ
 =ğ
nuÎ±r
)

80 
	`aù_bug
("aùÜ", *
¡r
, 
fÜm©
);

82 
i
 = 
his_h”
[
	`GET_ATTR_SEX
(
aùÜ
)];

89 ià(
vch1
 =ğ
nuÎ±r
)

90 
	`aù_bug
("vch1", *
¡r
, 
fÜm©
);

92 
i
 = 
	`PERS
(
vch1
, 
ob£rv”
, 
vis
);

97 ià(
vch1
 =ğ
nuÎ±r
)

98 
	`aù_bug
("vch1", *
¡r
, 
fÜm©
);

100 
i
 = 
he_she
[
	`GET_ATTR_SEX
(
vch1
)];

105 ià(
vch1
 =ğ
nuÎ±r
)

106 
	`aù_bug
("vch1", *
¡r
, 
fÜm©
);

108 
i
 = 
him_h”
[
	`GET_ATTR_SEX
(
vch1
)];

113 ià(
vch1
 =ğ
nuÎ±r
)

114 
	`aù_bug
("vch1", *
¡r
, 
fÜm©
);

116 
i
 = 
his_h”
[
	`GET_ATTR_SEX
(
vch1
)];

123 ià(
obj1
 =ğ
nuÎ±r
)

124 
	`aù_bug
("obj1", *
¡r
, 
fÜm©
);

125 ià(
	`ÿn_£e_obj
(
ob£rv”
, 
obj1
))

126 
i
 = 
obj1
->
shÜt_desü
;

128 
i
 = "something";

133 ià(
obj2
 =ğ
nuÎ±r
)

134 
	`aù_bug
("obj2", *
¡r
, 
fÜm©
);

135 ià(
	`ÿn_£e_obj
(
ob£rv”
, 
obj2
))

136 
i
 = 
obj2
->
shÜt_desü
;

138 
i
 = "something";

145 ià(
¡r2
 =ğ
nuÎ±r
) {

146 
	`aù_bug
("¡r2", *
¡r
, 
fÜm©
);

147 
i
 = "door";

150 
i
 = *
¡r2
;

157 ià(
¡r1
 =ğ
nuÎ±r
)

158 
	`aù_bug
("¡r1", *
¡r
, 
fÜm©
);

160 
i
 = *
¡r1
;

165 ià(
¡r2
 =ğ
nuÎ±r
)

166 
	`aù_bug
("¡r2", *
¡r
, 
fÜm©
);

168 
i
 = *
¡r2
;

174 'G': 
i
 = "\007"; ;

176 '$': 
i
 = "$"; ;

179 ++
¡r
;

180 
buf
 +ğ
i
;

183 ià(
¢oİ”
)

184 
buf
 += "{x";

186 
buf
 += '\n';

187 
buf
[0] = 
	`touµ”
(buf[0]);

189 ià(
ob£rv”
->
desc
)

190 
	`¡c
(
buf
, 
ob£rv”
);

192 ià(
MOBŒigg”
)

196 
	`m´og_aù_Œigg”
(
buf
.
	`c_¡r
(), 
ob£rv”
, 
aùÜ
,

197 
cÚ¡_ÿ¡
<
Objeù
 *>(
obj1
),

198 
cÚ¡_ÿ¡
<
Ch¬aù”
 *>(
vch1
));

199 
	}
}

201 
	$aù_·r£
(

202 
SŒšg
 
fÜm©
,

203 
Ch¬aù”
 *
aùÜ
,

204 
Room
 *
room
,

205 cÚ¡ 
Ch¬aù”
 *
vch1
, cÚ¡ Ch¬aù” *
vch2
,

206 cÚ¡ 
SŒšg
 *
¡r1
, cÚ¡ SŒšg *
¡r2
,

207 cÚ¡ 
Objeù
 *
obj1
, cÚ¡ Objeù *
obj2
,

208 
ty³
,

209 
mš_pos
,

210 
boŞ
 
ûnsÜ


213 ià(
fÜm©
.
	`em±y
())

216 
boŞ
 
SNEAKING
 = 
çl£
;

217 
vis
 = 
VIS_CHAR
;

221 ià(
ty³
 =ğ
TO_VICT_CHANNEL
) {

222 
ty³
 = 
TO_VICT
;

223 
vis
 = 
VIS_PLR
;

226 ià(
mš_pos
 =ğ
POS_SNEAK
) {

227 
mš_pos
 = 
POS_RESTING
;

228 
SNEAKING
 = 
Œue
;

232 ià(
room
 =ğ
nuÎ±r
) {

234 ià(
aùÜ
 !ğ
nuÎ±r
)

235 
room
 = 
aùÜ
->
š_room
;

236 ià(
obj1
 !ğ
nuÎ±r
)

237 
room
 = 
obj1
->
š_room
;

240 ià(
ty³
 =ğ
TO_VICT
) {

241 ià(
vch1
 =ğ
nuÎ±r
) {

242 
Loggšg
::
	`bugf
("Aù:‚uÎ vch1 w™h TO_VICT iÀfÜm© sŒšg '%s'", 
fÜm©
.
	`»¶aû
("$", "$$"));

246 ià(
vch1
->
š_room
 =ğ
nuÎ±r
)

249 
room
 = 
vch1
->
š_room
;

252 ià(
ty³
 =ğ
TO_WORLD
) {

253 ià(
vch2
 =ğ
nuÎ±r
) {

254 
Loggšg
::
	`bugf
("Aù:‚uÎ vch2 w™h TO_WORLD iÀfÜm© sŒšg '%s'", 
fÜm©
.
	`»¶aû
("$", "$$"));

258 ià(
vch2
->
š_room
 =ğ
nuÎ±r
 && 
aùÜ
 &&‡ùÜ->

 ==‚ullptr)

261 
room
 = 
vch2
->
š_room
;

265 ià(
room
 =ğ
nuÎ±r
)

269 
Ch¬aù”
 *
ob£rv”
 = 
room
->
³İË
; ob£rv” !ğ
nuÎ±r
; ob£rv” = ob£rv”->
Ãxt_š_room
) {

270 ià(
ûnsÜ
 && 
ob£rv”
->
	`is_Åc
())

273 ià(
	`g‘_pos™iÚ
(
ob£rv”
è< 
mš_pos
)

276 ià(
SNEAKING
) {

277 ià(!
	`IS_IMMORTAL
(
ob£rv”
))

280 ià(
aùÜ
 &&‡ùÜ->
aù_æags
.
	`has
(
PLR_SUPERWIZ
è&& !
	`IS_IMP
(
ob£rv”
))

285 ià(
ty³
 =ğ
TO_CHAR
 && 
ob£rv”
 !ğ
aùÜ
)

288 ià(
ty³
 =ğ
TO_VICT
 && (
ob£rv”
 !ğ
vch1
 || ob£rv” =ğ
aùÜ
))

291 ià(
ty³
 =ğ
TO_ROOM
 && 
ob£rv”
 =ğ
aùÜ
)

294 ià(
ty³
 =ğ
TO_NOTVICT
 && (
ob£rv”
 =ğ
aùÜ
 || ob£rv” =ğ
vch1
))

297 ià(
ty³
 =ğ
TO_WORLD
 && (
ob£rv”
 =ğ
aùÜ
 || ob£rv” =ğ
vch1
 || ob£rv” !ğ
vch2
))

300 ià(
ty³
 =ğ
TO_NOTVIEW
 && 
ob£rv”
 =ğ
aùÜ
)

303 ià(
ty³
 =ğ
TO_VIEW
)

307 
	`aù_fÜm©
(
fÜm©
, 
aùÜ
, 
vch1
, 
vch2
, 
¡r1
, 
¡r2
, 
obj1
, 
obj2
, 
ob£rv”
, 
çl£
, 
vis
);

312 ià(!
ûnsÜ
 && (
ty³
 =ğ
TO_ROOM
 ||y³ =ğ
TO_NOTVICT
 ||y³ =ğ
TO_VIEW
)) {

313 
Du–
::
A»Ç
 *
¬’a
 = 
¬’a_bË_h—d
->
Ãxt
;

315 
¬’a
 !ğ
¬’a_bË_
) {

316 ià(
room
->
´ÙÙy³
.
vnum
 >ğ
¬’a
->
mšvnum


317 && 
room
->
´ÙÙy³
.
vnum
 <ğ
¬’a
->
maxvnum
)

320 
¬’a
 =‡»Ç->
Ãxt
;

323 ià(
¬’a
 !ğ
¬’a_bË_
 &&‡»Ç->
v›wroom
->
³İË
 !ğ
nuÎ±r
) {

324 
Ch¬aù”
 *
ob£rv”
 = 
¬’a
->
v›wroom
->
³İË
; ob£rv” !ğ
nuÎ±r
; ob£rv” = ob£rv”->
Ãxt_š_room
) {

325 ià(
	`g‘_pos™iÚ
(
ob£rv”
è< 
mš_pos
)

329 
	`aù_fÜm©
("{Y[V]{x " + 
fÜm©
, 
aùÜ
, 
vch1
, 
vch2
, 
¡r1
, 
¡r2
, 
obj1
, 
obj2
, 
ob£rv”
, 
çl£
, 
vis
);

336 ià(
aùÜ
 =ğ
nuÎ±r
 ||‡ùÜ->

 ==‚ullptr)

339 ià(
ty³
 !ğ
TO_ROOM
 &&y³ !ğ
TO_NOTVICT
 &&y³ !ğ
TO_WORLD
 &&y³ !ğ
TO_NOTVIEW
)

342 ià(
fÜm©
.
	`has_´efix
("$n says '")

343 || 
fÜm©
.
	`has_´efix
("$n†eaves "))

346 ià(
fÜm©
.
	`has_´efix
("$n has‡rrived."))

347 
fÜm©
 = 
FÜm©
::
	`fÜm©
("$n has‡rrived‡t %s (%s).",

348 
aùÜ
->
š_room
->
	`Çme
(),‡ùÜ->š_room->
	`¬—
().
fe_Çme
);

351 
Ta
 *
td
 = 
aùÜ
->

;d; ) {

352 ià(
td
->
”_Çme
 !ğtd->
ed_by
->
Çme
) {

353 
	`£t_
(
td
->
ed_by
, 
aùÜ
, 
TAIL_NONE
);

354 
td
 = 
aùÜ
->

;

358 
td
 =d->
Ãxt
;

362 
Ta
 *
td
 = 
aùÜ
->

;d;d =d->
Ãxt
) {

363 
Ch¬aù”
 *
ob£rv”
 = 
nuÎ±r
;

365 
ob£rv”
 = 
aùÜ
->
š_room
->
³İË
; ob£rv”; ob£rv” = ob£rv”->
Ãxt_š_room
) {

366 ià(
ob£rv”
 =ğ
td
->
ed_by
)

370 ià(
ob£rv”
)

374 
	`aù_fÜm©
(
fÜm©
, 
aùÜ
, 
vch1
, 
vch2
, 
¡r1
, 
¡r2
, 
obj1
, 
obj2
,

375 
td
->
ed_by
, 
Œue
, 
vis
);

382 
MOBŒigg”
 = 
Œue
;

384 
	}
}

386 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, cÚ¡ 
AùabË
* 
¬g1
, cÚ¡ AùabË* 
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

387 
	`aù_·r£
(

388 
fÜm©
, 
aùÜ
, 
room
,

389 (cÚ¡ 
Ch¬aù”
 *)
¬g2
,

390 (cÚ¡ 
Ch¬aù”
 *)
¬g1
,

391 (cÚ¡ 
SŒšg
 *)
¬g1
,

392 (cÚ¡ 
SŒšg
 *)
¬g2
,

393 (cÚ¡ 
Objeù
 *)
¬g1
,

394 (cÚ¡ 
Objeù
 *)
¬g2
,

395 
ty³
, 
mš_pos
, 
ûnsÜ


397 
	}
}

400 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, cÚ¡ 
AùabË
* 
¬g1
, cÚ¡ AùabË& 
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

401 
	`aù
(
fÜm©
, 
aùÜ
, 
¬g1
, &
¬g2
, 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

402 
	}
}

405 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, cÚ¡ 
AùabË
& 
¬g1
, cÚ¡ AùabË* 
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

406 
	`aù
(
fÜm©
, 
aùÜ
, &
¬g1
, 
¬g2
, 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

407 
	}
}

410 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, cÚ¡ 
AùabË
& 
¬g1
, cÚ¡ AùabË& 
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

411 
	`aù
(
fÜm©
, 
aùÜ
, &
¬g1
, &
¬g2
, 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

412 
	}
}

419 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, cÚ¡ 
AùabË
* 
¬g1
, cÚ¡ *
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

420 
	`aù
(
fÜm©
, 
aùÜ
, 
¬g1
, 
	`SŒšg
(
¬g2
), 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

421 
	}
}

424 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, cÚ¡ 
AùabË
* 
¬g1
, 
¡d
::
nuÎ±r_t
 
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

425 
	`aù
(
fÜm©
, 
aùÜ
, 
¬g1
, 
	`SŒšg
(), 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

426 
	}
}

429 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, cÚ¡ *
¬g1
, cÚ¡ 
AùabË
* 
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

430 
	`aù
(
fÜm©
, 
aùÜ
, 
	`SŒšg
(
¬g1
), 
¬g2
, 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

431 
	}
}

434 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, 
¡d
::
nuÎ±r_t
 
¬g1
, cÚ¡ 
AùabË
* 
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

435 
	`aù
(
fÜm©
, 
aùÜ
, 
	`SŒšg
(), 
¬g2
, 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

436 
	}
}

443 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, cÚ¡ 
AùabË
& 
¬g1
, cÚ¡ *
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

444 
	`aù
(
fÜm©
, 
aùÜ
, &
¬g1
, 
	`SŒšg
(
¬g2
), 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

445 
	}
}

448 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, cÚ¡ 
AùabË
& 
¬g1
, 
¡d
::
nuÎ±r_t
 
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

449 
	`aù
(
fÜm©
, 
aùÜ
, &
¬g1
, 
	`SŒšg
(), 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

450 
	}
}

453 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, cÚ¡ *
¬g1
, cÚ¡ 
AùabË
& 
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

454 
	`aù
(
fÜm©
, 
aùÜ
, 
	`SŒšg
(
¬g1
), &
¬g2
, 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

455 
	}
}

458 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, 
¡d
::
nuÎ±r_t
 
¬g1
, cÚ¡ 
AùabË
& 
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

459 
	`aù
(
fÜm©
, 
aùÜ
, 
	`SŒšg
(), &
¬g2
, 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

460 
	}
}

467 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, cÚ¡ *
¬g1
, cÚ¡ *
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

468 
	`aù
(
fÜm©
, 
aùÜ
, 
	`SŒšg
(
¬g1
), SŒšg(
¬g2
), 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

469 
	}
}

472 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, cÚ¡ *
¬g1
, 
¡d
::
nuÎ±r_t
 
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

473 
	`aù
(
fÜm©
, 
aùÜ
, 
	`SŒšg
(
¬g1
), SŒšg(), 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

474 
	}
}

477 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, 
¡d
::
nuÎ±r_t
 
¬g1
, cÚ¡ *
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

478 
	`aù
(
fÜm©
, 
aùÜ
, 
	`SŒšg
(), SŒšg(
¬g2
), 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

479 
	}
}

482 
	$aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
aùÜ
, 
¡d
::
nuÎ±r_t
 
¬g1
, std::nuÎ±r_ˆ
¬g2
, 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
, 
Room
 *
room
) {

483 
	`aù
(
fÜm©
, 
aùÜ
, 
	`SŒšg
(), SŒšg(), 
ty³
, 
mš_pos
, 
ûnsÜ
, 
room
);

484 
	}
}

	@src/act_comm.cc

27 
	~<uni¡d.h
>

28 
	~<veùÜ
>

30 
	~"aù.hh
"

31 
	~"¬gum’t.hh
"

32 
	~"afãù/Afãù.hh
"

33 
	~"AuùiÚ.hh
"

34 
	~"chªÃls.hh
"

35 
	~"Ch¬aù”.hh
"

36 
	~"DesütÜ.hh
"

37 
	~"fe.hh
"

38 
	~"fšd.hh
"

39 
	~"Game.hh
"

40 
	~"š‹½.hh
"

41 
	~"lookup.hh
"

42 
	~"Loggšg.hh
"

43 
	~"m”c.hh
"

44 
	~"Objeù.hh
"

45 
	~"¿ndom.hh
"

46 
	~"Room.hh
"

47 
	~"SŒšg.hh
"

48 
	~"vt100.hh
"

49 
	~"comm.hh
"

50 
	~"WÜld.hh
"

56 
	sÃw_po£_¡ruù
 {

57 
SŒšg
 
	m£lf_msg
;

58 
SŒšg
 
	mroom_msg
;

61 
	g¡d
::
veùÜ
<
Ãw_po£_¡ruù
> 
mage_po£s
 = {

107 
	g¡d
::
veùÜ
<
Ãw_po£_¡ruù
> 
ş”ic_po£s
 = {

152 
	g¡d
::
veùÜ
<
Ãw_po£_¡ruù
> 
th›f_po£s
 = {

194 
	g¡d
::
veùÜ
<
Ãw_po£_¡ruù
> 
w¬riÜ_po£s
 = {

239 
	g¡d
::
veùÜ
<
Ãw_po£_¡ruù
> 
Ãüomªûr_po£s
 = {

284 
	g¡d
::
veùÜ
<
Ãw_po£_¡ruù
> 
·Ïdš_po£s
 = {

329 
	g¡d
::
veùÜ
<
Ãw_po£_¡ruù
> 
b¬d_po£s
 = {

374 
	g¡d
::
veùÜ
<
Ãw_po£_¡ruù
> 
¿ng”_po£s
 = {

420 
	g¡d
::
veùÜ
<
¡d
::veùÜ<
Ãw_po£_¡ruù
> > 
Ãw_po£_bË
 = {

421 
mage_po£s
,

422 
ş”ic_po£s
,

423 
th›f_po£s
,

424 
w¬riÜ_po£s
,

425 
Ãüomªûr_po£s
,

426 
·Ïdš_po£s
,

427 
b¬d_po£s
,

428 
¿ng”_po£s
,

433 
	$£Ëù_po£
(
Ch¬aù”
 *
ch
)

435 
Ëv–
;

436 
maxpo£
;

437 
po£
;

439 ià(
ch
->
	`is_Åc
()) {

440 
	`¡c
("SÜry, mobe ÿn'ˆpo£!\n", 
ch
);

444 ià(
ch
->
gud
 =ğ
Gud
::
nÚe
) {

445 
	`¡c
("You dÚ'ˆã– cÚfid’ˆ’ough iÀyou¸skl tØpo£.\n", 
ch
);

449 
maxpo£
 = 
Ãw_po£_bË
[
ch
->
gud
].
	`size
();

451 ià(
maxpo£
 <= 0) {

452 
	`¡c
("NØpo£ im¶em’‹d fÜ you¸şass, sÜry!\n", 
ch
);

456 
Ëv–
 = 
ch
->level;

457 
maxpo£
 = (
Ëv–
 * maxpo£ + 
MAX_LEVEL
 - 1) / MAX_LEVEL;

458 
po£
 = 
	`numb”_¿nge
(0, 
maxpo£
 - 1);

459  
po£
;

460 
	}
}

462 
	$do_po£
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

464 
po£
;

465 
po£
 = 
	`£Ëù_po£
(
ch
);

467 ià(
po£
 == -1)

470 
	`aù
(
Ãw_po£_bË
[
ch
->
gud
][
po£
].
£lf_msg
, ch, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

471 
	`aù
(
Ãw_po£_bË
[
ch
->
gud
][
po£
].
room_msg
, ch, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

473 
	}
}

476 
	$do_‹¡po£
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

478 ià(
¬gum’t
.
	`em±y
()) {

479 
	`¡c
("SyÁax:e¡po£ [şas [numb”]]\n", 
ch
);

483 
SŒšg
 
¬g
;

484 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

485 
Gud
 
gud
 = 
	`gud_lookup
(
¬g
);

487 ià(
gud
 =ğ
Gud
::
nÚe
) {

488 
	`¡c
("Th©' nÙ‡ v®id cÏss\n", 
ch
);

492 ià(
¬gum’t
.
	`em±y
()) {

493 
FÜm©
::
	`¥rštf
(
¬g
, "%d…oses defined for class '%s'\n",

494 
Ãw_po£_bË
[
gud
].
	`size
(), 
gud_bË
[gud].
Çme
);

495 
	`¡c
(
¬g
, 
ch
);

499 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

501 ià(!
¬g
.
	`is_numb”
()) {

502 
	`¡c
("Po£‚umb” mu¡ bnum”ic!\n", 
ch
);

506 
po£
 = 
	`©oi
(
¬g
);

508 ià(
po£
 < 1 ||…o£ > 
Ãw_po£_bË
[
gud
].
	`size
()) {

509 
	`¡c
("Po£‚umb” ouˆoà¿nge!\n", 
ch
);

513 
po£
--;

514 
	`¡c
("{YtØ{Cyour£lf{x:\n", 
ch
);

515 
	`aù
(
Ãw_po£_bË
[
gud
][
po£
].
£lf_msg
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

516 
	`¡c
("{YtØ{CÙh”s{x:\n", 
ch
);

517 
	`aù
(
Ãw_po£_bË
[
gud
][
po£
].
room_msg
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

518 
	}
}

521 
	$do_d–‘
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

523 
	`¡c
("You mu¡y³hfuÎ commªdØd–‘your£lf.\n", 
ch
);

524 
	}
}

526 
	$do_d–‘e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

528 
DesütÜ
 *
d
, *
d_Ãxt
;

529 
id
;

530 
¡r§ve
[
MAX_INPUT_LENGTH
];

531 
boŞ
 
impÜÁ
 = 
Œue
;

533 ià(
ch
->
	`is_Åc
()) {

534 
	`¡c
("You'»‚Ù g‘tšg ouˆoàh”th©ƒasy!\n", 
ch
);

538 ià(
	`g‘_du–
(
ch
)) {

539 
	`¡c
("You‡» invŞved iÀ¨du–, d—Èw™h iˆfœ¡.\n", 
ch
);

543 
ch
->
pcd©a
->
cÚfœm_d–‘e
) {

545 ià(!
¬gum’t
.
	`em±y
()) {

546 
	`¡c
("Ju¡y³ DELETE. NØ¬gum’t.\n", 
ch
);

550 
	`wizÃt
("$N i cÚ‹m¶©šg d–‘iÚ.", 
ch
, 
nuÎ±r
, 0, 0, 
	`GET_RANK
(ch));

551 
	`±c
(
ch
, "{RTy³ {PDELETE{R‡gaš iàyou„—Îy wªˆtØd–‘'%s{R';\n{x", ch->
Çme
);

552 
	`¡c
("{Rty³ {PDELETE NO{RØÿnûÈthi commªd.{x\n", 
ch
);

553 
ch
->
pcd©a
->
cÚfœm_d–‘e
 = 1;

557 ià(!
¬gum’t
.
	`em±y
()) {

558 
	`¡c
("D–‘¡©u »moved.\n", 
ch
);

559 
ch
->
pcd©a
->
cÚfœm_d–‘e
 = 0;

563 ià(
ch
->
pcd©a
->
»mÜt_couÁ
 > 0)

564 
	`±c
(
ch
, "Thi i ¨%dx„emÜˆch¬aù”.\n", ch->
pcd©a
->
»mÜt_couÁ
);

565 ià(
	`g‘_¶ay_hours
(
ch
) >= 100)

566 
	`±c
(
ch
, "You have…layedhis character for‡pproximately %d hours.\n",

567 
	`g‘_¶ay_hours
(
ch
));

568 ià(
ch
->
Ëv–
 >= 30)

569 
	`±c
(
ch
, "Thi i ¨Ëv– %d ch¬aù”.\n", ch->
Ëv–
);

571 
impÜÁ
 = 
çl£
;

573 ià(
impÜÁ
) {

574 
	`¡c
("You could stÈd–ay you¸decisiÚ, {RQUIT{x‡ndhšk iˆov”.\n", 
ch
);

575 
	`¡c
("Baw¬th©hi decisiÚ i {RFINAL{x;\nWwÈ{RNOT{x„esu¼eù you.\n", 
ch
);

578 
	`±c
(
ch
, "{RType {PDELETE{R one†astime if you„eally,„eally wanto delete '%s{R';{x",

579 
ch
->
Çme
);

580 
	`¡c
("{Rty³ {PDELETE NO{RØÿnûÈthi commªd.{x\n", 
ch
);

581 
ch
->
pcd©a
->
cÚfœm_d–‘e
 = 2;

585 ià(!
¬gum’t
.
	`em±y
()) {

586 
	`¡c
("D–‘¡©u »moved.\n", 
ch
);

587 
ch
->
pcd©a
->
cÚfœm_d–‘e
 = 0;

591 
FÜm©
::
	`¥rštf
(
¡r§ve
, "%s%s", 
PLAYER_DIR
, 
	`SŒšg
(
ch
->
Çme
).
	`low”ÿ£
().
	`ÿp™®ize
());

592 
	`wizÃt
("$N ha wed $M£làäomhe£„—lms.", 
ch
, 
nuÎ±r
, 0, 0, 0);

593 
	`upd©e_pc_šdex
(
ch
, 
Œue
);

594 
id
 = 
ch
->
pcd©a
->id;

595 
d
 = 
ch
->
desc
;

597 ià(
ch
->
pcd©a
 && ch->pcd©a->
video_æags
.
	`has
(
VIDEO_VT100
)) {

598 
	`ş—r_wšdow
(
ch
);

599 
	`»£t_‹rmš®
(
ch
);

602 
	`exŒaù_ch¬
(
ch
, 
Œue
);

604 ià(
d
 !ğ
nuÎ±r
)

605 
	`şo£_sock‘
(
d
);

608 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = 
d_Ãxt
) {

609 
Ch¬aù”
 *
tch
;

610 
d_Ãxt
 = 
d
->
Ãxt
;

611 
tch
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

613 ià(
tch
 &&ch->
pcd©a
 &&ch->pcd©a->
id
 == id) {

614 
	`exŒaù_ch¬
(
tch
, 
Œue
);

615 
	`şo£_sock‘
(
d
);

619 
	`uÆšk
(
¡r§ve
);

623 
	`¡c
("Forechnical„easons, you cannot delete yourself just‚ow.\n"

624 "PËa£–Èª Imm‡bouˆthis.\n", 
ch
);

625 
Loggšg
::
	`bug
("do_d–‘e: bad cÚfœm_d–‘e: %d ", 
ch
->
pcd©a
->
cÚfœm_d–‘e
);

628 
	}
}

631 
	$do_ş—r
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

633 
	`¡c
("\033[2J", 
ch
);

634 
	}
}

637 
	$do_Ãwb›k™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

639 
Objeù
 *
obj
;

640 
Objeù
 *
k™
;

641 
i
, 
k™vnum
 = 72;

643 ià(!
	`IS_IMMORTAL
(
ch
è&& !ch->
aù_æags
.
	`has
(
PLR_MAKEBAG
)) {

644 
	`do_huh
(
ch
);

648 
k™
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
k™vnum
), 0);

650 ià(! 
k™
) {

651 
Loggšg
::
	`bug
("Error creating kit in do_newbiekit.", 0);

652 
	`¡c
("You were unableo create‡‚ewbiekit.\n", 0);

657 
i
 = 73; i <= 83 ; i++) {

658 
obj
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
i
), 0);

660 ià(! 
obj
) {

661 
Loggšg
::
	`bug
("Error creating object in do_newbiekit.", 0);

665 
	`obj_to_obj
(
obj
, 
k™
);

668 
	`obj_to_ch¬
(
k™
, 
ch
);

669 
	`aù
("$Àha ü—‹d‡ $p!!!", 
ch
, 
k™
, 
nuÎ±r
, 
TO_ROOM
);

670 
	`aù
("You havü—‹d $p!! WooWoo!!!", 
ch
, 
k™
, 
nuÎ±r
, 
TO_CHAR
);

671 
	}
}

674 
	$do_ooc
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

676 ià(
ch
->
	`is_Åc
()) {

677 
	`¡c
("Mobe dÚ'ˆÿ»‡bouˆRP =).\n", 
ch
);

681 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_OOC
)) {

682 
	`¡c
("You‡»‚ØlÚg”„Ş¶ayšg.\n", 
ch
);

683 
ch
->
pcd©a
->
¶r_æags
 -ğ
PLR_OOC
;

684 
	`wizÃt
("$N i now iÀ*OOC* mode.", 
ch
, 
nuÎ±r
, 
WIZ_MISC
, 0, 0);

687 
	`¡c
("You sl iÁØch¬aù”.\n", 
ch
);

688 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_OOC
;

689 
	`wizÃt
("$N i now iÀ*RP* mode.", 
ch
, 
nuÎ±r
, 
WIZ_MISC
, 0, 0);

691 
	}
}

693 
	$do_pk
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

695 
Ch¬aù”
 *
wch
;

697 ià(
ch
->
	`is_Åc
()) {

698 
	`¡c
("Mobe dÚ'ˆÿ»‡bouˆPK =).\n", 
ch
);

702 ià(
ch
->
aù_æags
.
	`has
(
PLR_NOPK
)) {

703 
	`¡c
("You‡» stuck iÀPK mode! I hİnØÚi ŒyšgØkÈyou.\n", 
ch
);

707 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
è&& (
¬gum’t
.
	`em±y
(è|| !
	`IS_IMP
(ch)))

708 
	`¡c
("You¸PK fÏg i ®»ady up!\n", 
ch
);

709 ià(
¬gum’t
 == "on") {

710 
	`¡c
("Ev”yÚi gošgØbk“pšg‡ÀeyÚ you‚ow =).\n", 
ch
);

711 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_PK
;

712 
	`wizÃt
("$N i now iÀ*PK* mode.", 
ch
, 
nuÎ±r
, 
WIZ_MISC
, 0, 0);

714 ià(!
¬gum’t
.
	`em±y
(è&& 
	`IS_IMP
(
ch
)

715 && (
wch
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬gum’t
, 
VIS_PLR
)è!ğ
nuÎ±r
) {

716 ià(!
wch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
)) {

717 
	`¡c
("Th©…Ïy”' PK fÏg i ®»ady down.\n", 
ch
);

721 
wch
->
pcd©a
->
¶r_æags
 -ğ
PLR_PK
;

722 
	`wizÃt
("$N' PK fÏg ha b“Àlow”ed.", 
wch
, 
nuÎ±r
, 
WIZ_MISC
, 0, 0);

725 
	`¡c
("Once you„aise your PK flag it stays up until someone kills you!\n"

726 "Iàyou‡» su» you wªˆthis,y³ PK ON .\n", 
ch
);

728 
	}
}

731 
	$do_ch©mode
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

733 ià(
ch
->
	`is_Åc
())

736 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_CHATMODE
)) {

737 
	`¡c
("You havex™ed ch©mode.\n", 
ch
);

738 
ch
->
pcd©a
->
¶r_æags
 -ğ
PLR_CHATMODE
;

741 
	`¡c
("You wÈnØlÚg” s“ hung”/thœ¡ mes§ges.\n", 
ch
);

742 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_CHATMODE
;

744 
	}
}

747 
	$do_´iv©e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

749 ià(
ch
->
	`is_Åc
()) {

750 
	`¡c
("Mobe dÚ'ˆÿ»‡bouˆ´ivacy =).\n", 
ch
);

754 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PRIVATE
)) {

755 
	`¡c
("You¸room wÈnow di¥Ïy iÀshÜtwho.\n", 
ch
);

756 
ch
->
pcd©a
->
¶r_æags
 -ğ
PLR_PRIVATE
;

759 
	`¡c
("You¸room wÈnØlÚg” di¥Ïy iÀshÜtwho.\n", 
ch
);

760 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_PRIVATE
;

762 
	}
}

765 
	$do_showÏ¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

767 ià(
ch
->
	`is_Åc
()) {

768 
	`¡c
("Mobe dÚ'ˆÿ»‡bouˆtheœ showÏ¡ =).\n", 
ch
);

772 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_NOSHOWLAST
)) {

773 
ch
->
pcd©a
->
¶r_æags
 -ğ
PLR_NOSHOWLAST
;

774 
	`¡c
("You¸Ï¡imÚ wÈnow di¥Ïy iÀfšg”.\n", 
ch
);

777 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_NOSHOWLAST
;

778 
	`¡c
("You¸Ï¡imÚ wÈnØlÚg” di¥Ïy iÀfšg”.\n", 
ch
);

781 
	`do_§ve
(
ch
, "");

782 
	}
}

785 
	$do_autÜeÿÎ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

787 ià(
ch
->
aù_æags
.
	`has
(
PLR_WIMPY
)) {

788 
	`¡c
("You wÈnØlÚg”„eÿÎ iÀlšk-d—d comb©.\n", 
ch
);

789 
ch
->
aù_æags
 -ğ
PLR_WIMPY
;

792 
	`¡c
("You wÈnow„eÿÎ iÀlšk-d—d comb©.\n", 
ch
);

793 
ch
->
aù_æags
 +ğ
PLR_WIMPY
;

795 
	}
}

797 
	$do_autÙick
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

799 ià(
ch
->
aù_æags
.
	`has
(
PLR_TICKS
)) {

800 
	`¡c
("You wÈnØlÚg” s“icks.\n", 
ch
);

801 
ch
->
aù_æags
 -ğ
PLR_TICKS
;

804 
	`¡c
("You wÈnow s“icks.\n", 
ch
);

805 
ch
->
aù_æags
 +ğ
PLR_TICKS
;

807 
	}
}

810 
	$do_autİ“k
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

812 ià(
ch
->
	`is_Åc
()) ;

814 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
³ek
)) ;

816 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_AUTOPEEK
)) {

817 
	`¡c
("You wÈnØlÚg” PEEK‡utom©iÿÎy.\n", 
ch
);

818 
ch
->
pcd©a
->
¶r_æags
 -ğ
PLR_AUTOPEEK
;

821 
	`¡c
("You wÈnow PEEK‡utom©iÿÎy wh’ you LOOK.\n", 
ch
);

822 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_AUTOPEEK
;

824 
	}
}

827 
	$do_show¿ff
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

829 ià(
ch
->
	`is_Åc
()) {

830 
	`¡c
("Huh?\n", 
ch
);

834 ià(
ch
->
pcd©a
->
»mÜt_couÁ
 < 1) {

835 
	`¡c
("You havnÙ b“À»bÜÀy‘.\n", 
ch
);

839 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_SHOWRAFF
)) {

840 
	`¡c
("You¸»mÜˆafãù wÈnØlÚg” show iÀ'afãùs'.\n", 
ch
);

841 
ch
->
pcd©a
->
¶r_æags
 -ğ
PLR_SHOWRAFF
;

844 
	`¡c
("You¸»mÜˆafãù wÈnow show iÀ'afãùs'.\n", 
ch
);

845 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_SHOWRAFF
;

847 
	}
}

850 
	$do_d—f
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

852 ià(
ch
->
comm_æags
.
	`has
(
COMM_DEAF
)) {

853 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

854 
	`¡c
("You cª‚ow h—¸‹Î agaš.\n", 
ch
);

855 
ch
->
comm_æags
 -ğ
COMM_DEAF
;

856 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

859 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

860 
	`¡c
("From‚ow on, you wÚ'ˆh—¸‹Îs.\n", 
ch
);

861 
ch
->
comm_æags
 +ğ
COMM_DEAF
;

862 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

864 
	}
}

868 
	$do_qu›t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

870 ià(
ch
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

871 
	`¡c
("Qu›ˆmod»moved.\n", 
ch
);

872 
ch
->
comm_æags
 -ğ
COMM_QUIET
;

875 
	`¡c
("From‚ow on, you wÈÚly h—¸§y ªdƒmÙes.\n", 
ch
);

876 
ch
->
comm_æags
 +ğ
COMM_QUIET
;

878 
	}
}

882 
	$do_afk
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

884 *
¡¹ime
;

886 ià(
ch
->
comm_æags
.
	`has
(
COMM_AFK
)) {

887 
	`£t_cŞÜ
(
ch
, 
YELLOW
, 
NOBOLD
);

888 
	`¡c
("AFK mod»moved.\n", 
ch
);

890 ià(!
ch
->
	`is_Åc
())

891 ià(!
ch
->
pcd©a
->
bufãr
.
	`em±y
())

892 
	`¡c
("You havmes§ges: Ty³ '»¶ay'\n", 
ch
);

894 
ch
->
comm_æags
 -ğ
COMM_AFK
;

895 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

899 
	`wizÃt
("$N ha »tuºedØ$S keybßrd.", 
ch
, 
nuÎ±r
, 
WIZ_MISC
, 0, 0);

902 
¡¹ime
 = 
	`ùime
(&
Game
::
cu¼’t_time
);

903 
¡¹ime
[
	`¡¾’
(strtime) - 1] = '\0';

904 
	`£t_cŞÜ
(
ch
, 
YELLOW
, 
NOBOLD
);

905 
	`¡c
("You‡»‚ow iÀAFK mode.\n", 
ch
);

906 
ch
->
comm_æags
 +ğ
COMM_AFK
;

907 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

908 
	`wizÃt
("$N ha gÚAFK.", 
ch
, 
nuÎ±r
, 
WIZ_MISC
, 0, 0);

913 ià(!
ch
->
	`is_Åc
()) {

914 
buf
[
MAX_STRING_LENGTH
];

916 ià(!
¬gum’t
.
	`em±y
())

917 
FÜm©
::
	`¥rštf
(
buf
, "{B[{C%s{B] {C%s\n", 
¡¹ime
,

918 
¬gum’t
);

920 
FÜm©
::
	`¥rštf
(
buf
, "{B[{C%s{B] {CUnknown Departure.{x\n",

921 
¡¹ime
);

923 
ch
->
pcd©a
->
afk
 = 
buf
;

924 
	`¡c
(
buf
, 
ch
);

927 
	}
}

930 
	$do_nÙify
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

932 ià(
ch
->
	`is_Åc
()) ;

934 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_NONOTIFY
)) {

935 
	`¡c
("From‚ow on, you wÈbnÙif›d oàÃw‚Ùes.\n", 
ch
);

936 
ch
->
pcd©a
->
¶r_æags
 -ğ
PLR_NONOTIFY
;

939 
	`¡c
("NÙnÙify mod»moved.\n", 
ch
);

940 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_NONOTIFY
;

942 
	}
}

945 
	$upd©e_‹xt_fe
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
fe
, cÚ¡ SŒšg& 
¡r
)

947 ià(
ch
->
	`is_Åc
(è|| 
¡r
.
	`em±y
())

950 cÚ¡ *
time_fÜm©
 = "%m/%d/%y";

951 
timebuf
[100];

952 
	`¡ráime
(
timebuf
, Ñimebuf), 
time_fÜm©
, 
	`loÿÉime
(&
Game
::
cu¼’t_time
));

954 
SŒšg
 
buf
 = 
FÜm©
::
	`fÜm©
("{Y[{x%8s{Y]{x {C[{x%s{C]{x %s: %s\n",

955 
timebuf
,

956 
ch
->
š_room
 ? ch->š_room->
loÿtiÚ
.
	`to_¡ršg
(
çl£
) : " 0",

957 
ch
->
Çme
,

958 
¡r
);

960 
	`çµ’d
(
fe
, 
buf
);

961 
	}
}

963 
	$do_wbi
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

965 ià(
¬gum’t
.
	`em±y
()) {

966 
	`do_fe
(
ch
, "wbi 150");

970 
	`upd©e_‹xt_fe
(
ch
, 
WBI_FILE
, 
¬gum’t
);

971 
	`¡c
("And may iˆbim³d soÚ! :)\n", 
ch
);

972 
	}
}

974 
	$do_hbi
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

976 ià(
¬gum’t
.
	`em±y
()) {

977 
	`do_fe
(
ch
, "hbi 150");

981 
	`upd©e_‹xt_fe
(
ch
, 
HBI_FILE
, 
¬gum’t
);

982 
	`¡c
("IˆwÈbpo¡ed iÀ¨chªgnÙsoÚ! :)\n", 
ch
);

983 
	}
}

985 
	$do_wbb
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

987 ià(
¬gum’t
.
	`em±y
()) {

988 
	`do_fe
(
ch
, "wbb 150");

992 
	`upd©e_‹xt_fe
(
ch
, 
WBB_FILE
, 
¬gum’t
);

993 
	`¡c
("And may iˆbbuˆsoÚ! :)\n", 
ch
);

994 
	}
}

996 
	$do_hbb
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

998 ià(
¬gum’t
.
	`em±y
()) {

999 
	`do_fe
(
ch
, "hbb 150");

1003 
	`upd©e_‹xt_fe
(
ch
, 
HBB_FILE
, 
¬gum’t
);

1004 
	`¡c
("IˆwÈbpo¡ed iÀ¨chªgnÙsoÚ! :)\n", 
ch
);

1005 
	}
}

1007 
	$do_wÜk
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1009 ià(
¬gum’t
.
	`em±y
()) {

1010 
	`do_fe
(
ch
, "work 150");

1014 
	`upd©e_‹xt_fe
(
ch
, 
WORK_FILE
, 
¬gum’t
);

1015 
	`¡c
("May you¸id— bdev–İed soÚ! :)\n", 
ch
);

1016 
	}
}

1018 
	$do_imm­p
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1020 ià(
¬gum’t
.
	`em±y
()) {

1021 
	`do_fe
(
ch
, "immapp 150");

1025 
	`upd©e_‹xt_fe
(
ch
, 
IMMAPP_FILE
, 
¬gum’t
);

1026 
	`¡c
("Mayhey bcÚsid”ed soÚ! :)\n", 
ch
);

1027 
	}
}

1029 
	$do_rid—
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1031 ià(
¬gum’t
.
	`em±y
()) {

1032 
	`do_fe
(
ch
, "ridea 150");

1036 
	`upd©e_‹xt_fe
(
ch
, 
RIDEA_FILE
, 
¬gum’t
);

1037 
	`¡c
("And may iˆbdeb©ed soÚ! :)\n", 
ch
);

1038 
	}
}

1040 
	$do_punish
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1042 ià(
¬gum’t
.
	`em±y
()) {

1043 
	`do_fe
(
ch
, "punishment 150");

1047 
	`upd©e_‹xt_fe
(
ch
, 
PUNISHMENT_FILE
, 
¬gum’t
);

1048 
	`¡c
("Punishm’ˆlogged.\n", 
ch
);

1049 
	}
}

1051 
	$do_bug
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1053 ià(
¬gum’t
.
	`em±y
()) {

1054 ià(
	`IS_IMMORTAL
(
ch
))

1055 
	`do_fe
(
ch
, "bugs 150");

1057 
	`¡c
("Which bug would you†ikeo„eport?\n"

1058 "SyÁax: {Rbug{x you¸desütiÚ oàthbug\n", 
ch
);

1062 
	`upd©e_‹xt_fe
(
ch
, 
BUG_FILE
, 
¬gum’t
);

1063 
	`¡c
("Bug†ogged.\n", 
ch
);

1064 
	}
}

1066 
	$do_typo
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1068 ià(
¬gum’t
.
	`em±y
()) {

1069 ià(
	`IS_IMMORTAL
(
ch
))

1070 
	`do_fe
(
ch
, "typos 150");

1072 
	`¡c
("Whichypo would you†ikeo„eport?\n"

1073 "SyÁax: {Rtypo{x you¸desütiÚ oàthtypo\n", 
ch
);

1077 
	`upd©e_‹xt_fe
(
ch
, 
TYPO_FILE
, 
¬gum’t
);

1078 
	`¡c
("TypØlogged.\n", 
ch
);

1079 
	}
}

1081 
	$do_qui
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1083 
	`¡c
("Iàyou wªˆtØQUIT, you havtØ¥–È™ out.\n", 
ch
);

1085 
	}
}

1089 
boŞ
 
	$showlo¡
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, 
boŞ
 
found
, boŞ 
lock”
)

1091 ; 
obj
 !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
) {

1092 ià((
obj
->
Ëv–
 > 
	`g‘_hŞdabË_Ëv–
(
ch
))

1093 || (
obj
->
™em_ty³
 =ğ
ITEM_KEY
 && (obj->
v®ue
[0] == 0))

1094 || (
obj
->
™em_ty³
 =ğ
ITEM_MAP
 && !obj->
v®ue
[0])) {

1095 ià(!
found
)

1096 
	`±c
(
ch
, "{CThe following items in your %s will be†ost if you quit:{x\n",

1097 
lock”
 ? "locker" : "inventory");

1099 
found
 = 
Œue
;

1100 
	`±c
(
ch
, "%s\n", 
obj
->
shÜt_desü
);

1103 ià(
obj
->
cÚšs
)

1104 
found
 = 
	`showlo¡
(
ch
, 
obj
->
cÚšs
, found, 
lock”
);

1107  
found
;

1108 
	}
}

1110 
	$do_qu™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1112 
DesütÜ
 *
d
, *
d_Ãxt
, *
sd
;

1113 
Ch¬aù”
 *
viùim
;

1114 
id
, 
Êum
;

1115 *cÚ¡ 
mes§ge
 [] = {

1128 ià(
ch
->
	`is_Åc
()) {

1129 
	`¡c
("Ha! You‡» fÜev” doomedØ¡ay oÀLegacy, d—Èw™h it.\n", 
ch
);

1133 ià(
ch
->
²Ùe
) {

1134 
	`¡c
("You stÈhav¨nÙš…rog»ss, fšish iˆfœ¡…Ëa£.\n", 
ch
);

1138 ià(
ch
->
fightšg
) {

1139 
	`¡c
("NØway! You‡» fightšg.\n", 
ch
);

1143 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
) {

1144 
	`¡c
("You'»‚Ù g‘tšg ouˆoàthi th©ƒasy.\n", 
ch
);

1148 ià(
ch
->
pcd©a
->
pktim”
 > 0) {

1149 
	`¡c
("You¸blood i ¿cšgoØç¡ØËavnow!!\n", 
ch
);

1153 ià(
	`g‘_du–
(
ch
)) {

1154 
	`¡c
("You‡» invŞved iÀ¨du–, d—Èw™h iˆfœ¡.\n", 
ch
);

1158 ià(
	`g‘_pos™iÚ
(
ch
è<ğ
POS_STUNNED
) {

1159 
	`¡c
("You'»‚Ù DEAD y‘.\n", 
ch
);

1163 ià(
auùiÚ
.
	`is_·¹icªt
(
ch
)) {

1164 
	`¡c
("Wa™Èyou havsŞd/boughˆth™em oÀauùiÚ.\n", 
ch
);

1177 
Êum
 = 
	`g‘_lock”_numb”
(
ch
);

1179 ià(
Êum
 > 0 && !
	`IS_IMMORTAL
(
ch
)) {

1180 ià(
	`deduù_co¡
(
ch
, 
Êum
 * 10)) {

1181 
	`±c
(
ch
, "%d silver has been deducted for your†ocker.\n",

1182 
Êum
 * 10);

1183 
ch
->
aù_æags
 -ğ
PLR_CLOSED
;

1186 
	`¡c
("You cªnÙ‡ffÜdØ·y you¸lock” f“.\n", 
ch
);

1187 
	`¡c
("You¸lock” ha b“Àşo£d.\n", 
ch
);

1188 
ch
->
aù_æags
 +ğ
PLR_CLOSED
;

1192 
	`¡c
(
mes§ge
[
	`numb”_¿nge
(0, 9)], 
ch
);

1194 
sd
 = 
desütÜ_li¡
; sd !ğ
nuÎ±r
; sd = sd->
Ãxt
) {

1195 
viùim
 = 
sd
->
Üigš®
 ? sd->Üigš® : sd->
ch¬aù”
;

1197 ià(
sd
->
	`is_¶ayšg
()

1198 && 
sd
->
ch¬aù”
 !ğ
ch


1199 && 
	`ÿn_£e_who
(
viùim
, 
ch
)

1200 && !
viùim
->
comm_æags
.
	`has
(
COMM_NOANNOUNCE
)

1201 && !
viùim
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

1202 ià(
ch
->
pcd©a
 && !ch->pcd©a->
gameout
.
	`em±y
()) {

1203 
	`£t_cŞÜ
(
viùim
, 
GREEN
, 
BOLD
);

1204 
	`±c
(
viùim
, "[%s] %s\n", 
ch
->
Çme
, ch->
pcd©a
->
gameout
);

1207 
	`Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_ANNOUNCE
);

1208 
	`±c
(
viùim
, "[FYI] % ha qu™.\n", 
ch
->
Çme
);

1211 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

1215 
	`wizÃt
("$N„ejoš th»® wÜld.", 
ch
, 
nuÎ±r
, 
WIZ_LOGINS
, 0, 
	`GET_RANK
(ch));

1216 
	`§ve_ch¬_obj
(
ch
);

1217 
id
 = 
ch
->
pcd©a
->id;

1218 
d
 = 
ch
->
desc
;

1220 ià(
ch
->
pcd©a
 && ch->pcd©a->
video_æags
.
	`has
(
VIDEO_VT100
)) {

1221 
	`¡c
(
VT_SETWIN_CLEAR
, 
ch
);

1222 
	`¡c
(
VT_RESET_TERMINAL
, 
ch
);

1225 
	`exŒaù_ch¬
(
ch
, 
Œue
);

1228 ià(
d
 !ğ
nuÎ±r
)

1229 
	`şo£_sock‘
(
d
);

1232 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = 
d_Ãxt
) {

1233 
Ch¬aù”
 *
tch
;

1234 
d_Ãxt
 = 
d
->
Ãxt
;

1235 
tch
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

1237 ià(
tch
 &&ch->
pcd©a
 &&ch->pcd©a->
id
 == id) {

1238 
	`exŒaù_ch¬
(
tch
, 
Œue
);

1239 
	`şo£_sock‘
(
d
);

1242 
	}
}

1244 
	$do_fuckoff
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1246 
DesütÜ
 *
d
, *
d_Ãxt
;

1247 
id
;

1249 ià(
ch
->
	`is_Åc
())

1252 
SŒšg
 
log_buf
 = 
FÜm©
::
	`fÜm©
("% ha b“Àä›d.", 
ch
->
Çme
);

1253 
	`do_£nd_ªnounû
(
ch
, 
log_buf
);

1254 
Loggšg
::
	`log
(
log_buf
);

1255 
	`wizÃt
("$N ha b“À‹rmš©ed.", 
ch
, 
nuÎ±r
, 
WIZ_LOGINS
, 0, 
	`GET_RANK
(ch));

1259 
	`§ve_ch¬_obj
(
ch
);

1260 
id
 = 
ch
->
pcd©a
->id;

1261 
d
 = 
ch
->
desc
;

1262 
	`exŒaù_ch¬
(
ch
, 
Œue
);

1264 ià(
d
 !ğ
nuÎ±r
)

1265 
	`şo£_sock‘
(
d
);

1268 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = 
d_Ãxt
) {

1269 
Ch¬aù”
 *
tch
;

1270 
d_Ãxt
 = 
d
->
Ãxt
;

1271 
tch
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

1273 ià(
tch
 &&ch->
pcd©a
 &&ch->pcd©a->
id
 == id) {

1274 
	`exŒaù_ch¬
(
tch
, 
Œue
);

1275 
	`şo£_sock‘
(
d
);

1278 
	}
}

1280 
	$do_backup
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1282 ià(
ch
->
	`is_Åc
())

1285 
	`¡c
("Backšg u°pfe.\n", 
ch
);

1286 
	`backup_ch¬_obj
(
ch
);

1287 
	`WAIT_STATE
(
ch
, 4 * 
PULSE_VIOLENCE
);

1288 
	`¡c
("DÚe.\n", 
ch
);

1289 
ch
->
pcd©a
->
backup
 = 
	`g‘_¶ay_£cÚds
(ch);

1291 
	}
}

1293 
	$do_§ve
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1295 ià(
ch
->
	`is_Åc
())

1298 
	`§ve_ch¬_obj
(
ch
);

1299 
	`¡c
("Savšg. Rememb”, Legacy ha autom©iø§všg.\n", 
ch
);

1300 
	`WAIT_STATE
(
ch
, 4 * 
PULSE_VIOLENCE
);

1302 
	}
}

1304 
	$do_fŞlow
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1307 
Ch¬aù”
 *
viùim
;

1309 ià(
¬gum’t
.
	`em±y
()) {

1310 
	`¡c
("FŞlow whom?\n", 
ch
);

1314 
SŒšg
 
¬g
;

1315 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1317 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

1318 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

1322 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 !ğ
nuÎ±r
) {

1323 
	`aù
("Buˆyou'd„©h” fŞlow $N!", 
ch
, 
nuÎ±r
, ch->
ma¡”
, 
TO_CHAR
);

1327 ià(
viùim
 =ğ
ch
) {

1328 ià(
ch
->
ma¡”
 =ğ
nuÎ±r
) {

1329 
	`¡c
("You‚ow s»‡ˆyou¸owÀbu‰.\n", 
ch
);

1333 
	`¡İ_fŞlow”
(
ch
);

1337 ià(!
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
PLR_NOFOLLOW
è&& !
	`IS_IMMORTAL
(
ch
)) {

1338 
	`aù
("$N doesn't seemo want‡ny followers.\n",

1339 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1343 
ch
->
aù_æags
 -ğ
PLR_NOFOLLOW
;

1345 ià(
ch
->
ma¡”
 !ğ
nuÎ±r
)

1346 
	`¡İ_fŞlow”
(
ch
);

1348 
	`add_fŞlow”
(
ch
, 
viùim
);

1350 
	}
}

1352 
	$add_fŞlow”
(
Ch¬aù”
 *
ch
, Ch¬aù” *
ma¡”
)

1354 ià(
ch
->
ma¡”
 !ğ
nuÎ±r
) {

1355 
Loggšg
::
	`bug
("Add_follower:‚on-null master.", 0);

1359 
ch
->
ma¡”
 = master;

1360 
ch
->
Ëad”
 = 
nuÎ±r
;

1362 ià(
	`ÿn_£e_ch¬
(
ma¡”
, 
ch
))

1363 
	`aù
("$Ànow fŞlow you.", 
ch
, 
nuÎ±r
, 
ma¡”
, 
TO_VICT
);

1365 
	`aù
("You‚ow fŞlow $N.", 
ch
, 
nuÎ±r
, 
ma¡”
, 
TO_CHAR
);

1367 
	}
}

1369 
	$¡İ_fŞlow”
(
Ch¬aù”
 *
ch
)

1371 ià(
ch
->
ma¡”
 =ğ
nuÎ±r
) {

1372 
Loggšg
::
	`bug
("Stop_follower:‚ull master.", 0);

1376 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
)) {

1377 
afãù
::
	`»move_ty³_äom_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
);

1380 ià(
	`ÿn_£e_ch¬
(
ch
->
ma¡”
, chè&& ch->
š_room
 !ğ
nuÎ±r
) {

1381 
	`aù
("$À¡İ fŞlowšg you.", 
ch
, 
nuÎ±r
, ch->
ma¡”
, 
TO_VICT
);

1382 
	`aù
("You stİ fŞlowšg $N.", 
ch
, 
nuÎ±r
, ch->
ma¡”
, 
TO_CHAR
);

1385 ià(
ch
->
ma¡”
->
³t
 == ch)

1386 
ch
->
ma¡”
->
³t
 = 
nuÎ±r
;

1388 
ch
->
ma¡”
 = 
nuÎ±r
;

1389 
ch
->
Ëad”
 = 
nuÎ±r
;

1391 
	}
}

1394 
	$nuke_³ts
(
Ch¬aù”
 *
ch
)

1396 
Ch¬aù”
 *
³t
;

1398 ià((
³t
 = 
ch
->³tè!ğ
nuÎ±r
) {

1399 
	`¡İ_fŞlow”
(
³t
);

1401 ià(
³t
->
š_room
 !ğ
nuÎ±r
)

1402 
	`aù
("$N slowly fade away.", 
ch
, 
nuÎ±r
, 
³t
, 
TO_NOTVICT
);

1404 
	`exŒaù_ch¬
(
³t
, 
Œue
);

1407 
ch
->
³t
 = 
nuÎ±r
;

1409 
	}
}

1411 
	$d›_fŞlow”
(
Ch¬aù”
 *
ch
)

1413 ià(
ch
->
ma¡”
 !ğ
nuÎ±r
) {

1414 ià(
ch
->
ma¡”
->
³t
 == ch)

1415 
ch
->
ma¡”
->
³t
 = 
nuÎ±r
;

1417 ià(
ch
->
ma¡”
->
pcd©a
 !ğ
nuÎ±r
) {

1418 ià(
ch
->
ma¡”
->
pcd©a
->
sk–‘Ú
 == ch)

1419 
ch
->
ma¡”
->
pcd©a
->
sk–‘Ú
 = 
nuÎ±r
;

1421 ià(
ch
->
ma¡”
->
pcd©a
->
zomb›
 == ch)

1422 
ch
->
ma¡”
->
pcd©a
->
zomb›
 = 
nuÎ±r
;

1424 ià(
ch
->
ma¡”
->
pcd©a
->
w¿™h
 == ch)

1425 
ch
->
ma¡”
->
pcd©a
->
w¿™h
 = 
nuÎ±r
;

1427 ià(
ch
->
ma¡”
->
pcd©a
->
g¬goyË
 == ch)

1428 
ch
->
ma¡”
->
pcd©a
->
g¬goyË
 = 
nuÎ±r
;

1431 
	`¡İ_fŞlow”
(
ch
);

1434 
ch
->
Ëad”
 = 
nuÎ±r
;

1436 autØ
fch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

1437 ià(
fch
->
ma¡”
 =ğ
ch
)

1438 
	`¡İ_fŞlow”
(
fch
);

1440 ià(
fch
->
Ëad”
 =ğ
ch
)

1441 
fch
->
Ëad”
 = fch;

1445 
	}
}

1447 
	$do_Üd”
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1449 
buf
[
MAX_STRING_LENGTH
];

1450 
Ch¬aù”
 *
viùim
;

1451 
Ch¬aù”
 *
och
;

1452 
Ch¬aù”
 *
och_Ãxt
;

1453 
boŞ
 
found
;

1454 
boŞ
 
fAÎ
;

1455 
boŞ
 
»mÙe_çmŸr
 = 
çl£
;

1457 
SŒšg
 
¬g
, 
¬g2
;

1458 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1459 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g2
);

1461 ià(
¬g2
 == "delete"

1462 || 
¬g2
.
	`has_´efix
("mp")) {

1463 
	`¡c
("Th© wÈNOT bdÚe.\n", 
ch
);

1467 ià(
¬g
.
	`em±y
(è|| 
¬gum’t
.empty()) {

1468 
	`¡c
("Ord” whomØdØwh©?\n", 
ch
);

1472 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
)) {

1473 
	`¡c
("You f“Èlikkšg,‚Ù givšg, ord”s.\n", 
ch
);

1477 ià(
¬g
 == "all") {

1478 
fAÎ
 = 
Œue
;

1479 
viùim
 = 
nuÎ±r
;

1482 
fAÎ
 = 
çl£
;

1485 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

1489 
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g
, 
VIS_CHAR
);

1492 ià((!
viùim
è|| (viùim !ğ
ch
->
³t
è|| (!ch->
pcd©a
->
çmŸr
)) {

1493 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

1497 
	`¡c
("You„emÙ–y ord” you¸çmŸr...\n", 
ch
);

1498 
»mÙe_çmŸr
 = 
Œue
;

1503 ià(
¬g2
 =ğ"¡ay" && 
viùim
->
	`is_Åc
()) {

1504 
	`¡c
("You ord” you¸³ˆtØ¡ay.\n", 
ch
);

1505 
viùim
->
aù_æags
 +ğ
ACT_STAY
;

1509 ià(
¬g2
 =ğ"fŞlow" && 
viùim
->
	`is_Åc
()) {

1510 
	`¡c
("You ord” you¸³ˆtØfŞlow you.\n", 
ch
);

1511 
viùim
->
aù_æags
 -ğ
ACT_STAY
;

1515 ià(
¬g2
 =ğ"wimpy" && 
viùim
->
	`is_Åc
()) {

1516 
	`¡c
("You ord” you¸³ˆtØæ“ iàšju»d.\n", 
ch
);

1517 
viùim
->
aù_æags
 +ğ
ACT_WIMPY
;

1521 ià(
¬g2
 =ğ"cou¿ge" && 
viùim
->
	`is_Åc
()) {

1522 
	`¡c
("You ord” you¸³ˆfighˆtØthfšish.\n", 
ch
);

1523 
viùim
->
aù_æags
 -ğ
ACT_WIMPY
;

1527 ià(
viùim
 =ğ
ch
) {

1528 
	`¡c
("Ayaye,„ighˆaway!\n", 
ch
);

1532 ià(!
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ch¬m_³rsÚ
è|| viùim->
ma¡”
 !ğ
ch
 || 
	`IS_IMMORTAL
(victim)) {

1533 
	`¡c
("DØ™ your£lf!\n", 
ch
);

1538 
found
 = 
çl£
;

1540 
och
 = 
ch
->
š_room
->
³İË
; och !ğ
nuÎ±r
; och = 
och_Ãxt
) {

1541 
och_Ãxt
 = 
och
->
Ãxt_š_room
;

1543 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
och
,‡fãù::
ty³
::
ch¬m_³rsÚ
) &&

1544 
och
->
ma¡”
 =ğ
ch
 &&

1545 (
fAÎ
 || 
och
 =ğ
viùim
)) {

1546 ià(! 
found
) {

1547 
	`¡c
("You givthÜd”.\n", 
ch
);

1548 
found
 = 
Œue
;

1551 
FÜm©
::
	`¥rštf
(
buf
, "$ÀÜd” youØ'%s{x'.", 
¬gum’t
);

1552 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
och
, 
TO_VICT
);

1553 
	`š‹½»t
(
och
, 
¬gum’t
);

1557 ià((! 
found
è&& (
»mÙe_çmŸr
)) {

1558 
FÜm©
::
	`¥rštf
(
buf
, "$ÀÜd” youØ'%s{x'.", 
¬gum’t
);

1559 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, ch->
³t
, 
TO_VICT
);

1560 
	`š‹½»t
(
ch
->
³t
, 
¬gum’t
);

1561 
found
 = 
Œue
;

1564 ià(
found
)

1565 
	`WAIT_STATE
(
ch
, 
PULSE_VIOLENCE
);

1567 
	`¡c
("You havnØfŞlow” h”e.\n", 
ch
);

1568 
	}
}

1581 
	$do_³t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1583 
SŒšg
 
bufãr
;

1584 
šdex
;

1585 
Ë‰”
;

1587 ià(! 
ch
->
³t
) {

1588 
	`¡c
("Buˆyou dØnÙ hav¨³t.\n", 
ch
);

1592 ià(
	`¡¾’
(
¬gum’t
è> (
MIL
 - 16)) {

1593 
	`¡c
("PËa£ u£ sm®Ë¸wÜds.\n", 
ch
);

1598 
šdex
 = 0;

1599 
Ë‰”
 = 
ch
->
³t
->
Çme
[
šdex
];

1601 (
Ë‰”
 !ğ' 'è&& (Ë‰”è&& (
šdex
 < 100)) {

1602 
bufãr
[
šdex
] = 
Ë‰”
;

1603 
šdex
++;

1604 
Ë‰”
 = 
ch
->
³t
->
Çme
[
šdex
];

1608 
bufãr
 += " ";

1609 
bufãr
 +ğ
¬gum’t
;

1610 
	`do_Üd”
(
ch
, 
bufãr
);

1612 
	}
}

1614 
	$do_group
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1616 
buf
[
MAX_STRING_LENGTH
];

1617 
Ch¬aù”
 *
viùim
;

1619 
SŒšg
 
¬g
;

1620 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1622 ià(
¬g
.
	`em±y
()) {

1623 
Ch¬aù”
 *
Ëad”
;

1624 
Ëad”
 = (
ch
->Ëad” !ğ
nuÎ±r
) ? ch->leader : ch;

1625 
FÜm©
::
	`¥rštf
(
buf
, "%s' group:\n", 
	`PERS
(
Ëad”
, 
ch
, 
VIS_PLR
));

1626 
	`£t_cŞÜ
(
ch
, 
PURPLE
, 
BOLD
);

1627 
	`¡c
(
buf
, 
ch
);

1628 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1630 autØ
gch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

1631 ià(
	`is_§me_group
(
gch
, 
ch
)) {

1632 
SŒšg
 
gud
 =

1633 
gch
->
	`is_Åc
() ? "Mob" :

1634 
gch
->
gud
 =ğ
Gud
::
nÚe
 ? "---" :

1635 
gud_bË
[
gch
->
gud
].
who_Çme
;

1637 
FÜm©
::
	`¥rštf
(
buf
,

1639 
gch
->
Ëv–
,

1640 
gud
,

1641 
	`PERS
(
gch
, 
ch
, 
VIS_PLR
),

1642 
gch
->
h™
, 
	`GET_MAX_HIT
(gch),

1643 
gch
->
mªa
, 
	`GET_MAX_MANA
(gch),

1644 
gch
->
¡am
, 
	`GET_MAX_STAM
(gch),

1645 ((
gch
->
Ëv–
 >ğ
LEVEL_HERO
è|| gch->
	`is_Åc
()) ? 0 : (gch->level + 1) *

1646 
	`exp_³r_Ëv–
(
gch
, gch->
pcd©a
->
pošts
è- gch->
exp
);

1647 
	`£t_cŞÜ
(
ch
, 
PURPLE
, 
BOLD
);

1648 
	`¡c
(
buf
, 
ch
);

1649 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1656 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

1657 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

1661 ià(
viùim
 =ğ
ch
) {

1662 
	`¡c
("F“lšg†Ú–y?\n", 
ch
);

1666 ià(
ch
->
ma¡”
 !ğ
nuÎ±r
 || (ch->
Ëad”
 !=‚ullptr && ch->leader != ch)) {

1667 
	`¡c
("Buˆyou‡» fŞlowšg someÚ–£!\n", 
ch
);

1671 ià(
viùim
->
ma¡”
 !ğ
ch
 && ch != victim) {

1672 
	`aù
("$N i¢'ˆfŞlowšg you.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1676 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ch¬m_³rsÚ
)) {

1677 
	`¡c
("You cª'ˆ»movch¬med mob äom you¸group.\n", 
ch
);

1681 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
)) {

1682 
	`aù
("You†ikyou¸ma¡”oØmuchØËav$m!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

1686 ià(
	`is_§me_group
(
viùim
, 
ch
) && ch != victim) {

1687 
viùim
->
Ëad”
 = 
nuÎ±r
;

1688 
	`aù
("$À»move $N from $ group.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

1689 
	`£t_cŞÜ
(
viùim
, 
PURPLE
, 
BOLD
);

1690 
	`aù
("$À»move you from $ group.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

1691 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

1692 
	`£t_cŞÜ
(
ch
, 
PURPLE
, 
BOLD
);

1693 
	`aù
("You„emov$N from you¸group.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1694 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1698 
viùim
->
Ëad”
 = 
ch
;

1699 
	`aù
("$N još $n' group.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

1700 
	`aù
("You još $n' group.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

1701 
	`aù
("$N još you¸group.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1703 
	}
}

1708 
	$do_¥l™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1710 
buf
[
MAX_STRING_LENGTH
];

1711 
Ch¬aù”
 *
gch
;

1712 
memb”s
;

1713 
amouÁ_gŞd
 = 0, 
amouÁ_sv”
 = 0;

1714 
sh¬e_gŞd
, 
sh¬e_sv”
;

1715 
exŒa_gŞd
, 
exŒa_sv”
;

1717 ià(
¬gum’t
.
	`em±y
()) {

1718 
	`¡c
("S¶™ how much?\n", 
ch
);

1722 
SŒšg
 
¬g1
, 
¬g2
;

1723 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

1724 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g2
);

1726 
amouÁ_sv”
 = 
	`©oi
(
¬g1
);

1728 ià(!
¬g2
.
	`em±y
())

1729 
amouÁ_gŞd
 = 
	`©oi
(
¬g2
);

1731 ià(
amouÁ_gŞd
 < 0 || 
amouÁ_sv”
 < 0) {

1732 
	`¡c
("You¸grou°wouldn'ˆlikth©.\n", 
ch
);

1736 ià(
amouÁ_gŞd
 =ğ0 && 
amouÁ_sv”
 == 0) {

1737 
	`¡c
("You hªd ouˆz”Øcošs, buˆnØÚnÙiûs.\n", 
ch
);

1741 ià(
ch
->
gŞd
 < 
amouÁ_gŞd
 || ch->
sv”
 < 
amouÁ_sv”
) {

1742 
	`¡c
("You dÚ'ˆhavth© muchØ¥l™.\n", 
ch
);

1746 
memb”s
 = 0;

1748 
gch
 = 
ch
->
š_room
->
³İË
; gch !ğ
nuÎ±r
; gch = gch->
Ãxt_š_room
) {

1749 ià(
	`is_§me_group
(
gch
, 
ch
è&& !
afãù
::
	`exi¡s_Ú_ch¬
(gch,‡fãù::
ty³
::
ch¬m_³rsÚ
))

1750 
memb”s
++;

1753 ià(
memb”s
 < 2) {

1754 
	`¡c
("Ju¡ k“°™‡Î.\n", 
ch
);

1758 
sh¬e_sv”
 = 
amouÁ_sv”
 / 
memb”s
;

1759 
exŒa_sv”
 = 
amouÁ_sv”
 % 
memb”s
;

1760 
sh¬e_gŞd
 = 
amouÁ_gŞd
 / 
memb”s
;

1761 
exŒa_gŞd
 = 
amouÁ_gŞd
 % 
memb”s
;

1763 ià(
sh¬e_gŞd
 =ğ0 && 
sh¬e_sv”
 == 0) {

1764 
	`¡c
("DÚ'ˆev’ bÙh”, ch—psk©e.\n", 
ch
);

1768 
ch
->
sv”
 -ğ
amouÁ_sv”
;

1769 
ch
->
sv”
 +ğ
sh¬e_sv”
 + 
exŒa_sv”
;

1770 
ch
->
gŞd
 -ğ
amouÁ_gŞd
;

1771 
ch
->
gŞd
 +ğ
sh¬e_gŞd
 + 
exŒa_gŞd
;

1773 ià(
sh¬e_sv”
 > 0)

1774 
	`±c
(
ch
, "You split %d silver coin%s. Your share is %d silver.\n",

1775 
amouÁ_sv”
,‡mouÁ_sv” > 1 ? "s" : "", 
sh¬e_sv”
 + 
exŒa_sv”
);

1777 ià(
sh¬e_gŞd
 > 0)

1778 
	`±c
(
ch
, "You split %d gold coin%s. Your share is %d gold.\n",

1779 
amouÁ_gŞd
,‡mouÁ_gŞd > 1 ? "s" : "", 
sh¬e_gŞd
 + 
exŒa_gŞd
);

1781 ià(
sh¬e_gŞd
 == 0) {

1782 
FÜm©
::
	`¥rštf
(
buf
, "$n splits %d silver coin%s. Your share is %d silver.",

1783 
amouÁ_sv”
,‡mouÁ_sv” > 1 ? "s" : "", 
sh¬e_sv”
);

1785 ià(
sh¬e_sv”
 == 0) {

1786 
FÜm©
::
	`¥rštf
(
buf
, "$n splits %d gold coin%s. Your share is %d gold.",

1787 
amouÁ_gŞd
,‡mouÁ_gŞd > 1 ? "s" : "", 
sh¬e_gŞd
);

1790 
FÜm©
::
	`¥rštf
(
buf
,

1792 
amouÁ_sv”
, 
amouÁ_gŞd
,‡mouÁ_gŞd > 1 ? "s" : "", 
sh¬e_sv”
, 
sh¬e_gŞd
);

1795 
gch
 = 
ch
->
š_room
->
³İË
; gch !ğ
nuÎ±r
; gch = gch->
Ãxt_š_room
) {

1796 ià(
gch
 !ğ
ch
 && 
	`is_§me_group
(gch, chè&& !gch->
	`is_Åc
()) {

1797 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
gch
, 
TO_VICT
);

1798 
gch
->
gŞd
 +ğ
sh¬e_gŞd
;

1799 
gch
->
sv”
 +ğ
sh¬e_sv”
;

1804 
	}
}

1812 
boŞ
 
	$is_§me_group
(
Ch¬aù”
 *
ach
, Ch¬aù” *
bch
)

1814 ià(
ach
 =ğ
nuÎ±r
 || 
bch
 ==‚ullptr)

1815  
çl£
;

1817 ià(
ach
->
Ëad”
 !ğ
nuÎ±r
)‡ch =‡ch->leader;

1819 ià(
bch
->
Ëad”
 !ğ
nuÎ±r
) bch = bch->leader;

1821  
ach
 =ğ
bch
;

1822 
	}
}

1824 
	$®ign
(
Ch¬aù”
 *
ch
, 
Ãw_®ign
, *
®ign_¡r
)

1826 
buf
[
MAX_INPUT_LENGTH
];

1828 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
®ign
))

1831 ià(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
®ign
è< 
	`numb”_³rûÁ
()) {

1832 
	`¡c
("You faØchªgyou¸®ignm’t.\n", 
ch
);

1833 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
®ign
, 
çl£
, 20);

1836 
ch
->
®ignm’t
 = 
Ãw_®ign
;

1837 
FÜm©
::
	`¥rštf
(
buf
, "You‡»‚ow %s.\n", 
®ign_¡r
);

1838 
	`¡c
(
buf
, 
ch
);

1839 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
®ign
, 
Œue
, 20);

1842 
	`WAIT_STATE
(
ch
, 4 * 
PULSE_PER_SECOND
);

1843 
	}
}

1845 
	$do_®ign
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1847 ià(
ch
->
	`is_Åc
()) {

1848 
	`¡c
("Sly, mobe ÿn'ˆchªgtheœ‡lignm’t!\n", 
ch
);

1852 ià(!
	`CAN_USE_RSKILL
(
ch
, 
skl
::
ty³
::
®ign
)) {

1853 
	`¡c
("Huh?\n", 
ch
);

1857 ià(
¬gum’t
.
	`em±y
()) {

1858 
	`¡c
("Syntax: {RALIGN GOOD{x\n"

1860 "Ü {RALIGN EVIL{x\n", 
ch
);

1864 
SŒšg
 
¬g
;

1865 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1867 ià(
¬g
.
	`is_´efix_of
("good"))

1868 
	`®ign
(
ch
, 750, "good");

1869 ià(
¬g
.
	`is_´efix_of
("neutral"))

1870 
	`®ign
(
ch
, 0, "neutral");

1871 ià(
¬g
.
	`is_´efix_of
("evil"))

1872 
	`®ign
(
ch
, -750, "evil");

1874 
	`do_®ign
(
ch
, "");

1875 
	}
}

1878 
	$do_outf™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1880 
Objeù
 *
obj
;

1881 
vnum
;

1883 ià(
ch
->
Ëv–
 > 5 || ch->
	`is_Åc
()) {

1884 
	`¡c
("Fšd iˆyour£lf.\n", 
ch
);

1888 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_LIGHT
)è=ğ
nuÎ±r
) {

1889 
obj
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_SCHOOL_BANNER
), 0);

1891 ià(! 
obj
) {

1892 
Loggšg
::
	`bug
("Error making†ight in do_outfit.", 0);

1896 
obj
->
co¡
 = 0;

1897 
	`obj_to_ch¬
(
obj
, 
ch
);

1898 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_LIGHT
);

1901 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_BODY
)è=ğ
nuÎ±r
) {

1902 
obj
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_SCHOOL_VEST
), 0);

1904 ià(! 
obj
) {

1905 
Loggšg
::
	`bug
("Error making vest in do_outfit.", 0);

1909 
obj
->
co¡
 = 0;

1910 
	`obj_to_ch¬
(
obj
, 
ch
);

1911 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_BODY
);

1915 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
)è=ğ
nuÎ±r
) {

1916 
skl
::
ty³
 
¢
 = skl::ty³::
dagg”
;

1917 
vnum
 = 
OBJ_VNUM_SCHOOL_SWORD
;

1919 cÚ¡‡uto& 
’Œy
 : 
w—pÚ_bË
) {

1920 ià(
	`g‘_skl_Ëv–
(
ch
, 
¢
) <

1921 
	`g‘_skl_Ëv–
(
ch
, 
’Œy
.
skl
)) {

1922 
¢
 = 
’Œy
.
skl
;

1923 
vnum
 = 
’Œy
.vnum;

1927 
obj
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
vnum
), 0);

1929 ià(! 
obj
) {

1930 
Loggšg
::
	`bug
("Error creating weapon object in do_outfit.", 0);

1934 
	`obj_to_ch¬
(
obj
, 
ch
);

1935 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_WIELD
);

1938 ià(((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
)è=ğ
nuÎ±r


1939 || !
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_two_hªds
))

1940 && (
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_SHIELD
)è=ğ
nuÎ±r
) {

1941 
obj
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_SCHOOL_SHIELD
), 0);

1943 ià(! 
obj
) {

1944 
Loggšg
::
	`bug
("Error creating shield in do_outfit.", 0);

1948 
obj
->
co¡
 = 0;

1949 
	`obj_to_ch¬
(
obj
, 
ch
);

1950 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_SHIELD
);

1953 
	`±c
(
ch
, "You have beenƒquipped by %s.\n",

1954 !
ch
->
pcd©a
->
de™y
.
	`em±y
() ? ch->pcdata->deity : "Alisa");

1955 
	}
}

	@src/act_info.cc

28 
	~<veùÜ
>

29 
	~<s¡»am
>

30 
	~<®gÜ™hm
>

32 
	~"aù.hh
"

33 
	~"¬gum’t.hh
"

34 
	~"afãù/Afãù.hh
"

35 
	~"A»a.hh
"

36 
	~"chªÃls.hh
"

37 
	~"Ch¬aù”.hh
"

38 
	~"CÏn.hh
"

39 
	~"deş¬e.hh
"

40 
	~"D•¬‹dPÏy”.hh
"

41 
	~"DesütÜ.hh
"

42 
	~"Du–.hh
"

43 
	~"Ex™.hh
"

44 
	~"ExŒaDesü.hh
"

45 
	~"fe.hh
"

46 
	~"fšd.hh
"

47 
	~"FÏgs.hh
"

48 
	~"FÜm©.hh
"

49 
	~"Game.hh
"

50 
	~"GameTime.hh
"

51 
	~"š‹½.hh
"

52 
	~"lookup.hh
"

53 
	~"Loggšg.hh
"

54 
	~"loÙv2.hh
"

55 
	~"magic.hh
"

56 
	~"memÜy.hh
"

57 
	~"m”c.hh
"

58 
	~"MobePrÙÙy³.hh
"

59 
	~"NÙe.hh
"

60 
	~"Objeù.hh
"

61 
	~"ObjeùPrÙÙy³.hh
"

62 
	~"ObjeùV®ue.hh
"

63 
	~"PÏy”.hh
"

64 
	~"¿ndom.hh
"

65 
	~"Room.hh
"

66 
	~"skl/skl.hh
"

67 
	~"sql.hh
"

68 
	~"SocŸl.hh
"

69 
	~"SŒšg.hh
"

70 
	~"bËs.hh
"

71 
	~"ty³Çme.hh
"

72 
	~"W—th”.hh
"

73 
	~"WÜld.hh
"

74 
	~"gem/gem.hh
"

75 
	~"LoÿtiÚ.hh
"

76 
	~"RoomPrÙÙy³.hh
"

78 
ema_fe
 
¬gs
((
Ch¬aù”
 *
ch
, cÚ¡ *
fe
, cÚ¡ *
¡r
));

80 *cÚ¡ 
	gwh”e_Çme
 [] = {

108 
show_li¡_to_ch¬
 
¬gs
((
Objeù
 *
li¡
, 
Ch¬aù”
 *
ch
, 
boŞ
 
fShÜt
, boŞ 
fShowNÙhšg
, boŞ 
šsidecÚt
));

109 
show_ch¬_to_ch¬_0
 
¬gs
((
Ch¬aù”
 *
viùim
, Ch¬aù” *
ch
));

110 
show_ch¬_to_ch¬_1
 
¬gs
((
Ch¬aù”
 *
viùim
, Ch¬aù” *
ch
));

111 
show_ch¬_to_ch¬
 
¬gs
((
Ch¬aù”
 *
li¡
, Ch¬aù” *
ch
));

112 
boŞ
 
check_blšd
 
¬gs
((
Ch¬aù”
 *
ch
));

113 cÚ¡ 
SŒšg
 
li¡_ex™s
(
Ch¬aù”
 *
ch
, 
boŞ
 
fAuto
);

115 
SŒšg
 
	$fÜm©_obj_to_ch¬
(
Objeù
 *
obj
, 
Ch¬aù”
 *
ch
, 
boŞ
 
fShÜt
)

117 
SŒšg
 
buf
;

118 
diff
;

120 ià((
fShÜt
 && 
obj
->
shÜt_desü
.
	`em±y
())

121 || 
obj
->
desütiÚ
.
	`em±y
())

122  
buf
;

124 ià(
obj
->
num_£‰šgs
 > 0) {

125 
buf
 +ğ
gem
::
	`g‘_shÜt_¡ršg
(
obj
);

126 
buf
 += " ";

130 ià(!
ch
->
	`is_Åc
()

131 && ((
ch
->
pcd©a
->
que¡obj
 > 0 && 
obj
->
pIndexD©a
->
vnum
 == ch->pcdata->questobj)

132 || (
ch
->
pcd©a
->
sque¡obj
 !ğ
nuÎ±r
 && ch->pcd©a->sque¡obj =ğ
obj
)))

133 
buf
 += "{f{R[TARGET] {x";

135 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_INVIS
))

136 
buf
 += "{W(Invis) ";

138 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
d‘eù_ev
)

139 && 
	`IS_OBJ_STAT
(
obj
, 
ITEM_EVIL
))

140 
buf
 += "{R(Red Aura) ";

142 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
d‘eù_good
)

143 && 
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
))

144 
buf
 += "{B(Blue Aura) ";

146 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
d‘eù_magic
)

147 && 
	`IS_OBJ_STAT
(
obj
, 
ITEM_MAGIC
))

148 
buf
 += "{G(Magical) ";

150 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_GLOW
))

151 
buf
 += "{Y(Glowing) ";

153 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_HUM
))

154 
buf
 += "{C(Humming) ";

157 ià(
obj
->
™em_ty³
 =ğ
ITEM_WEAPON
) {

158 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_acidic
)è
buf
 += "{G(Ac) ";

159 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_æamšg
)è
buf
 += "{Y(Fl) ";

160 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_äo¡
)è
buf
 += "{C(Fr) ";

161 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_vampœic
)è
buf
 += "{P(Bl) ";

162 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_shockšg
)è
buf
 += "{V(Sh) ";

163 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
poisÚ
)è
buf
 += "{H(Po) ";

167 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
dazzlšg_light
))

168 
buf
 += "{W{f(Dazzling){x ";

170 ià(
obj
->
cÚd™iÚ
 <ğ9 && obj->cÚd™iÚ >ğ0è
buf
 += "{b(Ruined) ";

172 ià(
obj
->
cÚd™iÚ
 >ğ10 && obj->cÚd™iÚ <ğ24è
buf
 += "{b(Broken) ";

174 
buf
 += "{x";

176 ià(
fShÜt
)

177 
buf
 +ğ
obj
->
shÜt_desü
;

179 
buf
 +ğ
obj
->
desütiÚ
;

181 
buf
 += "{x";

183 ià(
ch
->
aù_æags
.
	`has
(
PLR_LOOKINPIT
è&& !ch->
	`is_Åc
()) {

184 
diff
 = 
	`g‘_u§bË_Ëv–
(
ch
è- 
obj
->
Ëv–
;

186 ià(
obj
->
Ëv–
 >ğ
LEVEL_IMMORTAL
è
buf
 += " {V(Immortal Item)";

187 ià(
diff
 < -50è
buf
 += " {R(You wish)";

188 ià(
diff
 < -25è
buf
 += " {R(In your dreams)";

189 ià(
diff
 < -10è
buf
 += " {P(Powerful Item)";

190 ià(
diff
 < 0è
buf
 += " {P(Almosthere)";

191 ià(
diff
 < 10è
buf
 += " {G(Just your size)";

192 ià(
diff
 < 25è
buf
 += " {G(Still useful)";

193 ià(
diff
 < 50è
buf
 += " {H(Weak Item)";

194 
buf
 += " {H(Tis but‡oy)";

196 
buf
 += "{x";

199  
buf
;

200 
	}
}

202 
	$show_afãù_to_ch¬
(cÚ¡ 
afãù
::
Afãù
 *
·f
, 
Ch¬aù”
 *
ch
)

204 
SŒšg
 
buf
;

206 ià(
·f
->
ty³
 > 
afãù
::ty³::
nÚe
)

207 
buf
 = 
FÜm©
::
	`fÜm©
("Efãù '%s'", 
afãù
::
	`lookup
(
·f
->
ty³
).
Çme
);

209 ià(
·f
->
loÿtiÚ
 !ğ0 &&…af->
modif›r
 != 0) {

210 ià(
·f
->
wh”e
 =ğ
TO_DEFENSE
)

211 
buf
 +ğ
FÜm©
::
	`fÜm©
("%sodifies defense‡gainst %s by %d",

212 
buf
.
	`em±y
(è? "M" : " m", 
	`dam_ty³_Çme
(
·f
->
loÿtiÚ
),…af->
modif›r
);

214 
buf
 +ğ
FÜm©
::
	`fÜm©
("%sffects %s by %d",

215 
buf
.
	`em±y
() ? "A" : "‡",

216 
	`afãù_loc_Çme
(
·f
->
loÿtiÚ
),

217 
·f
->
modif›r
);

219 ià(
·f
->
loÿtiÚ
 =ğ
APPLY_EXP_PCT


220 || 
·f
->
loÿtiÚ
 =ğ
APPLY_MANA_COST_PCT


221 || 
·f
->
loÿtiÚ
 =ğ
APPLY_STAM_COST_PCT


222 || 
·f
->
loÿtiÚ
 =ğ
APPLY_WPN_DAMAGE_PCT


223 || 
·f
->
loÿtiÚ
 =ğ
APPLY_SPELL_DAMAGE_PCT


224 || 
·f
->
loÿtiÚ
 =ğ
APPLY_VAMP_BONUS_PCT


225 || 
·f
->
loÿtiÚ
 =ğ
APPLY_FORGE_UNIQUE


226 || 
·f
->
loÿtiÚ
 =ğ
APPLY_PRIESTESS_UNIQUE


227 || 
·f
->
loÿtiÚ
 =ğ
APPLY_BREW_UNIQUE


228 || 
·f
->
loÿtiÚ
 =ğ
APPLY_SCRIBE_UNIQUE


229 || 
·f
->
loÿtiÚ
 =ğ
APPLY_TANK_UNIQUE


230 || 
·f
->
loÿtiÚ
 =ğ
APPLY_NECRO_PIERCE_UNIQUE


231 || 
·f
->
loÿtiÚ
 =ğ
APPLY_LIDDA_AURA_UNIQUE
)

232 
buf
 += "%";

236 ià(
	`IS_IMMORTAL
(
ch
))

237 
buf
 +ğ
FÜm©
::
	`fÜm©
(",†ev– %d", 
·f
->
Ëv–
);

239 ià(
·f
->
du¿tiÚ
 > -1)

240 
buf
 +ğ
FÜm©
::
	`fÜm©
(", %d hours", 
·f
->
du¿tiÚ
);

242 
buf
 += ".";

244 ià(!
·f
->
	`b™veùÜ
().
	`em±y
()) {

245 
num_æags
 = 0;

247 
i
 = 0; i < 32; i++)

248 ià(
·f
->
	`b™veùÜ
().
	`has
(
¡©ic_ÿ¡
<
FÏgs
::
B™
>(1 << 
i
)))

249 
num_æags
++;

251 
·f
->
wh”e
) {

252 
TO_OBJECT
:

253 
buf
 +ğ
FÜm©
::
	`fÜm©
(" Adds %s object flag%s.",

254 
	`exŒa_b™_Çme
(
·f
->
	`b™veùÜ
()), 
num_æags
 > 1 ? "s" : "");

265 
buf
 += "\n";

266 
	`¡c
(
buf
, 
ch
);

267 
	}
}

273 
	$show_li¡_to_ch¬
(
Objeù
 *
li¡
, 
Ch¬aù”
 *
ch
, 
boŞ
 
fShÜt
, boŞ 
fShowNÙhšg
, boŞ 
šsidecÚt
)

275 
Objeù
 *
obj
;

277 
buf
[
MAX_STRING_LENGTH
];

278 
nShow
 = 0, 
iShow
, 
couÁ
 = 0;

279 
boŞ
 
fCombše
, 
foundcÚt
 = 
çl£
;

281 ià(
ch
->
desc
 =ğ
nuÎ±r
)

284 
SŒšg
 
ouut
;

286 
obj
 = 
li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
)

287 
couÁ
++;

289 ià(
couÁ
 > 8000) {

290 
	`¡c
("Th”¬toØmªy i‹m tØdi¥Ïy.\n", 
ch
);

295 
SŒšg
 
´gp¡rShow
[8000];

296 
´gnShow
[8000];

299 
obj
 = 
li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
) {

300 ià(!
	`ÿn_£e_obj
(
ch
, 
obj
))

303 ià(
šsidecÚt
 && 
obj
->
cÚšs
)

304 
foundcÚt
 = 
Œue
;

306 ià(
obj
->
w—r_loc
 =ğ
WEAR_NONE
) {

307 
SŒšg
 
p¡rShow
 = 
	`fÜm©_obj_to_ch¬
(
obj
, 
ch
, 
fShÜt
);

308 
fCombše
 = 
çl£
;

310 ià(
ch
->
	`is_Åc
(è|| ch->
comm_æags
.
	`has
(
COMM_COMBINE
)) {

313 
iShow
 = 
nShow
 - 1; iShow >= 0; iShow--)

314 ià(!
	`¡rcmp
(
´gp¡rShow
[
iShow
], 
p¡rShow
)) {

315 
´gnShow
[
iShow
]++;

316 
fCombše
 = 
Œue
;

322 ià(!
fCombše
) {

323 
´gp¡rShow
 [
nShow
] = 
p¡rShow
;

324 
´gnShow
 [
nShow
] = 1;

325 
nShow
++;

331 
iShow
 = 0; iShow < 
nShow
; iShow++) {

332 ià(
´gp¡rShow
[
iShow
].
	`em±y
()) {

336 ià(
ch
->
	`is_Åc
(è|| ch->
comm_æags
.
	`has
(
COMM_COMBINE
)) {

337 ià(
´gnShow
[
iShow
] != 1) {

338 
FÜm©
::
	`¥rštf
(
buf
, "(%2dè", 
´gnShow
[
iShow
]);

339 
ouut
 +ğ
buf
;

342 
ouut
 += " ";

345 
ouut
 +ğ
´gp¡rShow
[
iShow
];

346 
ouut
 += '\n';

348 ià(
ouut
.
	`size
() > 15500) {

349 ià(
ch
->
comm_æags
.
	`has
(
COMM_COMBINE
))

350 
ouut
 += " (More stuff‚ot shown)\n";

352 
ouut
 += " (More stuff‚ot shown -- COMBINE would help)\n";

358 ià(
fShowNÙhšg
 && 
nShow
 == 0) {

359 ià(
ch
->
	`is_Åc
(è|| ch->
comm_æags
.
	`has
(
COMM_COMBINE
))

360 
	`¡c
(" ", 
ch
);

362 
	`¡c
("NÙhšg.\n", 
ch
);

365 
	`·ge_to_ch¬
(
ouut
, 
ch
);

367 ià(
foundcÚt
)

368 
obj
 = 
li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
)

369 ià(
	`ÿn_£e_obj
(
ch
, 
obj
è&& obj->
cÚšs
) {

370 
	`±c
(
ch
, "\À Insid%s{x:\n", 
obj
->
shÜt_desü
);

371 
	`show_li¡_to_ch¬
(
obj
->
cÚšs
, 
ch
, 
Œue
,rue, 
çl£
);

373 
	}
}

375 
	$do_bÚus
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
) {

376 
SŒšg
 
outbuf
, 
‹mpbuf
, 
bÏnkbuff
;

377 
boŞ
 
found
;

379 
outbuf
 +=

387 
found
 = 
çl£
;

388 
‹mpbuf
 =

392 
šdex
 = 1; index < 
MAX_ATTR
; index++) {

394 ià(
šdex
 == 7

395 || 
šdex
 == 8

396 || 
šdex
 == 10

397 || 
šdex
 == 11

398 || 
šdex
 == 25)

401 ià((
	`GET_ATTR_MOD
(
ch
, 
šdex
)) == 0)

404 
found
 = 
Œue
;

406 
‹mpbuf
 +ğ
FÜm©
::
	`fÜm©
(" |#| %-30s %5d",

407 
	`afãù_loc_Çme
(
šdex
), 
	`GET_ATTR_MOD
(
ch
, index));

409 ià(
šdex
 =ğ
APPLY_EXP_PCT


410 || 
šdex
 =ğ
APPLY_MANA_COST_PCT


411 || 
šdex
 =ğ
APPLY_STAM_COST_PCT


412 || 
šdex
 =ğ
APPLY_WPN_DAMAGE_PCT


413 || 
šdex
 =ğ
APPLY_SPELL_DAMAGE_PCT


414 || 
šdex
 =ğ
APPLY_VAMP_BONUS_PCT


415 || 
šdex
 =ğ
APPLY_FORGE_UNIQUE


416 || 
šdex
 =ğ
APPLY_PRIESTESS_UNIQUE


417 || 
šdex
 =ğ
APPLY_BREW_UNIQUE


418 || 
šdex
 =ğ
APPLY_SCRIBE_UNIQUE


419 || 
šdex
 =ğ
APPLY_TANK_UNIQUE


420 || 
šdex
 =ğ
APPLY_NECRO_PIERCE_UNIQUE


421 || 
šdex
 =ğ
APPLY_LIDDA_AURA_UNIQUE
)

422 
‹mpbuf
 += "%";

424 
‹mpbuf
 += " ";

426 
‹mpbuf
 += " |#|\n";

429 ià(
found
)

430 
outbuf
 +ğ
‹mpbuf
;

432 ià(
found
)

433 
‹mpbuf
 =

437 
found
 = 
çl£
;

438 
‹mpbuf
 =

443 
found_£t
 = 0;

444 
Objeù
 *
obj
;

445 
iW—r
;

446 
boŞ
 
Çme_di¥Ïyed
, 
£t2
, 
£t3
, 
£t4
, 
£t5
 = 
çl£
;

447 
bÏnkbuff
 = " ";

449 
iW—r
 = 0; iW—¸< 
MAX_WEAR
; iWear++) {

450 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
iW—r
)è!ğ
nuÎ±r
) {

451 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
) {

452 ià(
·f
->
loÿtiÚ
 == 0)

455 ià(
·f
->
loÿtiÚ
 >= 43 &&

456 (
·f
->
loÿtiÚ
 <= 63)){

458 
found_£t
 = ( 
·f
->
loÿtiÚ
 - 42 );

459 
found
 = 
Œue
;

461 ià((!
Çme_di¥Ïyed
è&& (
	`GET_ATTR
(
ch
, 
·f
->
loÿtiÚ
) >= 2)){

462 
‹mpbuf
 +ğ
FÜm©
::
	`fÜm©
(

464 
£t_bË
[
found_£t
 - 1].
di¥Ïy
,

465 
bÏnkbuff
);

466 
Çme_di¥Ïyed
 = 
Œue
;

467 
‹mpbuf
 += " |#|\n";

469 ià(
	`GET_ATTR
(
ch
, 
·f
->
loÿtiÚ
è>ğ2 && (!
£t2
)){

470 
‹mpbuf
 +ğ
FÜm©
::
	`fÜm©
(" |#| %-45  %1s", 
£t_bË
[
found_£t
 - 1].
£t2
,

471 
bÏnkbuff
);

472 
£t2
 = 
Œue
;

473 
‹mpbuf
 += " |#|\n";

475 ià(
	`GET_ATTR
(
ch
, 
·f
->
loÿtiÚ
è>ğ3 && (!
£t3
)){

476 
‹mpbuf
 +ğ
FÜm©
::
	`fÜm©
(" |#| %-45  %3s", 
£t_bË
[
found_£t
 - 1].
£t3
,

477 
bÏnkbuff
);

478 
£t3
 = 
Œue
;

479 
‹mpbuf
 += " |#|\n";

481 ià(
	`GET_ATTR
(
ch
, 
·f
->
loÿtiÚ
è>ğ4 && (!
£t4
)){

482 
‹mpbuf
 +ğ
FÜm©
::
	`fÜm©
(" |#| %-45  %3s", 
£t_bË
[
found_£t
 - 1].
£t4
,

483 
bÏnkbuff
);

484 
£t4
 = 
Œue
;

485 
‹mpbuf
 += " |#|\n";

487 ià(
	`GET_ATTR
(
ch
, 
·f
->
loÿtiÚ
è>ğ5 && (!
£t5
)){

488 
‹mpbuf
 +ğ
FÜm©
::
	`fÜm©
(" |#| %-45  %3s", 
£t_bË
[
found_£t
 - 1].
£t5
,

489 
bÏnkbuff
);

490 
£t5
 = 
Œue
;

491 
‹mpbuf
 += " |#|\n";

498 ià(
found
)

499 
outbuf
 +ğ
‹mpbuf
;

501 ià(
found
)

502 
‹mpbuf
 = " |#|----------------------------------------------------------------|#|\n";

505 
found
 = 
çl£
;

506 
‹mpbuf
 +=

510 
šdex
 = 1; index <ğ
DAM_IRON
; index++) {

512 ià(
šdex
 == 16

513 || 
šdex
 == 17

514 || 
šdex
 == 20)

517 ià((
	`GET_DEFENSE_MOD
(
ch
, 
šdex
)) == 0)

520 
found
 = 
Œue
;

522 
‹mpbuf
 +ğ
FÜm©
::
	`fÜm©
(" |#| %-30s %5d%%",

523 
	`dam_ty³_Çme
(
šdex
), 
	`GET_DEFENSE_MOD
(
ch
, index));

525 
‹mpbuf
 += " |#|\n";

528 ià(
found
)

529 
outbuf
 +ğ
‹mpbuf
;

531 
outbuf
 +=

536 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_BORDER
);

537 
	`·ge_to_ch¬
(
outbuf
, 
ch
);

538 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

539 
	}
}

541 
	$do_³ek
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

543 
Ch¬aù”
 *
viùim
;

544 
boŞ
 
®l
 = 
çl£
;

546 ià(
ch
->
	`is_Åc
(è|| !
	`g‘_skl_Ëv–
(ch, 
skl
::
ty³
::
³ek
)) {

547 
	`¡c
("You‡»‚Ù skËd‡ˆ³ekšg.\n", 
ch
);

551 ià(
¬gum’t
.
	`em±y
()) {

552 
	`¡c
("P“k‡ˆwhom?\n", 
ch
);

556 
SŒšg
 
¬g1
, 
¬g2
;

557 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

558 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

560 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g1
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

561 
	`¡c
("You s“‚ØÚbyh©‚amšhroom.\n", 
ch
);

565 ià(
viùim
 =ğ
ch
) {

566 
	`¡c
("A» youh©…¬ªoid?!?\n", 
ch
);

570 ià(
	`IS_IMMORTAL
(
viùim
è&& !IS_IMMORTAL(
ch
)) {

571 
	`¡c
("They…robably wouldn'ˆlikth©.\n", 
ch
);

575 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
³ek
))

578 ià(!
	`rŞl_chªû
(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
³ek
))) {

579 
	`¡c
("You cª'ˆ£emØfšd‡ good‡ngË...\n", 
ch
);

583 ià(!
¬g2
.
	`em±y
(è&& 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
³ek
) > 1) {

584 ià(
¬g2
 == "lore") {

585 
Objeù
 *
obj
;

587 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
lÜe
)) {

588 
	`¡c
("You‡»n'ˆŒašed iÀthlÜoà™ems.\n", 
ch
);

592 ià(
¬gum’t
.
	`em±y
()) {

593 
	`¡c
("Wh© i‹m iÀtheœ inv’tÜy dØyou wªˆtØlÜe?\n", 
ch
);

597 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
viùim
, 
¬gum’t
)è=ğ
nuÎ±r
) {

598 
	`¡c
("They‡»n'ˆÿ¼yšgh©.\n", 
ch
);

602 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
lÜe
).
b—ts
);

604 ià(!
ch
->
	`is_Åc
(è&& !
	`rŞl_chªû
(
	`g‘_skl_Ëv–
(ch, 
skl
::
ty³
::
lÜe
)))

605 
	`aù
("You†ook‡t $p, but you can't find out‡ny‡dditional information.",

606 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

608 
	`¥–l_id’tify
(
skl
::
ty³
::
lÜe
, (4 * 
obj
->
Ëv–
è/ 3, 
ch
, obj,

609 
TARGET_OBJ
, 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
lÜe
));

610 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
lÜe
, 
Œue
, 4);

615 ià(
¬g2
 =ğ"®l" && 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
³ek
) > 2)

616 
®l
 = 
Œue
;

619 
	`aù
("You…“k‡ˆ$S inv’tÜy:", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

620 
	`show_li¡_to_ch¬
(
viùim
->
ÿ¼yšg
, 
ch
, 
Œue
,rue, 
®l
);

621 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
³ek
, 
Œue
, 4);

622 
	}
}

624 
	$show_ch¬_to_ch¬_0
(
Ch¬aù”
 *
viùim
, Ch¬aù” *
ch
)

626 
SŒšg
 
buf
;

627 
mes§ge
[
MAX_STRING_LENGTH
];

630 ià(!
viùim
->
	`is_Åc
()) {

631 ià(
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_LINK_DEAD
))

632 
buf
 += "{G(LinkDead) ";

635 ià(
viùim
->
	`is_Åc
(è&& !
ch
->is_npc()

636 && ((
ch
->
pcd©a
->
que¡mob
 > 0 && 
viùim
->
pIndexD©a
->
vnum
 == ch->pcdata->questmob)

637 || (!
ch
->
desc
->
Üigš®
 && ch->
pcd©a
->
sque¡mob
 !ğ
nuÎ±r
 && 
viùim
 == ch->pcdata->squestmob)))

638 
buf
 += "{f{R[TARGET] {x";

640 ià(
viùim
->
comm_æags
.
	`has
(
COMM_AFK
))

641 
buf
 += "{b[AFK] ";

643 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
švis
))

644 
buf
 += "{C(Invis) ";

646 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
midnight
))

647 
buf
 += "{c(Shadowy) ";

649 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
hex
))

650 
buf
 += "{c(Dark Aura) ";

652 ià(
viùim
->
švis_Ëv–
)

653 
buf
 += "{T(Wizi) ";

655 ià(
viùim
->
lurk_Ëv–
)

656 
buf
 += "{H(Lurk) ";

658 ià(!
viùim
->
	`is_Åc
(è&& !viùim->
pcd©a
->
au¿
.
	`em±y
()) {

659 
¡ršg
[
MAX_INPUT_LENGTH
];

660 
FÜm©
::
	`¥rštf
(
¡ršg
, "{W(%s{Wè", 
viùim
->
pcd©a
->
au¿
);

661 
buf
 +ğ
¡ršg
;

664 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
hide
)è
buf
 += "{B(Hide) ";

666 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ch¬m_³rsÚ
)è
buf
 += "{M(Charmed) ";

668 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
·ss_doÜ
)è
buf
 += "{c(Translucent) ";

670 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ç”›_fœe
)è
buf
 += "{P(Pink Aura) ";

672 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
æamesh›ld
)è
buf
 += "{b(Flaming Aura) ";

674 ià(
	`IS_EVIL
(
viùim
è&& 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
d‘eù_ev
)è
buf
 += "{R(Red Aura) ";

676 ià(
	`IS_GOOD
(
viùim
è&& 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
d‘eù_good
)è
buf
 += "{Y(Golden Aura) ";

678 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
§nùu¬y
)è
buf
 += "{W(White Aura) ";

680 ià(!
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
PLR_KILLER
)è
buf
 += "{R(KILLER) ";

682 ià(!
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
PLR_THIEF
)è
buf
 += "{B(THIEF) ";

684 
buf
 += "{x";

686 ià(
	`g‘_pos™iÚ
(
viùim
è=ğviùim->
¡¬t_pos
 && !viùim->
lÚg_desü
.
	`em±y
()) {

687 ià(
viùim
->
	`is_Åc
())

688 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_MOBILES
);

690 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_PLAYERS
);

692 
buf
 +ğ
viùim
->
lÚg_desü
;

693 
	`¡c
(
buf
, 
ch
);

694 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

700 
buf
 +ğ(
viùim
->
	`is_Åc
(è? viùim->
shÜt_desü
 : viùim->
Çme
);

702 ià(!
viùim
->
	`is_Åc
(è&& !
ch
->
comm_æags
.
	`has
(
COMM_BRIEF
)

703 && 
	`g‘_pos™iÚ
(
viùim
è>ğ
POS_STANDING
 && 
ch
->
Ú
 =ğ
nuÎ±r
) {

704 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_PLAYERS
);

705 
buf
 +ğ
viùim
->
pcd©a
->
t™Ë
;

706 
	`¡c
("{x{a", 
ch
);

707 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

710 
	`g‘_pos™iÚ
(
viùim
)) {

711 
POS_DEAD
: 
buf
 += " is DEAD!!"; ;

713 
POS_MORTAL
: 
buf
 += " is mortally wounded."; ;

715 
POS_INCAP
: 
buf
 += " is incapacitated."; ;

717 
POS_STUNNED
: 
buf
 += " is†ying here stunned."; ;

719 
POS_SLEEPING
:

720 ià(
viùim
->
Ú
 !ğ
nuÎ±r
) {

721 ià(
viùim
->
Ú
->
v®ue
[2].
	`æags
().
	`has
(
SLEEP_AT
)) {

722 
FÜm©
::
	`¥rštf
(
mes§ge
, " is sleeping‡t %s.",

723 
viùim
->
Ú
->
shÜt_desü
);

724 
buf
 +ğ
mes§ge
;

726 ià(
viùim
->
Ú
->
v®ue
[2].
	`æags
().
	`has
(
SLEEP_ON
)) {

727 
FÜm©
::
	`¥rštf
(
mes§ge
, " is sleeping on %s.",

728 
viùim
->
Ú
->
shÜt_desü
);

729 
buf
 +ğ
mes§ge
;

732 
FÜm©
::
	`¥rštf
(
mes§ge
, " is sleeping in %s.",

733 
viùim
->
Ú
->
shÜt_desü
);

734 
buf
 +ğ
mes§ge
;

738 
buf
 += " is sleeping here.";

742 
POS_RESTING
:

743 ià(
viùim
->
Ú
 !ğ
nuÎ±r
) {

744 ià(
viùim
->
Ú
->
v®ue
[2].
	`æags
().
	`has
(
REST_AT
)) {

745 
FÜm©
::
	`¥rštf
(
mes§ge
, " is„esting‡t %s.",

746 
viùim
->
Ú
->
shÜt_desü
);

747 
buf
 +ğ
mes§ge
;

749 ià(
viùim
->
Ú
->
v®ue
[2].
	`æags
().
	`has
(
REST_ON
)) {

750 
FÜm©
::
	`¥rštf
(
mes§ge
, " is„esting on %s.",

751 
viùim
->
Ú
->
shÜt_desü
);

752 
buf
 +ğ
mes§ge
;

755 
FÜm©
::
	`¥rštf
(
mes§ge
, " is„esting in %s.",

756 
viùim
->
Ú
->
shÜt_desü
);

757 
buf
 +ğ
mes§ge
;

761 
buf
 += " is„esting here.";

765 
POS_SITTING
:

766 ià(
viùim
->
Ú
 !ğ
nuÎ±r
) {

767 ià(
viùim
->
Ú
->
v®ue
[2].
	`æags
().
	`has
(
SIT_AT
)) {

768 
FÜm©
::
	`¥rštf
(
mes§ge
, " is sitting‡t %s.",

769 
viùim
->
Ú
->
shÜt_desü
);

770 
buf
 +ğ
mes§ge
;

772 ià(
viùim
->
Ú
->
v®ue
[2].
	`æags
().
	`has
(
SIT_ON
)) {

773 
FÜm©
::
	`¥rštf
(
mes§ge
, " is sitting on %s.",

774 
viùim
->
Ú
->
shÜt_desü
);

775 
buf
 +ğ
mes§ge
;

778 
FÜm©
::
	`¥rštf
(
mes§ge
, " is sitting in %s.",

779 
viùim
->
Ú
->
shÜt_desü
);

780 
buf
 +ğ
mes§ge
;

784 
buf
 += " is sitting here.";

788 
POS_STANDING
:

789 ià(
viùim
->
Ú
 !ğ
nuÎ±r
) {

790 ià(
viùim
->
Ú
->
v®ue
[2].
	`æags
().
	`has
(
STAND_AT
)) {

791 
FÜm©
::
	`¥rštf
(
mes§ge
, " is standing‡t %s.",

792 
viùim
->
Ú
->
shÜt_desü
);

793 
buf
 +ğ
mes§ge
;

795 ià(
viùim
->
Ú
->
v®ue
[2].
	`æags
().
	`has
(
STAND_ON
)) {

796 
FÜm©
::
	`¥rštf
(
mes§ge
, " is standing on %s.",

797 
viùim
->
Ú
->
shÜt_desü
);

798 
buf
 +ğ
mes§ge
;

801 
FÜm©
::
	`¥rštf
(
mes§ge
, " is standing in %s.",

802 
viùim
->
Ú
->
shÜt_desü
);

803 
buf
 +ğ
mes§ge
;

807 
buf
 += " is here.";

811 
POS_FLYING
:

812 
buf
 += " is flying here.";

815 
POS_FIGHTING
:

816 
buf
 += " is here, fighting ";

818 ià(
viùim
->
fightšg
 =ğ
nuÎ±r
)

819 
buf
 += "thin‡ir??";

820 ià(
viùim
->
fightšg
 =ğ
ch
)

821 
buf
 += "YOU! DOH!";

822 ià(
viùim
->
š_room
 =ğviùim->
fightšg
->in_room) {

823 
buf
 +ğ
	`PERS
(
viùim
->
fightšg
, 
ch
, 
VIS_CHAR
);

824 
buf
 += ".";

827 
buf
 += "with shadow-boxers??";

832 
buf
 += "\n";

833 
buf
[0] = 
	`touµ”
(buf[0]);

834 
	`Ãw_cŞÜ
(
ch
, 
viùim
->
	`is_Åc
(è? 
CSLOT_MISC_MOBILES
 : 
CSLOT_MISC_PLAYERS
);

835 
	`¡c
(
buf
, 
ch
);

836 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

838 
	}
}

840 
	$show_ch¬_to_ch¬_1
(
Ch¬aù”
 *
viùim
, Ch¬aù” *
ch
)

842 
SŒšg
 
buf
;

843 
Objeù
 *
obj
;

844 
iW—r
;

845 
³rûÁ
;

846 
boŞ
 
found
;

848 ià(
	`ÿn_£e_ch¬
(
viùim
, 
ch
)) {

849 ià(
ch
 =ğ
viùim
)

850 
	`aù
("$Àlook © $m£lf.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

852 
	`aù
("$Àlook © you.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

853 
	`aù
("$Àlook © $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

857 ià(!
viùim
->
desütiÚ
.
	`em±y
()) {

858 
	`£t_cŞÜ
(
ch
, 
PURPLE
, 
NOBOLD
);

859 
	`¡c
(
viùim
->
desütiÚ
, 
ch
);

860 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

863 
	`£t_cŞÜ
(
ch
, 
PURPLE
, 
NOBOLD
);

864 
	`aù
("NÙhšg S³cŸl.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

865 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

868 ià(
	`GET_MAX_HIT
(
viùim
) > 0)

869 
³rûÁ
 = (100 * 
viùim
->
h™
è/ 
	`GET_MAX_HIT
(victim);

871 
³rûÁ
 = -1;

873 
buf
 = 
	`PERS
(
viùim
, 
ch
, 
VIS_CHAR
);

875 ià(
³rûÁ
 >= 100)

876 
buf
 += " is inƒxcellent condition.\n";

877 ià(
³rûÁ
 >= 90)

878 
buf
 += " has‡ few scratches.\n";

879 ià(
³rûÁ
 >= 75)

880 
buf
 += " has some small wounds‡nd bruises.\n";

881 ià(
³rûÁ
 >= 50)

882 
buf
 += " has quite‡ few wounds.\n";

883 ià(
³rûÁ
 >= 30)

884 
buf
 += " has some big‚asty wounds‡nd scratches.\n";

885 ià(
³rûÁ
 >= 15)

886 
buf
 += "†ooks…retty hurt.\n";

887 ià(
³rûÁ
 >= 1)

888 
buf
 += " is in‡wful condition.\n";

889 ià(
³rûÁ
 >= 0)

890 
buf
 += " will soon beoast!!!\n";

892 
buf
 += " is in‚eed of ***SERIOUS*** medical‡ttention!!!\n";

894 
buf
[0] = 
	`touµ”
(buf[0]);

895 
	`£t_cŞÜ
(
ch
, 
CYAN
, 
NOBOLD
);

896 
	`¡c
(
buf
, 
ch
);

897 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

898 
found
 = 
çl£
;

900 ià(!
viùim
->
	`is_Åc
()) {

901 
	`£t_cŞÜ
(
ch
, 
RED
, 
BOLD
);

902 
FÜm©
::
	`¥rštf
(
buf
, "%s has killed %d…layers‡nd has been killed by %d…layers.\n",

903 
	`GET_ATTR_SEX
(
viùim
è=ğ
SEX_NEUTRAL
 ? "It" : GET_ATTR_SEX(viùimè=ğ
SEX_MALE
 ? "He" : "She"

904 , 
viùim
->
pcd©a
->
pckls
, viùim->pcd©a->
pckËd
);

905 
	`¡c
(
buf
, 
ch
);

906 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

909 ià(!
viùim
->
	`is_Åc
()) {

910 
	`£t_cŞÜ
(
ch
, 
PURPLE
, 
BOLD
);

911 
FÜm©
::
	`¥rštf
(
buf
, "%s has killed %d…layers inhe‡rena‡nd has been defeated by %d…layers inhe‡rena.\n",

912 
	`GET_ATTR_SEX
(
viùim
è=ğ
SEX_NEUTRAL
 ? "It" : GET_ATTR_SEX(viùimè=ğ
SEX_MALE
 ? "He" : "She"

913 , 
viùim
->
pcd©a
->
¬’akls
, viùim->pcd©a->
¬’akËd
);

914 
	`¡c
(
buf
, 
ch
);

915 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

918 ià(!
viùim
->
	`is_Åc
(è&& !
	`IS_IMMORTAL
(victim)) {

919 
FÜm©
::
	`¥rštf
(
buf
, "% i ¨devouˆfŞlow” oà%s.\n", 
viùim
->
Çme
,

920 !
viùim
->
pcd©a
->
de™y
.
	`em±y
() ? victim->pcdata->deity : "no one");

921 
	`£t_cŞÜ
(
ch
, 
CYAN
, 
BOLD
);

922 
	`¡c
(
buf
, 
ch
);

923 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

926 ià(!
viùim
->
	`is_Åc
()) {

927 
	`£t_cŞÜ
(
ch
, 
BLUE
, 
BOLD
);

928 
FÜm©
::
	`¥rštf
(
buf
, "%s is‡bout %d years old.\n",

929 
	`GET_ATTR_SEX
(
viùim
è=ğ
SEX_NEUTRAL
 ? "It" : GET_ATTR_SEX(viùimè=ğ
SEX_MALE
 ? "He" : "She"

930 , 
	`GET_ATTR_AGE
(
viùim
));

931 
	`¡c
(
buf
, 
ch
);

932 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

935 
iW—r
 = 0; iW—¸< 
MAX_WEAR
; iWear++) {

936 ià(!
viùim
->
	`is_Åc
(è&& !viùim->
pcd©a
->
¥ou£
.
	`em±y
(è&& 
iW—r
 =ğ
WEAR_WEDDINGRING


937 && !
	`IS_IMMORTAL
(
ch
))

940 ià((
obj
 = 
	`g‘_eq_ch¬
(
viùim
, 
iW—r
)è!ğ
nuÎ±r


941 && 
	`ÿn_£e_obj
(
ch
, 
obj
)) {

942 
	`£t_cŞÜ
(
ch
, 
GREEN
, 
NOBOLD
);

944 ià(!
found
) {

945 
	`¡c
("\n", 
ch
);

946 
	`aù
("$N i usšg:", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

947 
found
 = 
Œue
;

950 
	`¡c
(
wh”e_Çme
[
iW—r
], 
ch
);

951 
	`¡c
(
	`fÜm©_obj_to_ch¬
(
obj
, 
ch
, 
Œue
), ch);

952 
	`¡c
("\n", 
ch
);

953 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

957 ià(
viùim
 !ğ
ch


958 && !
ch
->
	`is_Åc
()

959 && 
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_AUTOPEEK
)

960 && (!
	`IS_IMMORTAL
(
viùim
è|| IS_IMMORTAL(
ch
))

961 && 
	`numb”_³rûÁ
(è< 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
³ek
)) {

962 
	`£t_cŞÜ
(
ch
, 
YELLOW
, 
NOBOLD
);

963 
	`¡c
("\nYou…“k‡ˆthšv’tÜy:\n", 
ch
);

964 
	`show_li¡_to_ch¬
(
viùim
->
ÿ¼yšg
, 
ch
, 
Œue
,rue, 
çl£
);

965 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
³ek
, 
Œue
, 4);

967 
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
³ek
);

970 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

972 
	}
}

974 
	$show_ch¬_to_ch¬
(
Ch¬aù”
 *
li¡
, Ch¬aù” *
ch
)

976 
Ch¬aù”
 *
rch
;

978 
rch
 = 
li¡
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
) {

979 ià(
rch
 =ğ
ch
)

982 ià(
	`ÿn_£e_ch¬
(
ch
, 
rch
))

983 
	`show_ch¬_to_ch¬_0
(
rch
, 
ch
);

984 ià(
ch
->
š_room
->
	`is_d¬k
()

985 && !
ch
->
š_room
->
	`is_v”y_d¬k
()

986 && 
afãù
::
	`exi¡s_Ú_ch¬
(
rch
,‡fãù::
ty³
::
night_visiÚ
))

987 
	`¡c
("You s“ glowšgƒye w©chšg YOU!\n", 
ch
);

989 
	}
}

991 
boŞ
 
	$check_blšd
(
Ch¬aù”
 *
ch
)

993 ià(
	`IS_IMMORTAL
(
ch
))

994  
Œue
;

996 ià(
	`is_blšded
(
ch
)) {

997 
	`¡c
("You cª'ˆ£¨thšg!\n", 
ch
);

998  
çl£
;

1001  
Œue
;

1002 
	}
}

1012 
	$£t_cŞÜ
(
Ch¬aù”
 *
ch
, 
cŞÜ
, 
bŞd
)

1014 
buf
[
MAX_INPUT_LENGTH
];

1016 ià(
ch
->
aù_æags
.
	`has
(
PLR_COLOR
)) {

1017 
FÜm©
::
	`¥rštf
(
buf
, "\033[%d;%dm", 
bŞd
, 
cŞÜ
);

1018 
	`¡c
(
buf
, 
ch
);

1021 ià(!
ch
->
	`is_Åc
()) {

1022 
ch
->
pcd©a
->
Ï¡cŞÜ
[0] = 
cŞÜ
;

1023 
ch
->
pcd©a
->
Ï¡cŞÜ
[1] = 
bŞd
;

1025 
	}
}

1027 
	$Ãw_cŞÜ
(
Ch¬aù”
 *
ch
, 
¦Ù
)

1029 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
cŞÜ
[
¦Ù
] != 0)

1030 
	`£t_cŞÜ
(
ch
, ch->
pcd©a
->
cŞÜ
[
¦Ù
], ch->pcd©a->
bŞd
[slot]);

1032 
	`£t_cŞÜ
(
ch
, 
c£‰šg_bË
[
¦Ù
].
cŞÜ
, c£‰šg_bË[¦Ù].
bŞd
);

1033 
	}
}

1036 
	$do_süŞl
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1038 
buf
[100];

1039 
lšes
;

1041 ià(
¬gum’t
.
	`em±y
()) {

1042 
FÜm©
::
	`¥rštf
(
buf
, "You currently display %d†ines…er…age.\n",

1043 
ch
->
lšes
);

1044 
	`¡c
(
buf
, 
ch
);

1048 
SŒšg
 
¬g
;

1049 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1051 ià(!
¬g
.
	`is_numb”
()) {

1052 
	`¡c
("You mu¡…rovid¨numb”.\n", 
ch
);

1056 
lšes
 = 
	`©oi
(
¬g
);

1058 ià(
lšes
 < 10 ||†ines > 100) {

1059 
	`¡c
("You mu¡…rovid¨»asÚabË‚umb”.\n", 
ch
);

1063 
FÜm©
::
	`¥rštf
(
buf
, "SüŞÈ£ˆtØ%d†šes.\n", 
lšes
);

1064 
	`¡c
(
buf
, 
ch
);

1065 
ch
->
lšes
 =†ines;

1066 
	}
}

1068 
	$do_socŸls
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1070 
SŒšg
 
dbuf
;

1071 
buf
[
MAX_STRING_LENGTH
];

1072 
SocŸl
 *
™”©Ü
;

1073 
cŞ
;

1074 
cŞ
 = 0;

1076 
™”©Ü
 = 
socŸl_bË_h—d
->
Ãxt
; i‹¿tÜ !ğ
socŸl_bË_
; iterator = iterator->next) {

1077 
FÜm©
::
	`¥rštf
(
buf
, "%-12s", 
™”©Ü
->
Çme
);

1078 
dbuf
 +ğ
buf
;

1080 ià(++
cŞ
 % 6 == 0)

1081 
dbuf
 += "\n";

1084 ià(
cŞ
 % 6 != 0)

1085 
dbuf
 += "\n";

1087 
	`·ge_to_ch¬
(
dbuf
, 
ch
);

1088 
	}
}

1091 
	$do_imÙd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1093 
	`h–p
(
ch
, "imotd");

1094 
	}
}

1096 
	$do_ruËs
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1098 
	`h–p
(
ch
, "rules");

1099 
	}
}

1101 
	$do_¡Üy
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1103 
	`h–p
(
ch
, "story");

1104 
	}
}

1106 
	$do_d•¬‹d
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1108 
D•¬‹dPÏy”
 *
™”©Ü
;

1109 
Çme_buf
[20];

1110 
i
 = 0;

1111 
	`¡c
("\n", 
ch
);

1112 
	`¡c
(
d•¬‹d_li¡_lše
, 
ch
);

1114 
™”©Ü
 = 
d•¬‹d_li¡_h—d
->
Ãxt
; i‹¿tÜ !ğ
d•¬‹d_li¡_
; iterator = iterator->next) {

1115 
FÜm©
::
	`¥rštf
(
Çme_buf
, "%-18s", 
™”©Ü
->
Çme
);

1116 
	`¡c
(
Çme_buf
, 
ch
);

1117 
i
++;

1119 ià(
i
 % 2 == 0) {

1120 
™”©Ü
 = i‹¿tÜ->
Ãxt
;

1122 ià(
™”©Ü
 =ğ
d•¬‹d_li¡_
) {

1123 
	`¡c
("\n", 
ch
);

1124 
i
 = 0;

1128 
	`¡c
(
™”©Ü
->
Çme
, 
ch
);

1129 
	`¡c
("\n", 
ch
);

1130 
	`¡c
(
d•¬‹d_li¡_lše
, 
ch
);

1134 ià(
i
 != 0)

1135 
	`¡c
("\n", 
ch
);

1136 
	}
}

1138 
	$do_wizli¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1140 
	`h–p
(
ch
, "wizlist");

1141 
	}
}

1144 
	$com·»_şªs
(cÚ¡ *
p1
, cÚ¡ *
p2
)

1146  
	`¡rcmp
((*(
CÏn
 **)
p1
)->
Çme
, (*(CÏÀ**)
p2
)->name);

1147 
	}
}

1149 
	$do_şªli¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1151 
lblock
[
MIL
], 
rblock
[MIL];

1152 
CÏn
 *
şª
;

1153 
SŒšg
 
bufãr
;

1154 
couÁ
 = 0, 
l
 = 0, 
r
 = 0, 
i
 = 0, 
high»mÜt
 = 0, 
highËv–
 = 0;

1155 
	sşª_şª
 {

1156 
Çme
[20];

1157 
t™Ë
[150];

1158 
¿nk
[20];

1159 
Ëv–
;

1160 
»mÜt
;

1161 
¡©us
;

1162 
boŞ
 
´š‹d
;

1164 
şª_şª
 
şª_li¡
[500];

1166 ià(
¬gum’t
.
	`em±y
()) {

1167 
CÏn
 *
aCÏn
[
	`couÁ_şªs
()], 
z”o_şª
;

1168 
šdex
 = 0;

1169 
z”o_şª
.
Çme
 = "zzzzzzzz";

1170 
couÁ
 = 
	`couÁ_şªs
();

1172 
šdex
 < 
couÁ
) {

1173 
aCÏn
[
šdex
] = &
z”o_şª
;

1174 
šdex
++;

1177 
şª
 = 
şª_bË_h—d
->
Ãxt
;

1178 
couÁ
 = 0;

1180 
şª
 !ğ
şª_bË_
) {

1181 ià(
şª
 =ğ
nuÎ±r
)

1184 ià(!
şª
->
šd•’d’t
)

1185 
aCÏn
[
couÁ
] = 
şª
;

1187 
şª
 = cÏn->
Ãxt
;

1188 
couÁ
++;

1191 
	`qsÜt
(
aCÏn
, 
couÁ
, ×CÏn[0]), 
com·»_şªs
);

1192 
couÁ
 = 0;

1193 
	`£t_cŞÜ
(
ch
, 
CYAN
, 
BOLD
);

1194 
	`¡c
("Cu¼’ˆCÏn oàLegacy:\n\n", 
ch
);

1195 
	`¡c
("CÏÀNam Ma Nam LogØ C»©Ü\n", 
ch
);

1196 
	`¡c
("----------------------------------------------------------------------\n", 
ch
);

1197 
	`£t_cŞÜ
(
ch
, 
CYAN
, 
NOBOLD
);

1199 
	`¡rcmp
(
aCÏn
[
couÁ
]->
Çme
, "zzzzzzzz")) {

1200 
	`±c
(
ch
, "%-34s{x%-14s{x%-9s{x %s{x\n",

1201 
aCÏn
[
couÁ
]->
şªÇme
,

1202 
aCÏn
[
couÁ
]->
Çme
,

1203 
aCÏn
[
couÁ
]->
who_Çme
,

1204 
aCÏn
[
couÁ
]->
ü—tÜ
);

1205 
couÁ
++;

1208 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1213 ià(!(
şª
 = 
	`şª_lookup
(
¬gum’t
))) {

1214 
	`¡c
("Th© i nÙ‡ cÏn.\n", 
ch
);

1218 ià(
	`db_qu”yf
("do_clanlist",

1219 "SELECT‚ame,™Ë,„ªk,†ev–,„emÜt, cgrou°FROM…c_šdex WHERE cÏÀLIKE '%s'", 
	`db_esc
(
şª
->
Çme
)è!ğ
SQL_OK
)

1222 
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

1223 
FÏgs
 
cgroup
 = 
	`db_g‘_cŞumn_æags
(5);

1224 
	`¡rıy
(
şª_li¡
[
couÁ
].
Çme
, 
	`db_g‘_cŞumn_¡r
(0));

1225 
	`¡rıy
(
şª_li¡
[
couÁ
].
t™Ë
, 
	`db_g‘_cŞumn_¡r
(1));

1226 
	`¡rıy
(
şª_li¡
[
couÁ
].
¿nk
, 
	`db_g‘_cŞumn_¡r
(2));

1227 
şª_li¡
[
couÁ
].
Ëv–
 = 
	`db_g‘_cŞumn_št
(3);

1228 
şª_li¡
[
couÁ
].
»mÜt
 = 
	`db_g‘_cŞumn_št
(4);

1229 
şª_li¡
[
couÁ
].
¡©us
 = 
cgroup
.
	`has
(
GROUP_LEADER
è? 2 : cgroup.has(
GROUP_DEPUTY
) ? 1 : 0;

1230 
şª_li¡
[
couÁ
].
´š‹d
 = 
çl£
;

1232 ià(
şª_li¡
[
couÁ
].
»mÜt
 > 
high»mÜt
)

1233 
high»mÜt
 = 
şª_li¡
[
couÁ
].
»mÜt
;

1235 ià(
şª_li¡
[
couÁ
].
Ëv–
 > 
highËv–
)

1236 
highËv–
 = 
şª_li¡
[
couÁ
].
Ëv–
;

1238 
couÁ
++;

1241 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("{VMemb” oà%s:\n\n", 
şª
->
şªÇme
);

1242 
FÜm©
::
	`¥rštf
(
rblock
, "{x");

1243 
FÜm©
::
	`¥rštf
(
lblock
, "{x");

1245 ià(
şª
->
šd•’d’t
)

1246 
r
 = 2;„ > -1;„--) {

1247 
i
 = 0; i < 
couÁ
; i++) {

1248 ià(
şª_li¡
[
i
].
´š‹d
 || cÏn_li¡[i].
¡©us
 !ğ
r
)

1251 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("%s[{G%3s%s] {W[ {CIMM {W] %s%s{x\n",

1252 
r
 == 2 ? "{Y" :„ == 1 ? "{B" : "{W",

1253 
şª_li¡
[
i
].
¿nk
,

1254 
r
 == 2 ? "{Y" :„ == 1 ? "{B" : "{W",

1255 
şª_li¡
[
i
].
Çme
,

1256 
şª_li¡
[
i
].
t™Ë
);

1257 
şª_li¡
[
i
].
´š‹d
 = 
Œue
;

1261 
r
 = 
high»mÜt
;„ > -1;„--) {

1262 
l
 = 
highËv–
;† > 0;†--) {

1263 
i
 = 0; i < 
couÁ
; i++) {

1264 ià(
şª_li¡
[
i
].
´š‹d
 =ğ
Œue


1265 || 
şª_li¡
[
i
].
Ëv–
 !ğ
l


1266 || (
şª_li¡
[
i
].
»mÜt
 !ğ
r


1267 && 
şª_li¡
[
i
].
Ëv–
 < 
LEVEL_IMMORTAL
))

1270 ià(
l
 < 
LEVEL_IMMORTAL
) {

1271 ià(
r
)

1272 
FÜm©
::
	`¥rštf
(
rblock
, "{G%2d{c/", 
r
);

1274 
FÜm©
::
	`¥rštf
(
rblock
, " ");

1276 
FÜm©
::
	`¥rštf
(
lblock
, "{W[%s{B%2d{W]", 
rblock
, 
l
);

1279 
FÜm©
::
	`¥rštf
(
lblock
, "{W[ {CIMM {W]");

1281 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("%s[{G%3s%s] %s %s%s{x\n",

1282 
şª_li¡
[
i
].
¡©us
 == 2 ? "{Y" :

1283 
şª_li¡
[
i
].
¡©us
 == 1 ? "{B" : "{W",

1284 
şª_li¡
[
i
].
¿nk
,

1285 
şª_li¡
[
i
].
¡©us
 == 2 ? "{Y" :

1286 
şª_li¡
[
i
].
¡©us
 == 1 ? "{B" : "{W",

1287 
lblock
,

1288 
şª_li¡
[
i
].
Çme
,

1289 
şª_li¡
[
i
].
t™Ë
);

1290 
şª_li¡
[
i
].
´š‹d
 = 
Œue
;

1295 ià(
couÁ
 == 0)

1296 
	`¡c
("-‚Ú-\n", 
ch
);

1298 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("\n{WTh”¬%d memb” oà%s{x.\n", 
couÁ
, 
şª
->
şªÇme
);

1299 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

1302 
	}
}

1307 
	$do_autŞi¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1310 ià(
ch
->
	`is_Åc
())

1313 
	`¡c
("‡ùiÚ stus\n", 
ch
);

1314 
	`¡c
("---------------------\n", 
ch
);

1315 
	`¡c
("autßssi¡ ", 
ch
);

1317 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOASSIST
))

1318 
	`¡c
("ON\n", 
ch
);

1320 
	`¡c
("OFF\n", 
ch
);

1322 
	`¡c
("autÛx™ ", 
ch
);

1324 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOEXIT
))

1325 
	`¡c
("ON\n", 
ch
);

1327 
	`¡c
("OFF\n", 
ch
);

1329 
	`¡c
("autogŞd ", 
ch
);

1331 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOGOLD
))

1332 
	`¡c
("ON\n", 
ch
);

1334 
	`¡c
("OFF\n", 
ch
);

1336 
	`¡c
("autŞoÙ ", 
ch
);

1338 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOLOOT
))

1339 
	`¡c
("ON\n", 
ch
);

1341 
	`¡c
("OFF\n", 
ch
);

1343 
	`¡c
("auto§ø ", 
ch
);

1345 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOSAC
))

1346 
	`¡c
("ON\n", 
ch
);

1348 
	`¡c
("OFF\n", 
ch
);

1350 
	`¡c
("auto¥l™ ", 
ch
);

1352 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOSPLIT
))

1353 
	`¡c
("ON\n", 
ch
);

1355 
	`¡c
("OFF\n", 
ch
);

1357 
	`¡c
("autÙick ", 
ch
);

1359 ià(
ch
->
aù_æags
.
	`has
(
PLR_TICKS
))

1360 
	`¡c
("ON\n", 
ch
);

1362 
	`¡c
("OFF\n", 
ch
);

1364 
	`¡c
("autÜeÿÎ ", 
ch
);

1366 ià(
ch
->
aù_æags
.
	`has
(
PLR_WIMPY
))

1367 
	`¡c
("ON\n", 
ch
);

1369 
	`¡c
("OFF\n", 
ch
);

1371 
	`¡c
("ch©mod ", 
ch
);

1373 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_CHATMODE
))

1374 
	`¡c
("ON\n", 
ch
);

1376 
	`¡c
("OFF\n", 
ch
);

1378 
	`¡c
("com·ù mod ", 
ch
);

1380 ià(
ch
->
comm_æags
.
	`has
(
COMM_COMPACT
))

1381 
	`¡c
("ON\n", 
ch
);

1383 
	`¡c
("OFF\n", 
ch
);

1385 
	`¡c
("´om± ", 
ch
);

1387 ià(
ch
->
comm_æags
.
	`has
(
COMM_PROMPT
))

1388 
	`¡c
("ON\n", 
ch
);

1390 
	`¡c
("OFF\n", 
ch
);

1392 
	`¡c
("show deãnsiv", 
ch
);

1394 ià(
ch
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
))

1395 
	`¡c
("OFF\n", 
ch
);

1397 
	`¡c
("ON\n", 
ch
);

1399 
	`¡c
("show RAfãù  ", 
ch
);

1401 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_SHOWRAFF
))

1402 
	`¡c
("ON\n", 
ch
);

1404 
	`¡c
("OFF\n", 
ch
);

1406 
	`¡c
("combš™em  ", 
ch
);

1408 ià(
ch
->
comm_æags
.
	`has
(
COMM_COMBINE
))

1409 
	`¡c
("ON\n", 
ch
);

1411 
	`¡c
("OFF\n", 
ch
);

1413 
	`¡c
("autİ“k ", 
ch
);

1415 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_AUTOPEEK
))

1416 
	`¡c
("ON\n", 
ch
);

1418 
	`¡c
("OFF\n", 
ch
);

1420 ià(
ch
->
pcd©a
) {

1421 
	`¡c
("showlo¡ ", 
ch
);

1423 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_SHOWLOST
))

1424 
	`¡c
("ON\n", 
ch
);

1426 
	`¡c
("OFF\n", 
ch
);

1428 
	`¡c
("æash mod ", 
ch
);

1430 ià(
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_FLASH_LINE
))

1431 
	`¡c
("UNDERLINE\n", 
ch
);

1432 ià(
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_FLASH_OFF
))

1433 
	`¡c
("OFF\n", 
ch
);

1435 
	`¡c
("ON\n", 
ch
);

1438 ià(!
ch
->
aù_æags
.
	`has
(
PLR_CANLOOT
))

1439 
	`¡c
("You¸cÜp£ i §ã fromh›ves.\n", 
ch
);

1441 
	`¡c
("You¸cÜp£ may bloÙed.\n", 
ch
);

1443 ià(
ch
->
aù_æags
.
	`has
(
PLR_NOSUMMON
))

1444 
	`¡c
("You cªnÙ bsummÚed.\n", 
ch
);

1446 
	`¡c
("You cª bsummÚed.\n", 
ch
);

1448 ià(
ch
->
aù_æags
.
	`has
(
PLR_NOFOLLOW
))

1449 
	`¡c
("You dØnÙ w–comfŞlow”s.\n", 
ch
);

1451 
	`¡c
("You‡cû± fŞlow”s.\n", 
ch
);

1453 ià(
ch
->
pcd©a
) {

1454 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_SHOWLOST
))

1455 
	`¡c
("You‡»‚Ùif›d‡bouˆlo¡ i‹m wh’ qu™šg.\n", 
ch
);

1457 
	`¡c
("You‡»‚Ù‚Ùif›d‡bouˆlo¡ i‹m wh’ qu™šg.\n", 
ch
);

1459 
	}
}

1462 
	$do_ùe¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1464 ià(
ch
->
	`is_Åc
())

1467 ià(
ch
->
aù_æags
.
	`has
(
PLR_COLOR
)) {

1468 
	`¡c
("CŞÜ cu¼’y u£d‡ˆLegacy:\n", 
ch
);

1469 
	`¡c
("\n", 
ch
);

1470 
	`¡c
("{WWHITE (Wè {gGREY (gè {e{WBG GREY (e){a\n", 
ch
);

1471 
	`¡c
("{PPINK (Pè {RRED (Rè {r{PBG RED (r){a\n", 
ch
);

1472 
	`¡c
("{YYELLOW (Yè {bBROWN (bè {y{YBG BROWN (y){a\n", 
ch
);

1473 
	`¡c
("{GGREEN (Gè {HHUNTER (Hè {h{GBG HUNTER (h){a\n", 
ch
);

1474 
	`¡c
("{CCYAN (Cè {TTURQUOISE (Tè {t{CBG TURQUOISE (t){a\n", 
ch
);

1475 
	`¡c
("{BBLUE (Bè {NNAVY (Nè {n{BBG NAVY (n){a\n", 
ch
);

1476 
	`¡c
("{VVIOLET (Vè {MMAROON (Mè {m{VBG MAROON (m){a\n", 
ch
);

1477 
	`¡c
("{cCHARCOAL (cè {kBLACK (kè {a{cBG BLACK (a){a\n", 
ch
);

1478 
	`¡c
("{PD{YE{GF{BA{MU{VL{WT {x(xè {fFLASHING (f){x {sREVERSE (s){x\n", 
ch
);

1481 
	`¡c
("You mu¡uº cŞÜ oÀtØ£this.\n", 
ch
);

1482 
	}
}

1484 
	$do_autßssi¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1486 ià(
ch
->
	`is_Åc
())

1489 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOASSIST
)) {

1490 
	`¡c
("Autßssi¡„emoved.\n", 
ch
);

1491 
ch
->
aù_æags
 -ğ
PLR_AUTOASSIST
;

1494 
	`¡c
("You wÈnow‡ssi¡ wh’‚“ded.\n", 
ch
);

1495 
ch
->
aù_æags
 +ğ
PLR_AUTOASSIST
;

1497 
	}
}

1499 
	$do_deãnsive
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1501 ià(
ch
->
	`is_Åc
())

1504 ià(
ch
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

1505 
	`¡c
("You wÈnow s“‡Î blocks.\n", 
ch
);

1506 
ch
->
aù_æags
 -ğ
PLR_DEFENSIVE
;

1509 
	`¡c
("You wÈnØlÚg” s“ deãnsivblocks.\n", 
ch
);

1510 
ch
->
aù_æags
 +ğ
PLR_DEFENSIVE
;

1512 
	}
}

1514 
	$do_autÛx™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1516 ià(
ch
->
	`is_Åc
())

1519 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOEXIT
)) {

1520 
	`¡c
("Ex™ wÈnØlÚg” bdi¥Ïyed.\n", 
ch
);

1521 
ch
->
aù_æags
 -ğ
PLR_AUTOEXIT
;

1524 
	`¡c
("Ex™ wÈnow bdi¥Ïyed.\n", 
ch
);

1525 
ch
->
aù_æags
 +ğ
PLR_AUTOEXIT
;

1527 
	}
}

1529 
	$do_autogŞd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1531 ià(
ch
->
	`is_Åc
())

1534 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOGOLD
)) {

1535 
	`¡c
("AutogŞd„emoved.\n", 
ch
);

1536 
ch
->
aù_æags
 -ğ
PLR_AUTOGOLD
;

1539 
	`¡c
("Autom©iøgŞd†oÙšg s‘.\n", 
ch
);

1540 
ch
->
aù_æags
 +ğ
PLR_AUTOGOLD
;

1542 
	}
}

1544 
	$do_autŞoÙ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1546 ià(
ch
->
	`is_Åc
())

1549 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOLOOT
)) {

1550 
	`¡c
("AutŞoÙšg„emoved.\n", 
ch
);

1551 
ch
->
aù_æags
 -ğ
PLR_AUTOLOOT
;

1554 
	`¡c
("Autom©iøcÜp£†oÙšg s‘.\n", 
ch
);

1555 
ch
->
aù_æags
 +ğ
PLR_AUTOLOOT
;

1557 
	}
}

1559 
	$do_auto§c
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1561 ià(
ch
->
	`is_Åc
())

1564 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOSAC
)) {

1565 
	`¡c
("Auto§üificšg„emoved.\n", 
ch
);

1566 
ch
->
aù_æags
 -ğ
PLR_AUTOSAC
;

1569 
	`¡c
("Autom©iøcÜp£ saüificšg s‘.\n", 
ch
);

1570 
ch
->
aù_æags
 +ğ
PLR_AUTOSAC
;

1572 
	}
}

1574 
	$do_auto¥l™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1576 ià(
ch
->
	`is_Åc
())

1579 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOSPLIT
)) {

1580 
	`¡c
("Auto¥l™tšg„emoved.\n", 
ch
);

1581 
ch
->
aù_æags
 -ğ
PLR_AUTOSPLIT
;

1584 
	`¡c
("Autom©iøgŞd s¶™tšg s‘.\n", 
ch
);

1585 
ch
->
aù_æags
 +ğ
PLR_AUTOSPLIT
;

1587 
	}
}

1589 
	$do_br›f
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1591 ià(
ch
->
comm_æags
.
	`has
(
COMM_BRIEF
)) {

1592 
	`¡c
("FuÎ desütiÚ aùiv©ed.\n", 
ch
);

1593 
ch
->
comm_æags
 -ğ
COMM_BRIEF
;

1596 
	`¡c
("ShÜˆdesütiÚ aùiv©ed.\n", 
ch
);

1597 
ch
->
comm_æags
 +ğ
COMM_BRIEF
;

1599 
	}
}

1601 
	$do_com·ù
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1603 ià(
ch
->
comm_æags
.
	`has
(
COMM_COMPACT
)) {

1604 
	`¡c
("Com·ù mod»moved.\n", 
ch
);

1605 
ch
->
comm_æags
 -ğ
COMM_COMPACT
;

1608 
	`¡c
("Com·ù mod£t.\n", 
ch
);

1609 
ch
->
comm_æags
 +ğ
COMM_COMPACT
;

1611 
	}
}

1613 
	$do_showæags
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1615 
buf
[
MAX_STRING_LENGTH
];

1616 
Ch¬aù”
 *
viùim
;

1617 
viùim
 = 
ch
;

1619 ià(
	`IS_IMMORTAL
(
ch
è&& !
¬gum’t
.
	`em±y
()) {

1620 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬gum’t
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

1621 
	`¡c
("You cªnÙ†oÿ‹h© ch¬aù”.\n", 
ch
);

1626 
	`£t_cŞÜ
(
ch
, 
YELLOW
, 
NOBOLD
);

1627 
FÜm©
::
	`¥rštf
(
buf
, "Aù : %s\n", 
	`aù_b™_Çme
(
viùim
->
aù_æags
, viùim->
	`is_Åc
()));

1628 
	`¡c
(
buf
, 
ch
);

1630 ià(!
viùim
->
	`is_Åc
()) {

1631 
FÜm©
::
	`¥rštf
(
buf
, "PÌ : %s\n", 
	`¶r_b™_Çme
(
viùim
->
pcd©a
->
¶r_æags
));

1632 
	`¡c
(
buf
, 
ch
);

1635 ià(
viùim
->
	`is_Åc
()) {

1636 
FÜm©
::
	`¥rštf
(
buf
, "Ofà : %s\n", 
	`off_b™_Çme
(
viùim
->
off_æags
));

1637 
	`¡c
(
buf
, 
ch
);

1640 ià(!
viùim
->
	`is_Åc
()) {

1641 
FÜm©
::
	`¥rštf
(
buf
, "Wiz : %s\n", 
	`wiz_b™_Çme
(
viùim
->
wizÃt_æags
));

1642 
	`¡c
(
buf
, 
ch
);

1645 
	`±c
(
ch
, "Afà : %s\n", 
afãù
::
	`´št_ÿche
(
viùim
));

1646 
	`±c
(
ch
, "Dº : %s\n", 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_ABSORB
));

1647 
	`±c
(
ch
, "Imm : %s\n", 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_IMMUNE
));

1648 
	`±c
(
ch
, "Re  : %s\n", 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_RESIST
));

1649 
	`±c
(
ch
, "VuÊ : %s\n", 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_VULN
));

1650 
	`±c
(
ch
, "FÜm : %s\n", 
	`fÜm_b™_Çme
(
viùim
->
fÜm_æags
));

1651 
	`±c
(
ch
, "P¬ts: %s\n", 
	`·¹_b™_Çme
(
viùim
->
·¹s_æags
));

1652 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1654 
	}
}

1656 
	$do_show
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1658 ià(
ch
->
comm_æags
.
	`has
(
COMM_SHOW_AFFECTS
)) {

1659 
	`¡c
("Afãù wÈnØlÚg” bshowÀš scÜe.\n", 
ch
);

1660 
ch
->
comm_æags
 -ğ
COMM_SHOW_AFFECTS
;

1663 
	`¡c
("Afãù wÈnow bshowÀš scÜe.\n", 
ch
);

1664 
ch
->
comm_æags
 +ğ
COMM_SHOW_AFFECTS
;

1666 
	}
}

1668 
	#MAX_PROMPT_LEN
 300

	)

1669 
	$do_´om±
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1671 
SŒšg
 
buf
;

1673 ià(
¬gum’t
.
	`em±y
()) {

1674 ià(
ch
->
comm_æags
.
	`has
(
COMM_PROMPT
)) {

1675 
	`¡c
("You wÈnØlÚg” s“…rom±s.\n", 
ch
);

1676 
ch
->
comm_æags
 -ğ
COMM_PROMPT
;

1679 
	`¡c
("You wÈnow s“…rom±s.\n", 
ch
);

1680 
ch
->
comm_æags
 +ğ
COMM_PROMPT
;

1686 ià(!
	`¡rcmp
(
¬gum’t
, "default"))

1687 
buf
 = "{W<{C%h{Thp {G%m{Hma {B%v{Nst {W[{g%e{W] {R%X{W>{x ";

1688 ià(!
	`¡rcmp
(
¬gum’t
, "short"))

1689 
buf
 = "{W<{C%h{Thp {G%m{Hma {B%v{Nst{W>{x ";

1690 ià(!
	`¡rcmp
(
¬gum’t
, "long"))

1691 
buf
 = "{W<{C%h{g/{C%H{Thp {G%m{g/{G%M{Hma {B%v{Nst {W[{c%e{W] {Y%g{C/{g%s {W( {g%z {W) {R%X{W>{x ";

1692 ià(!
	`¡rcmp
(
¬gum’t
, "riches"))

1693 
buf
 = "{W<{C%h{g/{C%H{Thp {G%m{g/{G%M{Hma {B%v{Nst {W[{g%e{W] {Y%g{bg {W%s{gs{W>{x ";

1694 ià(!
	`¡rcmp
(
¬gum’t
, "immortal"))

1695 
buf
 = "{W<{Y({W%R{Y) {T-{C%r{T- {H[{G%e{H] {W%z {N[{B%w{N]{W>{x ";

1696 ià(!
	`¡rcmp
(
¬gum’t
, "align"))

1697 
buf
 = "{W<{C%h{g/{C%H{Thp {G%m{g/{G%M{Hma {B%v{Nst {W[{c%e{W] {R%X {V({M%a{V){W>{x ";

1698 ià(!
	`¡rcmp
(
¬gum’t
, "quest"))

1699 
buf
 = "{W<{C%h{g/{C%H{Thp {G%m{g/{G%M{Hma {B%v{Nst {Y({b%Q %q{Y){W>{x ";

1701 
buf
 +ğ
¬gum’t
;

1702 
buf
.
	`”a£
(
MAX_PROMPT_LEN
);

1704 ià(
buf
.
	`has_suffix
("%c"))

1705 
buf
 += " ";

1708 
ch
->
´om±
 = 
buf
;

1709 
FÜm©
::
	`¥rštf
(
buf
, "Prom± s‘Ø%s\n", 
ch
->
´om±
);

1710 
	`¡c
(
buf
, 
ch
);

1711 
	}
}

1713 
	$do_combše
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1715 ià(
ch
->
comm_æags
.
	`has
(
COMM_COMBINE
)) {

1716 
	`¡c
("LÚg inv’tÜy s–eùed.\n", 
ch
);

1717 
ch
->
comm_æags
 -ğ
COMM_COMBINE
;

1720 
	`¡c
("Combšed inv’tÜy s–eùed.\n", 
ch
);

1721 
ch
->
comm_æags
 +ğ
COMM_COMBINE
;

1723 
	}
}

1725 
	$do_showlo¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1727 ià(
ch
->
	`is_Åc
())

1730 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_SHOWLOST
)) {

1731 
	`¡c
("You wÈnØlÚg” bnÙif›d oàlo¡ i‹ms.\n", 
ch
);

1732 
ch
->
pcd©a
->
¶r_æags
 -ğ
PLR_SHOWLOST
;

1735 
	`¡c
("You wÈnow bnÙif›d oàlo¡ i‹ms.\n", 
ch
);

1736 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_SHOWLOST
;

1738 
	}
}

1740 
	$do_nŞoÙ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1742 ià(
ch
->
	`is_Åc
())

1745 ià(
ch
->
aù_æags
.
	`has
(
PLR_CANLOOT
)) {

1746 
	`¡c
("You¸cÜp£ i now saã fromh›ves.\n", 
ch
);

1747 
ch
->
aù_æags
 -ğ
PLR_CANLOOT
;

1750 
	`¡c
("You¸cÜp£ may‚ow bloÙed.\n", 
ch
);

1751 
ch
->
aù_æags
 +ğ
PLR_CANLOOT
;

1753 
	}
}

1755 
	$do_nofŞlow
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1757 ià(
ch
->
	`is_Åc
())

1760 ià(
ch
->
aù_æags
.
	`has
(
PLR_NOFOLLOW
)) {

1761 
	`¡c
("You‚ow‡cû± fŞlow”s.\n", 
ch
);

1762 
ch
->
aù_æags
 -ğ
PLR_NOFOLLOW
;

1765 
	`¡c
("You‚ØlÚg”‡cû± fŞlow”s.\n", 
ch
);

1766 
ch
->
aù_æags
 +ğ
PLR_NOFOLLOW
;

1767 
	`d›_fŞlow”
(
ch
);

1769 
	}
}

1771 
	$do_nosummÚ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1773 ià(
ch
->
aù_æags
.
	`has
(
PLR_NOSUMMON
)) {

1774 
	`¡c
("You‡»‚ØlÚg” immuÃØsummÚ.\n", 
ch
);

1775 
ch
->
aù_æags
 -ğ
PLR_NOSUMMON
;

1778 
	`¡c
("You‡»‚ow immuÃØsummÚšg.\n", 
ch
);

1779 
ch
->
aù_æags
 +ğ
PLR_NOSUMMON
;

1781 
	}
}

1783 
	$do_look
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1785 
buf
 [
MAX_STRING_LENGTH
];

1786 
Ex™
 *
³x™
;

1787 
Ch¬aù”
 *
viùim
;

1788 
Objeù
 *
obj
;

1789 cÚ¡ 
ExŒaDesü
 *
pdesc
;

1790 
doÜ
;

1791 
numb”
, 
couÁ
;

1793 ià(
ch
->
desc
 =ğ
nuÎ±r
)

1796 ià(
	`g‘_pos™iÚ
(
ch
è< 
POS_SLEEPING
) {

1797 
	`¡c
("You cª'ˆ£ªythšg!\n", 
ch
);

1801 ià(
	`g‘_pos™iÚ
(
ch
è=ğ
POS_SLEEPING
) {

1802 
	`¡c
("You cª'ˆ£ªythšg, you'» sË•šg!\n", 
ch
);

1806 ià(!
	`check_blšd
(
ch
))

1809 ià(!
	`ÿn_£e_š_room
(
ch
, ch->
š_room
)) {

1810 
	`¡c
("Iˆi p™ch bÏck ... \n", 
ch
);

1811 
	`show_ch¬_to_ch¬
(
ch
->
š_room
->
³İË
, ch);

1815 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
;

1816 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

1817 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

1818 
numb”
 = 
	`numb”_¬gum’t
(
¬g1
, 
¬g3
);

1819 
couÁ
 = 0;

1821 ià(
¬g1
.
	`em±y
() ||‡rg1 == "auto") {

1822 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

1825 
¡d
::
veùÜ
<
SŒšg
> 
mšim­
;

1826 
Game
::
	`wÜld
().
	`g‘_mšim­
(
ch
, 
mšim­
);

1827 
m­_lše
 = 0;

1829 ià(
mšim­
.
	`size
(è> 
m­_lše
)

1830 
	`¡c
(
mšim­
[
m­_lše
++] + " ", 
ch
);

1833 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_ROOM
);

1834 
	`¡c
(
ch
->
š_room
->
	`Çme
(), ch);

1835 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1837 ià(
	`IS_IMMORTAL
(
ch
)) {

1838 
FÜm©
::
	`¥rštf
(
buf
, " [%s] (%s) (%d)",

1839 
ch
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(),

1840 
ch
->
š_room
->
	`¬—
().
Çme
,

1841 
ch
->
š_room
->
	`¬—
().
	`num_¶ay”s
());

1842 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
BOLD
);

1843 
	`¡c
(
buf
, 
ch
);

1844 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1847 
	`¡c
("\n", 
ch
);

1849 
SŒšg
 
‹xt
;

1851 ià(
¬g1
.
	`em±y
()

1852 || (!
ch
->
	`is_Åc
(è&& !ch->
comm_æags
.
	`has
(
COMM_BRIEF
))) {

1853 
‹xt
 = " " + 
ch
->
š_room
->
	`desütiÚ
();

1856 ià(!
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
PLR_AUTOEXIT
)) {

1857 
‹xt
 +ğ"\n" + 
	`li¡_ex™s
(
ch
, 
Œue
);

1860 
¡d
::
i¡ršg¡»am
 
	`‹xt¡»am
(
‹xt
);

1861 
SŒšg
 
lše
;

1863 
¡d
::
	`g‘lše
(
‹xt¡»am
, 
lše
)) {

1864 ià(
mšim­
.
	`size
(è> 
m­_lše
)

1865 
	`¡c
(
mšim­
[
m­_lše
++] + " ", 
ch
);

1867 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1868 
	`¡c
(
lše
 + "\n", 
ch
);

1871 
mšim­
.
	`size
(è> 
m­_lše
)

1872 
	`¡c
(
mšim­
[
m­_lše
++] + "\n", 
ch
);

1874 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_OBJECTS
);

1875 
	`show_li¡_to_ch¬
(
ch
->
š_room
->
cÚ‹Ás
, ch, 
çl£
, false, false);

1876 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1877 
	`show_ch¬_to_ch¬
(
ch
->
š_room
->
³İË
, ch);

1883 
Du–
 *
du–
 = 
du–_bË_h—d
->
Ãxt
;

1885 
du–
 !ğ
du–_bË_
) {

1886 ià(
du–
->
acû±_tim”
 =ğ0 && 
ch
->
š_room
 =ğdu–->
¬’a
->
v›wroom
)

1889 
du–
 = du–->
Ãxt
;

1892 ià(
du–
 !ğ
du–_bË_


1893 && 
du–
->
ch®Ëng”
 !ğ
nuÎ±r


1894 && 
du–
->
deãnd”
 !ğ
nuÎ±r


1895 && 
ch
 !ğ
du–
->
ch®Ëng”


1896 && 
ch
 !ğ
du–
->
deãnd”
) {

1897 ià(
	`ÿn_£e_ch¬
(
ch
, 
du–
->
ch®Ëng”
)

1898 && !
du–
->
ch®Ëng”
->
š_room
->
	`æags
().
	`has
(
ROOM_NOWHERE
)

1899 && 
¬g1
.
	`is_´efix_of
(
du–
->
ch®Ëng”
->
Çme
)) {

1900 
	`ch¬_äom_room
(
ch
);

1901 
	`ch¬_to_room
(
ch
, 
du–
->
ch®Ëng”
->
š_room
);

1902 
	`do_look
(
ch
, "");

1903 
	`ch¬_äom_room
(
ch
);

1904 
	`ch¬_to_room
(
ch
, 
du–
->
¬’a
->
v›wroom
);

1908 ià(
	`ÿn_£e_ch¬
(
ch
, 
du–
->
deãnd”
)

1909 && !
du–
->
deãnd”
->
š_room
->
	`æags
().
	`has
(
ROOM_NOWHERE
)

1910 && 
¬g1
.
	`is_´efix_of
(
du–
->
deãnd”
->
Çme
)) {

1911 
	`ch¬_äom_room
(
ch
);

1912 
	`ch¬_to_room
(
ch
, 
du–
->
deãnd”
->
š_room
);

1913 
	`do_look
(
ch
, "");

1914 
	`ch¬_äom_room
(
ch
);

1915 
	`ch¬_to_room
(
ch
, 
du–
->
¬’a
->
v›wroom
);

1921 ià(
¬g1
 == "i" ||‡rg1 == "in" ||‡rg1 == "inside" ||‡rg1 == "on") {

1922 
Room
 *
loÿtiÚ
;

1925 ià(
¬g2
.
	`em±y
()) {

1926 
	`¡c
("Look iÀwh©?\n", 
ch
);

1931 ià(
¬g2
.
	`is_´efix_of
("lock”"è&& !
ch
->
	`is_Åc
()) {

1932 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_LOCKER
)) {

1933 
	`¡c
("You¸lock” cÚšs:\n", 
ch
);

1934 
ch
->
aù_æags
 +ğ
PLR_LOOKINPIT
;

1935 
	`show_li¡_to_ch¬
(
ch
->
pcd©a
->
lock”
, ch, 
Œue
,rue, 
çl£
);

1936 
ch
->
aù_æags
 -ğ
PLR_LOOKINPIT
;

1939 
	`¡c
("You dØnÙ s“h© h”e.\n", 
ch
);

1945 ià(!
ch
->
	`is_Åc
(è&& 
¬g2
.
	`is_´efix_of
("strongbox")) {

1946 ià(!
	`IS_HEROIC
(
ch
)) {

1947 
	`¡c
("OÆy h”Û ªd fÜm” h”Û hav¨¡rÚgbox.\n", 
ch
);

1951 ià(
ch
->
š_room
 && ch->š_room->
loÿtiÚ
 =ğ
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_STRONGBOX
))) {

1952 
	`¡c
("You¸¡rÚgbox cÚšs:\n", 
ch
);

1953 
ch
->
aù_æags
 +ğ
PLR_LOOKINPIT
;

1954 
	`show_li¡_to_ch¬
(
ch
->
pcd©a
->
¡rÚgbox
, ch, 
Œue
,rue, 
çl£
);

1955 
ch
->
aù_æags
 -ğ
PLR_LOOKINPIT
;

1958 
	`¡c
("You dØnÙ s“h© h”e.\n", 
ch
);

1963 ià((
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬g2
)è=ğ
nuÎ±r
) {

1964 
	`¡c
("You dØnÙ s“h© h”e.\n", 
ch
);

1977 
obj
->
™em_ty³
) {

1979 ià(!
	`IS_OBJ_STAT
(
obj
, 
ITEM_COMPARTMENT
è&& !obj->
cÚšs
)

1980 
	`¡c
("Th© i nÙ‡ cÚš”.\n", 
ch
);

1984 
ITEM_DRINK_CON
:

1985 ià(
obj
->
v®ue
[1] <ğ0 && !obj->
cÚšs
) {

1986 
	`¡c
("Iˆi em±y.\n", 
ch
);

1990 
	`±c
(
ch
, "It's %sfilled with‡ %s†iquid.\n",

1991 
obj
->
v®ue
[1] < obj->value[0] / 4 ? "lesshan half-" :

1992 
obj
->
v®ue
[1] < 3 * obj->value[0] / 4 ? "about half-" :

1994 
liq_bË
[
obj
->
v®ue
[2]].
cŞÜ
);

1997 
ITEM_CONTAINER
:

1998 
ITEM_CORPSE_NPC
:

1999 
ITEM_CORPSE_PC
:

2000 ià(
obj
->
v®ue
[1].
	`æags
().
	`has
(
CONT_CLOSED
)) {

2001 
	`¡c
("Iˆi şo£d.\n", 
ch
);

2005 ià(
obj
 =ğ
Game
::
	`wÜld
().
dÚ©iÚ_p™
)

2006 
ch
->
aù_æags
 +ğ
PLR_LOOKINPIT
;

2008 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_OBJECTS
);

2009 
	`aù
("$°hŞds:", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2010 
	`show_li¡_to_ch¬
(
obj
->
cÚšs
, 
ch
, 
Œue
,rue, 
çl£
);

2011 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2013 ià(
obj
 =ğ
Game
::
	`wÜld
().
dÚ©iÚ_p™
)

2014 
ch
->
aù_æags
 -ğ
PLR_LOOKINPIT
;

2018 
ITEM_PORTAL
:

2019 ià((
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(()
obj
->
v®ue
[3]))è=ğ
nuÎ±r
) {

2020 ià(!
obj
->
cÚšs
)

2021 
	`¡c
("Iˆlook v”yƒm±y..\n", 
ch
);

2026 
	`¡c
("\n", 
ch
);

2027 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_ROOM
);

2028 
	`¡c
(
loÿtiÚ
->
	`Çme
(), 
ch
);

2029 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2031 ià(
	`IS_IMMORTAL
(
ch
)) {

2032 
FÜm©
::
	`¥rštf
(
buf
, " [Room %s]", 
loÿtiÚ
->loÿtiÚ.
	`to_¡ršg
());

2033 
	`£t_cŞÜ
(
ch
, 
RED
, 
NOBOLD
);

2034 
	`¡c
(
buf
, 
ch
);

2035 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2038 
	`¡c
("\n", 
ch
);

2040 ià(!
ch
->
	`is_Åc
(è&& !ch->
comm_æags
.
	`has
(
COMM_BRIEF
)) {

2041 
	`¡c
(" ", 
ch
);

2042 
	`¡c
(
loÿtiÚ
->
	`desütiÚ
(), 
ch
);

2045 
	`¡c
("\n", 
ch
);

2047 ià(!
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
PLR_AUTOEXIT
)) {

2048 
showex™
[100];

2049 
FÜm©
::
	`¥rštf
(
showex™
, "% ex™ auto", 
loÿtiÚ
->loÿtiÚ.
	`to_¡ršg
());

2050 
	`do_©
(
ch
, 
showex™
);

2053 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_OBJECTS
);

2054 
	`show_li¡_to_ch¬
(
loÿtiÚ
->
cÚ‹Ás
, 
ch
, 
çl£
, false, false);

2055 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2056 
	`show_ch¬_to_ch¬
(
loÿtiÚ
->
³İË
, 
ch
);

2060 ià(
obj
->
™em_ty³
 !ğ
ITEM_CONTAINER


2061 && 
obj
->
™em_ty³
 !ğ
ITEM_CORPSE_NPC


2062 && 
obj
->
™em_ty³
 !ğ
ITEM_CORPSE_PC


2063 && (
	`IS_OBJ_STAT
(
obj
, 
ITEM_COMPARTMENT
è|| obj->
cÚšs
)) {

2064 ià(!
	`IS_OBJ_STAT
(
obj
, 
ITEM_COMPARTMENT
è&& !IS_OBJ_STAT(obj, 
ITEM_TRANSPARENT
))

2065 
	`¡c
("Thsurçû i İaque.\n", 
ch
);

2067 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_OBJECTS
);

2068 
	`aù
("$°hŞds:", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2069 
	`show_li¡_to_ch¬
(
obj
->
cÚšs
, 
ch
, 
Œue
,rue, 
çl£
);

2070 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2077 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g1
, 
VIS_CHAR
)è!ğ
nuÎ±r
) {

2078 
	`show_ch¬_to_ch¬_1
(
viùim
, 
ch
);

2082 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
) {

2083 ià(
	`ÿn_£e_obj
(
ch
, 
obj
)) {

2085 
pdesc
 = 
	`g‘_exŒa_desü
(
¬g3
, 
obj
->
exŒa_desü
);

2087 ià(
pdesc
 !ğ
nuÎ±r
) {

2088 ià(++
couÁ
 =ğ
numb”
) {

2089 
	`¡c
(
pdesc
->
desütiÚ
, 
ch
);

2095 
pdesc
 = 
	`g‘_exŒa_desü
(
¬g3
, 
obj
->
pIndexD©a
->
exŒa_desü
);

2097 ià(
pdesc
 !ğ
nuÎ±r
) {

2098 ià(++
couÁ
 =ğ
numb”
) {

2099 
	`¡c
(
pdesc
->
desütiÚ
, 
ch
);

2105 ià(
obj
->
Çme
.
	`has_wÜds
(
¬g3
)) {

2106 ià(++
couÁ
 =ğ
numb”
) {

2107 
	`¡c
(
obj
->
desütiÚ
, 
ch
);

2108 
	`¡c
("\n", 
ch
);

2115 
obj
 = 
ch
->
š_room
->
cÚ‹Ás
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
) {

2116 ià(
	`ÿn_£e_obj
(
ch
, 
obj
)) {

2117 
pdesc
 = 
	`g‘_exŒa_desü
(
¬g3
, 
obj
->
exŒa_desü
);

2119 ià(
pdesc
 !ğ
nuÎ±r
) {

2120 ià(++
couÁ
 =ğ
numb”
) {

2121 
	`¡c
(
pdesc
->
desütiÚ
, 
ch
);

2128 
pdesc
 = 
	`g‘_exŒa_desü
(
¬g3
, 
obj
->
pIndexD©a
->
exŒa_desü
);

2130 ià(
pdesc
 !ğ
nuÎ±r
) {

2131 ià(++
couÁ
 =ğ
numb”
) {

2132 
	`¡c
(
pdesc
->
desütiÚ
, 
ch
);

2140 ià(
obj
->
Çme
.
	`has_wÜds
(
¬g3
))

2141 ià(++
couÁ
 =ğ
numb”
) {

2142 
	`¡c
(
obj
->
desütiÚ
, 
ch
);

2143 
	`¡c
("\n", 
ch
);

2148 
pdesc
 = 
	`g‘_exŒa_desü
(
¬g3
, 
ch
->
š_room
->
	`exŒa_desü
());

2150 ià(
pdesc
 !ğ
nuÎ±r
) {

2151 ià(++
couÁ
 =ğ
numb”
) {

2152 
	`¡c
(
pdesc
->
desütiÚ
, 
ch
);

2157 ià(
couÁ
 > 0 && couÁ !ğ
numb”
) {

2158 ià(
couÁ
 == 1)

2159 
FÜm©
::
	`¥rštf
(
buf
, "You oÆy s“ oÃ % h”e.\n", 
¬g3
);

2161 
FÜm©
::
	`¥rštf
(
buf
, "You oÆy s“ %d oàtho£ h”e.\n", 
couÁ
);

2163 
	`¡c
(
buf
, 
ch
);

2167 ià(
¬g1
 =ğ"n" ||‡rg1 =ğ"nÜth"è
doÜ
 = 0;

2168 ià(
¬g1
 =ğ"e" ||‡rg1 =ğ"—¡"è
doÜ
 = 1;

2169 ià(
¬g1
 =ğ"s" ||‡rg1 =ğ"south"è
doÜ
 = 2;

2170 ià(
¬g1
 =ğ"w" ||‡rg1 =ğ"we¡"è
doÜ
 = 3;

2171 ià(
¬g1
 =ğ"u" ||‡rg1 =ğ"up"è
doÜ
 = 4;

2172 ià(
¬g1
 =ğ"d" ||‡rg1 =ğ"down"è
doÜ
 = 5;

2174 
	`¡c
("You dØnÙ s“h© h”e.\n", 
ch
);

2179 ià((
³x™
 = 
ch
->
š_room
->
ex™
[
doÜ
]è=ğ
nuÎ±r
) {

2180 
	`¡c
("NÙhšg s³cŸÈth”e.\n", 
ch
);

2184 ià(!
³x™
->
	`desütiÚ
().
	`em±y
())

2185 
	`¡c
(
³x™
->
	`desütiÚ
(), 
ch
);

2187 
	`¡c
("NÙhšg s³cŸÈth”e.\n", 
ch
);

2189 ià(!
³x™
->
	`keywÜd
().
	`em±y
()

2190 && 
³x™
->
	`keywÜd
()[0] != ' ') {

2191 ià(
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
))

2192 
	`aù
("Th$d i şo£d.", 
ch
, 
nuÎ±r
, 
³x™
->
	`keywÜd
(), 
TO_CHAR
);

2193 ià(
³x™
->
ex™_æags
.
	`has
(
EX_ISDOOR
))

2194 
	`aù
("Th$d i İ’.", 
ch
, 
nuÎ±r
, 
³x™
->
	`keywÜd
(), 
TO_CHAR
);

2198 
	}
}

2200 
	$do_examše
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2202 
buf
[
MAX_STRING_LENGTH
];

2203 
Objeù
 *
obj
;

2205 ià(
¬gum’t
.
	`em±y
()) {

2206 
	`¡c
("Examšwh©?\n", 
ch
);

2210 
SŒšg
 
¬g
;

2211 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

2214 ià(
¬gum’t
.
	`is_´efix_of
("locker"))

2215 
¬g
 = "in†ocker";

2217 ià(
¬gum’t
.
	`is_´efix_of
("strongbox"))

2218 
¬g
 = "in strongbox";

2220 
	`do_look
(
ch
, 
¬g
);

2222 ià((
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬g
)è!ğ
nuÎ±r
) {

2223 
obj
->
™em_ty³
) {

2225 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_COMPARTMENT
è|| obj->
cÚšs
) {

2226 
FÜm©
::
	`¥rštf
(
buf
, "š %s", 
¬gum’t
);

2227 
	`do_look
(
ch
, 
buf
);

2232 
ITEM_JUKEBOX
:

2233 
	`do_¶ay
(
ch
, "list");

2236 
ITEM_MONEY
:

2237 ià(
obj
->
v®ue
[0] == 0) {

2238 ià(
obj
->
v®ue
[1] == 0)

2239 
FÜm©
::
	`¥rštf
(
buf
, "Odd...there's‚o coins inhe…ile.\n");

2240 ià(
obj
->
v®ue
[1] == 1)

2241 
FÜm©
::
	`¥rštf
(
buf
, "Wow. One gold coin.\n");

2243 
FÜm©
::
	`¥rštf
(
buf
, "Th”¬%d gŞd coš šhpe.\n", 
obj
->
v®ue
[1]);

2245 ià(
obj
->
v®ue
[1] == 0) {

2246 ià(
obj
->
v®ue
[0] == 1)

2247 
FÜm©
::
	`¥rštf
(
buf
, "Wow. One silver coin.\n");

2249 
FÜm©
::
	`¥rštf
(
buf
, "Th”¬%d sv” coš šhpe.\n", 
obj
->
v®ue
[0]);

2252 
FÜm©
::
	`¥rštf
(
buf
, "There‡re %d gold‡nd %d silver coins inhe…ile.\n",

2253 
obj
->
v®ue
[1], obj->value[0]);

2255 
	`¡c
(
buf
, 
ch
);

2258 
ITEM_PORTAL
:

2259 
ITEM_DRINK_CON
:

2260 
ITEM_CONTAINER
:

2261 
ITEM_CORPSE_NPC
:

2262 
ITEM_CORPSE_PC
:

2263 
FÜm©
::
	`¥rštf
(
buf
, "š %s", 
¬gum’t
);

2264 
	`do_look
(
ch
, 
buf
);

2268 
	}
}

2274 
	$ex™s_š
(
Ch¬aù”
 *
ch
)

2276 
Ex™
 *
ex™
;

2277 
Objeù
 *
obj
;

2278 
SŒšg
 
ouut
;

2279 
buf
[1024];

2280 
boŞ
 
found
 = 
çl£
;

2282 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

2285 cÚ¡‡uto& 
¬—_·œ
 : 
Game
::
	`wÜld
().
¬—s
) {

2286 cÚ¡‡uto& 
·œ
 : 
¬—_·œ
.
£cÚd
->
rooms
) {

2287 cÚ¡ 
Room
 *
room
 = 
·œ
.
£cÚd
;

2289 
i
 = 0; i < 6; i++) {

2290 
ex™
 = 
room
->ex™[
i
];

2292 ià(
ex™
 =ğ
nuÎ±r
)

2295 ià(
ex™
->
to_room
 =ğ
nuÎ±r
)

2298 ià(
ex™
->
to_room
 =ğ
ch
->
š_room
) {

2299 
found
 = 
Œue
;

2300 
FÜm©
::
	`¥rštf
(
buf
, "( %-6.6s ) from %s (%s) in (%s)\n",

2301 
Ex™
::
	`dœ_Çme
(
i
),

2302 
room
->
	`Çme
(),

2303 
room
->
loÿtiÚ
.
	`to_¡ršg
(),

2304 
room
->
	`¬—
().
Çme
);

2305 
ouut
 +ğ
buf
;

2311 ià(!
found
)

2312 
ouut
 += "No„ooms†ead intohis one.\n";

2314 
found
 = 
çl£
;

2316 
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt
) {

2317 ià(
obj
->
™em_ty³
 =ğ
ITEM_PORTAL
) {

2318 ià(
obj
->
š_room
 =ğ
nuÎ±r
)

2321 ià(
	`LoÿtiÚ
(()
obj
->
v®ue
[3].
	`v®ue
()è=ğ
ch
->
š_room
->
loÿtiÚ
) {

2322 
found
 = 
Œue
;

2323 
FÜm©
::
	`¥rštf
(
buf
, "( Portal ) %s in %s (%s) in (%s)\n",

2324 
obj
->
Çme
,

2325 
obj
->
š_room
->
	`Çme
(),

2326 
obj
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(),

2327 
obj
->
š_room
->
	`¬—
().
Çme
);

2328 
ouut
 +ğ
buf
;

2333 ià(!
found
)

2334 
ouut
 += "No…ortals foundhat†ead intohis„oom.\n";

2336 
	`·ge_to_ch¬
(
ouut
, 
ch
);

2337 
	}
}

2339 cÚ¡ 
SŒšg
 
	$li¡_ex™s
(
Ch¬aù”
 *
ch
, 
boŞ
 
fAuto
) {

2340 
SŒšg
 
buf
;

2342 ià(
fAuto
)

2343 
FÜm©
::
	`¥rštf
(
buf
, "[Exits:");

2344 ià(
	`IS_IMMORTAL
(
ch
))

2345 
FÜm©
::
	`¥rštf
(
buf
, "Obviou ex™ äom„oom %s:\n", 
ch
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
());

2347 
FÜm©
::
	`¥rštf
(
buf
, "Obviousƒxits:\n");

2349 
boŞ
 
found
 = 
çl£
;

2351 
doÜ
 = 0; door <= 5; door++) {

2352 cÚ¡ 
Ex™
 *
³x™
;

2354 ià((
³x™
 = 
ch
->
š_room
->
ex™
[
doÜ
]è!ğ
nuÎ±r


2355 && 
³x™
->
to_room
 !ğ
nuÎ±r


2356 && 
	`ÿn_£e_room
(
ch
, 
³x™
->
to_room
)) {

2359 
found
 = 
Œue
;

2361 ià(
fAuto
) {

2362 
buf
 += " ";

2363 ià(
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
))

2364 
buf
 +ğ
FÜm©
::
	`fÜm©
("{Y(%s){x", 
Ex™
::
	`dœ_Çme
(
doÜ
));

2366 
buf
 +ğ
Ex™
::
	`dœ_Çme
(
doÜ
);

2369 
buf
 +ğ
FÜm©
::
	`fÜm©
("%-5 - ", 
Ex™
::
	`dœ_Çme
(
doÜ
).
	`ÿp™®ize
());

2371 ià(
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
))

2372 
buf
 += "{Y(closed){x";

2373 ià((
³x™
->
to_room
->
	`is_d¬k
(è&& !
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
night_visiÚ
))

2374 || 
³x™
->
to_room
->
	`is_v”y_d¬k
())

2375 
buf
 += "{cToo darkoell{x";

2377 
buf
 +ğ
³x™
->
to_room
->
	`Çme
();

2379 ià(
	`IS_IMMORTAL
(
ch
))

2380 
buf
 +ğ
FÜm©
::
	`fÜm©
(" (room %s)\n", 
³x™
->
to_room
->
loÿtiÚ
.
	`to_¡ršg
());

2382 
buf
 += "\n";

2387 ià(!
found
)

2388 
buf
 +ğ
fAuto
 ? "‚one" : "None.\n";

2390 ià(
fAuto
)

2391 
buf
 += "]\n";

2393  
buf
;

2394 
	}
}

2398 
	$do_ex™s
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2400 ià(!
	`check_blšd
(
ch
))

2403 ià(
¬gum’t
 =ğ"š" && 
	`IS_IMMORTAL
(
ch
)) {

2404 
	`ex™s_š
(
ch
);

2408 
boŞ
 
fAuto
 = 
¬gum’t
 == "auto";

2409 
SŒšg
 
buf
 = 
	`li¡_ex™s
(
ch
, 
fAuto
);

2411 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
BOLD
);

2412 
	`¡c
(
buf
, 
ch
);

2413 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2415 
	}
}

2417 
	$do_wÜth
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2419 ià(
ch
->
	`is_Åc
()) {

2420 
	`±c
(
ch
, "You hav%ld gŞd‡nd %ld sv”.\n", ch->
gŞd
, ch->
sv”
);

2424 ià(
ch
->
Ëv–
 < 
LEVEL_HERO
)

2425 
	`±c
(
ch
, "You have %ld gold, %ld silver,‡nd %dƒxperience (%ldƒxpo†evel).\n",

2426 
ch
->
gŞd
, ch->
sv”
, ch->
exp
, (ch->
Ëv–
 + 1è* 
	`exp_³r_Ëv–
(ch, ch->
pcd©a
->
pošts
) - ch->exp);

2428 
	`±c
(
ch
, "You hav%ld gŞd, %ld sv”,‡nd %dƒx³r›nû.\n", ch->
gŞd
, ch->
sv”
, ch->
exp
);

2430 
	`±c
(
ch
, "You hav%ld gŞd‡nd %ld sv” iÀthbªk.\n", ch->
gŞd_š_bªk
, ch->
sv”_š_bªk
);

2431 
	`±c
(
ch
, "You haveƒarned %d quest…oints, %d skill…oints, %d„oleplay…oints,\n",

2432 
ch
->
pcd©a
->
que¡pošts
, ch->pcd©a->
skÍošts
, ch->pcd©a->
rŞ•ošts
);

2433 
	`±c
(
ch
, "%d¿šs,‡nd %d…¿ùiûs.\n", ch->
Œaš
, ch->
´aùiû
);

2435 
	}
}

2437 
	$do_time
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2439 cÚ¡ 
WÜld
& 
wÜld
 = 
ch
->
š_room
->
	`¬—
().world;

2441 
	`±c
(
ch
, "{WIt is %d o'clock %s, Day of %s, %s ofhe Month of %s.{x\n",

2442 (
wÜld
.
time
.
hour
 % 12 == 0) ? 12 : world.time.hour % 12,

2443 
wÜld
.
time
.
hour
 >= 12 ? "pm" : "am",

2444 
wÜld
.
time
.
	`day_Çme
(),

2445 
wÜld
.
time
.
	`day_¡ršg
(),

2446 
wÜld
.
time
.
	`mÚth_Çme
());

2448 ià(
Game
::
que¡_doubË
) {

2449 
	`¡c
("{gQue¡…ošt ¬cu¼’y bešg doubËd!", 
ch
);

2451 ià(
	`IS_IMMORTAL
(
ch
)) {

2452 
hours
 = 
Game
::
que¡_doubË
 / 3600,

2453 
mšu‹s
 = (
Game
::
que¡_doubË
 - (
hours
 * 3600)) / 60,

2454 
£cÚds
 = (
Game
::
que¡_doubË
 - (
hours
 * 3600)è- (
mšu‹s
 * 60);

2456 ià(
Game
::
que¡_doubË
 > 1200)

2457 
	`¡c
("{Y", 
ch
);

2459 
	`¡c
(" (", 
ch
);

2460 
	`±c
(
ch
, "%2d:", 
hours
);

2462 ià(
mšu‹s
 > 9)

2463 
	`±c
(
ch
, "%d:", 
mšu‹s
);

2465 
	`±c
(
ch
, "0%d:", 
mšu‹s
);

2467 ià(
£cÚds
 > 9)

2468 
	`±c
(
ch
, "%d)", 
£cÚds
);

2470 
	`±c
(
ch
, "0%d)", 
£cÚds
);

2473 
	`¡c
("{x\n", 
ch
);

2476 
¡r_boÙ_time
[];

2478 
	`±c
(
ch
, "{gLegacy started up %s\nThe systemime is: %s{x\n",

2479 
¡r_boÙ_time
, (*è
	`ùime
(&
Game
::
cu¼’t_time
));

2480 
	}
}

2482 
	$do_w—th”
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2484 ià(!
	`IS_OUTSIDE
(
ch
)) {

2485 
	`¡c
("You‡» insidªd cªnÙ s“ outdoÜs.\n", 
ch
);

2489 
	`±c
(
ch
, "%s\n", ch->
š_room
->
	`¬—
().
wÜld
.
w—th”
.
	`desüibe
());

2490 
	}
}

2493 
	$do_whois
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2495 
buf
[
MAX_INPUT_LENGTH
];

2496 
SŒšg
 
block
;

2497 
şª
[
MAX_STRING_LENGTH
];

2498 
SŒšg
 
¿nk
;

2499 *
»mÜt
;

2500 
SŒšg
 
ouut
;

2501 
Ch¬aù”
 *
viùim
;

2503 ià(
¬gum’t
.
	`em±y
()) {

2504 
	`¡c
("You mu¡…rovid¨Çme.\n", 
ch
);

2508 
SŒšg
 
¬g
;

2509 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

2511 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

2512 
	`¡c
("NØÚoàth©‚ami ¶ayšg.\n", 
ch
);

2517 
FÜm©
::
	`¥rštf
(
block
, "%s%s%s",

2518 
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_OOC
) ? "{W({YRP{W){x" : "",

2519 
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PAINT
) ? "{W({VPB{W){x" : "",

2520 
viùim
->
aù_æags
.
	`has
(
PLR_MAKEBAG
) ? "{W({CNH{W){x" : "");

2521 
ouut
 +ğ
block
;

2523 ià(!
block
.
	`em±y
())

2524 
ouut
 += " ";

2527 ià(
	`IS_REMORT
(
viùim
)) {

2528 
FÜm©
::
	`¥rštf
(
buf
, "{G%2d{x", 
viùim
->
pcd©a
->
»mÜt_couÁ
);

2529 
»mÜt
 = 
buf
;

2532 
»mÜt
 = " ";

2534 
FÜm©
::
	`¥rštf
(
block
, "%s%s {B%d {P%3s {C%3s%s ",

2535 (
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
)) ? "{P[{x" : "{g[{x",

2536 
»mÜt
,

2537 
viùim
->
Ëv–
,

2538 
pc_¿û_bË
[
viùim
->
¿û
].
who_Çme
,

2539 
viùim
->
gud
 =ğ
Gud
::
nÚe
 ? "---" : 
gud_bË
[viùim->gud].
who_Çme
,

2540 (
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
)) ? "{P]{x" : "{g]{x");

2541 
ouut
 +ğ
block
;

2543 
FÜm©
::
	`¥rštf
(
block
, "%s%s%s{W%s{x %s{x\n",

2544 (
viùim
->
comm_æags
.
	`has
(
COMM_AFK
)) ? "{b[AFK]{x " : "",

2545 (
viùim
->
aù_æags
.
	`has
(
PLR_KILLER
)) ? "{R(KILLER){x " : "",

2546 (
viùim
->
aù_æags
.
	`has
(
PLR_THIEF
)) ? "{B(THIEF){x " : "",

2547 
viùim
->
Çme
,

2548 
viùim
->
pcd©a
->
t™Ë
);

2549 
ouut
 +ğ
block
;

2551 
FÜm©
::
	`¥rštf
(
şª
, "{x");

2553 ià(
viùim
->
şª
 !ğ
nuÎ±r
) {

2554 ià(!
viùim
->
pcd©a
->
¿nk
.
	`em±y
())

2555 
¿nk
 = 
viùim
->
pcd©a
->rank;

2556 ià(
viùim
->
	`has_cgroup
(
GROUP_LEADER
))

2557 
¿nk
 = "Leader";

2558 ià(
viùim
->
	`has_cgroup
(
GROUP_DEPUTY
))

2559 
¿nk
 = "Deputy";

2561 
¿nk
 = "Member";

2563 
FÜm©
::
	`¥rštf
(
şª
, "%s{x oà%s{x, ", 
¿nk
, 
viùim
->şª->
şªÇme
);

2566 ià(
	`IS_REMORT
(
viùim
è&& !viùim->
pcd©a
->
¡©us
.
	`em±y
())

2567 
FÜm©
::
	`¥rštf
(
»mÜt
, "%s{x, ", 
viùim
->
pcd©a
->
¡©us
);

2569 
»mÜt
 = "";

2571 
FÜm©
::
	`¥rštf
(
block
, "%s%s{PR©šg: %d{x\n", 
şª
, 
»mÜt
, 
viùim
->
pcd©a
->
pk¿nk
);

2572 
ouut
 +ğ
block
;

2574 ià(
viùim
->
comm_æags
.
	`has
(
COMM_AFK
))

2575 
ouut
 +ğ
viùim
->
pcd©a
->
afk
;

2577 
	`·ge_to_ch¬
(
ouut
, 
ch
);

2578 
	}
}

2580 *
	$couÁ_¶ay”s
(
Ch¬aù”
 *
ch
)

2582 
buf
[100];

2583 
couÁ
 = 0;

2584 
DesütÜ
 *
d
;

2586 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
)

2587 ià(
d
->
	`is_¶ayšg
(è&& 
	`ÿn_£e_who
(
ch
, d->
ch¬aù”
))

2588 
couÁ
++;

2590 ià(
Game
::
»cÜd_¶ay”s_sšû_boÙ
 =ğ
couÁ
)

2591 
FÜm©
::
	`¥rštf
(
buf
, "Th”¬%d ch¬aù” Ú,hmo¡ sšû†a¡„eboÙ.\n", 
couÁ
);

2593 
FÜm©
::
	`¥rštf
(
buf
, "There‡re %d characters on,he most since†ast„eboot is %d.\n",

2594 
couÁ
, 
Game
::
»cÜd_¶ay”s_sšû_boÙ
);

2596  
buf
;

2597 
	}
}

2599 
	$do_couÁ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2601 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
BOLD
);

2602 
	`¡c
(
	`couÁ_¶ay”s
(
ch
), ch);

2603 
	`±c
(
ch
, "Thmo¡…Ïy” ev” oÀ© onû i %d.\n", 
Game
::
»cÜd_¶ay”s
);

2604 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2605 
	}
}

2607 
	$do_who
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2609 
	ss_ch¬™em
 {

2610 
Ch¬aù”
 *
pch
;

2611 
Ëv–key
;

2613 
tmp_ch¬™em
;

2614 
SŒšg
 
buf
;

2615 
buf2
[
MIL
];

2616 
SŒšg
 
block1
;

2617 
block2
[
MIL
];

2618 
rbuf
[32];

2619 
SŒšg
 
ouut
;

2620 
DesütÜ
 *
d
;

2621 
iLev–Low”
 = 0, 
iLev–Uµ”
 = 
MAX_LEVEL
;

2622 
nNumb”
 = 0, 
nM©ch
 = 0, 
ndesc
 = 0;

2623 
j1
, 
j2
;

2624 
boŞ
 
rgfCÏss
[
Gud
::
size
], 
rgfRaû
[
pc_¿û_bË
.
	`size
()];

2625 
boŞ
 
fCÏssRe¡riù
 = 
çl£
, 
fCÏnRe¡riù
 = f®£, 
fRaûRe¡riù
 = f®£, 
fImmÜlOÆy
 = false;

2626 
boŞ
 
fCÏn
 = 
çl£
;

2627 
boŞ
 
fPK
 = 
çl£
;

2628 
Ch¬aù”
 *
wch
;

2629 
CÏn
 *
cch
 = 
nuÎ±r
;

2630 *
¿nk
, *
lbrk
, *
rbrk
, *
»mÜt
;

2633 
i
 = 0; i < 
Gud
::
size
; i++)

2634 
rgfCÏss
[
i
] = 
çl£
;

2636 
i
 = 0; i < 
pc_¿û_bË
.
	`size
(); i++)

2637 
rgfRaû
[
i
] = 
çl£
;

2641 ià(
¬gum’t
.
	`em±y
())

2644 
SŒšg
 
¬g
;

2645 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

2647 ià(
¬g
.
	`is_numb”
()) {

2648 ++
nNumb”
) {

2649 1: 
iLev–Low”
 = 
	`©oi
(
¬g
); ;

2651 2: 
iLev–Uµ”
 = 
	`©oi
(
¬g
); ;

2654 
	`¡c
("Fšd…Ïy” b‘w“Àwh©wØËv–s?\n", 
ch
);

2660 ià(
¬g
[0] == 'i')

2661 
fImmÜlOÆy
 = 
Œue
;

2662 ià(
¬g
.
	`is_´efix_of
("pk"))

2663 
fPK
 = 
Œue
;

2664 ià(
¬g
 == "clan")

2665 
fCÏnRe¡riù
 = 
Œue
;

2667 
Gud
 
gud
 = 
	`gud_lookup
(
¬g
);

2669 ià(
gud
 =ğ
Gud
::
nÚe
) {

2670 
iRaû
 = 
	`¿û_lookup
(
¬g
);

2672 ià(
iRaû
 =ğ0 || iRaû >ğ
pc_¿û_bË
.
	`size
()) {

2673 ià((
cch
 = 
	`şª_lookup
(
¬g
)è!ğ
nuÎ±r
)

2674 
fCÏn
 = 
Œue
;

2676 
	`¡c
("Th©' nÙ‡ v®id„aû, cÏss, cÏn, o¸wayØüashhi mud.\n", 
ch
);

2681 
fRaûRe¡riù
 = 
Œue
;

2682 
rgfRaû
[
iRaû
] = 
Œue
;

2686 
fCÏssRe¡riù
 = 
Œue
;

2687 
rgfCÏss
[
gud
] = 
Œue
;

2694 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
)

2695 
ndesc
++;

2697 
s_ch¬™em
 
ch¬™ems
[
ndesc
];

2700 
buf
.
	`ş—r
();

2702 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

2704 ià(!
d
->
	`is_¶ayšg
(è|| !
	`ÿn_£e_who
(
ch
, d->
ch¬aù”
))

2707 
wch
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

2709 ià(!
	`ÿn_£e_who
(
ch
, 
wch
))

2712 ià(
wch
->
Ëv–
 < 
iLev–Low”


2713 || 
wch
->
Ëv–
 > 
iLev–Uµ”


2714 || (
fImmÜlOÆy
 && !
	`IS_IMMORTAL
(
wch
))

2715 || (
fPK
 && !
wch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
))

2716 || (
fCÏssRe¡riù
 && !
rgfCÏss
[
wch
->
gud
])

2717 || (
fRaûRe¡riù
 && !
rgfRaû
[
wch
->
¿û
])

2718 || (
fCÏn
 && 
wch
->
şª
 !ğ
cch
)

2719 || (
fCÏnRe¡riù
 && !
wch
->
şª
))

2722 
ch¬™ems
[
nM©ch
].
pch
 = 
wch
;

2725 ià(
	`IS_IMMORTAL
(
wch
)) {

2726 
ch¬™ems
[
nM©ch
].
Ëv–key
 = 99000;

2728 ià(
	`IS_IMP
(
wch
))

2729 
ch¬™ems
[
nM©ch
].
Ëv–key
 += 2000;

2730 ià(
	`IS_HEAD
(
wch
))

2731 
ch¬™ems
[
nM©ch
].
Ëv–key
 += 1000;

2734 
ch¬™ems
[
nM©ch
].
Ëv–key
 = 1000 * 
wch
->
pcd©a
->
»mÜt_couÁ
 + wch->
Ëv–
;

2736 
nM©ch
++;

2740 
j1
 = 0; j1 < 
nM©ch
 - 1; j1++) {

2741 
j2
 = 
j1
 + 1; j2 < 
nM©ch
; j2++) {

2742 ià(
ch¬™ems
[
j2
].
Ëv–key
 > ch¬™ems[
j1
].levelkey) {

2743 
tmp_ch¬™em
 = 
ch¬™ems
[
j1
];

2744 
ch¬™ems
[
j1
] = ch¬™ems[
j2
];

2745 
ch¬™ems
[
j2
] = 
tmp_ch¬™em
;

2751 
j1
 = 0; j1 < 
nM©ch
; j1++) {

2752 
wch
 = 
ch¬™ems
[
j1
].
pch
;

2756 
SŒšg
 
gud
 = 
wch
->gud =ğ
Gud
::
nÚe
 ? "---" : 
gud_bË
[wch->gud].
who_Çme
;

2758 ià(
	`IS_REMORT
(
wch
)) {

2759 
FÜm©
::
	`¥rštf
(
rbuf
, "{G%2d{x", 
wch
->
pcd©a
->
»mÜt_couÁ
);

2760 
»mÜt
 = 
rbuf
;

2763 
»mÜt
 = " ";

2765 ià(
	`IS_IMMORTAL
(
wch
è&& !wch->
pcd©a
->
immÇme
.
	`em±y
()) {

2766 
block1
 = 
wch
->
pcd©a
->
immÇme
.
	`ûÁ”
(15);

2769 ià(
	`ch¬_©_w¬
(
wch
)) {

2770 
lbrk
 = "<";

2771 
rbrk
 = ">";

2774 
lbrk
 = "[";

2775 
rbrk
 = "]";

2778 
FÜm©
::
	`¥rštf
(
block1
, "%s%s%s {B%2d {P%3s {C%3s%s%s{x",

2779 
wch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
) ? "{P" : "{W",

2780 
lbrk
,

2781 
»mÜt
,

2782 
wch
->
Ëv–
,

2783 
pc_¿û_bË
[
wch
->
¿û
].
who_Çme
,

2784 
gud
,

2785 
wch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
) ? "{P" : "{W",

2786 
rbrk
);

2794 ià(
wch
->
şª
 || 
	`IS_IMMORTAL
(wch)) {

2795 
FÜm©
::
	`¥rštf
(
rbuf
, "%s{x%3s{x",

2796 
wch
->
	`has_cgroup
(
GROUP_LEADER
) ? "{Y~" :

2797 
wch
->
	`has_cgroup
(
GROUP_DEPUTY
) ? "{B~" : " ",

2798 !
wch
->
pcd©a
->
¿nk
.
	`em±y
() ? wch->pcdata->rank :

2799 
	`IS_IMMORTAL
(
wch
) ? "{WIMM" : " ");

2800 
¿nk
 = 
rbuf
;

2803 
¿nk
 = " ";

2805 
FÜm©
::
	`¥rštf
(
block2
, "%s %s{a{x %s%s%s",

2806 
¿nk
,

2807 
wch
->
şª
 ? wch->şª->
who_Çme
 : " ",

2808 
wch
->
aù_æags
.
	`has
(
PLR_MAKEBAG
) ? "{CH{x" : "{T-{x",

2809 
wch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_OOC
) ? "{YR{x" : "{b-{x",

2810 
wch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PAINT
) ? "{V*{x" : "{M-{x");

2814 ià(
wch
->
aù_æags
.
	`has
(
PLR_SUPERWIZ
)) {

2815 
lbrk
 = "{P({R";

2816 
rbrk
 = "{P)";

2818 ià(
wch
->
švis_Ëv–
 && wch->
lurk_Ëv–
) {

2819 
lbrk
 = "{T{{";

2820 
rbrk
 = "{T}";

2822 ià(
wch
->
švis_Ëv–
) {

2823 
lbrk
 = "{H<";

2824 
rbrk
 = "{H>";

2826 ià(
wch
->
lurk_Ëv–
) {

2827 
lbrk
 = "{G(";

2828 
rbrk
 = "{G)";

2831 
lbrk
 = "{W";

2832 
rbrk
 = "";

2835 
FÜm©
::
	`¥rštf
(
buf
, "% % ", 
block1
, 
block2
);

2837 ià(
wch
->
comm_æags
.
	`has
(
COMM_AFK
)è
buf
 += "{b[AFK]{x ";

2839 ià(
wch
->
aù_æags
.
	`has
(
PLR_KILLER
)è
buf
 += "{R(KILLER){x ";

2841 ià(
wch
->
aù_æags
.
	`has
(
PLR_THIEF
)è
buf
 += "{B(THIEF){x ";

2843 
buf
 +ğ
lbrk
;

2844 
buf
 +ğ
wch
->
Çme
;

2845 
buf
 +ğ
rbrk
;

2846 
buf
 += "{x";

2847 
buf
 +ğ
wch
->
pcd©a
->
t™Ë
;

2848 
buf
 += "{x{a{W \n";

2849 
ouut
 +ğ
buf
;

2852 
	`¡c
("\À {C*{W*{C* {BL{Ce{gg{Wa{Cc{By {C*{W*{C*{x\n\n", 
ch
);

2853 
FÜm©
::
	`¥rštf
(
buf2
, "\n");

2854 
ouut
 +ğ
buf2
;

2855 
ouut
 +ğ
	`couÁ_¶ay”s
(
ch
);

2856 
ouut
 += "\n";

2857 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
BOLD
);

2858 
	`·ge_to_ch¬
(
ouut
, 
ch
);

2859 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2861 
	}
}

2864 
	$do_swho
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2866 
buf
[
MAX_STRING_LENGTH
];

2867 
SŒšg
 
roombuf
, 
ouut
;

2868 
DesütÜ
 *
d
;

2869 
ouut
 += "{WRP PK NH PB QW SQ NT Name Pos'n Room Name{x\n";

2870 
ouut
 += "{W----------------------------------------------------------------------------{x\n";

2872 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

2873 
Ch¬aù”
 *
wch
;

2874 cÚ¡ *
pos™iÚ
 = "Drooling";

2876 ià(!
d
->
	`is_¶ayšg
(è|| !
	`ÿn_£e_who
(
ch
, d->
ch¬aù”
))

2879 
wch
 = (
d
->
Üigš®
 !ğ
nuÎ±r
è? d->Üigš® : d->
ch¬aù”
;

2881 ià(!
	`ÿn_£e_who
(
ch
, 
wch
))

2884 
	`g‘_pos™iÚ
(
wch
)) {

2885 
POS_DEAD
: 
pos™iÚ
 = "{WDead!"; ;

2887 
POS_MORTAL
: 
pos™iÚ
 = "{WWound"; ;

2889 
POS_INCAP
: 
pos™iÚ
 = "{WIncap"; ;

2891 
POS_STUNNED
: 
pos™iÚ
 = "{WStun "; ;

2893 
POS_SLEEPING
: 
pos™iÚ
 = "{gSleep"; ;

2895 
POS_RESTING
: 
pos™iÚ
 = "{bRest "; ;

2897 
POS_SITTING
: 
pos™iÚ
 =

2901 
POS_FIGHTING
: 
pos™iÚ
 = "{WFight"; ;

2903 
POS_STANDING
: 
pos™iÚ
 = "Stand"; ;

2904 
POS_FLYING
: 
pos™iÚ
 = "Fly "; ;

2908 ià(!
wch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PRIVATE
)) {

2909 
roombuf
 = 
wch
->
š_room
->
	`Çme
();

2911 
roombuf
.
	`uncŞÜ
().
	`size
() > 37)

2912 
roombuf
.
	`pİ_back
();

2914 ià(!
	`IS_IMMORTAL
(
ch
è|| IS_IMMORTAL(
wch
))

2915 
FÜm©
::
	`¥rštf
(
roombuf
, "Private");

2917 
roombuf
 = 
FÜm©
::
	`fÜm©
("~%s", 
wch
->
š_room
->
	`Çme
());

2919 
roombuf
.
	`uncŞÜ
().
	`size
() > 36)

2920 
roombuf
.
	`pİ_back
();

2922 
roombuf
 += "{V~";

2925 
FÜm©
::
	`¥rštf
(
buf
, "{b[%s][%s][%s][%s][%s][%s][%s{b] {W%-12s {R({P%s{R) {M<{V%s{M>\n",

2926 
wch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_OOC
) ? "{Y*{b" : " ",

2927 
wch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
) ? "{G*{b" : " ",

2928 
wch
->
aù_æags
.
	`has
(
PLR_MAKEBAG
) ? "{T*{b" : " ",

2929 
wch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PAINT
) ? "{P*{b" : " ",

2930 
	`IS_QUESTOR
(
wch
) ? "{V*{b" : " ",

2931 
	`IS_SQUESTOR
(
wch
) ? "{B*{b" : " ",

2932 (
wch
->
²Ùe
 !ğ
nuÎ±r
) ?

2933 
wch
->
²Ùe
->
ty³
 =ğ
NOTE_NOTE
 ? "{P*" :

2934 
wch
->
²Ùe
->
ty³
 =ğ
NOTE_IDEA
 ? "{Y*" :

2935 
wch
->
²Ùe
->
ty³
 =ğ
NOTE_ROLEPLAY
 ? "{V*" :

2936 
wch
->
²Ùe
->
ty³
 =ğ
NOTE_IMMQUEST
 ? "{B*" :

2937 
wch
->
²Ùe
->
ty³
 =ğ
NOTE_CHANGES
 ? "{G*" :

2938 
wch
->
²Ùe
->
ty³
 =ğ
NOTE_PERSONAL
 ? "{C*" :

2939 
wch
->
²Ùe
->
ty³
 =ğ
NOTE_TRADE
 ? "{b*" :

2942 
wch
->
Çme
,

2943 
pos™iÚ
,

2944 
roombuf
);

2945 
ouut
 +ğ
buf
;

2948 
ouut
 += "{W----------------------------------------------------------------------------{x\n";

2949 
	`·ge_to_ch¬
(
ouut
, 
ch
);

2950 
	}
}

2953 
	$do_šv’tÜy
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2955 
Ch¬aù”
 *
viùim
 = 
nuÎ±r
;

2957 ià(
¬gum’t
.
	`em±y
()) {

2958 
viùim
 = 
ch
;

2959 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_INV
);

2960 
	`¡c
("You‡» c¬ryšg:\n", 
ch
);

2963 
SŒšg
 
¬g1
;

2964 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

2966 ià(
¬g1
 =ğ"ch¬" && 
	`IS_IMMORTAL
(
ch
)) {

2967 
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬gum’t
, 
VIS_PLR
);

2969 ià(
viùim
 =ğ
nuÎ±r
) {

2970 
	`¡c
("They‡»n'ˆšhgame.\n", 
ch
);

2974 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_INV
);

2975 
	`aù
("$N i ÿ¼yšg:", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
, 
POS_SLEEPING
, 
çl£
);

2977 ià(
¬g1
 == "all") {

2978 
viùim
 = 
ch
;

2979 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_INV
);

2980 
	`¡c
("You‡» c¬ryšg:\n", 
ch
);

2981 
	`show_li¡_to_ch¬
(
viùim
->
ÿ¼yšg
, 
ch
, 
Œue
,rue,rue);

2982 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2986 
	`¡c
("SyÁax: Inv’tÜy o¸Inv’tÜy‡Î\n", 
ch
);

2988 ià(
	`IS_IMMORTAL
(
ch
))

2989 
	`¡c
(" : Inv’tÜy ch¬ <viùim>\n", 
ch
);

2995 
	`show_li¡_to_ch¬
(
viùim
->
ÿ¼yšg
, 
ch
, 
Œue
,rue, 
çl£
);

2996 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2997 
	}
}

2999 
	$do_equm’t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3001 
Objeù
 *
obj
;

3002 
iW—r
;

3003 
SŒšg
 
buf
;

3004 
Ch¬aù”
 *
viùim
;

3006 ià(
	`IS_IMMORTAL
(
ch
è&& !
¬gum’t
.
	`em±y
()) {

3007 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬gum’t
, 
VIS_PLR
)è=ğ
nuÎ±r
)

3008 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬gum’t
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

3009 
	`¡c
("They'»‚Ù iÀthgame.\n", 
ch
);

3013 
	`£t_cŞÜ
(
ch
, 
GREEN
, 
NOBOLD
);

3014 
	`aù
("$N i usšg:", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
, 
POS_SLEEPING
, 
çl£
);

3017 
viùim
 = 
ch
;

3018 
	`£t_cŞÜ
(
ch
, 
GREEN
, 
NOBOLD
);

3019 
	`¡c
("You‡» usšg:\n", 
ch
);

3022 
iW—r
 = 0; iW—¸< 
MAX_WEAR
; iWear++) {

3023 ià(
ch
->
pcd©a
)

3024 ià(
iW—r
 =ğ
WEAR_WEDDINGRING
 && !
ch
->
pcd©a
->
¥ou£
.
	`em±y
(è&& !
	`IS_IMMORTAL
(ch))

3027 
buf
 = 
wh”e_Çme
[
iW—r
];

3029 ià((
obj
 = 
	`g‘_eq_ch¬
(
viùim
, 
iW—r
)è=ğ
nuÎ±r
) {

3030 ià(!
	`IS_IMMORTAL
(
viùim
)) {

3032 ià((
iW—r
 =ğ
WEAR_SHIELD
 || iW—¸=ğ
WEAR_HOLD
)

3033 && 
	`g‘_eq_ch¬
(
viùim
, 
WEAR_SECONDARY
è!ğ
nuÎ±r
)

3036 ià(
iW—r
 =ğ
WEAR_SECONDARY
)

3040 
buf
 += " ({W- - -{x)";

3042 ià(
	`ÿn_£e_obj
(
ch
, 
obj
)) {

3043 
¥aûs
;

3045 ià(
obj
->
num_£‰šgs
 == 0)

3046 
¥aûs
 = 
MAX_GEM_SETTINGS
 + 3;

3048 
¥aûs
 = (
MAX_GEM_SETTINGS
 - 
obj
->
num_£‰šgs
);

3050 
¥aûs
-- > 0)

3051 
buf
 += " ";

3053 
buf
 +ğ
	`fÜm©_obj_to_ch¬
(
obj
, 
ch
, 
Œue
);

3056 
buf
 += " (something)";

3058 
buf
 += "\n";

3059 
	`¡c
(
buf
, 
ch
);

3062 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

3063 
	}
}

3065 
	$do_com·»
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3067 
Objeù
 *
obj1
;

3068 
Objeù
 *
obj2
;

3069 
v®ue1
;

3070 
v®ue2
;

3071 *
msg
;

3073 ià(
¬gum’t
.
	`em±y
()) {

3074 
	`¡c
("Com·» wh©Øwh©?\n", 
ch
);

3078 
SŒšg
 
¬g1
, 
¬g2
;

3079 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

3080 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

3082 ià((
obj1
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g1
)è=ğ
nuÎ±r
) {

3083 
	`¡c
("You dØnÙ havÚš you¸šv’tÜy.\n", 
ch
);

3087 ià(
¬g2
.
	`em±y
()) {

3088 
obj2
 = 
ch
->
ÿ¼yšg
; obj2 !ğ
nuÎ±r
; obj2 = obj2->
Ãxt_cÚ‹Á
) {

3089 ià(
obj2
->
w—r_loc
 !ğ
WEAR_NONE


3090 && 
	`ÿn_£e_obj
(
ch
, 
obj2
)

3091 && (
obj1
->
w—r_æags
 - 
ITEM_TAKE
).
	`has_ªy_of
(
obj2
->wear_flags))

3095 ià(
obj2
 =ğ
nuÎ±r
) {

3096 
	`¡c
("You‡»n'ˆw—ršg‡nythšg com·¿bË.\n", 
ch
);

3100 ià((
obj2
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g2
)è=ğ
nuÎ±r
) {

3101 
	`¡c
("You dØnÙ havÚš you¸šv’tÜy.\n", 
ch
);

3105 
msg
 = 
nuÎ±r
;

3106 
v®ue1
 = 0;

3107 
v®ue2
 = 0;

3109 ià(
obj1
 =ğ
obj2
)

3110 
msg
 = "You compare $po itself. It†ooks‡bouthe same.";

3111 ià(
obj1
->
™em_ty³
 !ğ
obj2
->item_type)

3112 
msg
 = "You can't compare $p‡nd $P.";

3114 
obj1
->
™em_ty³
) {

3116 
msg
 = "You can't compare $p‡nd $P.";

3119 
ITEM_ARMOR
:

3120 
v®ue1
 = 
obj1
->
v®ue
[0] + obj1->value[1] + obj1->value[2];

3121 
v®ue2
 = 
obj2
->
v®ue
[0] + obj2->value[1] + obj2->value[2];

3124 
ITEM_WEAPON
:

3125 
v®ue1
 = (1 + 
obj1
->
v®ue
[2]) * obj1->value[1];

3126 
v®ue2
 = (1 + 
obj2
->
v®ue
[2]) * obj2->value[1];

3131 ià(
msg
 =ğ
nuÎ±r
) {

3132 ià(
v®ue1
 =ğ
v®ue2
è
msg
 = "$p‡nd $P†ook‡bouthe same.";

3133 ià(
v®ue1
 > 
v®ue2
è
msg
 = "$p†ooks betterhan $P.";

3134 
msg
 = "$p†ooks worsehan $P.";

3137 
	`aù
(
msg
, 
ch
, 
obj1
, 
obj2
, 
TO_CHAR
);

3139 
	}
}

3141 
	$do_üed™s
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3143 
	`h–p
(
ch
, "diku");

3144 
	`h–p
(
ch
, "credit");

3146 
	}
}

3148 
	$do_wh”e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3150 
Du–
::
A»Ç
 *
¬’a
 = 
¬’a_bË_h—d
->
Ãxt
;

3151 
DesütÜ
 *
d
;

3152 
boŞ
 
found
 = 
çl£
;

3154 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

3157 
¬’a
 !ğ
¬’a_bË_
) {

3158 ià(
ch
->
š_room
->
´ÙÙy³
.
vnum
 >ğ
¬’a
->
mšvnum


3159 && 
ch
->
š_room
->
´ÙÙy³
.
vnum
 <ğ
¬’a
->
maxvnum
)

3162 
¬’a
 =‡»Ç->
Ãxt
;

3165 ià(
¬’a
 !ğ
¬’a_bË_
) {

3166 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

3167 ià(
viùim
->
š_room
 !ğ
nuÎ±r


3168 && 
viùim
->
š_room
->
´ÙÙy³
.
vnum
 >ğ
¬’a
->
mšvnum


3169 && 
viùim
->
š_room
->
´ÙÙy³
.
vnum
 <ğ
¬’a
->
maxvnum


3170 && !
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_NOWHERE
)

3171 && 
	`ÿn_£e_ch¬
(
ch
, 
viùim
)) {

3172 
found
 = 
Œue
;

3173 
	`±c
(
ch
, "%-28s{x %s{x\n", 
	`PERS
(
viùim
, ch, 
VIS_CHAR
), viùim->
š_room
->
	`Çme
());

3177 ià(!
found
)

3178 
	`¡c
("You cª'ˆ£ªyÚÃ¬by...\n", 
ch
);

3183 ià(
¬gum’t
.
	`em±y
()) {

3184 
	`¡c
("N—rby you s“:\n", 
ch
);

3186 
d
 = 
desütÜ_li¡
; d; d = d->
Ãxt
) {

3187 
Ch¬aù”
 *
viùim
 = 
d
->
ch¬aù”
;

3189 ià(
d
->
	`is_¶ayšg
()

3190 && 
viùim
->
š_room
 !ğ
nuÎ±r


3191 && !
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_NOWHERE
)

3192 && 
viùim
->
š_room
->
	`¬—
(è=ğ
ch
->in_room->area()

3193 && 
	`ÿn_£e_ch¬
(
ch
, 
viùim
)) {

3194 
found
 = 
Œue
;

3195 
	`±c
(
ch
, "%-28s{x %s{x\n", 
viùim
->
Çme
, viùim->
š_room
->
	`Çme
());

3199 ià(!
found
)

3200 
	`¡c
("NÚe.\n", 
ch
);

3203 
SŒšg
 
¬g
;

3204 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

3206 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

3207 ià(
viùim
->
š_room
 !ğ
nuÎ±r


3208 && 
viùim
->
š_room
->
	`¬—
(è=ğ
ch
->in_room->area()

3209 && !
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
hide
)

3210 && 
	`ÿn_£e_ch¬
(
ch
, 
viùim
)

3211 && 
viùim
->
Çme
.
	`has_wÜds
(
¬g
)) {

3212 
found
 = 
Œue
;

3213 
	`±c
(
ch
, "%-28s{x %s{x\n", 
	`PERS
(
viùim
, ch, 
VIS_CHAR
), viùim->
š_room
->
	`Çme
());

3218 ià(!
found
)

3219 
	`aù
("You didn'ˆfšd‡ny $T.", 
ch
, 
nuÎ±r
, 
¬g
, 
TO_CHAR
);

3221 
	}
}

3224 
	$do_scÚ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3226 
Ch¬aù”
 *
viùim
;

3228 
SŒšg
 
¬g
;

3229 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

3231 ià(
¬gum’t
.
	`em±y
()) {

3232 ià((
viùim
 = 
ch
->
fightšg
è=ğ
nuÎ±r
) {

3233 
	`¡c
("Which way did hgo?!?\n", 
ch
);

3237 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

3238 
	`¡c
("They'»‚Ù h”e.\n", 
ch
);

3242 
	`±c
(
ch
, "{GN{H[{G%s{H] {CL{T[{C%d{T]\n"

3244 
viùim
->
Çme
, viùim->
Ëv–
,

3245 
viùim
->
h™
, 
	`GET_MAX_HIT
(victim),

3246 
viùim
->
mªa
, 
	`GET_MAX_MANA
(victim),

3247 
viùim
->
¡am
, 
	`GET_MAX_STAM
(victim));

3249 ià(!
	`¡rcmp
(
¬gum’t
, "more")) {

3250 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
BOLD
);

3251 
	`±c
(
ch
, "Align[%d] Hit[%d] Dam[%d] AC[%d %d %d %d]\n",

3252 
viùim
->
®ignm’t
, 
	`GET_ATTR_HITROLL
(viùim), 
	`GET_ATTR_DAMROLL
(victim),

3253 
	`GET_AC
(
viùim
, 
AC_PIERCE
), GET_AC(viùim, 
AC_BASH
),

3254 
	`GET_AC
(
viùim
, 
AC_SLASH
), GET_AC(viùim, 
AC_EXOTIC
));

3256 
SŒšg
 
buf
;

3257 
buf
 = 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_ABSORB
);

3258 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, " Drain: %s\n", buf);

3259 
buf
 = 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_IMMUNE
);

3260 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, " Immune: %s\n", buf);

3261 
buf
 = 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_RESIST
);

3262 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, " Resist: %s\n", buf);

3263 
buf
 = 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_VULN
);

3264 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, " Vuln: %s\n", buf);

3265 
buf
 = 
afãù
::
	`´št_ÿche
(
viùim
);

3266 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, " Affect: %s\n", buf);

3268 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

3270 
	}
}

3272 
	$do_cÚsid”
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3274 
SŒšg
 
buf
;

3275 
Ch¬aù”
 *
viùim
;

3276 
diff
, 
³rûÁ
;

3278 ià(
¬gum’t
.
	`em±y
()) {

3279 
	`¡c
("CÚsid” klšg whom?\n", 
ch
);

3283 
SŒšg
 
¬g
;

3284 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

3286 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

3287 
	`¡c
("They'»‚Ù h”e.\n", 
ch
);

3291 
SŒšg
 
gud
 = 
viùim
->
	`is_Åc
() ? "mobile" :

3292 
viùim
->
gud
 =ğ
Gud
::
nÚe
 ? "none" :

3293 
gud_bË
[
viùim
->
gud
].
Çme
;

3296 ià(
ch
->
	`has_cgroup
(
GROUP_AVATAR
)) {

3297 
	`±c
(
ch
, "{CYou s“ % Öev– %d)\n", 
viùim
->
Çme
, viùim->
Ëv–
);

3298 
	`±c
(
ch
, "{TRace: %s Sex: %s Class: %s Size: %s\n",

3299 
¿û_bË
[
viùim
->
¿û
].
Çme
,

3300 
£x_bË
[
	`GET_ATTR_SEX
(
viùim
)].
Çme
,

3301 
gud
,

3302 
size_bË
[
viùim
->
size
].
Çme
);

3303 
	`±c
(
ch
, "{PStr: %-2d(%-2d)\t{BAC Pierce : %-10d{YHit Points: %d/%d\n",

3304 
	`ATTR_BASE
(
viùim
, 
APPLY_STR
), 
	`GET_ATTR_STR
(victim),

3305 
	`GET_AC
(
viùim
, 
AC_PIERCE
), viùim->
h™
, 
	`GET_MAX_HIT
(victim));

3306 
	`±c
(
ch
, "{PInt: %-2d(%-2d)\t{BAC Bash : %-10d{YMana : %d/%d\n",

3307 
	`ATTR_BASE
(
viùim
, 
APPLY_INT
), 
	`GET_ATTR_INT
(victim),

3308 
	`GET_AC
(
viùim
, 
AC_BASH
), viùim->
mªa
, 
	`GET_MAX_MANA
(victim));

3309 
	`±c
(
ch
, "{PWis: %-2d(%-2d)\t{BAC Slash : %-10d{YStamina : %d/%d\n",

3310 
	`ATTR_BASE
(
viùim
, 
APPLY_WIS
), 
	`GET_ATTR_WIS
(victim),

3311 
	`GET_AC
(
viùim
, 
AC_SLASH
), viùim->
¡am
, 
	`GET_MAX_STAM
(victim));

3312 
	`±c
(
ch
, "{PDex: %-2d(%-2d)\t{BAC Magic : %-10d{GHit Roll : %d\n",

3313 
	`ATTR_BASE
(
viùim
, 
APPLY_DEX
), 
	`GET_ATTR_DEX
(victim),

3314 
	`GET_AC
(
viùim
, 
AC_EXOTIC
), 
	`GET_ATTR_HITROLL
(victim));

3315 
	`±c
(
ch
, "{PCon: %-2d(%-2d)\t\t\t {GDam Roll : %d\n",

3316 
	`ATTR_BASE
(
viùim
, 
APPLY_CON
), 
	`GET_ATTR_CON
(victim),

3317 
	`GET_ATTR_DAMROLL
(
viùim
));

3318 
	`±c
(
ch
, "{PChr: %-2d(%-2d)\t{WSaves : %-10dAlignment : %d\n",

3319 
	`ATTR_BASE
(
viùim
, 
APPLY_CHR
), 
	`GET_ATTR_CHR
(victim),

3320 
	`GET_ATTR_SAVES
(
viùim
), viùim->
®ignm’t
);

3322 ià(
viùim
->
	`is_Åc
()) {

3323 
	`±c
(
ch
, "\t\t{WDamage : %2dd%-2d Message : %s\n",

3324 
viùim
->
damage
[
DICE_NUMBER
], viùim->damage[
DICE_TYPE
],

3325 
©ck_bË
[
viùim
->
dam_ty³
].
noun
);

3326 
	`±c
(
ch
, "\t\t{WCount : %-10dKilled : %d\n",

3327 
viùim
->
pIndexD©a
->
couÁ
, viùim->pIndexD©a->
kËd
);

3330 
	`±c
(
ch
, "\n{gAù: %s\n", 
	`aù_b™_Çme
(
viùim
->
aù_æags
, viùim->
	`is_Åc
()));

3332 ià(!
viùim
->
	`is_Åc
())

3333 
	`±c
(
ch
, "{gPÌ: %s\n", 
	`¶r_b™_Çme
(
viùim
->
pcd©a
->
¶r_æags
));

3335 ià(
viùim
->
	`is_Åc
(è&& !viùim->
off_æags
.
	`em±y
())

3336 
	`±c
(
ch
, "{gOff: %s\n", 
	`off_b™_Çme
(
viùim
->
off_æags
));

3338 
buf
 = 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_ABSORB
);

3339 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, "Drain: %s\n", buf);

3340 
buf
 = 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_IMMUNE
);

3341 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, "Immune: %s\n", buf);

3342 
buf
 = 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_RESIST
);

3343 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, "Resist: %s\n", buf);

3344 
buf
 = 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_VULN
);

3345 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, "Vuln: %s\n", buf);

3346 
buf
 = 
afãù
::
	`´št_ÿche
(
viùim
);

3347 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, "Affect: %s\n", buf);

3349 
	`±c
(
ch
, "{gForm: %s\n{gParts: %s\n",

3350 
	`fÜm_b™_Çme
(
viùim
->
fÜm_æags
), 
	`·¹_b™_Çme
(viùim->
·¹s_æags
));

3351 
	`±c
(
ch
, "{gMaster: %s {gLeader: %s {gPet: %s\n",

3352 
viùim
->
ma¡”
 ? viùim->ma¡”->
Çme
 : "(none)",

3353 
viùim
->
Ëad”
 ? viùim->Ëad”->
Çme
 : "(none)",

3354 
viùim
->
³t
 ? viùim->³t->
Çme
 : "(none)");

3356 ià(
viùim
->
	`is_Åc
(è&& viùim->
¥ec_fun
 != 0)

3357 
	`±c
(
ch
, "{gMobha ¥ecŸÈ´oûdu» %s.\n", 
	`¥ec_Çme
(
viùim
->
¥ec_fun
));

3359 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_ch¬
(
viùim
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
) {

3360 ià(
·f
->
³rmª’t
)

3363 
	`±c
(
ch
, "{bS³Î: '%s'", 
afãù
::
	`lookup
(
·f
->
ty³
).
Çme
);

3365 ià(
·f
->
wh”e
 =ğ
TO_AFFECTS
) {

3366 ià(
·f
->
loÿtiÚ
 !ğ
APPLY_NONE
 &&…af->
modif›r
 != 0)

3367 
	`±c
(
ch
, " modif› % by %d", 
	`afãù_loc_Çme
(
·f
->
loÿtiÚ
),…af->
modif›r
);

3369 ià(
·f
->
wh”e
 =ğ
TO_DEFENSE
)

3370 
	`±c
(
ch
, " %s damage from %s by %d%%",

3371 
·f
->
modif›r
 > 0 ? "reduces" : "increases",

3372 
	`dam_ty³_Çme
(
·f
->
loÿtiÚ
),

3373 
·f
->
modif›r
 > 0 ?…af->modifier : -paf->modifier);

3375 
	`¡c
(" dÛ som‘hšg weœd", 
ch
);

3377 ià(
·f
->
du¿tiÚ
 >= 0)

3378 
	`±c
(
ch
, " fÜ %d hours", 
·f
->
du¿tiÚ
);

3380 
	`±c
(
ch
, ",†ev– %d", 
·f
->
Ëv–
);

3382 ià(
·f
->
evŞutiÚ
 > 1)

3383 
	`±c
(
ch
, ",ƒvŞv%d", 
·f
->
evŞutiÚ
);

3385 
	`¡c
(".\n", 
ch
);

3389 
diff
 = 
viùim
->
Ëv–
 - 
ch
->level;

3391 ià(
diff
 <ğ-10è
buf
 = "You can kill $N‚aked‡nd weaponless.";

3392 ià(
diff
 <ğ-5è
buf
 = "$N is‚o match for you.";

3393 ià(
diff
 <ğ-2è
buf
 = "$N†ooks†ike‡nƒasy kill.";

3394 ià(
diff
 <ğ1è
buf
 = "The…erfect match!";

3395 ià(
diff
 <ğ4è
buf
 = "$N says 'Do you feel†ucky,…unk?'.";

3396 ià(
diff
 <ğ9è
buf
 = "$N†aughs‡t you mercilessly..";

3397 ià(
diff
 <ğ30è
buf
 = "Death willhank you for your gift.";

3398 
buf
 = "$N could slay you in one blow.";

3400 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
BOLD
);

3401 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3402 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

3404 ià(
	`GET_MAX_HIT
(
viùim
) > 0)

3405 
³rûÁ
 = (100 * 
viùim
->
h™
è/ 
	`GET_MAX_HIT
(victim);

3407 
³rûÁ
 = -1;

3409 ià(
³rûÁ
 >ğ100è
buf
 = "$N is inƒxcellent condition.";

3410 ià(
³rûÁ
 >ğ90è
buf
 = "$N has‡ few scratches.";

3411 ià(
³rûÁ
 >ğ75è
buf
 = "$N has some small wounds‡nd bruises.";

3412 ià(
³rûÁ
 >ğ50è
buf
 = "$N has quite‡ few wounds.";

3413 ià(
³rûÁ
 >ğ30è
buf
 = "$N has some big‚asty wounds‡nd scratches.";

3414 ià(
³rûÁ
 >ğ15è
buf
 = "$N†ooks…retty hurt.";

3415 ià(
³rûÁ
 >ğ1è
buf
 = "$N is in‡wful condition.";

3416 ià(
³rûÁ
 >ğ0è
buf
 = "$N will soon beoast!!!";

3417 
buf
 = "$N is in‚eed of ***SERIOUS*** medical‡ttention!!!";

3419 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3420 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

3421 
	}
}

3423 
	$£t_t™Ë
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
t™Ë
)

3425 
buf
[
MAX_STRING_LENGTH
];

3427 ià(
ch
->
	`is_Åc
()) {

3428 
Loggšg
::
	`bug
("Set_title: NPC.", 0);

3432 ià(
t™Ë
[0] != '.' &&itle[0] != ',' &&itle[0] != '!' &&itle[0] != '?') {

3433 
buf
[0] = ' ';

3434 
	`¡rıy
(
buf
 + 1, 
t™Ë
);

3437 
	`¡rıy
(
buf
, 
t™Ë
);

3439 
ch
->
pcd©a
->
t™Ë
 = 
buf
;

3441 
	}
}

3443 
	$do_t™Ë
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3445 ià(
ch
->
	`is_Åc
())

3448 ià(
¬gum’t
.
	`em±y
()) {

3449 
	`¡c
("Chªgyou¸t™ËØwh©?\n", 
ch
);

3453 ià(
¬gum’t
 == "none") {

3454 
	`£t_t™Ë
(
ch
, "");

3455 
	`¡c
("T™Ë„emoved.\n", 
ch
);

3459 ià(
¬gum’t
.
	`uncŞÜ
().
	`size
() > 45) {

3460 
	`¡c
("T™Ë ÿn'ˆblÚg”hª 45…rš‹d ch¬aù”s.\n", 
ch
);

3464 
	`£t_t™Ë
(
ch
, 
¬gum’t
);

3465 
	`±c
(
ch
, "T™Ë chªgedo: %s\n", ch->
pcd©a
->
t™Ë
);

3466 
	}
}

3474 
	$do_immÇme
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3476 ià(
ch
->
	`is_Åc
())

3479 
buf
[
MIL
];

3480 
FÜm©
::
	`¥rštf
(
buf
, "immÜÈimmÇm%s", 
¬gum’t
);

3481 
	`do_cÚfig
(
ch
, 
buf
);

3482 
	}
}

3484 
	$do_desütiÚ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3486 
SŒšg
 
buf
;

3488 ià(!
¬gum’t
.
	`em±y
()) {

3489 ià(
¬gum’t
[0] == '-') {

3490 
Ën
;

3491 
boŞ
 
found
 = 
çl£
;

3493 ià(
ch
->
desütiÚ
.
	`em±y
()) {

3494 
	`¡c
("NØlše ËáØ»move.\n", 
ch
);

3498 
buf
 = 
ch
->
desütiÚ
;

3500 
Ën
 = 
	`¡¾’
(
buf
);†en > 0;†en--) {

3501 ià(
buf
[
Ën
] == '\n') {

3502 ià(!
found
) {

3503 ià(
Ën
 > 0)

3504 
Ën
--;

3506 
found
 = 
Œue
;

3509 
buf
.
	`”a£
(
Ën
 + 1);

3510 
ch
->
desütiÚ
 = 
buf
;

3511 
	`£t_cŞÜ
(
ch
, 
PURPLE
, 
NOBOLD
);

3512 
	`¡c
("You¸desütiÚ is:\n", 
ch
);

3513 
	`¡c
(
ch
->
desütiÚ
.
	`em±y
() ? "(None).\n" : ch->description, ch);

3514 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

3520 
buf
.
	`ş—r
();

3521 
ch
->
desütiÚ
 = 
buf
;

3522 
	`¡c
("DesütiÚ cË¬ed.\n", 
ch
);

3526 ià(
¬gum’t
[0] == '+') {

3527 
buf
 +ğ
ch
->
desütiÚ
;

3528 
¬gum’t
 =‡rgum’t.
	`sub¡r
(1).
	`l¡r
();

3531 ià(
	`¡¾’
(
buf
è+ sŒËn(
¬gum’t
è>ğ
MAX_STRING_LENGTH
 - 2) {

3532 
	`¡c
("DesütiÚoØlÚg.\n", 
ch
);

3536 
buf
 +ğ
¬gum’t
;

3537 
buf
 += "\n";

3538 
ch
->
desütiÚ
 = 
buf
;

3541 
	`£t_cŞÜ
(
ch
, 
PURPLE
, 
NOBOLD
);

3542 
	`¡c
("You¸desütiÚ is:\n", 
ch
);

3543 
	`¡c
(
ch
->
desütiÚ
.
	`em±y
() ? "(None).\n" : ch->description, ch);

3544 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

3546 
	}
}

3549 
	$do_fšg”šfo
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3551 
SŒšg
 
buf
;

3553 ià(
ch
->
	`is_Åc
())

3556 ià(!
¬gum’t
.
	`em±y
()) {

3557 ià(
¬gum’t
 == "clear") {

3558 
ch
->
pcd©a
->
fšg”šfo
.
	`”a£
();

3559 
	`¡c
("Fšg”šfØş—»d.\n", 
ch
);

3562 ià(
¬gum’t
[0] == '-') {

3563 
Ën
;

3564 
boŞ
 
found
 = 
çl£
;

3566 ià(
ch
->
pcd©a
->
fšg”šfo
.
	`em±y
()) {

3567 
	`¡c
("NØlše ËáØ»move.\n", 
ch
);

3571 
buf
 = 
ch
->
pcd©a
->
fšg”šfo
;

3573 
Ën
 = 
	`¡¾’
(
buf
);†en > 0;†en--) {

3574 ià(
buf
[
Ën
] == '\n') {

3575 ià(!
found
) {

3576 ià(
Ën
 > 0)

3577 
Ën
--;

3579 
found
 = 
Œue
;

3582 
buf
.
	`”a£
(
Ën
 + 1);

3583 
ch
->
pcd©a
->
fšg”šfo
 = 
buf
;

3584 
	`£t_cŞÜ
(
ch
, 
CYAN
, 
NOBOLD
);

3585 
	`±c
(
ch
, "Your finger info is:\n%s",

3586 
ch
->
pcd©a
->
fšg”šfo
.
	`em±y
() ?

3587 "(NÚe).\n" : 
ch
->
pcd©a
->
fšg”šfo
);

3588 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

3594 
buf
.
	`ş—r
();

3595 
ch
->
pcd©a
->
fšg”šfo
.
	`”a£
();

3596 
	`¡c
("Fšg” InfØş—»d.\n", 
ch
);

3598 ià(
¬gum’t
[0] == '+') {

3599 
buf
 +ğ
ch
->
pcd©a
->
fšg”šfo
;

3600 
¬gum’t
 =‡rgum’t.
	`sub¡r
(1).
	`l¡r
();

3603 
	`¡c
("Syntax:\n"

3607 " fšg”šfØş—¸ (ş—r you¸fšg”šfo)\n", 
ch
);

3611 ià(
	`¡¾’
(
buf
è+ sŒËn(
¬gum’t
è>ğ
MAX_STRING_LENGTH
 - 2) {

3612 
	`¡c
("Fšg” infØtoØlÚg.\n", 
ch
);

3616 
buf
 +ğ
¬gum’t
;

3617 
buf
 += "\n";

3618 
ch
->
pcd©a
->
fšg”šfo
 = 
buf
;

3621 
	`£t_cŞÜ
(
ch
, 
CYAN
, 
NOBOLD
);

3622 
	`±c
(
ch
, "Your finger info is:\n"

3624 
ch
->
pcd©a
->
fšg”šfo
.
	`em±y
() ?

3626 
ch
->
pcd©a
->
fšg”šfo
);

3627 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

3628 
	}
}

3630 
	$do_»pÜt
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3632 
buf
[
MAX_INPUT_LENGTH
];

3634 
SŒšg
 
¬g
;

3635 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

3637 
	`±c
(
ch
,

3639 
ch
->
h™
, 
	`GET_MAX_HIT
(ch),

3640 
ch
->
mªa
, 
	`GET_MAX_MANA
(ch),

3641 
ch
->
¡am
, 
	`GET_MAX_STAM
(ch),

3642 
ch
->
exp
);

3643 
FÜm©
::
	`¥rštf
(
buf
, "$n says 'I have %d/%d hp %d/%d mana %d/%d st %d xp.'",

3644 
ch
->
h™
, 
	`GET_MAX_HIT
(ch),

3645 
ch
->
mªa
, 
	`GET_MAX_MANA
(ch),

3646 
ch
->
¡am
, 
	`GET_MAX_STAM
(ch),

3647 
ch
->
exp
);

3648 
	`aù
(
buf
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3650 ià(!
	`¡rcmp
(
¬g
, "all")) {

3651 ià(
afãù
::
	`li¡_ch¬
(
ch
è!ğ
nuÎ±r
) {

3652 
	`¡c
("You say 'I‡m‡fãùed byhfŞlowšg s³Îs:'\n", 
ch
);

3653 
	`aù
("$À§y 'I‡m‡fãùed byhfŞlowšg s³Îs:'", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3655 cÚ¡ 
afãù
::
Afãù
 *
·f_Ï¡
 = 
nuÎ±r
;

3656 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_ch¬
(
ch
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
) {

3657 ià(
·f_Ï¡
 !ğ
nuÎ±r
 && 
·f
->
ty³
 ==…af_last->type)

3660 
	`±c
(
ch
, "You say 'S³Î: %-15s'\n", 
afãù
::
	`lookup
(
·f
->
ty³
).
Çme
);

3661 
FÜm©
::
	`¥rštf
(
buf
, "$À§y 'S³Î: %-15s'", 
afãù
::
	`lookup
(
·f
->
ty³
).
Çme
);

3662 
	`aù
(
buf
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3666 
	`¡c
("You say 'I‡m‚Ù‡fãùed by‡ny s³Îs.'\n", 
ch
);

3667 
	`aù
("$À§y 'I‡m‚Ù‡fãùed by‡ny s³Îs.'", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3672 
	}
}

3675 
	$´ac_by_group
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

3677 cÚ¡ 
group_ty³
 *
gp
;

3678 
boŞ
 
group_fœ¡
;

3679 
skl
::
ty³
 
¢
;

3680 
buf
[50];

3681 
SŒšg
 
lše
;

3682 
lše_cŞs
 = 0;

3683 
SŒšg
 
ouut
;

3685 
gt
 = 0; gˆ< 
group_bË
.
	`size
(); gt++) {

3686 ià(!
ch
->
pcd©a
->
group_known
[
gt
])

3689 
gp
 = &
group_bË
[
gt
];

3691 ià(
gp
->
¿tšg
[
ch
->
gud
] < 0)

3694 ià(!
¬gum’t
.
	`em±y
(è&& !¬gum’t.
	`is_´efix_of
(
gp
->
Çme
))

3697 
group_fœ¡
 = 
Œue
;

3699 
js
 = 0; j < 
gp
->
¥–ls
.
	`size
(); js++) {

3700 
¢
 = 
skl
::
	`lookup
(
gp
->
¥–ls
[
js
]);

3702 ià(
¢
 =ğ
skl
::
ty³
::
unknown
)

3705 ià(
	`g‘_u§bË_Ëv–
(
¢
, 
ch
->
gud
è> ch->
Ëv–
)

3708 
Ë¬Ãd
 = 
	`g‘_Ë¬Ãd
(
ch
, 
¢
);

3710 ià(
Ë¬Ãd
 <= 0)

3714 ià(
group_fœ¡
) {

3715 
FÜm©
::
	`¥rštf
(
buf
, "%s:", 
gp
->
Çme
);

3717 
FÜm©
::
	`¥rštf
(
lše
, "{G%-25.25s{x ", 
buf
);

3718 
ouut
 +ğ
lše
;

3719 
ouut
 += "\n";

3720 
lše
.
	`”a£
();

3721 
lše_cŞs
 = 0;

3722 
group_fœ¡
 = 
çl£
;

3725 ià(
lše_cŞs
 >= 3) {

3726 
ouut
 +ğ
lše
;

3727 
ouut
 += "\n";

3728 
lše
.
	`”a£
();

3729 
lše_cŞs
 = 0;

3732 
FÜm©
::
	`¥rštf
(
buf
, "%3d%% %-20.20 ", 
Ë¬Ãd
,

3733 
gp
->
¥–ls
[
js
]);

3734 
lše
 +ğ
buf
;

3735 
lše_cŞs
++;

3738 ià(
lše_cŞs
 > 0) {

3739 
ouut
 +ğ
lše
;

3740 
ouut
 += "\n";

3741 
lše
.
	`”a£
();

3742 
lše_cŞs
 = 0;

3746 
FÜm©
::
	`¥rštf
(
buf
, "You hav%d…¿ùiû sessiÚ Ëá.\n", 
ch
->
´aùiû
);

3747 
ouut
 +ğ
buf
;

3748 
	`·ge_to_ch¬
(
ouut
, 
ch
);

3749 
	}
}

3752 
	$´ac_by_key
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
key
, cÚ¡ *
¬gum’t
)

3754 
skl
::
ty³
 
¦i¡
[skl::
	`num_skls
()];

3755 
nskls
 = 0;

3756 
js
;

3757 

;

3758 
ad•t
;

3759 
buf
[50];

3760 
lše_cŞs
 = 0;

3761 
SŒšg
 
ouut
;

3763 
SŒšg
 
¬g
;

3764 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

3767 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

3768 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

3769 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

3771 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

3774 ià(
’Œy
.
»mÜt_gud
 !ğ
Gud
::
nÚe
)

3775 ià(!
	`CAN_USE_RSKILL
(
ch
, 
ty³
))

3778 ià(
	`g‘_u§bË_Ëv–
(
ty³
, 
ch
->
gud
è> ch->
Ëv–
)

3781 ià(
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) <= 0)

3784 ià(!
¬g
.
	`em±y
(è&& !¬g.
	`is_´efix_of
(
’Œy
.
Çme
))

3788 

 = 
nskls
;

3790 ià(
key
[0] == '%') {

3791 

 > 0 &&

3792 (
	`g‘_Ë¬Ãd
(
ch
, 
¦i¡
[

 - 1]) <

3793 
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) ||

3794 (
	`g‘_Ë¬Ãd
(
ch
, 
¦i¡
[

 - 1]) ==

3795 
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) &&

3796 
	`¡rcmp
(
skl
::
	`lookup
(
¦i¡
[

 - 1]).
Çme
,

3797 
’Œy
.
Çme
) > 0))) {

3798 
¦i¡
[

] = slist[ip - 1];

3799 

--;

3803 

 > 0 && 
	`¡rcmp
(
skl
::
	`lookup
(
¦i¡
[ - 1]).
Çme
,

3804 
’Œy
.
Çme
) > 0) {

3805 
¦i¡
[

] = slist[ip - 1];

3806 

--;

3810 
¦i¡
[

] = 
ty³
;

3811 
nskls
++;

3815 
lše_cŞs
 = 0;

3817 
js
 = 0; j < 
nskls
; js++) {

3818 cÚ¡‡uto& 
’Œy
 = 
skl
::
	`lookup
(
¦i¡
[
js
]);

3820 ià(
’Œy
.
»mÜt_gud
 !ğ
Gud
::
nÚe
) {

3821 ià(
’Œy
.
»mÜt_gud
 =ğ
ch
->
gud
)

3822 
ad•t
 = 65;

3824 
ad•t
 = 50;

3827 
ad•t
 = 
gud_bË
[
ch
->
gud
].
skl_ad•t
;

3829 
ouut
 +ğ
FÜm©
::
	`fÜm©
("%s%3d%% %-20.20s{x ",

3830 
	`g‘_Ë¬Ãd
(
ch
, 
¦i¡
[
js
]è>ğ
ad•t
 ? "{g" : "{C",

3831 
	`g‘_Ë¬Ãd
(
ch
, 
¦i¡
[
js
]),

3832 
’Œy
.
Çme
);

3833 
lše_cŞs
++;

3835 ià(
lše_cŞs
 >= 3) {

3836 
ouut
 += "\n";

3837 
lše_cŞs
 = 0;

3841 ià(
lše_cŞs
 > 0)

3842 
ouut
 += "\n";

3844 
FÜm©
::
	`¥rštf
(
buf
, "You hav%d…¿ùiû sessiÚ Ëá.\n", 
ch
->
´aùiû
);

3845 
ouut
 +ğ
buf
;

3846 
	`·ge_to_ch¬
(
ouut
, 
ch
);

3847 
	}
}

3849 
	$do_´aùiû
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3851 
buf
[
MAX_STRING_LENGTH
];

3852 
Ch¬aù”
 *
mob
;

3853 
ad•t
, 
šü—£
;

3855 ià(
ch
->
	`is_Åc
()) {

3856 
	`¡c
("You dÚ'ˆÃedØ´aùiû‡nythšg.\n", 
ch
);

3860 ià(
ch
->
gud
 =ğ
Gud
::
nÚe
) {

3861 
	`¡c
("Još‡ gud iàyou wªˆtØË¬Àsomskls.\n", 
ch
);

3866 
SŒšg
 
¬g
;

3867 cÚ¡ *
¬g
 = 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

3869 ià(
¬g
.
	`em±y
()) {

3870 
	`´ac_by_key
(
ch
, "abc", "");

3873 ià(
¬g
.
	`is_´efix_of
("groups")) {

3874 
	`´ac_by_group
(
ch
, 
¬g
);

3877 ià(
¬g
.
	`is_´efix_of
("abc") ||

3878 
¬g
.
	`is_´efix_of
("%")) {

3879 
	`´ac_by_key
(
ch
, 
¬g
, 
¬g
);

3886 ià(!
	`IS_AWAKE
(
ch
)) {

3887 
	`¡c
("IÀyou¸d»ams, o¸wh©?\n", 
ch
);

3891 
mob
 = 
ch
->
š_room
->
³İË
; mob !ğ
nuÎ±r
; mob = mob->
Ãxt_š_room
) {

3892 ià(
mob
->
	`is_Åc
(è&& mob->
aù_æags
.
	`has
(
ACT_PRACTICE
))

3896 ià(
mob
 =ğ
nuÎ±r
) {

3897 
	`¡c
("You cª'ˆdØth© h”e.\n", 
ch
);

3901 ià(
ch
->
´aùiû
 <= 0) {

3902 
	`¡c
("You havnØ´aùiû sessiÚ Ëá.\n", 
ch
);

3906 
skl
::
ty³
 
¢
 = 
	`fšd_¥–l
(
ch
, 
¬gum’t
);

3907 cÚ¡‡uto& 
’Œy
 = 
skl
::
	`lookup
(
¢
);

3909 ià(
¢
 =ğ
skl
::
ty³
::
unknown


3910 || (!
ch
->
	`is_Åc
()

3911 && (
ch
->
Ëv–
 < 
	`g‘_u§bË_Ëv–
(
¢
, ch->
gud
)

3912 || 
	`g‘_Ë¬Ãd
(
ch
, 
¢
) < 1

3913 || 
’Œy
.
¿tšg
[
ch
->
gud
] == 0))) {

3914 
	`¡c
("You cª'ˆ´aùiûh©.\n", 
ch
);

3918 ià(
’Œy
.
»mÜt_gud
 !ğ
Gud
::
nÚe
)

3919 ià(!
	`CAN_USE_RSKILL
(
ch
, 
¢
)) {

3920 
	`¡c
("You cª'ˆ´aùiûh©.\n", 
ch
);

3924 
ad•t
 = 0;

3926 ià(
’Œy
.
»mÜt_gud
 !ğ
Gud
::
nÚe
) {

3927 ià(
’Œy
.
»mÜt_gud
 =ğ
ch
->
gud
)

3928 
ad•t
 = 65;

3929 ià(
	`HAS_EXTRACLASS
(
ch
, 
¢
))

3930 
ad•t
 = 50;

3933 
ad•t
 = 
ch
->
	`is_Åc
(è? 100 : 
gud_bË
[ch->
gud
].
skl_ad•t
;

3935 ià(
	`g‘_Ë¬Ãd
(
ch
, 
¢
è>ğ
ad•t
) {

3936 
FÜm©
::
	`¥rštf
(
buf
, "You‡re‡lready†earned‡t %s.\n",

3937 
’Œy
.
Çme
);

3938 
	`¡c
(
buf
, 
ch
);

3942 
ch
->
´aùiû
--;

3943 
šü—£
 = (
št_­p
[
	`GET_ATTR_INT
(
ch
)].
Ë¬n
 / 
’Œy
.
¿tšg
[ch->
gud
]);

3945 ià(
šü—£
 < 1)

3946 
šü—£
 = 1;

3948 
	`£t_Ë¬Ãd
(
ch
, 
¢
, 
	`g‘_Ë¬Ãd
(ch, snè+ 
šü—£
);

3950 ià(
	`g‘_Ë¬Ãd
(
ch
, 
¢
è< 
ad•t
) {

3951 
	`aù
("You…ractice $T.",

3952 
ch
, 
nuÎ±r
, 
’Œy
.
Çme
, 
TO_CHAR
);

3953 
	`aù
("$n…ractices $T.",

3954 
ch
, 
nuÎ±r
, 
’Œy
.
Çme
, 
TO_ROOM
);

3957 
	`£t_Ë¬Ãd
(
ch
, 
¢
, 
ad•t
);

3958 
	`aù
("You‡re‚ow†earned‡t $T.",

3959 
ch
, 
nuÎ±r
, 
’Œy
.
Çme
, 
TO_CHAR
);

3960 
	`aù
("$n is‚ow†earned‡t $T.",

3961 
ch
, 
nuÎ±r
, 
’Œy
.
Çme
, 
TO_ROOM
);

3963 
	}
}

3969 
	$do_wimpy
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3971 
buf
[
MAX_STRING_LENGTH
];

3972 
wimpy
;

3974 
SŒšg
 
¬g
;

3975 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

3977 ià(
¬g
.
	`em±y
())

3978 
wimpy
 = 
	`GET_MAX_HIT
(
ch
) / 5;

3980 
wimpy
 = 
	`©oi
(
¬g
);

3982 ià(
wimpy
 < 0) {

3983 
	`¡c
("You¸cou¿gexûed you¸wisdom.\n", 
ch
);

3987 ià(
wimpy
 > 
	`GET_MAX_HIT
(
ch
) / 2) {

3988 
	`¡c
("CHICKEN!!!!!\n", 
ch
);

3992 
ch
->
wimpy
 = wimpy;

3993 
FÜm©
::
	`¥rštf
(
buf
, "Wimpy s‘Ø%d h™…ošts.\n", 
wimpy
);

3994 
	`¡c
(
buf
, 
ch
);

3996 
	}
}

3998 
	$do_·sswÜd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4000 ià(
ch
->
	`is_Åc
())

4006 
SŒšg
 
¬g1
, 
¬g2
;

4007 
¬gum’t
.
	`l¥l™
(
¬g1
).l¥l™(
¬g2
);

4009 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.empty()) {

4010 
	`¡c
("SyÁax:…asswÜd <Şd> <Ãw>.\n", 
ch
);

4015 ià(
	`¡rcmp
(
¬g1
, 
ch
->
pcd©a
->
pwd
)) {

4016 
	`WAIT_STATE
(
ch
, 40);

4017 
	`¡c
("WrÚg…asswÜd. Wa™ 10 secÚds.\n", 
ch
);

4021 ià(
	`¡¾’
(
¬g2
) < 5) {

4022 
	`¡c
(

4023 "New…asswÜd mu¡ b©†—¡ fivch¬aù” lÚg.\n", 
ch
);

4027 
ch
->
pcd©a
->
pwd
 = 
¬g2
;

4028 
	`§ve_ch¬_obj
(
ch
);

4029 
	`¡c
("PasswÜd Chªged.\n", 
ch
);

4031 
	}
}

4032 
	$do_šv™e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4034 
Ch¬aù”
 *
viùim
;

4035 
buf
[
MAX_STRING_LENGTH
];

4036 
DesütÜ
 *
d
;

4037 
boŞ
 
found
 = 
çl£
;

4039 ià(
¬gum’t
.
	`em±y
()) {

4040 ià(
	`IS_IMMORTAL
(
ch
)) {

4041 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

4042 ià(!
d
->
	`is_¶ayšg
(è|| !
	`ÿn_£e_who
(
ch
, d->
ch¬aù”
))

4045 
viùim
 = (
d
->
Üigš®
 !ğ
nuÎ±r
è? d->Üigš® : d->
ch¬aù”
;

4047 ià(!
	`ÿn_£e_who
(
ch
, 
viùim
))

4050 ià(
viùim
->
šv™”s
 !ğ
nuÎ±r
) {

4051 ià(!
found
) {

4052 
	`¡c
("{M[{YNam {M][{YInv™šg CÏÀ {M][{YStu  {M]\n", 
ch
);

4053 
	`¡c
("--------------------------------------------------------{x\n", 
ch
);

4056 
FÜm©
::
	`¥rštf
(
buf
, "{M[{Y%-12s{M][{Y%-30s{M][{Y%-8s{M]{x\n", 
viùim
->
Çme
,

4057 
viùim
->
šv™”s
->
şªÇme
,

4058 (
viùim
->
šv™©iÚ_acû±ed
 =ğ
Œue
) ? "accepted" : "invited");

4059 
	`¡c
(
buf
, 
ch
);

4060 
found
 = 
Œue
;

4064 ià(!
found
)

4065 
	`¡c
("Th”¬cu¼’y‚Øšv™ed…Ïy”s.\n", 
ch
);

4068 ià(!
ch
->
	`has_cgroup
(
GROUP_LEADER
 | 
GROUP_DEPUTY
)) {

4069 
	`¡c
("OÆy†—d” Ü d•ut› oàyou¸şª may s’d ouˆšv™©iÚs.\n", 
ch
);

4073 
	`¡c
("You mu¡ s³cify‡‚amiàyou wªˆtØšv™someÚe.\n", 
ch
);

4079 
SŒšg
 
¬g1
;

4080 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

4082 ià(
¬g1
 == "terminate") {

4083 ià(
¬gum’t
.
	`em±y
()) {

4084 ià((
ch
->
šv™”s
 !ğ
nuÎ±r
)) {

4085 
	`¡c
("You hav‹rmš©ed you¸šv™©iÚ.\n", 
ch
);

4086 
ch
->
šv™”s
 = 
nuÎ±r
;

4087 
ch
->
šv™©iÚ_acû±ed
 = 
çl£
;

4097 
	`¡c
("NØÚha šv™edhlike oàyou!\n", 
ch
);

4101 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬gum’t
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

4102 
	`¡c
("Th³rsÚ you wªˆtØunšv™i nÙ h”e.\n", 
ch
);

4106 ià(
viùim
->
šv™”s
 !ğ
nuÎ±r
) {

4107 ià(
viùim
->
šv™”s
 =ğ
ch
->
şª
) {

4108 
	`¡c
("You hav‹rmš©edheœ inv™©iÚ.\n", 
ch
);

4109 
FÜm©
::
	`¥rštf
(
buf
, "% ha ‹rmš©ed you¸šv™©iÚ.\n", 
ch
->
Çme
);

4110 
viùim
->
šv™”s
 = 
nuÎ±r
;

4111 
viùim
->
šv™©iÚ_acû±ed
 = 
çl£
;

4112 
	`¡c
(
buf
, 
viùim
);

4115 
	`¡c
("Th©…Ïy” i nÙ inv™edØyou¸şª!\n", 
ch
);

4118 
	`¡c
("Th©…Ïy” i nÙ inv™edØyou¸şª!\n", 
ch
);

4122 
	`¡c
("Th©…Ïy” ha nÙ b“Àšv™ed.\n", 
ch
);

4126 ià(!
	`¡rcmp
(
¬g1
, "accept")) {

4127 ià(
ch
->
šv™”s
 =ğ
nuÎ±r
) {

4128 
	`¡c
("NØÚha šv™edhlike oàyou!\n", 
ch
);

4132 ià(
ch
->
šv™©iÚ_acû±ed
 =ğ
Œue
) {

4133 
	`¡c
("You hav®»ady‡cû±edhšv™©iÚ!\n", 
ch
);

4137 ià(!
	`deduù_co¡
(
ch
, 10000)) {

4138 
	`¡c
("You mu¡ hav©†—¡ 100 gŞdØacû±‡Àšv™©iÚ.\n", 
ch
);

4142 
	`¡c
("You havacû±edheœ inv™©iÚ.\n", 
ch
);

4143 
ch
->
šv™©iÚ_acû±ed
 = 
Œue
;

4145 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

4146 
viùim
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

4148 ià(
d
->
	`is_¶ayšg
()

4149 && 
d
->
ch¬aù”
 !ğ
ch


4150 && ((
ch
->
šv™”s
 =ğ
d
->
ch¬aù”
->
şª
)

4151 || 
	`IS_IMMORTAL
(
d
->
ch¬aù”
))

4152 && !
d
->
ch¬aù”
->
comm_æags
.
	`has
(
COMM_NOCLAN
)

4153 && !
d
->
ch¬aù”
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

4154 
	`Ãw_cŞÜ
(
d
->
ch¬aù”
, 
CSLOT_CHAN_CLAN
);

4156 ià(
	`IS_IMMORTAL
(
d
->
ch¬aù”
)) {

4157 
FÜm©
::
	`¥rštf
(
buf
, "%s",

4158 
ch
->
šv™”s
->
who_Çme
.
	`uncŞÜ
());

4159 
	`¡c
(
buf
, 
d
->
ch¬aù”
);

4162 
FÜm©
::
	`¥rštf
(
buf
, "%s has‡ccepted‡n invitationoƒnterhe clan hall",

4163 
ch
->
Çme
);

4164 
	`aù
("CÏÀNÙiû: '$t{x'", 
ch
, 
buf
, 
d
->
ch¬aù”
, 
TO_VICT
, 
POS_DEAD
, 
çl£
);

4165 
	`£t_cŞÜ
(
d
->
ch¬aù”
, 
WHITE
, 
NOBOLD
);

4172 ià(!
	`¡rcmp
(
¬g1
, "decline")) {

4173 ià(
ch
->
šv™”s
 =ğ
nuÎ±r
) {

4174 
	`¡c
("NØÚha šv™edhlike oàyou!\n", 
ch
);

4178 ià(
ch
->
šv™©iÚ_acû±ed
 =ğ
Œue
) {

4179 
	`¡c
("You hav®»ady‡cû±edhšv™©iÚ!\n", 
ch
);

4183 
	`¡c
("You havdeşšedheœ inv™©iÚ.\n", 
ch
);

4185 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

4186 
viùim
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

4188 ià(
d
->
	`is_¶ayšg
()

4189 && 
d
->
ch¬aù”
 !ğ
ch


4190 && ((
ch
->
šv™”s
 =ğ
d
->
ch¬aù”
->
şª
)

4191 || 
	`IS_IMMORTAL
(
d
->
ch¬aù”
))

4192 && !
d
->
ch¬aù”
->
comm_æags
.
	`has
(
COMM_NOCLAN
)

4193 && !
d
->
ch¬aù”
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

4194 
	`Ãw_cŞÜ
(
d
->
ch¬aù”
, 
CSLOT_CHAN_CLAN
);

4196 ià(
	`IS_IMMORTAL
(
d
->
ch¬aù”
)) {

4197 
FÜm©
::
	`¥rštf
(
buf
, "%s",

4198 
ch
->
šv™”s
->
who_Çme
.
	`uncŞÜ
());

4199 
	`¡c
(
buf
, 
d
->
ch¬aù”
);

4202 
FÜm©
::
	`¥rštf
(
buf
, "%s has declined‡n invitationoƒnterhe clan hall",

4203 
ch
->
Çme
);

4204 
	`aù
("CÏÀNÙiû: '$t{x'", 
ch
, 
buf
, 
d
->
ch¬aù”
, 
TO_VICT
, 
POS_DEAD
, 
çl£
);

4205 
	`£t_cŞÜ
(
d
->
ch¬aù”
, 
WHITE
, 
NOBOLD
);

4209 
ch
->
šv™”s
 = 
nuÎ±r
;

4210 
ch
->
šv™©iÚ_acû±ed
 = 
çl£
;

4214 ià(!
ch
->
	`has_cgroup
(
GROUP_LEADER
 | 
GROUP_DEPUTY
)) {

4215 
	`¡c
("OÆy†—d” Ü d•ut› oàyou¸şª may s’d ouˆšv™©iÚs.\n", 
ch
);

4219 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g1
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

4220 
	`¡c
("Th³rsÚ you wªˆtØšv™i nÙ h”e.\n", 
ch
);

4224 ià(
viùim
->
	`is_Åc
()) {

4225 
	`¡c
("You cªnÙ inv™mobe tØyou¸şª h®l.\n", 
ch
);

4229 ià(
viùim
->
šv™”s
 !ğ
nuÎ±r
) {

4230 ià(
viùim
->
šv™”s
 =ğ
ch
->
şª
)

4231 
	`¡c
("They‡Ì—dy havª inv™©iÚØyou¸şª h®l.\n", 
ch
);

4233 
	`¡c
("They‡Ì—dy havª inv™©iÚØ¨difã»Á cÏÀh®l.\n", 
ch
);

4238 ià(
viùim
 =ğ
ch
) {

4239 
	`¡c
("F“lšg†Ú–y?\n", 
ch
);

4243 ià(
viùim
->
şª
 =ğ
ch
->clan) {

4244 
	`¡c
("They dÚ'ˆÃed‡Àšv™©iÚØ’‹¸you¸şª h®l.\n", 
ch
);

4248 
viùim
->
šv™”s
 = 
ch
->
şª
;

4249 
viùim
->
šv™©iÚ_acû±ed
 = 
çl£
;

4250 
FÜm©
::
	`¥rštf
(
buf
, "You havšv™ed % tØ’‹¸you¸şª h®l.\n", 
viùim
->
Çme
);

4251 
	`¡c
(
buf
, 
ch
);

4252 
FÜm©
::
	`¥rštf
(
buf
, "% ha šv™ed youØ’‹¸thşª h®Èoà%s.\n", 
ch
->
Çme
,

4253 
ch
->
şª
->
şªÇme
);

4254 
	`¡c
(
buf
, 
viùim
);

4255 
	}
}

4257 
	$do_još
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4259 
Ch¬aù”
 *
viùim
;

4261 ià(
	`IS_IMMORTAL
(
ch
)) {

4262 
	`¡c
("U£ 'gud' in¡—d.\n", 
ch
);

4266 ià(!
ch
->
şª
 || !ch->
	`has_cgroup
(
GROUP_LEADER
 | 
GROUP_DEPUTY
)) {

4267 
	`do_huh
(
ch
);

4271 ià(
¬gum’t
.
	`em±y
()) {

4272 
	`¡c
("Whom dØwªˆtØjoš you¸şª?\n", 
ch
);

4276 
SŒšg
 
¬g
;

4277 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

4279 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

4280 
	`¡c
("They‡»n'ˆ¶ayšg.\n", 
ch
);

4284 ià(
viùim
->
Ëv–
 < 15 && !
	`IS_REMORT
(victim)) {

4285 
	`¡c
("They‡»oØšex³r›nûdØjoš you¸şª.\n", 
ch
);

4289 ià(
	`IS_IMMORTAL
(
viùim
)) {

4290 
	`¡c
("You cªnÙ još immÜls.\n", 
ch
);

4294 ià(
viùim
->
şª
) {

4295 
	`¡c
("They'»‡Ì—dy iÀ¨şª.\n", 
ch
);

4299 ià(
	`g‘_du–
(
viùim
)) {

4300 
	`¡c
("Wa™ uÁhey fšishheœ du–.\n", 
ch
);

4305 
viùim
->
	`»move_cgroup
(
GROUP_LEADER
);

4306 
viùim
->
	`»move_cgroup
(
GROUP_DEPUTY
);

4307 
viùim
->
	`add_cgroup
(
GROUP_CLAN
);

4308 
viùim
->
şª
 = 
ch
->clan;

4309 
viùim
->
pcd©a
->
que¡pošts_dÚ©ed
 = 0;

4310 
viùim
->
pcd©a
->
gŞd_dÚ©ed
 = 0;

4311 
	`§ve_ch¬_obj
(
viùim
);

4312 
	`±c
(
ch
, "Thch¬aù” i now‡ memb” oà%s.\n", ch->
şª
->
şªÇme
);

4313 
	`±c
(
viùim
, "You‡»‚ow‡ memb” oà%s.\n", 
ch
->
şª
->
şªÇme
);

4314 
	}
}

4319 
Objeù
 *
	$v­e_ûq_»cursive
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, 
d•th
) {

4320 ià(
obj
 =ğ
nuÎ±r
)

4321  
nuÎ±r
;

4324 
obj
->
Ãxt_cÚ‹Á
 = 
	`v­e_ûq_»cursive
(
ch
, obj->Ãxt_cÚ‹Á, 
d•th
);

4327 
obj
->
cÚšs
 = 
	`v­e_ûq_»cursive
(
ch
, obj->cÚšs, 
d•th
+1);

4330 
obj
->
gems
 = 
	`v­e_ûq_»cursive
(
ch
, obj->gems, 
d•th
);

4333 ià(
obj
->
pIndexD©a
->
vnum
 < 
ch
->
şª
->
¬—_mšvnum


4334 || 
obj
->
pIndexD©a
->
vnum
 > 
ch
->
şª
->
¬—_maxvnum
)

4335  
obj
;

4338 ià(
d•th
 > 0)

4339 
	`¡c
("You h—¸¨mufæed {Yex¶osiÚ{x‡nd sm–È{gsmoke{x from you¸b–Úgšgs.\n\r", 
ch
);

4341 
	`±c
(
ch
, "% {Yex¶ode viŞ’y{x,†—všg oÆy‡ cloud oà{gsmoke{x.\n", 
obj
->
shÜt_desü
);

4344 
Objeù
 *
´ev
, *
o
, *
o_Ãxt
;

4347 
o
 = 
obj
->
cÚšs
, 
´ev
 = 
nuÎ±r
; o; o = 
o_Ãxt
) {

4348 
o_Ãxt
 = 
o
->
Ãxt_cÚ‹Á
;

4351 ià(
d•th
 =ğ0 && 
o
->
™em_ty³
 =ğ
ITEM_MONEY
) {

4352 
ch
->
sv”
 +ğ
o
->
v®ue
[0];

4353 
ch
->
gŞd
 +ğ
o
->
v®ue
[1];

4356 ià(
´ev
)

4357 
´ev
->
Ãxt_cÚ‹Á
 = 
o
->
Ãxt
;

4359 
o
->
š_room
 = 
nuÎ±r
;

4360 
o
->
ÿ¼›d_by
 = 
nuÎ±r
;

4361 
o
->
š_obj
 = 
nuÎ±r
;

4362 
o
->
š_lock”
 = 
nuÎ±r
;

4363 
o
->
š_¡rÚgbox
 = 
nuÎ±r
;

4364 
	`exŒaù_obj
(
o
);

4368 
o
->
š_obj
 = 
obj
->in_obj;

4369 
´ev
 = 
o
;

4373 ià(
´ev
) {

4374 
´ev
->
Ãxt_cÚ‹Á
 = 
obj
->next_content;

4375 
obj
->
Ãxt_cÚ‹Á
 = obj->
cÚšs
;

4376 
obj
->
cÚšs
 = 
nuÎ±r
;

4380 
o
 = 
obj
->
gems
, 
´ev
 = 
nuÎ±r
; o; o = 
o_Ãxt
) {

4381 
o_Ãxt
 = 
o
->
Ãxt
;

4382 
o
->
š_obj
 = 
obj
->in_obj;

4383 
´ev
 = 
o
;

4387 ià(
´ev
) {

4388 
´ev
->
Ãxt_cÚ‹Á
 = 
obj
->next_content;

4389 
obj
->
Ãxt_cÚ‹Á
 = obj->
gems
;

4390 
obj
->
gems
 = 
nuÎ±r
;

4395 
Objeù
 *
survivšg
 = 
obj
->
Ãxt_cÚ‹Á
;

4398 
obj
->
š_room
 = 
nuÎ±r
;

4399 
obj
->
ÿ¼›d_by
 = 
nuÎ±r
;

4400 
obj
->
š_obj
 = 
nuÎ±r
;

4401 
obj
->
š_lock”
 = 
nuÎ±r
;

4402 
obj
->
š_¡rÚgbox
 = 
nuÎ±r
;

4403 
	`exŒaù_obj
(
obj
);

4404  
survivšg
;

4405 
	}
}

4407 
	$v­e_ûq
(
Ch¬aù”
 *
ch
)

4409 
ch
->
ÿ¼yšg
 = 
	`v­e_ûq_»cursive
(ch, ch->carrying, 0);

4410 
	}
}

4412 
	$do_unjoš
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4414 
Ch¬aù”
 *
viùim
;

4415 
CÏn
 *
şª
;

4417 ià(
	`IS_IMMORTAL
(
ch
)) {

4418 
	`¡c
("U£ 'gud' in¡—d.\n", 
ch
);

4422 ià(!
ch
->
şª
 || !ch->
	`has_cgroup
(
GROUP_LEADER
)) {

4423 
	`do_huh
(
ch
);

4427 ià(
¬gum’t
.
	`em±y
()) {

4428 
	`¡c
("Whom dØwªˆtØ»moväom you¸şª?\n", 
ch
);

4432 
SŒšg
 
¬g
;

4433 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

4435 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

4436 
	`¡c
("They‡»n'ˆ¶ayšg.\n", 
ch
);

4440 ià(
viùim
->
şª
 !ğ
ch
->clan) {

4441 
	`¡c
("They'»‚Ù iÀyou¸şª.\n", 
ch
);

4445 ià(
	`IS_IMMORTAL
(
viùim
)) {

4446 
	`¡c
("You cªnÙ unjoš immÜls.\n", 
ch
);

4450 ià(
	`g‘_du–
(
viùim
)) {

4451 
	`¡c
("Wa™ uÁhey fšishheœ du–.\n", 
ch
);

4455 ià(
viùim
->
	`has_cgroup
(
GROUP_LEADER
)) {

4456 
	`¡c
("They mu¡ bd–—d”ed fœ¡.\n", 
ch
);

4462 
	`v­e_ûq
(
viùim
);

4465 
	`±c
(
ch
, "Thch¬aù” i nØlÚg”‡ memb” of: %s\n", ch->
şª
->
şªÇme
);

4466 
	`±c
(
viùim
, "You‡»‚ØlÚg”‡ memb” of: %s\n", 
ch
->
şª
->
şªÇme
);

4467 
şª
 = 
viùim
->clan;

4468 
viùim
->
şª
 = 
nuÎ±r
;

4471 ià(
viùim
->
š_room
->
´ÙÙy³
.
vnum
 >ğ
şª
->
¬—_mšvnum


4472 && 
viùim
->
š_room
->
´ÙÙy³
.
vnum
 <ğ
şª
->
¬—_maxvnum
) {

4473 
	`ch¬_äom_room
(
viùim
);

4474 
	`ch¬_to_room
(
viùim
, 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_ALTAR
))));

4475 
	`do_look
(
ch
, "auto");

4476 
	`¡c
("You havb“À»moved fromhşªh®l.\n", 
viùim
);

4480 
viùim
->
	`»move_cgroup
(
GROUP_LEADER
);

4481 
viùim
->
	`»move_cgroup
(
GROUP_DEPUTY
);

4482 
viùim
->
	`»move_cgroup
(
GROUP_CLAN
);

4483 
viùim
->
pcd©a
->
que¡pošts_dÚ©ed
 = 0;

4484 
viùim
->
pcd©a
->
gŞd_dÚ©ed
 = 0;

4485 
	`§ve_ch¬_obj
(
viùim
);

4486 
	}
}

4490 
	$do_¿nk
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4492 
‹¡
[
MAX_STRING_LENGTH
];

4493 
Ch¬aù”
 *
viùim
;

4495 ià(!
ch
->
	`has_cgroup
(
GROUP_LEADER
 | 
GROUP_DEPUTY
è&& !
	`IS_IMMORTAL
(ch)) {

4496 
	`¡c
("SÜry, oÆy‡†—d” cª chªgşª„ªk.\n", 
ch
);

4500 ià(
¬gum’t
.
	`em±y
()) {

4501 
	`¡c
("Chªgwho£ cÏÀ¿nk?\n", 
ch
);

4505 
SŒšg
 
¬g1
;

4506 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

4508 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g1
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

4509 
	`¡c
("Th¶ay” i nÙ†ogged on.\n", 
ch
);

4513 ià(
viùim
->
şª
 !ğ
ch
->şª && !
	`IS_IMMORTAL
(ch)) {

4514 
	`¡c
("They‡»‚Ù‡ memb” oàyou¸şª.\n", 
ch
);

4518 ià(
¬gum’t
.
	`em±y
()) {

4519 
	`¡c
("Changeheir clan„anko what?\n"

4520 "(u£ 'nÚe'Ø»mov¿nk)\n", 
ch
);

4524 ià(
¬gum’t
.
	`is_´efix_of
("none")) {

4525 
	`¡c
("CÏÀ¿nk„emoved.\n", 
ch
);

4526 
	`¡c
("You¸şª„ªk ha b“À»moved.\n", 
viùim
);

4527 
viùim
->
pcd©a
->
¿nk
.
	`”a£
();

4531 ià(
¬gum’t
.
	`uncŞÜ
().
	`size
() > 3) {

4532 
	`¡c
("SŒšg cªnÙ blÚg”hª 3…rš‹d ch¬aù”s.\n", 
ch
);

4536 ià(
	`¡¾’
(
¬gum’t
) > 25) {

4537 
	`¡c
("SŒšg cªnÙ blÚg”hª 25Ù® ch¬aù”s.\n", 
ch
);

4541 
viùim
->
pcd©a
->
¿nk
 = 
¬gum’t
.
	`ûÁ”
(3);

4542 
FÜm©
::
	`¥rštf
(
‹¡
, "Your‚ew„ank is {W[%s{W]{x.\n",

4543 
viùim
->
pcd©a
->
¿nk
);

4544 
	`¡c
(
‹¡
, 
viùim
);

4545 
	`¡c
("CÏÀ¿nk chªged.\n", 
ch
);

4547 
	}
}

4550 
	$do_´efi
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4552 
	`¡c
("You cªnÙ‡bb»vŸ‹h´efix commªd.\n", 
ch
);

4554 
	}
}

4556 
	$do_´efix
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4558 
buf
[
MAX_INPUT_LENGTH
];

4560 ià(
¬gum’t
.
	`em±y
()) {

4561 ià(
ch
->
´efix
.
	`em±y
()) {

4562 
	`¡c
("You havnØ´efixØş—r.\n", 
ch
);

4566 
	`¡c
("P»fix„emoved.\n", 
ch
);

4567 
ch
->
´efix
.
	`”a£
();

4571 ià(!
ch
->
´efix
.
	`em±y
()) {

4572 
FÜm©
::
	`¥rštf
(
buf
, "P»fix chªgedo: %s.\n", 
¬gum’t
);

4575 
FÜm©
::
	`¥rštf
(
buf
, "P»fix s‘o: %s.\n", 
¬gum’t
);

4577 
	`¡c
(
buf
, 
ch
);

4578 
ch
->
´efix
 = 
¬gum’t
;

4579 
	}
}

4581 
	$do_ema
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4583 
buf
[
MIL
];

4585 ià(
ch
->
	`is_Åc
()) {

4586 
	`do_huh
(
ch
);

4590 ià(
¬gum’t
.
	`em±y
()) {

4591 
	`±c
(
ch
, "You¸cu¼’ˆema‡dd»s is: %s\n", ch->
pcd©a
->
ema
);

4595 
	`¡rıy
(
buf
, 
¬gum’t
);

4596 
ch
->
pcd©a
->
ema
 = 
buf
;

4598 
	`±c
(
ch
, "You¸ema ha b“Àchªgedo: %s\n", 
buf
);

4599 
FÜm©
::
	`¥rštf
(
buf
, "\"%s\" <%s>\n", 
ch
->
Çme
, ch->
pcd©a
->
ema
);

4600 
	`çµ’d
(
EMAIL_FILE
, 
buf
);

4601 
FÜm©
::
	`¥rštf
(
buf
, "$N ha chªgedheœƒmaØ'%s'\n", 
ch
->
pcd©a
->
ema
);

4602 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_MAIL
, 0, 
	`GET_RANK
(ch));

4603 
	}
}

4606 
	$gamešout
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
mÜl
, cÚ¡ SŒšg& 
’Œyex™
, 
šout
)

4608 
Ch¬aù”
 *
viùim
;

4609 
SŒšg
 *
msg±r
;

4610 
buf
[
MAX_INPUT_LENGTH
];

4611 *
p
;

4613 ià(
ch
->
	`is_Åc
()) {

4614 
	`¡c
("Mob dÚ'ˆhav’Œy/ex™ mes§ges!\n", 
ch
);

4618 ià(
mÜl
.
	`em±y
())

4619 
viùim
 = 
ch
;

4621 
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
mÜl
, 
VIS_PLR
);

4623 ià(
viùim
 =ğ
nuÎ±r
) {

4624 
	`aù
("NØ¶ay”‚amed '$t' iÀthgame!", 
ch
, 
mÜl
, 
nuÎ±r
, 
TO_CHAR
);

4629 ià(
šout
 == 'I')

4630 
msg±r
 = &
viùim
->
pcd©a
->
gameš
;

4632 
msg±r
 = &
viùim
->
pcd©a
->
gameout
;

4634 ià(
msg±r
->
	`em±y
()) {

4635 ià(
viùim
 =ğ
ch
)

4636 
	`aù
("You don't have‡ game $t message!",

4637 
ch
, 
’Œyex™
, 
nuÎ±r
, 
TO_CHAR
);

4639 
	`aù
("$N does‚ot have‡ game $t message!",

4640 
ch
, 
’Œyex™
, 
viùim
, 
TO_CHAR
);

4645 ià(
viùim
 =ğ
ch
)

4646 
	`aù
(*
msg±r
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

4649 
	`¡rıy
(
buf
, *
msg±r
);

4651 
p
 = 
buf
; *p;…++)

4652 ià(*
p
 == '$')

4653 *(
p
 + 1)) {

4654 'n': 
p
[1] = 'N'; ;

4656 'e': 
p
[1] = 'E'; ;

4658 'm': 
p
[1] = 'M'; ;

4660 's': 
p
[1] = 'S'; ;

4663 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4665 
	}
}

4667 
	$do_gameš
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4669 ià(!
	`IS_IMMORTAL
(
ch
è|| 
¬gum’t
.
	`em±y
())

4670 
	`gamešout
(
ch
, "", "entry", 'I');

4672 
	`gamešout
(
ch
, 
¬gum’t
, "entry", 'I');

4673 
	}
}

4675 
	$do_gameout
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4677 ià(!
	`IS_IMMORTAL
(
ch
è|| 
¬gum’t
.
	`em±y
())

4678 
	`gamešout
(
ch
, "", "exit", 'O');

4680 
	`gamešout
(
ch
, 
¬gum’t
, "exit", 'O');

4681 
	}
}

4684 
	$do_p™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4686 
Objeù
 *
p™
;

4687 
Objeù
 
£l_p™
;

4688 
Objeù
 *
obj
, *
Ãxt_obj
;

4689 
num1
 = -1, 
num2
 = -1;

4690 
Ëv–1
 = 0, 
Ëv–2
 = 0;

4691 
boŞ
 
æev–
 = 
çl£
, 
ãx¶ev–
 = f®£, 
âame
 = f®£, 
fw—r
 = f®£, 
fw—pÚ
 = false;

4692 
FÏgs
 
w—r_æag
;

4693 
w—pÚ_ty³
 = -1;

4695 ià(!
	`check_blšd
(
ch
))

4698 ià((
p™
 = 
	`g‘_obj_h”e
(
ch
, "p™")è=ğ
nuÎ±r
) {

4699 
	`¡c
("You dØnÙ s“‡ dÚ©iÚ…™ h”e.\n", 
ch
);

4703 ià(
p™
 !ğ
Game
::
	`wÜld
().
dÚ©iÚ_p™
) {

4704 
	`¡c
("You s“mØblookšg‡ˆthwrÚg…™.\n", 
ch
);

4708 ià(
p™
->
cÚšs
 =ğ
nuÎ±r
) {

4709 
	`¡c
("Thp™ i em±y‡ˆthmom’t.\n", 
ch
);

4714 
SŒšg
 
keywÜds
 = 
¬gum’t
;

4715 
SŒšg
 
¬g
;

4716 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

4718 ià(
¬g
.
	`em±y
())

4719 
keywÜds
 = "";

4721 ià(
¬g
.
	`is_numb”
()) {

4722 
num1
 = 
¡d
::
	`max
(
	`©oi
(
¬g
), -1);

4723 
keywÜds
 = 
¬gum’t
;

4724 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

4726 ià(
¬g
.
	`em±y
())

4727 
keywÜds
 = "";

4729 ià(
¬g
.
	`is_numb”
()) {

4730 
num2
 = 
¡d
::
	`max
(
	`©oi
(
¬g
), -1);

4731 
keywÜds
 = 
¬gum’t
;

4732 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

4734 ià(
¬g
.
	`em±y
())

4735 
keywÜds
 = "";

4742 
âame
 = !
keywÜds
.
	`em±y
();

4744 ià(
num1
 =ğ-1 && !
âame
) {

4746 
æev–
 = 
Œue
;

4747 
Ëv–1
 = 
¡d
::
	`mš
(
ch
->
Ëv–
 - 7, 2 * ch->level / 3);

4748 
Ëv–1
 = 
¡d
::
	`max
(level1, 0);

4749 
Ëv–2
 = 
	`g‘_hŞdabË_Ëv–
(
ch
);

4751 ià(
num1
 == -1) {

4753 
æev–
 = 
çl£
;

4755 ià(
num2
 == -1) {

4757 
ãx¶ev–
 = 
Œue
;

4758 
æev–
 = 
Œue
;

4759 
Ëv–1
 = 
¡d
::
	`max
(
num1
 - 10, 0);

4760 
Ëv–2
 = 
num1
 + 10;

4764 
ãx¶ev–
 = 
Œue
;

4765 
æev–
 = 
Œue
;

4766 
Ëv–1
 = 
¡d
::
	`max
(
num1
, 0);

4767 
Ëv–2
 = 
¡d
::
	`max
(
num2
, 
Ëv–1
);

4770 ià(
keywÜds
.
	`has_´efix
("wear")) {

4771 
fw—r
 = 
Œue
;

4772 
âame
 = 
çl£
;

4773 
keywÜds
 = 
	`Úe_¬gum’t
(keywÜds, 
¬g
);

4774 
keywÜds
 = 
	`Úe_¬gum’t
(keywÜds, 
¬g
);

4776 ià(!
¬g
.
	`em±y
()) {

4777 
šdex
 = 
	`æag_šdex_lookup
(
¬g
, 
w—r_æags
);

4779 ià(
šdex
 == -1) {

4780 
	`¡c
("Th© i nÙ‡ w—¸loÿtiÚ you cª s—rch fÜ iÀthp™.\n", 
ch
);

4781 
	`±c
(
ch
, "S—rchabË w—¸loÿtiÚ ¬e:\À %s", 
	`w—r_b™_Çme
(
FÏgs
::
®l
));

4785 
w—r_æag
 = 
w—r_æags
[
šdex
].
b™
;

4786 
keywÜds
 = "itemshat can be wornhere";

4789 
w—r_æag
 = 
	`FÏgs
(
FÏgs
::
®l
è- (
ITEM_TAKE
 | 
ITEM_NO_SAC
 | 
ITEM_WEAR_WEDDINGRING
);

4790 
keywÜds
 = "wearable items";

4793 ià(
keywÜds
.
	`has_´efix
("weapon")) {

4794 
fw—pÚ
 = 
Œue
;

4795 
âame
 = 
çl£
;

4796 
keywÜds
 = 
	`Úe_¬gum’t
(keywÜds, 
¬g
);

4797 
keywÜds
 = 
	`Úe_¬gum’t
(keywÜds, 
¬g
);

4799 ià(!
¬g
.
	`em±y
()) {

4800 
šdex
 = 
	`w—pÚ_lookup
(
¬g
);

4802 ià(
šdex
 == -1) {

4803 
	`¡c
("Th© i nÙ‡ w—pÚy³ you cª s—rch fÜ iÀthp™.\n", 
ch
);

4804 
	`¡c
("S—rchabË w—pÚy³ ¬e:\À ", 
ch
);

4805 cÚ¡‡uto& 
’Œy
 : 
w—pÚ_bË
)

4806 
	`±c
(
ch
, "% ", 
’Œy
.
Çme
);

4807 
	`¡c
("\n", 
ch
);

4811 
w—pÚ_ty³
 = 
w—pÚ_bË
[
šdex
].
ty³
;

4812 
keywÜds
 = "weapons ofhatype";

4816 
keywÜds
 = "weapons";

4823 
£l_p™
.
pIndexD©a
 = 
p™
->pIndexData;

4824 
	`şÚe_objeù
(
p™
, &
£l_p™
);

4825 
£l_p™
.
š_room
 = 
p™
->in_room;

4828 
obj
 = 
p™
->
cÚšs
; obj !ğ
nuÎ±r
; obj = 
Ãxt_obj
) {

4829 
Ãxt_obj
 = 
obj
->
Ãxt_cÚ‹Á
;

4831 ià(
æev–
 &&

4832 (
obj
->
Ëv–
 < 
Ëv–1
 || obj->Ëv– > 
Ëv–2
))

4835 ià(
âame
 && !
obj
->
Çme
.
	`has_wÜds
(
keywÜds
))

4838 ià(
fw—r
 && 
obj
->
w—r_æags
.
	`has_nÚe_of
(
w—r_æag
))

4841 ià(
fw—pÚ


4842 && (
obj
->
™em_ty³
 !ğ
ITEM_WEAPON


4843 || (
w—pÚ_ty³
 !ğ-1 && 
obj
->
v®ue
[0] != weapon_type)))

4846 
	`obj_äom_obj
(
obj
);

4847 
	`obj_to_obj
(
obj
, &
£l_p™
);

4850 ià(
£l_p™
.
cÚšs
 =ğ
nuÎ±r
) {

4851 
	`±c
(
ch
, "You see‚o %s%s inhe…it.\n",

4852 
keywÜds
,

4853 
æev–
 ? 
ãx¶ev–
 ? "aroundhat†evel" : "around your†evel" : "");

4857 
ch
->
aù_æags
 +ğ
PLR_LOOKINPIT
;

4858 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_OBJECTS
);

4859 
	`aù
("IÀyou¸£ËùiÚ from $p, you s“:", 
ch
, 
p™
, 
nuÎ±r
, 
TO_CHAR
);

4860 
	`show_li¡_to_ch¬
(
£l_p™
.
cÚšs
, 
ch
, 
Œue
,rue, 
çl£
);

4861 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

4862 
ch
->
aù_æags
 -ğ
PLR_LOOKINPIT
;

4866 
obj
 = 
£l_p™
.
cÚšs
; obj !ğ
nuÎ±r
; obj = 
Ãxt_obj
) {

4867 
Ãxt_obj
 = 
obj
->
Ãxt_cÚ‹Á
;

4868 
	`obj_äom_obj
(
obj
);

4869 
	`obj_to_obj
(
obj
, 
p™
);

4871 
	}
}

4874 
	$do_şªšfo
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4876 
buf
[
MAX_INPUT_LENGTH
];

4878 ià(
ch
->
	`is_Åc
()) {

4879 
	`¡c
("You ju¡†—vwÜryšg‡bouˆşª fÜ…Ïy”s.\n", 
ch
);

4883 ià(!
	`IS_IMMORTAL
(
ch
)) {

4884 ià(
ch
->
şª
 =ğ
nuÎ±r
) {

4885 
	`¡c
("You'»‚Ùƒv’ iÀ¨şª!\n", 
ch
);

4889 ià(
ch
->
şª
->
šd•’d’t
) {

4890 
	`¡c
("You¸şª dÛ¢'ˆsuµÜˆthi ã©u»!\n", 
ch
);

4894 
FÜm©
::
	`¥rštf
(
buf
, "You‡re‡ member of %s, created by %s.\n",

4895 
ch
->
şª
->
şªÇme
, ch->şª->
ü—tÜ
);

4896 
	`¡c
(
buf
, 
ch
);

4897 
FÜm©
::
	`¥rštf
(
buf
, "To send‡‚oteo your clan, send‡‚oteo '%s'.\n",

4898 
ch
->
şª
->
Çme
);

4899 
	`¡c
(
buf
, 
ch
);

4900 
FÜm©
::
	`¥rštf
(
buf
, "The clan has %ld questpoints, of which %d came from you.\n",

4901 
ch
->
şª
->
şªqp
, ch->
pcd©a
->
que¡pošts_dÚ©ed
);

4902 
	`¡c
(
buf
, 
ch
);

4903 
FÜm©
::
	`¥rštf
(
buf
, "The clan has %ld gold coins, of which %ld came from you.\n",

4904 
ch
->
şª
->
gŞd_b®ªû
, ch->
pcd©a
->
gŞd_dÚ©ed
);

4905 
	`¡c
(
buf
, 
ch
);

4908 
CÏn
 *
™”©Ü
;

4909 
	`¡c
("CÏÂam |QP |GŞd\n", 
ch
);

4910 
	`¡c
("--------------------+-------+------\n", 
ch
);

4912 
™”©Ü
 = 
şª_bË_h—d
->
Ãxt
; i‹¿tÜ !ğ
şª_bË_
; iterator = iterator->next) {

4913 ià(
™”©Ü
->
šd•’d’t
)

4916 
FÜm©
::
	`¥rštf
(
buf
, "%-20s|%-7ld|%ld\n", 
™”©Ü
->
Çme
, i‹¿tÜ->
şªqp
, i‹¿tÜ->
gŞd_b®ªû
);

4917 
	`¡c
(
buf
, 
ch
);

4920 
	`¡c
("--------------------+-------+------\n", 
ch
);

4924 
	}
}

4926 
SŒšg
 
	$make_b¬
(cÚ¡ 
SŒšg
& 
bgcŞÜ
, cÚ¡ SŒšg& 
fgcŞÜ
, 
šfo
, 
numbg
, 
boŞ
 
imm
)

4928 
SŒšg
 
ouut
, 
buf
;

4930 ià(
imm
)

4931 
FÜm©
::
	`¥rštf
(
ouut
, "{%s{%s%-10ld{x", 
bgcŞÜ
, 
fgcŞÜ
, 
šfo
);

4933 
FÜm©
::
	`¥rštf
(
ouut
, "{%s{%  {x", 
bgcŞÜ
, 
fgcŞÜ
);

4935 
FÜm©
::
	`¥rštf
(
buf
, "{x{%s", 
fgcŞÜ
);

4936  
ouut
.
	`š£¹
(
buf
, 
numbg
 + 4);

4937 
	}
}

4939 
	$do_şªpow”
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4941 
CÏn
 *
şª
;

4942 
couÁ
 = 0, 
šc
, 
i
, 
x
, 
j
 = 0, 
high
, 
low
, 
Ãgmod
 = 0, 
tÙ®
;

4943 
SŒšg
 
ouut
;

4944 
	sc_li¡
 {

4945 
CÏn
 *
şª
;

4946 
memb”s
;

4947 
tmemb”s
;

4948 
qp
;

4949 
gŞd
;

4950 
w¬±s
;

4951 
boŞ
 
´š‹d
;

4953 
c_li¡
 
şi¡
[
	`couÁ_şªs
()];

4955 
şª
 = 
şª_bË_h—d
->
Ãxt
; cÏÀ!ğ
şª_bË_
; clan = clan->next) {

4956 ià(
şª
->
šd•’d’t
)

4959 
şi¡
[
couÁ
].
şª
 = clan;

4960 
şi¡
[
couÁ
].
tmemb”s
 = 
	`couÁ_şª_memb”s
(
şª
, 0);

4961 
şi¡
[
couÁ
].
qp
 = 
şª
->
şªqp
;

4962 
şi¡
[
couÁ
].
gŞd
 = 
şª
->
gŞd_b®ªû
;

4963 
şi¡
[
couÁ
].
w¬±s
 = 
şª
->
w¬ımod
;

4964 
şi¡
[
couÁ
].
´š‹d
 = 
çl£
;

4965 
couÁ
++;

4969 
i
 = 1, 
high
 = 
şi¡
[0].
tmemb”s
; i < 
couÁ
; i++)

4970 
high
 = 
¡d
::
	`max
(
şi¡
[
i
].
tmemb”s
, high);

4972 
i
 = 0; i < 
couÁ
; i++)

4973 
şi¡
[
i
].
memb”s
 = 
high
 ? 
	`URANGE
(1, ((9 * cli¡[i].
tmemb”s
) / high) + 1, 10) : 1;

4975 
i
 = 1, 
high
 = 
şi¡
[0].
qp
; i < 
couÁ
; i++)

4976 
high
 = 
¡d
::
	`max
(
şi¡
[
i
].
qp
, high);

4978 
i
 = 0; i < 
couÁ
; i++)

4979 
şi¡
[
i
].
qp
 = 
high
 ? 
	`URANGE
(1, ((9 * clist[i].qp) / high) + 1, 10) : 1;

4981 
i
 = 0; i < 
couÁ
; i++)

4982 
şi¡
[
i
].
gŞd
 = 
	`URANGE
(1, ((9 * clist[i].gold) / 200000) + 1, 10);

4985 
i
 = 1, 
high
 = 
şi¡
[0].
w¬±s
, 
low
 = cli¡[0].w¬±s; i < 
couÁ
; i++) {

4986 
high
 = 
¡d
::
	`max
(
şi¡
[
i
].
w¬±s
, high);

4987 
low
 = 
¡d
::
	`mš
(
şi¡
[
i
].
w¬±s
,†ow);

4990 ià(
low
 < 0)

4991 
Ãgmod
 = 0 - 
low
;

4993 
high
 +ğ
Ãgmod
;

4994 
low
 +ğ
Ãgmod
;

4995 
šc
 = 
high
 - 
low
;

4997 
i
 = 0; i < 
couÁ
; i++)

4998 
şi¡
[
i
].
w¬±s
 = 
šc
 ? 
	`URANGE
(1, ((9 * (şi¡[i].w¬± + 
Ãgmod
 - 
low
)è/ incè+ 1, 10è: 
high
 ? 10 : 1;

5000 
ouut
 += "\n {WThe {BClans{W of {BL{Ce{gg{Wa{Cc{By{W:\n\n";

5001 
ouut
 +ğ
FÜm©
::
	`fÜm©
("%s{CSize: {GFame: {YWealth: {PMight:{x\n",

5002 
	`IS_IMMORTAL
(
ch
) ? " " :

5005 
i
 = 0; i < 
couÁ
; i++) {

5006 
x
 = 0, 
high
 = 0; x < 
couÁ
; x++)

5007 ià(!
şi¡
[
x
].
´š‹d
) {

5008 
tÙ®
 = 
	`ÿlc_ı
(
şi¡
[
x
].
şª
, 
Œue
);

5010 ià(
tÙ®
 >ğ
high
) {

5011 
j
 = 
x
;

5012 
high
 = 
tÙ®
;

5016 ià(
	`IS_IMMORTAL
(
ch
))

5017 
ouut
 +ğ
FÜm©
::
	`fÜm©
("{G(%2dè", 
high
);

5019 
şi¡
[
j
].
´š‹d
 = 
Œue
;

5020 
ouut
 +ğ
FÜm©
::
	`fÜm©
("{W%d. %-30s{x%s %s %s %s\n",

5021 
i
 + 1,

5022 
şi¡
[
j
].
şª
->
şªÇme
,

5023 
	`make_b¬
("t", "C", 
şi¡
[
j
].
tmemb”s
, cli¡[j].
memb”s
, 
	`IS_IMMORTAL
(
ch
)),

5024 
	`make_b¬
("h", "G", 
şi¡
[
j
].
şª
->
şªqp
, cli¡[j].
qp
, 
	`IS_IMMORTAL
(
ch
)),

5025 
	`make_b¬
("y", "Y", 
şi¡
[
j
].
şª
->
gŞd_b®ªû
, cli¡[j].
gŞd
, 
	`IS_IMMORTAL
(
ch
)),

5026 
	`make_b¬
("r", "P", 
şi¡
[
j
].
şª
->
w¬ımod
, cli¡[j].
w¬±s
, 
	`IS_IMMORTAL
(
ch
)));

5029 
ouut
 += "\n";

5030 
	`·ge_to_ch¬
(
ouut
, 
ch
);

5031 
	}
}

5034 
	$´št_Ãw_afãùs
(
Ch¬aù”
 *
ch
)

5036 
tÜch
[8], 
bÜd”
[4], 
b»aklše
[
MSL
];

5037 
SŒšg
 
bufãr
;

5038 
boŞ
 
found
 = 
çl£
;

5039 
	`¡rıy
(
bÜd”
, 
	`g‘_cu¡om_cŞÜ_code
(
ch
, 
CSLOT_SCORE_BORDER
));

5040 
FÜm©
::
	`¥rštf
(
tÜch
, "%s|#|{x", 
	`g‘_cu¡om_cŞÜ_code
(
ch
, 
CSLOT_SCORE_TORCH
));

5041 
FÜm©
::
	`¥rštf
(
b»aklše
, " %s%s----------------------------------------------------------------%s\n", 
tÜch
, 
bÜd”
,orch);

5043 ià(
afãù
::
	`li¡_ch¬
(
ch
è!ğ
nuÎ±r
)

5044 
afãù
::
	`sÜt_ch¬
(
ch
,‡fãù::
com·¿tÜ_du¿tiÚ
);

5047 ià(
afãù
::
	`li¡_ch¬
(
ch
è!ğ
nuÎ±r
) {

5048 
affcouÁ
 = 0;

5050 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_ch¬
(
ch
);…af;…aàğ·f->
Ãxt
)

5051 ià(
·f
->
wh”e
 =ğ
TO_AFFECTS
 && !·f->
³rmª’t
)

5052 
affcouÁ
++;

5054 ià(
affcouÁ
 > 0) {

5055 
bufãr
 +ğ
FÜm©
::
	`fÜm©
(" %s {bYou‡re‡ffected byhe following spells: %s\n",

5056 
tÜch
,orch);

5057 
bufãr
 +ğ
b»aklše
;

5059 cÚ¡ 
afãù
::
Afãù
 *
·f_Ï¡
 = 
nuÎ±r
;

5060 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_ch¬
(
ch
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
) {

5061 ià(
·f
->
wh”e
 !ğ
TO_AFFECTS
 ||…af->
³rmª’t
)

5064 
SŒšg
 
Çmebuf
, 
modbuf
, 
timebuf
;

5066 ià(
·f_Ï¡
 !ğ
nuÎ±r
 && 
·f
->
ty³
 ==…af_last->type) {

5067 ià(
ch
->
Ëv–
 >= 20)

5068 
Çmebuf
 = " ";

5073 
FÜm©
::
	`¥rštf
(
Çmebuf
, "%-19s", 
afãù
::
	`lookup
(
·f
->
ty³
).
Çme
);

5075 ià(
ch
->
Ëv–
 >= 20) {

5076 ià(
·f
->
loÿtiÚ
 !ğ
APPLY_NONE
 &&…af->
modif›r
 != 0)

5077 
FÜm©
::
	`¥rštf
(
modbuf
, "%s by %d",

5078 
	`afãù_loc_Çme
(
·f
->
loÿtiÚ
),…af->
modif›r
);

5080 ià(
·f
->
du¿tiÚ
 != -1)

5081 
FÜm©
::
	`¥rštf
(
timebuf
, "%3d hrs", 
·f
->
du¿tiÚ
 + 1);

5084 
bufãr
 +ğ
FÜm©
::
	`fÜm©
(" %s {b%-19s %s| {b%-30s %s| {b%7s %s\n",

5085 
tÜch
,

5086 
Çmebuf
,

5087 
bÜd”
,

5088 
modbuf
,

5089 
bÜd”
,

5090 
timebuf
,

5091 
tÜch


5094 
·f_Ï¡
 = 
·f
;

5097 
found
 = 
Œue
;

5101 
boŞ
 
´št
 = 
çl£
;

5103 
iW—r
 = 0; iW—¸< 
MAX_WEAR
; iWear++) {

5104 
Objeù
 *
obj
;

5106 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
iW—r
)è!ğ
nuÎ±r
) {

5107 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…af;…aàğ·f->
Ãxt
) {

5108 ià(
·f
->
wh”e
 !ğ
TO_AFFECTS
)

5111 ià(!
´št
) {

5112 ià(
found
)

5113 
bufãr
 +ğ
b»aklše
;

5115 
bufãr
 +ğ
FÜm©
::
	`fÜm©
(" %s {bYou‡re‡ffected byhe followingƒquipment spells: %s\n",

5116 
tÜch
,orch);

5117 
bufãr
 +ğ
b»aklše
;

5118 
´št
 = 
Œue
;

5119 
found
 = 
Œue
;

5122 
SŒšg
 
Çmebuf
, 
eqbuf
, 
timebuf
;

5124 
Çmebuf
 = 
afãù
::
	`lookup
(
·f
->
ty³
).
Çme
;

5125 
eqbuf
 = 
obj
->
shÜt_desü
.
	`uncŞÜ
().
	`sub¡r
(0, 38);

5127 ià(
·f
->
du¿tiÚ
 != -1)

5128 
FÜm©
::
	`¥rštf
(
timebuf
, "%3d hrs", 
·f
->
du¿tiÚ
 + 1);

5130 
bufãr
 +ğ
FÜm©
::
	`fÜm©
(" %s {b%-19s %s| {g%-30s %s| {b%7s %s\n",

5131 
tÜch
,

5132 
Çmebuf
,

5133 
bÜd”
,

5134 
eqbuf
,

5135 
bÜd”
,

5136 
timebuf
,

5137 
tÜch


5143 ià(
afãù
::
	`li¡_ch¬
(
ch
è!ğ
nuÎ±r
) {

5144 
affcouÁ
 = 0;

5146 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_ch¬
(
ch
);…af;…aàğ·f->
Ãxt
)

5147 ià(
·f
->
wh”e
 =ğ
TO_AFFECTS
 &&…af->
³rmª’t
)

5148 
affcouÁ
++;

5150 ià(
affcouÁ
 > 0) {

5151 ià(
found
)

5152 
bufãr
 +ğ
b»aklše
;

5154 
bufãr
 +ğ
FÜm©
::
	`fÜm©
(" %s {bYou‡re‡ffected byhe following„acial‡bilities: %s\n",

5155 
tÜch
,orch);

5156 
bufãr
 +ğ
b»aklše
;

5158 cÚ¡ 
afãù
::
Afãù
 *
·f_Ï¡
 = 
nuÎ±r
;

5159 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_ch¬
(
ch
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
) {

5160 ià(
·f
->
wh”e
 !ğ
TO_AFFECTS
 || !·f->
³rmª’t
)

5163 
SŒšg
 
Çmebuf
, 
modbuf
;

5165 ià(
·f_Ï¡
 !ğ
nuÎ±r
 && 
·f
->
ty³
 ==…af_last->type) {

5166 ià(
ch
->
Ëv–
 >= 20)

5167 
Çmebuf
 = " ";

5172 
FÜm©
::
	`¥rštf
(
Çmebuf
, "%-19s", 
afãù
::
	`lookup
(
·f
->
ty³
).
Çme
);

5174 ià(
ch
->
Ëv–
 >= 20) {

5175 ià(
·f
->
loÿtiÚ
 !ğ
APPLY_NONE
 &&…af->
modif›r
 != 0)

5176 
FÜm©
::
	`¥rštf
(
modbuf
, "%s by %d",

5177 
	`afãù_loc_Çme
(
·f
->
loÿtiÚ
),…af->
modif›r
);

5180 
bufãr
 +ğ
FÜm©
::
	`fÜm©
(" %s {b%-19s %s| {b%-40s %s\n",

5181 
tÜch
,

5182 
Çmebuf
,

5183 
bÜd”
,

5184 
modbuf
,

5185 
tÜch


5188 
·f_Ï¡
 = 
·f
;

5191 
found
 = 
Œue
;

5195 ià(!
ch
->
	`is_Åc
()

5196 && 
ch
->
pcd©a
->
»mÜt_couÁ


5197 && 
ch
->
pcd©a
->
¿fãù
[0]

5198 && 
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_SHOWRAFF
)) {

5200 ià(
found
)

5201 
bufãr
 +ğ
b»aklše
;

5203 
bufãr
 +ğ
FÜm©
::
	`fÜm©
(" %s {bYou‡re‡ffected byhe following„emort‡ffects: %s\n",

5204 
tÜch
,orch);

5205 
bufãr
 +ğ
b»aklše
;

5207 
¿ff
 = 0;„afà< 
ch
->
pcd©a
->
»mÜt_couÁ
 / 10 + 1;„aff++)

5208 
i
 = 0; i < 
MAX_RAFFECTS
; i++)

5209 ià(
¿fãùs
[
i
].
id
 =ğ
ch
->
pcd©a
->
¿fãù
[
¿ff
])

5210 
bufãr
 +ğ
FÜm©
::
	`fÜm©
(" %s {b%-62s %s\n",

5211 
tÜch
, 
¿fãùs
[
i
].
desütiÚ
,orch);

5213 
found
 = 
Œue
;

5216 ià(!
found
)

5217 
bufãr
 +ğ
FÜm©
::
	`fÜm©
(" %s {bYou‡re‚ot‡ffected by‡ny spells. %s\n",

5218 
tÜch
,orch);

5220 
bufãr
 +ğ
FÜm©
::
	`fÜm©
(" %s%s================================================================%s\n", 
tÜch
, 
bÜd”
,orch);

5221 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

5222 
	}
}

5225 
	$scÜe_Ãw
(
Ch¬aù”
 *
ch
)

5227 
SŒšg
 
buf
;

5228 
SŒšg
 
bÜd”
 = 
	`g‘_cu¡om_cŞÜ_code
(
ch
, 
CSLOT_SCORE_BORDER
);

5229 
SŒšg
 
tÜch
 = 
	`g‘_cu¡om_cŞÜ_code
(
ch
, 
CSLOT_SCORE_TORCH
);

5230 
SŒšg
 
æame
 = 
	`g‘_cu¡om_cŞÜ_code
(
ch
, 
CSLOT_SCORE_FLAME
);

5232 
	`±c
(
ch
, " %s, ,{x\n", 
æame
);

5235 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_TITLE
);

5236 
FÜm©
::
	`¥rštf
(
buf
, "%s%s{x%s", 
	`g‘_cu¡om_cŞÜ_code
(
ch
, 
CSLOT_SCORE_NAME
), ch->
	`is_Åc
(è? ch->
shÜt_desü
 : ch->
Çme
, ch->is_Åc(è? "" : ch->
pcd©a
->
t™Ë
);

5237 
	`±c
(
ch
, " %s'`,{x % %s'`,{x\n", 
æame
, 
buf
.
	`ûÁ”
(62), flame);

5239 
	`±c
(
ch
, " %s`, `,{x\n", 
æame
);

5241 
FÜm©
::
	`¥rštf
(
buf
, "% ", 
£x_bË
[
	`GET_ATTR_SEX
(
ch
)].
Çme
.
	`ÿp™®ize
());

5242 
buf
 +ğ
¿û_bË
[
ch
->
¿û
].
Çme
.
	`ÿp™®ize
();

5243 
buf
 += " ";

5244 
buf
 +ğ
ch
->
gud
 =ğ
Gud
::
nÚe
 ? "NÚe" : 
gud_bË
[ch->gud].
Çme
.
	`ÿp™®ize
();

5245 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_CLASS
);

5246 
	`±c
(
ch
, " {Y.:.{x % {Y.:.{x\n", 
buf
.
	`ûÁ”
(62));

5248 
	`±c
(
ch
, " %s)X({x ", 
tÜch
);

5249 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_LEVEL
);

5250 
FÜm©
::
	`¥rštf
(
buf
, "Level{B:{x %d {B({xRemort %d{B){x Age{B:{x %d {B({x%d Hours{B){x",

5251 
ch
->
Ëv–
,

5252 
ch
->
	`is_Åc
(è? 0 : ch->
pcd©a
->
»mÜt_couÁ
,

5253 
	`GET_ATTR_AGE
(
ch
),

5254 
	`g‘_¶ay_hours
(
ch
));

5255 
	`¡c
(
buf
.
	`ûÁ”
(62), 
ch
);

5256 
	`±c
(
ch
, " %s)X({x\n", 
tÜch
);

5258 
	`±c
(
ch
, "%s", 
tÜch
);

5259 
	`¡c
("[%%%]", 
ch
);

5260 
	`±c
(
ch
, "%s==============================================================%s", 
bÜd”
, 
tÜch
);

5261 
	`¡c
("[%%%]{x\n", 
ch
);

5263 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_STAT
);

5264 
	`±c
(
ch
, " %s|#|{x SŒ’gth %2d/", 
tÜch
, 
	`GET_ATTR_STR
(ch));

5265 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_MAXSTAT
);

5266 
	`±c
(
ch
, "%2d %s|{x", 
	`ATTR_BASE
(ch, 
APPLY_STR
), 
bÜd”
);

5267 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_HEALTHNAME
);

5268 
	`¡c
(" H°", 
ch
);

5269 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_HEALTHNUM
);

5270 
	`±c
(
ch
, "%5d/%5d %s|{x", ch->
h™
, 
	`GET_MAX_HIT
(ch), 
bÜd”
);

5271 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_WEALTH
);

5272 
	`±c
(
ch
, " GŞd %9ld %s|#|{x\n", ch->
gŞd
, 
tÜch
);

5274 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_STAT
);

5275 
	`±c
(
ch
, " %s|#|{x IÁ–lig’û %2d/", 
tÜch
, 
	`GET_ATTR_INT
(ch));

5276 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_MAXSTAT
);

5277 
	`±c
(
ch
, "%2d %s|{x", 
	`ATTR_BASE
(ch, 
APPLY_INT
), 
bÜd”
);

5278 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_HEALTHNAME
);

5279 
	`¡c
(" Mª¨", 
ch
);

5280 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_HEALTHNUM
);

5281 
	`±c
(
ch
, "%5d/%5d %s|{x", ch->
mªa
, 
	`GET_MAX_MANA
(ch), 
bÜd”
);

5282 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_WEALTH
);

5283 
	`±c
(
ch
, " Sv” %9ld %s|#|{x\n", ch->
sv”
, 
tÜch
);

5285 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_STAT
);

5286 
	`±c
(
ch
, " %s|#|{x Wisdom %2d/", 
tÜch
, 
	`GET_ATTR_WIS
(ch));

5287 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_MAXSTAT
);

5288 
	`±c
(
ch
, "%2d %s|{x", 
	`ATTR_BASE
(ch, 
APPLY_WIS
), 
bÜd”
);

5289 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_HEALTHNAME
);

5290 
	`¡c
(" Smš¨", 
ch
);

5291 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_HEALTHNUM
);

5292 
	`±c
(
ch
, "%5d/%5d %s|{x", ch->
¡am
, 
	`GET_MAX_STAM
(ch), 
bÜd”
);

5293 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_ENCUMB
);

5294 
	`±c
(
ch
, " I‹m %4d/%4d %s|#|{x\n", 
	`g‘_ÿ¼y_numb”
(ch), 
	`ÿn_ÿ¼y_n
(ch), 
tÜch
);

5296 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_STAT
);

5297 
	`±c
(
ch
, " %s|#|{x Dex‹r™y %2d/", 
tÜch
, 
	`GET_ATTR_DEX
(ch));

5298 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_MAXSTAT
);

5299 
	`±c
(
ch
, "%2d %s| |{x", 
	`ATTR_BASE
(ch, 
APPLY_DEX
), 
bÜd”
);

5300 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_ENCUMB
);

5301 
	`±c
(
ch
, " Weight %4d/%4d %s|#|{x\n",

5302 
	`g‘_ÿ¼y_weight
(
ch
),

5303 
	`IS_IMMORTAL
(
ch
è? 9999 : 
	`ÿn_ÿ¼y_w
(ch),

5304 
tÜch
);

5306 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_STAT
);

5307 
	`±c
(
ch
, " %s|#|{x CÚ¡™utiÚ %2d/", 
tÜch
, 
	`GET_ATTR_CON
(ch));

5308 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_MAXSTAT
);

5309 
	`±c
(
ch
, "%2d %s|{x", 
	`ATTR_BASE
(ch, 
APPLY_CON
), 
bÜd”
);

5310 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_ARMOR
);

5311 
	`±c
(
ch
, " ArmÜ v  %s| %s|#|{x\n", 
bÜd”
, 
tÜch
);

5313 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_STAT
);

5314 
	`±c
(
ch
, " %s|#|{x Ch¬ism¨%2d/", 
tÜch
, 
	`GET_ATTR_CHR
(ch));

5315 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_MAXSTAT
);

5316 
	`±c
(
ch
, "%2d %s|{x", 
	`ATTR_BASE
(ch, 
APPLY_CHR
), 
bÜd”
);

5317 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_ARMOR
);

5318 
	`±c
(
ch
, " P›rû %6d %s|{x", 
	`GET_AC
(ch, 
AC_PIERCE
), 
bÜd”
);

5319 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_DICENAME
);

5320 
	`¡c
(" H™rŞÈ ", 
ch
);

5321 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_DICENUM
);

5322 
	`±c
(
ch
, "%5d %s|#|{x\n", 
	`GET_ATTR_HITROLL
(ch), 
tÜch
);

5324 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_ARMOR
);

5325 
	`±c
(
ch
, " %s|#|{x %s|{x Bash %6d %s|{x",

5326 
tÜch
, 
bÜd”
, 
	`GET_AC
(
ch
, 
AC_BASH
), border);

5327 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_DICENAME
);

5328 
	`¡c
(" DamrŞÈ ", 
ch
);

5329 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_DICENUM
);

5330 
	`±c
(
ch
, "%5d %s|#|{x\n", 
	`GET_ATTR_DAMROLL
(ch), 
tÜch
);

5332 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_POINTNAME
);

5333 
	`±c
(
ch
, " %s|#|{x Que¡Pošt  ", 
tÜch
);

5334 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_POINTNUM
);

5335 
	`±c
(
ch
, "%5d %s|{x", ch->
	`is_Åc
(è? 0 : ch->
pcd©a
->
que¡pošts
, 
bÜd”
);

5336 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_ARMOR
);

5337 
	`±c
(
ch
, " SÏsh %6d %s|{x", 
	`GET_AC
(ch, 
AC_SLASH
), 
bÜd”
);

5338 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_DICENAME
);

5339 
	`¡c
(" Save  ", 
ch
);

5340 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_DICENUM
);

5341 
	`±c
(
ch
, "%5d %s|#|{x\n", 
	`GET_ATTR_SAVES
(ch), 
tÜch
);

5343 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_POINTNAME
);

5344 
	`±c
(
ch
, " %s|#|{x SklPošt  ", 
tÜch
);

5345 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_POINTNUM
);

5346 
	`±c
(
ch
, "%5d %s|{x", ch->
	`is_Åc
(è? 0 : ch->
pcd©a
->
skÍošts
, 
bÜd”
);

5347 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_ARMOR
);

5348 
	`±c
(
ch
, " Magiø %6d %s|{x", 
	`GET_AC
(ch, 
AC_EXOTIC
), 
bÜd”
);

5349 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_DICENAME
);

5350 
	`¡c
(" Wimpy ", 
ch
);

5351 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_DICENUM
);

5352 
	`±c
(
ch
, "%5d %s|#|{x\n", ch->
wimpy
, 
tÜch
);

5354 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_POINTNAME
);

5355 
	`±c
(
ch
, " %s|#|{x RPPošt  ", 
tÜch
);

5356 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_POINTNUM
);

5357 
	`±c
(
ch
, "%5d %s| | %s|#|{x\n",

5358 
ch
->
	`is_Åc
(è? 0 : ch->
pcd©a
->
rŞ•ošts
, 
bÜd”
, 
tÜch
);

5360 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_POINTNAME
);

5361 
	`±c
(
ch
, " %s|#|{x T¿š  ", 
tÜch
);

5362 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_POINTNUM
);

5363 
	`±c
(
ch
, "%5d %s|{x", ch->
Œaš
, 
bÜd”
);

5364 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_ALIGN
);

5365 
	`±c
(
ch
, " Alignment %s%5d %s|{x",

5366 
ch
->
®ignm’t
 > 350 ? "{W" : ch->®ignm’ˆ< -350 ? "{R" : "{c", ch->®ignm’t, 
bÜd”
);

5367 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_XPNAME
);

5368 
	`±c
(
ch
, " Ex³r›nû %s|#|{x\n", 
tÜch
);

5370 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_POINTNAME
);

5371 
	`±c
(
ch
, " %s|#|{x P¿ùiû  ", 
tÜch
);

5372 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_POINTNUM
);

5373 
	`±c
(
ch
, "%5d %s|----------------------|{x", ch->
´aùiû
, 
bÜd”
);

5374 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_XPNUM
);

5375 
	`±c
(
ch
, " To Level %6ld %s|#|{x\n",

5376 
ch
->
	`is_Åc
(è? 0 : (ch->
Ëv–
 + 1è* 
	`exp_³r_Ëv–
(ch, ch->
pcd©a
->
pošts
è- ch->
exp
, 
tÜch
);

5378 
FÜm©
::
	`¥rštf
(
buf
, "You‡re ");

5380 
	`g‘_pos™iÚ
(
ch
)) {

5381 
POS_DEAD
: 
buf
 += "DEAD!!"; ;

5383 
POS_INCAP
:

5384 
POS_MORTAL
: 
buf
 += "dying"; ;

5386 
POS_STUNNED
: 
buf
 += "stunned"; ;

5388 
POS_SLEEPING
: 
buf
 += "sleeping"; ;

5390 
POS_RESTING
: 
buf
 += "resting"; ;

5392 
POS_STANDING
: 
buf
 += "standing"; ;

5394 
POS_FIGHTING
: 
buf
 += "fighting"; ;

5396 
POS_SITTING
: 
buf
 += "sitting"; ;

5397 
POS_FLYING
: 
buf
 += "flying"; ;

5400 
	`±c
(
ch
, " %s|#| %s|{x", 
tÜch
, 
bÜd”
);

5401 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_POSITION
);

5402 
	`±c
(
ch
, "%s%s|{x", 
buf
.
	`ûÁ”
(22), 
bÜd”
);

5403 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_XPNUM
);

5404 
	`±c
(
ch
, " TÙ® %6d %s|#|{x\n", 
¡d
::
	`mš
(ch->
exp
, 999999), 
tÜch
);

5406 
	`±c
(
ch
, " %s|#|%s----------------------------------------------------------------%s|#|{x\n",

5407 
tÜch
, 
bÜd”
,orch);

5410 ià(!
ch
->
	`is_Åc
()) {

5411 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_PKRECORD
);

5412 
FÜm©
::
	`¥rštf
(
buf
, "PK: %d Wins, %d Losses %sRank: %d{x Arena: %d Wins, %d Losses",

5413 
ch
->
pcd©a
->
pckls
, ch->pcd©a->
pckËd
,

5414 
	`g‘_cu¡om_cŞÜ_code
(
ch
, 
CSLOT_SCORE_PKRANK
), ch->
pcd©a
->
pk¿nk
,

5415 
ch
->
pcd©a
->
¬’akls
, ch->pcd©a->
¬’akËd
);

5416 
	`±c
(
ch
, " %s|#|{x % %s|#|{x\n", 
tÜch
, 
buf
.
	`ûÁ”
(62),orch);

5419 
	`±c
(
ch
, " %s|#|%s================================================================%s|#|{x\n",

5420 
tÜch
, 
bÜd”
,orch);

5422 ià(
ch
->
comm_æags
.
	`has
(
COMM_SHOW_AFFECTS
))

5423 
	`´št_Ãw_afãùs
(
ch
);

5426 
	`±c
(
ch
, " %s|#| |#|{x\n", 
tÜch
);

5428 
	`±c
(
ch
, "%s[[|]] [[|]]{x\n", 
tÜch
);

5429 
	}
}

5431 
	$do_afãùs
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5433 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_FLAME
);

5434 
	`¡c
(" , ,\n"

5437 " {Y.:. .:.{x\n", 
ch
);

5438 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_TORCH
);

5439 
	`¡c
(" )X( )X(\n"

5440 "[%%%]", 
ch
);

5441 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_BORDER
);

5442 
	`¡c
("==============================================================", 
ch
);

5443 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_TORCH
);

5444 
	`¡c
("[%%%]\n", 
ch
);

5445 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

5446 
	`´št_Ãw_afãùs
(
ch
);

5447 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_SCORE_TORCH
);

5448 
	`¡c
(" |#| |#|\n"

5449 "[[|]] [[|]]\n", 
ch
);

5450 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

5451 
	}
}

5453 
	$do_scÜe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5455 
	`scÜe_Ãw
(
ch
);

5456 
	}
}

5464 
	$¥–l_süy
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5466 
Ch¬aù”
 *
³t
;

5469 ià(! 
ch
->
³t
) {

5470 
	`¡c
("You dØnÙ hav¨³t.\n", 
ch
);

5474 
³t
 = 
ch
->pet;

5477 ià(
³t
->
š_room
->
	`is_d¬k
()) {

5478 
	`¡c
("Throom you¸³ˆi š i d¬k.\n", 
ch
);

5482 
	`¡c
("You s“...\À ", 
ch
);

5483 
	`¡c
(
³t
->
š_room
->
	`desütiÚ
(), 
ch
);

5484 
	`show_li¡_to_ch¬
(
³t
->
š_room
->
cÚ‹Ás
, 
ch
, 
çl£
, false, false);

5485 
	`show_ch¬_to_ch¬
(
³t
->
š_room
->
³İË
, 
ch
);

5490 
	}
}

	@src/act_move.cc

28 
	~<m©h.h
>

29 
	~<®gÜ™hm
>

31 
	~"aù.hh
"

32 
	~"¬gum’t.hh
"

33 
	~"afãù/Afãù.hh
"

34 
	~"A»a.hh
"

35 
	~"B©e.hh
"

36 
	~"Ch¬aù”.hh
"

37 
	~"CÏn.hh
"

38 
	~"deş¬e.hh
"

39 
	~"DesütÜ.hh
"

40 
	~"Ex™.hh
"

41 
	~"ExŒaDesü.hh
"

42 
	~"fšd.hh
"

43 
	~"FÏgs.hh
"

44 
	~"FÜm©.hh
"

45 
	~"Game.hh
"

46 
	~"š‹½.hh
"

47 
	~"Loggšg.hh
"

48 
	~"memÜy.hh
"

49 
	~"m”c.hh
"

50 
	~"MobProg.hh
"

51 
	~"Objeù.hh
"

52 
	~"ObjeùPrÙÙy³.hh
"

53 
	~"ObjeùV®ue.hh
"

54 
	~"PÏy”.hh
"

55 
	~"Que¡A»a.hh
"

56 
	~"¿ndom.hh
"

57 
	~"Room.hh
"

58 
	~"skl/skl.hh
"

59 
	~"SeùÜ.hh
"

60 
	~"SŒšg.hh
"

61 
	~"WÜld.hh
"

62 
	~"RoomPrÙÙy³.hh
"

64 
DECLARE_SPEC_FUN
(
¥ec_şªgu¬d
);

66 cÚ¡ 
	g¡d
::
m­
<
SeùÜ
, > 
	g¡amša_loss
 = {

67 { 
SeùÜ
::
nÚe
, 0 },

68 { 
SeùÜ
::
šside
, 1 },

69 { 
SeùÜ
::
c™y
, 2 },

70 { 
SeùÜ
::
rßd
, 2 },

71 { 
SeùÜ
::
f›ld
, 2 },

72 { 
SeùÜ
::
fÜe¡_¥¬£
, 3 },

73 { 
SeùÜ
::
fÜe¡_medium
, 4 },

74 { 
SeùÜ
::
fÜe¡_d’£
, 6 },

75 { 
SeùÜ
::
hls
, 4 },

76 { 
SeùÜ
::
mouÁaš
, 6 },

77 { 
SeùÜ
::
w©”_swim
, 4 },

78 { 
SeùÜ
::
w©”_noswim
, 1 },

79 { 
SeùÜ
::
aœ
, 6 },

80 { 
SeùÜ
::
de£¹
, 10 },

81 { 
SeùÜ
::
¬’a
, 1 },

82 { 
SeùÜ
::
şª¬’a
, 1 },

88 
fšd_doÜ
 
¬gs
((
Ch¬aù”
 *
ch
, *
¬g
));

89 
boŞ
 
has_key
 
¬gs
((
Ch¬aù”
 *
ch
, 
key
));

90 
fšd_ex™
 
¬gs
((
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬g
));

92 
	$move_ch¬
(
Ch¬aù”
 *
ch
, 
doÜ
, 
boŞ
 
fŞlow
)

94 
Ch¬aù”
 *
fch
, *
fch_Ãxt
;

95 
Room
 *
š_room
, *
to_room
;

96 
Ex™
 *
³x™
;

97 
dœ_buf
[128];

99 ià(
doÜ
 < 0 || door > 5) {

100 
Loggšg
::
	`bug
("Do_move: bad doÜ %d.", 
doÜ
);

104 
š_room
 = 
ch
->in_room;

106 ià((
³x™
 = 
š_room
->
ex™
[
doÜ
]è=ğ
nuÎ±r


107 || (
to_room
 = 
³x™
->to_roomè=ğ
nuÎ±r


108 || !
	`ÿn_£e_room
(
ch
, 
³x™
->
to_room
)) {

109 
	`¡c
("AÏs, you cªnÙ gØth© way.\n", 
ch
);

113 ià(
to_room
->
	`æags
().
	`has
(
ROOM_LAW
)

114 && (
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
ACT_AGGRESSIVE
))) {

115 
	`¡c
("They dÚ'ˆ£emØwªˆyou¸'ty³' h”e.", 
ch
);

119 ià(
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
)

120 && (!
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
·ss_doÜ
è|| 
³x™
->
ex™_æags
.
	`has
(
EX_NOPASS
))

121 && !
	`IS_IMMORTAL
(
ch
)) {

122 
	`aù
("Th$d i şo£d.", 
ch
, 
nuÎ±r
, 
³x™
->
	`keywÜd
(), 
TO_CHAR
);

142 ià(!
	`is_room_owÃr
(
ch
, 
to_room
è&&o_room->
	`is_´iv©e
()) {

143 
	`¡c
("SÜry,h©„oom i ´iv©e.\n", 
ch
);

147 ià(!
ch
->
	`is_Åc
()) {

148 ià(
to_room
->
	`gud
(è!ğ
Gud
::
nÚe


149 && 
to_room
->
	`gud
(è!ğ
ch
->
gud


150 && !
	`IS_IMMORTAL
(
ch
)) {

151 
	`¡c
("You mu¡ b¨gud memb”Ø’‹r.\n", 
ch
);

156 ià(
š_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
)) {

157 ià(
to_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
))

158 
	`¡c
("{CYou cÚtšutØhŞd you¸b»©h...{x\n", 
ch
);

160 
	`¡c
("{CYou ga¥ fÜ‡œ!{x\n", 
ch
);

162 ià(
to_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
))

163 
	`¡c
("{CYou begšØhŞd you¸b»©h.{x\n", 
ch
);

166 ià((
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
aœ


167 || 
to_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
aœ
)

168 && !
	`IS_FLYING
(
ch
)

169 && !
	`IS_IMMORTAL
(
ch
)) {

170 ià(
	`CAN_FLY
(
ch
))

171 
	`do_æy
(
ch
, "");

173 
	`¡c
("You cªnÙ fly!\n", 
ch
);

175 ià(!
	`IS_FLYING
(
ch
))

179 ià((
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
w©”_noswim


180 || 
to_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
w©”_noswim
)

181 && !
	`IS_FLYING
(
ch
)

182 && !
	`IS_IMMORTAL
(
ch
)

183 && !
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
swimmšg
)) {

185 
boŞ
 
found
 = 
çl£
;

187 
Objeù
 *
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
)

188 ià(
obj
->
™em_ty³
 =ğ
ITEM_BOAT
) {

189 
found
 = 
Œue
;

193 ià(!
found
) {

195 ià(
	`CAN_FLY
(
ch
))

196 
	`do_æy
(
ch
, "");

199 ià(!
	`IS_FLYING
(
ch
)) {

200 
	`¡c
("You dÚ'ˆæßˆw–È’oughØw®k oÀw©”.\n", 
ch
);

206 cÚ¡‡uto& 
loss_’Œy1
 = 
¡amša_loss
.
	`fšd
(
š_room
->
	`£ùÜ_ty³
());

207 cÚ¡‡uto& 
loss_’Œy2
 = 
¡amša_loss
.
	`fšd
(
to_room
->
	`£ùÜ_ty³
());

208 
co¡
 = (
loss_’Œy1
 =ğ
¡amša_loss
.
	`ûnd
(è? 0 :†oss_’Œy1->
£cÚd
)

209 + (
loss_’Œy2
 =ğ
¡amša_loss
.
	`ûnd
(è? 0 :†oss_’Œy2->
£cÚd
);

212 ià(
	`IS_FLYING
(
ch
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
ha¡e
))

213 
co¡
 /= 2;

215 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
))

216 
co¡
 *= 2;

219 ià(
	`HAS_RAFF
(
ch
, 
RAFF_LIGHTFEET
))

220 
co¡
 /= 2;

222 ià(
ch
->
¡am
 < 
co¡
) {

223 
	`¡c
("You‡»oØexhau¡edØcÚtšue.\n", 
ch
);

228 ià(
	`HAS_RAFF
(
ch
, 
RAFF_SLOWWALK
))

229 
	`WAIT_STATE
(
ch
, 3);

231 
	`WAIT_STATE
(
ch
, 1);

233 
ch
->
¡am
 -ğ
co¡
;

235 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¢—k
è|| ch->
švis_Ëv–


236 || (!
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
PLR_SUPERWIZ
)))

237 
	`aù
("$ÀËave $T.", 
ch
, 
nuÎ±r
, 
Ex™
::
	`dœ_Çme
(
doÜ
), 
TO_NOTVIEW
, 
POS_SNEAK
, 
çl£
);

239 
	`aù
("$ÀËave $T.", 
ch
, 
nuÎ±r
, 
Ex™
::
	`dœ_Çme
(
doÜ
), 
TO_NOTVIEW
);

241 
	`ch¬_äom_room
(
ch
);

242 
	`ch¬_to_room
(
ch
, 
to_room
);

244 ià(
Ex™
::
	`»v_dœ
(
doÜ
) == 5)

245 
FÜm©
::
	`¥rštf
(
dœ_buf
, "%s", "below");

246 ià(
Ex™
::
	`»v_dœ
(
doÜ
) == 4)

247 
FÜm©
::
	`¥rštf
(
dœ_buf
, "%s", "above");

249 
FÜm©
::
	`¥rštf
(
dœ_buf
, "th%s", 
Ex™
::
	`dœ_Çme
(
doÜ
, 
Œue
));

251 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¢—k
è|| ch->
švis_Ëv–


252 || (!
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
PLR_SUPERWIZ
)))

253 
	`aù
("$Àha ¬rived from $T.", 
ch
, 
nuÎ±r
, 
dœ_buf
, 
TO_NOTVIEW
, 
POS_SNEAK
, 
çl£
);

255 
	`aù
("$Àha ¬rived from $T.", 
ch
, 
nuÎ±r
, 
dœ_buf
, 
TO_NOTVIEW
);

257 
	`do_look
(
ch
, "auto");

259 
fch
 = 
to_room
->
³İË
; fch !ğ
nuÎ±r
; fch = 
fch_Ãxt
) {

260 
fch_Ãxt
 = 
fch
->
Ãxt_š_room
;

262 ià(
fch
->
	`is_Åc
(è&& fch->
¥ec_fun
 && fch->¥ec_fuÀ=ğ
	`¥ec_lookup
("spec_clanguard"))

263 
	`¥ec_şªgu¬d
(
fch
);

266 ià(
š_room
 =ğ
to_room
)

269 
fch
 = 
š_room
->
³İË
; fch !ğ
nuÎ±r
; fch = 
fch_Ãxt
) {

270 
fch_Ãxt
 = 
fch
->
Ãxt_š_room
;

272 ià(
fch
->
ma¡”
 =ğ
ch
 && 
afãù
::
	`exi¡s_Ú_ch¬
(fch,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& 
	`g‘_pos™iÚ
(fchè< 
POS_STANDING
) {

273 ià(
fch
->
¡¬t_pos
 =ğ
POS_FLYING
 && 
	`CAN_FLY
(fch))

274 
	`do_æy
(
fch
, "");

276 
	`do_¡ªd
(
fch
, "");

279 ià(
fch
->
ma¡”
 =ğ
ch
 && 
	`g‘_pos™iÚ
(fchè>ğ
POS_STANDING
 && 
	`ÿn_£e_room
(fch, 
to_room
)) {

280 ià(
fch
->
	`is_Åc
(è&& fch->
aù_æags
.
	`has
(
ACT_STAY
))

283 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_LAW
è&& (
fch
->
	`is_Åc
()

284 && 
fch
->
aù_æags
.
	`has
(
ACT_AGGRESSIVE
))) {

285 
	`aù
("You cª'ˆbršg $N iÁØthc™y.", 
ch
, 
nuÎ±r
, 
fch
, 
TO_CHAR
);

286 
	`aù
("They dÚ'ˆ£emØwªˆyou¸'ty³' h”e.", 
fch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

290 
	`aù
("You fŞlow $N.", 
fch
, 
nuÎ±r
, 
ch
, 
TO_CHAR
);

291 
	`move_ch¬
(
fch
, 
doÜ
, 
Œue
);

295 
	`m´og_’Œy_Œigg”
(
ch
);

297 ià(!
ch
->
	`is_g¬bage
())

298 
	`m´og_g»‘_Œigg”
(
ch
);

299 
	}
}

301 
	$do_nÜth
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

303 
	`move_ch¬
(
ch
, 
DIR_NORTH
, 
çl£
);

305 
	}
}

307 
	$do_—¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

309 
	`move_ch¬
(
ch
, 
DIR_EAST
, 
çl£
);

311 
	}
}

313 
	$do_south
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

315 
	`move_ch¬
(
ch
, 
DIR_SOUTH
, 
çl£
);

317 
	}
}

319 
	$do_we¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

321 
	`move_ch¬
(
ch
, 
DIR_WEST
, 
çl£
);

323 
	}
}

325 
	$do_up
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

327 
	`move_ch¬
(
ch
, 
DIR_UP
, 
çl£
);

329 
	}
}

331 
	$do_down
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

333 
	`move_ch¬
(
ch
, 
DIR_DOWN
, 
çl£
);

335 
	}
}

337 
	$fšd_doÜ
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬g
)

339 
Ex™
 *
³x™
;

340 
doÜ
;

342 ià(
¬g
.
	`is_´efix_of
("nÜth")è
doÜ
 = 0;

343 ià(
¬g
.
	`is_´efix_of
("—¡")è
doÜ
 = 1;

344 ià(
¬g
.
	`is_´efix_of
("south")è
doÜ
 = 2;

345 ià(
¬g
.
	`is_´efix_of
("we¡")è
doÜ
 = 3;

346 ià(
¬g
.
	`is_´efix_of
("up")è
doÜ
 = 4;

347 ià(
¬g
.
	`is_´efix_of
("down")è
doÜ
 = 5;

349 
doÜ
 = 0; door <= 5; door++) {

350 ià((
³x™
 = 
ch
->
š_room
->
ex™
[
doÜ
]è!ğ
nuÎ±r


351 && 
³x™
->
ex™_æags
.
	`has
(
EX_ISDOOR
)

352 && 
³x™
->
	`keywÜd
().
	`has_wÜds
(
¬g
))

353  
doÜ
;

356 
	`aù
("You s“‚Ø$T h”e.", 
ch
, 
nuÎ±r
, 
¬g
, 
TO_CHAR
);

360 ià((
³x™
 = 
ch
->
š_room
->
ex™
[
doÜ
]è=ğ
nuÎ±r
) {

361 
	`aù
("Th”e' nØdoÜ $T h”e.", 
ch
, 
nuÎ±r
, 
¬g
, 
TO_CHAR
);

365 ià(!
³x™
->
ex™_æags
.
	`has
(
EX_ISDOOR
)) {

366 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

370  
doÜ
;

371 
	}
}

374 
	$fšd_ex™
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬g
)

376 
Ex™
 *
³x™
;

377 
doÜ
;

379 ià(
¬g
 =ğ"n" ||‡rg =ğ"nÜth"è
doÜ
 = 0;

380 ià(
¬g
 =ğ"e" ||‡rg =ğ"—¡"è
doÜ
 = 1;

381 ià(
¬g
 =ğ"s" ||‡rg =ğ"south"è
doÜ
 = 2;

382 ià(
¬g
 =ğ"w" ||‡rg =ğ"we¡"è
doÜ
 = 3;

383 ià(
¬g
 =ğ"u" ||‡rg =ğ"up"è
doÜ
 = 4;

384 ià(
¬g
 =ğ"d" ||‡rg =ğ"down"è
doÜ
 = 5;

386 
doÜ
 = 0; door <= 5; door++) {

387 ià((
³x™
 = 
ch
->
š_room
->
ex™
[
doÜ
]è!ğ
nuÎ±r


388 && 
³x™
->
ex™_æags
.
	`has
(
EX_ISDOOR
)

389 && 
³x™
->
	`keywÜd
().
	`has_wÜds
(
¬g
))

390  
doÜ
;

393 
	`aù
("I s“‚Ø$T h”e.", 
ch
, 
nuÎ±r
, 
¬g
, 
TO_CHAR
);

397 ià((
³x™
 = 
ch
->
š_room
->
ex™
[
doÜ
]è=ğ
nuÎ±r
) {

398 
	`aù
("I s“‚ØdoÜ $T h”e.", 
ch
, 
nuÎ±r
, 
¬g
, 
TO_CHAR
);

402  
doÜ
;

403 
	}
}

405 
	$do_İ’
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

407 
Objeù
 *
obj
;

408 
doÜ
;

410 ià(
¬gum’t
.
	`em±y
()) {

411 
	`¡c
("O³Àwh©?\n", 
ch
);

415 
SŒšg
 
¬g
;

416 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

418 ià(!
¬g
.
	`is_´efix_of
("north")

419 && !
¬g
.
	`is_´efix_of
("east")

420 && !
¬g
.
	`is_´efix_of
("south")

421 && !
¬g
.
	`is_´efix_of
("west")

422 && !
¬g
.
	`is_´efix_of
("up")

423 && !
¬g
.
	`is_´efix_of
("down")

424 && (
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬g
)è!ğ
nuÎ±r
) {

426 ià(
obj
->
™em_ty³
 =ğ
ITEM_PORTAL
) {

427 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_ISDOOR
)) {

428 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

432 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_CLOSED
)) {

433 
	`¡c
("It' ®»ady o³n.\n", 
ch
);

437 ià(
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_LOCKED
)) {

438 
	`¡c
("It' locked.\n", 
ch
);

442 
obj
->
v®ue
[1] -ğ
EX_CLOSED
;

443 
	`aù
("You o³À$°ªd‡ brighˆunhŞy†ighˆdawn upÚ you.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

444 
	`aù
("$Àİ’ $°ªd i ov”k’ by‡ÀunhŞy†ight.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

449 ià(
obj
->
™em_ty³
 !ğ
ITEM_CONTAINER
) {

450 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_COMPARTMENT
))

451 
	`¡c
("It' ®»ady o³n.\n", 
ch
);

452 ià(
obj
->
cÚšs
)

453 
	`¡c
("You cª'ˆİ’ it.\n", 
ch
);

455 
	`¡c
("Th©' nÙ‡ cÚš”.\n", 
ch
);

460 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
CONT_CLOSED
)) {

461 
	`¡c
("It' ®»ady o³n.\n", 
ch
);

465 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
CONT_CLOSEABLE
)) {

466 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

470 ià(
obj
->
v®ue
[1].
	`æags
().
	`has
(
CONT_LOCKED
)) {

471 
	`¡c
("It' locked.\n", 
ch
);

475 
obj
->
v®ue
[1] -ğ
CONT_CLOSED
;

476 
	`aù
("You o³À$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

477 
	`aù
("$Àİ’ $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

481 ià((
doÜ
 = 
	`fšd_doÜ
(
ch
, 
¬g
)) >= 0) {

483 
Room
 *
to_room
;

484 
Ex™
 *
³x™
;

485 
Ex™
 *
³x™_»v
;

486 
³x™
 = 
ch
->
š_room
->
ex™
[
doÜ
];

488 ià(!
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
))

489 { 
	`¡c
("It' ®»ady o³n.\n", 
ch
); ; }

491 ià(
³x™
->
ex™_æags
.
	`has
(
EX_LOCKED
))

492 { 
	`¡c
("It' locked.\n", 
ch
); ; }

494 
³x™
->
ex™_æags
 -ğ
EX_CLOSED
;

495 
	`aù
("$Àİ’ th$d.", 
ch
, 
nuÎ±r
, 
³x™
->
	`keywÜd
(), 
TO_ROOM
);

496 
	`¡c
("You o³À™.\n", 
ch
);

499 ià((
to_room
 = 
³x™
->to_roomè!ğ
nuÎ±r


500 && (
³x™_»v
 = 
to_room
->
ex™
[
Ex™
::
	`»v_dœ
(
doÜ
)]è!ğ
nuÎ±r


501 && 
³x™_»v
->
to_room
 =ğ
ch
->
š_room
) {

502 
Ch¬aù”
 *
rch
;

503 
³x™_»v
->
ex™_æags
 -ğ
EX_CLOSED
;

505 
rch
 = 
to_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
)

506 
	`aù
("Th$d o³ns.", 
rch
, 
nuÎ±r
, 
³x™_»v
->
	`keywÜd
(), 
TO_CHAR
);

511 
	}
}

513 
	$do_şo£
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

515 
Objeù
 *
obj
;

516 
doÜ
;

518 ià(
¬gum’t
.
	`em±y
()) {

519 
	`¡c
("Clo£ wh©?\n", 
ch
);

523 
SŒšg
 
¬g
;

524 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

526 ià(!
¬g
.
	`is_´efix_of
("north")

527 && !
¬g
.
	`is_´efix_of
("east")

528 && !
¬g
.
	`is_´efix_of
("south")

529 && !
¬g
.
	`is_´efix_of
("west")

530 && !
¬g
.
	`is_´efix_of
("up")

531 && !
¬g
.
	`is_´efix_of
("down")

532 && (
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬g
)è!ğ
nuÎ±r
) {

534 ià(
obj
->
™em_ty³
 =ğ
ITEM_PORTAL
) {

535 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_ISDOOR
)

536 || 
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_NOCLOSE
)) {

537 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

541 ià(
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_CLOSED
)) {

542 
	`¡c
("It' ®»ady clo£d.\n", 
ch
);

546 
obj
->
v®ue
[1] +ğ
EX_CLOSED
;

547 
	`aù
("You clo£ $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

548 
	`aù
("$Àşo£ $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

553 ià(
obj
->
™em_ty³
 !ğ
ITEM_CONTAINER
) {

554 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_COMPARTMENT
))

555 
	`¡c
("You cª'ˆşo£ it.\n", 
ch
);

556 ià(
obj
->
cÚšs
)

557 
	`¡c
("Th”i nØ­·»Á o³nšg.\n", 
ch
);

559 
	`¡c
("Th©' nÙ‡ cÚš”.\n", 
ch
);

564 ià(
obj
->
v®ue
[1].
	`æags
().
	`has
(
CONT_CLOSED
)) {

565 
	`¡c
("It' ®»ady clo£d.\n", 
ch
);

569 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
CONT_CLOSEABLE
)) {

570 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

574 
obj
->
v®ue
[1] +ğ
CONT_CLOSED
;

575 
	`aù
("You clo£ $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

576 
	`aù
("$Àşo£ $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

580 ià((
doÜ
 = 
	`fšd_doÜ
(
ch
, 
¬g
)) >= 0) {

582 
Room
 *
to_room
;

583 
Ex™
 *
³x™
;

584 
Ex™
 *
³x™_»v
;

585 
³x™
 = 
ch
->
š_room
->
ex™
[
doÜ
];

587 ià(
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
)) {

588 
	`¡c
("It' ®»ady clo£d.\n", 
ch
);

592 
³x™
->
ex™_æags
 +ğ
EX_CLOSED
;

593 
	`aù
("$Àşo£ th$d.", 
ch
, 
nuÎ±r
, 
³x™
->
	`keywÜd
(), 
TO_ROOM
);

594 
	`¡c
("You clo£ it.\n", 
ch
);

597 ià((
to_room
 = 
³x™
->to_roomè!ğ
nuÎ±r


598 && (
³x™_»v
 = 
to_room
->
ex™
[
Ex™
::
	`»v_dœ
(
doÜ
)]) != 0

599 && 
³x™_»v
->
to_room
 =ğ
ch
->
š_room
) {

600 
Ch¬aù”
 *
rch
;

601 
³x™_»v
->
ex™_æags
 +ğ
EX_CLOSED
;

603 
rch
 = 
to_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
)

604 
	`aù
("Th$d clo£s.", 
rch
, 
nuÎ±r
, 
³x™_»v
->
	`keywÜd
(), 
TO_CHAR
);

607 
	}
}

609 
boŞ
 
	$has_key
(
Ch¬aù”
 *
ch
, 
key
)

611 
Objeù
 *
obj
;

613 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
) {

614 ià(
obj
->
pIndexD©a
->
vnum
 =ğ
key
)

615  
Œue
;

618  
çl£
;

619 
	}
}

621 
	$do_lock
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

623 
Objeù
 *
obj
;

624 
doÜ
;

626 ià(
¬gum’t
.
	`em±y
()) {

627 
	`¡c
("Lock wh©?\n", 
ch
);

631 
SŒšg
 
¬g
;

632 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

634 ià(!
¬g
.
	`is_´efix_of
("north")

635 && !
¬g
.
	`is_´efix_of
("east")

636 && !
¬g
.
	`is_´efix_of
("south")

637 && !
¬g
.
	`is_´efix_of
("west")

638 && !
¬g
.
	`is_´efix_of
("up")

639 && !
¬g
.
	`is_´efix_of
("down")

640 && (
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬g
)è!ğ
nuÎ±r
) {

642 ià(
obj
->
™em_ty³
 =ğ
ITEM_PORTAL
) {

643 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_ISDOOR
)

644 || 
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_NOCLOSE
)) {

645 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

649 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_CLOSED
)) {

650 
	`¡c
("It' nÙ clo£d.\n", 
ch
);

654 ià(
obj
->
v®ue
[4] < 0 || obj->v®ue[1].
	`æags
().
	`has
(
EX_NOLOCK
)) {

655 
	`¡c
("Iˆÿn'ˆblocked.\n", 
ch
);

659 ià(!
	`has_key
(
ch
, 
obj
->
v®ue
[4])) {

660 
	`¡c
("You†ackhkey.\n", 
ch
);

664 ià(
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_LOCKED
)) {

665 
	`¡c
("It' ®»ady†ocked.\n", 
ch
);

669 
obj
->
v®ue
[1] +ğ
EX_LOCKED
;

670 
	`aù
("You†ock $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

671 
	`aù
("$Àlock $°ªd c¬efuÎy hide thkey.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

676 ià(
obj
->
™em_ty³
 !ğ
ITEM_CONTAINER
) {

677 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_COMPARTMENT
))

678 
	`¡c
("You cª'ˆev’ clo£ it,†‘‡lÚlock it.\n", 
ch
);

679 ià(
obj
->
cÚšs
)

680 
	`¡c
("You cª'ˆfšd‡ keyhŞe.\n", 
ch
);

682 
	`¡c
("Th©' nÙ‡ cÚš”.\n", 
ch
);

687 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
CONT_CLOSED
)) {

688 
	`¡c
("It' nÙ clo£d.\n", 
ch
);

692 ià(
obj
->
v®ue
[2] < 0) {

693 
	`¡c
("Iˆÿn'ˆblocked.\n", 
ch
);

697 ià(!
	`has_key
(
ch
, 
obj
->
v®ue
[2])) {

698 
	`¡c
("You†ackhkey.\n", 
ch
);

702 ià(
obj
->
v®ue
[1].
	`æags
().
	`has
(
CONT_LOCKED
)) {

703 
	`¡c
("It' ®»ady†ocked.\n", 
ch
);

707 
obj
->
v®ue
[1] +ğ
CONT_LOCKED
;

708 
	`aù
("You†ock $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

709 
	`aù
("$Àlock $°ªd c¬efuÎy hide thkey.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

713 ià((
doÜ
 = 
	`fšd_doÜ
(
ch
, 
¬g
)) >= 0) {

715 
Room
 *
to_room
;

716 
Ex™
 *
³x™
;

717 
Ex™
 *
³x™_»v
;

718 
³x™
 = 
ch
->
š_room
->
ex™
[
doÜ
];

720 ià(!
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
)) {

721 
	`¡c
("It' nÙ clo£d.\n", 
ch
);

725 ià(
³x™
->
	`key
() < 0) {

726 
	`¡c
("Iˆÿn'ˆblocked.\n", 
ch
);

730 ià(!
	`has_key
(
ch
, 
³x™
->
	`key
())) {

731 
	`¡c
("You†ackhkey.\n", 
ch
);

735 ià(
³x™
->
ex™_æags
.
	`has
(
EX_LOCKED
)) {

736 
	`¡c
("It' ®»ady†ocked.\n", 
ch
);

740 
³x™
->
ex™_æags
 +ğ
EX_LOCKED
;

741 
	`¡c
("You†ockhdoÜ.\n", 
ch
);

742 
	`aù
("$Àlock th$d.", 
ch
, 
nuÎ±r
, 
³x™
->
	`keywÜd
(), 
TO_ROOM
);

745 ià((
to_room
 = 
³x™
->to_roomè!ğ
nuÎ±r


746 && (
³x™_»v
 = 
to_room
->
ex™
[
Ex™
::
	`»v_dœ
(
doÜ
)]) != 0

747 && 
³x™_»v
->
to_room
 =ğ
ch
->
š_room
)

748 
³x™_»v
->
ex™_æags
 +ğ
EX_LOCKED
;

750 
	}
}

752 
	$do_uÆock
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

754 
Objeù
 *
obj
;

755 
doÜ
;

757 ià(
¬gum’t
.
	`em±y
()) {

758 
	`¡c
("UÆock wh©?\n", 
ch
);

762 
SŒšg
 
¬g
;

763 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

765 ià(!
¬g
.
	`is_´efix_of
("north")

766 && !
¬g
.
	`is_´efix_of
("east")

767 && !
¬g
.
	`is_´efix_of
("south")

768 && !
¬g
.
	`is_´efix_of
("west")

769 && !
¬g
.
	`is_´efix_of
("up")

770 && !
¬g
.
	`is_´efix_of
("down")

771 && (
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬g
)è!ğ
nuÎ±r
) {

773 ià(
obj
->
™em_ty³
 =ğ
ITEM_PORTAL
) {

774 ià(
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_ISDOOR
)) {

775 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

779 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_CLOSED
)) {

780 
	`¡c
("It' nÙ clo£d.\n", 
ch
);

784 ià(
obj
->
v®ue
[4] < 0) {

785 
	`¡c
("Iˆÿn'ˆbuÆocked.\n", 
ch
);

789 ià(!
	`has_key
(
ch
, 
obj
->
v®ue
[4])) {

790 
	`¡c
("You†ackhkey.\n", 
ch
);

794 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_LOCKED
)) {

795 
	`¡c
("It' ®»ady uÆocked.\n", 
ch
);

799 
obj
->
v®ue
[1] -ğ
EX_LOCKED
;

800 
	`aù
("You uÆock $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

801 
	`aù
("$ÀuÆock $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

806 ià(
obj
->
™em_ty³
 !ğ
ITEM_CONTAINER
) {

807 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_COMPARTMENT
))

808 
	`¡c
("It' nÙƒv’ clo£d.\n", 
ch
);

809 ià(
obj
->
cÚšs
)

810 
	`¡c
("You cª'ˆuÆockh©.\n", 
ch
);

812 
	`¡c
("Th©' nÙ‡ cÚš”.\n", 
ch
);

817 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
CONT_CLOSED
)) {

818 
	`¡c
("It' nÙ clo£d.\n", 
ch
);

822 ià(
obj
->
v®ue
[2] < 0) {

823 
	`¡c
("Iˆÿn'ˆbuÆocked.\n", 
ch
);

827 ià(!
	`has_key
(
ch
, 
obj
->
v®ue
[2])) {

828 
	`¡c
("You†ackhkey.\n", 
ch
);

832 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
CONT_LOCKED
)) {

833 
	`¡c
("It' ®»ady uÆocked.\n", 
ch
);

837 
obj
->
v®ue
[1] -ğ
CONT_LOCKED
;

838 
	`aù
("You uÆock $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

839 
	`aù
("$ÀuÆock $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

843 ià((
doÜ
 = 
	`fšd_doÜ
(
ch
, 
¬g
)) >= 0) {

845 
Room
 *
to_room
;

846 
Ex™
 *
³x™
;

847 
Ex™
 *
³x™_»v
;

848 
³x™
 = 
ch
->
š_room
->
ex™
[
doÜ
];

850 ià(!
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
)) {

851 
	`¡c
("It' nÙ clo£d.\n", 
ch
);

855 ià(
³x™
->
	`key
() < 0) {

856 
	`¡c
("Iˆÿn'ˆbuÆocked.\n", 
ch
);

860 ià(!
	`has_key
(
ch
, 
³x™
->
	`key
())) {

861 
	`¡c
("You†ackhkey.\n", 
ch
);

865 ià(!
³x™
->
ex™_æags
.
	`has
(
EX_LOCKED
)) {

866 
	`¡c
("It' ®»ady uÆocked.\n", 
ch
);

870 
³x™
->
ex™_æags
 -ğ
EX_LOCKED
;

871 
	`¡c
("You uÆock it.\n", 
ch
);

872 
	`aù
("$ÀuÆock th$d.", 
ch
, 
nuÎ±r
, 
³x™
->
	`keywÜd
(), 
TO_ROOM
);

875 ià((
to_room
 = 
³x™
->to_roomè!ğ
nuÎ±r


876 && (
³x™_»v
 = 
to_room
->
ex™
[
Ex™
::
	`»v_dœ
(
doÜ
)]è!ğ
nuÎ±r


877 && 
³x™_»v
->
to_room
 =ğ
ch
->
š_room
)

878 
³x™_»v
->
ex™_æags
 -ğ
EX_LOCKED
;

880 
	}
}

882 
	$do_pick
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

884 
Ch¬aù”
 *
gch
;

885 
Objeù
 *
obj
;

886 
doÜ
;

888 ià(
¬gum’t
.
	`em±y
()) {

889 
	`¡c
("Pick wh©? You¸no£!?\n", 
ch
);

893 
SŒšg
 
¬g
;

894 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

896 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
pick_lock
).
b—ts
);

899 
gch
 = 
ch
->
š_room
->
³İË
; gch; gch = gch->
Ãxt_š_room
) {

900 ià(
gch
->
	`is_Åc
(è&& 
	`IS_AWAKE
(gchè&& 
ch
->
Ëv–
 + 5 < gch->level) {

901 
	`aù
("$N‡ppearso be…rotecting it.",

902 
ch
, 
nuÎ±r
, 
gch
, 
TO_CHAR
);

907 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
pick_lock
)) {

908 
	`¡c
("Hmm. You s“mØÏckhknowËdgÚ howØpicklocks.\n", 
ch
);

912 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
pick_lock
))

915 ià(!
ch
->
	`is_Åc
(è&& 
	`numb”_³rûÁ
(è> 
	`g‘_skl_Ëv–
(ch, 
skl
::
ty³
::
pick_lock
)) {

916 
	`¡c
("You faed.\n", 
ch
);

917 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
pick_lock
, 
çl£
, 2);

921 ià((
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬g
)è!ğ
nuÎ±r
) {

923 ià(
obj
->
™em_ty³
 =ğ
ITEM_PORTAL
) {

924 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_ISDOOR
)) {

925 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

929 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_CLOSED
)) {

930 
	`¡c
("It' nÙ clo£d.\n", 
ch
);

934 ià(
obj
->
v®ue
[4] < 0) {

935 
	`¡c
("Iˆÿn'ˆbuÆocked.\n", 
ch
);

939 ià(
obj
->
v®ue
[1].
	`æags
().
	`has
(
EX_PICKPROOF
)) {

940 
	`¡c
("You faed.\n", 
ch
);

944 
obj
->
v®ue
[1] -ğ
EX_LOCKED
;

945 
	`aù
("You…ickhlock oÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

946 
	`aù
("$Àpick thlock oÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

947 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
pick_lock
, 
Œue
, 2);

952 ià(
obj
->
™em_ty³
 !ğ
ITEM_CONTAINER
) {

953 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_COMPARTMENT
))

954 
	`¡c
("It' nÙƒv’ clo£d.\n", 
ch
);

955 ià(
obj
->
cÚšs
)

956 
	`¡c
("IˆdÛ¢'ˆ£emØhav¨lock.\n", 
ch
);

958 
	`¡c
("Th©' nÙ‡ cÚš”.\n", 
ch
);

963 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
CONT_CLOSED
))

964 { 
	`¡c
("It' nÙ clo£d.\n", 
ch
); ; }

966 ià(
obj
->
v®ue
[2] < 0)

967 { 
	`¡c
("Iˆÿn'ˆbuÆocked.\n", 
ch
); ; }

969 ià(!
obj
->
v®ue
[1].
	`æags
().
	`has
(
CONT_LOCKED
))

970 { 
	`¡c
("It' ®»ady uÆocked.\n", 
ch
); ; }

972 ià(
obj
->
v®ue
[1].
	`æags
().
	`has
(
CONT_PICKPROOF
))

973 { 
	`¡c
("UnfÜtuÇ‹ly, you¸skl ´ovtØbÏckšg.\n", 
ch
); ; }

975 
obj
->
v®ue
[1] -ğ
CONT_LOCKED
;

976 
	`aù
("You…ickhlock oÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

977 
	`aù
("$Àpick thlock oÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

978 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
pick_lock
, 
Œue
, 2);

982 ià((
doÜ
 = 
	`fšd_doÜ
(
ch
, 
¬g
)) >= 0) {

984 
Room
 *
to_room
;

985 
Ex™
 *
³x™
;

986 
Ex™
 *
³x™_»v
;

987 
³x™
 = 
ch
->
š_room
->
ex™
[
doÜ
];

989 ià(!
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
è&& !
	`IS_IMMORTAL
(
ch
))

990 { 
	`¡c
("It' nÙ clo£d.\n", 
ch
); ; }

992 ià(
³x™
->
	`key
(è< 0 && !
	`IS_IMMORTAL
(
ch
))

993 { 
	`¡c
("Iˆÿn'ˆbpicked.\n", 
ch
); ; }

995 ià(!
³x™
->
ex™_æags
.
	`has
(
EX_LOCKED
))

996 { 
	`¡c
("It' ®»ady uÆocked.\n", 
ch
); ; }

998 ià(
³x™
->
ex™_æags
.
	`has
(
EX_PICKPROOF
è&& !
	`IS_IMMORTAL
(
ch
))

999 { 
	`¡c
("UnfÜtuÇ‹ly, you¸skl ´ovtØbÏckšg.\n", 
ch
); ; }

1001 
³x™
->
ex™_æags
 -ğ
EX_LOCKED
;

1002 
	`¡c
("You…ick it!!\n", 
ch
);

1003 
	`aù
("$Àpick th$d.", 
ch
, 
nuÎ±r
, 
³x™
->
	`keywÜd
(), 
TO_ROOM
);

1004 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
pick_lock
, 
Œue
, 2);

1007 ià((
to_room
 = 
³x™
->to_roomè!ğ
nuÎ±r


1008 && (
³x™_»v
 = 
to_room
->
ex™
[
Ex™
::
	`»v_dœ
(
doÜ
)]è!ğ
nuÎ±r


1009 && 
³x™_»v
->
to_room
 =ğ
ch
->
š_room
)

1010 
³x™_»v
->
ex™_æags
 -ğ
EX_LOCKED
;

1014 
	}
}

1016 
	$do_¡ªd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1018 
Objeù
 *
obj
 = 
nuÎ±r
;

1026 ià(!
¬gum’t
.
	`em±y
()) {

1027 ià(
	`g‘_pos™iÚ
(
ch
è=ğ
POS_FIGHTING
) {

1028 
	`¡c
("Thi i ®»ady‡ sndu°fight!\n", 
ch
);

1032 
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬gum’t
, ch->
š_room
->
cÚ‹Ás
);

1034 ià(
obj
 =ğ
nuÎ±r
) {

1035 ià(
	`g‘_ch¬_h”e
(
ch
, 
¬gum’t
, 
VIS_CHAR
è!ğ
nuÎ±r
)

1036 
	`¡c
("I th© how you»© you¸ä›nds?\n", 
ch
);

1038 
	`¡c
("You dÚ'ˆ£th© h”e.\n", 
ch
);

1043 ià(
obj
->
™em_ty³
 !ğ
ITEM_FURNITURE


1044 || (!
obj
->
v®ue
[2].
	`æags
().
	`has
(
STAND_AT
)

1045 && !
obj
->
v®ue
[2].
	`æags
().
	`has
(
STAND_ON
)

1046 && !
obj
->
v®ue
[2].
	`æags
().
	`has
(
STAND_IN
))) {

1047 
	`¡c
("You cª'ˆ£emØfšd‡…ÏûØ¡ªd.\n", 
ch
);

1051 ià(
ch
->
Ú
 !ğ
obj
 && 
	`couÁ_u£rs
(objè>ğobj->
v®ue
[0]) {

1052 
	`aù
("There's‚o„oomo stand on $p.",

1053 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
, 
POS_DEAD
, 
çl£
);

1058 
	`g‘_pos™iÚ
(
ch
)) {

1059 
POS_SLEEPING
:

1060 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦“p
)) {

1061 
	`¡c
("You dÚ'ˆ£emØwªˆtØwakup!\n", 
ch
);

1065 ià(
obj
 =ğ
nuÎ±r
) {

1066 
	`¡c
("You wakªd snd up.\n", 
ch
);

1067 
	`aù
("$Àwake ªd snd up.", 
ch
, 
nuÎ±r
,‚ullptr,

1068 
TO_ROOM
);

1069 
ch
->
Ú
 = 
nuÎ±r
;

1071 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
STAND_AT
)) {

1072 
	`aù
("You wakªd snd‡ˆ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1073 
	`aù
("$Àwake ªd snd © $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1075 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
STAND_ON
)) {

1076 
	`aù
("You wakªd snd oÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1077 
	`aù
("$Àwake ªd snd Ú $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1080 
	`aù
("You wakªd snd iÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1081 
	`aù
("$Àwake ªd snd š $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1084 
ch
->
pos™iÚ
 = 
POS_STANDING
;

1085 
	`do_look
(
ch
, "auto");

1088 
POS_RESTING
: 
POS_SITTING
:

1089 ià(
obj
 =ğ
nuÎ±r
) {

1090 
	`¡c
("You snd up.\n", 
ch
);

1091 
	`aù
("$À¡ªd up.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1092 
ch
->
Ú
 = 
nuÎ±r
;

1094 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
STAND_AT
)) {

1095 
	`aù
("You snd‡ˆ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1096 
	`aù
("$À¡ªd © $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1098 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
STAND_ON
)) {

1099 
	`aù
("You snd oÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1100 
	`aù
("$À¡ªd Ú $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1103 
	`aù
("You snd iÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1104 
	`aù
("$À¡ªd Ú $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1107 
ch
->
pos™iÚ
 = 
POS_STANDING
;

1110 
POS_FLYING
:

1111 
	`do_Ïnd
(
ch
, "");

1114 
POS_STANDING
:

1115 
	`¡c
("You‡»‡Ì—dy sndšg.\n", 
ch
);

1118 
POS_FIGHTING
:

1119 
	`¡c
("Thi i ®»ady‡ sndu°fight!\n", 
ch
);

1123 
ch
->
¡¬t_pos
 = 
POS_STANDING
;

1125 
	}
}

1127 
	$do_»¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1129 
Objeù
 *
obj
 = 
nuÎ±r
;

1131 ià(
ch
->
fightšg
) {

1132 
	`¡c
("HEY! NO†ayšg dowÀÚhJOB!!\n", 
ch
);

1137 ià(!
¬gum’t
.
	`em±y
()) {

1138 
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬gum’t
, ch->
š_room
->
cÚ‹Ás
);

1140 ià(
obj
 =ğ
nuÎ±r
) {

1141 ià(
	`g‘_ch¬_h”e
(
ch
, 
¬gum’t
, 
VIS_CHAR
è!ğ
nuÎ±r
)

1142 
	`¡c
("I th© how you»© you¸ä›nds?\n", 
ch
);

1144 
	`¡c
("You dÚ'ˆ£th© h”e.\n", 
ch
);

1149 
obj
 = 
ch
->
Ú
;

1151 ià(
obj
 !ğ
nuÎ±r
) {

1152 ià(
obj
->
™em_ty³
 !ğ
ITEM_FURNITURE


1153 || (!
obj
->
v®ue
[2].
	`æags
().
	`has
(
REST_ON
)

1154 && !
obj
->
v®ue
[2].
	`æags
().
	`has
(
REST_IN
)

1155 && !
obj
->
v®ue
[2].
	`æags
().
	`has
(
REST_AT
))) {

1156 
	`¡c
("You cª'ˆ»¡ oÀth©.\n", 
ch
);

1160 ià(
ch
->
Ú
 !ğ
obj
 && 
	`couÁ_u£rs
(objè>ğobj->
v®ue
[0]) {

1161 
	`aù
("Th”e' nØmÜroom oÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1165 
ch
->
Ú
 = 
obj
;

1168 
	`g‘_pos™iÚ
(
ch
)) {

1169 
POS_SLEEPING
:

1170 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦“p
)) {

1171 
	`¡c
("You dÚ'ˆ£emØwªˆtØwakup!\n", 
ch
);

1175 ià(
obj
 =ğ
nuÎ±r
) {

1176 
	`¡c
("You waku°ªd s¹„e¡šg.\n", 
ch
);

1177 
	`aù
("$Àwake u°ªd s¹ »¡šg.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1179 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
REST_AT
)) {

1180 
	`aù
("You wake up‡nd„est‡t $p.",

1181 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
, 
POS_SLEEPING
, 
çl£
);

1182 
	`aù
("$Àwake u°ªd„e¡ © $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1184 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
REST_ON
)) {

1185 
	`aù
("You wake up‡nd„est on $p.",

1186 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
, 
POS_SLEEPING
, 
çl£
);

1187 
	`aù
("$Àwake u°ªd„e¡ Ú $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1190 
	`aù
("You wake up‡nd„est in $p.",

1191 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
, 
POS_SLEEPING
, 
çl£
);

1192 
	`aù
("$Àwake u°ªd„e¡ š $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1195 
ch
->
pos™iÚ
 = 
POS_RESTING
;

1198 
POS_RESTING
:

1199 
	`¡c
("You‡»‡Ì—dy„e¡šg.\n", 
ch
);

1202 
POS_STANDING
:

1203 ià(
obj
 =ğ
nuÎ±r
) {

1204 
	`¡c
("You s™ dowÀªd„e¡.\n", 
ch
);

1205 
	`aù
("$Às™ dowÀªd„e¡s.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1207 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
REST_AT
)) {

1208 
	`aù
("You s™ dowÀ© $°ªd„e¡.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1209 
	`aù
("$Às™ dowÀ© $°ªd„e¡s.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1211 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
REST_ON
)) {

1212 
	`aù
("You s™ oÀ$°ªd„e¡.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1213 
	`aù
("$Às™ Ú $°ªd„e¡s.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1216 
	`aù
("You„e¡ iÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1217 
	`aù
("$À»¡ š $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1220 
ch
->
pos™iÚ
 = 
POS_RESTING
;

1223 
POS_SITTING
:

1224 ià(
obj
 =ğ
nuÎ±r
) {

1225 
	`¡c
("You†ay back‡nd„e¡.\n", 
ch
);

1226 
	`aù
("$Àl› back‡nd„e¡s.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1228 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
REST_AT
)) {

1229 
	`aù
("You„e¡‡ˆ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1230 
	`aù
("$À»¡ © $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1232 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
REST_ON
)) {

1233 
	`aù
("You„e¡ oÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1234 
	`aù
("$À»¡ Ú $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1237 
	`aù
("You„e¡ iÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1238 
	`aù
("$À»¡ š $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1241 
ch
->
pos™iÚ
 = 
POS_RESTING
;

1244 
POS_FLYING
:

1245 
	`do_Ïnd
(
ch
, "");

1247 ià(
ch
->
pos™iÚ
 =ğ
POS_FLYING
)

1250 
ch
->
¡¬t_pos
 = 
POS_FLYING
;

1251 
	`do_»¡
(
ch
, 
¬gum’t
);

1256 
	}
}

1258 
	$do_s™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1260 
Objeù
 *
obj
 = 
nuÎ±r
;

1262 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦“p
)) {

1263 
	`¡c
("You dÚ'ˆ£emØwªˆtØwakup!\n", 
ch
);

1267 ià(
ch
->
fightšg
) {

1268 
	`¡c
("NØs™tšg dowÀduršg…Ù’tŸÎy”mš® fights!\n", 
ch
);

1273 ià(!
¬gum’t
.
	`em±y
()) {

1274 
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬gum’t
, ch->
š_room
->
cÚ‹Ás
);

1276 ià(
obj
 =ğ
nuÎ±r
) {

1277 ià(
	`g‘_ch¬_h”e
(
ch
, 
¬gum’t
, 
VIS_CHAR
è!ğ
nuÎ±r
)

1278 
	`¡c
("I th© how you»© you¸ä›nds?\n", 
ch
);

1280 
	`¡c
("You dÚ'ˆ£th© h”e.\n", 
ch
);

1285 
obj
 = 
ch
->
Ú
;

1287 ià(
obj
 !ğ
nuÎ±r
) {

1288 ià(
obj
->
™em_ty³
 !ğ
ITEM_FURNITURE


1289 || (!
obj
->
v®ue
[2].
	`æags
().
	`has
(
SIT_ON
)

1290 && !
obj
->
v®ue
[2].
	`æags
().
	`has
(
SIT_IN
)

1291 && !
obj
->
v®ue
[2].
	`æags
().
	`has
(
SIT_AT
))) {

1292 
	`¡c
("You cª'ˆs™ oÀth©.\n", 
ch
);

1296 ià(
ch
->
Ú
 !ğ
obj
 && 
	`couÁ_u£rs
(objè>ğobj->
v®ue
[0]) {

1297 
	`aù
("Th”e' nØmÜroom oÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1301 
ch
->
Ú
 = 
obj
;

1304 
	`g‘_pos™iÚ
(
ch
)) {

1305 
POS_SLEEPING
:

1306 ià(
obj
 =ğ
nuÎ±r
) {

1307 
	`¡c
("You wakªd s™ up.\n", 
ch
);

1308 
	`aù
("$Àwake ªd s™ up.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1310 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
SIT_AT
)) {

1311 
	`aù
("You wakªd s™‡ˆ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1312 
	`aù
("$Àwake ªd s™ © $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1314 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
SIT_ON
)) {

1315 
	`aù
("You wakªd s™ oÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1316 
	`aù
("$Àwake ªd s™ © $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1319 
	`aù
("You wakªd s™ iÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1320 
	`aù
("$Àwake ªd s™ š $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1323 
ch
->
pos™iÚ
 = 
POS_SITTING
;

1326 
POS_RESTING
:

1327 ià(
obj
 =ğ
nuÎ±r
)

1328 
	`¡c
("You stİ„e¡šg.\n", 
ch
);

1329 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
SIT_AT
)) {

1330 
	`aù
("You s™‡ˆ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1331 
	`aù
("$Às™ © $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1333 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
SIT_ON
)) {

1334 
	`aù
("You s™ oÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1335 
	`aù
("$Às™ Ú $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1338 
ch
->
pos™iÚ
 = 
POS_SITTING
;

1341 
POS_SITTING
:

1342 
	`¡c
("You‡»‡Ì—dy s™tšg.\n", 
ch
);

1345 
POS_STANDING
:

1346 ià(
obj
 =ğ
nuÎ±r
) {

1347 
	`¡c
("You s™ down.\n", 
ch
);

1348 
	`aù
("$Às™ down.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1350 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
SIT_AT
)) {

1351 
	`aù
("You s™ dowÀ© $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1352 
	`aù
("$Às™ dowÀ© $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1354 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
SIT_ON
)) {

1355 
	`aù
("You s™ oÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1356 
	`aù
("$Às™ Ú $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1359 
	`aù
("You s™ dowÀš $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1360 
	`aù
("$Às™ dowÀš $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1363 
ch
->
pos™iÚ
 = 
POS_SITTING
;

1366 
POS_FLYING
:

1367 
	`do_Ïnd
(
ch
, "");

1369 ià(
ch
->
pos™iÚ
 =ğ
POS_FLYING
)

1372 
	`do_s™
(
ch
, 
¬gum’t
);

1373 
ch
->
¡¬t_pos
 = 
POS_FLYING
;

1378 
	}
}

1380 
	$do_¦“p
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1382 
Objeù
 *
obj
 = 
nuÎ±r
;

1384 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_NOSLEEP
)) {

1385 
	`¡c
("Hmmm...you cª'ˆ£emØçÎ‡¦“°šhi room.\n", 
ch
);

1389 
	`g‘_pos™iÚ
(
ch
)) {

1390 
POS_SLEEPING
:

1391 
	`¡c
("You‡»‡Ì—dy‡¦“p.\n", 
ch
);

1394 
POS_RESTING
:

1395 
POS_SITTING
:

1396 
POS_STANDING
:

1397 ià(
¬gum’t
.
	`em±y
(è&& 
ch
->
Ú
 =ğ
nuÎ±r
) {

1398 
	`¡c
("You gØtØ¦“p.\n", 
ch
);

1399 
	`aù
("$ÀgÛ tØ¦“p.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1400 
ch
->
pos™iÚ
 = 
POS_SLEEPING
;

1403 ià(
¬gum’t
.
	`em±y
())

1404 
obj
 = 
ch
->
Ú
;

1406 
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬gum’t
, ch->
š_room
->
cÚ‹Ás
);

1408 ià(
obj
 =ğ
nuÎ±r
) {

1409 ià(
	`g‘_ch¬_h”e
(
ch
, 
¬gum’t
, 
VIS_CHAR
è!ğ
nuÎ±r
)

1410 
	`¡c
("I th© how you»© you¸ä›nds?\n", 
ch
);

1412 
	`¡c
("You dÚ'ˆ£th© h”e.\n", 
ch
);

1417 ià(
obj
->
™em_ty³
 !ğ
ITEM_FURNITURE
 ||

1418 (!
obj
->
v®ue
[2].
	`æags
().
	`has
(
SLEEP_ON
)

1419 && !
obj
->
v®ue
[2].
	`æags
().
	`has
(
SLEEP_IN
)

1420 && !
obj
->
v®ue
[2].
	`æags
().
	`has
(
SLEEP_AT
))) {

1421 
	`¡c
("You cª'ˆ¦“°Úh©!\n", 
ch
);

1425 ià(
ch
->
Ú
 !ğ
obj
 && 
	`couÁ_u£rs
(objè>ğobj->
v®ue
[0]) {

1426 
	`aù
("There is‚o„oom on $p for you.",

1427 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1431 
ch
->
Ú
 = 
obj
;

1433 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
SLEEP_AT
)) {

1434 
	`aù
("You gØtØ¦“°© $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1435 
	`aù
("$ÀgÛ tØ¦“°© $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1437 ià(
obj
->
v®ue
[2].
	`æags
().
	`has
(
SLEEP_ON
)) {

1438 
	`aù
("You gØtØ¦“°Ú $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1439 
	`aù
("$ÀgÛ tØ¦“°Ú $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1442 
	`aù
("You gØtØ¦“°š $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1443 
	`aù
("$ÀgÛ tØ¦“°š $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1446 
ch
->
pos™iÚ
 = 
POS_SLEEPING
;

1451 
POS_FIGHTING
:

1452 
	`¡c
("I doubˆthi fighˆi THAT bÜšg!\n", 
ch
);

1455 
POS_FLYING
:

1456 
	`do_Ïnd
(
ch
, "");

1458 ià(
ch
->
pos™iÚ
 =ğ
POS_FLYING
)

1461 
	`do_¦“p
(
ch
, 
¬gum’t
);

1462 
ch
->
¡¬t_pos
 = 
POS_FLYING
;

1467 
	}
}

1469 
	$do_wake
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1471 
Ch¬aù”
 *
viùim
;

1473 ià(
¬gum’t
.
	`em±y
()) {

1478 ià(
ch
->
¡¬t_pos
 =ğ
POS_FLYING
 && 
	`CAN_FLY
(ch))

1479 
	`do_æy
(
ch
, "");

1481 
	`do_¡ªd
(
ch
, "");

1486 
SŒšg
 
¬g
;

1487 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1489 ià(!
	`IS_AWAKE
(
ch
))

1490 { 
	`¡c
("IÀyou¸¦“p?\n", 
ch
); ; }

1492 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
)

1493 { 
	`¡c
("Cª'ˆwak'em iàthey‡»‚Ù h”e!\n", 
ch
); ; }

1495 ià(
	`IS_AWAKE
(
viùim
))

1496 { 
	`aù
("$N i a awaka you‡».", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
); ; }

1498 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
¦“p
))

1499 { 
	`aù
("$E dÛ¢'ˆ£emØWANTØwakup!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
); ; }

1501 
	`aù
("$n„udely‡wakes you from your…eaceful slumber.",

1502 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
, 
POS_SLEEPING
, 
çl£
);

1504 ià(
viùim
->
¡¬t_pos
 =ğ
POS_FLYING
 && 
	`CAN_FLY
(victim))

1505 
	`do_æy
(
viùim
, "");

1507 
	`do_¡ªd
(
viùim
, "");

1508 
	}
}

1510 
	$do_¢—k
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1512 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¢—k
)) {

1513 
	`¡c
("You‡Ì—dy su½as thwšd iÀ¡—Éh.\n", 
ch
);

1517 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
¢—k
).
b—ts
);

1519 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
¢—k
)) {

1520 
	`¡c
("Buˆyou dÚ'ˆknow howØ¢—k!\n", 
ch
);

1524 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
¢—k
))

1527 ià(
	`numb”_³rûÁ
(è< 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
¢—k
)) {

1528 
afãù
::
	`add_ty³_to_ch¬
(
ch
,

1529 
afãù
::
ty³
::
¢—k
,

1530 
ch
->
Ëv–
,

1531 
ch
->
Ëv–
,

1532 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
¢—k
),

1533 
çl£


1535 
	`¡c
("You f“ÈmÜ¡—Éhy.\n", 
ch
);

1536 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
¢—k
, 
Œue
, 3);

1539 
	`¡c
("You f“Èlik¨klutz.\n", 
ch
);

1540 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
¢—k
, 
çl£
, 3);

1542 
	}
}

1544 
	$do_hide
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1546 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
hide
)) {

1547 
	`¡c
("You fšd‡Àev’ b‘‹¸hidšg…Ïû.\n", 
ch
);

1551 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
hide
).
b—ts
);

1553 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
hide
)) {

1554 
	`¡c
("Buˆyou dÚ'ˆknow howØhide!\n", 
ch
);

1558 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
hide
))

1561 ià(
	`numb”_³rûÁ
(è< 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
hide
)) {

1562 
afãù
::
	`add_ty³_to_ch¬
(
ch
,

1563 
afãù
::
ty³
::
hide
,

1564 
ch
->
Ëv–
,

1565 
ch
->
Ëv–
,

1566 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
hide
),

1567 
çl£


1569 
	`¡c
("You bËnd iÁØthsu¼oundšgs.\n", 
ch
);

1570 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
hide
, 
Œue
, 3);

1573 
	`¡c
("You‡‰em±ØbšcÚ¥icuous.\n", 
ch
);

1574 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
hide
, 
çl£
, 3);

1576 
	}
}

1581 
	$do_visibË
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1583 
afãù
::
	`»move_ty³_äom_ch¬
(
ch
,‡fãù::
ty³
::
švis
);

1584 
afãù
::
	`»move_ty³_äom_ch¬
(
ch
,‡fãù::
ty³
::
¢—k
);

1585 
afãù
::
	`»move_ty³_äom_ch¬
(
ch
,‡fãù::
ty³
::
hide
);

1586 
afãù
::
	`»move_ty³_äom_ch¬
(
ch
,‡fãù::
ty³
::
midnight
);

1587 
ch
->
aù_æags
 -ğ
PLR_SUPERWIZ
;

1588 
ch
->
švis_Ëv–
 = 0;

1589 
ch
->
lurk_Ëv–
 = 0;

1590 
	`¡c
("You‡»‚ow visibË.\n", 
ch
);

1592 
	}
}

1594 
	$do_»ÿÎ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1596 
	`»ÿÎ
(
ch
, 
çl£
);

1597 
	}
}

1599 
	$do_şª_»ÿÎ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1610 ià(
	`is_şª
(
ch
è|| ch->
aù_æags
.
	`has
(
ACT_PET
)) {

1612 ià(
ch
->
şª
 || ch->
aù_æags
.
	`has
(
ACT_PET
)) {

1613 
	`»ÿÎ
(
ch
, 
Œue
);

1619 
	`¡c
("You dØnÙ b–ÚgØ¨şª.\n", 
ch
);

1622 
	}
}

1624 
	$»ÿÎ
(
Ch¬aù”
 *
ch
, 
boŞ
 
şª
)

1626 
Room
 *
loÿtiÚ
;

1627 
boŞ
 
³t
 = 
çl£
, 
comb©
 = false;

1628 
lo£
 = 0;

1630 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

1633 ià(
ch
->
	`is_Åc
()) {

1634 ià(
ch
->
aù_æags
.
	`has
(
ACT_PET
è&& ch->
ma¡”
 !ğ
nuÎ±r
)

1635 
³t
 = 
Œue
;

1637 
	`±c
(
ch
, "OÆy…Ïy” ªd…‘ ÿÀ%¤eÿÎ.\n", 
şª
 ? "clan" : "");

1642 
	`aù
("$À´ay fÜ divšŒª¥ÜtiÚ...", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1644 ià(
	`ch¬_š_du–
(
ch
)) {

1645 
	`±c
(
ch
, "You cªnÙ %¤eÿÎ fromhdu–‡»Ç.\n", 
şª
 ? "clan" : "");

1649 ià(!
ch
->
	`is_Åc
())

1650 ià(
ch
->
pcd©a
->
pktim”
) {

1651 
	`¡c
("Thgod Ïugh‡ˆyou¸cow¬diû...\n", 
ch
);

1656 ià(
şª
) {

1657 ià(
³t
)

1658 
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
ma¡”
->
şª
->
»ÿÎ
);

1660 
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
şª
->
»ÿÎ
);

1663 
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_TEMPLE
)));

1666 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
şª¬’a
 && !
şª
 && ch->
fightšg
) {

1667 ià(
³t
)

1668 
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
ma¡”
->
şª
->
»ÿÎ
);

1670 
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
şª
->
»ÿÎ
);

1672 ià(
loÿtiÚ
 =ğ
nuÎ±r
)

1673 
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_TEMPLE
)));

1675 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
) {

1676 
DesütÜ
 *
d
;

1677 
boŞ
 
em±y
 = 
Œue
;

1679 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
)

1680 ià(
d
->
	`is_¶ayšg
()

1681 && 
d
->
ch¬aù”
 !ğ
ch


1682 && 
d
->
ch¬aù”
 !ğ
ch
->
³t


1683 && !
	`IS_IMMORTAL
(
d
->
ch¬aù”
)

1684 && 
d
->
ch¬aù”
->
š_room
 !ğ
nuÎ±r


1685 && 
d
->
ch¬aù”
->
š_room
->
	`¬—
(è=ğ
ch
->in_room->area())

1686 
em±y
 = 
çl£
;

1688 ià(
em±y
 && 
ch
->
fightšg
 =ğ
nuÎ±r
 && (
b©e
.
¡¬t
 || !b©e.
issued
)) {

1689 ià(
loÿtiÚ
 =ğ
nuÎ±r
) {

1690 
	`¡c
("You‡» com¶‘–y†o¡.\n", 
ch
);

1694 
	`¡c
("\n{YAfter winninghe great battle,\n"

1695 "you c®ÈupÚhpow” oàthgods!{x\n\n", 
ch
);

1696 
	`aù
("$Àdi§µ—r š‡ viùÜy cloud!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1697 
	`ch¬_äom_room
(
ch
);

1698 
	`ch¬_to_room
(
ch
, 
loÿtiÚ
);

1699 
	`aù
("$À¬rive äom‡ viùÜy cloud!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1700 
	`do_look
(
ch
, "auto");

1703 ià(
ch
->
³t
 !ğ
nuÎ±r
 && ch->³ˆ!ğch->
ma¡”
)

1704 
	`do_»ÿÎ
(
ch
->
³t
, "");

1709 
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_ARENACENTER
)));

1712 ià(
loÿtiÚ
 =ğ
nuÎ±r
) {

1713 
	`¡c
("You‡» com¶‘–y†o¡.\n", 
ch
);

1717 ià(
ch
->
š_room
 =ğ
loÿtiÚ
) {

1718 
	`¡c
("You‡»‡Ì—dyh”e.\n", 
ch
);

1722 ià((!
	`IS_IMMORTAL
(
ch
è&& ch->
š_room
->
	`æags
().
	`has
(
ROOM_NO_RECALL
)è|| 
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
cur£
)) {

1723 
	`¡c
("Unsym·th‘iøÏugh‹¸oàthGod ¶ay upÚ you¸—rs.\n", 
ch
);

1727 ià(
ch
->
fightšg
 !ğ
nuÎ±r
) {

1728 ià(
	`numb”_³rûÁ
(è< 80 * 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
»ÿÎ
) / 100) {

1729 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
»ÿÎ
, 
çl£
, 6);

1730 
	`WAIT_STATE
(
ch
, 4);

1731 
	`¡c
("ThGod ignÜyou¸ha¡y…¿y”s.\n", 
ch
);

1735 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a


1736 && 
ch
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
şª¬’a
)

1737 
lo£
 = (
ch
->
desc
 !ğ
nuÎ±r
 ? 25 : (
şª
 ? 50 : 25));

1739 
comb©
 = 
Œue
;

1740 
	`gaš_exp
(
ch
, 0 - 
lo£
);

1741 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
»ÿÎ
, 
Œue
, 4);

1742 
	`¡İ_fightšg
(
ch
, 
Œue
);

1746 ià(
	`HAS_RAFF
(
ch
, 
RAFF_BUGGYREC
è&& 
	`rŞl_chªû
(5))

1747 
loÿtiÚ
 = 
	`g‘_¿ndom_room
(
ch
);

1749 ià(!
ch
->
š_room
->
	`şª
(è|| ch->š_room->şª(è!ğch->
şª
)

1750 
ch
->
¡am
 = (ch->stam * 3) / 4;

1752 ià(
şª
)

1753 
	`aù
("$Àdi§µ—rs.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1755 
	`aù
("$Àdi§µ—r š‡ mushroom cloud.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1757 
	`ch¬_äom_room
(
ch
);

1758 
	`ch¬_to_room
(
ch
, 
loÿtiÚ
);

1759 
	`do_look
(
ch
, "auto");

1761 ià(
comb©
) {

1762 
	`±c
(
ch
, "You %sRECALL from comb©!", 
şª
 ? "CLAN" : "");

1764 ià(
lo£
è
	`±c
(
ch
, " You†ose %dƒxperience.",†ose);

1766 
	`¡c
("\n", 
ch
);

1769 ià(
şª
)

1770 
	`aù
("$À­³¬ šhroom.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1772 
	`aù
("$À¬rive äom‡ mushroom cloud.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1774 ià(
ch
->
³t
 !ğ
nuÎ±r
 && ch->³ˆ!ğch->
ma¡”
) {

1775 ià(
şª
)

1776 
	`do_şª_»ÿÎ
(
ch
->
³t
, "");

1778 
	`do_»ÿÎ
(
ch
->
³t
, "");

1780 
	}
}

1782 
	$do_Œaš
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1784 
SŒšg
 
buf
;

1785 
Ch¬aù”
 *
mob
;

1786 
¡©
 = - 1;

1787 *
pOuut
 = 
nuÎ±r
;

1788 
co¡
, 
add
;

1790 ià(
ch
->
	`is_Åc
()) {

1791 
	`¡c
("You dÚ'ˆÃedØŒaš your£lf.\n", 
ch
);

1795 ià(
ch
->
gud
 =ğ
Gud
::
nÚe
) {

1796 
	`¡c
("Još‡ gud iàyou wªˆtØŒaš your£lf.\n", 
ch
);

1803 
mob
 = 
ch
->
š_room
->
³İË
; mob; mob = mob->
Ãxt_š_room
) {

1804 ià(
mob
->
	`is_Åc
(è&& mob->
aù_æags
.
	`has
(
ACT_TRAIN
))

1808 ià(
mob
 =ğ
nuÎ±r
) {

1809 
	`¡c
("You cª'ˆdØth© h”e.\n", 
ch
);

1813 ià(
¬gum’t
.
	`em±y
()) {

1814 
FÜm©
::
	`¥rštf
(
buf
, "You hav%d¿ššg sessiÚs.\n", 
ch
->
Œaš
);

1815 
	`¡c
(
buf
, 
ch
);

1816 
¬gum’t
 = "foo";

1819 
co¡
 = 1;

1821 ià(
¬gum’t
 == "str") {

1822 ià(
gud_bË
[
ch
->
gud
].
¡©_´ime
 =ğ
STAT_STR
)

1823 
co¡
 = 1;

1825 
¡©
 = 
STAT_STR
;

1826 
pOuut
 = "strength";

1828 ià(
¬gum’t
 == "int") {

1829 ià(
gud_bË
[
ch
->
gud
].
¡©_´ime
 =ğ
STAT_INT
)

1830 
co¡
 = 1;

1832 
¡©
 = 
STAT_INT
;

1833 
pOuut
 = "intelligence";

1835 ià(
¬gum’t
 == "wis") {

1836 ià(
gud_bË
[
ch
->
gud
].
¡©_´ime
 =ğ
STAT_WIS
)

1837 
co¡
 = 1;

1839 
¡©
 = 
STAT_WIS
;

1840 
pOuut
 = "wisdom";

1842 ià(
¬gum’t
 == "dex") {

1843 ià(
gud_bË
[
ch
->
gud
].
¡©_´ime
 =ğ
STAT_DEX
)

1844 
co¡
 = 1;

1846 
¡©
 = 
STAT_DEX
;

1847 
pOuut
 = "dexterity";

1849 ià(
¬gum’t
 == "con") {

1850 ià(
gud_bË
[
ch
->
gud
].
¡©_´ime
 =ğ
STAT_CON
)

1851 
co¡
 = 1;

1853 
¡©
 = 
STAT_CON
;

1854 
pOuut
 = "constitution";

1856 ià(
¬gum’t
 == "chr") {

1857 ià(
gud_bË
[
ch
->
gud
].
¡©_´ime
 =ğ
STAT_CHR
)

1858 
co¡
 = 1;

1860 
¡©
 = 
STAT_CHR
;

1861 
pOuut
 = "charisma";

1863 ià(
¬gum’t
 == "hp")

1864 
co¡
 = 1;

1865 ià(
¬gum’t
 == "mana")

1866 
co¡
 = 1;

1867 ià(
¬gum’t
 == "stamina")

1868 
co¡
 = 1;

1870 
buf
 = "You canrain:";

1872 ià(
	`ATTR_BASE
(
ch
, 
APPLY_STR
è< 
	`g‘_max_Œaš
(ch, 
STAT_STR
))

1873 
buf
 += " str";

1875 ià(
	`ATTR_BASE
(
ch
, 
APPLY_INT
è< 
	`g‘_max_Œaš
(ch, 
STAT_INT
))

1876 
buf
 += " int";

1878 ià(
	`ATTR_BASE
(
ch
, 
APPLY_WIS
è< 
	`g‘_max_Œaš
(ch, 
STAT_WIS
))

1879 
buf
 += " wis";

1881 ià(
	`ATTR_BASE
(
ch
, 
APPLY_DEX
è< 
	`g‘_max_Œaš
(ch, 
STAT_DEX
))

1882 
buf
 += " dex";

1884 ià(
	`ATTR_BASE
(
ch
, 
APPLY_CON
è< 
	`g‘_max_Œaš
(ch, 
STAT_CON
))

1885 
buf
 += " con";

1887 ià(
	`ATTR_BASE
(
ch
, 
APPLY_CHR
è< 
	`g‘_max_Œaš
(ch, 
STAT_CHR
))

1888 
buf
 += " chr";

1890 
buf
 += " hp mana stamina.\n";

1891 
	`¡c
(
buf
, 
ch
);

1895 ià(
¬gum’t
 == "hp") {

1896 ià(
ch
->
pcd©a
->
Œašs_to_h™
 < 50è
add
 = 10;

1897 ià(
ch
->
pcd©a
->
Œašs_to_h™
 < 100è
add
 = 9;

1898 ià(
ch
->
pcd©a
->
Œašs_to_h™
 < 150è
add
 = 8;

1899 ià(
ch
->
pcd©a
->
Œašs_to_h™
 < 200è
add
 = 7;

1900 ià(
ch
->
pcd©a
->
Œašs_to_h™
 < 250è
add
 = 6;

1901 ià(
ch
->
pcd©a
->
Œašs_to_h™
 < 300è
add
 = 5;

1902 ià(
ch
->
pcd©a
->
Œašs_to_h™
 < 350è
add
 = 4;

1903 ià(
ch
->
pcd©a
->
Œašs_to_h™
 < 400è
add
 = 3;

1904 ià(
ch
->
pcd©a
->
Œašs_to_h™
 < 450è
add
 = 2;

1905 
add
 = 1;

1907 ià(
co¡
 > 
ch
->
Œaš
) {

1908 
	`¡c
("You dÚ'ˆhav’ough¿ššg sessiÚs.\n", 
ch
);

1912 
ch
->
Œaš
 -ğ
co¡
;

1913 
ch
->
pcd©a
->
Œašs_to_h™
 += 1;

1914 
	`ATTR_BASE
(
ch
, 
APPLY_HIT
è+ğ
add
;

1915 
ch
->
h™
 +ğ
add
;

1916 
	`aù
("You¸du¿b™y inü—£s!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

1917 
	`aù
("$n' du¿b™y inü—£s!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1921 ià(
¬gum’t
 == "mana") {

1922 ià(
ch
->
pcd©a
->
Œašs_to_mªa
 < 50è
add
 = 10;

1923 ià(
ch
->
pcd©a
->
Œašs_to_mªa
 < 100è
add
 = 9;

1924 ià(
ch
->
pcd©a
->
Œašs_to_mªa
 < 150è
add
 = 8;

1925 ià(
ch
->
pcd©a
->
Œašs_to_mªa
 < 200è
add
 = 7;

1926 ià(
ch
->
pcd©a
->
Œašs_to_mªa
 < 250è
add
 = 6;

1927 ià(
ch
->
pcd©a
->
Œašs_to_mªa
 < 300è
add
 = 5;

1928 ià(
ch
->
pcd©a
->
Œašs_to_mªa
 < 350è
add
 = 4;

1929 ià(
ch
->
pcd©a
->
Œašs_to_mªa
 < 400è
add
 = 3;

1930 ià(
ch
->
pcd©a
->
Œašs_to_mªa
 < 450è
add
 = 2;

1931 
add
 = 1;

1933 ià(
co¡
 > 
ch
->
Œaš
) {

1934 
	`¡c
("You dÚ'ˆhav’ough¿ššg sessiÚs.\n", 
ch
);

1938 
ch
->
Œaš
 -ğ
co¡
;

1939 
ch
->
pcd©a
->
Œašs_to_mªa
 += 1;

1940 
	`ATTR_BASE
(
ch
, 
APPLY_MANA
è+ğ
add
;

1941 
ch
->
mªa
 +ğ
add
;

1942 
	`aù
("You¸pow” inü—£s!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

1943 
	`aù
("$n' pow” inü—£s!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1947 ià(
¬gum’t
 == "stamina") {

1948 ià(
ch
->
pcd©a
->
Œašs_to_¡am
 < 50è
add
 = 10;

1949 ià(
ch
->
pcd©a
->
Œašs_to_¡am
 < 100è
add
 = 9;

1950 ià(
ch
->
pcd©a
->
Œašs_to_¡am
 < 150è
add
 = 8;

1951 ià(
ch
->
pcd©a
->
Œašs_to_¡am
 < 200è
add
 = 7;

1952 ià(
ch
->
pcd©a
->
Œašs_to_¡am
 < 250è
add
 = 6;

1953 ià(
ch
->
pcd©a
->
Œašs_to_¡am
 < 300è
add
 = 5;

1954 ià(
ch
->
pcd©a
->
Œašs_to_¡am
 < 350è
add
 = 4;

1955 ià(
ch
->
pcd©a
->
Œašs_to_¡am
 < 400è
add
 = 3;

1956 ià(
ch
->
pcd©a
->
Œašs_to_¡am
 < 450è
add
 = 2;

1957 
add
 = 1;

1959 ià(
co¡
 > 
ch
->
Œaš
) {

1960 
	`¡c
("You dÚ'ˆhav’ough¿ššg sessiÚs.\n", 
ch
);

1964 
ch
->
Œaš
 -ğ
co¡
;

1965 
ch
->
pcd©a
->
Œašs_to_¡am
 += 1;

1966 
	`ATTR_BASE
(
ch
, 
APPLY_STAM
è+ğ
add
;

1967 
ch
->
¡am
 +ğ
add
;

1968 
	`aù
("You¸’”gy inü—£s!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

1969 
	`aù
("$n' ’”gy inü—£s!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1973 ià(
	`ATTR_BASE
(
ch
, 
	`¡©_to_©Œ
(
¡©
)è>ğ
	`g‘_max_Œaš
(ch, stat)) {

1974 
	`aù
("You¸$T i ®»ady‡ˆmaximum.", 
ch
, 
nuÎ±r
, 
pOuut
, 
TO_CHAR
);

1978 ià(
co¡
 > 
ch
->
Œaš
) {

1979 
	`¡c
("You dÚ'ˆhav’ough¿ššg sessiÚs.\n", 
ch
);

1983 
ch
->
Œaš
 -ğ
co¡
;

1984 
	`ATTR_BASE
(
ch
, 
	`¡©_to_©Œ
(
¡©
)) += 1;

1985 
	`aù
("You¸$T inü—£s!", 
ch
, 
nuÎ±r
, 
pOuut
, 
TO_CHAR
);

1986 
	`aù
("$n' $T inü—£s!", 
ch
, 
nuÎ±r
, 
pOuut
, 
TO_ROOM
);

1988 
	}
}

1991 
boŞ
 
	$is_§ã_d¿g
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

1993 ià(
viùim
->
š_room
 =ğ
nuÎ±r
 || 
ch
->in_room ==‚ullptr)

1994  
Œue
;

1996 ià(
ch
->
fightšg
 || 
viùim
->fighting) {

1997 
	`¡c
("Wa™ fÜhfighˆtØfšish!\n", 
ch
);

1998  
Œue
;

2001 ià(
ch
 =ğ
viùim
) {

2002 
	`¡c
("You†ik¶ayšg w™h your£lf?\n", 
ch
);

2003  
Œue
;

2006 ià(
	`IS_IMMORTAL
(
viùim
)) {

2007 
	`¡c
("You cªnÙ dØth©ØimmÜls.\n", 
ch
);

2008  
Œue
;

2011 ià(
	`IS_IMMORTAL
(
ch
))

2012  
çl£
;

2015 ià(
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
)

2016 && (
viùim
->
	`is_Åc
(è|| viùim->
pcd©a
->
pktim”
 <= 0)) {

2017 
	`¡c
("Oddlyƒnough, iÀthi room you f“È³aûful.\n", 
ch
);

2018  
Œue
;

2021 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


2022 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
şª¬’a


2023 || 
	`ch¬_š_d¬’a_room
(
viùim
))

2024  
çl£
;

2027 ià(
Game
::
	`wÜld
().
que¡
.
pk


2028 && 
viùim
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()

2029 && 
ch
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area())

2030  
çl£
;

2032  
	`is_§ã_ch¬
(
ch
, 
viùim
, 
Œue
);

2033 
	}
}

2035 
	$do_push
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2037 
buf
[
MIL
], 
dœ_buf
[
MSL
];

2038 
Room
 *
to_room
;

2039 
Ex™
 *
³x™
;

2040 
Ch¬aù”
 *
viùim
;

2041 
dœ
;

2043 ià(
¬gum’t
.
	`em±y
()) {

2044 
	`¡c
("Whom dØyou wªˆtØpush?\n", 
ch
);

2048 
SŒšg
 
¬g
;

2049 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

2051 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

2052 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

2056 ià(
	`is_§ã_d¿g
(
ch
, 
viùim
))

2059 ià(!
	`IS_AWAKE
(
viùim
)) {

2060 
	`aù
("$N i a¦“p. Try d¿ggšg $M.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2064 ià(
	`g‘_pos™iÚ
(
viùim
è<ğ
POS_RESTING
) {

2065 
	`aù
("$N i »¡šg. Try d¿ggšg $M.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2070 ià(
¬gum’t
.
	`is_´efix_of
("nÜth")è
dœ
 = 0;

2071 ià(
¬gum’t
.
	`is_´efix_of
("—¡")è
dœ
 = 1;

2072 ià(
¬gum’t
.
	`is_´efix_of
("south")è
dœ
 = 2;

2073 ià(
¬gum’t
.
	`is_´efix_of
("we¡")è
dœ
 = 3;

2074 ià(
¬gum’t
.
	`is_´efix_of
("up")è
dœ
 = 4;

2075 ià(
¬gum’t
.
	`is_´efix_of
("down")è
dœ
 = 5;

2077 
	`¡c
("NØsuch dœeùiÚ.\n", 
ch
);

2082 ià(!
	`IS_IMMORTAL
(
ch
)) {

2083 
chªû
 = 75;

2084 
chªû
 +ğ(
	`GET_ATTR_STR
(
ch
è- GET_ATTR_STR(
viùim
)) * 5;

2085 
chªû
 = 
	`URANGE
(5, chance, 95);

2087 ià(!
	`rŞl_chªû
(
chªû
)) {

2088 
	`aù
("$ÀŒ› unsucûssfuÎyØpush $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2089 
	`aù
("$ÀŒ› tØpush you.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2090 
	`aù
("$N†ook © you w™h cÚ‹m±‡nd ignÜe you.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2092 ià(!
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
))

2093 
	`muÉi_h™
(
viùim
, 
ch
, 
skl
::
ty³
::
unknown
);

2100 ià((
³x™
 = 
ch
->
š_room
->
ex™
[
dœ
]è=ğ
nuÎ±r


2101 || (
to_room
 = 
³x™
->to_roomè=ğ
nuÎ±r


2102 || !
	`ÿn_£e_room
(
ch
, 
³x™
->
to_room
)) {

2103 
	`aù
("You shov$M u°agaš¡‡ w®Èªdh»©’ $M.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2104 
	`aù
("$Àshove you u°agaš¡‡ w®Èªdh»©’ you.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2105 
	`aù
("$Àshove $N u°agaš¡‡ w®Èªdh»©’ $M.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2109 ià(
to_room
->
	`æags
().
	`has
(
ROOM_LAW
)

2110 && (
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
ACT_AGGRESSIVE
))) {

2111 
	`¡c
("They‡»oØl-‹m³»dØhavšhc™y.\n", 
ch
);

2115 ià(!
ch
->
	`is_Åc
()

2116 && 
to_room
->
	`gud
(è!ğ
Gud
::
nÚe


2117 && 
to_room
->
	`gud
(è!ğ
viùim
->
gud
) {

2118 
	`¡c
("They‡»‚Ù‡ memb”,hey cªnÙƒÁ”.\n", 
ch
);

2123 ià(
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
)

2124 && (!
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
·ss_doÜ
)

2125 || 
³x™
->
ex™_æags
.
	`has
(
EX_NOPASS
))) {

2126 
FÜm©
::
	`¥rštf
(
buf
, "You shov$M u°agaš¡h% ªdh»©’ $M.", 
³x™
->
	`keywÜd
());

2127 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2128 
FÜm©
::
	`¥rštf
(
buf
, "$Àshove you u°agaš¡h% ªdh»©’ you.", 
³x™
->
	`keywÜd
());

2129 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2130 
FÜm©
::
	`¥rštf
(
buf
, "$Àshove $N u°agaš¡h% ªdh»©’ $M.", 
³x™
->
	`keywÜd
());

2131 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2135 ià(
to_room
->
	`is_´iv©e
()) {

2136 
	`¡c
("Th©„oom i ´iv©righˆnow.\n", 
ch
);

2140 
	`WAIT_STATE
(
ch
, 3);

2141 
FÜm©
::
	`¥rštf
(
buf
, "$Àpushe you %s!\n", 
Ex™
::
	`dœ_Çme
(
dœ
));

2142 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2143 
FÜm©
::
	`¥rštf
(
buf
, "$Àpushe $N %s!", 
Ex™
::
	`dœ_Çme
(
dœ
));

2144 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2145 
FÜm©
::
	`¥rštf
(
buf
, "You…ush $N %s.", 
Ex™
::
	`dœ_Çme
(
dœ
));

2146 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2147 
	`ch¬_äom_room
(
viùim
);

2148 
	`ch¬_to_room
(
viùim
, 
to_room
);

2150 ià(
Ex™
::
	`»v_dœ
(
dœ
) == 5)

2151 
FÜm©
::
	`¥rštf
(
dœ_buf
, "%s", "below");

2152 ià(
Ex™
::
	`»v_dœ
(
dœ
) == 4)

2153 
FÜm©
::
	`¥rštf
(
dœ_buf
, "%s", "above");

2155 
FÜm©
::
	`¥rštf
(
dœ_buf
, "th%s", 
Ex™
::
	`dœ_Çme
(
dœ
, 
Œue
));

2157 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
)

2158 && !
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
))

2159 
	`¡c
("{CYou ga¥ fÜ‡œ!{x\n", 
viùim
);

2161 ià(
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
)) {

2162 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
)) {

2163 
	`¡c
("{CYou cÚtšutØhŞd you¸b»©h...{x\n", 
viùim
);

2164 
FÜm©
::
	`¥rštf
(
buf
, "$N flßt š from %s.", 
dœ_buf
);

2165 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2168 
	`¡c
("{CYou begšØhŞd you¸b»©h.{x\n", 
viùim
);

2169 
FÜm©
::
	`¥rštf
(
buf
, "$N s·she š from %s.", 
dœ_buf
);

2170 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2173 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
aœ
) {

2174 ià(!
	`IS_FLYING
(
viùim
)

2175 && 
viùim
->
š_room
->
ex™
[
DIR_DOWN
]) {

2177 
FÜm©
::
	`¥rštf
(
buf
, "$À¡umbË štØthem±šes äom %s.", 
dœ_buf
);

2178 
	`aù
(
buf
, 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2181 ià(
	`CAN_FLY
(
viùim
))

2182 
	`do_æy
(
viùim
, "");

2184 ià(!
	`IS_FLYING
(
viùim
)) {

2185 
couÁ
 = 0;

2186 
br›f
 = 
viùim
->
comm_æags
.
	`has
(
COMM_BRIEF
);

2187 
viùim
->
comm_æags
 +ğ
COMM_BRIEF
;

2189 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
aœ


2190 && !
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
)

2191 && 
viùim
->
š_room
->
ex™
[
DIR_DOWN
]

2192 && (
to_room
 = 
viùim
->
š_room
->
ex™
[
DIR_DOWN
]->to_room)

2193 && 
couÁ
++ < 10) {

2194 
Room
 *
¬ound
, *
Şd
 = 
viùim
->
š_room
;

2195 
	`aù
("$Àsü—m ªd f®l down...", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2196 
	`do_look
(
viùim
, "auto");

2197 
	`ch¬_äom_room
(
viùim
);

2200 
dœ
 = 0; dir < 4; dir++) {

2201 ià(
Şd
->
ex™
[
dœ
] =ğ
nuÎ±r


2202 || (
¬ound
 = 
Şd
->
ex™
[
dœ
]->
to_room
è=ğ
nuÎ±r


2203 || 
¬ound
->
ex™
[
Ex™
::
	`»v_dœ
(
dœ
)] =ğ
nuÎ±r


2204 || 
¬ound
->
ex™
[
Ex™
::
	`»v_dœ
(
dœ
)]->
to_room
 !ğ
Şd
)

2207 
	`ch¬_to_room
(
viùim
, 
Şd
->
ex™
[
dœ
]->
to_room
);

2208 
FÜm©
::
	`¥rštf
(
buf
, "You hear‡ scream fromhe %s,‡s if someone were falling...",

2209 
Ex™
::
	`dœ_Çme
(
dœ
, 
Œue
));

2210 
	`aù
(
buf
, 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2211 
	`ch¬_äom_room
(
viùim
);

2214 
	`ch¬_to_room
(
viùim
, 
Şd
);

2216 ià(
couÁ
 == 1)

2217 
	`¡c
("\nYou sü—m‡ you„—lizth”i aœ und” you¸ã‘,‡nd f®Èdown!\n\n", 
viùim
);

2219 
	`¡c
("\nYou k“°çÎšg....\n\n", 
viùim
);

2221 
	`ch¬_äom_room
(
viùim
);

2222 
	`ch¬_to_room
(
viùim
, 
to_room
);

2223 
	`aù
("You hear‡ scream,‡nd†ook upo see $n hurtling in from‡bove!",

2224 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2227 ià(!
br›f
)

2228 
viùim
->
comm_æags
 -ğ
COMM_BRIEF
;

2230 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
w©”_noswim


2231 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
w©”_swim


2232 || 
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
)) {

2233 
	`¡c
("You s·sh dowÀHARD iÀthw©”. OW!!\n\n", 
viùim
);

2234 
	`aù
("$À¥ashe dowÀHARD iÀthw©”.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2236 ià(
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
))

2237 
	`¡c
("{CYou begšØhŞd you¸b»©h.{x\n", 
viùim
);

2240 
	`¡c
("Thground fš®ly b»ak you¸çÎ. OW!!\n\n", 
viùim
);

2241 
	`aù
("$Àüash†ªd HARD oÀthground.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2246 
FÜm©
::
	`¥rštf
(
buf
, "$Àæßt š from %s.", 
dœ_buf
);

2247 
	`aù
(
buf
, 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2251 
FÜm©
::
	`¥rštf
(
buf
, "$Ài ¡umbË š from %s.", 
dœ_buf
);

2252 
	`aù
(
buf
, 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2255 
	`do_look
(
viùim
, "auto");

2256 
	`m´og_’Œy_Œigg”
(
viùim
);

2258 ià(
viùim
->
	`is_g¬bage
())

2259 
	`m´og_g»‘_Œigg”
(
viùim
);

2260 
	}
}

2262 
	$do_d¿g
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2264 
buf
[
MIL
], 
dœ_buf
[
MSL
];

2265 
Room
 *
to_room
, *
äom_room
;

2266 
Ex™
 *
³x™
;

2267 
Ch¬aù”
 *
viùim
;

2268 
dœ
;

2270 ià(
¬gum’t
.
	`em±y
()) {

2271 
	`¡c
("Whom dØyou wªˆtØd¿g?\n", 
ch
);

2275 
SŒšg
 
¬g
;

2276 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

2278 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

2279 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

2283 ià(
	`is_§ã_d¿g
(
ch
, 
viùim
))

2286 ià(
	`g‘_pos™iÚ
(
viùim
è> 
POS_RESTING
) {

2287 
	`aù
("$N i ¡ªdšg. Try…ushšg $M.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2291 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
)

2292 && 
ch
->
ma¡”
 !ğ
nuÎ±r


2293 && 
viùim
->
š_room
 =ğ
ch
->
ma¡”
->in_room) {

2294 
	`¡c
("Wh©? And†—vyou¸b–oved ma¡”?\n", 
ch
);

2299 ià(
¬gum’t
.
	`is_´efix_of
("nÜth")è
dœ
 = 0;

2300 ià(
¬gum’t
.
	`is_´efix_of
("—¡")è
dœ
 = 1;

2301 ià(
¬gum’t
.
	`is_´efix_of
("south")è
dœ
 = 2;

2302 ià(
¬gum’t
.
	`is_´efix_of
("we¡")è
dœ
 = 3;

2303 ià(
¬gum’t
.
	`is_´efix_of
("up")è
dœ
 = 4;

2304 ià(
¬gum’t
.
	`is_´efix_of
("down")è
dœ
 = 5;

2306 
	`¡c
("NØsuch dœeùiÚ.\n", 
ch
);

2311 ià(!
	`IS_IMMORTAL
(
ch
)) {

2312 
chªû
 = 
	`GET_ATTR_STR
(
ch
) * 4;

2313 
chªû
 -ğ(
viùim
->
size
 - 
ch
->size) * 30;

2314 
chªû
 -ğ
	`g‘_ÿ¼y_weight
(
viùim
) / 60;

2316 
chªû
 = 
	`URANGE
(0, chance, 95);

2318 ià(!
	`rŞl_chªû
(
chªû
)) {

2319 
	`aù
("You sŒaš you¸musşes, buˆçØmov$N!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2320 
	`aù
("$À¡¿š $ musşes, buˆÿn'ˆ£emØd¿g $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2322 ià(
	`IS_AWAKE
(
viùim
)) {

2323 
	`aù
("$ÀŒ› tØd¿g you, buˆi nÙ sŒÚgƒnough.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2325 ià(!
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
))

2326 
	`muÉi_h™
(
viùim
, 
ch
, 
skl
::
ty³
::
unknown
);

2334 ià((
³x™
 = 
ch
->
š_room
->
ex™
[
dœ
]è=ğ
nuÎ±r


2335 || (
to_room
 = 
³x™
->to_roomè=ğ
nuÎ±r


2336 || !
	`ÿn_£e_room
(
ch
, 
³x™
->
to_room
)) {

2337 
	`aù
("You d¿g $M‡roundhroom.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2338 
	`aù
("$Àd¿g $N‡roundhroom!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2340 ià(
	`IS_AWAKE
(
viùim
))

2341 
	`aù
("$Àd¿g you‡roundhroom!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2343 
	`¡c
("You havnightm¬e abouˆyou¸h—d bešg sÏmmed iÁØ¨w®l.\n", 
viùim
);

2348 ià(
to_room
->
	`is_´iv©e
()) {

2349 
	`¡c
("SÜry,h©„oom i ´iv©e.\n", 
ch
);

2353 ià(
to_room
->
	`gud
(è!ğ
Gud
::
nÚe
) {

2354 
	`¡c
("You cªnÙ d¿g…eİË iÁØ¨gud„oom.\n", 
ch
);

2358 ià(
to_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
aœ


2359 && !
	`IS_FLYING
(
ch
)

2360 && !
	`IS_IMMORTAL
(
ch
)) {

2361 ià(
	`CAN_FLY
(
ch
))

2362 
	`do_æy
(
ch
, "");

2364 
	`¡c
("You cªnÙ fly!\n", 
ch
);

2366 ià(!
	`IS_FLYING
(
ch
))

2370 ià(
to_room
->
	`æags
().
	`has
(
ROOM_LAW
)) {

2371 ià(
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
ACT_AGGRESSIVE
)) {

2372 
	`¡c
("They dÚ'ˆwªˆyou¸'ty³' iÀth”e.\n", 
ch
);

2376 ià(
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
ACT_AGGRESSIVE
)) {

2377 
	`¡c
("They‡»oØl-‹m³»dØhavšhc™y.\n", 
ch
);

2382 
äom_room
 = 
ch
->
š_room
;

2384 cÚ¡‡uto& 
loss_’Œy1
 = 
¡amša_loss
.
	`fšd
(
äom_room
->
	`£ùÜ_ty³
());

2385 cÚ¡‡uto& 
loss_’Œy2
 = 
¡amša_loss
.
	`fšd
(
to_room
->
	`£ùÜ_ty³
());

2386 
co¡
 = (
loss_’Œy1
 =ğ
¡amša_loss
.
	`ûnd
(è? 0 :†oss_’Œy1->
£cÚd
)

2387 + (
loss_’Œy2
 =ğ
¡amša_loss
.
	`ûnd
(è? 0 :†oss_’Œy2->
£cÚd
);

2390 ià(
	`IS_FLYING
(
ch
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
ha¡e
))

2391 
co¡
 /= 2;

2393 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
))

2394 
co¡
 *= 2;

2397 ià(
	`HAS_RAFF
(
ch
, 
RAFF_LIGHTFEET
))

2398 
co¡
 /= 2;

2400 ià(
ch
->
¡am
 < 
co¡
) {

2401 
	`¡c
("You‡»oØexhau¡ed fÜh©.\n", 
ch
);

2405 
ch
->
¡am
 -ğ
co¡
;

2407 ià(!
	`IS_AWAKE
(
viùim
))

2408 
	`¡c
("You d»am‡bouˆrugbuºs.\n", 
viùim
);

2411 ià(
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
)) {

2412 ià(!
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
·ss_doÜ
)

2413 || 
³x™
->
ex™_æags
.
	`has
(
EX_NOPASS
)) {

2414 
	`±c
(
ch
, "You back iÁØth%s.\n", 
³x™
->
	`keywÜd
());

2415 
FÜm©
::
	`¥rštf
(
buf
, "$ÀŒ› tØd¿g $N, buˆback štØth%s.", 
³x™
->
	`keywÜd
());

2416 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2418 ià(
	`IS_AWAKE
(
viùim
)) {

2419 
FÜm©
::
	`¥rštf
(
buf
, "$ÀŒ› tØd¿g you, buˆback štØth%s.", 
³x™
->
	`keywÜd
());

2420 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2426 ià(!
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
·ss_doÜ
)

2427 || 
³x™
->
ex™_æags
.
	`has
(
EX_NOPASS
)) {

2428 
	`±c
(
ch
, "YouryØd¿ghemhroughh%s, buˆthey‡»oØsŞid.\n", 
³x™
->
	`keywÜd
());

2429 
FÜm©
::
	`¥rštf
(
buf
, "$ÀŒ› tØd¿g $N, buˆ$E bªg agaš¡h%s.", 
³x™
->
	`keywÜd
());

2430 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2432 ià(
	`IS_AWAKE
(
viùim
)) {

2433 
FÜm©
::
	`¥rštf
(
buf
, "$ÀŒ› tØd¿g you, buˆyou‡»oØsŞidØ·s throughh%s.", 
³x™
->
	`keywÜd
());

2434 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2437 
	`¡c
("You havnightm¬e abouˆyou¸h—d bªgšg‡gaš¡ w®ls.\n", 
viùim
);

2443 ià(
to_room
->
	`is_´iv©e
()) {

2444 
	`¡c
("Th©„oom i ´iv©righˆnow.\n", 
ch
);

2448 
	`WAIT_STATE
(
ch
, 3);

2450 
FÜm©
::
	`¥rštf
(
buf
, "$Àd¿g you %s!", 
Ex™
::
	`dœ_Çme
(
dœ
));

2451 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2452 
FÜm©
::
	`¥rštf
(
buf
, "$Àd¿g $N %s!", 
Ex™
::
	`dœ_Çme
(
dœ
));

2453 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2454 
FÜm©
::
	`¥rštf
(
buf
, "You d¿g $N %s.", 
Ex™
::
	`dœ_Çme
(
dœ
));

2455 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2456 
	`ch¬_äom_room
(
viùim
);

2457 
	`ch¬_äom_room
(
ch
);

2458 
	`ch¬_to_room
(
viùim
, 
to_room
);

2459 
	`ch¬_to_room
(
ch
, 
to_room
);

2461 ià(
Ex™
::
	`»v_dœ
(
dœ
) == 5)

2462 
FÜm©
::
	`¥rštf
(
dœ_buf
, "%s", "below");

2463 ià(
Ex™
::
	`»v_dœ
(
dœ
) == 4)

2464 
FÜm©
::
	`¥rštf
(
dœ_buf
, "%s", "above");

2466 
FÜm©
::
	`¥rštf
(
dœ_buf
, "th%s", 
Ex™
::
	`dœ_Çme
(
dœ
, 
Œue
));

2468 ià(
äom_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
)

2469 && !
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
)) {

2470 
	`aù
("{CYou ga¥ fÜ‡œ!{x\n", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2471 
	`aù
("{CYou ga¥ fÜ‡œ!{x\n", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2474 ià(
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
)) {

2475 ià(
äom_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
)) {

2476 
	`¡c
("{CYou cÚtšutØhŞd you¸b»©h...{x\n", 
ch
);

2477 
	`aù
("{CYou cÚtšutØhŞd you¸b»©h...{x", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

2478 
FÜm©
::
	`¥rštf
(
buf
, "$Àswim š from %s, d¿ggšg $N behšd.", 
dœ_buf
);

2479 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2482 
	`¡c
("{CYou begšØhŞd you¸b»©h.{x\n", 
ch
);

2483 
FÜm©
::
	`¥rštf
(
buf
, "$À¥ashe š from %s, d¿ggšg $N behšd.", 
dœ_buf
);

2484 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2486 ià(!
	`IS_AWAKE
(
viùim
)) {

2487 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
¦“p
)) {

2488 ià(
	`rŞl_chªû
(40)) {

2489 
afãù
::
	`»move_ty³_äom_ch¬
(
viùim
,‡fãù::
ty³
::
¦“p
);

2490 
viùim
->
pos™iÚ
 = 
POS_STANDING
;

2494 
viùim
->
pos™iÚ
 = 
POS_STANDING
;

2497 
	`aù
("A coŞ„ush oàw©”‡wak’ you. You‡» und”w©”!\n", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

2498 
	`aù
("$Àwake © bešg d¿gged iÁØthw©”.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2501 
	`aù
("{CYou begšØhŞd you¸b»©h.{x", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

2504 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
aœ
) {

2505 ià(!
	`IS_FLYING
(
viùim
)

2506 && 
viùim
->
š_room
->
ex™
[
DIR_DOWN
]) {

2508 
FÜm©
::
	`¥rštf
(
buf
, "$Àd¿g $N iÁØthem±šes äom %s.", 
dœ_buf
);

2509 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2511 ià(
	`CAN_FLY
(
viùim
)

2512 && 
	`IS_AWAKE
(
viùim
))

2513 
	`do_æy
(
viùim
, "");

2515 ià(!
	`IS_FLYING
(
viùim
)) {

2516 
couÁ
 = 0;

2517 
br›f
 = 
viùim
->
comm_æags
.
	`has
(
COMM_BRIEF
);

2518 
viùim
->
comm_æags
 +ğ
COMM_BRIEF
;

2520 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
aœ


2521 && !
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
)

2522 && 
viùim
->
š_room
->
ex™
[
DIR_DOWN
]

2523 && (
to_room
 = 
viùim
->
š_room
->
ex™
[
DIR_DOWN
]->to_room)

2524 && 
couÁ
++ < 10) {

2525 ià(
	`IS_AWAKE
(
viùim
)) {

2526 
Room
 *
¬ound
, *
Şd
 = 
viùim
->
š_room
;

2527 
	`aù
("$Àsü—m ªd f®l down...", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2528 
	`do_look
(
viùim
, "auto");

2529 
	`ch¬_äom_room
(
viùim
);

2532 
dœ
 = 0; dir < 4; dir++) {

2533 ià(
Şd
->
ex™
[
dœ
] =ğ
nuÎ±r


2534 || (
¬ound
 = 
Şd
->
ex™
[
dœ
]->
to_room
è=ğ
nuÎ±r


2535 || 
¬ound
->
ex™
[
Ex™
::
	`»v_dœ
(
dœ
)] =ğ
nuÎ±r


2536 || 
¬ound
->
ex™
[
Ex™
::
	`»v_dœ
(
dœ
)]->
to_room
 !ğ
Şd
)

2539 
	`ch¬_to_room
(
viùim
, 
Şd
->
ex™
[
dœ
]->
to_room
);

2540 
FÜm©
::
	`¥rštf
(
buf
, "You hear‡ scream fromhe %s,‡s if someone were falling...",

2541 
Ex™
::
	`dœ_Çme
(
dœ
, 
Œue
));

2542 
	`aù
(
buf
, 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2543 
	`ch¬_äom_room
(
viùim
);

2546 
	`ch¬_to_room
(
viùim
, 
Şd
);

2548 ià(
couÁ
 == 1)

2549 
	`¡c
("\nYou sü—m‡ you„—lizth”i aœ und” you¸ã‘,‡nd f®Èdown!\n\n", 
viùim
);

2551 
	`¡c
("\nYou k“°çÎšg....\n\n", 
viùim
);

2554 
	`aù
("$N f®l down...", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2556 ià(
couÁ
 == 1)

2557 
	`¡c
("You havª un£‰lšg d»am‡bouˆçÎšg...\n", 
viùim
);

2560 
to_room
 = 
viùim
->
š_room
->
ex™
[
DIR_DOWN
]->to_room;

2561 
	`ch¬_äom_room
(
viùim
);

2562 
	`ch¬_to_room
(
viùim
, 
to_room
);

2564 ià(
	`IS_AWAKE
(
viùim
))

2565 
	`aù
("You hear‡ scream,‡nd†ook upo see $n hurtling in from‡bove!",

2566 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2568 
	`aù
("$ÀçÎ š from‡bove.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2571 ià(!
br›f
)

2572 
viùim
->
comm_æags
 -ğ
COMM_BRIEF
;

2574 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
w©”_noswim


2575 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
w©”_swim


2576 || 
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
)) {

2577 ià(
	`IS_AWAKE
(
viùim
))

2578 
	`¡c
("You s·sh dowÀHARD iÀthw©”. OW!!\n\n", 
viùim
);

2580 
	`¡c
("You‡»‡wak’ed by‡ mšd‚umbšg sÏ°oàw©”‡ you s¶ash down!\n\n", 
viùim
);

2582 
	`aù
("$À¥ashe dowÀHARD iÀthw©”.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2585 ià(
	`IS_AWAKE
(
viùim
))

2586 
	`¡c
("Thground fš®ly b»ak you¸çÎ. OW!!\n\n", 
viùim
);

2588 
	`¡c
("You‡»‡wak’ed‡ you c¿sh HARD iÁØthground!\n\n", 
viùim
);

2590 
	`aù
("$Àüash†ªd HARD oÀthground.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2593 
afãù
::
	`»move_ty³_äom_ch¬
(
viùim
,‡fãù::
ty³
::
¦“p
);

2594 
viùim
->
pos™iÚ
 = 
POS_STANDING
;

2598 
FÜm©
::
	`¥rštf
(
buf
, "$Àæ› š from %s, d¿ggšg $N behšd.", 
dœ_buf
);

2599 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2603 
FÜm©
::
	`¥rštf
(
buf
, "$Àd¿g $N iÀäom %s.", 
dœ_buf
);

2604 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

2607 ià(
	`IS_AWAKE
(
viùim
))

2608 
	`do_look
(
viùim
, "auto");

2610 
	`do_look
(
ch
, "auto");

2612 
	`m´og_’Œy_Œigg”
(
ch
);

2614 ià(!
ch
->
	`is_g¬bage
())

2615 
	`m´og_g»‘_Œigg”
(
ch
);

2617 
	`m´og_’Œy_Œigg”
(
viùim
);

2619 ià(!
viùim
->
	`is_g¬bage
())

2620 
	`m´og_g»‘_Œigg”
(
viùim
);

2621 
	}
}

2624 
	$do_m¬k
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2626 ià(
ch
->
	`is_Åc
()) {

2627 
	`¡c
("You f“ÈsØ© homh”e,h”i nØÃedØMARK.\n", 
ch
);

2631 ià(!
	`CAN_USE_RSKILL
(
ch
, 
skl
::
ty³
::
m¬k
)) {

2632 
	`¡c
("Huh?\n", 
ch
);

2636 ià(
ch
->
š_room
 =ğ
nuÎ±r
) {

2637 
	`¡c
("You‡»†o¡! You would‚Ù wªˆtØ»tuº h”e.\n", 
ch
);

2641 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


2642 || 
ch
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()

2643 || (
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_GODS_ONLY
è&& !
	`IS_IMMORTAL
(ch))

2644 || 
	`ch¬_š_du–_room
(
ch
)) {

2645 
	`¡c
("Acûs tØthi room mu¡ bgašed‡Ãwƒachime!\n", 
ch
);

2649 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
m¬k
))

2652 
ch
->
pcd©a
->
m¬k_room
 = ch->
š_room
->
loÿtiÚ
;

2653 
	`¡c
("You m¬khi loÿtiÚ. RELOCATE wÈg‘ you back h”e.\n", 
ch
);

2654 
	}
}

2657 
	$do_»loÿ‹
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2659 
Room
 *
rg‘_room
;

2661 ià(
ch
->
	`is_Åc
()) {

2662 
	`¡c
("It' ¨niû day out, you would„©h” w®k.\n", 
ch
);

2666 ià(!
	`CAN_USE_RSKILL
(
ch
, 
skl
::
ty³
::
m¬k
)) {

2667 
	`¡c
("Huh?\n", 
ch
);

2671 ià(!
ch
->
pcd©a
->
m¬k_room
.
	`is_v®id
()) {

2672 
	`¡c
("You dØnÙ„ememb” m¬kšg‡ny„oom.\n", 
ch
);

2676 
rg‘_room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
pcd©a
->
m¬k_room
);

2678 ià(
rg‘_room
 =ğ
nuÎ±r
) {

2679 
	`¡c
("Thway backØthroom you m¬ked ha b“Àlo¡.\n", 
ch
);

2684 ià(
ch
->
š_room
->
loÿtiÚ
 =ğ
	`LoÿtiÚ
(
	`Vnum
(1212))) {

2685 
	`¡c
("You cªnÙ„–oÿ‹ ouˆoàthi room.\n", 
ch
);

2689 ià(
ch
->
fightšg
) {

2690 
	`¡c
("You cªnÙ„–oÿ‹ ouˆoàcomb©.\n", 
ch
);

2694 ià(
	`ch¬_š_du–_room
(
ch
)) {

2695 
	`¡c
("You cªnÙ„–oÿ‹ fromhdu–‡»Ç.\n", 
ch
);

2699 ià(
ch
->
pcd©a
->
pktim”
) {

2700 
	`¡c
("You cªnÙ„–oÿ‹ sØsoÚ‡á” comb©.\n", 
ch
);

2704 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
m¬k
))

2707 ià(
	`numb”_³rûÁ
(è> 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
m¬k
)) {

2708 
	`¡c
("You faØ»loÿ‹.\n", 
ch
);

2709 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
m¬k
, 
çl£
, 4);

2713 ià((
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
)

2714 || (
ch
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area())) {

2715 
	`¡c
("You‡»n'ˆg‘tšg ouˆoàh”th©ƒasy!\n", 
ch
);

2719 ià(
ch
->
š_room
 =ğ
rg‘_room
) {

2720 
	`¡c
("NÙicšg you‡»‡Ì—dyh”e, you dÚ'ˆbÙh”.\n", 
ch
);

2724 ià(
ch
->
š_room
 !ğ
nuÎ±r
) {

2725 
	`aù
("$Àdi§µ—r š‡ fÏsh oàblšdšg†ight.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2726 
	`ch¬_äom_room
(
ch
);

2729 
	`ch¬_to_room
(
ch
, 
rg‘_room
);

2730 
	`aù
("$À­³¬ š‡…ufàoàsmoke.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2731 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
m¬k
, 
Œue
, 4);

2732 
	`do_look
(
ch
, "auto");

2733 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
m¬k
).
b—ts
);

2734 
	}
}

2736 cÚ¡ 
SŒšg
 
	$g‘_w¬p_loc_¡ršg
(cÚ¡ 
Objeù
 *
obj
) {

2737 ià(!
obj
 || obj->
™em_ty³
 !ğ
ITEM_WARP_CRYSTAL
)

2740 cÚ¡ 
ExŒaDesü
 *
ed
 = 
	`g‘_exŒa_desü
("w¬p_loc", 
obj
->
exŒa_desü
);

2742 ià(!
ed
 && 
obj
->
pIndexD©a
)

2743 
ed
 = 
	`g‘_exŒa_desü
("w¬p_loc", 
obj
->
pIndexD©a
->
exŒa_desü
);

2745 ià(
ed
)

2746  
ed
->
desütiÚ
;

2749 
	}
}

2752 cÚ¡ 
Objeù
 *
	$g‘_w¬p_üy¡®
(cÚ¡ 
SŒšg
& 
¡r
) {

2753 
Objeù
 *
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj; obj = obj->
Ãxt
)

2754 ià(
	`g‘_w¬p_loc_¡ršg
(
obj
).
	`uncŞÜ
(è=ğ
¡r
.uncolor())

2755  
obj
;

2757  
nuÎ±r
;

2758 
	}
}

2760 
	$do_w¬p
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2762 
SŒšg
 
¬g
;

2763 
boŞ
 
fÜg‘
 = 
çl£
;

2764 
Room
 *
rg‘_room
;

2766 ià(
ch
->
	`is_Åc
()) {

2767 
	`¡c
("It' ¨niû day out, you would„©h” w®k.\n", 
ch
);

2771 ià(
¬gum’t
.
	`l¥l™
() == "forget") {

2772 
fÜg‘
 = 
Œue
;

2773 
¬gum’t
 =‡rgum’t.
	`l¥l™
(
¬g
).
	`¡r
();

2774 
¬g
.
	`ş—r
();

2777 ià(
¬gum’t
.
	`em±y
()) {

2778 ià(
ch
->
pcd©a
->
w¬p_locs
.
	`em±y
()) {

2779 
	`¡c
("Onû you havtouched‡À«th”y‹ cry¡®, you wÈbabËØw¬°tØ™.\n", 
ch
);

2783 ià(
fÜg‘
)

2784 
	`¡c
("Which cry¡® dØyou wªˆtØfÜg‘?\n", 
ch
);

2786 
	`¡c
("You havtouched‡‘h”y‹ cry¡® š:\n", 
ch
);

2787 
couÁ
 = 1;

2788 
max_couÁ
 = 
ch
->
pcd©a
->
w¬p_locs
.
	`size
();

2789 
numb”_¥aû
 = 
	`log10
(
max_couÁ
) + 1;

2790 
¡ršg_¥aû
 = 0;

2792 cÚ¡ 
SŒšg
& 
¡r
: 
ch
->
pcd©a
->
w¬p_locs
)

2793 ià(
¡r
.
	`Ëngth
(è> 
¡ršg_¥aû
)

2794 
¡ršg_¥aû
 = 
¡r
.
	`Ëngth
();

2796 
cŞumns
 = 
¡d
::
	`max
(1, 90 / (2 + ()
numb”_¥aû
 + 2 + ()
¡ršg_¥aû
));

2798 cÚ¡ 
SŒšg
& 
¡r
: 
ch
->
pcd©a
->
w¬p_locs
) {

2799 
	`±c
(
ch
, " %*dè%s", 
numb”_¥aû
, 
couÁ
++, 
¡r
);

2801 
i
 = 
¡r
.
	`Ëngth
(); i < 
¡ršg_¥aû
; i++)

2802 
	`±c
(
ch
, " ");

2804 ià((
couÁ
-1è% 
cŞumns
 == 0)

2805 
	`±c
(
ch
, "\n");

2808 
	`±c
(
ch
, "\n");

2813 
SŒšg
 
rg‘_loc
;

2814 
numb”
;

2816 ià(
¬gum’t
.
	`is_numb”
())

2817 
numb”
 = 
	`©oi
(
¬gum’t
);

2819 
numb”
 = 
	`numb”_¬gum’t
(
¬gum’t
, 
¬g
);

2821 cÚ¡ 
SŒšg
& 
¡r
: 
ch
->
pcd©a
->
w¬p_locs
)

2822 ià(
¬g
.
	`em±y
(è|| 
¡r
.
	`uncŞÜ
().
	`has_wÜds
(arg))

2823 ià(--
numb”
 == 0)

2824 
rg‘_loc
 = 
¡r
;

2826 ià(
rg‘_loc
.
	`em±y
()) {

2827 
	`¡c
("You havÃv” b“Àªywh”likth©.\n", 
ch
);

2828 
	`do_w¬p
(
ch
, "");

2832 ià(
fÜg‘
) {

2833 autØ
™
 = 
ch
->
pcd©a
->
w¬p_locs
.
	`begš
(); iˆ!ğch->pcd©a->w¬p_locs.
	`’d
(); it++)

2834 ià(*
™
 =ğ
rg‘_loc
) {

2835 
ch
->
pcd©a
->
w¬p_locs
.
	`”a£
(
™
);

2839 
	`±c
(
ch
, "You f“ÈËs ©tuÃdØthüy¡® iÀ%s.\n", 
rg‘_loc
);

2843 cÚ¡ 
Objeù
 *
üy¡®
 = 
	`g‘_w¬p_üy¡®
(
rg‘_loc
);

2845 ià(!
üy¡®
 || !üy¡®->
š_room
) {

2846 
	`¡c
("SŒªge, you dÚ'ˆ£emØbabËØŒav–h”righˆnow.\n", 
ch
);

2847 
Loggšg
::
	`bugf
("w¬°loÿtiÚ '%s' dÛ¢'ˆm©ch‡ cry¡®", 
rg‘_loc
);

2851 
rg‘_room
 = 
üy¡®
->
š_room
;

2854 ià(
ch
->
š_room
->
loÿtiÚ
 =ğ
	`LoÿtiÚ
(
	`Vnum
(1212))) {

2855 
	`¡c
("You cªnÙ w¬°ouˆoàthi room.\n", 
ch
);

2859 ià(
ch
->
fightšg
) {

2860 
	`¡c
("You cªnÙ w¬°ouˆoàcomb©.\n", 
ch
);

2864 ià(
	`ch¬_š_du–_room
(
ch
)) {

2865 
	`¡c
("You cªnÙ w¬°äomhdu–‡»Ç.\n", 
ch
);

2869 ià(
ch
->
pcd©a
->
pktim”
) {

2870 
	`¡c
("You cªnÙ w¬°sØsoÚ‡á” comb©.\n", 
ch
);

2874 ià((
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
)

2875 || (
ch
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area())) {

2876 
	`¡c
("You‡»n'ˆg‘tšg ouˆoàh”th©ƒasy!\n", 
ch
);

2880 ià((!
	`IS_IMMORTAL
(
ch
è&& ch->
š_room
->
	`æags
().
	`has
(
ROOM_NO_RECALL
)è|| 
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
cur£
)) {

2881 
	`¡c
("Unsym·th‘iøÏugh‹¸oàthGod ¶ay upÚ you¸—rs.\n", 
ch
);

2885 ià(
ch
->
š_room
 =ğ
rg‘_room
) {

2886 
	`¡c
("NÙicšg you‡»‡Ì—dyh”e, you dÚ'ˆbÙh”.\n", 
ch
);

2890 ià(
ch
->
š_room
 !ğ
nuÎ±r
) {

2891 
	`aù
("$Àdi§µ—r š‡ fÏsh oàblšdšg†ight.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2892 
	`ch¬_äom_room
(
ch
);

2895 
	`ch¬_to_room
(
ch
, 
rg‘_room
);

2896 
	`aù
("$À­³¬ š fÏsh oàblšdšg†ight.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2897 
	`do_look
(
ch
, "auto");

2898 
	}
}

2901 
Room
 *
	$g‘_¿ndom_room
(
Ch¬aù”
 *
ch
)

2903 
pick
 = 0, 
·ss
 = 1;

2905 
·ss
 <= 2) {

2906 
couÁ
 = 0;

2908 auto& 
¬—_·œ
 : 
Game
::
	`wÜld
().
¬—s
) {

2909 auto& 
’Œy
 : 
¬—_·œ
.
£cÚd
->
rooms
) {

2911 
Room
 *
room
 = 
’Œy
.
£cÚd
;

2913 ià(
room
 =ğ
nuÎ±r


2914 || !
	`ÿn_£e_room
(
ch
, 
room
)

2915 || 
room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()

2916 || 
room
->
	`şª
()

2917 || 
room
->
	`gud
(è!ğ
Gud
::
nÚe


2918 || 
room
->
	`¬—
().
Çme
 == "Playpen"

2919 || 
room
->
	`¬—
().
Çme
 == "IMM-Zone"

2920 || 
room
->
	`¬—
().
Çme
 == "Limbo"

2921 || 
room
->
	`¬—
().
Çme
 == "Eilyndrae"

2922 || 
room
->
	`¬—
().
Çme
 == "Torayna Cri"

2923 || 
room
->
	`¬—
().
Çme
 == "The Abyss"

2924 || 
room
->
	`æags
().
	`has_ªy_of
(
ROOM_PRIVATE
 | 
ROOM_SOLITARY
)

2925 || (
ch
->
	`is_Åc
(è&& 
room
->
	`æags
().
	`has
(
ROOM_LAW
è&& ch->
aù_æags
.has(
ACT_AGGRESSIVE
))

2926 || 
room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
)

2930 
Room
 *
´ev
;

2931 ià((
´ev
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
room
->
´ÙÙy³
.
vnum
.
	`v®ue
(è- 1)))è!ğ
nuÎ±r
)

2932 ià(
´ev
->
	`æags
().
	`has
(
ROOM_PET_SHOP
))

2935 ià(
·ss
 =ğ2 && 
couÁ
 =ğ
pick
)

2936  
room
;

2938 
couÁ
++;

2942 ià(
·ss
++ =ğ2 || 
couÁ
 == 0)

2945 
pick
 = 
	`numb”_¿nge
(0, 
couÁ
-1);

2948  
nuÎ±r
;

2949 
	}
}

2951 
	$do_’‹r
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2953 
Room
 *
loÿtiÚ
;

2956 ià(!
¬gum’t
.
	`em±y
()) {

2957 
Room
 *
Şd_room
;

2958 
Objeù
 *
pÜl
;

2959 
Ch¬aù”
 *
fch
, *
fch_Ãxt
;

2960 
boŞ
 
fightšg
 = 
çl£
;

2961 
dex
, 
chªû
, 
tİp
 = 0;

2962 
Şd_room
 = 
ch
->
š_room
;

2964 ià((
pÜl
 = 
	`g‘_obj_li¡
(
ch
, 
¬gum’t
, ch->
š_room
->
cÚ‹Ás
)è=ğ
nuÎ±r
) {

2965 
	`¡c
("You dÚ'ˆ£th© h”e.\n", 
ch
);

2969 ià(
pÜl
->
™em_ty³
 !ğ
ITEM_PORTAL
 || (pÜl->
v®ue
[1].
	`æags
().
	`has
(
EX_CLOSED
è&& !
	`IS_IMMORTAL
(
ch
))) {

2970 
	`¡c
("You dÚ'ˆ£ªy sÜˆoà’Œªû...\n", 
ch
);

2974 ià(!
	`IS_IMMORTAL
(
ch
)) {

2975 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
 || 
	`ch¬_š_du–_room
(ch)) {

2976 
	`¡c
("Thgod hav»¡riùedhu£ oàpÜl šh¬’a.\n", 
ch
);

2982 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_NOPORTAL
)

2983 || (
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_NO_RECALL
è&& 
	`CAN_WEAR
(
pÜl
, 
ITEM_TAKE
))) {

2984 
	`¡c
("ThLÜd oàEv ha d’›d you‡cûs tØyou¸pÜl...muahahaha...\n", 
ch
);

2988 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
cur£
)

2989 && (
pÜl
->
v®ue
[2].
	`æags
().
	`has
(
GATE_NOCURSE
è|| 
	`CAN_WEAR
ÕÜl, 
ITEM_TAKE
))) {

2990 
	`¡c
("You s‹°through‡nd‡» s·ˆviŞ’y back out. Hmmm..\n", 
ch
);

2995 ià(
pÜl
->
v®ue
[2].
	`æags
().
	`has
(
GATE_RANDOM
) ||…ortal->value[3] == -1) {

2996 
loÿtiÚ
 = 
	`g‘_¿ndom_room
(
ch
);

2997 
pÜl
->
v®ue
[3] = 
loÿtiÚ
->loÿtiÚ.
	`to_št
();

2999 ià(
pÜl
->
v®ue
[2].
	`æags
().
	`has
(
GATE_BUGGY
è&& (
	`numb”_³rûÁ
() < 5))

3000 
loÿtiÚ
 = 
	`g‘_¿ndom_room
(
ch
);

3002 
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(()
pÜl
->
v®ue
[3]));

3004 ià(
loÿtiÚ
 =ğ
nuÎ±r


3005 || 
loÿtiÚ
 =ğ
Şd_room


3006 || !
	`ÿn_£e_room
(
ch
, 
loÿtiÚ
)

3007 || (
loÿtiÚ
->
	`is_´iv©e
(è&& !
	`IS_IMP
(
ch
))) {

3008 
	`aù
("$°İ’ štØ¨sŞid†ookšg brick w®l.", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_CHAR
);

3012 ià(
ch
->
	`is_Åc
(è&& 
loÿtiÚ
->
	`æags
().
	`has
(
ROOM_LAW
è&& ch->
aù_æags
.has(
ACT_AGGRESSIVE
)) {

3013 
	`¡c
("A soÚ‡ youƒÁ”, you‡» s·ˆviŞ’y ouˆagaš.\n", 
ch
);

3017 ià(
ch
->
fightšg
) {

3018 ià(
	`CAN_WEAR
(
pÜl
, 
ITEM_TAKE
)) {

3019 
	`¡c
("ThLÜd oàEv ha d’›d you‡cûs tØyou¸pÜl...muahahaha...\n", 
ch
);

3024 
dex
 = 
	`GET_ATTR_DEX
(
ch
);

3025 
chªû
 = (
dex
 - 9) * 6;

3027 
fch
 = 
ch
->
š_room
->
³İË
; fch !ğ
nuÎ±r
; fch = fch->
Ãxt_š_room
) {

3028 ià(
fch
->
fightšg
 !ğ
ch
)

3031 
chªû
 +ğ(
dex
 - 
	`GET_ATTR_DEX
(
fch
)) * 5;

3033 ià(
tİp
)

3034 
chªû
 -= 10;

3036 
tİp
++;

3039 
chªû
 = 
	`URANGE
(10, chance, 90);

3040 
	`WAIT_STATE
(
ch
, 
PULSE_VIOLENCE
);

3042 ià(!
	`rŞl_chªû
(
chªû
)) {

3043 
	`¡c
("You cª'ˆg‘ clo£ƒnoughØjum°š!\n", 
ch
);

3047 
fightšg
 = 
Œue
;

3048 
	`¡İ_fightšg
(
ch
, 
Œue
);

3049 
	`aù
("$Àjump štØ$p!", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_ROOM
);

3052 
	`aù
("$À¡• štØ$p.", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_ROOM
);

3054 ià(
fightšg
) {

3055 ià(
pÜl
->
v®ue
[2].
	`æags
().
	`has
(
GATE_NORMAL_EXIT
))

3056 
	`aù
("You jum°through $p!", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_CHAR
);

3058 
	`aù
("You jum°through $°ªd iÁØ¨brighˆlighˆbeyÚd...", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_CHAR
);

3061 ià(
pÜl
->
v®ue
[2].
	`æags
().
	`has
(
GATE_NORMAL_EXIT
))

3062 
	`aù
("You s‹°through $p.", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_CHAR
);

3064 
	`aù
("You w®khrough $°ªd iÁØ¨brighˆlighˆbeyÚd...", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_CHAR
);

3067 
	`ch¬_äom_room
(
ch
);

3068 
	`ch¬_to_room
(
ch
, 
loÿtiÚ
);

3070 ià(
pÜl
->
v®ue
[2].
	`æags
().
	`has
(
GATE_GOWITH
)) {

3071 
	`obj_äom_room
(
pÜl
);

3072 
	`obj_to_room
(
pÜl
, 
loÿtiÚ
);

3075 ià(
fightšg
) {

3076 ià(
pÜl
->
v®ue
[2].
	`æags
().
	`has
(
GATE_NORMAL_EXIT
))

3077 
	`aù
("$Àjump ouˆoà$p,†ookšg somewh© b©‹»d.", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_ROOM
);

3079 
	`aù
("IÀ¨blšdšg fÏsh, $À¬rive through $p.", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_ROOM
);

3082 ià(
pÜl
->
v®ue
[2].
	`æags
().
	`has
(
GATE_NORMAL_EXIT
))

3083 
	`aù
("$À§uÁ” š.", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_ROOM
);

3085 
	`aù
("IÀ¨blšdšg fÏsh, $À¬rive through $p.", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_ROOM
);

3088 
	`do_look
(
ch
, "auto");

3090 ià(!
ch
->
	`is_Åc
(è&& 
fightšg
) {

3091 ià(
ch
->
gud
 !ğ
Gud
::
th›f
) {

3092 ià(
ch
->
gud
 =ğ
Gud
::
·Ïdš
) {

3093 
	`¡c
("You†o£ 50ƒxp.\n", 
ch
);

3094 
	`gaš_exp
(
ch
, -50);

3097 
	`¡c
("You†o£ 10ƒxp.\n", 
ch
);

3098 
	`gaš_exp
(
ch
, -10);

3104 ià(
pÜl
->
v®ue
[0] > 0) {

3105 
pÜl
->
v®ue
[0] -= 1;

3107 ià(
pÜl
->
v®ue
[0] == 0)

3108 
pÜl
->
v®ue
[0] = -1;

3112 ià(
Şd_room
 =ğ
loÿtiÚ
)

3115 
fch
 = 
Şd_room
->
³İË
; fch !ğ
nuÎ±r
; fch = 
fch_Ãxt
) {

3116 
fch_Ãxt
 = 
fch
->
Ãxt_š_room
;

3119 ià(
pÜl
 =ğ
nuÎ±r
 ||…Ül->
v®ue
[0] == -1)

3122 ià(
fch
->
ma¡”
 =ğ
ch
 && 
afãù
::
	`exi¡s_Ú_ch¬
(fch,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& 
	`g‘_pos™iÚ
(fchè< 
POS_STANDING
) {

3123 ià(
fch
->
¡¬t_pos
 =ğ
POS_FLYING
 && 
	`CAN_FLY
(fch))

3124 
	`do_æy
(
fch
, "");

3126 
	`do_¡ªd
(
fch
, "");

3129 ià(
fch
->
ma¡”
 =ğ
ch
 && 
	`g‘_pos™iÚ
(fchè=ğ
POS_STANDING
) {

3130 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_LAW
)

3131 && (
fch
->
	`is_Åc
(è&& fch->
aù_æags
.
	`has
(
ACT_AGGRESSIVE
))) {

3132 
	`aù
("You cª'ˆbršg $N iÁØthc™y!! A» you DAFT?!", 
ch
, 
nuÎ±r
, 
fch
, 
TO_CHAR
);

3133 
	`aù
("G‘ y”‡gg»ssivbu‰ ou‰¨towÀbuddy...", 
fch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

3137 
	`aù
("You cha£‡á” $N.", 
fch
, 
nuÎ±r
, 
ch
, 
TO_CHAR
);

3138 
	`do_’‹r
(
fch
, 
¬gum’t
);

3142 ià(
pÜl
 !ğ
nuÎ±r
 &&…Ül->
v®ue
[0] == -1) {

3143 
buf
[
MAX_STRING_LENGTH
];

3144 
	`aù
("$°ex¶ode outw¬d ªd vªishes.", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_CHAR
);

3145 
FÜm©
::
	`¥rštf
(
buf
, "$p disappears with‡n inrush of‡ir‡nd‡ 'Pop!'");

3147 ià(
ch
->
š_room
 =ğ
Şd_room
)

3148 
	`aù
(
buf
, 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_ROOM
);

3149 ià(
Şd_room
->
³İË
 !ğ
nuÎ±r
) {

3150 
	`aù
(
buf
, 
Şd_room
->
³İË
, 
pÜl
, 
nuÎ±r
, 
TO_CHAR
);

3151 
	`aù
(
buf
, 
Şd_room
->
³İË
, 
pÜl
, 
nuÎ±r
, 
TO_ROOM
);

3154 
	`exŒaù_obj
(
pÜl
);

3160 
	`¡c
("Nİe, cª'ˆdØ™.\n", 
ch
);

3161 
	}
}

3163 
	$do_Ïnd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3165 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
aœ
) {

3166 
	`¡c
("Th”i nowh”tØpuˆyou¸ã‘!\n", 
ch
);

3170 ià(!
	`IS_FLYING
(
ch
)) {

3171 
	`¡c
("You‡»‡Ì—dy oÀthground.\n", 
ch
);

3175 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
w©”_swim


3176 || 
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
w©”_noswim
) {

3177 
	`¡c
("You†ªd iÀthw©” w™h‡ big {B*{CS{BP{CL{BA{CS{BH{C*{x!\n", 
ch
);

3178 
	`aù
("$n†ands inhe water with‡ big {B*{CS{BP{CL{BA{CS{BH{C*{x!\n",

3179 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3181 
	`¡c
("You†ªd g¿ûfuÎy oÀbÙh f“t.\n", 
ch
);

3182 
	`aù
("$Àg¿ûfuÎy†ªd Ú bÙh f“t.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3185 
ch
->
pos™iÚ
 = 
POS_STANDING
;

3186 
ch
->
¡¬t_pos
 = 
POS_STANDING
;

3187 
	}
}

3189 
	$do_æy
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3191 ià(
	`IS_FLYING
(
ch
)) {

3192 
	`¡c
("You‡»‡Ì—dy flyšg!\n", 
ch
);

3196 ià(!
	`CAN_FLY
(
ch
)) {

3197 
	`¡c
("You‡‰em±Øgrow somwšgs, buˆç.\n", 
ch
);

3202 ià(
ch
->
pos™iÚ
 <ğ
POS_SITTING
)

3203 
	`do_¡ªd
(
ch
, "");

3206 ià(
ch
->
pos™iÚ
 <ğ
POS_SITTING
)

3209 
ch
->
pos™iÚ
 = 
POS_FLYING
;

3210 
ch
->
¡¬t_pos
 = 
POS_FLYING
;

3211 
ch
->
Ú
 = 
nuÎ±r
;

3213 
	`¡c
("YouaktØthaœ.\n", 
ch
);

3214 
	`aù
("$Àke tØthaœ.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3215 
	}
}

3225 
	$do_¥ou£g©e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3227 
Ch¬aù”
 *
viùim
;

3228 
boŞ
 
g©e_³t
 = 
çl£
;

3230 ià(
ch
->
	`is_Åc
())

3233 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

3237 ià(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
¥ou£g©e
) < 50) {

3238 
	`¡c
("You dØnÙ know howØg©tØyou¸¥ou£.\n", 
ch
);

3242 ià(
ch
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()) {

3243 
	`¡c
("You may‚Ù g©šhque¡‡»a.\n", 
ch
);

3247 ià((
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
è|| (
	`ch¬_š_du–_room
(ch))) {

3248 
	`¡c
("You may‚Ù g©whšh¬’a.\n", 
ch
);

3252 ià(! 
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_MARRIED
)) {

3253 
	`¡c
("You‡»‚Ù m¬r›d.\n", 
ch
);

3257 ià(
ch
->
fightšg
) {

3258 
	`¡c
("You‡»oØbusy„ighˆnow!\n", 
ch
);

3262 
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, ch->
pcd©a
->
¥ou£
, 
VIS_CHAR
);

3264 ià(! 
viùim
) {

3265 
	`¡c
("You¸b–oved dÛ nÙ s“mØbšhi wÜld.\n", 
ch
);

3269 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_NO_RECALL
)

3270 || 
viùim
 =ğ
ch


3271 || 
viùim
->
š_room
 =ğ
nuÎ±r


3272 || !
	`ÿn_£e_room
(
ch
, 
viùim
->
š_room
)

3273 || 
viùim
->
š_room
->
	`æags
().
	`has_ªy_of
(
ROOM_SAFE
 | 
ROOM_PRIVATE
 | 
ROOM_SOLITARY
 | 
ROOM_NO_RECALL
)

3274 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


3275 || 
viùim
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()

3276 || 
	`ch¬_š_du–_room
(
viùim
)

3277 || 
viùim
->
š_room
->
	`şª
()

3278 || 
viùim
->
š_room
->
	`gud
(è!ğ
Gud
::
nÚe


3279 || (
viùim
->
	`is_Åc
())) {

3280 
	`¡c
("You faed.\n", 
ch
);

3285 ià((
ch
->
³t
è&& (ch->
š_room
 == ch->pet->in_room) &&

3286 (! 
ch
->
³t
->
aù_æags
.
	`has
(
ACT_STAY
)))

3287 
g©e_³t
 = 
Œue
;

3290 
	`aù
("$À¡• through‡ g©ªd vªishes.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3291 
	`¡c
("You s‹°through‡ g©ªd vªish.\n", 
ch
);

3292 
	`ch¬_äom_room
(
ch
);

3293 
	`ch¬_to_room
(
ch
, 
viùim
->
š_room
);

3294 
	`aù
("$Àha ¬rivedhrough‡ g©e.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3295 
	`do_look
(
ch
, "auto");

3297 ià(
g©e_³t
) {

3298 
	`aù
("$À¡• through‡ g©ªd vªishes.", 
ch
->
³t
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3299 
	`¡c
("You s‹°through‡ g©ªd vªish.\n", 
ch
->
³t
);

3300 
	`ch¬_äom_room
(
ch
->
³t
);

3301 
	`ch¬_to_room
(
ch
->
³t
, 
viùim
->
š_room
);

3302 
	`aù
("$Àha ¬rivedhrough‡ g©e.", 
ch
->
³t
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3303 
	`do_look
(
ch
->
³t
, "auto");

3305 
	}
}

	@src/act_obj.cc

28 
	~<veùÜ
>

29 
	~<sys/time.h
>

30 
	~<®gÜ™hm
>

32 
	~"aù.hh
"

33 
	~"¬gum’t.hh
"

34 
	~"afãù/Afãù.hh
"

35 
	~"A»a.hh
"

36 
	~"chªÃls.hh
"

37 
	~"Ch¬aù”.hh
"

38 
	~"CÏn.hh
"

39 
	~"deş¬e.hh
"

40 
	~"DesütÜ.hh
"

41 
	~"ev’t/ev’t.hh
"

42 
	~"ExŒaDesü.hh
"

43 
	~"fšd.hh
"

44 
	~"FÏgs.hh
"

45 
	~"FÜm©.hh
"

46 
	~"Game.hh
"

47 
	~"GameTime.hh
"

48 
	~"š‹½.hh
"

49 
	~"lookup.hh
"

50 
	~"Loggšg.hh
"

51 
	~"magic.hh
"

52 
	~"memÜy.hh
"

53 
	~"m”c.hh
"

54 
	~"MobProg.hh
"

55 
	~"MobePrÙÙy³.hh
"

56 
	~"Objeù.hh
"

57 
	~"ObjeùPrÙÙy³.hh
"

58 
	~"ObjeùV®ue.hh
"

59 
	~"PÏy”.hh
"

60 
	~"Que¡A»a.hh
"

61 
	~"¿ndom.hh
"

62 
	~"Room.hh
"

63 
	~"Shİ.hh
"

64 
	~"skl/skl.hh
"

65 
	~"SŒšg.hh
"

66 
	~"bËs.hh
"

67 
	~"WÜld.hh
"

68 
	~"RoomPrÙÙy³.hh
"

70 
chªÃl_who
 
¬gs
((
Ch¬aù”
 *
ch
, cÚ¡ *
chªÃÊame
, 
chªÃl
, 
cu¡om
));

75 
boŞ
 
»move_obj
 
¬gs
((
Ch¬aù”
 *
ch
, 
iW—r
, boŞ 
fR•Ïû
));

76 
w—r_obj
 
¬gs
((
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, 
boŞ
 
fR•Ïû
));

77 
Ch¬aù”
 *
fšd_k“³r
 
¬gs
((Ch¬aù” *
ch
));

78 
g‘_co¡
 
¬gs
((
Ch¬aù”
 *
k“³r
, 
Objeù
 *
obj
, 
boŞ
 
fBuy
));

79 
obj_to_k“³r
 
¬gs
((
Objeù
 *
obj
, 
Ch¬aù”
 *
ch
));

80 
Objeù
 *
g‘_obj_k“³r
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
k“³r
, cÚ¡ 
SŒšg
& 
¬gum’t
));

86 *
	$Üdš®_¡ršg
(
n
)

88 
buf
[20];

90 ià(
n
 == 1)

92 ià(
n
 == 2)

94 ià(
n
 == 3)

96 ià(
n
 % 10 == 1)

97 
FÜm©
::
	`¥rštf
(
buf
, "%d¡", 
n
);

98 ià(
n
 % 10 == 2)

99 
FÜm©
::
	`¥rštf
(
buf
, "%dnd", 
n
);

100 ià(
n
 % 10 == 3)

101 
FÜm©
::
	`¥rštf
(
buf
, "%drd", 
n
);

103 
FÜm©
::
	`¥rštf
(
buf
, "%dth", 
n
);

105  
buf
;

106 
	}
}

115 
boŞ
 
	$şª_eq_ok
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, cÚ¡ 
SŒšg
& 
aùiÚ
)

117 ià(
	`IS_IMMORTAL
(
ch
))

118  
Œue
;

120 
CÏn
 *
jşª
;

121 ià((
jşª
 = 
	`şª_vnum_lookup
(
obj
->
pIndexD©a
->
vnum
)è=ğ
nuÎ±r
)

122  
Œue
;

124 ià(
ch
->
şª
 !ğ
jşª
) {

125 ià(!
aùiÚ
.
	`em±y
()) {

126 
	`±c
(
ch
, "You‡ttempto %s %s, which belongso %s.\n",

127 
aùiÚ
, 
obj
->
shÜt_desü
, 
jşª
->
şªÇme
);

130 
	`±c
(
ch
, "%s {Yexplodes violently{x,†eaving only‡ cloud of {gsmoke{x.\n",

131 
obj
->
shÜt_desü
);

132 
	`¡c
("You‡»†ucky you w”’'ˆ{Phu¹!{x\n", 
ch
);

133 
	`de¡roy_obj
(
obj
);

134  
çl£
;

137 ià(
obj
->
Çme
.
	`has_wÜds
("Ëad”eq"è&& !
ch
->
	`has_cgroup
(
GROUP_LEADER
)) {

138 ià(!
aùiÚ
.
	`em±y
()) {

139 
	`±c
(
ch
, "You‡ttempto %s your Leader's %s.\n",

140 
aùiÚ
, 
obj
->
shÜt_desü
);

143 
	`±c
(
ch
, "%s flies from your grasp,…resumably into your Clan's coffers.\n",

144 
obj
->
shÜt_desü
);

145 
	`¡c
("Wa™ uÁhL—d” h—¸oàthis!\n", 
ch
);

146 
	`exŒaù_obj
(
obj
);

147  
çl£
;

150  
Œue
;

151 
	}
}

159 
boŞ
 
	$³rs_eq_ok
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, cÚ¡ 
SŒšg
& 
aùiÚ
)

161 cÚ¡ 
ExŒaDesü
 *
pdesc
;

162 
owÃr
[
MAX_STRING_LENGTH
];

163 
buf
[
MAX_STRING_LENGTH
];

165 ià(
ch
 =ğ
nuÎ±r
) {

166 
Loggšg
::
	`bug
("pers_eq_ok:‚ullptr character", 0);

167  
Œue
;

170 ià(
obj
 =ğ
nuÎ±r
) {

171 
Loggšg
::
	`bug
("pers_eq_ok:‚ullptr object", 0);

172  
Œue
;

175 ià(
obj
->
pIndexD©a
 =ğ
nuÎ±r
) {

176 
Loggšg
::
	`bug
("pers_eq_ok:‚ullptr object->pIndexData", 0);

177  
Œue
;

180 ià((
pdesc
 = 
	`g‘_exŒa_desü
(
KEYWD_OWNER
, 
obj
->
exŒa_desü
)è=ğ
nuÎ±r


181 && (
pdesc
 = 
	`g‘_exŒa_desü
(
KEYWD_OWNER
, 
obj
->
pIndexD©a
->
exŒa_desü
)è=ğ
nuÎ±r
)

182  
Œue
;

184 
	`ssÿnf
(
pdesc
->
desütiÚ
.
	`c_¡r
(), "%[^\n]", 
owÃr
);

186 ià(
	`SŒšg
(
owÃr
).
	`has_wÜds
(
ch
->
Çme
))

187  
Œue
;

189 ià(
obj
->
shÜt_desü
.
	`em±y
()) {

190 
Loggšg
::
	`bugf
("şª_eq_ok: objeù %d ha nØshÜt_desü", 
obj
->
pIndexD©a
->
vnum
);

191 
obj
->
shÜt_desü
 = "something";

194 ià(!
aùiÚ
.
	`em±y
()) {

195 
FÜm©
::
	`¥rštf
(
buf
, "You‡‰em±Ø% %s.\n", 
aùiÚ
, 
obj
->
shÜt_desü
);

196 
	`¡c
(
buf
, 
ch
);

197 
FÜm©
::
	`¥rštf
(
buf
, " Thi ™em b–Úg tØ%s!\n", 
owÃr
);

198 
	`¡c
(
buf
, 
ch
);

200 ià(
	`IS_IMMORTAL
(
ch
)) {

201 
	`¡c
(" A ª ImmÜl, you havthright.\n", 
ch
);

202  
Œue
;

206  
çl£
;

207 
	}
}

211 
boŞ
 
	$ÿn_loÙ
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
)

213 
Ch¬aù”
 *
owÃr
 = 
nuÎ±r
;

215 ià(
	`IS_IMMORTAL
(
ch
))

216  
Œue
;

218 ià(
obj
->
owÃr
.
	`em±y
())

219  
Œue
;

221 autØ
wch
 : 
Game
::
	`wÜld
().
ch¬_li¡
)

222 ià(
wch
->
Çme
 =ğ
obj
->
owÃr
) {

223 
owÃr
 = 
wch
;

227 ià(
owÃr
 =ğ
nuÎ±r
)

228  
Œue
;

230 ià(
ch
->
Çme
 =ğ
owÃr
->name)

231  
Œue
;

233 ià(!
owÃr
->
	`is_Åc
(è&& owÃr->
aù_æags
.
	`has
(
PLR_CANLOOT
))

234  
Œue
;

236 ià(
	`is_§me_group
(
ch
, 
owÃr
))

237  
Œue
;

239  
çl£
;

240 
	}
}

242 
	$do_£cÚd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

244 
Objeù
 *
obj
;

246 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
du®_w›ld
è&& !ch->
	`is_Åc
()) {

247 
	`¡c
("You‡»‚Ù‡bËØw›ldwØw—pÚs.\n", 
ch
);

251 ià(
¬gum’t
.
	`em±y
()) {

252 
	`¡c
("Which w—pÚ dØyou wªˆtØw›ld iÀyou¸off-hªd?\n", 
ch
);

256 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬gum’t
)è=ğ
nuÎ±r
) {

257 
	`¡c
("You dØnÙ havth© w—pÚ.\n", 
ch
);

261 ià(
obj
->
™em_ty³
 !ğ
ITEM_WEAPON
) {

262 
	`¡c
("Th© i nÙ‡ w—pÚ.\n", 
ch
);

266 ià(!
	`IS_IMMORTAL
(
ch
)) {

267 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_two_hªds
è&& 
ch
->
size
 < 
SIZE_HUGE
) {

268 
	`¡c
("You cª‚Ù du®-w›ld‡wØhªded w—pÚ.\n", 
ch
);

272 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
è!ğ
nuÎ±r


273 && 
afãù
::
	`exi¡s_Ú_obj
(
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
),‡fãù::
ty³
::
w—pÚ_two_hªds
)

274 && 
ch
->
size
 < 
SIZE_LARGE
) {

275 
	`¡c
("You¸´im¬y w—pÚ i kšg bÙh oàyou¸hªds.\n", 
ch
);

279 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_SHIELD
è!ğ
nuÎ±r


280 || 
	`g‘_eq_ch¬
(
ch
, 
WEAR_HOLD
è!ğ
nuÎ±r
) {

281 
	`¡c
("You‚“d bÙh hªd ä“Øw›ldwØw—pÚs.\n", 
ch
);

285 ià(
	`g‘_obj_weight
(
obj
è> (
¡r_­p
[
	`GET_ATTR_STR
(
ch
)].
w›ld
 * 5)) {

286 
	`¡c
("Thi w—pÚ i toØh—vyØbu£d iÀyou¸off-hªd.\n", 
ch
);

290 ià(
obj
->
Ëv–
 > 
	`g‘_u§bË_Ëv–
(
ch
)) {

291 ià(
obj
->
Ëv–
 < 
LEVEL_IMMORTAL
) {

292 
	`±c
(
ch
, "You must be†evel %d(%d)o usehis object.\n",

293 
ch
->
Ëv–
 + (
obj
->Ëv– - 
	`g‘_u§bË_Ëv–
(ch)), obj->level);

294 
	`aù
("$ÀŒ› tØu£ $p, buˆi toØšex³r›nûd.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

298 
	`¡c
("Thi ™em mu¡ blow”ed fÜ mÜÈu£.\n", 
ch
);

299 
	`aù
("$ÀŒ› tØu£ $p, buˆi toØboundØthmÜÈ¶ªe.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

305 ià(!
	`»move_obj
(
ch
, 
WEAR_SECONDARY
, 
Œue
))

308 ià(!
	`şª_eq_ok
(
ch
, 
obj
, "equip yourself with"))

311 ià(!
	`³rs_eq_ok
(
ch
, 
obj
, "equip yourself with"))

314 
	`aù
("$Àw›ld $p{x iÀ$ off-hªd.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

315 
	`aù
("You w›ld $p{x iÀyou¸off-hªd.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

316 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_SECONDARY
);

317 
	}
}

319 
	$g‘_obj
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, Objeù *
cÚš”
)

322 
Ch¬aù”
 *
gch
;

323 
memb”s
;

324 
bufãr
[100];

326 ià(!
	`CAN_WEAR
(
obj
, 
ITEM_TAKE
)) {

327 
	`¡c
("You cª'ˆkth©!\n", 
ch
);

331 ià(
cÚš”
 && cÚš”->
ÿ¼›d_by
 && cÚš”->ÿ¼›d_by =ğ
ch
) {

335 ià(
	`g‘_ÿ¼y_numb”
(
ch
è+ 
	`g‘_obj_numb”
(
obj
è> 
	`ÿn_ÿ¼y_n
(ch)) {

336 
	`aù
("$d: you cª'ˆÿ¼yh© mªy i‹ms.", 
ch
, 
nuÎ±r
, 
obj
->
Çme
, 
TO_CHAR
);

340 ià(
	`g‘_ÿ¼y_weight
(
ch
è+ 
	`g‘_obj_weight
(
obj
è> 
	`ÿn_ÿ¼y_w
(ch)) {

341 
	`aù
("$d: you cª'ˆÿ¼yh© much weight.", 
ch
, 
nuÎ±r
, 
obj
->
Çme
, 
TO_CHAR
);

345 ià(!
	`ÿn_loÙ
(
ch
, 
obj
)) {

346 
	`aù
("HEY! NØcÜp£†oÙšg y¨sÿv’g”!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

350 ià(
obj
->
š_room
 !ğ
nuÎ±r
) {

351 
gch
 = 
obj
->
š_room
->
³İË
; gch !ğ
nuÎ±r
; gch = gch->
Ãxt_š_room
)

352 ià(
gch
->
Ú
 =ğ
obj
) {

353 
	`aù
("$N‡µ—r tØbusšg $p.", 
ch
, 
obj
, 
gch
, 
TO_CHAR
);

358 ià(
cÚš”
 !ğ
nuÎ±r
) {

359 ià(
cÚš”
 =ğ
Game
::
	`wÜld
().
dÚ©iÚ_p™
) {

360 ià(!
	`IS_HEROIC
(
ch
)

361 && ((
obj
->
Ëv–
 >ğ
LEVEL_IMMORTAL
 && obj->Ëv– > 
	`g‘_hŞdabË_Ëv–
(
ch
))

362 || (
obj
->
Ëv–
 < 
LEVEL_IMMORTAL
 && obj->Ëv– > 
	`g‘_u§bË_Ëv–
(
ch
)))) {

363 
	`¡c
("You‡»‚Ù…ow”fuÈ’oughØu£ it.\n", 
ch
);

367 
obj
->
dÚ©ed
 = 0;

370 
	`aù
("You g‘ $°äom $P.", 
ch
, 
obj
, 
cÚš”
, 
TO_CHAR
);

371 
	`aù
("$Àg‘ $°äom $P.", 
ch
, 
obj
, 
cÚš”
, 
TO_ROOM
);

372 
	`obj_äom_obj
(
obj
);

375 
	`aù
("You g‘ $p.", 
ch
, 
obj
, 
cÚš”
, 
TO_CHAR
);

376 
	`aù
("$Àg‘ $p.", 
ch
, 
obj
, 
cÚš”
, 
TO_ROOM
);

377 
	`obj_äom_room
(
obj
);

380 ià(
obj
->
™em_ty³
 =ğ
ITEM_MONEY
) {

381 
ch
->
sv”
 +ğ
obj
->
v®ue
[0];

382 
ch
->
gŞd
 +ğ
obj
->
v®ue
[1];

384 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOSPLIT
)) {

386 
memb”s
 = 0;

388 
gch
 = 
ch
->
š_room
->
³İË
; gch !ğ
nuÎ±r
; gch = gch->
Ãxt_š_room
)

389 ià(
	`is_§me_group
(
gch
, 
ch
)

390 && !
gch
->
	`is_Åc
())

391 
memb”s
++;

393 ià(
memb”s
 > 1 && (
obj
->
v®ue
[0] > 1 || obj->value[1])) {

394 
FÜm©
::
	`¥rštf
(
bufãr
, "%d %d", 
obj
->
v®ue
[0], obj->value[1]);

395 
	`do_¥l™
(
ch
, 
bufãr
);

399 
	`exŒaù_obj
(
obj
);

402 
	`obj_to_ch¬
(
obj
, 
ch
);

404 ià(!
ch
->
	`is_Åc
()) {

406 ià(
	`IS_QUESTOR
(
ch
)) {

407 ià(
ch
->
pcd©a
->
que¡obj
 =ğ
obj
->
pIndexD©a
->
vnum
 && ch->pcd©a->
que¡obf
 != -1) {

408 
buf
[
MAX_STRING_LENGTH
];

409 
	`¡c
("{YYou hav®mo¡ com¶‘ed you¸QUEST!{x\n", 
ch
);

410 
	`¡c
("{YR‘uºØthque¡ma¡” befÜyou¸timrun out!{x\n", 
ch
);

411 
ch
->
pcd©a
->
que¡obf
 = -1;

412 
FÜm©
::
	`¥rštf
(
buf
, "{Y:QUEST: {x$N ha found %s", 
obj
->
shÜt_desü
);

413 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

418 ià(
	`IS_SQUESTOR
(
ch
)) {

419 ià(
ch
->
pcd©a
->
sque¡obj
 =ğ
obj
 && !ch->pcd©a->
sque¡objf
) {

420 
buf
[
MAX_STRING_LENGTH
];

422 ià(
ch
->
pcd©a
->
sque¡mob
 =ğ
nuÎ±r
) {

423 
	`¡c
("{YYou hav®mo¡ com¶‘ed you¸{VSKILL QUEST!{x\n", 
ch
);

424 
	`¡c
("{YR‘uºØthque¡mi¡»s befÜyou¸timrun out!{x\n", 
ch
);

427 
	`¡c
("{YYou havcom¶‘ed…¬ˆoàyou¸{VSKILL QUEST!{x\n", 
ch
);

428 
FÜm©
::
	`¥rštf
(
buf
, "{YTakehe‡rtifacto %s whilehere is stillime!{x\n",

429 
ch
->
pcd©a
->
sque¡mob
->
shÜt_desü
);

430 
	`¡c
(
buf
, 
ch
);

433 
ch
->
pcd©a
->
sque¡objf
 = 
Œue
;

434 
FÜm©
::
	`¥rštf
(
buf
, "{Y:SKILL QUEST: {x$N ha foundh%s", 
obj
->
shÜt_desü
);

435 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

442 
	}
}

444 
boŞ
 
	$äom_box_ok
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, *
box_ty³
)

446 ià(
obj
 =ğ
nuÎ±r
) {

447 
	`±c
(
ch
, "You dØnÙ s“h© iÀyou¸%s.\n", 
box_ty³
);

448  
çl£
;

451 ià(!
	`CAN_WEAR
(
obj
, 
ITEM_TAKE
)) {

452 
	`¡c
("You cª'ˆkth©!\n", 
ch
);

453 
Loggšg
::
	`bugf
("I‹m w™houˆITEM_TAKE iÀ%s' %s.", 
ch
->
Çme
, 
box_ty³
);

454  
çl£
;

457 ià(
	`g‘_ÿ¼y_numb”
(
ch
è+ 
	`g‘_obj_numb”
(
obj
è> 
	`ÿn_ÿ¼y_n
(ch)) {

458 
	`±c
(
ch
, "%s: you cª'ˆÿ¼yh© mªy i‹ms.\n", 
obj
->
Çme
);

459  
çl£
;

462 ià(
	`g‘_ÿ¼y_weight
(
ch
è+ 
	`g‘_obj_weight
(
obj
è> 
	`ÿn_ÿ¼y_w
(ch)) {

463 
	`±c
(
ch
, "%s: you cª'ˆÿ¼yh© much weight.\n", 
obj
->
Çme
);

464  
çl£
;

467  
Œue
;

468 
	}
}

470 
	$do_touch
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
) {

471 ià(
¬gum’t
.
	`em±y
()) {

472 
	`¡c
("Touch wh©?\n", 
ch
);

476 
SŒšg
 
¬g
;

477 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

479 
Objeù
 *
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬g
);

481 ià(!
obj
) {

482 
	`¡c
("You dÚ'ˆ£th© h”e.\n", 
ch
);

486 ià(
obj
->
™em_ty³
 =ğ
ITEM_WARP_CRYSTAL
) {

487 ià(
ch
->
	`is_Åc
()) {

488 
	`¡c
("Thgod havfÜbidd’ you¸kšd fromouchšgh©.\n", 
ch
);

492 
	`aù
("You…Ïû you¸hªd upÚh$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

493 
	`aù
("$À¶aû $ hªd upÚh$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

495 
SŒšg
 
loc
;

497 
ExŒaDesü
 *
ed
 = 
obj
->
pIndexD©a
->
exŒa_desü
;ƒd;ƒd =ƒd->
Ãxt
)

498 ià(
ed
->
keywÜd
 == "warp_loc")

499 
loc
 = 
ed
->
desütiÚ
;

501 ià(
loc
.
	`em±y
()) {

502 
Loggšg
::
	`bug
("warp crystal with‚o†ocationƒxtra description", 0);

503 
	`aù
("Th$°£em tØbš”t.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

507 ià(
ch
->
pcd©a
->
w¬p_locs
.
	`fšd
(
loc
è!ğch->pcd©a->w¬p_locs.
	`’d
()) {

508 
	`aù
("You havtouchedhi $°®»ady...‚Ùhšg h­³ns.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

512 
	`aù
("Tendrils of blue-whiteƒnergy momentarily swirl‡round your wrist.\n"

514 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

515 
	`aù
("Tendrils of blue-whiteƒnergy momentarily swirl‡round $n's wrist.",

516 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

518 
ch
->
pcd©a
->
w¬p_locs
.
	`em¶aû
(
loc
);

522 
	`¡c
("Yououch it, buˆnÙhšg h­³ns.\n", 
ch
);

523 
	}
}

525 
	$do_g‘
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

527 
Objeù
 *
obj
, *
obj_Ãxt
, *
cÚš”
;

528 
boŞ
 
found
;

531 ià(
¬gum’t
.
	`em±y
()) {

532 
	`¡c
("G‘ wh©?\n", 
ch
);

536 
SŒšg
 
¬g1
, 
¬g2
;

537 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

538 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

540 ià(
¬g2
 == "from")

541 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

543 ià(
¬g2
.
	`em±y
()) {

544 ià(
¬g1
 !ğ"®l" && !¬g1.
	`has_´efix
("all.")) {

546 
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬g1
, ch->
š_room
->
cÚ‹Ás
);

548 ià(
obj
 =ğ
nuÎ±r
) {

549 
	`±c
(
ch
, "You dÚ'ˆ£¨% h”e.\n", 
¬g1
);

553 
	`g‘_obj
(
ch
, 
obj
, 
nuÎ±r
);

557 
found
 = 
çl£
;

559 
obj
 = 
ch
->
š_room
->
cÚ‹Ás
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

560 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

562 ià((
¬g1
.
	`Ëngth
() == 3

563 || 
obj
->
Çme
.
	`has_wÜds
(
¬g1
.
	`sub¡r
(4)))

564 && 
	`ÿn_£e_obj
(
ch
, 
obj
)) {

565 
found
 = 
Œue
;

566 
	`g‘_obj
(
ch
, 
obj
, 
nuÎ±r
);

570 ià(!
found
) {

571 ià(
¬g1
.
	`Ëngth
() == 3)

572 
	`¡c
("G‘ wh©?\n", 
ch
);

574 
	`±c
(
ch
, "You s“‚Ø% h”e.\n", &
¬g1
[4]);

580 ià(
¬g2
 =ğ"®l" ||‡rg2.
	`has_´efix
("all.")) {

581 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

585 ià(
¬g2
.
	`is_´efix_of
("lock”"è&& !
ch
->
	`is_Åc
()) {

586 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_LOCKER
)) {

587 ià(
ch
->
aù_æags
.
	`has
(
PLR_CLOSED
)) {

588 
numb”
 = 
	`g‘_lock”_numb”
(
ch
);

590 ià(
	`deduù_co¡
(
ch
, 
numb”
 * 10)) {

591 
	`±c
(
ch
, "%d silver has been deducted for your†ocker.\n",

592 
numb”
 * 10);

593 
ch
->
aù_æags
 -ğ
PLR_CLOSED
;

596 
	`¡c
("You¸lock” i şo£d.\n", 
ch
);

601 ià(
¬g1
 !ğ"®l" && !¬g1.
	`has_´efix
("all.")) {

602 
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬g1
, ch->
pcd©a
->
lock”
);

604 ià(!
	`äom_box_ok
(
ch
, 
obj
, "locker"))

607 
	`obj_äom_lock”
(
obj
);

608 
	`obj_to_ch¬
(
obj
, 
ch
);

609 
	`aù
("$Àg‘ $°äom $ lock”.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

610 
	`aù
("You g‘ $°äom you¸lock”.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

613 
found
 = 
çl£
;

615 
obj
 = 
ch
->
pcd©a
->
lock”
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

616 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

618 ià((
¬g1
.
	`Ëngth
() == 3

619 || 
obj
->
Çme
.
	`has_wÜds
(
¬g1
.
	`sub¡r
(4))è&& 
	`ÿn_£e_obj
(
ch
, obj)) {

620 
found
 = 
Œue
;

622 ià(!
	`äom_box_ok
(
ch
, 
obj
, "locker"))

625 
	`obj_äom_lock”
(
obj
);

626 
	`obj_to_ch¬
(
obj
, 
ch
);

627 
	`aù
("$Àg‘ $°äom $ lock”.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

628 
	`aù
("You g‘ $°äom you¸lock”.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

632 ià(!
found
) {

633 ià(
¬g1
.
	`Ëngth
() == 3)

634 
	`¡c
("You s“‚Ùhšg iÀthlock”.\n", 
ch
);

636 
	`¡c
("You s“‚Ùhšg†ikth© iÀthlock”.\n", 
ch
);

641 
	`¡c
("You dØnÙ s“‡†ock”‡cûs h”e.\n", 
ch
);

647 ià(!
ch
->
	`is_Åc
(è&& 
¬g2
.
	`is_´efix_of
("strongbox")) {

648 ià(!
	`IS_HEROIC
(
ch
)) {

649 
	`¡c
("OÆy h”Û ªd fÜm” h”Û hav¡rÚgboxes.\n", 
ch
);

653 ià(!
ch
->
š_room
 || ch->š_room->
loÿtiÚ
 !ğ
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_STRONGBOX
))) {

654 
	`¡c
("You dØnÙ s“ you¸¡rÚgbox h”e.\n", 
ch
);

658 ià(
¬g1
 !ğ"®l" && !¬g1.
	`has_´efix
("all.")) {

659 
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬g1
, ch->
pcd©a
->
¡rÚgbox
);

661 ià(!
	`äom_box_ok
(
ch
, 
obj
, "strongbox"))

664 
	`obj_äom_¡rÚgbox
(
obj
);

665 
	`obj_to_ch¬
(
obj
, 
ch
);

666 
	`aù
("$Àg‘ $°äom $ ¡rÚgbox.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

667 
	`aù
("You g‘ $°äom you¸¡rÚgbox.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

672 
found
 = 
çl£
;

674 
obj
 = 
ch
->
pcd©a
->
¡rÚgbox
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

675 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

677 ià((
¬g1
.
	`Ëngth
(è=ğ3 || 
obj
->
Çme
.
	`has_wÜds
×rg1.
	`sub¡r
(4))è&& 
	`ÿn_£e_obj
(
ch
, obj)) {

678 
found
 = 
Œue
;

680 ià(!
	`äom_box_ok
(
ch
, 
obj
, "strongbox"))

683 
	`obj_äom_¡rÚgbox
(
obj
);

684 
	`obj_to_ch¬
(
obj
, 
ch
);

685 
	`aù
("$Àg‘ $°äom $ ¡rÚgbox.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

686 
	`aù
("You g‘ $°äom you¸¡rÚgbox.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

690 ià(!
found
) {

691 ià(
¬g1
.
	`Ëngth
() == 3)

692 
	`¡c
("You s“‚Ùhšg iÀyou¸¡rÚgbox.\n", 
ch
);

694 
	`¡c
("You s“‚Ùhšg†ikth© iÀyou¸¡rÚgbox.\n", 
ch
);

700 ià((
cÚš”
 = 
	`g‘_obj_h”e
(
ch
, 
¬g2
)è=ğ
nuÎ±r
) {

701 
	`±c
(
ch
, "You s“‚Ø% h”e.\n", 
¬g2
);

705 
cÚš”
->
™em_ty³
) {

707 ià(!
	`IS_OBJ_STAT
(
cÚš”
, 
ITEM_COMPARTMENT
)) {

708 ià(
cÚš”
->
cÚšs
)

709 
	`¡c
("You cª'ˆg‘ iˆout.\n", 
ch
);

711 
	`¡c
("Th©' nÙ‡ cÚš”.\n", 
ch
);

718 
ITEM_CONTAINER
:

719 
ITEM_CORPSE_NPC
:

722 
ITEM_CORPSE_PC
:

723 ià(!
	`ÿn_loÙ
(
ch
, 
cÚš”
)) {

724 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

731 ià(
cÚš”
->
v®ue
[1].
	`æags
().
	`has
(
CONT_CLOSED
è&& !
	`IS_OBJ_STAT
(cÚš”, 
ITEM_COMPARTMENT
)) {

732 
	`±c
(
ch
, "Th% i şo£d.\n", 
cÚš”
->
shÜt_desü
);

736 ià(
¬g1
 !ğ"®l" && !¬g1.
	`has_´efix
("all.")) {

738 
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬g1
, 
cÚš”
->
cÚšs
);

740 ià(
obj
 =ğ
nuÎ±r
) {

741 
	`±c
(
ch
, "You s“‚Ùhšg†ikth© iÀ%s.\n", 
cÚš”
->
shÜt_desü
);

745 
	`g‘_obj
(
ch
, 
obj
, 
cÚš”
);

749 
found
 = 
çl£
;

751 
obj
 = 
cÚš”
->
cÚšs
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

752 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

754 ià((
¬g1
.
	`Ëngth
(è=ğ3 || 
obj
->
Çme
.
	`has_wÜds
×rg1.
	`sub¡r
(4))è&& 
	`ÿn_£e_obj
(
ch
, obj)) {

755 
found
 = 
Œue
;

757 ià(
cÚš”
 =ğ
Game
::
	`wÜld
().
dÚ©iÚ_p™
 && !
	`IS_IMMORTAL
(
ch
)) {

758 
	`¡c
("DÚ'ˆbsØg»edy!\n", 
ch
);

762 
	`g‘_obj
(
ch
, 
obj
, 
cÚš”
);

766 ià(!
found
) {

767 ià(
¬g1
.
	`Ëngth
() == 3)

768 
	`±c
(
ch
, "You s“‚Ùhšg iÀ%s.\n", 
cÚš”
->
shÜt_desü
);

770 
	`±c
(
ch
, "You s“‚Ùhšg†ikth© iÀ%s.\n", 
cÚš”
->
shÜt_desü
);

774 
	}
}

781 
boŞ
 
	$wl_f™
(
Objeù
 *
obj
, Objeù *
cÚš”
)

783 
obj_weight
, 
cÚš”_max_tÙ®
, 
cÚš”_max_sšgË
;

784 
obj_weight
 = 
	`g‘_obj_weight
(
obj
);

786 ià(
cÚš”
->
™em_ty³
 =ğ
ITEM_CONTAINER
) {

787 
cÚš”_max_sšgË
 = 
cÚš”
->
v®ue
[3] * 10;

788 
cÚš”_max_tÙ®
 = 
cÚš”
->
v®ue
[0] * 10;

791 ià(
	`CAN_WEAR
(
cÚš”
, 
ITEM_TAKE
)) {

792 
cÚš”_max_sšgË
 = (
cÚš”
->
Ëv–
 + 1) * 30;

793 
cÚš”_max_tÙ®
 = ((
cÚš”
->
Ëv–
 / 3) + 1) * 10;

796 
cÚš”_max_sšgË
 = 1000;

797 
cÚš”_max_tÙ®
 = 10000;

801 ià(
obj_weight
 > 
cÚš”_max_sšgË
)

802  
çl£
;

804 ià(
obj_weight
 + 
	`g‘_obj_weight
(
cÚš”
è> 
cÚš”_max_tÙ®
)

805  
çl£
;

807  
Œue
;

808 
	}
}

810 
	$do_put
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

812 
Objeù
 *
cÚš”
, *
obj
, *
obj_Ãxt
;

813 
weight
;

814 
boŞ
 
found
 = 
çl£
, 
tooh—vy
 = 
Œue
;

816 
SŒšg
 
¬g1
, 
¬g2
;

817 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

818 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

820 ià(
¬g2
 == "in" ||‡rg2 == "on")

821 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

823 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.empty()) {

824 
	`¡c
("Puˆwh© iÀwh©?\n", 
ch
);

828 ià(
¬g2
 =ğ"®l" ||‡rg2.
	`has_´efix
("all.")) {

829 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

834 ià(!
ch
->
	`is_Åc
(è&& 
¬g2
.
	`is_´efix_of
("locker")) {

835 ià(!
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_LOCKER
)) {

836 
	`¡c
("You dØnÙ s“‡†ock” iÀthi room.\n", 
ch
);

840 ià(
¬g1
 !ğ"®l" && !¬g1.
	`has_´efix
("all.")) {

842 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g1
)è=ğ
nuÎ±r
) {

843 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

847 ià(!
	`ÿn_drİ_obj
(
ch
, 
obj
)) {

848 
	`¡c
("You cª'ˆËˆgØoà™.\n", 
ch
);

852 
weight
 = 
	`g‘_obj_weight
(
obj
);

854 ià(
weight
 + 
	`g‘_lock”_weight
(
ch
) > 10000

855 || 
weight
 > 1000

856 || 
	`g‘_obj_numb”
(
obj
è+ 
	`g‘_lock”_numb”
(
ch
) > 250) {

857 
	`¡c
("IˆwÚ'ˆf™.\n", 
ch
);

861 
	`obj_äom_ch¬
(
obj
);

862 
	`obj_to_lock”
(
obj
, 
ch
);

863 
	`aù
("$Àput $°š $ lock”.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

864 
	`aù
("You…uˆ$°š you¸lock”.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

869 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

870 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

871 
weight
 = 
	`g‘_obj_weight
(
obj
);

873 ià((
¬g1
.
	`Ëngth
(è=ğ3 || 
obj
->
Çme
.
	`has_wÜds
×rg1.
	`sub¡r
(4)))

874 && 
	`ÿn_£e_obj
(
ch
, 
obj
)

875 && 
obj
->
w—r_loc
 =ğ
WEAR_NONE


876 && 
	`ÿn_drİ_obj
(
ch
, 
obj
)

877 && 
weight
 + 
	`g‘_lock”_weight
(
ch
) <= 10000

878 && 
weight
 <= 1000

879 && 
	`g‘_obj_numb”
(
obj
è+ 
	`g‘_lock”_numb”
(
ch
) <= 250) {

880 
	`obj_äom_ch¬
(
obj
);

881 
	`obj_to_lock”
(
obj
, 
ch
);

882 
	`aù
("$Àput $°š $ lock”.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

883 
	`aù
("You…uˆ$°š you¸lock”.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

884 
found
 = 
Œue
;

888 ià(!
found
)

889 
	`¡c
("You dØnÙ havtho£.\n", 
ch
);

895 ià(!
ch
->
	`is_Åc
(è&& 
¬g2
.
	`is_´efix_of
("strongbox")) {

896 ià(!
	`IS_HEROIC
(
ch
)) {

897 
	`¡c
("OÆy h”Û ªd fÜm” h”Û hav¡rÚgboxes.\n", 
ch
);

901 ià(!
ch
->
š_room
 || ch->š_room->
loÿtiÚ
 !ğ
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_STRONGBOX
))) {

902 
	`¡c
("Th”i nØ¡rÚgbox h”e.\n", 
ch
);

906 ià(
¬g1
 !ğ"®l" && !¬g1.
	`has_´efix
("all.")) {

908 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g1
)è=ğ
nuÎ±r
) {

909 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

913 ià(!
	`ÿn_drİ_obj
(
ch
, 
obj
)) {

914 
	`¡c
("You cª'ˆËˆgØoà™.\n", 
ch
);

923 
	`obj_äom_ch¬
(
obj
);

924 
	`obj_to_¡rÚgbox
(
obj
, 
ch
);

925 
	`aù
("$Àput $°š $ ¡rÚgbox.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

926 
	`aù
("You…uˆ$°š you¸¡rÚgbox.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

931 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

932 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

934 ià((
¬g1
.
	`Ëngth
(è=ğ3 || 
obj
->
Çme
.
	`has_wÜds
×rg1.
	`sub¡r
(4)))

935 && 
	`ÿn_£e_obj
(
ch
, 
obj
)

936 && 
obj
->
w—r_loc
 =ğ
WEAR_NONE


937 && 
	`ÿn_drİ_obj
(
ch
, 
obj
)) {

939 
	`obj_äom_ch¬
(
obj
);

940 
	`obj_to_¡rÚgbox
(
obj
, 
ch
);

941 
	`aù
("$Àput $°š $ ¡rÚgbox.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

942 
	`aù
("You…uˆ$°š you¸¡rÚgbox.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

943 
found
 = 
Œue
;

947 ià(!
found
)

948 
	`¡c
("You dØnÙ havtho£.\n", 
ch
);

953 ià((
cÚš”
 = 
	`g‘_obj_h”e
(
ch
, 
¬g2
)è=ğ
nuÎ±r
) {

954 
	`aù
("Th”e' nØ$T h”e.", 
ch
, 
nuÎ±r
, 
¬g2
, 
TO_CHAR
);

958 ià(
cÚš”
->
™em_ty³
 !ğ
ITEM_CONTAINER
) {

959 ià(!
	`IS_OBJ_STAT
(
cÚš”
, 
ITEM_COMPARTMENT
)) {

960 ià(
cÚš”
->
cÚšs
)

961 
	`¡c
("You cªnÙ fšd‡Àİ’šg.\n", 
ch
);

963 
	`¡c
("Th©' nÙ‡ cÚš”.\n", 
ch
);

969 ià(
cÚš”
->
v®ue
[1].
	`æags
().
	`has
(
CONT_CLOSED
)

970 && !
	`IS_OBJ_STAT
(
cÚš”
, 
ITEM_COMPARTMENT
)) {

971 
	`aù
("Th$d i şo£d.", 
ch
, 
nuÎ±r
, 
cÚš”
->
Çme
, 
TO_CHAR
);

975 ià(
¬g1
 !ğ"®l" && !¬g1.
	`has_´efix
("all.")) {

977 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g1
)è=ğ
nuÎ±r
) {

978 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

982 ià(
obj
 =ğ
cÚš”
) {

983 
	`¡c
("You cª'ˆfŞd iˆštØ™£lf.\n", 
ch
);

987 ià(
cÚš”
 =ğ
Game
::
	`wÜld
().
dÚ©iÚ_p™


988 && 
obj
->
Ëv–
 >ğ
LEVEL_IMMORTAL
) {

989 
	`¡c
("Th© i‹m i toØpow”fuÈfÜhdÚ©iÚ…™.\n", 
ch
);

993 ià(!
	`ÿn_drİ_obj
(
ch
, 
obj
)) {

994 
	`¡c
("You cª'ˆËˆgØoà™.\n", 
ch
);

1005 ià(!
	`wl_f™
(
obj
, 
cÚš”
)) {

1006 
	`¡c
("IˆwÚ'ˆf™.\n", 
ch
);

1010 
	`obj_äom_ch¬
(
obj
);

1011 
	`obj_to_obj
(
obj
, 
cÚš”
);

1013 ià(
cÚš”
->
™em_ty³
 =ğ
ITEM_CONTAINER
 && cÚš”->
v®ue
[1].
	`æags
().
	`has
(
CONT_PUT_ON
)) {

1014 
	`aù
("$Àput $°Ú $P.", 
ch
, 
obj
, 
cÚš”
, 
TO_ROOM
);

1015 
	`aù
("You…uˆ$°Ú $P.", 
ch
, 
obj
, 
cÚš”
, 
TO_CHAR
);

1018 
	`aù
("$Àput $°š $P.", 
ch
, 
obj
, 
cÚš”
, 
TO_ROOM
);

1019 
	`aù
("You…uˆ$°š $P.", 
ch
, 
obj
, 
cÚš”
, 
TO_CHAR
);

1026 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

1027 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

1029 ià((
¬g1
.
	`Ëngth
(è=ğ3 || 
obj
->
Çme
.
	`has_wÜds
×rg1.
	`sub¡r
(4)))

1030 && 
	`ÿn_£e_obj
(
ch
, 
obj
)

1031 && 
obj
->
w—r_loc
 =ğ
WEAR_NONE


1032 && 
obj
 !ğ
cÚš”


1033 && 
	`ÿn_drİ_obj
(
ch
, 
obj
)) {

1034 
found
 = 
Œue
;

1036 ià(
cÚš”
 =ğ
Game
::
	`wÜld
().
dÚ©iÚ_p™


1037 && 
obj
->
Ëv–
 >ğ
LEVEL_IMMORTAL
) {

1038 
	`¡c
("Th© i‹m i toØpow”fuÈfÜhdÚ©iÚ…™.\n", 
ch
);

1042 ià(!
	`wl_f™
(
obj
, 
cÚš”
))

1045 
tooh—vy
 = 
çl£
;

1046 
	`obj_äom_ch¬
(
obj
);

1047 
	`obj_to_obj
(
obj
, 
cÚš”
);

1049 ià(
cÚš”
->
™em_ty³
 =ğ
ITEM_CONTAINER
 && cÚš”->
v®ue
[1].
	`æags
().
	`has
(
CONT_PUT_ON
)) {

1050 
	`aù
("$Àput $°Ú $P.", 
ch
, 
obj
, 
cÚš”
, 
TO_ROOM
);

1051 
	`aù
("You…uˆ$°Ú $P.", 
ch
, 
obj
, 
cÚš”
, 
TO_CHAR
);

1054 
	`aù
("$Àput $°š $P.", 
ch
, 
obj
, 
cÚš”
, 
TO_ROOM
);

1055 
	`aù
("You…uˆ$°š $P.", 
ch
, 
obj
, 
cÚš”
, 
TO_CHAR
);

1060 ià(!
found
)

1061 
	`¡c
("You dØnÙ havtho£.\n", 
ch
);

1062 ià(
tooh—vy
)

1063 
	`¡c
("They wÚ'ˆf™.\n", 
ch
);

1064 
	}
}

1067 
	$do_drİ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1069 
Objeù
 *
obj
;

1070 
Objeù
 *
obj_Ãxt
;

1071 
boŞ
 
found
;

1072 
numb”
;

1074 ià(
¬gum’t
.
	`em±y
()) {

1075 
	`¡c
("You‡‰em±Ødrİ iˆlik™' hÙ.\n", 
ch
);

1079 
SŒšg
 
¬g
, 
obj_Çme
;

1080 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1082 ià(
¬g
.
	`is_numb”
()) {

1084 
amouÁ
, 
gŞd
 = 0, 
sv”
 = 0;

1085 
amouÁ
 = 
	`©oi
(
¬g
);

1086 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1088 ià(
amouÁ
 <= 0

1089 || (!
¬g
.
	`is_´efix_of
("coins") && !arg.is_prefix_of("coin") &&

1090 !
¬g
.
	`is_´efix_of
("gold") && !arg.is_prefix_of("silver"))) {

1091 
	`¡c
("SÜry, you cª'ˆdØth©.\n", 
ch
);

1095 ià(
¬g
.
	`is_´efix_of
("coins") ||‡rg.is_prefix_of("coin")

1096 || 
¬g
.
	`is_´efix_of
("silver")) {

1097 ià(
ch
->
sv”
 < 
amouÁ
) {

1098 
	`¡c
("You dÚ'ˆhavth© much sv”.\n", 
ch
);

1102 
ch
->
sv”
 -ğ
amouÁ
;

1103 
sv”
 = 
amouÁ
;

1106 ià(
ch
->
gŞd
 < 
amouÁ
) {

1107 
	`¡c
("You dÚ'ˆhavth© much gŞd.\n", 
ch
);

1111 
ch
->
gŞd
 -ğ
amouÁ
;

1112 
gŞd
 = 
amouÁ
;

1116 
obj
 = 
ch
->
š_room
->
cÚ‹Ás
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

1117 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

1119 ià(
obj
->
pIndexD©a
->
vnum
 =ğ
GEN_OBJ_MONEY


1120 && 
obj
->
Çme
.
	`has_wÜds
("gcash")) {

1121 
sv”
 +ğ
obj
->
v®ue
[0];

1122 
gŞd
 +ğ
obj
->
v®ue
[1];

1123 
	`exŒaù_obj
(
obj
);

1127 
	`aù
("$ÀËt somcoš tumbËØthæoÜ.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1128 
	`¡c
("You fl somcoš tØthground.\n", 
ch
);

1129 
	`obj_to_room
(
	`ü—‹_mÚey
(
gŞd
, 
sv”
), 
ch
->
š_room
);

1133 ià(
¬g
 =ğ"®l" ||‡rg.
	`has_´efix
("all.")) {

1135 
found
 = 
çl£
;

1137 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

1138 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

1140 ià((
¬g
.
	`Ëngth
(è=ğ3 || 
obj
->
Çme
.
	`has_wÜds
×rg.
	`sub¡r
(4)))

1141 && 
	`ÿn_£e_obj
(
ch
, 
obj
)

1142 && 
obj
->
w—r_loc
 =ğ
WEAR_NONE
) {

1143 
found
 = 
Œue
;

1145 ià(
	`ÿn_drİ_obj
(
ch
, 
obj
)) {

1146 
	`obj_äom_ch¬
(
obj
);

1147 
	`aù
("$Àdrİ $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1148 
	`aù
("You drİ $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1149 
	`obj_to_room
(
obj
, 
ch
->
š_room
);

1151 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_MELT_DROP
)) {

1152 
	`aù
("$°üumbË štØdu¡.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1153 
	`aù
("$°üumbË štØdu¡.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1154 
	`de¡roy_obj
(
obj
);

1158 
	`aù
("You cª'ˆ£emØËˆgØoà$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1162 ià(!
found
) {

1163 ià(
¬g
.
	`Ëngth
() == 3)

1164 
	`aù
("You‡re‚ot carrying‡nything.",

1165 
ch
, 
nuÎ±r
, 
¬g
, 
TO_CHAR
);

1167 
	`aù
("You do‚ot have‡ $T.",

1168 
ch
, 
nuÎ±r
, &
¬g
[4], 
TO_CHAR
);

1175 
numb”
 = 
	`muÉ_¬gum’t
(
¬g
, 
obj_Çme
);

1177 ià(
numb”
 == -1) {

1178 
FÜm©
::
	`¥rštf
(
¬g
, "You…atiently wait for something called "

1179 "'%s'Ødrİ oÀyou fromhsky.\n", 
obj_Çme
);

1180 
	`¡c
(
¬g
, 
ch
);

1184 ià(
numb”
 < 0) {

1185 
FÜm©
::
	`¥rštf
(
¬g
, "You…atiently wait for %dhings called "

1186 "'%s'Ødrİ oÀyou fromhsky.\n", -
numb”
, 
obj_Çme
);

1187 
	`¡c
(
¬g
, 
ch
);

1191 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
obj_Çme
)è=ğ
nuÎ±r
) {

1192 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

1196 ià(!
	`ÿn_drİ_obj
(
ch
, 
obj
)) {

1197 
	`¡c
("You cª'ˆ£emØËˆgØoà™.\n", 
ch
);

1201 ià(
numb”
 == 0) {

1202 
	`¡c
("You drİ 0 i‹m ªdƒnd u°w™h wh© you had befÜe.\n", 
ch
);

1206 ià(
numb”
 == 1) {

1208 
	`obj_äom_ch¬
(
obj
);

1209 
	`aù
("$Àdrİ $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1210 
	`aù
("You drİ $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1211 
	`obj_to_room
(
obj
, 
ch
->
š_room
);

1213 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_MELT_DROP
)) {

1214 
	`aù
("$°dissŞve štØsmoke.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1215 
	`aù
("$°dissŞve štØsmoke.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1216 
	`de¡roy_obj
(
obj
);

1222 
Objeù
 *
İ
, *
obj_Ãxt
;

1223 
couÁ
 = 1;

1227 cÚ¡ 
Vnum
& 
obj_vnum
 = 
obj
->
pIndexD©a
->
vnum
;

1229 
İ
 = 
obj
->
Ãxt_cÚ‹Á
; op; op = op->next_content) {

1230 ià(
İ
->
pIndexD©a
->
vnum
 !ğ
obj_vnum
)

1233 
couÁ
++;

1235 ià(!
	`ÿn_drİ_obj
(
ch
, 
İ
)) {

1236 
	`aù
("The $T one stickso you,…reventing "

1238 
ch
, 
nuÎ±r
, 
	`Üdš®_¡ršg
(
couÁ
), 
TO_CHAR
);

1242 ià(
couÁ
 >ğ
numb”
)

1246 
FÜm©
::
	`¥rštf
(
¬g
, "%d", 
couÁ
);

1248 ià(
couÁ
 < 
numb”
) {

1249 
	`aù
("Buˆyou oÆy hav$T oàtho£!", 
ch
, 
nuÎ±r
, 
¬g
, 
TO_CHAR
);

1254 
	`aù
("$Àdrİ $p[$T].", 
ch
, 
obj
, 
¬g
, 
TO_ROOM
);

1255 
	`aù
("You drİ $p[$T].", 
ch
, 
obj
, 
¬g
, 
TO_CHAR
);

1257 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_MELT_DROP
)) {

1258 
	`aù
("$p[$T] dissŞvštØsmoke.", 
ch
, 
obj
, 
¬g
, 
TO_ROOM
);

1259 
	`aù
("$p[$T] dissŞvštØsmoke.", 
ch
, 
obj
, 
¬g
, 
TO_CHAR
);

1263 
couÁ
 = 0;

1265 
İ
 = 
obj
; op; o°ğ
obj_Ãxt
) {

1266 
obj_Ãxt
 = 
İ
->
Ãxt_cÚ‹Á
;

1268 ià(
İ
->
pIndexD©a
->
vnum
 !ğ
obj_vnum
)

1271 
couÁ
++;

1272 
	`obj_äom_ch¬
(
İ
);

1274 ià(
	`IS_OBJ_STAT
(
İ
, 
ITEM_MELT_DROP
))

1275 
	`de¡roy_obj
(
İ
);

1277 
	`obj_to_room
(
İ
, 
ch
->
š_room
);

1279 ià(
couÁ
 >ğ
numb”
)

1283 
	}
}

1285 
	$do_give
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1287 
Ch¬aù”
 *
viùim
;

1288 
Objeù
 *
obj
, *
İ
, *
obj_Ãxt
;

1289 
numb”
, 
couÁ
 = 0, 
™em_numb”
 = 0, 
™em_weight
 = 0;

1291 
SŒšg
 
¬g1
, 
¬g2
, 
buf
;

1292 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

1293 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

1295 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.empty()) {

1296 
	`¡c
("Givwh©Øwhom?\n", 
ch
);

1300 ià(
¬g1
.
	`is_numb”
()) {

1302 
amouÁ
;

1303 
boŞ
 
sv”
;

1304 
amouÁ
 = 
	`©oi
(
¬g1
);

1306 ià(
amouÁ
 <= 0) {

1307 
	`¡c
("YouryØhªd ouˆimagš¬y mÚey. Ch—psk©e.\n", 
ch
);

1311 ià(
¬g2
 != "coins"

1312 && 
¬g2
 != "coin"

1313 && 
¬g2
 != "gold"

1314 && 
¬g2
 != "silver") {

1315 
	`¡c
("U£ giv<numb”> <gŞd|sv”> <³rsÚ>.\n", 
ch
);

1319 
sv”
 = 
¬g2
 != "gold";

1320 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

1322 ià(
¬g2
.
	`em±y
()) {

1323 
	`¡c
("GivthmÚeyØwhom?\n", 
ch
);

1327 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g2
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

1328 
	`¡c
("They s“mØhavËá.\n", 
ch
);

1332 ià(
viùim
 =ğ
ch
) {

1333 
	`¡c
("IndigÇÁ, you–Èyour£làth© you dÚ'ˆÃed‡ny h–p.\n", 
ch
);

1337 ià((!
sv”
 && 
ch
->
gŞd
 < 
amouÁ
)

1338 || (
sv”
 && 
ch
->sv” < 
amouÁ
)) {

1339 
	`¡c
("You‡»n'ˆth©„ich.\n", 
ch
);

1343 ià(!
viùim
->
	`is_Åc
()) {

1344 ià(!
	`IS_IMMORTAL
(
ch
è&& 
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_LINK_DEAD
)) {

1345 
FÜm©
::
	`¥rštf
(
buf
, "$N i ŒyšgØgivª objeùØthlškd—d ch¬aù” %s.", 
viùim
->
Çme
);

1346 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_CHEAT
, 0, 
	`GET_RANK
(ch));

1347 
	`¡c
("You¸»c›Á cªnÙ„eûivobjeù šheœ cu¼’ˆ¡©e.\n", 
ch
);

1351 ià((!
sv”
 && (
	`g‘_ÿ¼y_weight
(
viùim
è+ 
	`gŞd_weight
(
amouÁ
è> 
	`ÿn_ÿ¼y_w
(victim)))

1352 || (
sv”
 && (
	`g‘_ÿ¼y_weight
(
viùim
è+ 
	`sv”_weight
(
amouÁ
è> 
	`ÿn_ÿ¼y_w
(victim)))) {

1353 
	`¡c
("They cª'ˆÿ¼yh© much weight.", 
ch
);

1358 ià(
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
ACT_IS_CHANGER
)) {

1359 
chªge
;

1360 
chªge
 = (
sv”
 ? 95 * 
amouÁ
 / 10000 : 95 *‡mount);

1362 ià(
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
ACT_IS_CHANGER
)) {

1363 
	`¡c
("You dÚ'ˆÃed mÜmÚey.\n", 
ch
);

1367 ià((!
sv”


1368 && (
	`g‘_ÿ¼y_weight
(
ch
)

1369 + 
	`gŞd_weight
(
chªge
)

1370 - 
	`sv”_weight
(
amouÁ
è> 
	`ÿn_ÿ¼y_w
(
ch
)))

1371 || (
sv”


1372 && (
	`g‘_ÿ¼y_weight
(
ch
)

1373 + 
	`sv”_weight
(
chªge
)

1374 - 
	`gŞd_weight
(
amouÁ
è> 
	`ÿn_ÿ¼y_w
(
ch
)))) {

1375 
	`¡c
("Buˆyou wouldn'ˆbabËØÿ¼yh© much chªge!\n", 
ch
);

1380 ià(
sv”
) {

1381 
ch
->
sv”
 -ğ
amouÁ
;

1382 
viùim
->
sv”
 +ğ
amouÁ
;

1385 
ch
->
gŞd
 -ğ
amouÁ
;

1386 
viùim
->
gŞd
 +ğ
amouÁ
;

1389 ià(
amouÁ
 == 1)

1390 
FÜm©
::
	`¥rštf
(
buf
, "$Àgive you oÃ % coš.", 
sv”
 ? "silver" : "gold");

1392 
FÜm©
::
	`¥rštf
(
buf
, "$Àgive you %d %s.", 
amouÁ
, 
sv”
 ? "silver" : "gold");

1394 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

1395 
FÜm©
::
	`¥rštf
(
buf
, "$n gives $N %s %s coin%s. Must be‚iceo be„ich.",

1396 
amouÁ
 == 1 ? "one" : "some",

1397 
sv”
 ? "silver" : "gold",

1398 
amouÁ
 == 1 ? "" : "s");

1399 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

1401 ià(
amouÁ
 == 1)

1402 
FÜm©
::
	`¥rštf
(
buf
, "You givÚ% cošØ$N.", 
sv”
 ? "silver" : "gold");

1404 
FÜm©
::
	`¥rštf
(
buf
, "You giv%d % tØ$N.", 
amouÁ
, 
sv”
 ? "silver" : "gold");

1406 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1407 
	`m´og_bribe_Œigg”
(
viùim
, 
ch
, 
sv”
 ? 
amouÁ
 :‡mount * 100);

1409 ià(
viùim
->
	`is_g¬bage
(è|| 
ch
->is_garbage())

1412 ià(
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
ACT_IS_CHANGER
)) {

1413 
chªge
;

1414 
chªge
 = (
sv”
 ? 95 * 
amouÁ
 / 10000 : 95 *‡mount);

1416 ià(!
sv”
 && 
chªge
 > 
viùim
->silver)

1417 
viùim
->
sv”
 +ğ
chªge
;

1419 ià(
sv”
 && 
chªge
 > 
viùim
->
gŞd
)

1420 
viùim
->
gŞd
 +ğ
chªge
;

1422 ià(!
	`ÿn_£e_ch¬
(
viùim
, 
ch
)) {

1423 
	`aù
("$Àlook ¬ound fÜ whÛv” could bsØg’”ous.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1427 ià(
chªge
 < 1) {

1428 
	`aù
("$À‹Î you 'I'm sÜry, you did‚Ù givm’oughØchªge.'", 
viùim
, 
nuÎ±r
, 
ch
, 
TO_VICT
);

1429 
ch
->
»¶y
 = 
viùim
->
Çme
;

1430 
FÜm©
::
	`¥rštf
(
buf
, "%d % %s", 
amouÁ
, 
sv”
 ? "sv”" : "gŞd", 
ch
->
Çme
);

1431 
	`do_give
(
viùim
, 
buf
);

1435 
FÜm©
::
	`¥rštf
(
buf
, "%d % %s", 
chªge
, 
sv”
 ? "gŞd" : "sv”", 
ch
->
Çme
);

1436 
	`do_give
(
viùim
, 
buf
);

1438 ià(
sv”
) {

1439 
FÜm©
::
	`¥rštf
(
buf
, "%d sv” %s", (95 * 
amouÁ
 / 100 - 
chªge
 * 100), 
ch
->
Çme
);

1440 
	`do_give
(
viùim
, 
buf
);

1443 
	`aù
("$À‹Î you 'Wh© dØyouhšk I‡m? MadoàmÚey?!'", 
viùim
, 
nuÎ±r
, 
ch
, 
TO_VICT
);

1444 
ch
->
»¶y
 = 
viùim
->
Çme
;

1451 
numb”
 = 
	`muÉ_¬gum’t
(
¬g1
, 
buf
);

1452 
¬g1
 = 
buf
;

1454 ià(
numb”
 < 0) {

1455 
	`¡c
("Iàyou wªˆmÜthª you had,ry s‹®šg!\n", 
ch
);

1459 ià(
numb”
 == 0) {

1460 
	`¡c
("You givaway 0 i‹ms,ƒndšg u°w™h wh© you had befÜe.\n", 
ch
);

1464 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g1
)è=ğ
nuÎ±r
) {

1465 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

1469 ià(
obj
->
w—r_loc
 !ğ
WEAR_NONE
) {

1470 
	`¡c
("You mu¡„emov™ fœ¡.\n", 
ch
);

1475 
İ
 = 
obj
; op; o°ğİ->
Ãxt_cÚ‹Á
) {

1476 ià(
İ
->
pIndexD©a
->
vnum
 !ğ
obj
->pIndexData->vnum)

1479 
couÁ
++;

1480 
™em_numb”
 +ğ
	`g‘_obj_numb”
(
İ
);

1481 
™em_weight
 +ğ
	`g‘_obj_weight
(
İ
);

1483 ià(!
	`ÿn_drİ_obj
(
ch
, 
İ
)) {

1484 ià(
numb”
 == 1)

1485 
	`¡c
("You cªnÙ s“mØËˆgØoà™.\n", 
ch
);

1487 
	`±c
(
ch
, "You cªnÙ s“mØËˆgØoàth% Úe.", 
	`Üdš®_¡ršg
(
couÁ
));

1492 ià(
couÁ
 >ğ
numb”
)

1496 ià(
couÁ
 < 
numb”
) {

1497 
	`±c
(
ch
, "Buˆyou oÆy hav%d oàtho£!", 
couÁ
);

1501 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g2
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

1502 
	`¡c
("They‡»‚Ù h”e.\n", 
ch
);

1506 ià(
viùim
 =ğ
ch
) {

1507 
	`¡c
("IndigÇÁ, you–Èyour£làth© you dÚ'ˆÃed‡ny h–p.\n", 
ch
);

1511 ià(!
viùim
->
	`is_Åc
(è&& !
	`IS_IMMORTAL
(
ch
è&& viùim->
pcd©a
->
¶r_æags
.
	`has
(
PLR_LINK_DEAD
)) {

1512 
FÜm©
::
	`¥rštf
(
buf
, "$N i ŒyšgØgivª objeùØthlškd—d ch¬aù” %s.", 
viùim
->
Çme
);

1513 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_CHEAT
, 0, 
	`GET_RANK
(ch));

1514 
	`¡c
("You¸»c›Á cªnÙ„eûivobjeù šheœ cu¼’ˆ¡©e.\n", 
ch
);

1518 ià(
viùim
->
	`is_Åc
(è&& viùim->
pIndexD©a
->
pShİ
 !ğ
nuÎ±r
) {

1519 
	`aù
("$N–l you 'SÜry, you'Î havtØ£Îh©.'", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1520 
ch
->
»¶y
 = 
viùim
->
Çme
;

1524 ià(!
	`ÿn_drİ_obj
(
ch
, 
obj
)) {

1525 
	`¡c
("You cª'ˆËˆgØoà™.\n", 
ch
);

1529 ià(!
	`ÿn_£e_obj
(
viùim
, 
obj
)) {

1531 ià(!(!
ch
->
	`is_Åc
(è&& 
viùim
->is_npc()

1532 && 
	`IS_SQUESTOR
(
ch
è&& ch->
pcd©a
->
sque¡obj
 !ğ
nuÎ±r
 && ch->pcd©a->
sque¡mob
 !=‚ullptr

1533 && 
obj
 =ğ
ch
->
pcd©a
->
sque¡obj
 && 
viùim
 =ğch->pcd©a->
sque¡mob
)) {

1534 
	`aù
("$N cª'ˆ£™.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1539 ià(
	`g‘_ÿ¼y_numb”
(
viùim
è+ 
™em_numb”
 > 
	`ÿn_ÿ¼y_n
(victim)) {

1540 
	`aù
("$N i ®»ady c¬ryšgoØmuch.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1544 ià(
	`g‘_ÿ¼y_weight
(
viùim
è+ 
™em_weight
 > 
	`ÿn_ÿ¼y_w
(victim)) {

1545 
	`aù
("$N buckË und”h© much weight.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1550 
İ
 = 
obj
, 
couÁ
 = 0; op; o°ğ
obj_Ãxt
) {

1551 
obj_Ãxt
 = 
İ
->
Ãxt_cÚ‹Á
;

1553 ià(
İ
->
pIndexD©a
->
vnum
 !ğ
obj
->pIndexData->vnum)

1556 
	`obj_äom_ch¬
(
İ
);

1557 
	`obj_to_ch¬
(
İ
, 
viùim
);

1558 
couÁ
++;

1560 ià(
couÁ
 >ğ
numb”
)

1564 ià(
numb”
 == 1) {

1565 
	`aù
("$Àgive $°tØ$N.", 
ch
, 
obj
, 
viùim
, 
TO_NOTVICT
);

1566 
	`aù
("$Àgive you $p.", 
ch
, 
obj
, 
viùim
, 
TO_VICT
);

1567 
	`aù
("You giv$°tØ$N.", 
ch
, 
obj
, 
viùim
, 
TO_CHAR
);

1570 
FÜm©
::
	`¥rštf
(
buf
, "$Àgive $p[%d]Ø$N.", 
numb”
);

1571 
	`aù
(
buf
, 
ch
, 
obj
, 
viùim
, 
TO_NOTVICT
);

1572 
FÜm©
::
	`¥rštf
(
buf
, "$Àgive you $p[%d].", 
numb”
);

1573 
	`aù
(
buf
, 
ch
, 
obj
, 
viùim
, 
TO_VICT
);

1574 
FÜm©
::
	`¥rštf
(
buf
, "You giv$p[%d]Ø$N.", 
numb”
);

1575 
	`aù
(
buf
, 
ch
, 
obj
, 
viùim
, 
TO_CHAR
);

1578 ià(
	`IS_SQUESTOR
(
ch
)

1579 && 
ch
->
pcd©a
->
sque¡mob
 !ğ
nuÎ±r
 && ch->pcd©a->
sque¡obj
 !=‚ullptr) {

1580 ià(
obj
 =ğ
ch
->
pcd©a
->
sque¡obj
 && 
viùim
 =ğch->pcd©a->
sque¡mob
) {

1581 
sque¡obj_to_sque¡mob
 
	`¬gs
((
Ch¬aù”
 * 
ch
, 
Objeù
 * 
obj
, Ch¬aù” * 
mob
));

1583 ià(!
ch
->
pcd©a
->
sque¡objf
) {

1584 
Loggšg
::
	`bug
("At give sqobjo sqmob without sqobj found, continuing...", 0);

1585 
ch
->
pcd©a
->
sque¡objf
 = 
Œue
;

1588 
	`sque¡obj_to_sque¡mob
(
ch
, 
obj
, 
viùim
);

1595 
	`m´og_give_Œigg”
(
viùim
, 
ch
, 
obj
);

1596 
	}
}

1599 
	$do_’v’om
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1601 
Objeù
 *
obj
;

1602 
³rûÁ
, 
skl
;

1605 ià(
¬gum’t
.
	`em±y
()) {

1606 
	`¡c
("Env’om wh© i‹m?\n", 
ch
);

1610 
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬gum’t
, ch->
ÿ¼yšg
);

1612 ià(
obj
 =ğ
nuÎ±r
) {

1613 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

1617 ià((
skl
 = 
	`g‘_skl_Ëv–
(
ch
, skl::
ty³
::
’v’om
)) < 1) {

1618 
	`¡c
("A» you c¿zy? You'd…oisÚ your£lf!\n", 
ch
);

1622 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
’v’om
))

1625 ià(
obj
->
™em_ty³
 =ğ
ITEM_FOOD
 || obj->™em_ty³ =ğ
ITEM_DRINK_CON
) {

1626 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
è|| IS_OBJ_STAT(obj, 
ITEM_BURN_PROOF
)) {

1627 
	`aù
("You faØpoisÚ $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1631 ià(
	`numb”_³rûÁ
(è< 
skl
) {

1632 
	`aù
("$ÀŒ—t $°w™h d—dly…oisÚ.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1633 
	`aù
("You»© $°w™h d—dly…oisÚ.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1635 ià(!
obj
->
v®ue
[3]) {

1636 
obj
->
v®ue
[3] = 1;

1637 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
’v’om
, 
Œue
, 4);

1640 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
’v’om
).
b—ts
);

1644 
	`aù
("You faØpoisÚ $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1646 ià(!
obj
->
v®ue
[3])

1647 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
’v’om
, 
çl£
, 4);

1649 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
’v’om
).
b—ts
);

1653 ià(
obj
->
™em_ty³
 =ğ
ITEM_WEAPON
) {

1654 ià(
obj
->
v®ue
[3] < 0

1655 || 
©ck_bË
[
obj
->
v®ue
[3]].
damage
 =ğ
DAM_BASH
) {

1656 
	`¡c
("You cª oÆyƒnv’omƒdged w—pÚs.\n", 
ch
);

1660 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
poisÚ
)) {

1661 
	`aù
("$°i ®»adyƒnv’omed.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1665 
³rûÁ
 = 
	`numb”_³rûÁ
();

1667 ià(
³rûÁ
 < 
skl
) {

1668 
afãù
::
Afãù
 
af
;

1669 
af
.
wh”e
 = 
TO_WEAPON
;

1670 
af
.
ty³
 = 
afãù
::ty³::
poisÚ
;

1671 
af
.
Ëv–
 = 
ch
->level;

1672 
af
.
du¿tiÚ
 = 
ch
->
Ëv–
 * 5;

1673 
af
.
loÿtiÚ
 = 0;

1674 
af
.
modif›r
 = 0;

1675 
af
.
	`b™veùÜ
(0);

1676 
af
.
evŞutiÚ
 = 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
’v’om
);

1677 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

1678 
	`aù
("$Àcßt $°w™h d—dly v’om.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1679 
	`aù
("You cßˆ$°w™h v’om.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1680 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
’v’om
, 
Œue
, 3);

1681 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
’v’om
).
b—ts
);

1685 
	`aù
("You faØ’v’om $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1686 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
’v’om
, 
çl£
, 3);

1687 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
’v’om
).
b—ts
);

1692 
	`aù
("You cª'ˆpoisÚ $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1694 
	}
}

1696 
	$do_fœebudšg
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1698 
Objeù
 *
tÜch
;

1700 ià(
	`g‘_ÿ¼y_numb”
(
ch
è+ 1 > 
	`ÿn_ÿ¼y_n
(ch)) {

1701 
	`aù
("You cª'ˆÿ¼y‡ny mÜ™ems.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

1705 ià(
	`g‘_ÿ¼y_weight
(
ch
è>ğ
	`ÿn_ÿ¼y_w
(ch)) {

1706 
	`aù
("You cª'ˆÿ¼y‡ny mÜweight.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

1710 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
fœebudšg
)) {

1711 
	`¡c
("You†ackhknowËdg™ake tØmak¨tÜch!\n", 
ch
);

1715 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
fœebudšg
))

1718 ià((
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
c™y
)

1719 || (
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
w©”_swim
)

1720 || (
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
w©”_noswim
)

1721 || (
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
de£¹
)

1722 || (
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
aœ
)) {

1723 
	`¡c
("You cªnÙ fšd‡nywig tØmak¨tÜch.\n", 
ch
);

1727 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
fœebudšg
).
b—ts
);

1729 ià(
	`numb”_³rûÁ
(è> 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
fœebudšg
)) {

1730 
	`¡c
("You buº your£lf.\n", 
ch
);

1731 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
fœebudšg
, 
çl£
, 8);

1735 
tÜch
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_TORCH
), 0);

1737 ià(! 
tÜch
) {

1738 
Loggšg
::
	`bug
("Error creating‡orch in firebuilding.", 0);

1739 
	`¡c
("You w”uÇbËØmak¨tÜch.\n", 
ch
);

1743 
tÜch
->
co¡
 = 0;

1744 
	`obj_to_ch¬
(
tÜch
, 
ch
);

1745 
	`aù
("$Àg©h” somtwig ªd c»©e $p.", 
ch
, 
tÜch
, 
nuÎ±r
, 
TO_ROOM
);

1746 
	`aù
("You g©h” somtwig ªd c»©$p.", 
ch
, 
tÜch
, 
nuÎ±r
, 
TO_CHAR
);

1747 
tÜch
->
v®ue
[2] = -1;

1748 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
fœebudšg
, 
Œue
, 8);

1750 
	}
}

1752 
	$do_fl
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1754 
buf
[
MAX_STRING_LENGTH
];

1755 
Objeù
 *
obj
;

1756 
Objeù
 *
fœ¡_fouÁaš
 = 
nuÎ±r
;

1757 
Objeù
 *
wª‹d_fouÁaš
 = 
nuÎ±r
;

1759 ià(
¬gum’t
.
	`em±y
()) {

1760 
	`¡c
("FÈwh©?\n", 
ch
);

1764 
SŒšg
 
¬g
;

1765 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1767 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

1768 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

1772 ià(
obj
->
™em_ty³
 !ğ
ITEM_DRINK_CON
) {

1773 
	`¡c
("You cª'ˆfÈth©.\n", 
ch
);

1777 
fœ¡_fouÁaš
 = 
ch
->
š_room
->
cÚ‹Ás
; fœ¡_fouÁaš !ğ
nuÎ±r
;

1778 
fœ¡_fouÁaš
 = fœ¡_fouÁaš->
Ãxt_cÚ‹Á
)

1779 ià(
fœ¡_fouÁaš
->
™em_ty³
 =ğ
ITEM_FOUNTAIN
)

1782 ià(
fœ¡_fouÁaš
 =ğ
nuÎ±r
) {

1783 
	`¡c
("From wh©?\n", 
ch
);

1787 
wª‹d_fouÁaš
 = 
fœ¡_fouÁaš
;

1789 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1791 ià(!
¬g
.
	`em±y
()) {

1792 ià(
¬g
.
	`is_´efix_of
("from"))

1793 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1795 ià(!
¬g
.
	`em±y
()) {

1796 
wª‹d_fouÁaš
 = 
	`g‘_obj_h”e
(
ch
, 
¬g
);

1798 ià(
wª‹d_fouÁaš
 =ğ
nuÎ±r
) {

1799 
	`¡c
("You dÚ'ˆ£th© h”e.\n", 
ch
);

1803 ià(
wª‹d_fouÁaš
->
™em_ty³
 !ğ
ITEM_FOUNTAIN
) {

1804 
	`¡c
("Th©' nÙ‡ fouÁaš.\n", 
ch
);

1810 ià(
obj
->
v®ue
[1] !ğ0 && obj->v®ue[2] !ğ
wª‹d_fouÁaš
->value[2]) {

1811 
	`¡c
("Th”i ®»ady‡nÙh”†iquid iÀ™.\n", 
ch
);

1815 ià(
obj
->
v®ue
[1] >= obj->value[0]) {

1816 
	`¡c
("You¸cÚš” brim ov” w™h†iquid.\n", 
ch
);

1820 
FÜm©
::
	`¥rštf
(
buf
, "You fill $p with %s from $P.",

1821 
liq_bË
[
wª‹d_fouÁaš
->
v®ue
[2]].
Çme
);

1822 
	`aù
(
buf
, 
ch
, 
obj
, 
wª‹d_fouÁaš
, 
TO_CHAR
);

1823 
FÜm©
::
	`¥rštf
(
buf
, "$n fills $p with %s from $P.",

1824 
liq_bË
[
wª‹d_fouÁaš
->
v®ue
[2]].
Çme
);

1825 
	`aù
(
buf
, 
ch
, 
obj
, 
wª‹d_fouÁaš
, 
TO_ROOM
);

1826 
obj
->
v®ue
[2] = 
wª‹d_fouÁaš
->value[2];

1827 
obj
->
v®ue
[1] = obj->value[0];

1828 
obj
->
v®ue
[3] = 
wª‹d_fouÁaš
->value[3];

1829 
	}
}

1831 
	$do_pour
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1833 
buf
[
MAX_STRING_LENGTH
];

1834 
Objeù
 *
out
, *
š
;

1835 
Ch¬aù”
 *
vch
 = 
nuÎ±r
;

1836 
amouÁ
;

1838 
SŒšg
 
¬g
;

1839 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1841 ià(
¬g
.
	`em±y
(è|| 
¬gum’t
.empty()) {

1842 
	`¡c
("Pou¸wh© iÁØwh©?\n", 
ch
);

1846 ià((
out
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

1847 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

1851 ià(
out
->
™em_ty³
 !ğ
ITEM_DRINK_CON
) {

1852 
	`¡c
("Th©' nÙ‡ dršk cÚš”.\n", 
ch
);

1856 ià(
¬gum’t
 == "out") {

1857 ià(
out
->
v®ue
[1] == 0) {

1858 
	`¡c
("It' ®»adyƒm±y.\n", 
ch
);

1862 
out
->
v®ue
[1] = 0;

1863 
out
->
v®ue
[3] = 0;

1864 
FÜm©
::
	`¥rštf
(
buf
, "You invert $p, spilling %s‡ll overhe ground.",

1865 
liq_bË
[
out
->
v®ue
[2]].
Çme
);

1866 
	`aù
(
buf
, 
ch
, 
out
, 
nuÎ±r
, 
TO_CHAR
);

1867 
FÜm©
::
	`¥rštf
(
buf
, "$n inverts $p, spilling %s‡ll overhe ground.",

1868 
liq_bË
[
out
->
v®ue
[2]].
Çme
);

1869 
	`aù
(
buf
, 
ch
, 
out
, 
nuÎ±r
, 
TO_ROOM
);

1873 ià((
š
 = 
	`g‘_obj_h”e
(
ch
, 
¬gum’t
)è=ğ
nuÎ±r
) {

1874 
vch
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬gum’t
, 
VIS_CHAR
);

1876 ià(
vch
 =ğ
nuÎ±r
) {

1877 
	`¡c
("Pou¸štØwh©?\n", 
ch
);

1881 
š
 = 
	`g‘_eq_ch¬
(
vch
, 
WEAR_HOLD
);

1883 ià(
š
 =ğ
nuÎ±r
) {

1884 
	`¡c
("They‡»n'ˆhŞdšg‡nythšg.", 
ch
);

1889 ià(
š
->
™em_ty³
 !ğ
ITEM_DRINK_CON
) {

1890 
	`¡c
("You cª oÆy…ou¸štØÙh” dršk cÚš”s.\n", 
ch
);

1894 ià(
š
 =ğ
out
) {

1895 
	`¡c
("You cªnÙ chªgthÏw oàphysics!\n", 
ch
);

1899 ià(
š
->
v®ue
[1] !ğ0 && in->v®ue[2] !ğ
out
->value[2]) {

1900 
	`¡c
("They dÚ'ˆhŞdh§mliquid.\n", 
ch
);

1904 ià(
out
->
v®ue
[1] == 0) {

1905 
	`aù
("Th”e' nÙhšg iÀ$°tØpour.", 
ch
, 
out
, 
nuÎ±r
, 
TO_CHAR
);

1909 ià(
š
->
v®ue
[1] >= in->value[0]) {

1910 
	`aù
("$°i ®»ady fËdØthtİ.", 
ch
, 
š
, 
nuÎ±r
, 
TO_CHAR
);

1914 
amouÁ
 = 
¡d
::
	`mš
(
out
->
v®ue
[1], 
š
->value[0] - in->value[1]);

1915 
š
->
v®ue
[1] +ğ
amouÁ
;

1916 
out
->
v®ue
[1] -ğ
amouÁ
;

1917 
š
->
v®ue
[2] = 
out
->value[2];

1918 
š
->
v®ue
[3] = 
out
->value[3];

1920 ià(
vch
 =ğ
nuÎ±r
) {

1921 
FÜm©
::
	`¥rštf
(
buf
, "You…our %s from $p into $P.",

1922 
liq_bË
[
out
->
v®ue
[2]].
Çme
);

1923 
	`aù
(
buf
, 
ch
, 
out
, 
š
, 
TO_CHAR
);

1924 
FÜm©
::
	`¥rštf
(
buf
, "$n…ours %s from $p into $P.",

1925 
liq_bË
[
out
->
v®ue
[2]].
Çme
);

1926 
	`aù
(
buf
, 
ch
, 
out
, 
š
, 
TO_ROOM
);

1929 
FÜm©
::
	`¥rštf
(
buf
, "You…our some %s for $N.",

1930 
liq_bË
[
out
->
v®ue
[2]].
Çme
);

1931 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
vch
, 
TO_CHAR
);

1932 
FÜm©
::
	`¥rštf
(
buf
, "$n…ours you some %s.",

1933 
liq_bË
[
out
->
v®ue
[2]].
Çme
);

1934 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
vch
, 
TO_VICT
);

1935 
FÜm©
::
	`¥rštf
(
buf
, "$n…ours some %s for $N.",

1936 
liq_bË
[
out
->
v®ue
[2]].
Çme
);

1937 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
vch
, 
TO_NOTVICT
);

1939 
	}
}

1941 
	$do_dršk
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1943 
Objeù
 *
obj
;

1944 
amouÁ
, 
liquid
, 
liqv®ue
;

1946 
SŒšg
 
¬g
;

1947 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1949 ià(!
¬g
.
	`em±y
(è&& !
¬gum’t
.empty() &&‡rg == "from")

1950 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1952 ià(
¬g
.
	`em±y
()) {

1953 
obj
 = 
ch
->
š_room
->
cÚ‹Ás
; obj; obj = obj->
Ãxt_cÚ‹Á
)

1954 ià(
obj
->
™em_ty³
 =ğ
ITEM_FOUNTAIN
)

1957 ià(
obj
 =ğ
nuÎ±r
)

1958 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
)

1959 ià(
obj
->
™em_ty³
 =ğ
ITEM_DRINK_CON
)

1962 ià(
obj
 =ğ
nuÎ±r
) {

1963 
	`¡c
("Dršk from wh©?\n", 
ch
);

1968 ià((
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

1969 
	`¡c
("You cª'ˆfšd it.\n", 
ch
);

1974 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
cÚd™iÚ
[
COND_DRUNK
] > 10) {

1975 
	`¡c
("ThcÚš” fa tØ»ach you¸mouth. *Hic*\n", 
ch
);

1979 
obj
->
™em_ty³
) {

1981 
	`¡c
("You cª'ˆdršk fromh©.\n", 
ch
);

1984 
ITEM_FOUNTAIN
:

1985 ià((
liquid
 = 
obj
->
v®ue
[2]) < 0) {

1986 
Loggšg
::
	`bug
("Do_dršk: bad†iquid‚umb” %d.", 
liquid
);

1987 
liquid
 = 
obj
->
v®ue
[2] = 0;

1990 
amouÁ
 = 
liq_bË
[
liquid
].
afãù
[4] * 3;

1993 
ITEM_DRINK_CON
:

1994 ià(
obj
->
v®ue
[1] <= 0) {

1995 
	`¡c
("You¸cÚš” i em±y.\n", 
ch
);

1999 ià((
liquid
 = 
obj
->
v®ue
[2]) < 0) {

2000 
Loggšg
::
	`bug
("Do_dršk: bad†iquid‚umb” %d.", 
liquid
);

2001 
liquid
 = 
obj
->
v®ue
[2] = 0;

2004 
amouÁ
 = 
liq_bË
[
liquid
].
afãù
[4];

2005 
amouÁ
 = 
¡d
::
	`mš
×mouÁ, 
obj
->
v®ue
[1].
	`v®ue
());

2009 ià(!
ch
->
	`is_Åc
(è&& !
	`IS_IMMORTAL
(ch)

2010 && 
ch
->
pcd©a
->
cÚd™iÚ
[
COND_FULL
] > 45) {

2011 
	`¡c
("You'»oØfuÎØdršk mÜe.\n", 
ch
);

2015 
	`aù
("$Àdršk $T from $p.", 
ch
, 
obj
, 
liq_bË
[
liquid
].
Çme
, 
TO_ROOM
);

2016 
	`aù
("You dršk $T from $p.", 
ch
, 
obj
, 
liq_bË
[
liquid
].
Çme
, 
TO_CHAR
);

2017 
	`gaš_cÚd™iÚ
(
ch
, 
COND_DRUNK
, 
amouÁ
 * 
liq_bË
[
liquid
].
afãù
[COND_DRUNK] / 36);

2018 
	`gaš_cÚd™iÚ
(
ch
, 
COND_FULL
, 
amouÁ
 * 
liq_bË
[
liquid
].
afãù
[COND_FULL] / 4);

2019 
	`gaš_cÚd™iÚ
(
ch
, 
COND_HUNGER
, 
amouÁ
 * 
liq_bË
[
liquid
].
afãù
[COND_HUNGER] / 2);

2021 ià(
ch
->
¿û
 =ğ6 && 
liquid
 =ğ
	`liq_lookup
("blood"))

2022 
liqv®ue
 = 10;

2024 
liqv®ue
 = 
liq_bË
[
liquid
].
afãù
[
COND_THIRST
];

2026 
	`gaš_cÚd™iÚ
(
ch
, 
COND_THIRST
, 
amouÁ
 * 
liqv®ue
 / 10);

2028 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
cÚd™iÚ
[
COND_DRUNK
] > 10)

2029 
	`¡c
("You'»ß¡ed. Throom begš tØ¥š!\n", 
ch
);

2031 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
cÚd™iÚ
[
COND_FULL
] > 40)

2032 
	`¡c
("You‡» fuÎ.\n", 
ch
);

2034 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
cÚd™iÚ
[
COND_THIRST
] > 40)

2035 
	`¡c
("You¸thœ¡ i qu’ched.\n", 
ch
);

2037 ià(
obj
->
v®ue
[3] != 0) {

2039 
	`aù
("$Àtuº six shade oàg»’‡nd cŞÏp£s.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2040 
	`¡c
("Youuº six shade oàg»’‡nd cŞÏp£.\n", 
ch
);

2042 
afãù
::
	`add_ty³_to_ch¬
(
ch
,

2043 
afãù
::
ty³
::
poisÚ
,

2044 
	`numb”_fuzzy
(
amouÁ
),

2045 
amouÁ
 * 3,

2047 
çl£


2051 ià(
obj
->
v®ue
[0] > 0) {

2052 
obj
->
v®ue
[1] = 
¡d
::
	`max
(()obj->v®ue[1] - 
amouÁ
, 0);

2055 ià(
obj
->
v®ue
[1] == 0)

2056 
obj
->
v®ue
[3] = 0;

2058 
	}
}

2060 
	$do_—t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2062 
Objeù
 *
obj
, *
İ
, *
obj_Ãxt
;

2063 
numb”
, 
couÁ
;

2064 
boŞ
 
fFuÎ
 = 
çl£
, 
fNoLÚg”Hungry
 = f®£, 
fPoisÚed
 = f®£, 
found
 = false;

2065 
Objeù
 *
to_exŒaù
 = 
nuÎ±r
;

2067 
SŒšg
 
buf
, 
¬g
;

2068 
numb”
 = 
	`muÉ_¬gum’t
(
¬gum’t
, 
buf
);

2069 
	`Úe_¬gum’t
(
buf
, 
¬g
);

2071 ià(
numb”
 < 0) {

2072 
	`¡c
("Niûry, buˆth©' nÙhwayØd›t.\n", 
ch
);

2076 ià(
numb”
 == 0) {

2077 
	`¡c
("OK, youƒ©‚Ùhšg. You¸wai¡lš¦im ¦ighy.\n", 
ch
);

2081 ià(
¬g
.
	`em±y
()) {

2082 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
) {

2083 ià(
obj
->
™em_ty³
 =ğ
ITEM_FOOD
) {

2084 
found
 = 
Œue
;

2089 ià(!
found
) {

2090 
	`¡c
("E© wh©?\n", 
ch
);

2094 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

2095 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

2099 ià(!
	`IS_IMMORTAL
(
ch
)) {

2100 ià(
obj
->
™em_ty³
 !ğ
ITEM_FOOD
 && obj->™em_ty³ !ğ
ITEM_PILL
) {

2101 
	`¡c
("You cª'ˆ—ˆth©!\n", 
ch
);

2105 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
cÚd™iÚ
[
COND_FULL
] > 40) {

2106 
	`¡c
("You‡»oØfuÎØ—ˆmÜe.\n", 
ch
);

2112 
couÁ
 = 0;

2114 
İ
 = 
obj
; op; o°ğİ->
Ãxt_cÚ‹Á
) {

2115 ià(
İ
->
pIndexD©a
->
vnum
 !ğ
obj
->pIndexData->vnum)

2118 
couÁ
++;

2120 ià(
couÁ
 >ğ
numb”
)

2124 
FÜm©
::
	`¥rštf
(
buf
, "%d", 
couÁ
);

2126 ià(
couÁ
 < 
numb”
) {

2127 
	`aù
("Buˆyou oÆy hav$T oàtho£!", 
ch
, 
nuÎ±r
, 
buf
, 
TO_CHAR
);

2131 ià(
numb”
 > 10) {

2132 
	`¡c
("You couldn'ˆpossibly f™ mÜthª’ oàtho£ iÀyou¸mouth.\n", 
ch
);

2137 cÚ¡ 
Vnum
& 
obj_vnum
 = 
obj
->
pIndexD©a
->
vnum
;

2138 
couÁ
 = 0;

2140 
İ
 = 
obj
; o°&& !
fFuÎ
; o°ğ
obj_Ãxt
) {

2141 
obj_Ãxt
 = 
İ
->
Ãxt_cÚ‹Á
;

2143 ià(
İ
->
pIndexD©a
->
vnum
 !ğ
obj_vnum
)

2146 ià(
İ
->
™em_ty³
 =ğ
ITEM_PILL
) {

2147 ià(
ch
->
Ëv–
 < 
İ
->Ëv– && !
	`IS_IMMORTAL
(ch)) {

2148 
	`¡c
("Thi pÈi toØpow”fuÈfÜ youØ—t.\n", 
ch
);

2152 
	`aù
("$À—t $p.", 
ch
, 
İ
, 
nuÎ±r
, 
TO_ROOM
);

2153 
	`aù
("Youƒ© $p.", 
ch
, 
İ
, 
nuÎ±r
, 
TO_CHAR
);

2154 
	`obj_ÿ¡_¥–l
(
skl
::
	`äom_št
(
İ
->
v®ue
[1]), op->v®ue[0], 
ch
, ch, 
nuÎ±r
);

2155 
	`obj_ÿ¡_¥–l
(
skl
::
	`äom_št
(
İ
->
v®ue
[2]), op->v®ue[0], 
ch
, ch, 
nuÎ±r
);

2156 
	`obj_ÿ¡_¥–l
(
skl
::
	`äom_št
(
İ
->
v®ue
[3]), op->v®ue[0], 
ch
, ch, 
nuÎ±r
);

2157 
	`obj_ÿ¡_¥–l
(
skl
::
	`äom_št
(
İ
->
v®ue
[4]), op->v®ue[0], 
ch
, ch, 
nuÎ±r
);

2159 ià(
İ
->
™em_ty³
 =ğ
ITEM_FOOD
) {

2160 ià(
ch
->
Ëv–
 < 
İ
->Ëv– && !
	`IS_IMMORTAL
(ch)) {

2161 
	`¡c
("Thi food i toØrich fÜ youØ—t.\n", 
ch
);

2165 ià(
İ
->
v®ue
[3] != 0) {

2167 
afãù
::
	`add_ty³_to_ch¬
(
ch
,

2168 
afãù
::
ty³
::
poisÚ
,

2169 
	`numb”_fuzzy
(
İ
->
Ëv–
),

2170 
İ
->
Ëv–
,

2172 
çl£


2175 
fPoisÚed
 = 
Œue
;

2180 ià(!
ch
->
	`is_Åc
()) {

2181 
cÚd™iÚ
;

2182 
cÚd™iÚ
 = 
ch
->
pcd©a
->cÚd™iÚ[
COND_HUNGER
];

2183 
	`gaš_cÚd™iÚ
(
ch
, 
COND_FULL
, 
İ
->
™em_ty³
 =ğ
ITEM_PILL
 ? 4 : 
obj
->
v®ue
[0]);

2184 
	`gaš_cÚd™iÚ
(
ch
, 
COND_HUNGER
, 
İ
->
™em_ty³
 =ğ
ITEM_PILL
 ? 2 : 
obj
->
v®ue
[1]);

2186 ià(
cÚd™iÚ
 =ğ0 && 
ch
->
pcd©a
->cÚd™iÚ[
COND_HUNGER
] > 0)

2187 
fNoLÚg”Hungry
 = 
Œue
;

2188 ià(
ch
->
pcd©a
->
cÚd™iÚ
[
COND_FULL
] > 40)

2189 
fFuÎ
 = 
Œue
;

2193 ià(
to_exŒaù
 !ğ
nuÎ±r
)

2194 
	`exŒaù_obj
(
to_exŒaù
);

2196 
to_exŒaù
 = 
İ
;

2198 ià(++
couÁ
 >ğ
numb”
)

2202 ià(
couÁ
 == 1)

2203 
buf
.
	`”a£
();

2205 
FÜm©
::
	`¥rštf
(
buf
, "[%d]", 
couÁ
);

2207 ià(
obj
->
™em_ty³
 !ğ
ITEM_PILL
) {

2208 
	`aù
("$À—t $p$T.", 
ch
, 
to_exŒaù
, 
buf
, 
TO_ROOM
);

2209 
	`aù
("Youƒ© $p$T.", 
ch
, 
to_exŒaù
, 
buf
, 
TO_CHAR
);

2212 ià(
fNoLÚg”Hungry
)

2213 
	`¡c
("You‡»‚ØlÚg” hungry.\n", 
ch
);

2215 ià(
fFuÎ
 && !
	`IS_IMMORTAL
(
ch
))

2216 
	`¡c
("You‡» fuÎ.\n", 
ch
);

2218 ià(
fPoisÚed
) {

2219 
	`aù
("$Àtuº six shade oàg»’‡nd cŞÏp£s.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2220 
	`¡c
("Youuº six shade oàg»’‡nd cŞÏp£.\n", 
ch
);

2223 ià(
to_exŒaù
 !ğ
nuÎ±r
)

2224 
	`exŒaù_obj
(
to_exŒaù
);

2225 
	}
}

2230 
boŞ
 
	$»move_obj
(
Ch¬aù”
 *
ch
, 
iW—r
, 
boŞ
 
fR•Ïû
)

2232 
Objeù
 *
obj
;

2234 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
iW—r
)è=ğ
nuÎ±r
)

2235  
Œue
;

2237 ià(!
fR•Ïû
)

2238  
çl£
;

2240 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_NOREMOVE
)) {

2241 
	`aù
("You cª'ˆ£emØ»mov$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2242  
çl£
;

2245 
	`uÃqu_ch¬
(
ch
, 
obj
);

2246 
	`aù
("$À¡İ usšg $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2247 
	`aù
("You stİ usšg $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2248  
Œue
;

2249 
	}
}

2256 
	$w—r_obj
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, 
boŞ
 
fR•Ïû
)

2259 ià(!
	`şª_eq_ok
(
ch
, 
obj
, "equip yourself with"))

2263 ià(!
	`³rs_eq_ok
(
ch
, 
obj
, "equip yourself with"))

2266 ià(!
	`IS_IMMORTAL
(
ch
)) {

2267 ià(
obj
->
Ëv–
 > 
	`g‘_u§bË_Ëv–
(
ch
)) {

2268 ià(
obj
->
Ëv–
 < 
LEVEL_IMMORTAL
) {

2269 
	`±c
(
ch
, "You must be†evel %d(%d)o usehis object.\n",

2270 
ch
->
Ëv–
 + (
obj
->Ëv– - 
	`g‘_u§bË_Ëv–
(ch)), obj->level);

2271 
	`aù
("$ÀŒ› tØu£ $p, buˆi toØšex³r›nûd.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2275 
	`¡c
("Thi ™em mu¡ blow”ed fÜ mÜÈu£.\n", 
ch
);

2276 
	`aù
("$ÀŒ› tØu£ $p, buˆi toØboundØthmÜÈ¶ªe.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2283 ià(!
	`IS_IMMORTAL
(
ch
)

2284 && 
obj
->
pIndexD©a
->
gud
 !ğ
Gud
::
nÚe


2285 && 
obj
->
pIndexD©a
->
gud
 !ğ
ch
->guild){

2286 
	`¡c
("Thi ™em cªnÙ bu£d by you¸şass.\n", 
ch
);

2287 
	`aù
("$ÀŒ› tØu£ $p, buˆi nÙhcÜ»ù cÏss.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2292 ià(!
	`IS_IMMORTAL
(
ch
)) {

2293 ià((
	`IS_OBJ_STAT
(
obj
, 
ITEM_ANTI_EVIL
è&& 
	`IS_EVIL
(
ch
))

2294 || (
	`IS_OBJ_STAT
(
obj
, 
ITEM_ANTI_GOOD
è&& 
	`IS_GOOD
(
ch
))

2295 || (
	`IS_OBJ_STAT
(
obj
, 
ITEM_ANTI_NEUTRAL
è&& 
	`IS_NEUTRAL
(
ch
))) {

2296 
	`aù
("You‡» z­³d by $°ªd drİ it.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2297 
	`aù
("$Ài z­³d by $°ªd drİ ™.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2298 
	`obj_äom_ch¬
(
obj
);

2299 
	`obj_to_room
(
obj
, 
ch
->
š_room
);

2304 ià(
obj
->
™em_ty³
 =ğ
ITEM_WEDDINGRING
) {

2305 ià(!
	`»move_obj
(
ch
, 
WEAR_WEDDINGRING
, 
fR•Ïû
))

2308 
	`aù
("$Àw—r $°Ú $ ršgfšg”.", 
ch
, 
obj
, 
nuÎ±r
 , 
TO_ROOM
);

2309 
	`aù
("You w—¸$°Ú you¸ršgfšg”.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2310 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_WEDDINGRING
);

2314 ià(
obj
->
™em_ty³
 =ğ
ITEM_LIGHT
) {

2315 ià(!
	`»move_obj
(
ch
, 
WEAR_LIGHT
, 
fR•Ïû
))

2318 
	`aù
("$Àlight $p{x‡nd hŞd ™.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2319 
	`aù
("You†ighˆ$p{x‡nd hŞd it.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2320 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_LIGHT
);

2324 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WEAR_FINGER
)) {

2325 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_FINGER_L
è!ğ
nuÎ±r


2326 && 
	`g‘_eq_ch¬
(
ch
, 
WEAR_FINGER_R
è!ğ
nuÎ±r


2327 && !
	`»move_obj
(
ch
, 
WEAR_FINGER_L
, 
fR•Ïû
)

2328 && !
	`»move_obj
(
ch
, 
WEAR_FINGER_R
, 
fR•Ïû
))

2331 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_FINGER_L
è=ğ
nuÎ±r
) {

2332 
	`aù
("$Àw—r $p{x oÀ$ Ëá fšg”.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2333 
	`aù
("You w—¸$p{x oÀyou¸Ëá fšg”.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2334 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_FINGER_L
);

2338 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_FINGER_R
è=ğ
nuÎ±r
) {

2339 
	`aù
("$Àw—r $p{x oÀ$ righˆfšg”.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2340 
	`aù
("You w—¸$p{x oÀyou¸righˆfšg”.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2341 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_FINGER_R
);

2345 
Loggšg
::
	`bug
("Wear_obj:‚o free finger.", 0);

2346 
	`¡c
("You‡Ì—dy w—¸twØršgs.\n", 
ch
);

2350 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WEAR_NECK
)) {

2351 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_NECK_1
è!ğ
nuÎ±r


2352 && 
	`g‘_eq_ch¬
(
ch
, 
WEAR_NECK_2
è!ğ
nuÎ±r


2353 && !
	`»move_obj
(
ch
, 
WEAR_NECK_1
, 
fR•Ïû
)

2354 && !
	`»move_obj
(
ch
, 
WEAR_NECK_2
, 
fR•Ïû
))

2357 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_NECK_1
è=ğ
nuÎ±r
) {

2358 
	`aù
("$Àw—r $p{x‡round $ Ãck.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2359 
	`aù
("You w—¸$p{x‡round you¸Ãck.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2360 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_NECK_1
);

2364 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_NECK_2
è=ğ
nuÎ±r
) {

2365 
	`aù
("$Àw—r $p{x‡round $ Ãck.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2366 
	`aù
("You w—¸$p{x‡round you¸Ãck.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2367 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_NECK_2
);

2371 
Loggšg
::
	`bug
("Wear_obj:‚o free‚eck.", 0);

2372 
	`¡c
("You‡Ì—dy w—¸twØÃck i‹ms.\n", 
ch
);

2376 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WEAR_BODY
)) {

2377 ià(!
	`»move_obj
(
ch
, 
WEAR_BODY
, 
fR•Ïû
))

2380 
	`aù
("$Àw—r $p{x oÀ$ tÜso.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2381 
	`aù
("You w—¸$p{x oÀyou¸tÜso.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2382 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_BODY
);

2386 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WEAR_HEAD
)) {

2387 ià(!
	`»move_obj
(
ch
, 
WEAR_HEAD
, 
fR•Ïû
))

2390 
	`aù
("$Àw—r $p{x oÀ$ h—d.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2391 
	`aù
("You w—¸$p{x oÀyou¸h—d.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2392 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_HEAD
);

2396 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WEAR_LEGS
)) {

2397 ià(!
	`»move_obj
(
ch
, 
WEAR_LEGS
, 
fR•Ïû
))

2400 
	`aù
("$Àw—r $p{x oÀ$ Ëgs.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2401 
	`aù
("You w—¸$p{x oÀyou¸Ëgs.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2402 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_LEGS
);

2406 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WEAR_FEET
)) {

2407 ià(!
	`»move_obj
(
ch
, 
WEAR_FEET
, 
fR•Ïû
))

2410 
	`aù
("$Àw—r $p{x oÀ$ ã‘.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2411 
	`aù
("You w—¸$p{x oÀyou¸ã‘.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2412 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_FEET
);

2416 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WEAR_HANDS
)) {

2417 ià(!
	`»move_obj
(
ch
, 
WEAR_HANDS
, 
fR•Ïû
))

2420 
	`aù
("$Àw—r $p{x oÀ$ hªds.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2421 
	`aù
("You w—¸$p{x oÀyou¸hªds.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2422 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_HANDS
);

2426 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WEAR_ARMS
)) {

2427 ià(!
	`»move_obj
(
ch
, 
WEAR_ARMS
, 
fR•Ïû
))

2430 
	`aù
("$Àw—r $p{x oÀ$ ¬ms.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2431 
	`aù
("You w—¸$p{x oÀyou¸¬ms.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2432 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_ARMS
);

2436 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WEAR_ABOUT
)) {

2437 ià(!
	`»move_obj
(
ch
, 
WEAR_ABOUT
, 
fR•Ïû
))

2440 
	`aù
("$Àw—r $p{x‡bouˆ$ body.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2441 
	`aù
("You w—¸$p{x‡bouˆyou¸body.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2442 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_ABOUT
);

2446 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WEAR_WAIST
)) {

2447 ià(!
	`»move_obj
(
ch
, 
WEAR_WAIST
, 
fR•Ïû
))

2450 
	`aù
("$Àw—r $p{x‡bouˆ$ wai¡.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2451 
	`aù
("You w—¸$p{x‡bouˆyou¸wai¡.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2452 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_WAIST
);

2456 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WEAR_WRIST
)) {

2457 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_WRIST_L
è!ğ
nuÎ±r


2458 && 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WRIST_R
è!ğ
nuÎ±r


2459 && !
	`»move_obj
(
ch
, 
WEAR_WRIST_L
, 
fR•Ïû
)

2460 && !
	`»move_obj
(
ch
, 
WEAR_WRIST_R
, 
fR•Ïû
))

2463 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_WRIST_L
è=ğ
nuÎ±r
) {

2464 
	`aù
("$n wears $p{x‡round $s†eft wrist.",

2465 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2466 
	`aù
("You wear $p{x‡round your†eft wrist.",

2467 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2468 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_WRIST_L
);

2472 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_WRIST_R
è=ğ
nuÎ±r
) {

2473 
	`aù
("$n wears $p{x‡round $s„ight wrist.",

2474 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2475 
	`aù
("You wear $p{x‡round your„ight wrist.",

2476 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2477 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_WRIST_R
);

2481 
Loggšg
::
	`bug
("Wear_obj:‚o free wrist.", 0);

2482 
	`¡c
("You‡Ì—dy w—¸twØwri¡ i‹ms.\n", 
ch
);

2486 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WEAR_SHIELD
)) {

2487 
Objeù
 *
w—pÚ
;

2489 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_SECONDARY
è!ğ
nuÎ±r
 && !
	`IS_IMMORTAL
(ch)) {

2490 
	`¡c
("You cªnÙ u£‡ sh›ld whusšgwØw—pÚs.\n", 
ch
);

2494 ià(!
	`»move_obj
(
ch
, 
WEAR_SHIELD
, 
fR•Ïû
))

2497 
w—pÚ
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
);

2499 ià(
w—pÚ
 !ğ
nuÎ±r
 && 
ch
->
size
 < 
SIZE_LARGE


2500 && 
afãù
::
	`exi¡s_Ú_obj
(
w—pÚ
,‡fãù::
ty³
::
w—pÚ_two_hªds
)) {

2501 
	`¡c
("You‚“d‡nÙh” hªd f»tØdØth©.\n", 
ch
);

2505 
	`aù
("$Àw—r $p{x‡ ¨sh›ld.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2506 
	`aù
("You w—¸$p{x‡ ¨sh›ld.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2507 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_SHIELD
);

2511 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WIELD
)) {

2512 
skl
::
ty³
 
¢
;

2513 
skl
;

2515 ià(!
	`»move_obj
(
ch
, 
WEAR_WIELD
, 
fR•Ïû
))

2518 ià(!
ch
->
	`is_Åc
()

2519 && 
	`g‘_obj_weight
(
obj
è> (
¡r_­p
[
	`GET_ATTR_STR
(
ch
)].
w›ld


2521 
	`¡c
("It' toØh—vy fÜ youØpick up.\n", 
ch
);

2525 ià(!
ch
->
	`is_Åc
(è&& ch->
size
 < 
SIZE_LARGE


2526 && 
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_two_hªds
)

2527 && 
	`g‘_eq_ch¬
(
ch
, 
WEAR_SHIELD
è!ğ
nuÎ±r
) {

2528 
	`¡c
("You‚“dwØhªd ä“ fÜh© w—pÚ.\n", 
ch
);

2532 ià(!
ch
->
	`is_Åc
(è&& 
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_two_hªds
) &&

2533 
	`g‘_eq_ch¬
(
ch
, 
WEAR_SECONDARY
è!ğ
nuÎ±r
) {

2534 
	`¡c
("You cª‚Ù u£‡wØhªded w—pÚ wh’ du®-w›ldšg.\n", 
ch
);

2538 
	`aù
("$Àw›ld $p{x.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2539 
	`aù
("You w›ld $p{x.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2540 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_WIELD
);

2541 
¢
 = 
	`g‘_w—pÚ_skl
(
ch
, 
çl£
);

2543 ià(
¢
 =ğ
skl
::
ty³
::
hªd_to_hªd
)

2546 
skl
 = 
	`g‘_w—pÚ_Ë¬Ãd
(
ch
, 
¢
);

2548 ià(
skl
 >= 100)

2549 
	`aù
("You f“È© oÃ w™h $p{x.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2550 ià(
skl
 > 85)

2551 
	`aù
("You f“Èqu™cÚfid’ˆw™h $p{x.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2552 ià(
skl
 > 70)

2553 
	`aù
("You‡» skËd w™h $p{x.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2554 ià(
skl
 > 50)

2555 
	`aù
("You¸skÈw™h $°i adequ©e{x.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2556 ià(
skl
 > 25)

2557 
	`aù
("$°ã– ¨l™şumsy iÀyou¸hªds{x.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2558 ià(
skl
 > 1)

2559 
	`aù
("You fumbË‡nd‡lmo¡ drİ $p{x.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2561 
	`aù
("You don'tƒven know whichƒnd is up on $p{x.",

2562 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2567 ià(
	`CAN_WEAR
(
obj
, 
ITEM_HOLD
)) {

2568 ià(!
	`»move_obj
(
ch
, 
WEAR_HOLD
, 
fR•Ïû
))

2571 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_SECONDARY
è!ğ
nuÎ±r
 && !
	`IS_IMMORTAL
(ch)) {

2572 
	`¡c
("You cªnÙ hŞd‡À™em whusšgwØw—pÚs.\n", 
ch
);

2576 
	`aù
("$ÀhŞd $p{x iÀ$ hªd.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2577 
	`aù
("You hŞd $p{x iÀyou¸hªd.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2578 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_HOLD
);

2582 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WEAR_FLOAT
)) {

2583 ià(!
	`»move_obj
(
ch
, 
WEAR_FLOAT
, 
fR•Ïû
))

2586 
	`aù
("$À»Ëa£ $p{xØæßˆÃxˆtØ$m.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2587 
	`aù
("You„–—£ $p{x‡nd iˆæßt ÃxˆtØyou.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2588 
	`equ_ch¬
(
ch
, 
obj
, 
WEAR_FLOAT
);

2592 ià(
fR•Ïû
)

2593 
	`¡c
("You cª'ˆw—r, w›ld, o¸hŞdh©.\n", 
ch
);

2594 
	}
}

2596 
	$do_w—r
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2598 
Objeù
 *
obj
;

2600 ià(
¬gum’t
.
	`em±y
()) {

2601 
	`¡c
("W—r, w›ld, o¸hŞd wh©?\n", 
ch
);

2605 
SŒšg
 
¬g
;

2606 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

2608 ià(
¬g
 == "all") {

2609 
Objeù
 *
obj_Ãxt
;

2611 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

2612 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

2614 ià(
obj
->
w—r_loc
 =ğ
WEAR_NONE
 && 
	`ÿn_£e_obj
(
ch
, obj))

2615 
	`w—r_obj
(
ch
, 
obj
, 
çl£
);

2621 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

2622 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

2626 
	`w—r_obj
(
ch
, 
obj
, 
Œue
);

2630 
	}
}

2632 
	$do_»move
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2634 
Objeù
 *
obj
;

2636 ià(
¬gum’t
.
	`em±y
()) {

2637 
	`¡c
("Removwh©?\n", 
ch
);

2641 
SŒšg
 
¬g
;

2642 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

2645 ià(!
	`¡rcmp
(
¬g
, "all")) {

2646 
x
;

2648 
x
 = 0; x < 20; x++)

2649 
	`»move_obj
(
ch
, 
x
, 
Œue
);

2654 ià((
obj
 = 
	`g‘_obj_w—r
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

2655 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

2659 
	`»move_obj
(
ch
, 
obj
->
w—r_loc
, 
Œue
);

2661 
	}
}

2664 
	$do_dÚ©e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2666 
Objeù
 *
™em
;

2669 ià(
Game
::
	`wÜld
().
dÚ©iÚ_p™
 =ğ
nuÎ±r
)

2670 
Game
::
	`wÜld
().
dÚ©iÚ_p™
 = Game::wÜld().
objeù_li¡
; Game::wÜld().dÚ©iÚ_p™ !ğ
nuÎ±r
; Game::wÜld().dÚ©iÚ_p™ = Game::wÜld().dÚ©iÚ_p™->
Ãxt
)

2671 ià(
Game
::
	`wÜld
().
dÚ©iÚ_p™
->
pIndexD©a
->
vnum
 =ğ
OBJ_VNUM_PIT
)

2675 ià(
Game
::
	`wÜld
().
dÚ©iÚ_p™
 =ğ
nuÎ±r
) {

2676 
Game
::
	`wÜld
().
dÚ©iÚ_p™
 = 
	`ü—‹_objeù
(Game::wÜld().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_PIT
), 0);

2678 ià(! 
Game
::
	`wÜld
().
dÚ©iÚ_p™
) {

2679 
Loggšg
::
	`bug
("Error creating donation…it in do_donate.", 0);

2680 
	`¡c
("Th”i nØdÚ©iÚ…™.\n", 
ch
);

2684 
	`obj_to_room
(
Game
::
	`wÜld
().
dÚ©iÚ_p™
, Game::wÜld().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_ALTAR
))));

2687 ià(
¬gum’t
.
	`em±y
()) {

2688 
	`¡c
("DÚ©wh©?\n", 
ch
);

2692 
SŒšg
 
¬g
;

2693 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

2695 ià((
™em
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

2696 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

2700 ià(
™em
->
Ëv–
 >ğ
LEVEL_IMMORTAL
) {

2701 
	`¡c
("Th© i‹m i toØpow”fuÈfÜhdÚ©iÚ…™.\n", 
ch
);

2706 ià(!
	`şª_eq_ok
(
ch
, 
™em
, "donate"))

2709 ià(!
	`ÿn_drİ_obj
(
ch
, 
™em
)) {

2710 
	`¡c
("You cª'ˆ£emØËˆgØoà™.\n", 
ch
);

2714 
	`aù
("$ÀdÚ©e $°tØthdÚ©iÚ…™.", 
ch
, 
™em
, 
nuÎ±r
, 
TO_ROOM
);

2715 
	`aù
("You dÚ©$°tØthdÚ©iÚ…™.", 
ch
, 
™em
, 
nuÎ±r
, 
TO_CHAR
);

2716 
	`obj_äom_ch¬
(
™em
);

2717 
	`obj_to_obj
(
™em
, 
Game
::
	`wÜld
().
dÚ©iÚ_p™
);

2718 
	}
}

2721 
	$do_junk
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2723 
Objeù
 *
obj
;

2725 ià(
¬gum’t
.
	`em±y
()) {

2726 
	`¡c
("Junk wh©?\n", 
ch
);

2730 
SŒšg
 
¬g
;

2731 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

2733 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

2734 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

2738 ià(!
	`ÿn_drİ_obj
(
ch
, 
obj
)) {

2739 
	`¡c
("You cª'ˆ£emØËˆgØoà™.\n", 
ch
);

2743 
	`aù
("$Àjunk $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2744 
	`aù
("You junk $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2745 
	`exŒaù_obj
(
obj
);

2747 
	}
}

2749 
boŞ
 
	$acû±abË_§c
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
)

2751 ià(!
	`ÿn_£e_obj
(
ch
, 
obj
))

2752  
çl£
;

2754 ià(
obj
->
™em_ty³
 =ğ
ITEM_CORPSE_PC
) {

2755 ià(
obj
->
cÚšs
) {

2756 
	`¡c
("Thpow” th© bwouldn'ˆlikth©.\n", 
ch
);

2757  
çl£
;

2761 ià(!
	`CAN_WEAR
(
obj
, 
ITEM_TAKE
è|| CAN_WEAR(obj, 
ITEM_NO_SAC
è|| 
	`IS_OBJ_STAT
(obj, 
ITEM_NOSAC
)) {

2762 
	`±c
(
ch
, "% i nÙ‡Àacû±abË saüifiû.\n", 
obj
->
shÜt_desü
.
	`ÿp™®ize
());

2763  
çl£
;

2766  
Œue
;

2767 
	}
}

2770 
	$do_§üifiû
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2772 
buf
[
MAX_STRING_LENGTH
];

2773 
Objeù
 *
obj
, *
obj_Ãxt
;

2774 
boŞ
 
found
 = 
çl£
;

2775 
sv”
 = 0;

2777 
Ch¬aù”
 *
gch
;

2778 
memb”s
;

2779 
bufãr
[100];

2781 
SŒšg
 
¬g
;

2782 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

2784 ià(
¬g
.
	`em±y
(è||‡rg =ğ
ch
->
Çme
) {

2785 
	`aù
("$Àæšg $m£là©hã‘ oàthGods...§d.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2786 
	`¡c
("PËa£„eäaš from bloodyšgh®r.\n", 
ch
);

2790 ià(
¬g
 == "all") {

2791 
obj
 = 
ch
->
š_room
->
cÚ‹Ás
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

2792 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

2794 ià(!
	`acû±abË_§c
(
ch
, 
obj
))

2797 
boŞ
 
bešg_u£d
 = 
çl£
;

2798 autØ
³rsÚ
 : 
Game
::
	`wÜld
().
ch¬_li¡
)

2799 ià(
³rsÚ
->
Ú
 =ğ
obj
) {

2800 
bešg_u£d
 = 
Œue
;

2804 ià(
bešg_u£d
)

2807 ià(!
ch
->
	`is_Åc
(è|| !
	`IS_IMMORTAL
(ch))

2808 
sv”
 +ğ
	`URANGE
(1, 
obj
->
co¡
, (obj->
Ëv–
 * 3));

2810 
	`aù
("$À§üifiû $°tØthGods.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2811 
	`exŒaù_obj
(
obj
);

2812 
found
 = 
Œue
;

2815 ià(!
found
) {

2816 
	`¡c
("Th”i nÙhšgØ§üifiû h”e.\n", 
ch
);

2820 ià(
ch
->
	`is_Åc
(è|| 
	`IS_IMMORTAL
(ch)) {

2821 
	`¡c
("You saüifiûƒv”ythšg iÀthroom.\n", 
ch
);

2825 ià(
sv”
 == 1) {

2826 
FÜm©
::
	`¥rštf
(
buf
, "% give you oÃ sv” coš fÜ you¸§üifiûs.\n", 
ch
->
pcd©a
->
de™y
);

2827 
	`¡c
(
buf
, 
ch
);

2830 
FÜm©
::
	`¥rštf
(
buf
, "% give you %d sv” coš fÜ you¸§üifiûs.\n", 
ch
->
pcd©a
->
de™y
, 
sv”
);

2831 
	`¡c
(
buf
, 
ch
);

2834 
	`wizÃt
("$N s’d u°¨g¿‹fuÈ§üifiû.", 
ch
, 
nuÎ±r
, 
WIZ_SACCING
, 0, 0);

2837 
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬g
, ch->
š_room
->
cÚ‹Ás
);

2839 ià(
obj
 =ğ
nuÎ±r
) {

2840 
	`¡c
("You cª'ˆfšd it.\n", 
ch
);

2844 ià(!
	`acû±abË_§c
(
ch
, 
obj
))

2847 
boŞ
 
bešg_u£d
 = 
çl£
;

2848 autØ
³rsÚ
 : 
Game
::
	`wÜld
().
ch¬_li¡
)

2849 ià(
³rsÚ
->
Ú
 =ğ
obj
) {

2850 
bešg_u£d
 = 
Œue
;

2854 ià(
bešg_u£d
) {

2855 
	`¡c
("Iˆlook liksomeÚi usšgh©.\n", 
ch
);

2859 ià(
ch
->
	`is_Åc
(è|| 
	`IS_IMMORTAL
(ch))

2860 
	`¡c
("You mak¨loy® saüifiû.\n", 
ch
);

2862 
sv”
 = 
	`URANGE
(1, 
obj
->
co¡
, (obj->
Ëv–
 * 3));

2864 ià(
sv”
 == 1) {

2865 
FÜm©
::
	`¥rštf
(
buf
, "% give you oÃ sv” coš fÜ you¸§üifiû.\n", 
ch
->
pcd©a
->
de™y
);

2866 
	`¡c
(
buf
, 
ch
);

2869 
FÜm©
::
	`¥rštf
(
buf
, "% give you %d sv” coš fÜ you¸§üifiû.\n", 
ch
->
pcd©a
->
de™y
, 
sv”
);

2870 
	`¡c
(
buf
, 
ch
);

2874 
	`aù
("$À§üifiû $°tØthGods.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2875 
	`wizÃt
("$N s’d u°$°a ¨g¿‹fuÈ§üifiû.", 
ch
, 
obj
, 
WIZ_SACCING
, 0, 0);

2876 
	`exŒaù_obj
(
obj
);

2879 
ch
->
sv”
 += silver;

2881 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOSPLIT
)) {

2883 
memb”s
 = 0;

2885 
gch
 = 
ch
->
š_room
->
³İË
; gch !ğ
nuÎ±r
; gch = gch->
Ãxt_š_room
)

2886 ià(
	`is_§me_group
(
gch
, 
ch
)

2887 && !
gch
->
	`is_Åc
())

2888 
memb”s
++;

2890 ià(
memb”s
 > 1 && 
sv”
 > 1) {

2891 
FÜm©
::
	`¥rštf
(
bufãr
, "%d", 
sv”
);

2892 
	`do_¥l™
(
ch
, 
bufãr
);

2895 
	}
}

2897 
	$do_quaff
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2899 
Objeù
 *
obj
;

2901 ià(
¬gum’t
.
	`em±y
()) {

2902 
	`¡c
("Quafàwh©?\n", 
ch
);

2906 
SŒšg
 
¬g
;

2907 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

2909 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

2910 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_HOLD
)è=ğ
nuÎ±r
) {

2911 
	`¡c
("You dØnÙ havth©…ÙiÚ.\n", 
ch
);

2916 ià(
obj
->
™em_ty³
 !ğ
ITEM_POTION
) {

2917 
	`¡c
("You cª quafàÚly…ÙiÚs.\n", 
ch
);

2921 ià(
ch
->
Ëv–
 < 
obj
->level) {

2922 
	`¡c
("Thi liquid i toØpow”fuÈfÜ youØdršk.\n", 
ch
);

2926 ià(!
ch
->
	`is_Åc
()) {

2927 ià(
ch
->
pcd©a
->
cÚd™iÚ
[
COND_FULL
] > 45) {

2928 
	`¡c
("You‡»oØfuÎØquafàthis.\n", 
ch
);

2932 
	`gaš_cÚd™iÚ
(
ch
, 
COND_FULL
, 4);

2935 
	`aù
("$Àquaff $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2936 
	`aù
("You quafà$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2937 
	`obj_ÿ¡_¥–l
(
skl
::
	`äom_št
(
obj
->
v®ue
[1]), obj->v®ue[0], 
ch
, ch, 
nuÎ±r
);

2938 
	`obj_ÿ¡_¥–l
(
skl
::
	`äom_št
(
obj
->
v®ue
[2]), obj->v®ue[0], 
ch
, ch, 
nuÎ±r
);

2939 
	`obj_ÿ¡_¥–l
(
skl
::
	`äom_št
(
obj
->
v®ue
[3]), obj->v®ue[0], 
ch
, ch, 
nuÎ±r
);

2940 
	`obj_ÿ¡_¥–l
(
skl
::
	`äom_št
(
obj
->
v®ue
[4]), obj->v®ue[0], 
ch
, ch, 
nuÎ±r
);

2941 
	`exŒaù_obj
(
obj
);

2942 
	}
}

2945 
SŒšg
 
rg‘_Çme
;

2947 
	$do_»c™e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2949 
Ch¬aù”
 *
viùim
;

2950 
Objeù
 *
süŞl
, *
obj
 = 
nuÎ±r
;

2952 
SŒšg
 
¬g1
, 
¬g2
;

2953 
rg‘_Çme
 = 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g1
);

2954 
	`Úe_¬gum’t
(
rg‘_Çme
, 
¬g2
);

2956 ià((
süŞl
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g1
)è=ğ
nuÎ±r
) {

2957 ià((
süŞl
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_HOLD
)è=ğ
nuÎ±r
) {

2958 
	`¡c
("You dØnÙ havth© süŞl.\n", 
ch
);

2963 ià(
süŞl
->
™em_ty³
 !ğ
ITEM_SCROLL
) {

2964 
	`¡c
("You cª„ec™Úly süŞls.\n", 
ch
);

2969 ià(
süŞl
->
v®ue
[1] <= 0) {

2970 
	`¡c
("ThsüŞÈi bÏnk.\n", 
ch
);

2974 ià(
	`g‘_u§bË_Ëv–
(
ch
è< 
süŞl
->
Ëv–
) {

2975 
	`¡c
("Thi süŞÈi toØcom¶ex fÜ youØcom´eh’d.\n", 
ch
);

2979 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
süŞls
))

2982 ià(
¬g2
.
	`em±y
()) {

2985 ià(
skl
::
	`lookup
(skl::
	`äom_št
(
süŞl
->
v®ue
[1])).
rg‘
 =ğ
TAR_CHAR_OFFENSIVE


2986 || 
skl
::
	`lookup
(skl::
	`äom_št
(
süŞl
->
v®ue
[1])).
rg‘
 =ğ
TAR_OBJ_CHAR_OFF
) {

2987 ià(
ch
->
fightšg
 !ğ
nuÎ±r
)

2988 
viùim
 = 
ch
->
fightšg
;

2990 
	`¡c
("Rec™thsüŞÈÚ whom o¸wh©?\n", 
ch
);

2995 
viùim
 = 
ch
;

2998 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g2
, 
VIS_CHAR
)è=ğ
nuÎ±r


2999 && (
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬g2
)è=ğ
nuÎ±r
) {

3000 
	`¡c
("You cª'ˆfšd it.\n", 
ch
);

3005 
	`aù
("$À»c™e $p.", 
ch
, 
süŞl
, 
nuÎ±r
, 
TO_ROOM
);

3006 
	`aù
("You„ec™$p.", 
ch
, 
süŞl
, 
nuÎ±r
, 
TO_CHAR
);

3008 ià(
	`numb”_³rûÁ
(è>ğ20 + 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
süŞls
) * 4 / 5) {

3009 
	`¡c
("You mi¥rÚounû‡ syÎabË.\n", 
ch
);

3010 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
süŞls
, 
çl£
, 2);

3013 
	`obj_ÿ¡_¥–l
(
skl
::
	`äom_št
(
süŞl
->
v®ue
[1]), süŞl->v®ue[0], 
ch
, 
viùim
, 
obj
);

3014 
	`obj_ÿ¡_¥–l
(
skl
::
	`äom_št
(
süŞl
->
v®ue
[2]), süŞl->v®ue[0], 
ch
, 
viùim
, 
obj
);

3015 
	`obj_ÿ¡_¥–l
(
skl
::
	`äom_št
(
süŞl
->
v®ue
[3]), süŞl->v®ue[0], 
ch
, 
viùim
, 
obj
);

3016 
	`obj_ÿ¡_¥–l
(
skl
::
	`äom_št
(
süŞl
->
v®ue
[4]), süŞl->v®ue[0], 
ch
, 
viùim
, 
obj
);

3017 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
süŞls
, 
Œue
, 2);

3021 
	`WAIT_STATE
(
ch
, (ch->
gud
 =ğ
Gud
::
mage
 || ch->gud =ğGud::
ş”ic
 || ch->gud =ğGud::
Ãüomªûr
)

3022 ? (
skl
::
	`lookup
(skl::
ty³
::
süŞls
).
b—ts
 * 4) / 5

3023 : 
skl
::
	`lookup
(skl::
ty³
::
süŞls
).
b—ts
);

3024 
	`exŒaù_obj
(
süŞl
);

3025 
	}
}

3027 
	$do_b¿ndish
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3029 
Ch¬aù”
 *
vch
;

3030 
Ch¬aù”
 *
vch_Ãxt
;

3031 
Objeù
 *
¡aff
;

3033 ià((
¡aff
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_HOLD
)è=ğ
nuÎ±r
) {

3034 
	`¡c
("You hŞd‚Ùhšg iÀyou¸hªd.\n", 
ch
);

3038 ià(
¡aff
->
™em_ty³
 !ğ
ITEM_STAFF
) {

3039 
	`¡c
("You cª b¿ndish oÆy w™h‡ sff.\n", 
ch
);

3043 
skl
::
ty³
y³ = skl::
	`äom_št
(
¡aff
->
v®ue
[3]);

3045 ià(
ty³
 =ğ
skl
::ty³::
unknown
) {

3046 
Loggšg
::
	`bug
("Do_b¿ndish: bad sÀ%d.", 
¡aff
->
v®ue
[3]);

3050 cÚ¡‡uto& 
’Œy
 = 
skl
::
	`lookup
(
ty³
);

3052 ià(
’Œy
.
¥–l_fun
 == 0) {

3053 
Loggšg
::
	`bugf
("Do_b¿ndish: bad s³Î '%s'.", 
’Œy
.
Çme
);

3057 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
¡aves
))

3060 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
¡aves
).
b—ts
);

3062 ià(
¡aff
->
v®ue
[2] > 0) {

3063 
	`aù
("$Àliá u°ªd b¿ndishe $p.", 
ch
, 
¡aff
, 
nuÎ±r
, 
TO_ROOM
);

3064 
	`aù
("You b¿ndish $p.", 
ch
, 
¡aff
, 
nuÎ±r
, 
TO_CHAR
);

3066 ià(
	`g‘_u§bË_Ëv–
(
ch
è< 
¡aff
->
Ëv–


3067 || 
	`numb”_³rûÁ
(è>ğ20 + 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
¡aves
) * 4 / 5) {

3068 
	`aù
("You faØšvok$p.", 
ch
, 
¡aff
, 
nuÎ±r
, 
TO_CHAR
);

3069 
	`aù
("...ªd‚Ùhšg h­³ns.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3070 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
¡aves
, 
çl£
, 2);

3072 
vch
 = 
ch
->
š_room
->
³İË
; vch; vch = 
vch_Ãxt
) {

3073 
vch_Ãxt
 = 
vch
->
Ãxt_š_room
;

3075 
’Œy
.
rg‘
) {

3077 
Loggšg
::
	`bug
("Do_b¿ndish: bad¬g‘ fÜ sÀ%d.", 
¡aff
->
v®ue
[3]);

3080 
TAR_IGNORE
:

3081 ià(
vch
 !ğ
ch
)

3086 
TAR_CHAR_OFFENSIVE
:

3087 ià(
ch
->
	`is_Åc
(è? 
vch
->is_npc() : !vch->is_npc())

3092 
TAR_CHAR_DEFENSIVE
:

3093 ià(
ch
->
	`is_Åc
(è? !
vch
->is_npc() : vch->is_npc())

3098 
TAR_CHAR_SELF
:

3099 ià(
vch
 !ğ
ch
)

3105 
	`obj_ÿ¡_¥–l
(
ty³
, 
¡aff
->
v®ue
[0], 
ch
, 
vch
, 
nuÎ±r
);

3106 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
¡aves
, 
Œue
, 2);

3110 ià(--
¡aff
->
v®ue
[2] <= 0) {

3111 
	`aù
("$n' $°bÏze brighˆªd i gÚe.", 
ch
, 
¡aff
, 
nuÎ±r
, 
TO_ROOM
);

3112 
	`aù
("You¸$°bÏze brighˆªd i gÚe.", 
ch
, 
¡aff
, 
nuÎ±r
, 
TO_CHAR
);

3113 
	`de¡roy_obj
(
¡aff
);

3117 
	}
}

3119 
	$do_z­
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3121 
Ch¬aù”
 *
viùim
;

3122 
Objeù
 *
wªd
;

3123 
Objeù
 *
obj
 = 
nuÎ±r
;

3125 ià(
¬gum’t
.
	`em±y
(è&& 
ch
->
fightšg
 =ğ
nuÎ±r
) {

3126 
	`¡c
("Z­ whom o¸wh©?\n", 
ch
);

3130 ià((
wªd
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_HOLD
)è=ğ
nuÎ±r
) {

3131 
	`¡c
("You‡» hŞdšg‚Ùhšg iÀyou¸hªd.\n", 
ch
);

3135 ià(
wªd
->
™em_ty³
 !ğ
ITEM_WAND
) {

3136 
	`¡c
("You cª z­ oÆy w™h‡ wªd.\n", 
ch
);

3140 
SŒšg
 
¬g
;

3141 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

3143 ià(
¬g
.
	`em±y
()) {

3145 ià(
ch
->
fightšg
 !ğ
nuÎ±r
)

3146 
viùim
 = 
ch
->
fightšg
;

3148 
	`¡c
("Z­ whom o¸wh©?\n", 
ch
);

3153 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r


3154 && (
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬g
)è=ğ
nuÎ±r


3155 && (
skl
::
	`äom_št
(
wªd
->
v®ue
[3]è!ğskl::
ty³
::
summÚ
 || (
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
)) {

3156 
	`¡c
("You cª'ˆfšd it.\n", 
ch
);

3162 ià(
viùim
 =ğ
nuÎ±r
 && 
obj
 =ğ
wªd
) {

3163 
	`¡c
("You cª'ˆz­‡ wªd w™h it£lf.\n", 
ch
);

3167 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
wªds
))

3170 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
wªds
).
b—ts
);

3172 ià(
wªd
->
v®ue
[2] > 0) {

3173 ià(
viùim
 !ğ
nuÎ±r
) {

3174 ià(
viùim
 =ğ
ch
) {

3175 
	`aù
("$Àz­ $m£làw™h $p.", 
ch
, 
wªd
, 
viùim
, 
TO_ROOM
);

3176 
	`aù
("You z­ your£làw™h $p.", 
ch
, 
wªd
, 
viùim
, 
TO_CHAR
);

3179 
	`aù
("$Àz­ $N w™h $p.", 
ch
, 
wªd
, 
viùim
, 
TO_ROOM
);

3180 
	`aù
("You z­ $N w™h $p.", 
ch
, 
wªd
, 
viùim
, 
TO_CHAR
);

3184 
	`aù
("$Àz­ $P w™h $p.", 
ch
, 
wªd
, 
obj
, 
TO_ROOM
);

3185 
	`aù
("You z­ $P w™h $p.", 
ch
, 
wªd
, 
obj
, 
TO_CHAR
);

3188 ià(
	`g‘_u§bË_Ëv–
(
ch
è< 
wªd
->
Ëv–


3189 || 
	`numb”_³rûÁ
(è>ğ20 + 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
wªds
) * 4 / 5) {

3190 
	`aù
("Yourƒfforts with $p…roduce only sparks‡nd smoke.",

3191 
ch
, 
wªd
, 
nuÎ±r
, 
TO_CHAR
);

3192 
	`aù
("$n'sƒfforts with $p…roduce only sparks‡nd smoke.",

3193 
ch
, 
wªd
, 
nuÎ±r
, 
TO_ROOM
);

3194 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
wªds
, 
çl£
, 2);

3199 
rg‘_Çme
 = 
¬g
;

3200 
	`obj_ÿ¡_¥–l
(
skl
::
	`äom_št
(
wªd
->
v®ue
[3]), wªd->v®ue[0], 
ch
, 
viùim
, 
obj
);

3201 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
wªds
, 
Œue
, 2);

3205 ià(--
wªd
->
v®ue
[2] <= 0) {

3206 
	`aù
("$n' $°ex¶ode štØäagm’ts.", 
ch
, 
wªd
, 
nuÎ±r
, 
TO_ROOM
);

3207 
	`aù
("You¸$°ex¶ode štØäagm’ts.", 
ch
, 
wªd
, 
nuÎ±r
, 
TO_CHAR
);

3208 
	`de¡roy_obj
(
wªd
);

3212 
	}
}

3214 
	$do_b»w
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3216 
Objeù
 *
obj
;

3217 
skl
::
ty³
 
¢
;

3218 
rg‘_Ëv–
 = 0;

3220 ià(
ch
->
	`is_Åc
()) {

3221 
	`¡c
("Mobe ÿn'ˆb»w!.\n", 
ch
);

3225 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
b»w
)) {

3226 
	`¡c
("You dØnÙ know howØb»w…ÙiÚs.\n", 
ch
);

3230 ià(
ch
->
gud
 =ğ
Gud
::
nÚe
) {

3231 
	`¡c
("OÆy gud memb” ÿÀb»w…ÙiÚs.\n", 
ch
);

3235 ià(
¬gum’t
.
	`em±y
()) {

3236 
	`¡c
("B»w wh© s³Î?\n", 
ch
);

3240 
SŒšg
 
¬g
;

3241 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

3244 
obj
 = 
ch
->
ÿ¼yšg
; obj; obj = obj->
Ãxt_cÚ‹Á
) {

3245 ià(
obj
->
™em_ty³
 =ğ
ITEM_POTION
 && obj->
w—r_loc
 =ğ
WEAR_HOLD
)

3262 ià(!
obj
) {

3263 
	`¡c
("You‡»‚Ù hŞdšg‡ vŸl.\n", 
ch
);

3267 ià((
¢
 = 
skl
::
	`lookup
(
¬g
)è=ğskl::
ty³
::
unknown
) {

3268 
	`¡c
("Th”i nØsuch s³Î.\n", 
ch
);

3272 ià(!
	`g‘_skl_Ëv–
(
ch
, 
¢
)) {

3273 
	`¡c
("You dÚ'ˆknow‡ny s³Î byh©‚ame.\n", 
ch
);

3281 ià(((
skl
::
	`lookup
(
¢
).
rg‘
 !ğ
TAR_CHAR_DEFENSIVE
) &&

3282 (
skl
::
	`lookup
(
¢
).
rg‘
 !ğ
TAR_CHAR_SELF
) &&

3283 (
skl
::
	`lookup
(
¢
).
rg‘
 !ğ
TAR_OBJ_CHAR_DEF
))

3285 (
skl
::
	`lookup
(
¢
).
»mÜt_gud
 !ğ
Gud
::
nÚe
)) {

3286 
	`¡c
("You cªnÙ b»wh© s³Î.\n", 
ch
);

3295 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

3297 ià(!
¬g
.
	`em±y
()) {

3298 
rg‘_Ëv–
 = 
	`©oi
(
¬g
);

3301 ià(
rg‘_Ëv–
 < 
	`g‘_u§bË_Ëv–
(
¢
, 
ch
->
gud
)) {

3302 
	`¡c
("You cªnÙ b»wh¥–È©h©†ow‡†ev–.\n", 
ch
);

3307 ià(
rg‘_Ëv–
 > 
ch
->
Ëv–
) {

3308 
	`¡c
("You havnÙ y‘„—chedh©†ev–!\n", 
ch
);

3313 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
b»w
))

3316 
	`aù
("$Àbegš ´•¬šg‡…ÙiÚ.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3317 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
b»w
, 
Œue
, 2);

3318 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
b»w
).
b—ts
);

3321 ià(!
ch
->
	`is_Åc
()

3322 && (
	`numb”_³rûÁ
(è> (
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
b»w
) +

3323 
	`GET_ATTR
(
ch
, 
APPLY_SCRIBE_UNIQUE
))||

3324 
	`numb”_³rûÁ
(è> ((
	`GET_ATTR_INT
(
ch
) - 13) * 5 +

3325 (
	`GET_ATTR_WIS
(
ch
) - 13) * 3))) {

3326 
	`aù
("$°ex¶ode viŞ’y!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3327 
	`aù
("$°ex¶ode viŞ’y!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3328 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
b»w
, 
çl£
, 2);

3329 
	`de¡roy_obj
(
obj
);

3336 ià(
rg‘_Ëv–
) {

3337 
obj
->
Ëv–
 = (è
rg‘_Ëv–
;

3338 
obj
->
v®ue
[0] = (è
rg‘_Ëv–
;

3341 
obj
->
Ëv–
 = 
ch
->level;

3342 
obj
->
v®ue
[0] = 
ch
->
Ëv–
;

3345 
	`¥–l_im´št
(
¢
, 
ch
->
Ëv–
, ch, 
obj
);

3346 
	}
}

3348 
	$do_süibe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3350 
Objeù
 *
obj
;

3351 
skl
::
ty³
 
¢
;

3352 
rg‘_Ëv–
 = 0;

3354 ià(
ch
->
	`is_Åc
()) {

3355 
	`¡c
("Mobe ÿn'ˆsüibe!.\n", 
ch
);

3359 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
süibe
)) {

3360 
	`¡c
("You dØnÙ know howØsüibsüŞls.\n", 
ch
);

3364 ià(
ch
->
gud
 =ğ
Gud
::
nÚe
) {

3365 
	`¡c
("OÆy gud memb” ÿÀsüibsüŞls.\n", 
ch
);

3369 ià(
¬gum’t
.
	`em±y
()) {

3370 
	`¡c
("Süibwh© s³Î?\n", 
ch
);

3374 
SŒšg
 
¬g
;

3375 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

3378 
obj
 = 
ch
->
ÿ¼yšg
; obj; obj = obj->
Ãxt_cÚ‹Á
) {

3379 ià(
obj
->
™em_ty³
 =ğ
ITEM_SCROLL
 && obj->
w—r_loc
 =ğ
WEAR_HOLD
)

3383 ià(!
obj
) {

3384 
	`¡c
("You‡»‚Ù hŞdšg‡…¬chm’t.\n", 
ch
);

3388 ià((
¢
 = 
skl
::
	`lookup
(
¬g
)è=ğskl::
ty³
::
unknown
) {

3389 
	`¡c
("Th”i nØsuch s³Î.\n", 
ch
);

3393 ià(!
	`g‘_skl_Ëv–
(
ch
, 
¢
)) {

3394 
	`¡c
("You dÚ'ˆknow‡ny s³Î byh©‚ame.\n", 
ch
);

3398 ià(
skl
::
	`lookup
(
¢
).
»mÜt_gud
 !ğ
Gud
::
nÚe
) {

3399 
	`¡c
("You cªnÙ süibth© s³Î.\n", 
ch
);

3409 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

3411 ià(!
¬g
.
	`em±y
()) {

3412 
rg‘_Ëv–
 = 
	`©oi
(
¬g
);

3415 ià(
rg‘_Ëv–
 < 
	`g‘_u§bË_Ëv–
(
¢
, 
ch
->
gud
)) {

3416 
	`¡c
("You cªnÙ süibth© s³Î‡ˆth©†ev–.", 
ch
);

3421 ià(
rg‘_Ëv–
 > 
ch
->
Ëv–
) {

3422 
	`¡c
("You‡»‚Ù y‘‡ˆth©†ev–!\n", 
ch
);

3427 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
süibe
))

3430 
	`aù
("$Àbegš wr™šg‡ süŞl.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3431 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
süibe
, 
Œue
, 2);

3432 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
süibe
).
b—ts
);

3435 ià(!
ch
->
	`is_Åc
()

3436 && (
	`numb”_³rûÁ
(è> ( 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
süibe
) +

3437 
	`GET_ATTR
(
ch
, 
APPLY_SCRIBE_UNIQUE
)) ||

3438 
	`numb”_³rûÁ
(è> ((
	`GET_ATTR_INT
(
ch
) - 13) * 5 +

3439 (
	`GET_ATTR_WIS
(
ch
) - 13) * 3))) {

3440 
	`aù
("$°bur¡ š fÏmes!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3441 
	`aù
("$°bur¡ š fÏmes!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3442 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
süibe
, 
çl£
, 2);

3443 
	`de¡roy_obj
(
obj
);

3451 ià(
rg‘_Ëv–
) {

3452 
obj
->
Ëv–
 = (è
rg‘_Ëv–
;

3453 
obj
->
v®ue
[0] = (è
rg‘_Ëv–
;

3456 
obj
->
Ëv–
 = 
ch
->level;

3457 
obj
->
v®ue
[0] = 
ch
->
Ëv–
;

3460 
	`¥–l_im´št
(
¢
, 
ch
->
Ëv–
, ch, 
obj
);

3461 
	}
}

3463 
	$do_¡—l
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3465 
buf
 [
MAX_STRING_LENGTH
];

3466 
Ch¬aù”
 *
viùim
;

3467 
Objeù
 *
obj
;

3468 
³rûÁ
;

3470 ià(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
¡—l
) == 0) {

3471 
	`¡c
("You dÚ'ˆknow howØ¡—l.\n", 
ch
);

3475 
SŒšg
 
¬g1
, 
¬g2
;

3476 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

3477 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

3479 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.empty()) {

3480 
	`¡c
("S‹® wh© from whom?\n", 
ch
);

3484 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g2
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

3485 
	`¡c
("Cª'ˆ¡—Èäom…eİË whØ¬nÙ h”e.\n", 
ch
);

3489 ià(
viùim
 =ğ
ch
) {

3490 
	`¡c
("A†™schizİh»nŸ gošg oÀh”e?\n", 
ch
);

3494 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


3495 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
şª¬’a


3496 || (
viùim
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.¬—(è&& !Game::wÜld().que¡.
pk
)

3497 || 
	`ch¬_š_du–_room
(
viùim
)) {

3498 
	`¡c
("You‡» h”tØdØb©e,‚ÙØ¡—l!\n", 
ch
);

3502 ià(
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
ACT_MORPH
è&& !
viùim
->is_npc()) {

3503 
	`¡c
("MÜphed…Ïy” ÿÂÙ‡‰ack PC's.\n", 
ch
);

3507 ià(!
viùim
->
	`is_Åc
(è&& 
	`IS_IMMORTAL
(victim)) {

3508 
	`¡c
("I'm sÜry, buˆthgod wouldn'ˆlikth©!\n", 
ch
);

3512 ià(
	`is_§ã
(
ch
, 
viùim
, 
Œue
))

3515 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
¡—l
))

3518 ià(
viùim
->
	`is_Åc
(è&& viùim->
fightšg
) {

3519 
	`¡c
("I dÚ'ˆthškh© i ¨good id—.\n", 
ch
);

3523 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
¡—l
).
b—ts
);

3524 
³rûÁ
 = 
	`numb”_³rûÁ
();

3526 ià(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
¡—l
) >= 1)

3527 
³rûÁ
 +ğ(
	`IS_AWAKE
(
viùim
) ? 10 : -50);

3529 ià((!
viùim
->
	`is_Åc
(è&& !
ch
->is_Åc(è&& !
	`IS_IMMORTAL
(ch))

3530 && ((
ch
->
Ëv–
 + 8 < 
viùim
->level || ch->level - 8 > victim->level)

3531 || (!
	`is_şª
(
viùim
è|| !is_şª(
ch
)))) {

3532 
	`¡c
("You cªnÙ s‹® fromhem.\n", 
ch
);

3536 ià(!
viùim
->
	`is_Åc
(è&& !
	`IS_IMMORTAL
(
ch
)) {

3537 ià(!
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
)) {

3538 
	`¡c
("They‡»‚Ù iÀthmoodØPS‹®.\n", 
ch
);

3542 ià(!
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
)) {

3543 
	`¡c
("You‡»‚Ù iÀthmoodØPS‹®.\n", 
ch
);

3548 ià(!
ch
->
	`is_Åc
(è&& 
³rûÁ
 > 
	`g‘_skl_Ëv–
(ch, 
skl
::
ty³
::
¡—l
)) {

3552 
	`¡c
("Uh-oh! WhOİs.\n", 
ch
);

3553 
	`aù
("$ÀŒ›dØ¡—Èäom you.\n", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

3554 
	`aù
("$ÀbungË ¨robb”y‡‰em± oÀ$N.\n", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

3556 
	`numb”_¿nge
(0, 3)) {

3558 
FÜm©
::
	`¥rštf
(
buf
, "% i ¨bum mugg”!", 
ch
->
Çme
);

3562 
FÜm©
::
	`¥rštf
(
buf
, "%s couldn't„ob %s way out of‡…aper bag!",

3563 
ch
->
Çme
, 
	`GET_ATTR_SEX
(chè=ğ
SEX_NEUTRAL
 ? "™s" : GET_ATTR_SEX(chè=ğ
SEX_MALE
 ? "his" : "her");

3567 
FÜm©
::
	`¥rštf
(
buf
, "% Œ›dØrob me!", 
ch
->
Çme
);

3571 
FÜm©
::
	`¥rštf
(
buf
, "K“°you¸hªd ouˆoàth”e, %s! P”v”t!", 
ch
->
Çme
);

3575 
	`do_y–l
(
viùim
, 
buf
);

3577 ià(!
ch
->
	`is_Åc
()) {

3578 ià(
viùim
->
	`is_Åc
()) {

3579 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
¡—l
, 
çl£
, 2);

3580 
	`muÉi_h™
(
viùim
, 
ch
, 
skl
::
ty³
::
unknown
);

3583 
FÜm©
::
	`¥rštf
(
buf
, "$Nr›dØ¡—Èäom %s.", 
viùim
->
Çme
);

3584 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_FLAGS
, 0, 0);

3586 ià(!
ch
->
aù_æags
.
	`has
(
PLR_THIEF
)) {

3587 
ch
->
aù_æags
 +ğ
PLR_THIEF
;

3588 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_NOPK
;

3589 
	`£t_cŞÜ
(
ch
, 
BLUE
, 
NOBOLD
);

3590 
	`¡c
("*** You‡»‚ow‡ THIEF!! ***\n", 
ch
);

3591 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

3592 
ch
->
pcd©a
->
æag_th›f
 = 
MAX_THIEF
;

3601 ià(
¬g1
 == "coin"

3602 || 
¬g1
 == "coins"

3603 || 
¬g1
 == "gold"

3604 || 
¬g1
 == "silver") {

3605 
gŞd
, 
sv”
;

3606 
gŞd
 = 
viùim
->gŞd * 
	`numb”_¿nge
(1, 
ch
->
Ëv–
è/ 
MAX_LEVEL
;

3607 
sv”
 = 
viùim
->sv” * 
	`numb”_¿nge
(1, 
ch
->
Ëv–
è/ 
MAX_LEVEL
;

3609 ià(
gŞd
 <ğ0 && 
sv”
 <= 0) {

3610 
	`¡c
("You didn'ˆg‘‡nythšg. Try someÚrich”.\n", 
ch
);

3614 
ch
->
gŞd
 += gold;

3615 
ch
->
sv”
 += silver;

3616 
viùim
->
sv”
 -= silver;

3617 
viùim
->
gŞd
 -= gold;

3619 ià(
sv”
 <= 0)

3620 
FÜm©
::
	`¥rštf
(
buf
, "Bšgo! You gÙ %d gŞd coš%s.\n", 
gŞd
,

3621 
gŞd
 == 1 ? "" : "s");

3622 ià(
gŞd
 <= 0)

3623 
FÜm©
::
	`¥rštf
(
buf
, "Bšgo! You gÙ %d sv” coš%s.\n", 
sv”
,

3624 
sv”
 == 1 ? "" : "s");

3626 
FÜm©
::
	`¥rštf
(
buf
, "Bingo! You got %d silver‡nd %d gold coins.\n",

3627 
sv”
, 
gŞd
);

3629 
	`¡c
(
buf
, 
ch
);

3630 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
¡—l
, 
Œue
, 2);

3634 
obj
 = 
viùim
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
) {

3635 ià(
obj
->
w—r_loc
 =ğ
WEAR_NONE


3636 && 
	`ÿn_£e_obj
(
ch
, 
obj
)

3637 && 
obj
->
Çme
.
	`has_wÜds
(
¬g1
))

3641 ià(
obj
 =ğ
nuÎ±r
) {

3642 
	`¡c
("You f“È¬ound, buˆdÚˆg‘‡nythšg buˆlšt.\n", 
ch
);

3646 ià(!
	`ÿn_drİ_obj
(
ch
, 
obj
)

3647 || 
	`IS_OBJ_STAT
(
obj
, 
ITEM_INVENTORY
)

3648 || 
obj
->
Ëv–
 > 
ch
->level) {

3649 
	`¡c
("You cª'ˆ´y iˆaway.\n", 
ch
);

3653 ià(
	`g‘_ÿ¼y_numb”
(
ch
è+ 
	`g‘_obj_numb”
(
obj
è> 
	`ÿn_ÿ¼y_n
(ch)) {

3654 
	`¡c
("You havyou¸hªd fuÎ.\n", 
ch
);

3658 ià(
	`g‘_ÿ¼y_weight
(
ch
è+ 
	`g‘_obj_weight
(
obj
è> 
	`ÿn_ÿ¼y_w
(ch)) {

3659 
	`¡c
("You cª'ˆÿ¼yh© much weight.\n", 
ch
);

3663 
	`obj_äom_ch¬
(
obj
);

3664 
	`obj_to_ch¬
(
obj
, 
ch
);

3665 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
¡—l
, 
Œue
, 2);

3666 
	`¡c
("GÙ it!\n", 
ch
);

3669 ià(
	`IS_QUESTOR
(
ch
)) {

3670 ià(
ch
->
pcd©a
->
que¡obj
 =ğ
obj
->
pIndexD©a
->
vnum
 && ch->pcd©a->
que¡obf
 != -1) {

3671 
buf
[
MAX_STRING_LENGTH
];

3672 
	`¡c
("{YYou hav®mo¡ com¶‘ed you¸QUEST!{x\n", 
ch
);

3673 
	`¡c
("{YR‘uºØthque¡ma¡” befÜyou¸timrun out!{x\n", 
ch
);

3674 
ch
->
pcd©a
->
que¡obf
 = -1;

3675 
FÜm©
::
	`¥rštf
(
buf
, "{Y:QUEST: {x$N ha found %s", 
obj
->
shÜt_desü
);

3676 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

3681 ià(
	`IS_SQUESTOR
(
ch
)) {

3682 ià(
ch
->
pcd©a
->
sque¡obj
 =ğ
obj
 && !ch->pcd©a->
sque¡objf
) {

3683 
buf
[
MAX_STRING_LENGTH
];

3685 ià(
ch
->
pcd©a
->
sque¡mob
 =ğ
nuÎ±r
) {

3686 
	`¡c
("{YYou hav®mo¡ com¶‘ed you¸{VSKILL QUEST!{x\n", 
ch
);

3687 
	`¡c
("{YR‘uºØthque¡mi¡»s befÜyou¸timrun out!{x\n", 
ch
);

3690 
	`¡c
("{YYou havcom¶‘ed…¬ˆoàyou¸{VSKILL QUEST!{x\n", 
ch
);

3691 
	`±c
(
ch
, "{YTakehe‡rtifacto %s whilehere is stillime!{x\n",

3692 
ch
->
pcd©a
->
sque¡mob
->
shÜt_desü
);

3695 
ch
->
pcd©a
->
sque¡objf
 = 
Œue
;

3696 
FÜm©
::
	`¥rštf
(
buf
, "{Y:SKILL QUEST: {x$N ha foundh%s", 
obj
->
shÜt_desü
);

3697 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

3700 
	}
}

3705 
Ch¬aù”
 *
	$fšd_k“³r
(
Ch¬aù”
 *
ch
)

3708 
Ch¬aù”
 *
k“³r
;

3709 
Shİ
 *
pShİ
;

3710 
pShİ
 = 
nuÎ±r
;

3712 
k“³r
 = 
ch
->
š_room
->
³İË
; k“³r; k“³¸ğk“³r->
Ãxt_š_room
) {

3713 ià(
k“³r
->
aù_æags
.
	`has
(
ACT_MORPH
))

3716 ià(
k“³r
->
	`is_Åc
(è&& (
pShİ
 = k“³r->
pIndexD©a
->pShİè!ğ
nuÎ±r
)

3720 ià(
pShİ
 =ğ
nuÎ±r
) {

3721 
	`¡c
("Thi i¢'ˆ¨¡Üe...you mighˆhavnÙiûd.\n", 
ch
);

3722  
nuÎ±r
;

3747 ià(
k“³r
->
š_room
->
	`¬—
().
wÜld
.
time
.
hour
 < 
pShİ
->
İ’_hour
) {

3748 
	`do_§y
(
k“³r
, "Sorry, I‡m closed.");

3749  
nuÎ±r
;

3752 ià(
k“³r
->
š_room
->
	`¬—
().
wÜld
.
time
.
hour
 > 
pShİ
->
şo£_hour
) {

3753 
	`do_§y
(
k“³r
, "Sorry, I‡m closed.");

3754  
nuÎ±r
;

3760 ià(!
	`ÿn_£e_ch¬
(
k“³r
, 
ch
)) {

3761 
	`do_§y
(
k“³r
, "Umm, Sorry, If I could see you, we couldrade!");

3762  
nuÎ±r
;

3765  
k“³r
;

3766 
	}
}

3769 
	$obj_to_k“³r
(
Objeù
 *
obj
, 
Ch¬aù”
 *
ch
)

3771 
Objeù
 *
t_obj
, *
t_obj_Ãxt
;

3774 
t_obj
 = 
ch
->
ÿ¼yšg
;_obj !ğ
nuÎ±r
;_obj = 
t_obj_Ãxt
) {

3775 
t_obj_Ãxt
 = 
t_obj
->
Ãxt_cÚ‹Á
;

3777 ià(
obj
->
pIndexD©a
 =ğ
t_obj
->pIndexData

3778 && 
obj
->
shÜt_desü
 =ğ
t_obj
->short_descr) {

3780 ià(
	`IS_OBJ_STAT
(
t_obj
, 
ITEM_INVENTORY
)) {

3781 
	`exŒaù_obj
(
obj
);

3785 
obj
->
co¡
 = 
t_obj
->cost;

3790 ià(
t_obj
 =ğ
nuÎ±r
) {

3791 
obj
->
Ãxt_cÚ‹Á
 = 
ch
->
ÿ¼yšg
;

3792 
ch
->
ÿ¼yšg
 = 
obj
;

3795 
obj
->
Ãxt_cÚ‹Á
 = 
t_obj
->next_content;

3796 
t_obj
->
Ãxt_cÚ‹Á
 = 
obj
;

3799 
obj
->
ÿ¼›d_by
 = 
ch
;

3800 
obj
->
š_room
 = 
nuÎ±r
;

3801 
obj
->
š_obj
 = 
nuÎ±r
;

3802 
	}
}

3805 
Objeù
 *
	$g‘_obj_k“³r
(
Ch¬aù”
 *
ch
, Ch¬aù” *
k“³r
, cÚ¡ 
SŒšg
& 
¬gum’t
)

3807 
Objeù
 *
obj
;

3808 
numb”
;

3809 
couÁ
;

3811 
SŒšg
 
¬g
;

3812 
numb”
 = 
	`numb”_¬gum’t
(
¬gum’t
, 
¬g
);

3813 
couÁ
 = 0;

3815 
obj
 = 
k“³r
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
) {

3816 ià(
obj
->
w—r_loc
 =ğ
WEAR_NONE


3817 && 
	`ÿn_£e_obj
(
k“³r
, 
obj
)

3818 && 
	`ÿn_£e_obj
(
ch
, 
obj
)

3819 && 
obj
->
Çme
.
	`has_wÜds
(
¬g
)) {

3820 ià(++
couÁ
 =ğ
numb”
)

3821  
obj
;

3824 
obj
->
Ãxt_cÚ‹Á
 !ğ
nuÎ±r


3825 && 
obj
->
pIndexD©a
 =ğobj->
Ãxt_cÚ‹Á
->pIndexData

3826 && 
obj
->
shÜt_desü
 =ğobj->
Ãxt_cÚ‹Á
->short_descr)

3827 
obj
 = obj->
Ãxt_cÚ‹Á
;

3831  
nuÎ±r
;

3832 
	}
}

3834 
	$g‘_co¡
(
Ch¬aù”
 *
k“³r
, 
Objeù
 *
obj
, 
boŞ
 
fBuy
)

3836 
Shİ
 *
pShİ
;

3837 
co¡
;

3839 ià(
obj
 =ğ
nuÎ±r
 || (
pShİ
 = 
k“³r
->
pIndexD©a
->pShop) ==‚ullptr)

3842 ià(
fBuy
)

3843 
co¡
 = 
obj
->co¡ * 
pShİ
->
´of™_buy
 / 100;

3844 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_QUESTSELL
)) {

3845 ià(
pShİ
->
buy_ty³
[0] =ğ
ITEM_QUESTSHOP
) {

3846 
co¡
 = 
obj
->co¡ * 
pShİ
->
´of™_£Î
 / 100;

3847 
co¡
 = (co¡ * 
obj
->
cÚd™iÚ
) / 100;

3850 
co¡
 = 0;

3853 
Objeù
 *
obj2
;

3854 
™y³
;

3855 
co¡
 = 0;

3857 
™y³
 = 0; ity³ < 
MAX_TRADE
; itype++) {

3858 ià(
obj
->
™em_ty³
 =ğ
pShİ
->
buy_ty³
[
™y³
]) {

3859 
co¡
 = 
obj
->co¡ * 
pShİ
->
´of™_£Î
 / 100;

3864 ià(!
	`IS_OBJ_STAT
(
obj
, 
ITEM_SELL_EXTRACT
))

3865 
obj2
 = 
k“³r
->
ÿ¼yšg
; obj2; obj2 = obj2->
Ãxt_cÚ‹Á
) {

3866 ià(
obj
->
pIndexD©a
 =ğ
obj2
->pIndexData

3867 && 
obj
->
shÜt_desü
 =ğ
obj2
->short_descr) {

3868 ià(
	`IS_OBJ_STAT
(
obj2
, 
ITEM_INVENTORY
))

3869 
co¡
 /= 2;

3871 
co¡
 = cost * 3 / 4;

3876 ià(
obj
->
™em_ty³
 =ğ
ITEM_STAFF
 || obj->™em_ty³ =ğ
ITEM_WAND
) {

3877 ià(
obj
->
v®ue
[1] == 0)

3878 
co¡
 /= 4;

3880 
co¡
 = co¡ * 
obj
->
v®ue
[2] / obj->value[1];

3883  
co¡
;

3884 
	}
}

3886 
	$make_³t
(
Ch¬aù”
 *
ch
, Ch¬aù” *
³t
) {

3887 
³t
->
aù_æags
 +ğ
ACT_PET
;

3888 
	`add_fŞlow”
(
³t
, 
ch
);

3889 
³t
->
Ëad”
 = 
ch
;

3890 
ch
->
³t
 =…et;

3891 
	}
}

3893 
	$do_buy
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3895 
buf
[
MAX_STRING_LENGTH
];

3896 
co¡
, 
rŞl
;

3898 
Ëv–_buyabË
;

3899 
ÿsh_Ú_ch¬
, 
mÚey_š_bªk
;

3900 
Ãed_bªk_üed™
 = 
çl£
;

3901 
tÙ®_co¡
;

3903 
ÿsh_Ú_ch¬
 = 
ch
->
sv”
 + (ch->
gŞd
 * 100);

3904 
mÚey_š_bªk
 = 
ch
->
sv”_š_bªk
 + (ch->
gŞd_š_bªk
 * 100);

3906 ià(
¬gum’t
.
	`em±y
()) {

3907 
	`¡c
("Wh© dØyou wªˆtØbuy?\n", 
ch
);

3911 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_PET_SHOP
)) {

3913 
buf
[
MAX_STRING_LENGTH
];

3914 
Ch¬aù”
 *
³t
;

3915 
Room
 *
roomNext
;

3916 
Room
 *
š_room
;

3918 ià(
ch
->
	`is_Åc
())

3921 
SŒšg
 
¬g
;

3922 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

3925 ià(
ch
->
š_room
->
loÿtiÚ
 =ğ
	`LoÿtiÚ
(
	`Vnum
(9621)))

3926 
roomNext
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(9706)));

3928 
roomNext
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ch
->
š_room
->
´ÙÙy³
.
vnum
.
	`v®ue
() + 1)));

3930 ià(
roomNext
 =ğ
nuÎ±r
) {

3931 
Loggšg
::
	`bugf
("Do_buy: bad…‘ shİ‡ˆvnum %d.", 
ch
->
š_room
->
´ÙÙy³
.
vnum
);

3932 
	`¡c
("SÜry, wdÚ'ˆ£Îho£. Iàyou'd†iktØ£my mªag”...\n", 
ch
);

3936 
š_room
 = 
ch
->in_room;

3937 
ch
->
š_room
 = 
roomNext
;

3938 
³t
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
);

3939 
ch
->
š_room
 = in_room;

3941 ià(
ch
->
š_room
->
	`gud
(è!ğ
Gud
::
nÚe


3942 && 
ch
->
š_room
->
	`gud
(è!ğch->
gud


3943 && !
	`IS_IMMORTAL
(
ch
)) {

3944 
	`¡c
("SÜry, memb” Úly.\n", 
ch
);

3948 ià(
³t
 =ğ
nuÎ±r
 || !³t->
aù_æags
.
	`has
(
ACT_PET
)) {

3949 
	`¡c
("SÜry, wdÚ'ˆ£Îho£. Iàyou'd†iktØ£my mªag”...\n", 
ch
);

3953 ià(
ch
->
³t
 !ğ
nuÎ±r
) {

3954 
	`¡c
("You'vgÙ‡…‘‡Ì—dy!\n", 
ch
);

3958 ià(
ch
->
pcd©a
->
çmŸr
) {

3959 
	`¡c
("You‡» stÈmouºšghlos oàyou¸çmŸr.\n", 
ch
);

3963 
co¡
 = 10 * 
³t
->
Ëv–
 *…et->level;

3974 ià(
ÿsh_Ú_ch¬
 < 
co¡
) {

3975 
Ãed_bªk_üed™
 = 
Œue
;

3977 
co¡
 += cost / 10;

3979 ià((
ÿsh_Ú_ch¬
 + 
mÚey_š_bªk
è< 
co¡
) {

3980 
	`¡c
("You‡»oØpoÜØbuyh©.\n", 
ch
);

3985 ià(
ch
->
Ëv–
 < 
³t
->level) {

3986 
	`¡c
("Thi thšg wouldƒ© you fÜ b»akç¡!\n", 
ch
);

3991 
rŞl
 = 
	`numb”_³rûÁ
();

3993 ià(
	`numb”_³rûÁ
(è< (
	`GET_ATTR_CHR
(
ch
) * 3))

3994 
rŞl
 -= 15;

3996 ià(
rŞl
 < 1)„oll = 1;

3998 ià(
rŞl
 < 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
haggË
)) {

3999 
co¡
 -ğco¡ / 2 * 
rŞl
 / 100;

4000 
	`±c
(
ch
, "You haggËh´iû dowÀtØ%d cošs.\n", 
co¡
);

4001 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
haggË
, 
Œue
, 4);

4007 ià(
Ãed_bªk_üed™
) {

4008 
co¡
 -ğ
ÿsh_Ú_ch¬
;

4009 
ch
->
sv”
 = ch->
gŞd
 = 0;

4011 ià(
ch
->
sv”_š_bªk
 >ğ
co¡
)

4012 
ch
->
sv”_š_bªk
 -ğ
co¡
;

4014 
co¡
 -ğ
ch
->
sv”_š_bªk
;

4015 
ch
->
sv”_š_bªk
 = 0;

4016 
ch
->
gŞd_š_bªk
 -ğ(
co¡
 / 100) + 1;

4017 
ch
->
sv”_š_bªk
 = 100 - (
co¡
 % 100);

4021 
	`deduù_co¡
(
ch
, 
co¡
);

4023 
³t
 = 
	`ü—‹_mobe
Õ‘->
pIndexD©a
);

4026 ià(! 
³t
) {

4027 
Loggšg
::
	`bug
("Memoryƒrror from create_mobile() in do_buy().", 0);

4028 
	`¡c
("You w”uÇbËØkyou¸³t! You g‘‡„efund.\n", 
ch
);

4029 
ch
->
sv”
 +ğ
co¡
;

4032 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

4034 ià(!
¬g
.
	`em±y
()) {

4035 ià(
	`¡rchr
(
¬g
, '~'))

4036 
	`wizÃt
("$N is‡ttemptingo useheilde in…et‚ame cheat.",

4037 
ch
, 
nuÎ±r
, 
WIZ_CHEAT
, 0, 
	`GET_RANK
(ch));

4039 
FÜm©
::
	`¥rštf
(
buf
, "% %s", 
³t
->
Çme
, 
¬g
);

4040 
³t
->
Çme
 = 
buf
;

4043 
FÜm©
::
	`¥rštf
(
buf
, "%sA collar‡round its‚eck says 'I belongo %s'.\n",

4044 
³t
->
desütiÚ
, 
ch
->
Çme
);

4045 
³t
->
desütiÚ
 = 
buf
;

4046 
	`ch¬_to_room
(
³t
, 
ch
->
š_room
);

4048 
	`make_³t
(
ch
, 
³t
);

4049 
afãù
::
	`add_³rm_to_ch¬
(
³t
,‡fãù::
ty³
::
ch¬m_³rsÚ
);

4050 
³t
->
comm_æags
 = 
COMM_NOCHANNELS
;

4052 
	`¡c
("Enjoy you¸³t. W©ch out,hey b™e!\n", 
ch
);

4053 
	`aù
("$Àpurcha£d $N‡ ¨³t.", 
ch
, 
nuÎ±r
, 
³t
, 
TO_ROOM
);

4058 
Ch¬aù”
 *
k“³r
;

4059 
Objeù
 *
obj
, *
t_obj
;

4060 
numb”
, 
couÁ
 = 1;

4062 ià((
k“³r
 = 
	`fšd_k“³r
(
ch
)è=ğ
nuÎ±r
)

4065 ià(
k“³r
->
š_room
->
	`gud
(è!ğ
Gud
::
nÚe


4066 && 
k“³r
->
š_room
->
	`gud
(è!ğ
ch
->
gud


4067 && !
	`IS_IMMORTAL
(
ch
)) {

4068 
	`aù
("$À‹Î you 'SÜry, memb” Úly.'", 
k“³r
, 
nuÎ±r
, 
ch
, 
TO_VICT
);

4072 
SŒšg
 
¬g
;

4073 
numb”
 = 
	`muÉ_¬gum’t
(
¬gum’t
, 
¬g
);

4075 
obj
 = 
	`g‘_obj_k“³r
(
ch
, 
k“³r
, 
¬g
);

4076 
co¡
 = 
	`g‘_co¡
(
k“³r
, 
obj
, 
Œue
);

4078 ià(
co¡
 <ğ0 || !
	`ÿn_£e_obj
(
ch
, 
obj
)) {

4079 
	`aù
("$nells you 'I don't sellhat --ry 'list''.",

4080 
k“³r
, 
nuÎ±r
, 
ch
, 
TO_VICT
);

4081 
ch
->
»¶y
 = 
k“³r
->
Çme
;

4086 ià(
numb”
 <= 0 ||‚umber >= 100) {

4087 
	`¡c
("SÜry, I dÚ'ˆhavth© mªy.\n", 
ch
);

4091 ià(!
	`IS_OBJ_STAT
(
obj
, 
ITEM_INVENTORY
)) {

4092 
t_obj
 = 
obj
->
Ãxt_cÚ‹Á
;

4093 
couÁ
 < 
numb”
 && 
t_obj
 !ğ
nuÎ±r
;

4094 
t_obj
 =_obj->
Ãxt_cÚ‹Á
) {

4095 ià(
t_obj
->
pIndexD©a
 =ğ
obj
->pIndexData

4096 && 
t_obj
->
shÜt_desü
 =ğ
obj
->short_descr)

4097 
couÁ
++;

4102 ià(
couÁ
 < 
numb”
) {

4103 
	`aù
("$nells you 'I don't havehat many in stock.",

4104 
k“³r
, 
nuÎ±r
, 
ch
, 
TO_VICT
);

4105 
ch
->
»¶y
 = 
k“³r
->
Çme
;

4110 ià(
k“³r
->
pIndexD©a
->
pShİ
->
	`is_que¡shİ
()) {

4111 ià(
ch
->
	`is_Åc
(è|| ch->
pcd©a
->
que¡pošts
 < 
co¡
 * 
numb”
) {

4112 
	`aù
("$nell you 'Sorry, but you don't haveƒnough quest…oints!'",

4113 
k“³r
, 
nuÎ±r
, 
ch
, 
TO_VICT
);

4114 
ch
->
»¶y
 = 
k“³r
->
Çme
;

4118 ià(
ÿsh_Ú_ch¬
 < (
co¡
 * 
numb”
)) {

4120 
Ãed_bªk_üed™
 = 
Œue
;

4123 ià((
ÿsh_Ú_ch¬
 + 
mÚey_š_bªk
è< ((
co¡
 * 
numb”
) + (cost *‚umber / 10))) {

4124 ià(
numb”
 > 1)

4125 
	`aù
("$nells you 'You can't‡ffordo buyhat many'.",

4126 
k“³r
, 
obj
, 
ch
, 
TO_VICT
);

4128 
	`aù
("$nells you 'You can't‡ffordo buy $p'.",

4129 
k“³r
, 
obj
, 
ch
, 
TO_VICT
);

4131 
ch
->
»¶y
 = 
k“³r
->
Çme
;

4136 ià(
obj
->
pIndexD©a
->
™em_ty³
 =ğ
ITEM_PILL
 || obj->pIndexD©a->™em_ty³ =ğ
ITEM_POTION
)

4137 
Ëv–_buyabË
 = 
ch
->
Ëv–
;

4139 
Ëv–_buyabË
 = 
	`g‘_u§bË_Ëv–
(
ch
);

4141 ià(
obj
->
Ëv–
 > 
Ëv–_buyabË
) {

4142 
	`aù
("$nells you 'You can't use $p yet'.",

4143 
k“³r
, 
obj
, 
ch
, 
TO_VICT
);

4144 
ch
->
»¶y
 = 
k“³r
->
Çme
;

4148 ià(
	`g‘_ÿ¼y_numb”
(
ch
è+ 
numb”
 * 
	`g‘_obj_numb”
(
obj
è> 
	`ÿn_ÿ¼y_n
(ch)) {

4149 
	`¡c
("You cª'ˆÿ¼yh© mªy i‹ms.\n", 
ch
);

4153 ià(
	`g‘_ÿ¼y_weight
(
ch
è+ 
numb”
 * 
	`g‘_obj_weight
(
obj
è> 
	`ÿn_ÿ¼y_w
(ch)) {

4154 
	`¡c
("You cª'ˆÿ¼yh© much weight.\n", 
ch
);

4159 ià(!
k“³r
->
pIndexD©a
->
pShİ
->
	`is_que¡shİ
()) {

4160 
rŞl
 = 
	`numb”_³rûÁ
();

4162 ià(
	`numb”_³rûÁ
(è< (
	`GET_ATTR_CHR
(
ch
) * 3))

4163 
rŞl
 -= 15;

4165 ià(
rŞl
 < 1)„oll = 1;

4167 ià(!
	`IS_OBJ_STAT
(
obj
, 
ITEM_SELL_EXTRACT
)

4168 && 
rŞl
 < 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
haggË
)

4169 && 
obj
->
pIndexD©a
->
™em_ty³
 !ğ
ITEM_MONEY
) {

4170 
co¡
 -ğ
obj
->co¡ / 2 * 
rŞl
 / 100;

4171 
	`aù
("You haggË w™h $N.", 
ch
, 
nuÎ±r
, 
k“³r
, 
TO_CHAR
);

4172 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
haggË
, 
Œue
, 4);

4175 ià(
numb”
 > 1) {

4176 
FÜm©
::
	`¥rštf
(
buf
, "$Àbuy $p[%d].", 
numb”
);

4177 
	`aù
(
buf
, 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

4178 
FÜm©
::
	`¥rštf
(
buf
, "You buy $p[%d] fÜ %d sv”.", 
numb”
, 
co¡
 *‚umber);

4179 
	`aù
(
buf
, 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

4182 
	`aù
("$Àbuy $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

4183 
FÜm©
::
	`¥rštf
(
buf
, "You buy $°fÜ %d sv”.", 
co¡
);

4184 
	`aù
(
buf
, 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

4190 
tÙ®_co¡
 = 
co¡
 * 
numb”
;

4192 ià(
Ãed_bªk_üed™
) {

4193 
tÙ®_co¡
 +=otal_cost / 10;

4195 
tÙ®_co¡
 -ğ
ÿsh_Ú_ch¬
;

4196 
ch
->
sv”
 = ch->
gŞd
 = 0;

4199 ià(
ch
->
sv”_š_bªk
 >ğ
tÙ®_co¡
)

4200 
ch
->
sv”_š_bªk
 -ğ
tÙ®_co¡
;

4202 
tÙ®_co¡
 -ğ
ch
->
sv”_š_bªk
;

4203 
ch
->
sv”_š_bªk
 = 0;

4204 
ch
->
gŞd_š_bªk
 -ğ(
co¡
 / 100) + 1;

4205 
ch
->
sv”_š_bªk
 = 100 - (
co¡
 % 100);

4209 
	`deduù_co¡
(
ch
, 
tÙ®_co¡
);

4211 
k“³r
->
gŞd
 +ğ
co¡
 * 
numb”
 / 100;

4212 
k“³r
->
sv”
 +ğ
co¡
 * 
numb”
 - (cost *‚umber / 100) * 100;

4216 ià(
numb”
 > 1) {

4217 
FÜm©
::
	`¥rštf
(
buf
, "$Àbuy $p[%d].", 
numb”
);

4218 
	`aù
(
buf
, 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

4219 
FÜm©
::
	`¥rštf
(
buf
, "You buy $p[%d] for %d Quest Points.",

4220 
numb”
, 
co¡
 *‚umber);

4221 
	`aù
(
buf
, 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

4224 
	`aù
("$Àbuy $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

4225 
FÜm©
::
	`¥rštf
(
buf
, "You buy $°fÜ %d Que¡ Pošts.", 
co¡
);

4226 
	`aù
(
buf
, 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

4229 
ch
->
pcd©a
->
que¡pošts
 -ğ
co¡
;

4232 
	`m´og_buy_Œigg”
(
k“³r
, 
ch
);

4234 ià(
k“³r
->
	`is_g¬bage
(è|| 
ch
->is_garbage())

4237 
couÁ
 = 0; couÁ < 
numb”
; count++) {

4238 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_INVENTORY
)) {

4239 
t_obj
 = 
	`ü—‹_objeù
(
obj
->
pIndexD©a
, obj->
Ëv–
);

4241 ià(! 
t_obj
) {

4242 
Loggšg
::
	`bug
("Memoryƒrror creating object in do_buy.", 0);

4247 
t_obj
 = 
obj
;

4248 
obj
 = obj->
Ãxt_cÚ‹Á
;

4249 
	`obj_äom_ch¬
(
t_obj
);

4253 ià(
k“³r
->
š_room
->
	`gud
(è!ğ
Gud
::
nÚe
) {

4254 
SŒšg
 
owÃr
;

4255 
ExŒaDesü
 *
ed
;

4256 
boŞ
 
foundŞd
 = 
çl£
;

4259 ià(
t_obj
->
exŒa_desü
 !ğ
nuÎ±r
) {

4260 
ed
 = 
t_obj
->
exŒa_desü
;ƒd !ğ
nuÎ±r
;ƒd =ƒd->
Ãxt
)

4261 ià(
ed
->
keywÜd
 =ğ
KEYWD_OWNER
) {

4262 
owÃr
 = 
ch
->
Çme
;

4263 
ed
->
desütiÚ
 = 
owÃr
;

4264 
foundŞd
 = 
Œue
;

4268 ià(!
foundŞd
) {

4269 
ed
 = 
Ãw
 
	`ExŒaDesü
(
KEYWD_OWNER
, 
ch
->
Çme
);

4270 
ed
->
Ãxt
 = 
t_obj
->
exŒa_desü
;

4271 
t_obj
->
exŒa_desü
 = 
ed
;

4275 
t_obj
->
tim”
 = 0;

4277 ià(
co¡
 < 
t_obj
->cost)

4278 
t_obj
->
co¡
 = cost;

4280 
	`obj_to_ch¬
(
t_obj
, 
ch
);

4283 
	}
}

4285 
	$do_li¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4287 
buf
[
MAX_STRING_LENGTH
];

4289 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_PET_SHOP
)) {

4290 
Room
 *
roomNext
;

4291 
Ch¬aù”
 *
³t
;

4292 
boŞ
 
found
;

4295 ià(
ch
->
š_room
->
loÿtiÚ
 =ğ
	`LoÿtiÚ
(
	`Vnum
(9621)))

4296 
roomNext
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(9706)));

4298 
roomNext
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ch
->
š_room
->
´ÙÙy³
.
vnum
.
	`v®ue
() + 1)));

4300 ià(
roomNext
 =ğ
nuÎ±r
) {

4301 
Loggšg
::
	`bugf
("Do_li¡: bad…‘ shİ‡ˆvnum %d.", 
ch
->
š_room
->
´ÙÙy³
.
vnum
);

4302 
	`¡c
("You cª'ˆdØth© h”e.\n", 
ch
);

4306 
found
 = 
çl£
;

4308 
³t
 = 
roomNext
->
³İË
;…‘;…‘ =…‘->
Ãxt_š_room
) {

4309 ià(
³t
->
aù_æags
.
	`has
(
ACT_PET
)) {

4310 ià(!
found
) {

4311 
found
 = 
Œue
;

4312 
	`¡c
("P‘ ªd ExÙiøCom·niÚ fÜ s®e:\n", 
ch
);

4315 
FÜm©
::
	`¥rštf
(
buf
, "[%2d] %8d - %s\n",

4316 
³t
->
Ëv–
,

4317 10 * 
³t
->
Ëv–
 *…et->level,

4318 
³t
->
shÜt_desü
);

4319 
	`¡c
(
buf
, 
ch
);

4323 ià(!
found
)

4324 
	`¡c
("SÜry, we'» ouˆoà³t righˆnow.\n", 
ch
);

4330 
Ch¬aù”
 *
k“³r
;

4331 
Objeù
 *
obj
;

4332 
co¡
, 
couÁ
;

4333 
boŞ
 
found
;

4335 ià((
k“³r
 = 
	`fšd_k“³r
(
ch
)è=ğ
nuÎ±r
)

4338 
SŒšg
 
¬g
;

4339 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

4340 
found
 = 
çl£
;

4342 
obj
 = 
k“³r
->
ÿ¼yšg
; obj; obj = obj->
Ãxt_cÚ‹Á
) {

4343 ià(
obj
->
w—r_loc
 =ğ
WEAR_NONE


4344 && 
	`ÿn_£e_obj
(
ch
, 
obj
)

4345 && (
co¡
 = 
	`g‘_co¡
(
k“³r
, 
obj
, 
Œue
)) > 0

4346 && (
¬g
.
	`em±y
()

4347 || 
obj
->
Çme
.
	`has_wÜds
(
¬g
))) {

4348 ià(!
found
) {

4349 
found
 = 
Œue
;

4351 ià(
k“³r
->
pIndexD©a
->
pShİ
->
	`is_que¡shİ
())

4352 
	`¡c
("{PAÎ…riû š QUEST POINTS!{x\n", 
ch
);

4354 
	`¡c
("[Lv Priû Qty] I‹m\n", 
ch
);

4357 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_INVENTORY
))

4358 
FÜm©
::
	`¥rštf
(
buf
, "[%2d %5d -- ] %s\n",

4359 
obj
->
Ëv–
, 
co¡
, obj->
shÜt_desü
);

4361 
couÁ
 = 1;

4363 
obj
->
Ãxt_cÚ‹Á
 !ğ
nuÎ±r


4364 && 
obj
->
pIndexD©a
 =ğobj->
Ãxt_cÚ‹Á
->pIndexData

4365 && 
obj
->
shÜt_desü
 =ğobj->
Ãxt_cÚ‹Á
->short_descr) {

4366 
obj
 = obj->
Ãxt_cÚ‹Á
;

4367 
couÁ
++;

4370 
FÜm©
::
	`¥rštf
(
buf
, "[%2d %5d %2d ] %s\n",

4371 
obj
->
Ëv–
, 
co¡
, 
couÁ
, obj->
shÜt_desü
);

4374 
	`¡c
(
buf
, 
ch
);

4378 ià(!
found
)

4379 
	`¡c
("You cª'ˆbuy‡nythšg h”e.\n", 
ch
);

4381 ià(
k“³r
->
pIndexD©a
->
pShİ
->
	`is_que¡shİ
()) {

4382 
	`¡c
("---------------------------\n", 
ch
);

4383 
	`¡c
("{PAÎ…riû š QUEST POINTS!{x\n", 
ch
);

4389 
	}
}

4391 
	$do_£Î
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4393 
buf
[
MAX_STRING_LENGTH
];

4394 
Ch¬aù”
 *
k“³r
;

4395 
Objeù
 *
obj
;

4396 
co¡
, 
rŞl
;

4398 ià(
¬gum’t
.
	`em±y
()) {

4399 
	`¡c
("S–Èwh©?\n", 
ch
);

4403 
SŒšg
 
¬g
;

4404 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

4406 ià((
k“³r
 = 
	`fšd_k“³r
(
ch
)è=ğ
nuÎ±r
)

4409 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

4410 
	`aù
("$nells you 'You don't havehat item'.",

4411 
k“³r
, 
nuÎ±r
, 
ch
, 
TO_VICT
);

4412 
ch
->
»¶y
 = 
k“³r
->
Çme
;

4416 ià(!
	`ÿn_drİ_obj
(
ch
, 
obj
)) {

4417 
	`¡c
("You cª'ˆËˆgØoà™.\n", 
ch
);

4421 ià(!
	`ÿn_£e_obj
(
k“³r
, 
obj
)) {

4422 
	`aù
("$ÀdÛ¢'ˆ£wh© you‡» ofãršg.", 
k“³r
, 
nuÎ±r
, 
ch
, 
TO_VICT
);

4426 ià(
k“³r
->
pIndexD©a
->
pShİ
->
	`is_que¡shİ
(è&& 
ch
->
	`is_Åc
()) {

4427 
	`¡c
("Mobe ÿn'ˆ£Î que¡ i‹ms.\n", 
ch
);

4431 ià((
co¡
 = 
	`g‘_co¡
(
k“³r
, 
obj
, 
çl£
)) <= 0) {

4432 
	`aù
("$ÀÏugh © $°ªd sugge¡ ¨nov– u£ fÜ it.", 
k“³r
, 
obj
, 
ch
, 
TO_VICT
);

4436 ià(!
k“³r
->
pIndexD©a
->
pShİ
->
	`is_que¡shİ
(è&& 
co¡
 > (k“³r->
sv”
 + 100 * k“³r->
gŞd
)) {

4437 
	`aù
("$nells you 'The shop has fallen upon hardimes. I cant‡fford $p.'",

4438 
k“³r
, 
obj
, 
ch
, 
TO_VICT
);

4442 
	`aù
("$À£Î $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

4444 ià(!
k“³r
->
pIndexD©a
->
pShİ
->
	`is_que¡shİ
()) {

4446 
rŞl
 = 
	`numb”_³rûÁ
();

4448 ià(
	`numb”_³rûÁ
(è< (
	`GET_ATTR_CHR
(
ch
) * 3))

4449 
rŞl
 -= 15;

4451 ià(
rŞl
 < 1)„oll = 1;

4453 ià(!
	`IS_OBJ_STAT
(
obj
, 
ITEM_SELL_EXTRACT
)

4454 && 
rŞl
 < 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
haggË
)

4455 && 
obj
->
pIndexD©a
->
™em_ty³
 !ğ
ITEM_MONEY
) {

4456 
	`¡c
("You haggË w™hhshİk“³r.\n", 
ch
);

4457 
co¡
 +ğ
obj
->co¡ / 2 * 
rŞl
 / 100;

4458 
co¡
 = 
¡d
::
	`mš
(co¡, 95 * 
	`g‘_co¡
(
k“³r
, 
obj
, 
Œue
) / 100);

4459 
co¡
 = 
¡d
::
	`mš
(co¡, (
k“³r
->
sv”
 + 100 * k“³r->
gŞd
));

4460 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
haggË
, 
Œue
, 4);

4463 
FÜm©
::
	`¥rštf
(
buf
, "You sell $p for %d silver‡nd %d gold…iece%s.",

4464 
co¡
 - (cost / 100) * 100, cost / 100, cost == 1 ? "" : "s");

4465 
	`aù
(
buf
, 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

4466 
ch
->
gŞd
 +ğ
co¡
 / 100;

4467 
ch
->
sv”
 +ğ
co¡
 - (cost / 100) * 100;

4468 
	`deduù_co¡
(
k“³r
, 
co¡
);

4470 ià(
k“³r
->
gŞd
 < 0)

4471 
k“³r
->
gŞd
 = 0;

4473 ià(
k“³r
->
sv”
 < 0)

4474 
k“³r
->
sv”
 = 0;

4477 
FÜm©
::
	`¥rštf
(
buf
, "You sell $p for %d Quest Point%s.",

4478 
co¡
, cost == 1 ? "" : "s");

4479 
	`aù
(
buf
, 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

4480 
ch
->
pcd©a
->
que¡pošts
 +ğ
co¡
;

4483 ià(
obj
->
™em_ty³
 =ğ
ITEM_TRASH


4484 || 
	`IS_OBJ_STAT
(
obj
, 
ITEM_SELL_EXTRACT
)

4485 || 
k“³r
->
pIndexD©a
->
pShİ
->
	`is_que¡shİ
())

4486 
	`exŒaù_obj
(
obj
);

4488 
	`obj_äom_ch¬
(
obj
);

4489 
obj
->
tim”
 = 
	`numb”_¿nge
(50, 100);

4490 
	`obj_to_k“³r
(
obj
, 
k“³r
);

4494 
	}
}

4496 
	$do_v®ue
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4498 
buf
[
MAX_STRING_LENGTH
];

4499 
Ch¬aù”
 *
k“³r
;

4500 
Objeù
 *
obj
;

4501 
co¡
;

4503 ià(
¬gum’t
.
	`em±y
()) {

4504 
	`¡c
("V®uwh©?\n", 
ch
);

4508 
SŒšg
 
¬g
;

4509 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

4511 ià((
k“³r
 = 
	`fšd_k“³r
(
ch
)è=ğ
nuÎ±r
)

4514 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

4515 
	`aù
("$nells you 'You don't havehat item'.",

4516 
k“³r
, 
nuÎ±r
, 
ch
, 
TO_VICT
);

4517 
ch
->
»¶y
 = 
k“³r
->
Çme
;

4521 ià(!
	`ÿn_£e_obj
(
k“³r
, 
obj
)) {

4522 
	`aù
("$ÀdÛ¢'ˆ£wh© you‡» ofãršg.", 
k“³r
, 
nuÎ±r
, 
ch
, 
TO_VICT
);

4526 ià(!
	`ÿn_drİ_obj
(
ch
, 
obj
)) {

4527 
	`¡c
("You cª'ˆËˆgØoà™.\n", 
ch
);

4531 ià((
co¡
 = 
	`g‘_co¡
(
k“³r
, 
obj
, 
çl£
)) <= 0) {

4532 
	`aù
("$ÀÏugh © $p.", 
k“³r
, 
obj
, 
ch
, 
TO_VICT
);

4536 ià(
k“³r
->
pIndexD©a
->
pShİ
->
	`is_que¡shİ
())

4537 
FÜm©
::
	`¥rštf
(
buf
, "$À‹Î you 'I'Î givyou %d que¡…ošt fÜ $p'.", 
co¡
);

4539 
FÜm©
::
	`¥rštf
(
buf
,

4541 
co¡
 - (cost / 100) * 100, cost / 100);

4544 
	`aù
(
buf
, 
k“³r
, 
obj
, 
ch
, 
TO_VICT
);

4545 
ch
->
»¶y
 = 
k“³r
->
Çme
;

4547 
	}
}

4550 
SŒšg
 
	$ªv_owÃr_Çme
(
Objeù
 *
ªv
)

4553 ià(
ªv
->
v®ue
[2] == 0)  "";

4556 ià(!
ªv
->
Çme
.
	`has_´efix
("anvil…rivate ")) {

4557 
Loggšg
::
	`bugf
("anvil_owner_name:‡nvil %d has‡…rivate flag but incorrect‚ame",

4558 
ªv
->
pIndexD©a
->
vnum
);

4562  
ªv
->
Çme
.
	`sub¡r
(
	`¡¾’
("anvil…rivate "));

4563 
	}
}

4566 
	$is_ªv_owÃr
(
Ch¬aù”
 *
ch
, 
Objeù
 *
ªv
)

4568  
	`ªv_owÃr_Çme
(
ªv
).
	`has_exaù_wÜds
(
ch
->
Çme
);

4569 
	}
}

4576 
	$fÜge_æag
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
Objeù
 *
ªv
)

4578 
Objeù
 *
w—pÚ
;

4579 
bË_num
, 
æag_couÁ
 = 0, 
evo
, 
qpco¡
;

4580 
evo
 = 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
fÜge
);

4583 ià((
w—pÚ
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
)è=ğ
nuÎ±r
) {

4584 
	`¡c
("You mu¡ bw›ldšg‡ w—pÚØfÜgæag upÚ!\n", 
ch
);

4589 ià(!
	`IS_IMMORTAL
(
ch
è&& 
w—pÚ
->
Ëv–
 < 30) {

4590 
	`¡c
("Thw—pÚ you‡» w›ldšg i nÙ…ow”fuÈ’oughØ»ûiv’hªûm’t.\n", 
ch
);

4594 
SŒšg
 
¬g
;

4595 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

4598 ià((
bË_num
 = 
	`afãù_šdex_lookup
(
¬g
, 
w—pÚ_afãùs
)) == -1) {

4599 
	`±c
(
ch
, "'%s' i nÙ‡ v®id w—pÚ fÏg‚ame, sÜry!\n", 
¬g
);

4603 
afãù
::
ty³
y³ = 
w—pÚ_afãùs
[
bË_num
].type;

4606 ià(
ty³
 =ğ
afãù
::ty³::
poisÚ


4607 || 
ty³
 =ğ
afãù
::ty³::
w—pÚ_sh¬p


4608 || 
ty³
 =ğ
afãù
::ty³::
w—pÚ_acidic


4609 || (
ty³
 =ğ
afãù
::ty³::
w—pÚ_vÜ·l
 && 
evo
 < 2)) {

4610 
	`¡c
("You cªnÙ fÜgth© fÏg.\n", 
ch
);

4618 ià(
afãù
::
	`exi¡s_Ú_obj
(
w—pÚ
,‡fãù::
ty³
::
w—pÚ_acidic
)è
æag_couÁ
++;

4619 ià(
afãù
::
	`exi¡s_Ú_obj
(
w—pÚ
,‡fãù::
ty³
::
w—pÚ_æamšg
)è
æag_couÁ
++;

4620 ià(
afãù
::
	`exi¡s_Ú_obj
(
w—pÚ
,‡fãù::
ty³
::
w—pÚ_äo¡
)è
æag_couÁ
++;

4621 ià(
afãù
::
	`exi¡s_Ú_obj
(
w—pÚ
,‡fãù::
ty³
::
w—pÚ_vampœic
)è
æag_couÁ
++;

4622 ià(
afãù
::
	`exi¡s_Ú_obj
(
w—pÚ
,‡fãù::
ty³
::
w—pÚ_shockšg
)è
æag_couÁ
++;

4624 ià((
æag_couÁ
 >ğ2 || (æag_couÁ >ğ1 && 
evo
 < 3))

4625 && 
ty³
 !ğ
afãù
::ty³::
w—pÚ_two_hªds


4626 && 
ty³
 !ğ
afãù
::ty³::
w—pÚ_vÜ·l
) {

4627 
	`¡c
("You cªnÙ fÜgªy mÜmagiÿÈæag Úh© w—pÚ.\n", 
ch
);

4634 ià(
ty³
 =ğ
afãù
::ty³::
w—pÚ_two_hªds
 &&‡fãù::
	`exi¡s_Ú_obj
(
w—pÚ
,ype)) {

4635 
	`aù
("$°i ®»ady‡wo-hªded w—pÚ.", 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_CHAR
);

4639 ià(
ty³
 =ğ
afãù
::ty³::
w—pÚ_acidic
 &&‡fãù::
	`exi¡s_Ú_obj
(
w—pÚ
,ype)) {

4640 
	`aù
("$°i ®»ady drpšg w™h‡cid.", 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_CHAR
);

4644 ià(
ty³
 =ğ
afãù
::ty³::
w—pÚ_æamšg
 &&‡fãù::
	`exi¡s_Ú_obj
(
w—pÚ
,ype)) {

4645 
	`aù
("$°i ®»ady‡ fÏmšg w—pÚ.", 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_CHAR
);

4649 ià(
ty³
 =ğ
afãù
::ty³::
w—pÚ_äo¡
 &&‡fãù::
	`exi¡s_Ú_obj
(
w—pÚ
,ype)) {

4650 
	`aù
("$p' i ®»ady cß‹d w™h iû.", 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_CHAR
);

4654 ià(
ty³
 =ğ
afãù
::ty³::
w—pÚ_vampœic
 &&‡fãù::
	`exi¡s_Ú_obj
(
w—pÚ
,ype)) {

4655 
	`aù
("$°®»ady dršk thblood oà™ viùim.", 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_CHAR
);

4659 ià(
ty³
 =ğ
afãù
::ty³::
w—pÚ_shockšg
 &&‡fãù::
	`exi¡s_Ú_obj
(
w—pÚ
,ype)) {

4660 
	`aù
("$°i ®»ady imbued w™h†ighŠšg.", 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_CHAR
);

4664 ià(
ty³
 =ğ
afãù
::ty³::
w—pÚ_vÜ·l
 &&‡fãù::
	`exi¡s_Ú_obj
(
w—pÚ
,ype)) {

4665 
	`aù
("$°i ®»ady sh¬°’oughØ£v”†imbs.", 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_CHAR
);

4670 ià(!
	`IS_IMMORTAL
(
ch
)) {

4671 
qpco¡
 = 
ªv
->
v®ue
[1];

4673 ià(
	`is_ªv_owÃr
(
ch
, 
ªv
))

4674 
qpco¡
 = 
ªv
->
v®ue
[4];

4676 ià(
æag_couÁ
 > 0)

4677 
qpco¡
 *= 5;

4680 
qpco¡
 = 0;

4683 ià(
ch
->
pcd©a
->
que¡pošts
 < 
qpco¡
) {

4684 
	`±c
(
ch
, "You†ackh»quœed %d que¡…ošt tØfÜgæag Úhi ªv.\n", 
qpco¡
);

4689 ià(
qpco¡
 > 0) {

4690 
	`±c
(
ch
, "IÀ¨ha¡y…¿y”, you ofã¸%d…ošt oàyou¸que¡šgƒx³r›nû‡ ¨§üifiû.\n", 
qpco¡
);

4691 
ch
->
pcd©a
->
que¡pošts
 -ğ
qpco¡
;

4694 
	`±c
(
ch
, "You grabhe smith hammer‚extohe‡nvil,†ay %s down uponhe‡nvil,‡nd strike it with‡ mighty blow! *CLING!*\n",

4695 
w—pÚ
->
shÜt_desü
);

4696 
	`aù
("$ÀÏy $°upÚhªv‡nd sŒike ™ w™h‡ mighty blow!", 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_ROOM
);

4698 ià(
	`IS_IMMORTAL
(
ch
è|| 
	`numb”_³rûÁ
(è< (
æag_couÁ
 >= 1 ? 50 : 30)) {

4699 
	`¡c
("Amid s·rk ªd„isšg smoke,‡ÀawesomŒªsfÜm©iÚ‡fãù you¸w—pÚ!\n", 
ch
);

4700 
	`aù
("$n' w—pÚ sŒike ¥¬k Úhªv,‡nd smokri£s. Iˆis... chªged!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4702 
afãù
::
Afãù
 
af
;

4703 
af
.
wh”e
 = 
TO_WEAPON
;

4704 
af
.
ty³
 =ype;

4705 
af
.
Ëv–
 = 
ch
->level;

4706 
af
.
du¿tiÚ
 = -1;

4707 
af
.
loÿtiÚ
 = 0;

4708 
af
.
modif›r
 = 0;

4709 
af
.
	`b™veùÜ
(0);

4710 
af
.
evŞutiÚ
 = 
evo
;

4711 
afãù
::
	`cİy_to_obj
(
w—pÚ
, &
af
);

4713 ià(
ty³
 =ğ
afãù
::ty³::
w—pÚ_two_hªds
) {

4714 ++
w—pÚ
->
v®ue
[1];

4715 
	`»move_obj
(
ch
, 
WEAR_WIELD
, 
Œue
);

4719 ià(
æag_couÁ
 >= 1) {

4720 
	`¡c
("You¸w—pÚ begš tØglow‡ brighˆy–lowh’ sudd’lyƒx¶odes!!!!!\n", 
ch
);

4721 
	`aù
("$n' w—pÚ glow ¨brighˆy–lowh’ sudd’lyƒx¶odes.\n", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4722 
	`de¡roy_obj
(
w—pÚ
);

4726 
	`¡c
("Thblow j¬ you¸¬m, buˆyou‚Ùiû‚Øchªgš you¸w—pÚ.\n", 
ch
);

4727 
	`aù
("$Àlook di§µoš‹d.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4731 
	}
}

4734 
	$do_hÚe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4736 
buf
[
MAX_STRING_LENGTH
];

4737 
Objeù
 *
w—pÚ
;

4738 
Objeù
 *
wh‘¡Úe
;

4739 
wh‘¡Úe
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_HOLD
);

4740 
w—pÚ
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
);

4742 ià(
ch
->
	`is_Åc
(è|| (
	`g‘_skl_Ëv–
(ch, 
skl
::
ty³
::
hÚe
) < 1)) {

4743 
	`¡c
("You†ackhskÈtØhÚw—pÚs.\n", 
ch
);

4747 ià(
w—pÚ
 =ğ
nuÎ±r
) {

4748 
	`¡c
("HÚwh©, you¸hªd? Try w›ldšg it.\n", 
ch
);

4752 ià(
afãù
::
	`exi¡s_Ú_obj
(
w—pÚ
,‡fãù::
ty³
::
w—pÚ_sh¬p
)) {

4753 
	`aù
("$°could‚Ù…ossibly bªy sh¬³r.", 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_CHAR
);

4757 ià((
©ck_bË
[
w—pÚ
->
v®ue
[3]].
damage
 !ğ
DAM_SLASH
)

4758 && (
©ck_bË
[
w—pÚ
->
v®ue
[3]].
damage
 !ğ
DAM_PIERCE
)) {

4759 
	`¡c
("You cª oÆy hÚedged w—pÚs.\n", 
ch
);

4763 ià((
wh‘¡Úe
 =ğ
nuÎ±r
è|| (!wh‘¡Úe->
Çme
.
	`has_wÜds
("whetstone"))) {

4764 
	`¡c
("How dØyouƒx³ùØsh¬³À¨w—pÚ w™houˆhŞdšg‡ wh‘¡Úe?\n", 
ch
);

4768 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
hÚe
))

4771 ià(!
	`IS_IMMORTAL
(
ch
)) {

4772 ià(
	`numb”_³rûÁ
(è> 
¡d
::
	`mš
(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
hÚe
), 95)) {

4773 
FÜm©
::
	`¥rštf
(
buf
, "You failo hone your weapon,‡nd you gouge %s deeply,„uining it.\n",

4774 
wh‘¡Úe
->
shÜt_desü
);

4775 
	`¡c
(
buf
, 
ch
);

4776 
	`aù
("$n' hªd sls,‡nd $ruš $ wh‘¡Úe.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4777 
	`de¡roy_obj
(
wh‘¡Úe
);

4782 
FÜm©
::
	`¥rštf
(
buf
, "You sklfuÎy hÚ% tØ¨¿zÜƒdge.\n", 
w—pÚ
->
shÜt_desü
);

4783 
	`aù
("$ÀsklfuÎy sh¬³n $°tØ¨¿zÜƒdge.", 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_ROOM
);

4784 
	`¡c
(
buf
, 
ch
);

4786 
afãù
::
Afãù
 
af
;

4787 
af
.
wh”e
 = 
TO_WEAPON
;

4788 
af
.
ty³
 = 
afãù
::ty³::
w—pÚ_sh¬p
;

4789 
af
.
Ëv–
 = 
ch
->level;

4790 
af
.
du¿tiÚ
 = 
ch
->
Ëv–
 * 5;

4791 
af
.
loÿtiÚ
 = 0;

4792 
af
.
modif›r
 = 0;

4793 
af
.
	`b™veùÜ
(0);

4794 
af
.
evŞutiÚ
 = 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
hÚe
);

4795 
afãù
::
	`cİy_to_obj
(
w—pÚ
, &
af
);

4797 
	}
}

4799 
	$do_fÜge
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4801 
Objeù
 *
obj
, *
ªv
 = 
nuÎ±r
, *
m©”Ÿl
;

4802 
Ch¬aù”
 *
owÃr
;

4803 
SŒšg
 
buf
;

4804 
sdesc
[
MSL
], 
co¡buf
[MSL];

4805 
ExŒaDesü
 *
ed
;

4806 
is_owÃr
, 
co¡
, 
co¡_gŞd
, 
co¡_sv”
, 
evo
;

4807 
evo
 = 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
fÜge
);

4810 
SŒšg
 
ty³
;

4811 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
ty³
);

4813 ià(
¬gum’t
.
	`em±y
(è|| 
ty³
.empty()) {

4814 ià(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
fÜge
))

4815 
	`¡c
("Syntax: {Rforge{x <weaponype> <weapon‚ame>\n"

4816 " {RfÜgæag{x <æagy³>\n", 
ch
);

4818 
	`¡c
("SyÁax: {RfÜgæag{x <æagy³>\n", 
ch
);

4820 
	`¡c
("PossibË fÏgy³ ¬e: fÏmšg, fro¡, shockšg, vampœic, vÜ·l, o¸twohªded.\n", 
ch
);

4821 
	`¡c
("(£HELP FORGE fÜ d‘as)\n", 
ch
);

4826 
obj
 = 
ch
->
š_room
->
cÚ‹Ás
; obj; obj = obj->
Ãxt_cÚ‹Á
) {

4827 ià(
obj
->
™em_ty³
 =ğ
ITEM_ANVIL
) {

4828 
ªv
 = 
obj
;

4833 ià(
ªv
 =ğ
nuÎ±r
 && !
	`IS_IMMORTAL
(
ch
)) {

4834 
	`¡c
("How dØyou…rİo£ØfÜgw™houˆª‡nv?\n", 
ch
);

4835 
	`¡c
("A…ubliøªv may bfound iÀthsm™hy b–ow GriswŞd' R•aœ Shİ.\n", 
ch
);

4840 ià(
ty³
.
	`is_´efix_of
("æag"è&& !
ch
->
	`is_Åc
()) {

4841 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
fÜge
))

4844 
	`fÜge_æag
(
ch
, 
¬gum’t
, 
ªv
);

4849 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
fÜge
)) {

4850 
	`¡c
("You stand beforehe‡nvil, feeling foolish.\n"

4851 "LackšghskÈtØfÜge, you would oÆy„ušhm©”Ÿl.\n", 
ch
);

4855 ià(
	`w—pÚ_lookup
(
ty³
) == -1) {

4856 
	`¡c
("Th© i nÙ‡ v®id w—pÚy³.\n", 
ch
);

4861 ià(
	`IS_IMMORTAL
(
ch
)) {

4862 
is_owÃr
 = 0;

4863 
co¡
 = 0;

4866 
is_owÃr
 = 
	`is_ªv_owÃr
(
ch
, 
ªv
);

4867 
co¡
 = 
is_owÃr
 ? 
ªv
->
v®ue
[3] :‡nvil->value[0];

4869 ià(
co¡
 > 0) {

4870 ià(100 * 
ch
->
gŞd
 + ch->
sv”
 < 
co¡
) {

4871 
	`±c
(
ch
, "Iˆco¡ %d sv”ØfÜgÚhi ªv,‡nd you dÚ'ˆhavth© much!\n", 
co¡
);

4877 ià(
¬gum’t
.
	`uncŞÜ
().
	`size
() > 30) {

4878 
	`¡c
("Nami lim™edØ30…rš‹d ch¬aù”s.\n", 
ch
);

4882 ià((
m©”Ÿl
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_HOLD
)è=ğ
nuÎ±r
) {

4883 
	`¡c
("You‡»‚Ù hŞdšg‡ny m©”Ÿl tØmak¨w—pÚ!\n", 
ch
);

4887 ià(
m©”Ÿl
->
™em_ty³
 !ğ
ITEM_MATERIAL
) {

4888 
	`¡c
("Th© i nÙ‡ u£abË m©”Ÿl!\n", 
ch
);

4892 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
fÜge
))

4895 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
fÜge
).
b—ts
);

4897 ià(!
	`IS_IMMORTAL
(
ch
è&& 
	`numb”_³rûÁ
(è> (
	`g‘_skl_Ëv–
(ch, 
skl
::
ty³
::
fÜge
è+ 
m©”Ÿl
->
v®ue
[0] +

4898 
	`GET_ATTR
(
ch
, 
APPLY_FORGE_UNIQUE
))) {

4899 
	`¡c
("You faØfÜg¨u£fuÈw—pÚ.\n", 
ch
);

4900 
	`aù
("$ÀŒ› buˆç tØfÜg¨u£fuÈw—pÚ.\n", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4901 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
fÜge
, 
çl£
, 1);

4902 
	`de¡roy_obj
(
m©”Ÿl
);

4906 
obj
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_WEAPON
), 0);

4908 ià(!
obj
) {

4909 
Loggšg
::
	`bug
("Memoryƒrror in do_forge.", 0);

4910 
	`¡c
("AÀ”rÜ occu»d whŒyšgØfÜge.\n", 
ch
);

4914 
obj
->
Ëv–
 = 
ch
->level;

4915 
obj
->
m©”Ÿl
 = material->material;

4916 
obj
->
cÚd™iÚ
 = 
m©”Ÿl
->condition;

4918 
obj
->
exŒa_æags
 = 
m©”Ÿl
->extra_flags;

4920 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
m©”Ÿl
);…af;…aàğ·f->
Ãxt
)

4921 
afãù
::
	`cİy_to_obj
(
obj
, 
·f
);

4923 
obj
->
v®ue
[0] = 
	`g‘_w—pÚ_ty³
(
ty³
);

4924 
FÜm©
::
	`¥rštf
(
buf
, "% %s", 
w—pÚ_bË
[
	`w—pÚ_lookup
(
ty³
)].
Çme
, 
¬gum’t
.
	`uncŞÜ
());

4925 
obj
->
Çme
 = 
buf
;

4926 
FÜm©
::
	`¥rštf
(
sdesc
, "%s{x", 
¬gum’t
);

4927 
obj
->
shÜt_desü
 = 
sdesc
;

4928 
FÜm©
::
	`¥rštf
(
buf
, "A % i h”e, fÜged by %s' üaásmªsh.", 
w—pÚ_bË
[
	`w—pÚ_lookup
(
ty³
)].
Çme
, 
ch
->name);

4929 
obj
->
desütiÚ
 = 
buf
;

4930 
FÜm©
::
	`¥rštf
(
buf
, "It is‡ marvellous %s, crafted fromhe finest %s‡round.\n"

4933 
w—pÚ_bË
[
	`w—pÚ_lookup
(
ty³
)].
Çme
, 
obj
->
m©”Ÿl
,

4934 
ch
->
š_room
->
	`¬—
().
wÜld
.
time
.
	`mÚth_Çme
(),

4935 (
ch
->
Ëv–
 > 
LEVEL_HERO
) ? "an immortal" : (ch->level > 75) ? "a master" :

4936 (
ch
->
Ëv–
 > 50) ? "anƒxperienced" : (ch->level > 25) ? "a young" : "a‚ewbie",

4937 
ch
->
gud
 =ğ
Gud
::
nÚe
 ? "adv’tu»r" : 
gud_bË
[ch->gud].
Çme
,

4938 
ch
->
Çme
, 
¿û_bË
[ch->
¿û
].name);

4939 
ed
 = 
Ãw
 
	`ExŒaDesü
(
obj
->
Çme
, 
buf
);

4940 
ed
->
Ãxt
 = 
obj
->
exŒa_desü
;

4941 
obj
->
exŒa_desü
 = 
ed
;

4942 
obj
->
v®ue
[1] = 5;

4943 
obj
->
v®ue
[2] = 
	`numb”_fuzzy
(
ch
->
Ëv–
 / 5);

4945 ià(
evo
 == 2)

4946 
obj
->
v®ue
[2] += 1;

4948 ià(
evo
 == 3)

4949 
obj
->
v®ue
[2] += 2;

4951 ià(
evo
 == 4)

4952 
obj
->
v®ue
[2] += 3;

4954 
obj
->
v®ue
[0]) {

4955 
WEAPON_SWORD
 : 
obj
->
v®ue
[3] = 
	`©ck_lookup
("slash"); ;

4957 
WEAPON_MACE
 : 
obj
->
v®ue
[3] = 
	`©ck_lookup
("pound"); ;

4959 
WEAPON_DAGGER
 : 
obj
->
v®ue
[3] = 
	`©ck_lookup
("pierce"); ;

4961 
WEAPON_AXE
 : 
obj
->
v®ue
[3] = 
	`©ck_lookup
("chop"); ;

4963 
WEAPON_SPEAR
 : 
obj
->
v®ue
[3] = 
	`©ck_lookup
("thrust"); ;

4965 
WEAPON_FLAIL
 : 
obj
->
v®ue
[3] = 
	`©ck_lookup
("crush"); ;

4967 
WEAPON_WHIP
 : 
obj
->
v®ue
[3] = 
	`©ck_lookup
("whip"); ;

4969 
WEAPON_POLEARM
: 
obj
->
v®ue
[3] = 
	`©ck_lookup
("beating"); ;

4970 
WEAPON_BOW
 : 
obj
->
v®ue
[3] = 
	`©ck_lookup
("arrow"); ;

4973 
obj
->
weight
 = 
	`numb”_fuzzy
(
	`numb”_¿nge
(
ch
->
Ëv–
 / 10, ch->level / 15) * 10);

4974 
obj
->
co¡
 = 
ch
->
Ëv–
 / 
	`numb”_¿nge
(1, 10);

4976 
obj
->
v®ue
[1] +ğ
m©”Ÿl
->value[1];

4977 
obj
->
v®ue
[2] +ğ
m©”Ÿl
->value[2];

4979 ià(
ch
->
Ëv–
 >= 50)

4980 
obj
->
v®ue
[2] += 1;

4982 
	`obj_to_ch¬
(
obj
, 
ch
);

4984 
FÜm©
::
	`¥rštf
(
buf
, "%s %s into‡ formidable %s\ncalled \"%s\".\n",

4986 
m©”Ÿl
->
shÜt_desü
,

4987 
w—pÚ_bË
[
	`w—pÚ_lookup
(
ty³
)].
Çme
,

4988 
obj
->
shÜt_desü
);

4989 
	`¡c
(
buf
, 
ch
);

4990 
FÜm©
::
	`¥rštf
(
buf
, "% ha fÜged‡ % Çmed \"%s\".", 
ch
->
Çme
,

4991 
w—pÚ_bË
[
	`w—pÚ_lookup
(
ty³
)].
Çme
, 
obj
->
shÜt_desü
);

4992 
	`aù
(
buf
, 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

4993 
	`de¡roy_obj
(
m©”Ÿl
);

4994 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
fÜge
, 
Œue
, 1);

4997 ià(
co¡
 > 0) {

4998 ià(
ªv
->
v®ue
[2] == 0) {

4999 
FÜm©
::
	`¥rštf
(
buf
,

5001 
co¡
);

5002 
	`¡c
(
buf
, 
ch
);

5005 
FÜm©
::
	`¥rštf
(
buf
,

5007 
co¡
);

5008 
	`¡c
(
buf
, 
ch
);

5010 ià(! 
is_owÃr
) {

5011 
owÃr
 = 
	`g‘_ch¬_wÜld
(
ch
, 
	`ªv_owÃr_Çme
(
ªv
), 
VIS_CHAR
);

5013 ià(
owÃr
 !ğ
nuÎ±r
) {

5014 
co¡_gŞd
 = 
co¡
 / 100;

5015 
co¡_sv”
 = 
co¡
 - 100 * 
co¡_gŞd
;

5016 
FÜm©
::
	`¥rštf
(
buf
, "% ·y you ", 
ch
->
Çme
);

5018 ià(
co¡_gŞd
 > 0) {

5019 
FÜm©
::
	`¥rštf
(
co¡buf
, "%d gŞd ", 
co¡_gŞd
);

5020 
buf
 +ğ
co¡buf
;

5022 ià(
co¡_sv”
 > 0è
buf
 += "and ";

5025 ià(
co¡_sv”
 > 0) {

5026 
FÜm©
::
	`¥rštf
(
co¡buf
, "%d sv” ", 
co¡_sv”
);

5027 
buf
 +ğ
co¡buf
;

5030 
buf
 += "forhe use of your‡nvil.\n";

5031 
	`¡c
(
buf
, 
owÃr
);

5032 
owÃr
->
gŞd
 +ğ
co¡_gŞd
;

5033 
owÃr
->
sv”
 +ğ
co¡_sv”
;

5038 
	`deduù_co¡
(
ch
, 
co¡
);

5040 
	}
}

5043 
	$do_’g¿ve
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5045 
Ch¬aù”
 *
jew–”
 = 
nuÎ±r
;

5046 
Objeù
 *
w—pÚ
;

5047 
ExŒaDesü
 *
ed
;

5048 
ExŒaDesü
 *
’g_desc
;

5049 
ExŒaDesü
 *
dæt_desc
;

5050 
buf
[10 * 
MAX_INPUT_LENGTH
];

5051 *
pd
;

5052 *
pb
;

5053 *
l2
, *
ld
, *
Ï
;

5054 
lšes
;

5055 
c0
;

5056 
SŒšg
 
dbuf
;

5057 *
’g_lše
;

5059 ià(!
	`IS_IMMORTAL
(
ch
) &&

5060 (
jew–”
 = 
	`g‘_mob_h”e
(
ch
, "jew–”", 
VIS_CHAR
)è=ğ
nuÎ±r
 &&

5061 (
jew–”
 = 
	`g‘_mob_h”e
(
ch
, "jew–Ër", 
VIS_CHAR
)è=ğ
nuÎ±r
) {

5062 
	`¡c
("You‚“d‡ jew–”' ’g¿všgoŞ tØ’g¿ve.\n", 
ch
);

5063 
	`¡c
("Fšd‡ jew–”‡ndry‡gaš oÀhi Ü h”…»mi£s!\n", 
ch
);

5067 ià((
w—pÚ
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
)è=ğ
nuÎ±r
) {

5068 
	`¡c
("You mu¡ {Rw›ld{x‡ w—pÚ iÀÜd”Ø’g¿v™.\n", 
ch
);

5072 ià(
¬gum’t
.
	`em±y
()) {

5073 
	`¡c
("Wh© dØyou wªˆtØ’g¿vÚ you¸w—pÚ?\n", 
ch
);

5079 ià(!
	`IS_IMMORTAL
(
ch
è&& 
¬gum’t
.
	`uncŞÜ
().
	`size
() > 75) {

5080 
	`check_socŸl
(
jew–”
, "snort", "");

5082 
	`¡c
(" \"ThbÏdoà¨w—pÚ i nÙ su™ed fÜhG»© Th”ª Nov–!\"\n", 
ch
);

5083 
	`¡c
(" \"A…rofound s’tim’t, w–Èex´es£d, wÈbnØlÚg”hªhi £Á’û.\"\n", 
ch
);

5090 
’g_lše
 = "There‡re some…ersonal {Cengravings{x onhis weapon.\n";

5091 
’g_desc
 = 
nuÎ±r
;

5092 
dæt_desc
 = 
nuÎ±r
;

5094 
SŒšg
 
tbuf
;

5095 
	`Úe_¬gum’t
(
w—pÚ
->
Çme
, 
tbuf
);

5096 
	`¡rıy
(
buf
, 
tbuf
);

5098 
ed
 = 
w—pÚ
->
exŒa_desü
;ƒd;ƒd =ƒd->
Ãxt
) {

5099 ià(
dæt_desc
 =ğ
nuÎ±r
 && 
ed
->
keywÜd
.
	`has_wÜds
(
buf
))

5100 
dæt_desc
 = 
ed
;

5102 ià(
’g_desc
 =ğ
nuÎ±r
 && 
ed
->
keywÜd
.
	`has_wÜds
("engravings"))

5103 
’g_desc
 = 
ed
;

5106 ià(
’g_desc
 =ğ
nuÎ±r
) {

5108 
’g_desc
 = 
Ãw
 
	`ExŒaDesü
("engravings", "\n");

5109 
’g_desc
->
Ãxt
 = 
w—pÚ
->
exŒa_desü
;

5110 
w—pÚ
->
exŒa_desü
 = 
’g_desc
;

5113 ià(
dæt_desc
 =ğ
nuÎ±r
) {

5115 
dæt_desc
 = 
Ãw
 
	`ExŒaDesü
(

5116 
w—pÚ
->
Çme
,

5117 !
w—pÚ
->
desütiÚ
.
	`em±y
() ?

5118 (
dbuf
 +ğ
w—pÚ
->
desütiÚ
 + "\n" + 
’g_lše
) :ƒng_line);

5120 
dæt_desc
->
Ãxt
 = 
w—pÚ
->
exŒa_desü
;

5121 
w—pÚ
->
exŒa_desü
 = 
dæt_desc
;

5123 ià(
	`¡r¡r
(
dæt_desc
->
desütiÚ
, 
’g_lše
è=ğ
nuÎ±r
) {

5125 
dbuf
 +ğ
dæt_desc
->
desütiÚ
;

5126 
dbuf
 +ğ
’g_lše
;

5127 
dæt_desc
->
desütiÚ
 = 
dbuf
;

5128 
dbuf
.
	`”a£
();

5139 
lšes
 = 1;

5140 
l2
 = 
nuÎ±r
;

5141 
ld
 = 
nuÎ±r
;

5142 
Ï
 = 
nuÎ±r
;

5143 
pb
 = 
buf
;

5144 
tdesc
[10*
MIL
];

5145 
	`¡rıy
(
tdesc
, 
’g_desc
->
desütiÚ
);

5147 
pd
 = 
tdesc
; *pd;) {

5148 ià(
pd
[0] == '\n') {

5149 *
pb
++ = *
pd
++;

5150 *
pb
 = '\0';

5152 ià(++
lšes
 =ğ2 && *
pd
 != '\0')

5153 
l2
 = 
pd
;

5156 *
pb
++ = *
pd
++;

5161 ià(
ld
 =ğ
nuÎ±r
 &&

5162 
buf
[0] == '[' &&

5163 
	`isdig™
(
buf
[1]) &&

5164 
	`isdig™
(
buf
[2]) &&

5165 
	`isdig™
(
buf
[3]) &&

5166 
	`isdig™
(
buf
[4]) &&

5167 
	`isdig™
(
buf
[5]) &&

5168 
	`isdig™
(
buf
[6]) &&

5169 
buf
[7] == ']' &&

5170 
buf
[8] == ' ' &&

5171 
buf
[9] == '{' &&

5172 
	`i§Íha
(
buf
[10]) &&

5173 !
	`¡ºcmp
(
ch
->
Çme
, 
buf
 + 11, 
	`¡¾’
(ch->name)) &&

5174 
buf
[11 + 
	`¡¾’
(
ch
->
Çme
)] == '{')

5175 
ld
 = 
pd
 - 
	`¡¾’
(
buf
);

5176 ià(
Ï
 =ğ
nuÎ±r
 && 
ld
 !=‚ullptr)

5177 
Ï
 = 
pd
;

5179 
pb
 = 
buf
;

5184 ià(
ld
 !ğ
nuÎ±r
) {

5185 
c0
 = *
ld
;

5186 *
ld
 = '\0';

5187 
dbuf
 +ğ
’g_desc
->
desütiÚ
;

5188 *
ld
 = 
c0
;

5189 
dbuf
 +ğ
Ï
;

5191 ià(
lšes
 > 20)

5192 
dbuf
 +ğ
l2
;

5194 
dbuf
 +ğ
’g_desc
->
desütiÚ
;

5196 
	`¡ráime
(
buf
, 9, "[%m/%d] ", 
	`loÿÉime
(&
Game
::
cu¼’t_time
));

5197 
dbuf
 +ğ
buf
;

5199 ià(
ch
->
	`is_Åc
()) {

5200 
FÜm©
::
	`¥rštf
(
buf
, "{Y%s{x, {Mc™iz’ oà%s,", 
ch
->
shÜt_desü
,

5201 
ch
->
š_room
 && !ch->š_room->
	`¬—
().
Çme
.
	`em±y
() ?

5202 
ch
->
š_room
->
	`¬—
().
Çme
 : "Thera");

5205 
FÜm©
::
	`¥rštf
(
buf
, "{Y%s{W%s{x ", 
ch
->
Çme
,

5206 
ch
->
pcd©a
 && !ch->pcd©a->
t™Ë
.
	`em±y
() ?

5207 
ch
->
pcd©a
->
t™Ë
 : "{M(adventurer of Thera){x");

5210 
dbuf
 +ğ
buf
;

5211 
FÜm©
::
	`¥rštf
(
buf
, "’g¿ved {Ythis{x:\À\"%s\".\n", 
¬gum’t
);

5212 
dbuf
 +ğ
buf
;

5213 
’g_desc
->
desütiÚ
 = 
dbuf
;

5214 
	`¡c
("You havËá‡ m¬k oàdu¿tiÚ upÚ you¸w—pÚ.\n", 
ch
);

5215 
	`aù
("$ÀsŞemÆyƒng¿ve $ w—pÚ.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5216 
	}
}

5219 
	$do_weddšgršg
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5221 
Ch¬aù”
 *
jew–”
 = 
nuÎ±r
;

5222 
Objeù
 *
ršg
;

5223 
´iû
 = 0;

5225 ià(
ch
->
desc
->
Üigš®
 !ğ
nuÎ±r
) {

5226 
	`¡c
("Sw™ch backØyou¸»® fÜm!\n", 
ch
);

5230 ià(!
	`IS_IMMORTAL
(
ch
) &&

5231 (
jew–”
 = 
	`g‘_mob_h”e
(
ch
, "jew–”", 
VIS_CHAR
)è=ğ
nuÎ±r
 &&

5232 (
jew–”
 = 
	`g‘_mob_h”e
(
ch
, "jew–Ër", 
VIS_CHAR
)è=ğ
nuÎ±r
) {

5233 
	`¡c
("You‚“d‡ jew–”' ’g¿všgoŞ tØ’g¿ve.\n", 
ch
);

5234 
	`¡c
("Fšd‡ jew–”‡ndry‡gaš oÀhi Ü h”…»mi£s!\n", 
ch
);

5238 ià((
ršg
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WEDDINGRING
)è=ğ
nuÎ±r
) {

5239 
	`¡c
("You mu¡ {Rw—r{x you¸weddšg„šg iÀÜd”Øhav™ chªged.\n", 
ch
);

5243 
SŒšg
 
¬g1
;

5244 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

5246 ià(
¬g1
.
	`em±y
(è|| 
¬gum’t
.empty())

5247 
h–p
;

5249 ià(!
	`IS_IMMORTAL
(
ch
))

5250 
´iû
 = 2 * 
¬gum’t
.
	`uncŞÜ
().
	`size
();

5252 ià(
´iû
 > 100 && !
	`IS_IMMORTAL
(
ch
)) {

5253 
	`¡c
("Thjew–”ƒxşaim 'Th©' toØlÚg! It'Î‚ev” f™ oÀsuch‡šy„šg!\n", 
ch
);

5257 ià((
ch
->
sv”
 + ch->
gŞd
 * 100è< 
´iû
) {

5258 
	`±c
(
ch
, "A desütiÚ†ikth© co¡ %d gŞd. And you dÚ'ˆhavth© much, dØyou?\n", 
´iû
);

5262 ià(
¬g1
.
	`is_´efix_of
("long")) {

5263 
	`±c
(
ch
, "ThlÚg desütiÚ oàyou¸weddšgršg i now:\n{x'%s{x'.\n", 
¬gum’t
);

5264 
ršg
->
desütiÚ
 = 
¬gum’t
;

5266 ià(
¬g1
.
	`is_´efix_of
("short")) {

5267 
	`±c
(
ch
, "ThshÜˆdesütiÚ oàyou¸weddšgršg i now:\n{x'%s{x'.\n", 
¬gum’t
);

5268 
ršg
->
shÜt_desü
 = 
¬gum’t
;

5271 
h–p
;

5273 
	`deduù_co¡
(
ch
, 
´iû
 * 100);

5274 
	`±c
(
ch
, "You…ayhjew–” %d gŞd.\n", 
´iû
);

5276 
h–p
:

5277 
	`¡c
("Thjew–”ƒx¶aš tØyouhsyÁax you should u£:\n", 
ch
);

5278 
	`¡c
("weddšgršg shÜˆ<‹xt>\n", 
ch
);

5279 
	`¡c
("weddšgršg†Úg <‹xt>\n", 
ch
);

5280 
	`¡c
("\nTh´iû i 2 gŞd…›û fÜƒv”y ch¬aù” oà‹xt.\n", 
ch
);

5282 
	}
}

5284 
	$do_lÜe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5286 
Objeù
 *
obj
;

5288 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
lÜe
)) {

5289 
	`¡c
("You‡»n'ˆŒašed iÀthlÜoà™ems.\n", 
ch
);

5293 ià(
¬gum’t
.
	`em±y
()) {

5294 
	`¡c
("Wh© dØyou wªˆtØlÜe?\n", 
ch
);

5298 
SŒšg
 
¬g
;

5299 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

5301 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g
)è=ğ
nuÎ±r


5302 && (
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

5303 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

5307 ià(!
	`´d_chªû
(&
ch
->
skl_çs
, 
	`g‘_skl_Ëv–
(ch, 
skl
::
ty³
::
lÜe
))) {

5308 
	`aù
("You†ook‡ˆ$p, buˆyou cª'ˆfšd ouˆªy‡dd™iÚ® infÜm©iÚ.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5309 
	`aù
("$Àlook © $°buˆÿÂÙ fšd ouˆªythšg.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

5313 
	`aù
("$À¡ud› $p, discov”šg‡Î oà™ hidd’…ow”s.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

5314 
	`¥–l_id’tify
(
skl
::
ty³
::
lÜe
, (4 * 
obj
->
Ëv–
è/ 3, 
ch
, obj, 
TARGET_OBJ
, 
	`g‘_evŞutiÚ
(ch, skill::type::lore));

5315 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
lÜe
, 
Œue
, 4);

5317 
	}
}

5319 
	$do_autog¿ph
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5321 
Objeù
 *
obj
;

5322 
buf
[
MSL
];

5324 
SŒšg
 
¬g
;

5325 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

5327 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

5328 
	`¡c
("You‡»‚Ù c¬ryšgh©.\n", 
ch
);

5332 
FÜm©
::
	`¥rštf
(
buf
, "% {c×utog¿phed){x", 
obj
->
shÜt_desü
);

5333 
obj
->
shÜt_desü
 = 
buf
;

5334 
	`¡c
("You sigÀthÿrd.\n", 
ch
);

5335 
	}
}

5341 
	$do_»Çme
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5343 
Ch¬aù”
 *
³t
;

5344 
Ãw_Çme
[64];

5347 ià(! 
ch
->
³t
) {

5348 
	`¡c
("You havnØ³t.\n", 
ch
);

5353 ià(
¬gum’t
.
	`em±y
()) {

5354 
	`¡c
("So...™' ¨NØNamb¿nd?\n", 
ch
);

5359 ià(
	`¡¾’
(
¬gum’t
) > 60) {

5360 
	`¡c
("Th© i ¨mouth fuÎ!\n", 
ch
);

5364 
³t
 = 
ch
->pet;

5367 ià(
	`¡rchr
(
³t
->
Çme
, '~')) {

5368 
	`¡c
("You¸³ˆha ª inv®id‚ame!\n", 
ch
);

5372 ià(
	`¡rchr
(
¬gum’t
, '~')) {

5373 
	`¡c
("Th© i nÙ‡ v®id‚amfÜ you¸³t!\n", 
ch
);

5377 
FÜm©
::
	`¥rštf
(
Ãw_Çme
, "% %s", 
³t
->
Çme
, 
¬gum’t
);

5378 
³t
->
Çme
 = 
Ãw_Çme
;

5379 
	`¡c
("You¸³ˆha now b“ÀÇmed ", 
ch
);

5380 
	`¡c
(
¬gum’t
, 
ch
);

5381 
	`¡c
(".\n", 
ch
);

5382 
	}
}

	@src/affect/affect.cc

1 
	~"afãù/Afãù.hh
"

2 
	~"Loggšg.hh
"

3 
	~"¿ndom.hh
"

5 
Çme¥aû
 
	gafãù
 {

9 
â_debug
(
Afãù
 *
node
, *
d©a
) {

10 *
	gcouÁ
 = (*)
d©a
;

13 (*
	gcouÁ
)++;

14 
	gLoggšg
::
bugf
("ÿÎback %d iÀafãù %d", *
couÁ
, 
node
->
ty³
);

18 
â_çde_¥–l
(
Afãù
 *
node
, *
d©a
) {

19 ::
afãù
::
ty³
y³ = ::afãù::ty³::
nÚe
;

21 ià(
	gd©a
 !ğ
nuÎ±r
) {

22 
â_d©a_cÚš”_ty³
 *
cÚš”
 = (â_d©a_cÚš”_ty³ *)
d©a
;

23 
	gty³
 = 
cÚš”
->
ty³
;

26 ià(
	gnode
->
	gdu¿tiÚ
 > 0

27 && (
	gty³
 =ğ::
afãù
::
ty³
::
nÚe
 || 
node
->type ==ype)) {

28 
node
->
du¿tiÚ
--;

30 ià(
	gnode
->
	gËv–
 > 0 && 
rŞl_chªû
(80))

31 
	gnode
->
	gËv–
--;

37 
â_£t_Ëv–
(
Afãù
 *
node
, *
d©a
) {

38 
	gËv–
 = *(*)
d©a
;

39 
	gnode
->
	gËv–
 = 
Ëv–
;

45 
com·¿tÜ_m¬k
(cÚ¡ 
Afãù
 *
lhs
, cÚ¡ Afãù *
rhs
) {

46  
	glhs
->
	gm¬k
 - 
	grhs
->mark;

49 
com·¿tÜ_du¿tiÚ
(cÚ¡ 
Afãù
 *
lhs
, cÚ¡ Afãù *
rhs
) {

50  
	glhs
->
	gdu¿tiÚ
 - 
	grhs
->duration;

53 
com·¿tÜ_ty³
(cÚ¡ 
Afãù
 *
lhs
, cÚ¡ Afãù *
rhs
) {

54 ià(
	glhs
->
	gty³
 < 
	grhs
->type)  -1;

55 ià(
	grhs
->
	gty³
 < 
	glhs
->type)  1;

59 
com·¿tÜ_³rmª’t
(cÚ¡ 
Afãù
 *
lhs
, cÚ¡ Afãù *
rhs
) {

60  (
	glhs
->
	g³rmª’t
 =ğ
rhs
->
³rmª’t
) ? 0 : 1;

65 
upd©e
(
Afãù
 *
·f
, cÚ¡ Afãù *
aff_‹m¶©e
) {

66 
	g·f
->
	gty³
 = 
aff_‹m¶©e
->
ty³
;

67 
	g·f
->
	gwh”e
 = 
aff_‹m¶©e
->
wh”e
;

68 
	g·f
->
	gloÿtiÚ
 = 
aff_‹m¶©e
->
loÿtiÚ
;

69 
	g·f
->
	gdu¿tiÚ
 = 
aff_‹m¶©e
->
du¿tiÚ
;

70 
	g·f
->
	gËv–
 = 
aff_‹m¶©e
->
Ëv–
;

71 
	g·f
->
	gmodif›r
 = 
aff_‹m¶©e
->
modif›r
;

72 
	g·f
->
b™veùÜ
(
aff_‹m¶©e
->bitvector());

73 
	g·f
->
	gevŞutiÚ
 = 
aff_‹m¶©e
->
evŞutiÚ
;

74 
	g·f
->
	g³rmª’t
 = 
aff_‹m¶©e
->
³rmª’t
;

80 
checksum
(cÚ¡ 
Afãù
 *
·f
) {

81 cÚ¡ *
	g¡r
 = (cÚ¡ *)
·f
;

84 
	g¡¬t
 = 0

85 + (
Afãù
 *)

86 + (
Afãù
 *)

88 + (
boŞ
);

89 
	g’d
 = (
Afãù
);

91 
	ghash
 = 5381;

94 
	gi
 = 
¡¬t
; i < 
	g’d
; i++)

95 
	ghash
 = ((
hash
 << 5è+ hashè+ 
¡r
[
i
];

97  
	ghash
;

100 
sw­
(
Afãù
 *
a
, Afãù *
b
) {

101 ià(
	ga
 =ğ
nuÎ±r
 || 
b
 ==‚ullptr)

107 
Afãù
 
	gt
;

108 
	gt
 = *
a
;

109 *
	ga
 = *
b
;

110 *
	gb
 = 
t
;

112 
	gb
->
	gÃxt
 = 
a
->
Ãxt
;

113 
	gb
->
	g´ev
 = 
a
->
´ev
;

114 
	ga
->
	gÃxt
 = 
t
.
Ãxt
;

115 
	ga
->
	g´ev
 = 
t
.
´ev
;

118 ::
afãù
::
ty³
 
b™_to_ty³
(
FÏgs
::
B™
 
b™
) {

119 
b™
) {

120 
AFF_BLIND
:  ::
afãù
::
ty³
::
blšdÃss
;

121 
	gAFF_INVISIBLE
:  ::
afãù
::
ty³
::
švis
;

122 
	gAFF_DETECT_EVIL
:  ::
afãù
::
ty³
::
d‘eù_ev
;

123 
	gAFF_DETECT_GOOD
:  ::
afãù
::
ty³
::
d‘eù_good
;

124 
	gAFF_DETECT_INVIS
:  ::
afãù
::
ty³
::
d‘eù_švis
;

125 
	gAFF_DETECT_MAGIC
:  ::
afãù
::
ty³
::
d‘eù_magic
;

126 
	gAFF_DETECT_HIDDEN
:  ::
afãù
::
ty³
::
d‘eù_hidd’
;

127 
	gAFF_SANCTUARY
:  ::
afãù
::
ty³
::
§nùu¬y
;

128 
	gAFF_FAERIE_FIRE
:  ::
afãù
::
ty³
::
ç”›_fœe
;

129 
	gAFF_INFRARED
:  ::
afãù
::
ty³
::
night_visiÚ
;

130 
	gAFF_CURSE
:  ::
afãù
::
ty³
::
cur£
;

131 
	gAFF_FEAR
:  ::
afãù
::
ty³
::
ã¬
;

132 
	gAFF_POISON
:  ::
afãù
::
ty³
::
poisÚ
;

133 
	gAFF_PROTECT_EVIL
:  ::
afãù
::
ty³
::
´ÙeùiÚ_ev
;

134 
	gAFF_PROTECT_GOOD
:  ::
afãù
::
ty³
::
´ÙeùiÚ_good
;

135 
	gAFF_NIGHT_VISION
:  ::
afãù
::
ty³
::
night_visiÚ
;

136 
	gAFF_SNEAK
:  ::
afãù
::
ty³
::
¢—k
;

137 
	gAFF_HIDE
:  ::
afãù
::
ty³
::
hide
;

138 
	gAFF_CHARM
:  ::
afãù
::
ty³
::
ch¬m_³rsÚ
;

139 
	gAFF_FLYING
:  ::
afãù
::
ty³
::
æy
;

140 
	gAFF_PASS_DOOR
:  ::
afãù
::
ty³
::
·ss_doÜ
;

141 
	gAFF_BERSERK
:  ::
afãù
::
ty³
::
b”£rk
;

142 
	gAFF_CALM
:  ::
afãù
::
ty³
::
ÿlm
;

143 
	gAFF_HASTE
:  ::
afãù
::
ty³
::
ha¡e
;

144 
	gAFF_SLOW
:  ::
afãù
::
ty³
::
¦ow
;

145 
	gAFF_PLAGUE
:  ::
afãù
::
ty³
::
¶ague
;

146 
	gAFF_DIVINEREGEN
:  ::
afãù
::
ty³
::
divše_»g’”©iÚ
;

147 
	gAFF_FLAMESHIELD
:  ::
afãù
::
ty³
::
æamesh›ld
;

148 
	gAFF_REGENERATION
:  ::
afãù
::
ty³
::
»g’”©iÚ
;

149 
	gAFF_TALON
:  ::
afãù
::
ty³
::
lÚ
;

150 
	gAFF_STEEL
:  ::
afãù
::
ty³
::
¡“l_mi¡
;

152 
Loggšg
::
bugf
("b™_to_¢: w›rd b™ %d", 
b™
);

155  ::
afãù
::
ty³
::
nÚe
;

158 
©Œ_loÿtiÚ_check
(
loÿtiÚ
) {

159 
	gloÿtiÚ
) {

160 
	gAPPLY_NONE
 :  
APPLY_NONE
;

161 
	gAPPLY_STR
 :  
APPLY_STR
;

162 
	gAPPLY_DEX
 :  
APPLY_DEX
;

163 
	gAPPLY_INT
 :  
APPLY_INT
;

164 
	gAPPLY_WIS
 :  
APPLY_WIS
;

165 
	gAPPLY_CON
 :  
APPLY_CON
;

166 
	gAPPLY_SEX
 :  
APPLY_SEX
;

167 
	gAPPLY_AGE
 :  
APPLY_AGE
;

168 
	gAPPLY_MANA
 :  
APPLY_MANA
;

169 
	gAPPLY_HIT
 :  
APPLY_HIT
;

170 
	gAPPLY_STAM
 :  
APPLY_STAM
;

171 
	gAPPLY_GOLD
 :  
APPLY_GOLD
;

172 
	gAPPLY_EXP_PCT
 :  
APPLY_EXP_PCT
;

173 
	gAPPLY_AC
 :  
APPLY_AC
;

174 
	gAPPLY_HITROLL
 :  
APPLY_HITROLL
;

175 
	gAPPLY_DAMROLL
 :  
APPLY_DAMROLL
;

177 
	gAPPLY_SAVING_PARA
 :

178 
APPLY_SAVING_ROD
 :

179 
APPLY_SAVING_PETRI
 :

180 
APPLY_SAVING_BREATH
 :

181 
APPLY_SAVING_SPELL
 :  
APPLY_SAVES
;

182 
	gAPPLY_CHR
 :  
APPLY_CHR
;

183 
	gAPPLY_QUESTPOINTS
 :  
APPLY_QUESTPOINTS
;

184 
	gAPPLY_SKILLPOINTS
 :  
APPLY_SKILLPOINTS
;

185 
	gAPPLY_MANA_COST_PCT
 :  
APPLY_MANA_COST_PCT
;

186 
	gAPPLY_STAM_COST_PCT
 :  
APPLY_STAM_COST_PCT
;

187 
	gAPPLY_WPN_DAMAGE_PCT
 :  
APPLY_WPN_DAMAGE_PCT
;

188 
	gAPPLY_SPELL_DAMAGE_PCT
 :  
APPLY_SPELL_DAMAGE_PCT
;

189 
	gAPPLY_VAMP_BONUS_PCT
 :  
APPLY_VAMP_BONUS_PCT
;

190 
	gAPPLY_HP_BLOCK_PCT
 :  
APPLY_HP_BLOCK_PCT
;

191 
	gAPPLY_MANA_BLOCK_PCT
 :  
APPLY_MANA_BLOCK_PCT
;

193 
	gAPPLY_FORGE_UNIQUE
 :  
APPLY_FORGE_UNIQUE
;

194 
	gAPPLY_PRIESTESS_UNIQUE
 :  
APPLY_PRIESTESS_UNIQUE
;

195 
	gAPPLY_BREW_UNIQUE
 :  
APPLY_BREW_UNIQUE
;

196 
	gAPPLY_SCRIBE_UNIQUE
 :  
APPLY_SCRIBE_UNIQUE
;

197 
	gAPPLY_TANK_UNIQUE
 :  
APPLY_TANK_UNIQUE
;

198 
	gAPPLY_NECRO_PIERCE_UNIQUE
 :  
APPLY_NECRO_PIERCE_UNIQUE
;

199 
	gAPPLY_LIDDA_AURA_UNIQUE
 :  
APPLY_LIDDA_AURA_UNIQUE
;

201 
	gSET_MAGE_INVOKER
 :  
SET_MAGE_INVOKER
;

202 
	gSET_WARRIOR_BESERKER
 :  
SET_WARRIOR_BESERKER
;

203 
	gSET_CLERIC_DIVINE
 :  
SET_CLERIC_DIVINE
;

204 
	gSET_THIEF_CUTPURSE
 :  
SET_THIEF_CUTPURSE
;

205 
	gSET_PALADIN_GRACE
 :  
SET_PALADIN_GRACE
;

208 
	gLoggšg
::
bugf
("©Œ_loÿtiÚ_check: bad†oÿtiÚ %d", 
loÿtiÚ
);

217 
boŞ
 
·r£_æags
(
Ë‰”
, 
Afãù
 *
·f
, 
FÏgs
& 
b™veùÜ
) {

218 
	gË‰”
) {

220 'O': 
·f
->
wh”e
 = 
TO_OBJECT
; ;

221 'W': 
·f
->
wh”e
 = 
TO_WEAPON
; ;

222 'A': 
·f
->
wh”e
 = 
TO_AFFECTS
; ;

223 'D': 
·f
->
wh”e
 = 
TO_DEFENSE
; ;

224 'I': 
·f
->
wh”e
 = 
TO_DEFENSE
; 
	g·f
->
	gmodif›r
 = 100; ;

225 'R': 
·f
->
wh”e
 = 
TO_DEFENSE
; 
	g·f
->
	gmodif›r
 = 50; ;

226 'V': 
·f
->
wh”e
 = 
TO_DEFENSE
; 
	g·f
->
	gmodif›r
 = -50; ;

228 
Loggšg
::
bugf
("·r£_æags: bad†‘‹¸%c", 
Ë‰”
);

229  
	gçl£
;

232 ià(
	g·f
->
	gwh”e
 =ğ
TO_DEFENSE
) {

233 ià(
·f
->
modif›r
 == 0) {

234 
Loggšg
::
bug
("parse_flags: TO_DEFENSE with modifier of 0", 0);

235  
	gçl£
;

240 
	gb™veùÜ
 -ğ
FÏgs
::
A
;

242 ià(
	gb™veùÜ
.
has
(
IMM_WEAPON
)) {

243 
	gb™veùÜ
 +ğ
IMM_SLASH
|
IMM_BASH
|
IMM_PIERCE
;

244 
	gb™veùÜ
 -ğ
IMM_WEAPON
;

247 ià(
	gb™veùÜ
.
has
(
IMM_MAGIC
)) {

248 
	gb™veùÜ
 +ğ
IMM_FIRE
|
IMM_COLD
|
IMM_ELECTRICITY


249 |
IMM_ACID
|
IMM_POISON
|
IMM_NEGATIVE
|
IMM_HOLY
|
IMM_ENERGY


250 |
IMM_MENTAL
|
IMM_DISEASE
|
IMM_DROWNING
|
IMM_LIGHT
|
IMM_SOUND
;

251 
	gb™veùÜ
 -ğ
IMM_MAGIC
;

259 ià(
	g·f
->
	gwh”e
 =ğ
TO_AFFECTS
 && 
·f
->
ty³
 !ğ::
afãù
::ty³::
nÚe
) {

261 
b™veùÜ
.
ş—r
();

262 
	g·f
->
b™veùÜ
(0);

264 ià(
	g·f
->
	gwh”e
 =ğ
TO_OBJECT
) {

266 
b™veùÜ
.
ş—r
();

274 
	gFÏgs
::
B™
 
b™
 = 
FÏgs
::
nÚe
;

276 ià(!
	gb™veùÜ
.
em±y
()) {

277 
	gb™_v®
 = 1;

278 
	gšdex
 = 0;

280 
	gšdex
 < 32 && !
	gb™veùÜ
.
has
(
¡©ic_ÿ¡
<
FÏgs
::
B™
>(
b™_v®
))) {

281 
b™_v®
 <<= 1;

282 
	gšdex
++;

285 ià(
	gšdex
 < 32) {

286 
	gb™
 = 
¡©ic_ÿ¡
<
FÏgs
::
B™
>(
b™_v®
);

287 
	gb™veùÜ
 -ğ
b™
;

294 ià(
	g·f
->
	gwh”e
 =ğ
TO_WEAPON
) {

295 
b™
) {

296 
WEAPON_ACIDIC
 : 
·f
->
ty³
 = ::
afãù
::ty³::
w—pÚ_acidic
; ;

297 
	gWEAPON_FLAMING
 : 
·f
->
ty³
 = ::
afãù
::ty³::
w—pÚ_æamšg
; ;

298 
	gWEAPON_FROST
 : 
·f
->
ty³
 = ::
afãù
::ty³::
w—pÚ_äo¡
; ;

299 
	gWEAPON_VAMPIRIC
 : 
·f
->
ty³
 = ::
afãù
::ty³::
w—pÚ_vampœic
; ;

300 
	gWEAPON_SHOCKING
 : 
·f
->
ty³
 = ::
afãù
::ty³::
w—pÚ_shockšg
; ;

301 
	gWEAPON_SHARP
 : 
·f
->
ty³
 = ::
afãù
::ty³::
w—pÚ_sh¬p
; ;

302 
	gWEAPON_VORPAL
 : 
·f
->
ty³
 = ::
afãù
::ty³::
w—pÚ_vÜ·l
; ;

303 
	gWEAPON_POISON
 : 
·f
->
ty³
 = ::
afãù
::ty³::
poisÚ
; ;

304 
	gWEAPON_TWO_HANDS
 : 
·f
->
ty³
 = ::
afãù
::ty³::
w—pÚ_two_hªds
; ;

305 
	gFÏgs
::
nÚe
 : ;

307 
Loggšg
::
bugf
("·r£_æags: TO_WEAPON w™h unknowÀdeãn£ b™ %d", 
b™
);

308  
	gçl£
;

312 ià(
	g·f
->
	gty³
 =ğ::
afãù
::
ty³
::
nÚe
) {

313 
Loggšg
::
bug
("parse_flags: TO_WEAPON with‚o bits‡nd‚oype", 0);

314  
	gçl£
;

317  
	gŒue
;

320 ià(
	g·f
->
	gwh”e
 =ğ
TO_DEFENSE
) {

322 
b™
) {

323 
IMM_CHARM
 : 
·f
->
loÿtiÚ
 = 
DAM_CHARM
; ;

324 
	gIMM_BASH
 : 
·f
->
loÿtiÚ
 = 
DAM_BASH
; ;

325 
	gIMM_PIERCE
 : 
·f
->
loÿtiÚ
 = 
DAM_PIERCE
; ;

326 
	gIMM_SLASH
 : 
·f
->
loÿtiÚ
 = 
DAM_SLASH
; ;

327 
	gIMM_FIRE
 : 
·f
->
loÿtiÚ
 = 
DAM_FIRE
; ;

328 
	gIMM_COLD
 : 
·f
->
loÿtiÚ
 = 
DAM_COLD
; ;

329 
	gIMM_ELECTRICITY
 : 
·f
->
loÿtiÚ
 = 
DAM_ELECTRICITY
; ;

330 
	gIMM_ACID
 : 
·f
->
loÿtiÚ
 = 
DAM_ACID
; ;

331 
	gIMM_POISON
 : 
·f
->
loÿtiÚ
 = 
DAM_POISON
; ;

332 
	gIMM_NEGATIVE
 : 
·f
->
loÿtiÚ
 = 
DAM_NEGATIVE
; ;

333 
	gIMM_HOLY
 : 
·f
->
loÿtiÚ
 = 
DAM_HOLY
; ;

334 
	gIMM_ENERGY
 : 
·f
->
loÿtiÚ
 = 
DAM_ENERGY
; ;

335 
	gIMM_MENTAL
 : 
·f
->
loÿtiÚ
 = 
DAM_MENTAL
; ;

336 
	gIMM_DISEASE
 : 
·f
->
loÿtiÚ
 = 
DAM_DISEASE
; ;

337 
	gIMM_DROWNING
 : 
·f
->
loÿtiÚ
 = 
DAM_DROWNING
; ;

338 
	gIMM_LIGHT
 : 
·f
->
loÿtiÚ
 = 
DAM_LIGHT
; ;

339 
	gIMM_SOUND
 : 
·f
->
loÿtiÚ
 = 
DAM_SOUND
; ;

340 
	gIMM_WOOD
 : 
·f
->
loÿtiÚ
 = 
DAM_WOOD
; ;

341 
	gIMM_SILVER
 : 
·f
->
loÿtiÚ
 = 
DAM_SILVER
; ;

342 
	gIMM_IRON
 : 
·f
->
loÿtiÚ
 = 
DAM_IRON
; ;

343 
	gFÏgs
::
nÚe
 : ;

345 
Loggšg
::
bugf
("·r£_æags: TO_DEFENSE w™h unknowÀdeãn£ b™ %d", 
b™
);

346  
	gçl£
;

350 ià(
	g·f
->
	gloÿtiÚ
 == 0) {

351 
Loggšg
::
bug
("parse_flags: TO_DEFENSE with†ocation 0", 0);

352  
	gçl£
;

356 
	g·f
->
b™veùÜ
(0);

357  
	gŒue
;

360 ià(
	g·f
->
	gwh”e
 =ğ
TO_AFFECTS
 && 
·f
->
ty³
 =ğ::
afãù
::ty³::
nÚe
) {

361 ià(
b™
 =ğ
FÏgs
::
nÚe
) {

362 
Loggšg
::
bug
("parse_flags: TO_AFFECTS with‚oype‡nd‚o bit", 0);

363  
	gçl£
;

366 ::
afãù
::
ty³
y³ = 
b™_to_ty³
(
b™
);

368 ià(
	gty³
 =ğ::
afãù
::
ty³
::
nÚe
) {

369 
Loggšg
::
bugf
("·r£_æags: TO_AFFECTS: sÀnÙ found fÜ b™ %d", 
b™
);

370  
	gçl£
;

373 
	g·f
->
	gty³
 = 
ty³
;

374 
	g·f
->
b™veùÜ
(0);

381 
	g·f
->
	gloÿtiÚ
 = 
©Œ_loÿtiÚ_check
(
·f
->
loÿtiÚ
);

383 ià(
	g·f
->
	gloÿtiÚ
 == -1) {

384 
Loggšg
::
bugf
("·r£_æags:‡fãù wh”e=%d w™h bad†oÿtiÚ %d", 
·f
->
wh”e
,…af->
loÿtiÚ
);

385  
	gçl£
;

388 ià(
	g·f
->
	gloÿtiÚ
 == 0)

389 
·f
->
modif›r
 = 0;

392 ià(
	g·f
->
	gwh”e
 =ğ
TO_OBJECT
 && 
·f
->
b™veùÜ
().
em±y
(è&&…af->
loÿtiÚ
 == 0) {

393 
Loggšg
::
bug
("parse_flags: TO_OBJECT with‚o modifiers", 0);

394  
	gçl£
;

397  
	gŒue
;

	@src/affect/affect_cache_array.cc

1 
	~<veùÜ
>

3 
	~"afãù/Afãù.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"Loggšg.hh
"

7 
Çme¥aû
 
	gafãù
 {

9 
	#g‘_ÿche
(
ch
è((ch)->
afãù_ÿche
 =ğ
nuÎ±r
 ?‚uÎ±¸: (*)(ch)->afãù_ÿche)

	)

10 
	#ÿche_size
 ()::
afãù
::
ty³
::
size


	)

12 
ä“_ÿche
(
Ch¬aù”
 *
ch
) {

13 
	gd–‘e
[] (*)
	gch
->
	gafãù_ÿche
;

14 
	gch
->
	gafãù_ÿche
 = 
nuÎ±r
;

17 
boŞ
 
š_ÿche
(cÚ¡ 
Ch¬aù”
 *
ch
, ::
afãù
::
ty³
ype) {

19 
ty³
 > ::
afãù
::ty³::
nÚe


20 && ()
ty³
 < 
ÿche_size


21 && 
ch
->
afãù_ÿche


22 && 
g‘_ÿche
(
ch
)[()
ty³
] > 0);

25 
upd©e_ÿche
(
Ch¬aù”
 *
ch
, ::
afãù
::
ty³
y³, 
boŞ
 
fAdd
) {

26 ià(
	gty³
 <ğ::
afãù
::
ty³
::
nÚe
 || (éy³ >ğ
ÿche_size
) {

27 
Loggšg
::
bug
("upd©e_ÿche: c®Ëd w™hy³ = %d", ()
ty³
);

31 ià(
	gfAdd
) {

32 ià(
g‘_ÿche
(
ch
è=ğ
nuÎ±r
) {

33 
ch
->
afãù_ÿche
 = 
Ãw
 [
ÿche_size
];

35 
	gi
 = 0; i < 
	gÿche_size
; i++)

36 
g‘_ÿche
(
ch
)[
i
] = 0;

39 
g‘_ÿche
(
ch
)[()
ty³
]++;

40 
g‘_ÿche
(
ch
)[0]++;

43 ià(
g‘_ÿche
(
ch
è=ğ
nuÎ±r
) {

44 
Loggšg
::
bugf
("update_cache: illegal„emoval from‚ullptr‡ffect cache‡type %d (%s)",

45 
ty³
, 
lookup
Ñy³).
Çme
);

49 ià(
g‘_ÿche
(
ch
)[()
ty³
] == 0) {

50 
Loggšg
::
bugf
("update_cache: illegal„emoval of uncounted value‡type %d (%s)",

51 
ty³
, 
lookup
Ñy³).
Çme
);

55 
g‘_ÿche
(
ch
)[()
ty³
]--;

56 
g‘_ÿche
(
ch
)[0]--;

58 ià(
g‘_ÿche
(
ch
)[0] == 0)

59 
ä“_ÿche
(
ch
);

63 
SŒšg
 
´št_ÿche
(
Ch¬aù”
 *
ch
) {

64 
SŒšg
 
	gbuf
;

66 ià(
	gch
->
	gafãù_ÿche
 =ğ
nuÎ±r
)

67  
buf
;

69 
	gty³_n
 = 1;y³_À< 
	gÿche_size
;ype_n++) {

70 
	gcouÁ
 = 
g‘_ÿche
(
ch
)[
ty³_n
];

72 ià(
	gcouÁ
 > 0) {

73 ià(!
	gbuf
.
em±y
())

74 
	gbuf
 += " ";

76 
	gbuf
 +ğ
FÜm©
::
fÜm©
("%s(%d)", 
lookup
((::
afãù
::
ty³
)
ty³_n
).
Çme
, 
couÁ
);

80  
	gbuf
;

	@src/affect/affect_char.cc

1 
	~<veùÜ
>

3 
	~"afãù/afãù_li¡.hh
"

4 
	~"afãù/Afãù.hh
"

5 
	~"Ch¬aù”.hh
"

6 
	~"Loggšg.hh
"

7 
	~"m”c.hh
"

8 
	~"¿ndom.hh
"

10 
Çme¥aû
 
	gafãù
 {

13 
modify_ch¬
(*
owÃr
, cÚ¡ 
Afãù
 *
·f
, 
boŞ
 
fAdd
);

17 cÚ¡ 
Afãù
 *
li¡_ch¬
(
Ch¬aù”
 *
ch
) {

18  
	gch
->
	gafãùed
;

21 
boŞ
 
exi¡s_Ú_ch¬
(cÚ¡ 
Ch¬aù”
 *
ch
, ::
afãù
::
ty³
ype) {

22  
š_ÿche
(
ch
, 
ty³
);

25 cÚ¡ 
Afãù
 *
fšd_Ú_ch¬
(
Ch¬aù”
 *
ch
, ::
afãù
::
ty³
ype) {

26  
fšd_š_li¡
(&
ch
->
afãùed
, 
ty³
);

31 
cİy_to_ch¬
(
Ch¬aù”
 *
ch
, cÚ¡ 
Afãù
 *
aff_‹m¶©e
)

33 
cİy_to_li¡
(&
ch
->
afãùed
, 
aff_‹m¶©e
);

34 
modify_ch¬
(
ch
, 
aff_‹m¶©e
, 
Œue
);

37 
još_to_ch¬
(
Ch¬aù”
 *
ch
, 
Afãù
 *
·f
)

39 
â_·¿ms
 
	g·¿ms
;

41 
	g·¿ms
.
	gowÃr
 = 
ch
;

42 
	g·¿ms
.
	gmodif›r
 = 
modify_ch¬
;

43 
	g·¿ms
.
	gd©a
 = 
nuÎ±r
;

45 
dedup_š_li¡
(&
ch
->
afãùed
, 
·f
, &
·¿ms
);

46 
cİy_to_ch¬
(
ch
, 
·f
);

49 
add_³rm_to_ch¬
(
Ch¬aù”
 *
ch
, ::
afãù
::
ty³
ype) {

50 
add_ty³_to_ch¬
(
ch
, 
ty³
, ch->
Ëv–
, -1, 1, 
Œue
);

54 
cİy_æags_to_ch¬
(
Ch¬aù”
 *
ch
, 
Ë‰”
, 
FÏgs
 
b™veùÜ
, 
boŞ
 
³rmª’t
) {

55 
Afãù
 
	gaf
;

56 
	gaf
.
	gËv–
 = 
ch
->
Ëv–
;

57 
	gaf
.
	gdu¿tiÚ
 = -1;

58 
	gaf
.
	gevŞutiÚ
 = 1;

59 
	gaf
.
	g³rmª’t
 = 
³rmª’t
;

61 !
	gb™veùÜ
.
em±y
()) {

62 
	gaf
.
	gty³
 = ::
afãù
::
ty³
::
nÚe
;

63 ià(
·r£_æags
(
Ë‰”
, &
af
, 
b™veùÜ
)) {

64 ià(
	gË‰”
 == 'A')

65 
add_ty³_to_ch¬
(
ch
, 
af
.
ty³
, ch->
Ëv–
, -1, 1, 
³rmª’t
);

67 
cİy_to_ch¬
(
ch
, &
af
);

72 
add_¿cŸl_to_ch¬
(
Ch¬aù”
 *
ch
) {

73 
cİy_æags_to_ch¬
(
ch
, 'A', 
¿û_bË
[ch->
¿û
].
aff
, 
Œue
);

74 
cİy_æags_to_ch¬
(
ch
, 'I', 
¿û_bË
[ch->
¿û
].
imm
, 
Œue
);

75 
cİy_æags_to_ch¬
(
ch
, 'R', 
¿û_bË
[ch->
¿û
].
»s
, 
Œue
);

76 
cİy_æags_to_ch¬
(
ch
, 'V', 
¿û_bË
[ch->
¿û
].
vuÊ
, 
Œue
);

81 
»move_äom_ch¬
(
Ch¬aù”
 *
ch
, 
Afãù
 *
·f
)

83 
»move_äom_li¡
(&
ch
->
afãùed
, 
·f
);

84 
modify_ch¬
(
ch
, 
·f
, 
çl£
);

85 
d–‘e
 
	g·f
;

88 
»move_m©chšg_äom_ch¬
(
Ch¬aù”
 *
ch
, 
com·¿tÜ
 
comp
, cÚ¡ 
Afãù
 *
·‰”n
) {

89 
â_·¿ms
 
	g·¿ms
;

91 
	g·¿ms
.
	gowÃr
 = 
ch
;

92 
	g·¿ms
.
	gmodif›r
 = 
modify_ch¬
;

93 
	g·¿ms
.
	gd©a
 = 
nuÎ±r
;

95 
»move_m©chšg_äom_li¡
(&
ch
->
afãùed
, 
comp
, 
·‰”n
, &
·¿ms
);

98 
»move_m¬ked_äom_ch¬
(
Ch¬aù”
 *
ch
) {

99 
Afãù
 
	g·‰”n
;

100 
	g·‰”n
.
	gm¬k
 = 
Œue
;

102 
»move_m©chšg_äom_ch¬
(
ch
, 
com·¿tÜ_m¬k
, &
·‰”n
);

105 
»move_ty³_äom_ch¬
(
Ch¬aù”
 *
ch
, ::
afãù
::
ty³
ype) {

106 
Afãù
 
·‰”n
;

107 
	g·‰”n
.
	gty³
 = 
ty³
;

109 
»move_m©chšg_äom_ch¬
(
ch
, 
com·¿tÜ_ty³
, &
·‰”n
);

112 
»move_®l_äom_ch¬
(
Ch¬aù”
 *
ch
, 
boŞ
 
³rmª’t
) {

113 
Afãù
 
	g·‰”n
;

114 
	g·‰”n
.
	g³rmª’t
 = 
³rmª’t
;

116 
»move_m©chšg_äom_ch¬
(
ch
, 
com·¿tÜ_³rmª’t
, &
·‰”n
);

121 
™”©e_ov”_ch¬
(
Ch¬aù”
 *
ch
, 
afãù_â
 
â
, *
d©a
) {

122 
â_·¿ms
 
	g·¿ms
;

124 
	g·¿ms
.
	gowÃr
 = 
ch
;

125 
	g·¿ms
.
	gmodif›r
 = 
modify_ch¬
;

126 
	g·¿ms
.
	gd©a
 = 
d©a
;

128 
™”©e_ov”_li¡
(&
ch
->
afãùed
, 
â
, &
·¿ms
);

131 
sÜt_ch¬
(
Ch¬aù”
 *
ch
, 
com·¿tÜ
 
comp
) {

132 
sÜt_li¡
(&
ch
->
afãùed
, 
comp
);

137 
add_ty³_to_ch¬
(
Ch¬aù”
 *
ch
, ::
afãù
::
ty³
y³, 
Ëv–
, 
du¿tiÚ
, 
evŞutiÚ
, 
boŞ
 
³rmª’t
) {

138 
	saff_¡
 {

139 ::
afãù
::
ty³
ype;

140 
	gloÿtiÚ
;

141 
	gmodif›r
;

142 
	gevŞutiÚ
;

145 cÚ¡ 
	g¡d
::
veùÜ
<
aff_¡
> 
aff_bË
 = {

146 { ::
afãù
::
ty³
::
age
, 
APPLY_STR
, -
Ëv–
/20, 1 },

147 { ::
afãù
::
ty³
::
age
, 
APPLY_CON
, -
Ëv–
/20, 1 },

148 { ::
afãù
::
ty³
::
age
, 
APPLY_WIS
, 
Ëv–
/50, 1 },

149 { ::
afãù
::
ty³
::
age
, 
APPLY_AGE
, 
Ëv–
, 1 },

150 { ::
afãù
::
ty³
::
¬mÜ
, 
APPLY_AC
, -20, 1 },

151 { ::
afãù
::
ty³
::
b¬r›r
, 
APPLY_NONE
, 0, 1 },

152 { ::
afãù
::
ty³
::
b”£rk
, 
APPLY_HITROLL
, 
ch
->
is_Åc
(è? 
Ëv–
/8 : 
GET_ATTR_HITROLL
(ch)/5, 1 },

153 { ::
afãù
::
ty³
::
b”£rk
, 
APPLY_DAMROLL
, 
ch
->
is_Åc
(è? 
Ëv–
/8 : 
GET_ATTR_DAMROLL
(ch)/5, 1 },

154 { ::
afãù
::
ty³
::
b”£rk
, 
APPLY_AC
, 
¡d
::
max
(10, 10 * (
ch
->
Ëv–
 / 5)), 1 },

155 { ::
afãù
::
ty³
::
bËss
, 
APPLY_HITROLL
, 
Ëv–
/8, 1 },

156 { ::
afãù
::
ty³
::
bËss
, 
APPLY_SAVES
, -
Ëv–
/8, 1 },

157 { ::
afãù
::
ty³
::
blšdÃss
, 
APPLY_HITROLL
, -4, 1 },

158 { ::
afãù
::
ty³
::
blood_moÚ
, 
APPLY_HITROLL
, 
Ëv–
/20, 1 },

159 { ::
afãù
::
ty³
::
blood_moÚ
, 
APPLY_DAMROLL
, 
Ëv–
/12, 1 },

160 { ::
afãù
::
ty³
::
bÚe_w®l
, 
APPLY_NONE
, 0, 1 },

161 { ::
afãù
::
ty³
::
ÿlm
, 
APPLY_HITROLL
, -5, 1 },

162 { ::
afãù
::
ty³
::
ÿlm
, 
APPLY_DAMROLL
, -5, 1 },

163 { ::
afãù
::
ty³
::
ch¬m_³rsÚ
, 
APPLY_NONE
, 0, 1 },

164 { ::
afãù
::
ty³
::
chªge_£x
, 
APPLY_SEX
, 
numb”_¿nge
(1,2), 1 },

165 { ::
afãù
::
ty³
::
chªÃl
, 
APPLY_STR
, -1, 1 },

166 { ::
afãù
::
ty³
::
chªÃl
, 
APPLY_CON
, -2, 1 },

167 { ::
afãù
::
ty³
::
chl_touch
, 
APPLY_STR
, -1, 1 },

168 { ::
afãù
::
ty³
::
cur£
, 
APPLY_HITROLL
, -
Ëv–
 / 8, 1 },

169 { ::
afãù
::
ty³
::
cur£
, 
APPLY_SAVES
, 
Ëv–
 / 8, 1 },

170 { ::
afãù
::
ty³
::
dazzË
, 
APPLY_HITROLL
, -4, 1 },

171 { ::
afãù
::
ty³
::
d‘eù_ev
, 
APPLY_NONE
, 0, 1 },

172 { ::
afãù
::
ty³
::
d‘eù_good
, 
APPLY_NONE
, 0, 1 },

173 { ::
afãù
::
ty³
::
d‘eù_magic
, 
APPLY_NONE
, 0, 1 },

174 { ::
afãù
::
ty³
::
d‘eù_švis
, 
APPLY_NONE
, 0, 1 },

175 { ::
afãù
::
ty³
::
d‘eù_hidd’
, 
APPLY_NONE
, 0, 1 },

176 { ::
afãù
::
ty³
::
dœt_kickšg
, 
APPLY_HITROLL
, -4, 1 },

177 { ::
afãù
::
ty³
::
divše_»g’”©iÚ
, 
APPLY_NONE
, 0, 1 },

178 { ::
afãù
::
ty³
::
ç”›_fœe
, 
APPLY_AC
, 
Ëv–
 * 2, 1 },

179 { ::
afãù
::
ty³
::
ã¬
, 
APPLY_HITROLL
, -
Ëv–
 / 10, 1 },

180 { ::
afãù
::
ty³
::
ã¬
, 
APPLY_DAMROLL
, -
Ëv–
 / 16, 1 },

181 { ::
afãù
::
ty³
::
ã¬
, 
APPLY_SAVES
, -
Ëv–
 / 14, 1 },

182 { ::
afãù
::
ty³
::
fœe_b»©h
, 
APPLY_HITROLL
, -4, 1 },

183 { ::
afãù
::
ty³
::
æamesh›ld
, 
APPLY_AC
, -20, 1 },

184 { ::
afãù
::
ty³
::
æy
, 
APPLY_NONE
, 0, 1 },

185 { ::
afãù
::
ty³
::
focus
, 
APPLY_NONE
, 0, 1 },

186 { ::
afãù
::
ty³
::
fÜû_sh›ld
, 
APPLY_NONE
, 0, 1 },

187 { ::
afãù
::
ty³
::
ä’zy
, 
APPLY_HITROLL
, 
Ëv–
/6, 1 },

188 { ::
afãù
::
ty³
::
ä’zy
, 
APPLY_DAMROLL
, 
Ëv–
/6, 1 },

189 { ::
afãù
::
ty³
::
ä’zy
, 
APPLY_AC
, 10*(
Ëv–
/12), 1 },

190 { ::
afãù
::
ty³
::
gŸÁ_¡»ngth
, 
APPLY_STR
, 
Ëv–
/25+2, 1 },

191 { ::
afãù
::
ty³
::
ha¡e
, 
APPLY_DEX
, 0, 1 },

192 { ::
afãù
::
ty³
::
hamm”¡rike
, 
APPLY_HITROLL
, 
g‘_un¥–Ëd_h™rŞl
(
ch
)/4, 1 },

193 { ::
afãù
::
ty³
::
hamm”¡rike
, 
APPLY_DAMROLL
, 
g‘_un¥–Ëd_damrŞl
(
ch
)/4, 1 },

194 { ::
afãù
::
ty³
::
hex
, 
APPLY_AC
, 
Ëv–
 * 3, 1 },

195 { ::
afãù
::
ty³
::
hide
, 
APPLY_NONE
, 0, 1 },

196 { ::
afãù
::
ty³
::
švis
, 
APPLY_NONE
, 0, 1 },

198 { ::
afãù
::
ty³
::
midnight
, 
APPLY_NONE
, 0, 1 },

199 { ::
afãù
::
ty³
::
night_visiÚ
, 
APPLY_NONE
, 0, 1 },

200 { ::
afãù
::
ty³
::
·¿lyze
, 
APPLY_NONE
, 0, 1 },

201 { ::
afãù
::
ty³
::
·ss_doÜ
, 
APPLY_NONE
, 0, 1 },

202 { ::
afãù
::
ty³
::
¶ague
, 
APPLY_STR
, -
Ëv–
 / 20 - 1, 1 },

203 { ::
afãù
::
ty³
::
poisÚ
, 
APPLY_STR
, -2, 1 },

204 { ::
afãù
::
ty³
::
´ÙeùiÚ_ev
, 
APPLY_SAVES
, -1, 1 },

205 { ::
afãù
::
ty³
::
´ÙeùiÚ_good
, 
APPLY_SAVES
, -1, 1 },

206 { ::
afãù
::
ty³
::
¿ybª
, 
APPLY_NONE
, 0, 1 },

207 { ::
afãù
::
ty³
::
»g’”©iÚ
, 
APPLY_NONE
, 0, 1 },

208 { ::
afãù
::
ty³
::
§nùu¬y
, 
APPLY_NONE
, 0, 1 },

209 { ::
afãù
::
ty³
::
shadow_fÜm
, 
APPLY_NONE
, 0, 1 },

210 { ::
afãù
::
ty³
::
sh“n
, 
APPLY_NONE
, 0, 1 },

211 { ::
afãù
::
ty³
::
sh›ld
, 
APPLY_AC
, -20, 1 },

212 { ::
afãù
::
ty³
::
¦“p
, 
APPLY_NONE
, 0, 1 },

213 { ::
afãù
::
ty³
::
¦ow
, 
APPLY_DEX
, 0, 1 },

214 { ::
afãù
::
ty³
::
smokesü“n
, 
APPLY_HITROLL
, -4, 1 },

215 { ::
afãù
::
ty³
::
¢—k
, 
APPLY_NONE
, 0, 1 },

216 { ::
afãù
::
ty³
::
¡“l_mi¡
, 
APPLY_AC
, -
Ëv–
 / 10, 1 },

217 { ::
afãù
::
ty³
::
¡Úe_skš
, 
APPLY_AC
, -40, 1 },

218 { ::
afãù
::
ty³
::
lÚ
, 
APPLY_NONE
, 0, 1 },

219 { ::
afãù
::
ty³
::
w—k’
, 
APPLY_STR
, -
Ëv–
/5, 1 },

222 
Afãù
 
	gaf
;

223 
	gaf
.
	gwh”e
 = 
TO_AFFECTS
;

224 
	gaf
.
	gty³
 = 
ty³
;

225 
	gaf
.
	gËv–
 = 
Ëv–
;

226 
	gaf
.
	gdu¿tiÚ
 = 
du¿tiÚ
;

227 
	gaf
.
	gevŞutiÚ
 = 
evŞutiÚ
;

228 
	gaf
.
	g³rmª’t
 = 
³rmª’t
;

229 
boŞ
 
	gfound
 = 
çl£
;

231 
	gi
 = 0; i < 
	gaff_bË
.
size
(); i++) {

232 ià(
	gaff_bË
[
i
].
	gty³
 !ğ
ty³
) {

233 ià(
found
)

240 ià(
	gaff_bË
[
i
].
	gevŞutiÚ
 >ƒvolution)

243 
	gfound
 = 
Œue
;

244 
	gaf
.
	gloÿtiÚ
 = 
aff_bË
[
i
].
loÿtiÚ
;

245 
	gaf
.
	gmodif›r
 = 
aff_bË
[
i
].
modif›r
;

246 
još_to_ch¬
(
ch
, &
af
);

249 ià(!
	gfound
)

250 
	gLoggšg
::
bug
("add_ty³_to_ch¬:‡fãù w™hy³ %d‚Ù found iÀbË", ()
ty³
);

253 
»mÜt_afãù_modify_ch¬
(
Ch¬aù”
 *
ch
, 
wh”e
, 
FÏgs
 
b™veùÜ
, 
boŞ
 
fAdd
) {

254 
Afãù
 
	gaf
;

255 
	gaf
.
	gty³
 = ::
afãù
::
ty³
::
nÚe
;

256 
	gaf
.
	gËv–
 = 
ch
->
Ëv–
;

257 
	gaf
.
	gdu¿tiÚ
 = -1;

258 
	gaf
.
	gevŞutiÚ
 = 1;

259 
	gaf
.
	g³rmª’t
 = 
Œue
;

262 
	gË‰”
 =

263 
wh”e
 =ğ
TO_RESIST
 ? 'R' :

264 
wh”e
 =ğ
TO_VULN
 ? 'V' : '?';

266 !
	gb™veùÜ
.
em±y
()) {

267 ià(
·r£_æags
(
Ë‰”
, &
af
, 
b™veùÜ
))

268 
modify_ch¬
(
ch
, &
af
, 
fAdd
);

283 
modify_ch¬
(*
owÃr
, cÚ¡ 
Afãù
 *
·f
, 
boŞ
 
fAdd
) {

284 
modify_ch¬
((
Ch¬aù”
 *)
owÃr
, 
·f
, 
fAdd
);

287 
modify_ch¬
(
Ch¬aù”
 *
ch
, cÚ¡ 
Afãù
 *
·f
, 
boŞ
 
fAdd
) {

288 ià(
	g·f
->
	gwh”e
 !ğ
TO_DEFENSE
 && 
·f
->
wh”e
 !ğ
TO_AFFECTS
 &&…af->wh”!ğ
TO_OBJECT
)

291 ià(
	g·f
->
	gwh”e
 =ğ
TO_DEFENSE
) {

292 ià(
·f
->
loÿtiÚ
 < 1 ||…af->location > 32) {

293 
Loggšg
::
bugf
("modify_ch¬ (%s): bad†oÿtiÚ %d iÀTO_DEFENSE", 
ch
->
Çme
, 
·f
->
loÿtiÚ
);

297 ià(
	g·f
->
	gmodif›r
 == 0)

300 ià(
	gfAdd
) {

301 ià(
	gch
->
	gdeãn£_mod
 =ğ
nuÎ±r
) {

302 
ch
->
deãn£_mod
 = 
Ãw
 [
DEFENSE_MOD_MEM_SIZE
];

303 
mem£t
(
ch
->
deãn£_mod
, 0, 
DEFENSE_MOD_MEM_SIZE
);

306 
	gch
->
	gdeãn£_mod
[0]++;

307 
	gch
->
	gdeãn£_mod
[
·f
->
loÿtiÚ
] +ğ·f->
modif›r
;

310 ià(
	gch
->
	gdeãn£_mod
 =ğ
nuÎ±r
) {

311 
Loggšg
::
bugf
("modify_ch¬ (%s):‡‰em±Ø»moväom‚uÎ±¸deãn£_mod", 
ch
->
Çme
);

315 
	gch
->
	gdeãn£_mod
[0]--;

316 
	gch
->
	gdeãn£_mod
[
·f
->
loÿtiÚ
] -ğ·f->
modif›r
;

318 ià(
	gch
->
	gdeãn£_mod
[0] == 0) {

319 
d–‘e
[] 
ch
->
deãn£_mod
;

320 
	gch
->
	gdeãn£_mod
 = 
nuÎ±r
;

327 ià(
	g·f
->
	gwh”e
 =ğ
TO_AFFECTS
) {

328 ià(
·f
->
ty³
 =ğ::
afãù
::ty³::
nÚe
) {

329 
Loggšg
::
bugf
("modify_ch¬ (%s): bady³ %d iÀTO_AFFECTS", 
ch
->
Çme
, 
·f
->
ty³
);

333 
upd©e_ÿche
(
ch
, 
·f
->
ty³
, 
fAdd
);

339 ià(
	g·f
->
	gmodif›r
 == 0)

342 ià(
	g·f
->
	gloÿtiÚ
 !ğ
APPLY_NONE
) {

343 ià(
·f
->
loÿtiÚ
 < 1 ||…af->loÿtiÚ >ğ
MAX_ATTR
) {

344 
Loggšg
::
bugf
("modify_ch¬ (%s): bad†oÿtiÚ %d wh’ modif›¸i %d", 
ch
->
Çme
, 
·f
->
loÿtiÚ
,…af->
modif›r
);

348 ià(
	gfAdd
) {

349 ià(
	gch
->
	g­¶y_ÿche
 =ğ
nuÎ±r
) {

350 
ch
->
­¶y_ÿche
 = 
Ãw
 [
APPLY_CACHE_MEM_SIZE
];

351 
mem£t
(
ch
->
­¶y_ÿche
, 0, 
APPLY_CACHE_MEM_SIZE
);

354 
	gch
->
	g­¶y_ÿche
[0]++;

355 
	gch
->
	g­¶y_ÿche
[
·f
->
loÿtiÚ
] +ğ·f->
modif›r
;

358 ià(
	gch
->
	g­¶y_ÿche
 =ğ
nuÎ±r
) {

359 
Loggšg
::
bugf
("modify_ch¬ (%s):‡‰em±Ø»moväom‚uÎ±¸­¶y_ÿche", 
ch
->
Çme
);

363 
	gch
->
	g­¶y_ÿche
[
·f
->
loÿtiÚ
] -ğ·f->
modif›r
;

365 ià(--
	gch
->
	g­¶y_ÿche
[0] <= 0) {

366 
d–‘e
[] 
ch
->
­¶y_ÿche
;

367 
	gch
->
	g­¶y_ÿche
 = 
nuÎ±r
;

	@src/affect/affect_list.cc

1 
	~"afãù/afãù_li¡.hh
"

3 
Çme¥aû
 
	gafãù
 {

5 
»move_äom_li¡
(
Afãù
 **
li¡_h—d
, Afãù *
·f
) {

6 ià(*
	gli¡_h—d
 =ğ
·f
)

7 *
li¡_h—d
 = 
·f
->
Ãxt
;

9 ià(
	g·f
->
	g´ev
)

10 
	g·f
->
	g´ev
->
	gÃxt
 = 
·f
->
Ãxt
;

11 ià(
	g·f
->
	gÃxt
)

12 
	g·f
->
	gÃxt
->
	g´ev
 = 
·f
->
´ev
;

14 
	g·f
->
	gÃxt
 = 
nuÎ±r
;

15 
	g·f
->
	g´ev
 = 
nuÎ±r
;

18 
š£¹_š_li¡
(
Afãù
 **
li¡_h—d
, Afãù *
·f
) {

19 ià(*
	gli¡_h—d
) {

20 ià((*
	gli¡_h—d
)->
	g´ev
) {

21 (*
	gli¡_h—d
)->
	g´ev
->
	gÃxt
 = 
·f
;

22 
	g·f
->
	g´ev
 = (*
li¡_h—d
)->
´ev
;

25 (*
	gli¡_h—d
)->
	g´ev
 = 
·f
;

28 
	g·f
->
	gÃxt
 = *
li¡_h—d
;

29 *
	gli¡_h—d
 = 
·f
;

32 
cİy_to_li¡
(
Afãù
 **
li¡_h—d
, cÚ¡ Afãù *
aff_‹m¶©e
)

34 
Afãù
 *
	g·f_Ãw
 = 
Ãw
 Affect();

35 *
	g·f_Ãw
 = *
aff_‹m¶©e
;

36 
	g·f_Ãw
->
	gÃxt
 = 
nuÎ±r
;

37 
	g·f_Ãw
->
	g´ev
 = 
nuÎ±r
;

38 
š£¹_š_li¡
(
li¡_h—d
, 
·f_Ãw
);

42 
dedup_š_li¡
(
Afãù
 **
li¡_h—d
, Afãù *
·f
, 
â_·¿ms
 *
·¿ms
)

44 
Afãù
 *
	g·f_Şd
, *
	g·f_Ãxt
;

46 
	g·f_Şd
 = *
li¡_h—d
;…af_Şd !ğ
nuÎ±r
;…af_Şd = 
·f_Ãxt
) {

47 
·f_Ãxt
 = 
·f_Şd
->
Ãxt
;

49 ià(
	g·f_Şd
->
	gty³
 !ğ
·f
->
ty³


50 || 
·f_Şd
->
wh”e
 !ğ
·f
->where

51 || 
·f_Şd
->
loÿtiÚ
 !ğ
·f
->location

52 || (
·f_Şd
->
du¿tiÚ
 =ğ-1 && 
·f
->duration != -1)

53 || (
·f_Şd
->
du¿tiÚ
 !ğ-1 && 
·f
->duration == -1)

54 || 
·f_Şd
->
³rmª’t
 !ğ
·f
->permanent)

57 
	g·f
->
	gËv–
 = 
¡d
::
max
(
·f
->
Ëv–
, 
·f_Şd
->level);

58 
	g·f
->
	gdu¿tiÚ
 = 
¡d
::
max
(
·f
->
du¿tiÚ
, 
·f_Şd
->duration);

59 
	g·f
->
	gmodif›r
 +ğ
·f_Şd
->
modif›r
;

60 
	g·f
->
b™veùÜ
(
·f
->b™veùÜ(è+ 
·f_Şd
->bitvector());

61 
	g·f
->
	gevŞutiÚ
 = 
¡d
::
max
(
·f
->
evŞutiÚ
, 
·f_Şd
->evolution);

63 
»move_äom_li¡
(
li¡_h—d
, 
·f_Şd
);

64 (
	g·¿ms
->
	gmodif›r
)Õ¬ams->
	gowÃr
, 
	g·f_Şd
, 
	gçl£
);

65 
d–‘e
 
	g·f_Şd
;

69 
ş—r_li¡
(
Afãù
 **
li¡_h—d
) {

70 ià(*
	gli¡_h—d
 =ğ
nuÎ±r
)

73 
ş—r_li¡
(&(*
li¡_h—d
)->
Ãxt
);

74 
d–‘e
 *
	gli¡_h—d
;

75 *
	gli¡_h—d
 = 
nuÎ±r
;

78 cÚ¡ 
Afãù
 *
fšd_š_li¡
(Afãù **
li¡_h—d
, ::
afãù
::
ty³
ype) {

79 cÚ¡ 
Afãù
 *
·f
 = *
li¡_h—d
; 
	g·f
;…aàğ·f->
Ãxt
)

80 ià(
·f
->
ty³
 ==ype)

81  
·f
;

83  
	gnuÎ±r
;

86 
»move_m©chšg_äom_li¡
(
Afãù
 **
li¡_h—d
, 
com·¿tÜ
 
comp
, cÚ¡ Afãù *
·‰”n
, 
â_·¿ms
 *
·¿ms
) {

87 
Afãù
 *
	g·f
, *
	g·f_Ãxt
;

89 
	g·f
 = *
li¡_h—d
;…af;…aàğ
·f_Ãxt
) {

90 
·f_Ãxt
 = 
·f
->
Ãxt
;

94 ià(
	g·f
->
	g³rmª’t
 && (
	g·‰”n
 =ğ
nuÎ±r
 || !
·‰”n
->
³rmª’t
))

97 ià(
	gcomp
 =ğ
nuÎ±r
 || (*
comp
)(
·f
, 
	g·‰”n
) == 0) {

98 
»move_äom_li¡
(
li¡_h—d
, 
·f
);

99 (
	g·¿ms
->
	gmodif›r
)Õ¬ams->
	gowÃr
, 
	g·f
, 
	gçl£
);

100 
d–‘e
 
	g·f
;

105 
™”©e_ov”_li¡
(
Afãù
 **
li¡_h—d
, 
afãù_â
 
â
, 
â_·¿ms
 *
·¿ms
) {

106 
Afãù
 *
	g·f
 = *
li¡_h—d
;…af;…aàğ
·f
->
Ãxt
) {

108 ià(
·f
->
´ev
è·f->´ev->
Ãxt
 =…af->next;

109 ià(
	g·f
->
	gÃxt
è·f->Ãxt->
	g´ev
 = 
·f
->
´ev
;

111 ià(
	g·¿ms
->
	gowÃr
èÕ¬ams->
	gmodif›r
)Õ¬ams->owÃr, 
	g·f
, 
	gçl£
);

113 (*
	gâ
)(
	g·f
, 
	g·¿ms
->
	gd©a
);

116 ià(
	g·f
->
	g´ev
è·f->´ev->
	gÃxt
 = 
·f
;

117 ià(
	g·f
->
	gÃxt
è·f->Ãxt->
	g´ev
 = 
·f
;

119 ià(
	g·¿ms
->
	gowÃr
èÕ¬ams->
	gmodif›r
)Õ¬ams->owÃr, 
	g·f
, 
	gŒue
);

123 
checksum_li¡
(
Afãù
 **
li¡_h—d
) {

124 
	gsum
 = 0;

129 cÚ¡ 
Afãù
 *
	g·f
 = *
li¡_h—d
;…aà!ğ
nuÎ±r
;…aàğ
·f
->
Ãxt
)

130 
sum
 +ğ
checksum
(
·f
);

132  
	gsum
;

135 
sÜt_li¡
(
Afãù
 **
li¡_h—d
, 
com·¿tÜ
 
comp
) {

136 
boŞ
 
	gsÜ‹d
 = 
çl£
;

138 !
	gsÜ‹d
) {

139 
	gsÜ‹d
 = 
Œue
;

144 
Afãù
 *
	g·f
 = *
li¡_h—d
;…af;…aàğ
·f
->
Ãxt
) {

145 ià(
·f
->
Ãxt
 =ğ
nuÎ±r
)

148 ià((*
	gcomp
)(
	g·f
,…af->
	gÃxt
) > 0) {

149 
sw­
(
·f
,…af->
Ãxt
);

150 
	gsÜ‹d
 = 
çl£
;

	@src/affect/affect_obj.cc

1 
	~"afãù/afãù_li¡.hh
"

2 
	~"afãù/Afãù.hh
"

3 
	~"Objeù.hh
"

4 
	~"ObjeùPrÙÙy³.hh
"

5 
	~"cÚ¡ªts.hh
"

7 
Çme¥aû
 
	gafãù
 {

10 
modify_obj
(*
owÃr
, cÚ¡ 
Afãù
 *
·f
, 
boŞ
 
fAdd
);

14 
boŞ
 
’chª‹d_obj
(
Objeù
 *
obj
) {

15  
checksum_li¡
(&
obj
->
afãùed
è!ğobj->
pIndexD©a
->
afãù_checksum
;

18 cÚ¡ 
Afãù
 *
li¡_obj
(
Objeù
 *
obj
) {

19  
	gobj
->
	gafãùed
;

22 
boŞ
 
exi¡s_Ú_obj
(
Objeù
 *
obj
, ::
afãù
::
ty³
ype) {

23  
fšd_Ú_obj
(
obj
, 
ty³
è? 
	gŒue
 : 
çl£
;

26 cÚ¡ 
Afãù
 *
fšd_Ú_obj
(
Objeù
 *
obj
, ::
afãù
::
ty³
ype) {

27  
fšd_š_li¡
(&
obj
->
afãùed
, 
ty³
);

32 
cİy_to_obj
(
Objeù
 *
obj
, cÚ¡ 
Afãù
 *
aff_‹m¶©e
)

34 
cİy_to_li¡
(&
obj
->
afãùed
, 
aff_‹m¶©e
);

35 
modify_obj
(
obj
, 
aff_‹m¶©e
, 
Œue
);

38 
još_to_obj
(
Objeù
 *
obj
, 
Afãù
 *
·f
) {

39 
â_·¿ms
 
	g·¿ms
;

41 
	g·¿ms
.
	gowÃr
 = 
obj
;

42 
	g·¿ms
.
	gmodif›r
 = 
modify_obj
;

43 
	g·¿ms
.
	gd©a
 = 
nuÎ±r
;

45 
dedup_š_li¡
(&
obj
->
afãùed
, 
·f
, &
·¿ms
);

46 
cİy_to_obj
(
obj
, 
·f
);

51 
»move_äom_obj
(
Objeù
 *
obj
, 
Afãù
 *
·f
)

53 
»move_äom_li¡
(&
obj
->
afãùed
, 
·f
);

54 
modify_obj
(
obj
, 
·f
, 
çl£
);

55 
d–‘e
 
	g·f
;

58 
»move_m©chšg_äom_obj
(
Objeù
 *
obj
, 
com·¿tÜ
 
comp
, cÚ¡ 
Afãù
 *
·‰”n
) {

59 
â_·¿ms
 
	g·¿ms
;

61 
	g·¿ms
.
	gowÃr
 = 
obj
;

62 
	g·¿ms
.
	gmodif›r
 = 
modify_obj
;

63 
	g·¿ms
.
	gd©a
 = 
nuÎ±r
;

65 
»move_m©chšg_äom_li¡
(&
obj
->
afãùed
, 
comp
, 
·‰”n
, &
·¿ms
);

68 
»move_m¬ked_äom_obj
(
Objeù
 *
obj
) {

69 
Afãù
 
	g·‰”n
;

70 
	g·‰”n
.
	gm¬k
 = 
Œue
;

72 
»move_m©chšg_äom_obj
(
obj
, 
com·¿tÜ_m¬k
, &
·‰”n
);

75 
»move_ty³_äom_obj
(
Objeù
 *
obj
, ::
afãù
::
ty³
ype) {

76 
Afãù
 
·‰”n
;

77 
	g·‰”n
.
	gty³
 = 
ty³
;

79 
»move_m©chšg_äom_obj
(
obj
, 
com·¿tÜ_ty³
, &
·‰”n
);

82 
»move_®l_äom_obj
(
Objeù
 *
obj
, 
boŞ
 
³rmª’t
)

84 
Afãù
 
	g·‰”n
;

85 
	g·‰”n
.
	g³rmª’t
 = 
³rmª’t
;

87 
»move_m©chšg_äom_obj
(
obj
, 
com·¿tÜ_³rmª’t
, &
·‰”n
);

92 
™”©e_ov”_obj
(
Objeù
 *
obj
, 
afãù_â
 
â
, *
d©a
) {

93 
â_·¿ms
 
	g·¿ms
;

95 
	g·¿ms
.
	gowÃr
 = 
obj
;

96 
	g·¿ms
.
	gmodif›r
 = 
modify_obj
;

97 
	g·¿ms
.
	gd©a
 = 
d©a
;

99 
™”©e_ov”_li¡
(&
obj
->
afãùed
, 
â
, &
·¿ms
);

102 
sÜt_obj
(
Objeù
 *
obj
, 
com·¿tÜ
 
comp
) {

103 
sÜt_li¡
(&
obj
->
afãùed
, 
comp
);

109 
boŞ
 
obj_has_afãù
(
Objeù
 *
obj
, ::
afãù
::
ty³
ype) {

110  
fšd_š_li¡
(&
obj
->
afãùed
, 
ty³
è? 
	gŒue
 : 
çl£
;

113 
modify_æag_ÿche_obj
(
Objeù
 *
obj
, 
wh”e
, cÚ¡ 
FÏgs
& 
æags
, 
boŞ
 
fAdd
) {

114 ià(
	gæags
.
em±y
())

117 ià(
	gwh”e
 !ğ
TO_OBJECT
 && 
wh”e
 !ğ
TO_WEAPON
)

123 ià(!
	gfAdd
) {

124 
	gobj
->
	gÿched_exŒa_æags
.
ş—r
();

126 cÚ¡ 
Afãù
 *
	g·f
 = 
obj
->
afãùed
;…af;…aàğ
·f
->
Ãxt
)

127 
modify_æag_ÿche_obj
(
obj
, 
·f
->
wh”e
,…af->
b™veùÜ
(), 
Œue
);

129 cÚ¡ 
Afãù
 *
	g·f
 = 
obj
->
gem_afãùed
;…af;…aàğ
·f
->
Ãxt
)

130 
modify_æag_ÿche_obj
(
obj
, 
·f
->
wh”e
,…af->
b™veùÜ
(), 
Œue
);

133 
	gwh”e
) {

134 
	gTO_OBJECT
:

135 
obj
->
ÿched_exŒa_æags
 +ğ
æags
;

145 
modify_obj
(*
owÃr
, cÚ¡ 
Afãù
 *
·f
, 
boŞ
 
fAdd
) {

146 
modify_obj
((
Objeù
 *)
owÃr
, 
·f
, 
fAdd
);

149 
modify_obj
(
Objeù
 *
obj
, cÚ¡ 
Afãù
 *
·f
, 
boŞ
 
fAdd
) {

150 
modify_æag_ÿche_obj
(
obj
, 
·f
->
wh”e
,…af->
b™veùÜ
(), 
fAdd
);

152 ià(
	gobj
->
	gÿ¼›d_by
 && obj->
	gw—r_loc
 !ğ
WEAR_NONE
)

153 
modify_ch¬
(
obj
->
ÿ¼›d_by
, 
·f
, 
fAdd
);

	@src/affect/affect_room.cc

1 
	~"afãù/afãù_li¡.hh
"

2 
	~"afãù/Afãù.hh
"

3 
	~"Room.hh
"

5 
Çme¥aû
 
	gafãù
 {

8 
modify_room
(*
owÃr
, cÚ¡ 
Afãù
 *
·f
, 
boŞ
 
fAdd
);

12 cÚ¡ 
Afãù
 *
li¡_room
(
Room
 *
room
) {

13  
	groom
->
	gafãùed
;

16 
boŞ
 
exi¡s_Ú_room
(
Room
 *
room
, ::
afãù
::
ty³
ype) {

17  
fšd_Ú_room
(
room
, 
ty³
è? 
	gŒue
 : 
çl£
;

20 cÚ¡ 
Afãù
 *
fšd_Ú_room
(
Room
 *
room
, ::
afãù
::
ty³
ype) {

21  
fšd_š_li¡
(&
room
->
afãùed
, 
ty³
);

26 
cİy_to_room
(
Room
 *
room
, cÚ¡ 
Afãù
 *
aff_‹m¶©e
)

28 
cİy_to_li¡
(&
room
->
afãùed
, 
aff_‹m¶©e
);

29 
modify_room
(
room
, 
aff_‹m¶©e
, 
Œue
);

32 
još_to_room
(
Room
 *
room
, 
Afãù
 *
·f
) {

33 
â_·¿ms
 
	g·¿ms
;

35 
	g·¿ms
.
	gowÃr
 = 
room
;

36 
	g·¿ms
.
	gmodif›r
 = 
modify_room
;

37 
	g·¿ms
.
	gd©a
 = 
nuÎ±r
;

39 
dedup_š_li¡
(&
room
->
afãùed
, 
·f
, &
·¿ms
);

40 
cİy_to_room
(
room
, 
·f
);

45 
»move_äom_room
(
Room
 *
room
, 
Afãù
 *
·f
)

47 
»move_äom_li¡
(&
room
->
afãùed
, 
·f
);

48 
modify_room
(
room
, 
·f
, 
çl£
);

49 
d–‘e
 
	g·f
;

52 
»move_m©chšg_äom_room
(
Room
 *
room
, 
com·¿tÜ
 
comp
, cÚ¡ 
Afãù
 *
·‰”n
) {

53 
â_·¿ms
 
	g·¿ms
;

55 
	g·¿ms
.
	gowÃr
 = 
room
;

56 
	g·¿ms
.
	gmodif›r
 = 
modify_room
;

57 
	g·¿ms
.
	gd©a
 = 
nuÎ±r
;

59 
»move_m©chšg_äom_li¡
(&
room
->
afãùed
, 
comp
, 
·‰”n
, &
·¿ms
);

62 
»move_m¬ked_äom_room
(
Room
 *
room
) {

63 
Afãù
 
	g·‰”n
;

64 
	g·‰”n
.
	gm¬k
 = 
Œue
;

66 
»move_m©chšg_äom_room
(
room
, 
com·¿tÜ_m¬k
, &
·‰”n
);

69 
»move_ty³_äom_room
(
Room
 *
room
, ::
afãù
::
ty³
ype) {

70 
Afãù
 
·‰”n
;

71 
	g·‰”n
.
	gty³
 = 
ty³
;

73 
»move_m©chšg_äom_room
(
room
, 
com·¿tÜ_ty³
, &
·‰”n
);

76 
»move_®l_äom_room
(
Room
 *
room
, 
boŞ
 
³rmª’t
)

78 
Afãù
 
	g·‰”n
;

79 
	g·‰”n
.
	g³rmª’t
 = 
³rmª’t
;

81 
»move_m©chšg_äom_room
(
room
, 
com·¿tÜ_³rmª’t
, &
·‰”n
);

86 
™”©e_ov”_room
(
Room
 *
room
, 
afãù_â
 
â
, *
d©a
) {

87 
â_·¿ms
 
	g·¿ms
;

89 
	g·¿ms
.
	gowÃr
 = 
room
;

90 
	g·¿ms
.
	gmodif›r
 = 
modify_room
;

91 
	g·¿ms
.
	gd©a
 = 
d©a
;

93 
™”©e_ov”_li¡
(&
room
->
afãùed
, 
â
, &
·¿ms
);

96 
sÜt_room
(
Room
 *
room
, 
com·¿tÜ
 
comp
) {

97 
sÜt_li¡
(&
room
->
afãùed
, 
comp
);

102 
modify_æag_ÿche_room
(
Room
 *
room
, 
wh”e
, cÚ¡ 
FÏgs
& 
æags
, 
boŞ
 
fAdd
) {

103 ià(
	gæags
.
em±y
())

106 ià(
	gwh”e
 !ğ
TO_ROOMFLAGS
)

112 ià(!
	gfAdd
) {

113 
	groom
->
	gÿched_room_æags
.
ş—r
();

115 cÚ¡ 
Afãù
 *
	g·f
 = 
room
->
afãùed
;…af;…aàğ
·f
->
Ãxt
)

116 
modify_æag_ÿche_room
(
room
, 
·f
->
wh”e
,…af->
b™veùÜ
(), 
Œue
);

119 
	groom
->
	gÿched_room_æags
 +ğ
æags
;

127 
modify_room
(*
owÃr
, cÚ¡ 
Afãù
 *
·f
, 
boŞ
 
fAdd
) {

128 
modify_room
((
Room
 *)
owÃr
, 
·f
, 
fAdd
);

131 
modify_room
(
Room
 *
room
, cÚ¡ 
Afãù
 *
·f
, 
boŞ
 
fAdd
) {

132 
	g·f
->
	gwh”e
) {

133 
	gTO_ROOMFLAGS
:

134 
modify_æag_ÿche_room
(
room
, 
·f
->
wh”e
,…af->
b™veùÜ
(), 
fAdd
);

137 
	gTO_HPREGEN
:

144 
	gTO_MPREGEN
:

	@src/affect/affect_table.cc

1 
	~"afãù/Afãù.hh
"

2 
	~"Loggšg.hh
"

4 
Çme¥aû
 
	gafãù
 {

6 cÚ¡ 
	gbË_’Œy
& 
lookup
(::
afãù
::
ty³
ype) {

7 cÚ¡‡uto& 
·œ
 = 
afãù_bË
.
fšd
(
ty³
);

9 ià(
	g·œ
 =ğ
afãù_bË
.
ûnd
()) {

10 
Loggšg
::
bugf
("afãù†ookup:y³ %d‚Ù found", 
ty³
);

11  
	gafãù_bË
.
fšd
(::
afãù
::
ty³
::
unknown
)->
£cÚd
;

14  
	g·œ
->
	g£cÚd
;

17 cÚ¡ ::
afãù
::
ty³
 
lookup
(cÚ¡ 
SŒšg
& 
Çme
) {

18 cÚ¡‡uto& 
·œ
 : 
afãù_bË
)

19 ià(
Çme
.
is_´efix_of
(
·œ
.
£cÚd
.name))

20  
·œ
.
fœ¡
;

22  
	gty³
::
unknown
;

26 cÚ¡ 
	g¡d
::
m­
<::
afãù
::
ty³
, cÚ¡ 
	gbË_’Œy
> 
	gafãù_bË
 = {

28 { 
ty³
::
unknown
, { "unknown", "", "", "" }},

29 { 
ty³
::
nÚe
, { "reserved", "", "", "" }},

32 { 
ty³
::
acid_b»©h
, { "acid breath", "!Acid Breath!",

34 { 
ty³
::
age
, { "age", "You feel younger.",

36 { 
ty³
::
¬mÜ
, { "armor", "You feel†ess‡rmored.",

38 { 
ty³
::
bËss
, { "bless", "You feel†ess„ighteous.",

40 { 
ty³
::
blšdÃss
, { "blindness", "You can see‡gain.",

42 { 
ty³
::
blood_moÚ
, { "blood moon", "You feel†ess bloodthirsty.",

44 { 
ty³
::
ÿlm
, { "calm", "You have†ost your…eace of mind.",

46 { 
ty³
::
chªge_£x
, { "change sex", "Your body feels familiar‡gain.",

48 { 
ty³
::
chªÃl
, { "channel", "You feel„evived.",

50 { 
ty³
::
ch¬m_³rsÚ
, { "charm…erson", "You feel more self-confident.",

52 { 
ty³
::
chl_touch
, { "chillouch", "You feel†ess cold.",

54 { 
ty³
::
cur£
, { "curse", "The curse wears off.",

56 { 
ty³
::
d¬kÃss
, { "darkness", "",

58 { 
ty³
::
dazzlšg_light
, { "dazzling†ight", "!Dazzling Light!",

60 { 
ty³
::
d‘eù_ev
, { "detectƒvil", "The„ed in your vision disappears.",

62 { 
ty³
::
d‘eù_good
, { "detect good", "The gold in your vision disappears.",

64 { 
ty³
::
d‘eù_hidd’
, { "detect hidden", "You feel†ess‡ware of your surroundings.",

66 { 
ty³
::
d‘eù_švis
, { "detect invis", "You‚o†onger seehe invisible.",

68 { 
ty³
::
d‘eù_magic
, { "detect magic", "The detect magic wears off.",

70 { 
ty³
::
divše_»g’”©iÚ
,{ "divine„egeneration","You‚o†onger feel so vibrant.",

72 { 
ty³
::
’chªt_¬mÜ
, { "enchant‡rmor", "!Enchant Armor!",

74 { 
ty³
::
’chªt_w—pÚ
, { "enchant weapon", "!Enchant Weapon!",

76 { 
ty³
::
ç”›_fœe
, { "faerie fire", "The…ink‡ura‡round you fades‡way.",

78 { 
ty³
::
ã¬
, { "fear", "You‡re‚o†onger‡fraid.",

80 { 
ty³
::
fœe_b»©h
, { "fire breath", "The smoke†eaves yourƒyes.",

82 { 
ty³
::
fœ•roof
, { "fireproof", "",

84 { 
ty³
::
æamesh›ld
, { "flameshield", "The circle of flames‡round your body dissipates.",

86 { 
ty³
::
æy
, { "fly", "You slowly floatohe ground.",

88 { 
ty³
::
ä’zy
, { "frenzy", "Your„ageƒbbs.",

90 { 
ty³
::
gŸÁ_¡»ngth
, { "giant strength", "You feel weaker.",

92 { 
ty³
::
ha¡e
, { "haste", "You feel yourself slow down.",

94 { 
ty³
::
švis
, { "invisibility", "You‡re‚o†onger invisible.",

96 { 
ty³
::
mass_švis
, { "mass invis", "You‡re‚o†onger invisible.",

98 { 
ty³
::
night_visiÚ
, { "infravision", "You‚o†onger see inhe dark.",

100 { 
ty³
::
·ss_doÜ
, { "pass door", "You feel solid‡gain.",

102 { 
ty³
::
¶ague
, { "plague", "Your sores vanish.",

104 { 
ty³
::
poisÚ
, { "poison", "You feel†ess sick.",

106 { 
ty³
::
´ÙeùiÚ_ev
, { "protectionƒvil", "You feel†ess…rotected fromƒvil.",

108 { 
ty³
::
´ÙeùiÚ_good
, { "protection good", "You feel†ess…rotected from good.",

110 { 
ty³
::
¿ybª
, { "rayban", "You blink‡s yourƒye…rotection fades.",

112 { 
ty³
::
»g’”©iÚ
, { "regeneration", "You‚o†onger feel so vibrant.",

114 { 
ty³
::
§nùu¬y
, { "sanctuary", "The white‡ura‡round your body fades.",

116 { 
ty³
::
sh›ld
, { "shield", "Your force shield shimmershen fades‡way.",

118 { 
ty³
::
¦“p
, { "sleep", "You feel†essired.",

120 { 
ty³
::
¦ow
, { "slow", "You feel yourself speed up.",

122 { 
ty³
::
smokesü“n
, { "smokescreen", "Smoke‚o†onger clouds your vision.",

124 { 
ty³
::
¡“l_mi¡
, { "steel mist", "The steel mist fades from your‡rmor.",

126 { 
ty³
::
¡Úe_skš
, { "stone skin", "Your skin feels soft‡gain.",

128 { 
ty³
::
lÚ
, { "talon", "You‚o†onger hold your weapon soightly.",

130 { 
ty³
::
w—k’
, { "weaken", "You feel stronger.",

132 { 
ty³
::
b”£rk
, { "berserk", "You feel your…ulse slow down.",

134 { 
ty³
::
dœt_kickšg
, { "dirt kicking", "You„ubhe dirt out of yourƒyes.",

136 { 
ty³
::
hide
, { "hide", "You‡re‚o†onger hidden.",

138 { 
ty³
::
med™©iÚ
, { "meditation", "Meditation",

140 { 
ty³
::
¢—k
, { "sneak", "You‚o†onger feel stealthy.",

142 { 
ty³
::
sh“n
, { "sheen", "Your‡rmor†oses its sheen.",

144 { 
ty³
::
focus
, { "focus", "Your spells†oseheir focus.",

146 { 
ty³
::
·¿lyze
, { "paralyze", "You can feel your†imbs‡gain!",

148 { 
ty³
::
œÚskš
, { "ironskin", "Your skin softens considerably.",

150 { 
ty³
::
b¬r›r
, { "barrier", "The barrier‡round you crumbles.",

152 { 
ty³
::
dazzË
, { "dazzle", "The spots in your vision fade.",

154 { 
ty³
::
midnight
, { "midnight", "You step out ofhe shadows.",

156 { 
ty³
::
shadow_fÜm
, { "shadow form", "!Shadow Form!",

158 { 
ty³
::
hex
, { "hex", "You feel‡gainhe warmth of†ight.",

160 { 
ty³
::
bÚe_w®l
, { "bone wall", "The swirling bones fallohe ground.",

162 { 
ty³
::
hamm”¡rike
, { "hammerstrike", "The…ower ofhe gods has†eft you.",

164 { 
ty³
::
fÜû_sh›ld
, { "force shield", "Your mystical‡ura fades.",

168 { 
ty³
::
w—pÚ_acidic
, { "acidic", "", "", "The sizzling sound from $p quiets." }},

169 { 
ty³
::
w—pÚ_vampœic
, { "vampiric", "", "", "$p is‚o†onger‡ bloodthirsty weapon." }},

170 { 
ty³
::
w—pÚ_æamšg
, { "flaming", "", "", "$p's flame diminishes." }},

171 { 
ty³
::
w—pÚ_äo¡
, { "frost", "", "", "$p is‚o†onger so coldoheouch." }},

172 { 
ty³
::
w—pÚ_shockšg
, { "shocking", "", "", "$p'sƒnergy fizzles out." }},

173 { 
ty³
::
w—pÚ_two_hªds
, { "two-handed", "", "", "$p suddenly feels†ighter." }},

174 { 
ty³
::
w—pÚ_sh¬p
, { "sharp", "", "", "$p‚o†onger†ooks so sharp." }},

175 { 
ty³
::
w—pÚ_vÜ·l
, { "vorpal", "", "", "$p feels†ess drawno severing‚ecks." }},

178 { 
ty³
::
obj_´efix_sŞ¬
, { "solar", "", "", "" }},

179 { 
ty³
::
obj_´efix_a¡¿l
, { "astral", "", "", "" }},

180 { 
ty³
::
obj_´efix_luÇr
, { "lunar", "", "", "" }},

181 { 
ty³
::
obj_´efix_wšdy
, { "windy", "", "", "" }},

182 { 
ty³
::
obj_´efix_h—Éhy
, { "healthy", "", "", "" }},

183 { 
ty³
::
obj_´efix_h—¹y
, { "hearty", "", "", "" }},

184 { 
ty³
::
obj_´efix_¡®w¬t
, { "stalwart", "", "", "" }},

185 { 
ty³
::
obj_´efix_my¡iÿl
, { "mystical", "", "", "" }},

186 { 
ty³
::
obj_´efix_magiÿl
, { "magical", "", "", "" }},

187 { 
ty³
::
obj_´efix_lucky
, { "lucky", "", "", "" }},

188 { 
ty³
::
obj_´efix_fÜtu™ous
,{ "fortuitous", "", "", "" }},

189 { 
ty³
::
obj_´efix_¡urdy
, { "sturdy", "", "", "" }},

190 { 
ty³
::
obj_´efix_»šfÜûd
,{ "reinforced", "", "", "" }},

191 { 
ty³
::
obj_´efix_´eci£
, { "precise", "", "", "" }},

192 { 
ty³
::
obj_´efix_skËd
, { "skilled", "", "", "" }},

193 { 
ty³
::
obj_´efix_jagged
, { "jagged", "", "", "" }},

194 { 
ty³
::
obj_´efix_brul
, { "brutal", "", "", "" }},

196 { 
ty³
::
obj_suffix_š™Ÿ‹_que¡Ü
, { "initiate questor", "", "", "" }},

197 { 
ty³
::
obj_suffix_advªûd_que¡Ü
, { "advanced questor", "", "", "" }},

198 { 
ty³
::
obj_suffix_ma¡”_que¡Ü
, { "master questor", "", "", "" }},

199 { 
ty³
::
obj_suffix_skËd
, { "skilled", "", "", "" }},

200 { 
ty³
::
obj_suffix_sklful
, { "skillful", "", "", "" }},

201 { 
ty³
::
obj_suffix_ex³r›nûd
, { "experienced", "", "", "" }},

202 { 
ty³
::
obj_suffix_š™Ÿ‹_mage
, { "initiate mage", "", "", "" }},

203 { 
ty³
::
obj_suffix_advªûd_mage
, { "advanced mage", "", "", "" }},

204 { 
ty³
::
obj_suffix_ma¡”_mage
, { "master mage", "", "", "" }},

205 { 
ty³
::
obj_suffix_sw®low
, { "swallow", "", "", "" }},

206 { 
ty³
::
obj_suffix_hawk
, { "hawk", "", "", "" }},

207 { 
ty³
::
obj_suffix_çlcÚ
, { "falcon", "", "", "" }},

208 { 
ty³
::
obj_suffix_deva¡©iÚ
, { "devastation", "", "", "" }},

209 { 
ty³
::
obj_suffix_ªnih©iÚ
, { "annihilation", "", "", "" }},

210 { 
ty³
::
obj_suffix_¬ÿÃ_pow”
, { "arcane…ower", "", "", "" }},

211 { 
ty³
::
obj_suffix_my¡iÿl_pow”
, { "mystical…ower", "", "", "" }},

212 { 
ty³
::
obj_suffix_hexxšg
, { "hexxing", "", "", "" }},

213 { 
ty³
::
obj_suffix_»¡Ü©ive
, { "restorative", "", "", "" }},

214 { 
ty³
::
obj_suffix_my¡ic
, { "mystic", "", "", "" }},

216 { 
ty³
::
obj_fÜge_unique
, { "expertise", "", "", "" }},

217 { 
ty³
::
obj_´›¡ess_unique
, { "priestess", "", "", "" }},

218 { 
ty³
::
obj_b»w_unique
, { "brewmaster", "", "", "" }},

219 { 
ty³
::
obj_süibe_unique
, { "scriber", "", "", "" }},

220 { 
ty³
::
obj_nk_unique
, { "Shield's Defense", "", "", "" }},

221 { 
ty³
::
obj_Ãüo_p›rû_unique
, { "Necromancer's Power", "", "", "" }},

222 { 
ty³
::
obj_lidda_au¿_unique
, { "Lidda's Aura", "", "", "" }},

224 { 
ty³
::
obj_£t_mage_švok”
, { "mage invoker set", "", "", "" }},

225 { 
ty³
::
obj_£t_w¬riÜ_b”£rk”
, { "warrior beserker set", "", "", "" }},

226 { 
ty³
::
obj_£t_ş”ic_divše
, { "cleric divine set", "", "", "" }},

227 { 
ty³
::
obj_£t_th›f_cuur£
, { "thief cutpurse set", "", "", "" }},

228 { 
ty³
::
obj_£t_·Ïdš_g¿û
, { "paladin grace set", "", "", "" }},

	@src/alias.cc

28 
	~<m­
>

29 
	~<ut™y
>

31 
	~"¬gum’t.hh
"

32 
	~"Ch¬aù”.hh
"

33 
	~"deş¬e.hh
"

34 
	~"DesütÜ.hh
"

35 
	~"Loggšg.hh
"

36 
	~"memÜy.hh
"

37 
	~"m”c.hh
"

38 
	~"PÏy”.hh
"

39 
	~"SŒšg.hh
"

41 *
g‘_muÉi_commªd
 
¬gs
((
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
));

44 
	$sub¡™u‹_®Ÿs
(
DesütÜ
 *
d
, 
SŒšg
 
¬gum’t
)

46 
Ch¬aù”
 *
ch
;

47 
SŒšg
 
buf
;

48 
SŒšg
 
´efix
;

49 
ch
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

51 ià(!
ch
) {

52 
Loggšg
::
	`bug
("substitute_alias:‚ull ch", 0);

56 ià(!
ch
->
pcd©a
) {

57 
Loggšg
::
	`bug
("substitute_alias:‚ull…cdata", 0);

62 ià(!
ch
->
´efix
.
	`em±y
(è&& !
¬gum’t
.
	`has_´efix
("prefix"))

63 
¬gum’t
 = 
ch
->
´efix
 + " " +‡rgument;

65 ià(
ch
->
	`is_Åc
()

66 || 
¬gum’t
.
	`has_´efix
("alias") ||‡rgument.has_prefix("una")

67 || 
¬gum’t
.
	`has_´efix
("prefix")) {

68 
	`š‹½»t
(
d
->
ch¬aù”
, 
¬gum’t
);

72 
buf
 = 
¬gum’t
;

74 
¡d
::
¡ršg
 
šput
 = 
¬gum’t
;

75 
SŒšg
 
wÜd
;

76 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
wÜd
);

77 autØ
£¬ch
 = 
ch
->
pcd©a
->
®Ÿs
.
	`fšd
(
wÜd
);

79 ià(
£¬ch
 !ğ
ch
->
pcd©a
->
®Ÿs
.
	`’d
()) {

80 
buf
 = (*
£¬ch
).
£cÚd
;

81 
buf
 += " ";

82 
buf
 +ğ
¬gum’t
;

84 
buf
 = 
	`g‘_muÉi_commªd
(
d
, buf);

86 ià(
	`¡¾’
(
buf
è> 
MAX_INPUT_LENGTH
) {

87 
	`¡c
("AlŸ sub¡™utiÚoØlÚg. Trunÿ‹d.\n", 
ch
);

88 
buf
.
	`”a£
(
MAX_INPUT_LENGTH
 - 1);

92 
	`š‹½»t
(
d
->
ch¬aù”
, 
buf
);

93 
	}
}

95 
	$do_®Ÿ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

97 
	`¡c
("I'm sÜry,‡lŸ mu¡ b’‹»d iÀfuÎ.\n", 
ch
);

99 
	}
}

101 
	$do_®Ÿs
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

103 
Ch¬aù”
 *
rch
;

105 ià(
ch
->
desc
 =ğ
nuÎ±r
)

106 
rch
 = 
ch
;

108 
rch
 = 
ch
->
desc
->
Üigš®
 ? ch->desc->original : ch;

110 ià(
rch
->
	`is_Åc
())

113 
SŒšg
 
¬g
;

114 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

116 ià(
¬g
.
	`em±y
()) {

117 ià(
rch
->
pcd©a
->
®Ÿs
.
	`em±y
()) {

118 
	`¡c
("You havnØ®Ÿ£ defšed.\n", 
ch
);

122 
	`¡c
("You¸cu¼’ˆ®Ÿ£ ¬e:\n", 
ch
);

124 autØ&
kv
: 
rch
->
pcd©a
->
®Ÿs
)

125 
	`±c
(
ch
, " %s: %s\n", 
kv
.
fœ¡
, kv.
£cÚd
);

130 ià(
¬g
.
	`has_´efix
("una") ||‡rg == "alias") {

131 
	`¡c
("SÜry,h© wÜd i »£rved.\n", 
ch
);

135 ià(
¬gum’t
.
	`em±y
()) {

136 autØ
£¬ch
 = 
rch
->
pcd©a
->
®Ÿs
.
	`fšd
(
¬g
);

138 ià(
£¬ch
 =ğ
rch
->
pcd©a
->
®Ÿs
.
	`’d
())

139 
	`¡c
("Th©‡lŸ i nÙ defšed.\n", 
ch
);

141 
	`±c
(
ch
, "% ®Ÿ£ tØ'%s'.\n", (*
£¬ch
).
fœ¡
, (*£¬ch).
£cÚd
);

146 ià(
¬gum’t
.
	`is_´efix_of
("delete") ||‡rgument.is_prefix_of("prefix")) {

147 
	`¡c
("Th© sh®ÈnÙ bdÚe!\n", 
ch
);

151 autØ
£¬ch
 = 
rch
->
pcd©a
->
®Ÿs
.
	`fšd
(
¬g
);

153 
	`±c
(
ch
, "%s is‚ow %saliasedo '%s'.\n",

154 
¬g
,

155 
£¬ch
 =ğ
rch
->
pcd©a
->
®Ÿs
.
	`’d
() ? "" : "re",

156 
¬gum’t
);

158 
rch
->
pcd©a
->
®Ÿs
[
¬g
] = 
¬gum’t
;

159 
	}
}

161 
	$do_uÇlŸs
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

163 
Ch¬aù”
 *
rch
;

165 ià(
ch
->
desc
 =ğ
nuÎ±r
)

166 
rch
 = 
ch
;

168 
rch
 = 
ch
->
desc
->
Üigš®
 ? ch->desc->original : ch;

170 ià(
rch
->
	`is_Åc
())

173 ià(
¬gum’t
.
	`em±y
()) {

174 
	`¡c
("UÇlŸ wh©?\n", 
ch
);

178 
SŒšg
 
¬g
;

179 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

181 autØ
£¬ch
 = 
rch
->
pcd©a
->
®Ÿs
.
	`fšd
(
¬g
);

183 ià(
£¬ch
 =ğ
rch
->
pcd©a
->
®Ÿs
.
	`’d
())

184 
	`¡c
("NØ®Ÿ oàth©‚amtØ»move.\n", 
ch
);

186 
	`¡c
("AlŸ »moved.\n", 
ch
);

188 
rch
->
pcd©a
->
®Ÿs
.
	`”a£
(
¬g
);

189 
	}
}

	@src/area_handler.cc

11 
	~"¬gum’t.hh
"

12 
	~"afãù/Afãù.hh
"

13 
	~"A»a.hh
"

14 
	~"Ch¬aù”.hh
"

15 
	~"deş¬e.hh
"

16 
	~"ExŒaDesü.hh
"

17 
	~"FÏgs.hh
"

18 
	~"FÜm©.hh
"

19 
	~"Game.hh
"

20 
	~"Loggšg.hh
"

21 
	~"memÜy.hh
"

22 
	~"m”c.hh
"

23 
	~"MobePrÙÙy³.hh
"

24 
	~"Objeù.hh
"

25 
	~"ObjeùPrÙÙy³.hh
"

26 
	~"ObjeùV®ue.hh
"

27 
	~"PÏy”.hh
"

28 
	~"¿ndom.hh
"

29 
	~"Room.hh
"

30 
	~"SŒšg.hh
"

31 
	~"WÜld.hh
"

37 
Ch¬aù”
 *
	$ü—‹_mobe
(
MobePrÙÙy³
 *
pMobIndex
)

39 
Ch¬aù”
 *
mob
;

40 
i
, 
¡amba£
;

41 
w—Éh
;

43 ià(
pMobIndex
 =ğ
nuÎ±r
) {

44 
Loggšg
::
	`bug
("Create_mobile:‚ullptr…MobIndex.", 0);

48  
nuÎ±r
;

51 
mob
 = 
Ãw
 
	`Ch¬aù”
();

54 ià(!
mob
)

55  
nuÎ±r
;

57 
mob
->
pIndexD©a
 = 
pMobIndex
;

58 
mob
->
Çme
 = 
pMobIndex
->
¶ay”_Çme
;

59 
mob
->
shÜt_desü
 = 
pMobIndex
->short_descr;

60 
mob
->
lÚg_desü
 = 
pMobIndex
->long_descr;

61 
mob
->
desütiÚ
 = 
pMobIndex
->description;

62 
mob
->
¥ec_fun
 = 
pMobIndex
->spec_fun;

63 
mob
->
»£t
 = 
nuÎ±r
;

65 ià(
pMobIndex
->
w—Éh
 <= 0) {

66 
mob
->
sv”
 = 0;

67 
mob
->
gŞd
 = 0;

70 
w—Éh
 = 
mob
->
pIndexD©a
->wealth;

71 
w—Éh
 = 
	`numb”_¿nge
(wealth / 2, 3 * wealth / 2);

72 
mob
->
sv”
 = 
w—Éh
 % 100;

73 
mob
->
gŞd
 = 
w—Éh
 / 100;

77 
mob
->
group_æags
 = 
pMobIndex
->group_flags;

78 
mob
->
aù_æags
 = 
pMobIndex
->act_flags;

79 
mob
->
comm_æags
 = 
COMM_NOCHANNELS
;

80 
mob
->
®ignm’t
 = 
pMobIndex
->alignment;

81 
mob
->
Ëv–
 = 
pMobIndex
->level;

82 
	`ATTR_BASE
(
mob
, 
APPLY_HITROLL
èğ
pMobIndex
->
h™rŞl
;

83 
	`ATTR_BASE
(
mob
, 
APPLY_DAMROLL
èğ
pMobIndex
->
damage
[
DICE_BONUS
];

84 
	`ATTR_BASE
(
mob
, 
APPLY_HIT
èğ
	`diû
(
pMobIndex
->
h™
[
DICE_NUMBER
],

85 
pMobIndex
->
h™
[
DICE_TYPE
])

86 + 
pMobIndex
->
h™
[
DICE_BONUS
];

87 
	`ATTR_BASE
(
mob
, 
APPLY_MANA
èğ
	`diû
(
pMobIndex
->
mªa
[
DICE_NUMBER
],

88 
pMobIndex
->
mªa
[
DICE_TYPE
])

89 + 
pMobIndex
->
mªa
[
DICE_BONUS
];

90 
mob
->
damage
[
DICE_NUMBER
] = 
pMobIndex
->damage[DICE_NUMBER];

91 
mob
->
damage
[
DICE_TYPE
] = 
pMobIndex
->damage[DICE_TYPE];

92 
mob
->
dam_ty³
 = 
pMobIndex
->dam_type;

94 ià(
mob
->
dam_ty³
 == 0)

95 
	`numb”_¿nge
(1, 3)) {

96 (1): 
mob
->
dam_ty³
 = 3; ;

98 (2): 
mob
->
dam_ty³
 = 7; ;

100 (3): 
mob
->
dam_ty³
 = 11; ;

103 
i
 = 0; i < 4; i++)

104 
mob
->
¬mÜ_ba£
[
i
] = 
pMobIndex
->
ac
[i];

106 
mob
->
off_æags
 = 
pMobIndex
->off_flags;

107 
mob
->
¡¬t_pos
 = 
pMobIndex
->start_pos;

108 
mob
->
deçuÉ_pos
 = 
pMobIndex
->default_pos;

110 ià(
pMobIndex
->
£x
 == 3)

111 
	`ATTR_BASE
(
mob
, 
APPLY_SEX
èğ
	`numb”_¿nge
(1, 2);

113 
	`ATTR_BASE
(
mob
, 
APPLY_SEX
èğ
pMobIndex
->
£x
;

115 
mob
->
¿û
 = 
pMobIndex
->race;

116 
mob
->
fÜm_æags
 = 
pMobIndex
->form_flags;

117 
mob
->
·¹s_æags
 = 
pMobIndex
->parts_flags;

118 
mob
->
size
 = 
pMobIndex
->size;

119 
mob
->
m©”Ÿl
 = 
pMobIndex
->material;

122 
¡©
 = 0; sˆ< 
MAX_STATS
; stat++)

123 
	`ATTR_BASE
(
mob
, 
	`¡©_to_©Œ
(
¡©
)èğ
¡d
::
	`mš
(25, 
	`numb”_fuzzy
(8 + mob->
Ëv–
 / 12));

125 ià(
mob
->
aù_æags
.
	`has
(
ACT_WARRIOR
)) {

126 
	`ATTR_BASE
(
mob
, 
APPLY_STR
) += 3;

127 
	`ATTR_BASE
(
mob
, 
APPLY_INT
) -= 2;

128 
	`ATTR_BASE
(
mob
, 
APPLY_CON
) += 2;

129 
	`ATTR_BASE
(
mob
, 
APPLY_CHR
) -= 1;

130 
	`ATTR_BASE
(
mob
, 
APPLY_WIS
) -= 2;

132 ià(
mob
->
aù_æags
.
	`has
(
ACT_THIEF
)) {

133 
	`ATTR_BASE
(
mob
, 
APPLY_DEX
) += 3;

134 
	`ATTR_BASE
(
mob
, 
APPLY_WIS
) -= 2;

135 
	`ATTR_BASE
(
mob
, 
APPLY_CHR
) += 2;

136 
	`ATTR_BASE
(
mob
, 
APPLY_CON
) -= 2;

138 ià(
mob
->
aù_æags
.
	`has
(
ACT_CLERIC
)) {

139 
	`ATTR_BASE
(
mob
, 
APPLY_WIS
) += 3;

140 
	`ATTR_BASE
(
mob
, 
APPLY_INT
) += 1;

141 
	`ATTR_BASE
(
mob
, 
APPLY_DEX
) -= 2;

142 
	`ATTR_BASE
(
mob
, 
APPLY_CHR
) += 1;

144 ià(
mob
->
aù_æags
.
	`has
(
ACT_MAGE
)) {

145 
	`ATTR_BASE
(
mob
, 
APPLY_INT
) += 3;

146 
	`ATTR_BASE
(
mob
, 
APPLY_STR
) -= 3;

147 
	`ATTR_BASE
(
mob
, 
APPLY_DEX
) += 1;

148 
	`ATTR_BASE
(
mob
, 
APPLY_WIS
) += 1;

149 
	`ATTR_BASE
(
mob
, 
APPLY_CON
) -= 2;

152 ià(
¿û_bË
[
mob
->
¿û
].
pc_¿û
 =ğ
Œue
)

153 
¡©
 = 0; sˆ< 
MAX_STATS
; stat++)

154 
	`ATTR_BASE
(
mob
, 
	`¡©_to_©Œ
(
¡©
)è+ğ(
pc_¿û_bË
[mob->
¿û
].
¡©s
[stat] - 13);

157 ià(
mob
->
off_æags
.
	`has
(
OFF_FAST
))

158 
	`ATTR_BASE
(
mob
, 
APPLY_DEX
) += 2;

160 
	`ATTR_BASE
(
mob
, 
APPLY_STR
è+ğmob->
size
 - 
SIZE_MEDIUM
;

161 
	`ATTR_BASE
(
mob
, 
APPLY_CON
è+ğ(mob->
size
 - 
SIZE_MEDIUM
) / 2;

163 
afãù
::
	`add_¿cŸl_to_ch¬
(
mob
);

165 
afãù
::
	`cİy_æags_to_ch¬
(
mob
, 'A', 
pMobIndex
->
afãù_æags
, 
çl£
);

166 
afãù
::
	`cİy_æags_to_ch¬
(
mob
, 'I', 
pMobIndex
->
imm_æags
, 
Œue
);

167 
afãù
::
	`cİy_æags_to_ch¬
(
mob
, 'R', 
pMobIndex
->
»s_æags
, 
Œue
);

168 
afãù
::
	`cİy_æags_to_ch¬
(
mob
, 'V', 
pMobIndex
->
vuÊ_æags
, 
Œue
);

171 
	`ATTR_BASE
(
mob
, 
APPLY_STAM
) = 100;

173 ià(
mob
->
aù_æags
.
	`has
(
ACT_MAGE
))

174 
¡amba£
 = 3;

175 ià(
mob
->
aù_æags
.
	`has
(
ACT_CLERIC
))

176 
¡amba£
 = 4;

177 ià(
mob
->
aù_æags
.
	`has
(
ACT_THIEF
))

178 
¡amba£
 = 7;

179 ià(
mob
->
aù_æags
.
	`has
(
ACT_WARRIOR
))

180 
¡amba£
 = 9;

182 
¡amba£
 = 5;

184 
i
 = 0; i < 
mob
->
Ëv–
; i++)

185 
	`ATTR_BASE
(
mob
, 
APPLY_STAM
è+ğ
	`numb”_fuzzy
(
¡amba£
);

187 
mob
->
h™
 = 
	`GET_MAX_HIT
(mob);

188 
mob
->
mªa
 = 
	`GET_MAX_MANA
(mob);

189 
mob
->
¡am
 = 
	`GET_MAX_STAM
(mob);

191 
mob
->
pos™iÚ
 = mob->
¡¬t_pos
;

194 
Game
::
	`wÜld
().
	`add_ch¬
(
mob
);

195 
pMobIndex
->
couÁ
++;

196  
mob
;

197 
	}
}

200 
	$şÚe_mobe
(
Ch¬aù”
 *
·»Á
, Ch¬aù” *
şÚe
)

202 ià(
·»Á
 =ğ
nuÎ±r
 || 
şÚe
 =ğnuÎ±¸|| !·»Á->
	`is_Åc
())

206 
şÚe
->
Çme
 = 
·»Á
->name;

207 
şÚe
->
shÜt_desü
 = 
·»Á
->short_descr;

208 
şÚe
->
lÚg_desü
 = 
·»Á
->long_descr;

209 
şÚe
->
desütiÚ
 = 
·»Á
->description;

210 
şÚe
->
m©”Ÿl
 = 
·»Á
->material;

211 
şÚe
->
´efix
 = 
·»Á
->prefix;

212 
şÚe
->
´om±
 = 
·»Á
->prompt;

214 
i
 = 1; i < 
MAX_ATTR
; i++)

215 
	`ATTR_BASE
(
şÚe
, 
i
èğATTR_BASE(
·»Á
, i);

217 
şÚe
->
group_æags
 = 
·»Á
->group_flags;

219 
şÚe
->
gud
 = 
·»Á
->guild;

220 
şÚe
->
¿û
 = 
·»Á
->race;

221 
şÚe
->
Ëv–
 = 
·»Á
->level;

222 
şÚe
->
tim”
 = 
·»Á
->timer;

223 
şÚe
->
wa™
 = 
·»Á
->wait;

224 
şÚe
->
h™
 = 
·»Á
->hit;

226 
şÚe
->
mªa
 = 
·»Á
->mana;

228 
şÚe
->
¡am
 = 
·»Á
->stam;

230 
şÚe
->
gŞd
 = 0;

231 
şÚe
->
sv”
 = 0;

232 
şÚe
->
exp
 = 
·»Á
->exp;

233 
şÚe
->
aù_æags
 = 
·»Á
->act_flags;

234 
şÚe
->
comm_æags
 = 
·»Á
->comm_flags;

235 
şÚe
->
švis_Ëv–
 = 
·»Á
->invis_level;

236 
şÚe
->
pos™iÚ
 = 
·»Á
->position;

237 
şÚe
->
´aùiû
 = 
·»Á
->practice;

238 
şÚe
->
Œaš
 = 
·»Á
->train;

240 
şÚe
->
®ignm’t
 = 
·»Á
->alignment;

243 
şÚe
->
wimpy
 = 
·»Á
->wimpy;

244 
şÚe
->
fÜm_æags
 = 
·»Á
->form_flags;

245 
şÚe
->
·¹s_æags
 = 
·»Á
->parts_flags;

246 
şÚe
->
size
 = 
·»Á
->size;

247 
şÚe
->
off_æags
 = 
·»Á
->off_flags;

248 
şÚe
->
dam_ty³
 = 
·»Á
->dam_type;

249 
şÚe
->
¡¬t_pos
 = 
·»Á
->start_pos;

250 
şÚe
->
deçuÉ_pos
 = 
·»Á
->default_pos;

251 
şÚe
->
¥ec_fun
 = 
·»Á
->spec_fun;

253 
i
 = 0; i < 4; i++)

254 
şÚe
->
¬mÜ_ba£
[
i
] = 
·»Á
->armor_base[i];

262 
i
 = 0; i < 3; i++)

263 
şÚe
->
damage
[
i
] = 
·»Á
->damage[i];

265 
afãù
::
	`»move_®l_äom_ch¬
(
şÚe
, 
Œue
);

266 
afãù
::
	`»move_®l_äom_ch¬
(
şÚe
, 
çl£
);

268 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_ch¬
(
·»Á
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
)

269 
afãù
::
	`cİy_to_ch¬
(
şÚe
, 
·f
);

270 
	}
}

275 
Objeù
 *
	$ü—‹_objeù
(
ObjeùPrÙÙy³
 *
pObjIndex
, 
Ëv–
)

277 
Objeù
 *
obj
;

278 
i
;

280 ià(
pObjIndex
 =ğ
nuÎ±r
) {

281 
Loggšg
::
	`bug
("Create_object:‚ullptr…ObjIndex.", 0);

286  
nuÎ±r
;

289 
obj
 = 
Ãw
 
	`Objeù
(
pObjIndex
);

292 ià(! 
obj
) {

293 
Loggšg
::
	`bug
("create_object: unableo‡llocate memory", 0);

294  
nuÎ±r
;

297 
obj
->
Ëv–
 = 
pObjIndex
->level;

298 
obj
->
w—r_loc
 = -1;

299 
obj
->
Çme
 = 
pObjIndex
->name;

300 
obj
->
shÜt_desü
 = 
pObjIndex
->short_descr;

301 
obj
->
desütiÚ
 = 
pObjIndex
->description;

302 
obj
->
m©”Ÿl
 = 
pObjIndex
->material;

303 
obj
->
cÚd™iÚ
 = 
pObjIndex
->condition;

304 
obj
->
™em_ty³
 = 
pObjIndex
->item_type;

305 
obj
->
exŒa_æags
 = 
pObjIndex
->extra_flags;

306 
obj
->
w—r_æags
 = 
pObjIndex
->wear_flags;

307 
obj
->
v®ue
[0] = 
pObjIndex
->value[0];

308 
obj
->
v®ue
[1] = 
pObjIndex
->value[1];

309 
obj
->
v®ue
[2] = 
pObjIndex
->value[2];

310 
obj
->
v®ue
[3] = 
pObjIndex
->value[3];

311 
obj
->
v®ue
[4] = 
pObjIndex
->value[4];

312 
obj
->
num_£‰šgs
 = 
pObjIndex
->num_settings;

313 
obj
->
weight
 = 
pObjIndex
->weight;

314 
obj
->
co¡
 = 
pObjIndex
->cost;

319 
obj
->
™em_ty³
) {

321 
Loggšg
::
	`bugf
("R—d_objeù: vnum %d bady³.", 
pObjIndex
->
vnum
);

324 
ITEM_LIGHT
:

325 ià(
obj
->
v®ue
[2] == 999)

326 
obj
->
v®ue
[2] = -1;

330 
ITEM_JUKEBOX
:

331 
i
 = 0; i < 5; i++)

332 
obj
->
v®ue
[
i
] = -1;

336 
ITEM_SCROLL
:

337 
ITEM_WAND
:

338 
ITEM_STAFF
:

339 
ITEM_WEAPON
:

340 
ITEM_ARMOR
:

341 
ITEM_POTION
:

342 
ITEM_PILL
:

343 
ITEM_MONEY
:

345 
ITEM_ANVIL
:

346 
ITEM_FURNITURE
:

347 
ITEM_TRASH
:

348 
ITEM_CONTAINER
:

349 
ITEM_DRINK_CON
:

350 
ITEM_KEY
:

351 
ITEM_FOOD
:

352 
ITEM_BOAT
:

353 
ITEM_CORPSE_NPC
:

354 
ITEM_CORPSE_PC
:

355 
ITEM_FOUNTAIN
:

356 
ITEM_MAP
:

357 
ITEM_PBTUBE
:

358 
ITEM_PBGUN
:

359 
ITEM_MATERIAL
:

360 
ITEM_CLOTHING
:

361 
ITEM_PORTAL
:

362 
ITEM_TREASURE
:

363 
ITEM_WARP_STONE
:

364 
ITEM_GEM
:

365 
ITEM_JEWELRY
:

366 
ITEM_WEDDINGRING
:

367 
ITEM_TOKEN
:

368 
ITEM_WARP_CRYSTAL
:

372 cÚ¡ 
afãù
::
Afãù
 *
·f
 = 
pObjIndex
->
afãùed
;…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
)

373 
afãù
::
	`cİy_to_obj
(
obj
, 
·f
);

375 
obj
->
Ãxt
 = 
Game
::
	`wÜld
().
objeù_li¡
;

376 
Game
::
	`wÜld
().
objeù_li¡
 = 
obj
;

377 
pObjIndex
->
couÁ
++;

378  
obj
;

379 
	}
}

382 
	$şÚe_objeù
(
Objeù
 *
·»Á
, Objeù *
şÚe
)

384 
i
;

385 
ExŒaDesü
 *
ed
, *
ed_Ãw
;

387 ià(
·»Á
 =ğ
nuÎ±r
 || 
şÚe
 ==‚ullptr)

391 
şÚe
->
Çme
 = 
·»Á
->name;

392 
şÚe
->
shÜt_desü
 = 
·»Á
->short_descr;

393 
şÚe
->
desütiÚ
 = 
·»Á
->description;

394 
şÚe
->
™em_ty³
 = 
·»Á
->item_type;

395 
şÚe
->
exŒa_æags
 = 
·»Á
->extra_flags;

396 
şÚe
->
w—r_æags
 = 
·»Á
->wear_flags;

397 
şÚe
->
weight
 = 
·»Á
->weight;

398 
şÚe
->
co¡
 = 
·»Á
->cost;

399 
şÚe
->
Ëv–
 = 
·»Á
->level;

400 
şÚe
->
cÚd™iÚ
 = 
·»Á
->condition;

401 
şÚe
->
m©”Ÿl
 = 
·»Á
->material;

402 
şÚe
->
tim”
 = 
·»Á
->timer;

404 
i
 = 0; i < 5; i ++)

405 
şÚe
->
v®ue
[
i
] = 
·»Á
->value[i];

408 
afãù
::
	`»move_®l_äom_obj
(
şÚe
, 
Œue
);

410 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
·»Á
);…af;…aàğ·f->
Ãxt
)

411 
afãù
::
	`cİy_to_obj
(
şÚe
, 
·f
);

414 
ed
 = 
·»Á
->
exŒa_desü
;ƒd !ğ
nuÎ±r
;ƒd =ƒd->
Ãxt
) {

415 
ed_Ãw
 = 
Ãw
 
	`ExŒaDesü
(*
ed
);

416 
ed_Ãw
->
Ãxt
 = 
şÚe
->
exŒa_desü
;

417 
şÚe
->
exŒa_desü
 = 
ed_Ãw
;

419 
	}
}

423 
	$do_¬—s
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

426 
boŞ
 
show®l
 = 
Œue
;

427 
boŞ
 
sÜtv
 = 
çl£
;

428 
Ëv–
 = 0;

429 
vnum
 = 0;

430 
SŒšg
 
keywÜds
;

431 
boŞ
 
¡¬
 = 
çl£
;

433 
size_t
 
±rs_size
;

434 
couÁ
 = 0;

435 
A»a
 *
­
;

436 
¿nge
[12];

437 
SŒšg
 
dbuf
;

439 
j
, 
k
;

441 
SŒšg
 
¬g
;

442 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

444 ià(!
¬g
.
	`em±y
()) {

445 
show®l
 = 
çl£
;

447 ià(
¬g
.
	`is_numb”
()) {

448 
Ëv–
 = 
	`©oi
(
¬g
);

450 ià(
	`IS_IMMORTAL
(
ch
è&& 
Ëv–
 > 150) {

451 
vnum
 = 
Ëv–
;

452 
Ëv–
 = 0;

454 ià(
Ëv–
 < 0 ||†evel > 100) {

455 
	`¡c
("Lev– mu¡ bb‘w“À1‡nd 100!\n", 
ch
);

459 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

462 !
¬g
.
	`em±y
()) {

463 ià(
	`IS_IMMORTAL
(
ch
è&& !
	`¡rcmp
("*", 
¬g
))

464 
¡¬
 = 
Œue
;

465 ià(
	`IS_IMMORTAL
(
ch
è&& !
	`¡rcmp
("#", 
¬g
))

466 
sÜtv
 = 
Œue
;

468 ià(!
keywÜds
.
	`em±y
())

469 
keywÜds
 += " ";

471 
keywÜds
 +ğ
¬g
;

474 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

479 
±rs_size
 = (
Game
::
	`wÜld
().
¬—s
.
	`size
(è+ 1è* (
­
);

480 
A»a
 *
±rs
[
±rs_size
];

483 auto& 
¬—_·œ
 : 
Game
::
	`wÜld
().
¬—s
) {

484 
A»a
 *
­
 = 
¬—_·œ
.
£cÚd
;

486 ià(!
	`IS_IMMORTAL
(
ch
è&& 
­
->
¬—_ty³
 =ğ
AREA_TYPE_XXX
)

489 ià(
¡¬
) {

490 ià(
­
->
	`num_¶ay”s
() == 0)

494 ià(
vnum
) {

495 ià(
­
->
mš_vnum
 > 
vnum
 || vnum >‡p->
max_vnum
)

499 ià(
Ëv–
)

500 ià(
Ëv–
 < 
­
->
low_¿nge
 ||†ev– >‡p->
high_¿nge
)

503 ià(!
keywÜds
.
	`em±y
()) {

504 ià(!
­
->
keywÜds
.
	`has_wÜds
(keywords))

508 ià(
Ëv–
)

509 ià(
­
->
¬—_ty³
 =ğ
AREA_TYPE_CLAN
 ||

510 
­
->
¬—_ty³
 =ğ
AREA_TYPE_ARENA
)

513 
±rs
[
couÁ
++] = 
­
;

518 
j
 = 0; j < 
couÁ
 - 1; j++)

519 
k
 = 
j
 + 1; k < 
couÁ
; k++)

520 ià((!
sÜtv
 && 
	`¡rcmp
(
±rs
[
j
]->
t™Ë
,…Œs[
k
]->title) > 0)

521 || (
sÜtv
 && 
±rs
[
j
]->
mš_vnum
 >…Œs[
k
]->min_vnum)) {

522 
­
 = 
±rs
[
j
];

523 
±rs
[
j
] =…Œs[
k
];

524 
±rs
[
k
] = 
­
;

529 
j
 = 0; j < 
couÁ
; j++) {

530 
­
 = 
±rs
[
j
];

532 
­
->
¬—_ty³
) {

533 
AREA_TYPE_ALL
:

534 
	`¡rıy
(
¿nge
, "{W ALL {x");

537 
AREA_TYPE_IMMS
:

538 
	`¡rıy
(
¿nge
, "{g IMM {x");

541 
AREA_TYPE_CLAN
:

542 
	`¡rıy
(
¿nge
, "{g CLANS {x");

545 
AREA_TYPE_HERO
:

546 
	`¡rıy
(
¿nge
, "{g HRO {x");

549 
AREA_TYPE_ARENA
:

550 
	`¡rıy
(
¿nge
, "{g ARENA {x");

553 
AREA_TYPE_XXX
:

554 
	`¡rıy
(
¿nge
, "{g XXX {x");

558 
FÜm©
::
	`¥rštf
(
¿nge
, "{x%3d-%3d{x", 
­
->
low_¿nge
,‡p->
high_¿nge
);

560 ià(
­
->
high_¿nge
 <= 15)

561 
¿nge
[1] = 'C';

562 ià(
­
->
high_¿nge
 <= 50)

563 
¿nge
[1] = 'G';

564 ià(
­
->
low_¿nge
 >= 80)

565 
¿nge
[1] = 'M';

566 ià(
­
->
low_¿nge
 >= 50)

567 
¿nge
[1] = 'R';

568 ià(
­
->
low_¿nge
 >= 30)

569 
¿nge
[1] = 'Y';

571 
¿nge
[1] = 'W';

576 ià(
	`IS_IMMORTAL
(
ch
)) {

577 
SŒšg
 
f’ame
 = 
­
->
fe_Çme
.
	`l¥l™
(".");

579 ià(
couÁ
 == 0) {

580 
dbuf
 +ğ
FÜm©
::
	`fÜm©
("%-8.8s [%5d-%5d]%3s ",

581 
f’ame
, 
­
->
mš_vnum
,‡p->
max_vnum
, " ");

584 
dbuf
 +ğ
FÜm©
::
	`fÜm©
("%-8.8s [%5d-%5d]{Y%3d{x ",

585 
f’ame
, 
­
->
mš_vnum
,‡p->
max_vnum
, 
couÁ
);

589 
dbuf
 +ğ
FÜm©
::
	`fÜm©
(

590 "<%s> %-s{a{x%*s%-s{a{x\n", 
¿nge
,

591 
­
->
t™Ë
, 25 -‡p->t™Ë.
	`uncŞÜ
().
	`size
(), " ",

592 
­
->
authÜ
);

595 ià(
show®l
) {

596 
dbuf
 +ğ
FÜm©
::
	`fÜm©
(

598 
couÁ
);

600 ià(
couÁ
 <= 0) {

601 
dbuf
 += "No‡reas found matching your search criteria.\n";

604 
	`·ge_to_ch¬
(
dbuf
, 
ch
);

605 
	}
}

	@src/argument.cc

1 
	~"deş¬e.hh
"

2 
	~"¬gum’t.hh
"

3 
	~"FÏgs.hh
"

4 
	~"SŒšg.hh
"

12 
	$numb”_¬gum’t
(cÚ¡ *
¬gum’t
, *
¬g
)

15 ià(*
¬gum’t
 >= '0' && *argument <= '9') {

17 cÚ¡ *
pdÙ
 = 
	`¡r¡r
(
¬gum’t
, ".");

19 ià(
pdÙ
 !ğ
nuÎ±r
) {

20 
tmp_buf
[
	`¡¾’
(
¬gum’t
)+1];

21 
	`¡rıy
(
tmp_buf
, 
¬gum’t
);

22 *
tdÙ
 = &
tmp_buf
[
pdÙ
 - 
¬gum’t
];

23 *
tdÙ
 = '\0';

26 ià(
	`SŒšg
(
tmp_buf
).
	`is_numb”
()) {

28 
	`¡rıy
(
¬g
, 
tdÙ
 + 1);

29  
	`©oi
(
tmp_buf
);

34 
	`¡rıy
(
¬g
, 
¬gum’t
);

36 
	}
}

54 
	gFÏgs
::
B™
 
	$’t™y_¬gum’t
(cÚ¡ *
¬gum’t
, *
¬g
)

56 
tmp_buf
[
	`¡¾’
(
¬gum’t
)+1];

57 *
­
;

58 
numb”
;

59 
FÏgs
::
B™
 
‘y³
 = FÏgs::
nÚe
;

61 
numb”
 = 
	`numb”_¬gum’t
(
¬gum’t
, 
tmp_buf
);

62 
­
 = 
tmp_buf
;

64 ià(
­
[0] != '\0' &&‡p[1] == '.') {

65 
	`tŞow”
(
­
[0])) {

67 
‘y³
 = 
ENTITY_P
; 
­
 += 2;

71 
‘y³
 = 
ENTITY_M
; 
­
 += 2;

75 
‘y³
 = 
ENTITY_O
; 
­
 += 2;

79 
‘y³
 = 
ENTITY_R
; 
­
 += 2;

83 ià(
­
[0] != '\0' &&‡p[1] == '#') {

84 
	`tŞow”
(
­
[0])) {

86 
‘y³
 = 
ENTITY_VM
; 
­
 += 2;

90 
‘y³
 = 
ENTITY_VO
; 
­
 += 2;

94 
‘y³
 = 
ENTITY_VR
; 
­
 += 2;

100 ià(
numb”
 == 1)

101 
	`¡rıy
(
¬g
, 
­
);

103 
	`¥rštf
(
¬g
, "%d.%s", 
numb”
, 
­
);

105  
‘y³
;

106 
	}
}

111 
	$muÉ_¬gum’t
(cÚ¡ *
¬gum’t
, *
¬g
)

113 
numb”
;

114 
buf
[
	`¡¾’
(
¬gum’t
)+1];

116 
	`¡rıy
(
buf
, 
¬gum’t
);

117 *
p¡¬
 = 
	`¡rchr
(
buf
, '*');

119 ià(
p¡¬
 =ğ
nuÎ±r
) {

121 
	`¡rıy
(
¬g
, 
¬gum’t
);

125 *
p¡¬
 = '\0';

126 
numb”
 = 
	`©oi
(
¬gum’t
);

127 *
p¡¬
 = '*';

128 
	`¡rıy
(
¬g
, 
p¡¬
 + 1);

129  
numb”
;

130 
	}
}

136 cÚ¡ *
	$Úe_¬gum’t
(cÚ¡ *
¬gum’t
, *
¬g_fœ¡
)

138 
cEnd
;

140 
	`is¥aû
(*
¬gum’t
))

141 
¬gum’t
++;

143 
cEnd
 = ' ';

145 ià(*
¬gum’t
 == '\'' || *argument == '"')

146 
cEnd
 = *
¬gum’t
++;

148 *
¬gum’t
 != '\0') {

149 ià(*
¬gum’t
 =ğ
cEnd
) {

150 
¬gum’t
++;

154 *
¬g_fœ¡
 = *
¬gum’t
 ;

155 
¬g_fœ¡
++;

156 
¬gum’t
++;

159 *
¬g_fœ¡
 = '\0';

161 
	`is¥aû
(*
¬gum’t
))

162 
¬gum’t
++;

164  
¬gum’t
;

165 
	}
}

167 
	$numb”_¬gum’t
(cÚ¡ 
SŒšg
& 
¬gum’t
, SŒšg& 
¬g
) {

168 
buf
[
¬gum’t
.
	`size
()+1];

169 
»t
 = 
	`numb”_¬gum’t
(
¬gum’t
.
	`c_¡r
(), 
buf
);

170 
¬g
.
	`assign
(
buf
);

171  
»t
;

172 
	}
}

174 
	gFÏgs
::
B™
 
	$’t™y_¬gum’t
(cÚ¡ 
SŒšg
& 
¬gum’t
, SŒšg& 
¬g
) {

175 
buf
[
¬gum’t
.
	`size
()+1];

176 
FÏgs
::
B™
 
»t
 = 
	`’t™y_¬gum’t
(
¬gum’t
.
	`c_¡r
(), 
buf
);

177 
¬g
.
	`assign
(
buf
);

178  
»t
;

179 
	}
}

181 
	$muÉ_¬gum’t
(cÚ¡ 
SŒšg
& 
¬gum’t
, SŒšg& 
¬g
) {

182 
buf
[
¬gum’t
.
	`size
()+1];

183 
»t
 = 
	`muÉ_¬gum’t
(
¬gum’t
.
	`c_¡r
(), 
buf
);

184 
¬g
.
	`assign
(
buf
);

185  
»t
;

186 
	}
}

188 cÚ¡ *
	$Úe_¬gum’t
(cÚ¡ 
SŒšg
& 
¬gum’t
, SŒšg& 
¬g
) {

189 
buf
[
¬gum’t
.
	`size
()+1];

190 cÚ¡ *
»t
 = 
	`Úe_¬gum’t
(
¬gum’t
.
	`c_¡r
(), 
buf
);

191 
¬g
.
	`assign
(
buf
);

192  
»t
;

193 
	}
}

	@src/attribute.cc

1 
	~"aù.hh
"

2 
	~"afãù/Afãù.hh
"

3 
	~"Ch¬aù”.hh
"

4 
	~"deş¬e.hh
"

5 
	~"FÏgs.hh
"

6 
	~"FÜm©.hh
"

7 
	~"GameTime.hh
"

8 
	~"lookup.hh
"

9 
	~"Loggšg.hh
"

10 
	~"m”c.hh
"

11 
	~"Objeù.hh
"

12 
	~"PÏy”.hh
"

13 
	~"SŒšg.hh
"

14 
	~"ty³Çme.hh
"

21 
	$¡©_to_©Œ
(
¡©
) {

22 
¡©
) {

23 
STAT_STR
:  
APPLY_STR
;

24 
STAT_DEX
:  
APPLY_DEX
;

25 
STAT_CON
:  
APPLY_CON
;

26 
STAT_WIS
:  
APPLY_WIS
;

27 
STAT_INT
:  
APPLY_INT
;

28 
STAT_CHR
:  
APPLY_CHR
;

30 
Loggšg
::
	`bugf
("¡©_to_©Œ: inv®id sˆ%d", 
¡©
);

33  
APPLY_STR
;

34 
	}
}

37 
	$g‘_max_¡©
(cÚ¡ 
Ch¬aù”
 *
ch
, 
¡©
)

39 
max
 = 25;

41 ià(
ch
->
	`is_Åc
())

42 
max
 = 
	`ATTR_BASE
(
ch
, 
	`¡©_to_©Œ
(
¡©
)) + 4;

43 ià(!
	`IS_IMMORTAL
(
ch
)) {

44 
max
 = 
pc_¿û_bË
[
ch
->
¿û
].
max_¡©s
[
¡©
] + 4;

46 ià(
ch
->
gud
 !ğ
Gud
::
nÚe


47 && 
gud_bË
[
ch
->
gud
].
¡©_´ime
 =ğ
¡©
)

48 
max
 += 2;

52 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
çmŸr
 && ch->
³t
) {

53 
max_¦Ù
 = 0;

55 
i
 = 0; i < 
MAX_STATS
; i++)

56 ià(
	`ATTR_BASE
(
ch
->
³t
, 
	`¡©_to_©Œ
(
i
)è> ATTR_BASE(ch->³t, st_to_©Œ(
max_¦Ù
)))

57 
max_¦Ù
 = 
i
;

59 ià(
max_¦Ù
 =ğ
¡©
)

60 
max
++;

63 ià(
ch
->
¿û
 =ğ
	`¿û_lookup
("human"))

64 
max
++;

66  
	`URANGE
(3, 
max
, 25);

67 
	}
}

71 
	$g‘_age
(
Ch¬aù”
 *
ch
)

73 
age
 = 17;

75 ià(!
ch
->
	`is_Åc
())

76 
age
 = 
pc_¿û_bË
[
ch
->
¿û
].
ba£_age
;

78 
age
 +ğ
	`g‘_¶ay_£cÚds
(
ch
è/ (
MUD_YEAR
 * 
MUD_MONTH
 * 
MUD_DAY
 * 
MUD_HOUR
);

79 
age
 +ğ
	`GET_ATTR_MOD
(
ch
, 
APPLY_AGE
);

80  
age
;

81 
	}
}

88 
	$g‘_un¥–Ëd_h™rŞl
(
Ch¬aù”
 *
ch
)

90 
sum
 = 
	`GET_ATTR_HITROLL
(
ch
è- 
	`GET_ATTR_MOD
(ch, 
APPLY_HITROLL
);

92 
Objeù
 *
obj
 = 
ch
->
ÿ¼yšg
; obj; obj = obj->
Ãxt_cÚ‹Á
)

93 ià(
obj
->
w—r_loc
 !ğ
WEAR_NONE
)

94 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…af;…aàğ·f->
Ãxt
)

95 ià(
·f
->
loÿtiÚ
 =ğ
APPLY_HITROLL
)

96 
sum
 +ğ
·f
->
modif›r
;

98  
sum
;

99 
	}
}

101 
	$g‘_un¥–Ëd_damrŞl
(
Ch¬aù”
 *
ch
)

103 
sum
 = 
	`GET_ATTR_DAMROLL
(
ch
è- 
	`GET_ATTR_MOD
(ch, 
APPLY_DAMROLL
);

105 
Objeù
 *
obj
 = 
ch
->
ÿ¼yšg
; obj; obj = obj->
Ãxt_cÚ‹Á
)

106 ià(
obj
->
w—r_loc
 !ğ
WEAR_NONE
)

107 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…af;…aàğ·f->
Ãxt
)

108 ià(
·f
->
loÿtiÚ
 =ğ
APPLY_DAMROLL
)

109 
sum
 +ğ
·f
->
modif›r
;

111  
sum
;

112 
	}
}

115 
	$g‘_un¥–Ëd_ac
(
Ch¬aù”
 *
ch
, 
ty³
)

117 
Objeù
 *
obj
;

118 
ac
 = 100, 
loc
;

120 
loc
 = 0;†oø< 
MAX_WEAR
;†oc++)

121 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
loc
)è!ğ
nuÎ±r
)

122 
ac
 -ğ
	`­¶y_ac
(
obj
, 
loc
, 
ty³
);

124  
ac
;

125 
	}
}

127 
	$©Œibu‹_check
(
Ch¬aù”
 *
ch
) {

129 
Objeù
 *
w—pÚ
;

131 ià(
ch
 !ğ
nuÎ±r


132 && 
ch
->
š_room
 !ğ
nuÎ±r


133 && (
w—pÚ
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
)è!ğ
nuÎ±r


134 && 
	`g‘_obj_weight
(
w—pÚ
è> (
¡r_­p
[
	`GET_ATTR_STR
(
ch
)].
w›ld
 * 10)) {

137 
boŞ
 
found
 = 
çl£
;

138 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_ch¬
(
ch
);…af;…aàğ·f->
Ãxt
)

139 ià(
·f
->
wh”e
 =ğ
TO_AFFECTS
 &&…af->
loÿtiÚ
 =ğ
APPLY_STR
 &&…af->
modif›r
 < 0) {

140 
found
 = 
Œue
;

144 ià(
found
) {

145 
	`aù
("You drİ $p.", 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_CHAR
);

146 
	`aù
("$Àdrİ $p.", 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_ROOM
);

147 
	`obj_äom_ch¬
(
w—pÚ
);

148 
	`obj_to_room
(
w—pÚ
, 
ch
->
š_room
);

151 
	}
}

153 
SŒšg
 
	$´št_deãn£_modif›rs
(
Ch¬aù”
 *
ch
, 
wh”e
) {

154 
SŒšg
 
buf
;

156 ià(
ch
->
deãn£_mod
 =ğ
nuÎ±r
)

157  
buf
;

159 
i
 = 1; i < 32; i++) {

160 
boŞ
 
´št
 = 
çl£
;

162 
wh”e
) {

163 
TO_ABSORB
: ià(
ch
->
deãn£_mod
[
i
] > 100è
´št
 = 
Œue
; ;

164 
TO_IMMUNE
: ià(
ch
->
deãn£_mod
[
i
] =ğ100è
´št
 = 
Œue
; ;

165 
TO_RESIST
: ià(
ch
->
deãn£_mod
[
i
] > 0 && ch->defense_mod[i] < 100)

166 
´št
 = 
Œue
; ;

167 
TO_VULN
: ià(
ch
->
deãn£_mod
[
i
] < 0è
´št
 = 
Œue
; ;

169 
Loggšg
::
	`bugf
("´št_deãn£_modif›rs: unknowÀwh”%d", 
wh”e
);

172 ià(
´št
) {

173 ià(!
buf
.
	`em±y
())

174 
buf
 += " ";

176 
buf
 +ğ
	`dam_ty³_Çme
(
i
);

178 ià(
wh”e
 !ğ
TO_IMMUNE
) {

179 
mbuf
[100];

180 
FÜm©
::
	`¥rštf
(
mbuf
, "(%+d%%)",

181 
wh”e
 =ğ
TO_ABSORB
 ? 
ch
->
deãn£_mod
[
i
]-100 :

182 
wh”e
 =ğ
TO_RESIST
 ? -
ch
->
deãn£_mod
[
i
] :

183 -
ch
->
deãn£_mod
[
i
]

185 
buf
 +ğ
mbuf
;

190  
buf
;

191 
	}
}

	@src/bank.cc

8 
	~"aù.hh
"

9 
	~"¬gum’t.hh
"

10 
	~"Ch¬aù”.hh
"

11 
	~"CÏn.hh
"

12 
	~"deş¬e.hh
"

13 
	~"FÏgs.hh
"

14 
	~"FÜm©.hh
"

15 
	~"Game.hh
"

16 
	~"lookup.hh
"

17 
	~"memÜy.hh
"

18 
	~"m”c.hh
"

19 
	~"PÏy”.hh
"

20 
	~"Room.hh
"

21 
	~"SŒšg.hh
"

23 
	$do_d•os™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

25 
buf
[
MAX_INPUT_LENGTH
];

26 
max_gŞd
;

27 
max_sv”
;

29 
SŒšg
 
¬g1
, 
¬g2
;

30 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

31 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

33 ià(
ch
->
	`is_Åc
()) {

34 
	`¡c
("Mobe ÿn'ˆd•os™ mÚey!\n", 
ch
);

38 ià(!
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_BANK
)) {

39 
	`¡c
("FuÂy,hi dÛ¢'ˆlook†ik¨bªk...\n", 
ch
);

43 ià(
¬g1
.
	`em±y
(è|| !¬g1.
	`is_numb”
(è|| 
	`©oi
(arg1) <= 0 ||

44 (
	`¡rÿ£cmp
(
¬g2
, "gold") != 0 && strcasecmp(arg2, "silver") != 0)) {

45 
	`¡c
("Syntax:\n"

46 " d•os™ <amouÁ> <gŞd o¸sv”>\n", 
ch
);

50 
	`fšd_mÚey
(
ch
);

52 ià(
	`¡rÿ£cmp
(
¬g2
, "gold") == 0) {

53 ià(
ch
->
gŞd
 < 
	`©oi
(
¬g1
)) {

54 
	`¡c
("You dÚ'ˆHAVEh© much gŞd..\n", 
ch
);

58 
max_gŞd
 = ((
ch
->
pcd©a
->
»mÜt_couÁ
 * 10000) + 50000);

60 ià((
ch
->
gŞd_š_bªk
 + 
	`©oi
(
¬g1
)è> 
max_gŞd
) {

61 
	`±c
(
ch
, "You cª'ˆpuˆmÜthª %ld gŞd iÀthbªk.\n", 
max_gŞd
);

65 
ch
->
gŞd
 -ğ
	`©oi
(
¬g1
);

66 
ch
->
gŞd_š_bªk
 +ğ
	`©oi
(
¬g1
);

67 
FÜm©
::
	`¥rštf
(
buf
, "Your balance is %ld gold‡nd %ld silver.\n",

68 
ch
->
gŞd_š_bªk
, ch->
sv”_š_bªk
);

69 
	`¡c
(
buf
, 
ch
);

72 ià(
	`¡rÿ£cmp
(
¬g2
, "silver") == 0) {

73 ià(
ch
->
sv”
 < 
	`©oi
(
¬g1
)) {

74 
	`¡c
("You dÚ'ˆHAVEh© much sv”.\n", 
ch
);

78 
max_sv”
 = ((
ch
->
pcd©a
->
»mÜt_couÁ
 * 1000000) + 1000000);

80 ià((
ch
->
sv”_š_bªk
 + 
	`©oi
(
¬g1
)è> 
max_sv”
) {

81 
	`±c
(
ch
, "You cª'ˆpuˆmÜthª %ld sv” iÀthbªk.\n", 
max_sv”
);

85 
ch
->
sv”
 -ğ
	`©oi
(
¬g1
);

86 
ch
->
sv”_š_bªk
 +ğ
	`©oi
(
¬g1
);

87 
FÜm©
::
	`¥rštf
(
buf
, "Your balance is %ld gold‡nd %ld silver.\n",

88 
ch
->
gŞd_š_bªk
, ch->
sv”_š_bªk
);

89 
	`¡c
(
buf
, 
ch
);

93 
	}
}

95 
	$do_şªd•os™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

97 
buf
[
MAX_INPUT_LENGTH
];

98 
CÏn
 *
rg‘
;

100 ià(
ch
->
	`is_Åc
()) {

101 
	`¡c
("Mobe ÿn'ˆd•os™ mÚey!\n", 
ch
);

105 ià(
¬gum’t
.
	`em±y
()) {

106 
	`¡c
("{PH–°şªd•os™{x fÜ h–°Ú howØu£his.\n", 
ch
);

110 
SŒšg
 
¬g1
, 
¬g2
;

111 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

112 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

115 ià(!
	`IS_IMMORTAL
(
ch
)) {

116 ià(!
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_BANK
)) {

117 
	`¡c
("FuÂy,hi dÛ¢'ˆlook†ik¨bªk...\n", 
ch
);

121 ià(
ch
->
	`is_Åc
()) {

122 
	`¡c
("You dÚ'ˆÃedØwÜry‡bouˆşªs.\n", 
ch
);

126 ià(
ch
->
şª
 =ğ
nuÎ±r
) {

127 
	`¡c
("You‡»‚Ù iÀ¨şª.\n", 
ch
);

131 ià(
ch
->
şª
->
šd•’d’t
) {

132 
	`¡c
("You¸şª dÛ nÙ hav¨bªk‡ccouÁ.\n", 
ch
);

136 ià(!
¬g1
.
	`is_numb”
(è|| 
	`©oi
(arg1) <= 0) {

137 
	`¡c
("Syntax:\n"

138 " cÏnd•os™ <amouÁ>.\n", 
ch
);

142 ià(
ch
->
gŞd
 < 
	`©oi
(
¬g1
)) {

143 
	`¡c
("You dÚ'ˆHAVEh© much gŞd...\n", 
ch
);

147 ià((
ch
->
şª
->
gŞd_b®ªû
 + 
	`©oi
(
¬g1
)) > 200000) {

148 
	`¡c
("Thşªbªk†im™ i 200000 gŞd.\n", 
ch
);

152 
ch
->
gŞd
 -ğ
	`©oi
(
¬g1
);

153 
ch
->
pcd©a
->
gŞd_dÚ©ed
 +ğ
	`©oi
(
¬g1
);

154 
ch
->
şª
->
gŞd_b®ªû
 +ğ
	`©oi
(
¬g1
);

155 
	`§ve_şª_bË
();

156 
	`§ve_ch¬_obj
(
ch
);

157 
FÜm©
::
	`¥rštf
(
buf
, "{W[ %s just deposited %d gold coin%s inhe clan's bank‡ccount! ]{x\n",

158 
ch
->
Çme
, 
	`©oi
(
¬g1
), (atoi(arg1) > 1) ? "s" : "");

159 
	`£nd_to_şª
(
ch
, ch->
şª
, 
buf
);

160 
	`±c
(
ch
, "You¸şª' b®ªû i now %ld gŞd.\n", ch->
şª
->
gŞd_b®ªû
);

166 ià(!
ch
->
	`has_cgroup
(
GROUP_BUILD
è&& !
	`IS_IMP
(ch)) {

167 
	`¡c
("You'»‚Ù highƒnough†ev–ØgivgŞdØşªs.\n", 
ch
);

171 ià(
¬g1
.
	`em±y
()) {

172 
	`¡c
("Syntax:\n"

173 " cÏnd•os™ <şªÇme> <amouÁ>.\n", 
ch
);

177 
rg‘
 = 
	`şª_lookup
(
¬g1
);

179 ià(
rg‘
 =ğ
nuÎ±r
) {

180 
	`¡c
("Th”i nØsuch cÏn.\n", 
ch
);

184 ià(
rg‘
->
šd•’d’t
) {

185 
	`¡c
("Th© cÏÀdÛ nÙ hav¨bªk‡ccouÁ.\n", 
ch
);

189 ià(
	`©oi
(
¬g2
) <= 0) {

190 
	`¡c
("ThamouÁ mu¡ bg»©”hª 0.\n", 
ch
);

194 ià((
rg‘
->
gŞd_b®ªû
 + 
	`©oi
(
¬g2
)) > 200000) {

195 
	`¡c
("Thşªbªk†im™ i 200000 gŞd.\n", 
ch
);

199 
rg‘
->
gŞd_b®ªû
 +ğ
	`©oi
(
¬g2
);

200 
FÜm©
::
	`¥rštf
(
buf
, "{W[ %s just deposited %d gold coin%s inhe clan's bank‡ccount! ]{x\n",

201 
ch
->
Çme
, 
	`©oi
(
¬g2
), (atoi(arg2) > 1) ? "s" : "");

202 
	`£nd_to_şª
(
ch
, 
rg‘
, 
buf
);

203 
	`±c
(
ch
, "Th© cÏn' b®ªû i now %ld gŞd.\n", 
rg‘
->
gŞd_b®ªû
);

204 
	`§ve_şª_bË
();

206 
	}
}

208 
	$fšd_mÚey
(
Ch¬aù”
 *
ch
)

210 
j
;

211 
max_gŞd
, 
max_sv”
;

213 ià(
ch
->
	`is_Åc
())

216 ià((
ch
->
Ï¡_bªk
 - 
Game
::
cu¼’t_time
) > 86400) {

217 
j
 = (
ch
->
Ï¡_bªk
 - 
Game
::
cu¼’t_time
) / 86400; j != 0 ; j--) {

218 
ch
->
gŞd_š_bªk
 += ch->gold_in_bank * .02;

219 
ch
->
sv”_š_bªk
 += ch->silver_in_bank * .02;

222 
ch
->
Ï¡_bªk
 = 
	`time
(
nuÎ±r
);

225 
max_gŞd
 = ((
ch
->
pcd©a
->
»mÜt_couÁ
 * 1000) + 50000);

226 
max_sv”
 = ((
ch
->
pcd©a
->
»mÜt_couÁ
 * 100000) + 1000000);

228 ià((
ch
->
gŞd_š_bªk
 > 
max_gŞd
) || ch->gold_in_bank < 0)

229 
ch
->
gŞd_š_bªk
 = 
max_gŞd
;

231 ià((
ch
->
sv”_š_bªk
 > 
max_sv”
è|| ch->
gŞd_š_bªk
 < 0)

232 
ch
->
sv”_š_bªk
 = 
max_sv”
;

233 
	}
}

235 
	$do_b®ªû
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

237 
buf
[
MAX_INPUT_LENGTH
];

239 ià(
ch
->
	`is_Åc
()) {

240 
	`¡c
("Mobe dØnÙ havbªk‡ccouÁs.\n", 
ch
);

244 ià(!
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_BANK
)) {

245 
	`¡c
("Th”i nØbªk h”e.\n", 
ch
);

249 
	`fšd_mÚey
(
ch
);

250 
FÜm©
::
	`¥rštf
(
buf
, "You have %ld gold‡nd %ld silver…ieces inhe bank.\n",

251 
ch
->
gŞd_š_bªk
, ch->
sv”_š_bªk
);

252 
	`¡c
(
buf
, 
ch
);

253 
	}
}

255 
	$do_w™hd¿w
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

257 
buf
[
MAX_INPUT_LENGTH
];

259 ià(
ch
->
	`is_Åc
()) {

260 
	`¡c
("NPC' ÿn'ˆg‘ mÚey.. dumbass!!!!\n", 
ch
);

264 
SŒšg
 
¬g1
, 
¬g2
;

265 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

266 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

268 ià(!
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_BANK
)) {

269 
	`¡c
("FuÂy,hi dÛ¢'ˆlook†ik¨bªk...\n", 
ch
);

273 
	`fšd_mÚey
(
ch
);

275 ià(
¬g1
.
	`em±y
(è|| !¬g1.
	`is_numb”
(è|| 
	`©oi
(arg1) <= 0 ||

276 (
	`¡rÿ£cmp
(
¬g2
, "gold") != 0 && strcasecmp(arg2, "silver") != 0)) {

277 
	`¡c
("Syntax:\n"

278 " w™hd¿w <amouÁ> <gŞd o¸sv”>\n", 
ch
);

282 ià(
	`¡rÿ£cmp
(
¬g2
, "gold") == 0) {

283 ià(
ch
->
gŞd_š_bªk
 < 
	`©oi
(
¬g1
)) {

284 
	`¡c
("You dÚ'ˆhavth© much gŞd iÀthbªk!\n", 
ch
);

288 ià(
	`g‘_ÿ¼y_weight
(
ch
è+ 
	`gŞd_weight
(
	`©oi
(
¬g1
)è> 
	`ÿn_ÿ¼y_w
(ch)) {

289 
	`aù
("You can't carryhat much weight.",

290 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

294 
ch
->
gŞd_š_bªk
 -ğ
	`©oi
(
¬g1
);

295 
ch
->
gŞd
 +ğ
	`©oi
(
¬g1
);

296 
	`fšd_mÚey
(
ch
);

297 
FÜm©
::
	`¥rštf
(
buf
, "You‚ow have %ld gold‡nd %ld silver inhe bank.\n",

298 
ch
->
gŞd_š_bªk
, ch->
sv”_š_bªk
);

299 
	`¡c
(
buf
, 
ch
);

302 ià(
	`¡rÿ£cmp
(
¬g2
, "silver") == 0) {

303 ià(
ch
->
sv”_š_bªk
 < 
	`©oi
(
¬g1
)) {

304 
	`¡c
("You dÚ'ˆhavth© much sv” iÀthbªk!\n", 
ch
);

308 ià(
	`g‘_ÿ¼y_weight
(
ch
è+ 
	`sv”_weight
(
	`©oi
(
¬g1
)è> 
	`ÿn_ÿ¼y_w
(ch)) {

309 
	`aù
("You can't carryhat much weight.",

310 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

314 
ch
->
sv”_š_bªk
 -ğ
	`©oi
(
¬g1
);

315 
ch
->
sv”
 +ğ
	`©oi
(
¬g1
);

316 
	`fšd_mÚey
(
ch
);

317 
FÜm©
::
	`¥rštf
(
buf
, "You‚ow have %ld gold‡nd %ld silver inhe bank.\n",

318 
ch
->
gŞd_š_bªk
, ch->
sv”_š_bªk
);

319 
	`¡c
(
buf
, 
ch
);

323 
	}
}

325 
	$do_şªw™hd¿w
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

327 
buf
[
MAX_INPUT_LENGTH
];

328 
CÏn
 *
rg‘
;

330 ià(
ch
->
	`is_Åc
()) {

331 
	`¡c
("Mobe dÚ'ˆÃed mÚey.\n", 
ch
);

335 
SŒšg
 
¬g1
;

336 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

339 ià(!
	`IS_IMMORTAL
(
ch
)) {

340 ià(!
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_BANK
)) {

341 
	`¡c
("FuÂy,hi dÛ¢'ˆlook†ik¨bªk...\n", 
ch
);

345 ià(
ch
->
şª
 =ğ
nuÎ±r
) {

346 
	`¡c
("You‡»‚Ù iÀ¨şª.\n", 
ch
);

350 ià(
ch
->
şª
->
šd•’d’t
) {

351 
	`¡c
("You¸şª dÛ nÙ hav¨bªk‡ccouÁ.\n", 
ch
);

355 ià(!
ch
->
	`has_cgroup
(
GROUP_LEADER
)) {

356 
	`¡c
("OÆy†—d” may w™hd¿w gŞd fromhşª bªk‡ccouÁ.\n", 
ch
);

360 ià(
¬g1
.
	`em±y
(è|| !¬g1.
	`is_numb”
(è|| 
	`©oi
(arg1) <= 0) {

361 
	`¡c
("Syntax:\n"

362 " cÏnw™hd¿w <amouÁ>.\n", 
ch
);

366 ià(
¬gum’t
.
	`em±y
()) {

367 
	`¡c
("You mu¡…rovid¨»asÚ.\n", 
ch
);

371 ià(
ch
->
şª
->
gŞd_b®ªû
 < 
	`©oi
(
¬g1
)) {

372 
	`¡c
("You¸şª dÛ nÙ havth© much gŞd iÀthbªk.\n", 
ch
);

376 ià(
	`g‘_ÿ¼y_weight
(
ch
è+ 
	`gŞd_weight
(
	`©oi
(
¬g1
)è> 
	`ÿn_ÿ¼y_w
(ch)) {

377 
	`¡c
("You cª'ˆÿ¼yh© much weight.\n", 
ch
);

381 
ch
->
şª
->
gŞd_b®ªû
 -ğ
	`©oi
(
¬g1
);

382 
ch
->
gŞd
 +ğ
	`©oi
(
¬g1
);

383 
FÜm©
::
	`¥rštf
(
buf
, "{W[ %s has withdrawn %d gold coin%s for %s. ]{x\n",

384 
ch
->
Çme
, 
	`©oi
(
¬g1
), (©oi×rg1è> 1è? "s" : "", 
¬gum’t
);

385 
	`£nd_to_şª
(
ch
, ch->
şª
, 
buf
);

386 
FÜm©
::
	`¥rštf
(
buf
, "{WYou¸şª' b®ªû i now %ld gŞd.{x\n", 
ch
->
şª
->
gŞd_b®ªû
);

387 
	`£nd_to_şª
(
ch
, ch->
şª
, 
buf
);

388 
	`§ve_şª_bË
();

389 
	`§ve_ch¬_obj
(
ch
);

394 ià(!
ch
->
	`has_cgroup
(
GROUP_BUILD
è&& !
	`IS_IMP
(ch)) {

395 
	`¡c
("You'»‚Ù highƒnough†ev–Øw™hd¿w gŞd from cÏns.\n", 
ch
);

399 ià(
¬g1
.
	`em±y
()) {

400 
	`¡c
("Syntax:\n"

401 " cÏnw™hd¿w <şªÇme> <amouÁ> <»asÚ>\n", 
ch
);

405 
rg‘
 = 
	`şª_lookup
(
¬g1
);

407 ià(
rg‘
 =ğ
nuÎ±r
) {

408 
	`¡c
("Th”i nØsuch cÏn.\n", 
ch
);

412 ià(
rg‘
->
šd•’d’t
) {

413 
	`¡c
("Th© cÏÀdÛ nÙ hav¨bªk‡ccouÁ.\n", 
ch
);

417 
SŒšg
 
¬g2
;

418 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

420 ià(
	`©oi
(
¬g2
) <= 0) {

421 
	`¡c
("ThamouÁ mu¡ bg»©”hª 0.\n", 
ch
);

425 ià(
rg‘
->
gŞd_b®ªû
 < 
	`©oi
(
¬g2
)) {

426 
	`¡c
("Th© cÏÀdÛ nÙ havth© much gŞd iÀthbªk.\n", 
ch
);

430 ià(
¬gum’t
.
	`em±y
()) {

431 
	`¡c
("You mu¡…rovid¨»asÚ.\n", 
ch
);

435 
rg‘
->
gŞd_b®ªû
 -ğ
	`©oi
(
¬g2
);

436 
FÜm©
::
	`¥rštf
(
buf
, "{W[ %s has deducted %d gold coin%s for %s. ]\n",

437 
ch
->
Çme
, 
	`©oi
(
¬g2
), (©oi×rg2è> 1è? "s" : "", 
¬gum’t
);

438 
	`£nd_to_şª
(
ch
, 
rg‘
, 
buf
);

439 
FÜm©
::
	`¥rštf
(
buf
, "{WYou¸şª' b®ªû i now %ld gŞd.{x\n", 
rg‘
->
gŞd_b®ªû
);

440 
	`£nd_to_şª
(
ch
, 
rg‘
, 
buf
);

441 
	`±c
(
ch
, "Theœ cÏn' b®ªû i now %ld gŞd.\n", 
rg‘
->
gŞd_b®ªû
);

442 
	`§ve_şª_bË
();

444 
	}
}

	@src/channels.cc

28 
	~<®gÜ™hm
>

29 
	~<™”©Ü
>

30 
	~<veùÜ
>

32 
	~"aù.hh
"

33 
	~"¬gum’t.hh
"

34 
	~"A»a.hh
"

35 
	~"Ch¬aù”.hh
"

36 
	~"CÏn.hh
"

37 
	~"deş¬e.hh
"

38 
	~"DesütÜ.hh
"

39 
	~"fšd.hh
"

40 
	~"FÏgs.hh
"

41 
	~"FÜm©.hh
"

42 
	~"Game.hh
"

43 
	~"lookup.hh
"

44 
	~"memÜy.hh
"

45 
	~"m”c.hh
"

46 
	~"MobProg.hh
"

47 
	~"Objeù.hh
"

48 
	~"PÏy”.hh
"

49 
	~"¿ndom.hh
"

50 
	~"Room.hh
"

51 
	~"SocŸl.hh
"

52 
	~"SŒšg.hh
"

53 
	~"bËs.hh
"

54 
	~"WÜld.hh
"

56 
boŞ
 
check_chªÃl_socŸl
 
¬gs
((
Ch¬aù”
 *
ch
, 
chªÃl
,

57 
cu¡om
, cÚ¡ 
SŒšg
& 
commªd
, cÚ¡ SŒšg& 
¬gum’t
));

59 
£nd_to_qu”y
 
¬gs
((
Ch¬aù”
 *
ch
, cÚ¡ *
¡ršg
));

60 
boŞ
 
sw—rcheck
 
¬gs
((cÚ¡ 
SŒšg
& 
¬gum’t
));

61 
boŞ
 
is_ignÜšg
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
);

62 cÚ¡ *
makedrunk
 
¬gs
((
Ch¬aù”
 *
ch
, cÚ¡ *
¡ršg
));

66 
	$do_chªÃls
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

69 
	`¡c
(" chªÃÈ stus\n", 
ch
);

70 
	`¡c
("----------------------\n", 
ch
);

71 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_GOSSIP
);

72 
	`¡c
("goss ", 
ch
);

74 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_GOSSIP
)è
	`¡c
("REVOKED\n", ch);

75 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOGOSSIP
)è
	`¡c
("ON\n", ch);

76 
	`¡c
("OFF\n", 
ch
);

78 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_FLAME
);

79 
	`¡c
("æam ", 
ch
);

81 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_FLAME
)è
	`¡c
("REVOKED\n", ch);

82 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOFLAME
)è
	`¡c
("ON\n", ch);

83 
	`¡c
("OFF\n", 
ch
);

85 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_QWEST
);

86 
	`¡c
("qwe¡ ", 
ch
);

88 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_QWEST
)è
	`¡c
("REVOKED\n", ch);

89 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOQWEST
)è
	`¡c
("ON\n", ch);

90 
	`¡c
("OFF\n", 
ch
);

92 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_PRAY
);

93 
	`¡c
("´ay ", 
ch
);

95 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_PRAY
)è
	`¡c
("REVOKED\n", ch);

96 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOPRAY
)è
	`¡c
("ON\n", ch);

97 
	`¡c
("OFF\n", 
ch
);

99 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_AUCTION
);

100 
	`¡c
("auùiÚ ", 
ch
);

102 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_AUCTION
)è
	`¡c
("REVOKED\n", ch);

103 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOAUCTION
)è
	`¡c
("ON\n", ch);

104 
	`¡c
("OFF\n", 
ch
);

106 ià(
	`is_şª
(
ch
è&& (!ch->
şª
->
šd•’d’t
 || 
	`IS_IMMORTAL
(ch))) {

107 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_CLAN
);

108 
	`¡c
("CÏÁ®k ", 
ch
);

110 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_CLAN
)è
	`¡c
("REVOKED\n", ch);

111 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOCLAN
)è
	`¡c
("ON\n", ch);

112 
	`¡c
("OFF\n", 
ch
);

115 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_ANNOUNCE
);

116 
	`¡c
("ªnounû ", 
ch
);

118 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOANNOUNCE
)è
	`¡c
("ON\n", ch);

119 
	`¡c
("OFF\n", 
ch
);

121 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_MUSIC
);

122 
	`¡c
("musiø ", 
ch
);

124 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_MUSIC
)è
	`¡c
("REVOKED\n", ch);

125 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOMUSIC
)è
	`¡c
("ON\n", ch);

126 
	`¡c
("OFF\n", 
ch
);

128 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_QA
);

129 
	`¡c
("Q/A ", 
ch
);

131 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_QA
)è
	`¡c
("REVOKED\n", ch);

132 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOQUESTION
)è
	`¡c
("ON\n", ch);

133 
	`¡c
("OFF\n", 
ch
);

135 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_SOCIAL
);

136 
	`¡c
("SocŸÈ ", 
ch
);

138 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_SOCIAL
)è
	`¡c
("REVOKED\n", ch);

139 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOSOCIAL
)è
	`¡c
("ON\n", ch);

140 
	`¡c
("OFF\n", 
ch
);

142 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_IC
);

143 
	`¡c
("IC ", 
ch
);

145 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_IC
)è
	`¡c
("REVOKED\n", ch);

146 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOIC
)è
	`¡c
("ON\n", ch);

147 
	`¡c
("OFF\n", 
ch
);

149 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_GRATS
);

150 
	`¡c
("g¿t  ", 
ch
);

152 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_GRATS
)è
	`¡c
("REVOKED\n", ch);

153 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOGRATS
)è
	`¡c
("ON\n", ch);

154 
	`¡c
("OFF\n", 
ch
);

156 ià(
	`IS_IMMORTAL
(
ch
)) {

157 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_IMM
);

158 
	`¡c
("Imm Ch© ", 
ch
);

160 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOWIZ
)è
	`¡c
("ON\n", ch);

161 
	`¡c
("OFF\n", 
ch
);

164 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_PAGE
);

165 
	`¡c
("·g ", 
ch
);

167 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_PAGE
)è
	`¡c
("REVOKED\n", ch);

168 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOPAGE
)è
	`¡c
("ON\n", ch);

169 
	`¡c
("OFF\n", 
ch
);

171 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

172 
	`¡c
("‹Î ", 
ch
);

174 ià(!
ch
->
comm_æags
.
	`has
(
COMM_DEAF
)è
	`¡c
("ON\n", ch);

175 
	`¡c
("OFF\n", 
ch
);

177 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

178 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_QTELL
);

179 
	`¡c
("q‹Î ", 
ch
);

181 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_QTELL
)è
	`¡c
("REVOKED\n\n", ch);

182 ià(!
ch
->
comm_æags
.
	`has
(
COMM_NOQUERY
)è
	`¡c
("ON\n", ch);

183 
	`¡c
("OFF\n", 
ch
);

185 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

186 
	`¡c
("qu›ˆmod ", 
ch
);

188 ià(
ch
->
comm_æags
.
	`has
(
COMM_QUIET
)è
	`¡c
("ON\n", ch);

189 
	`¡c
("OFF\n", 
ch
);

194 ià(!
ch
->
	`is_Åc
()) {

195 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_NONOTIFY
)è
	`¡c
("You will‚ot be‚otified of‚ew‚otes.\n", ch);

196 
	`¡c
("You {Wwl{x bnÙif›d oàÃw‚Ùes.\n", 
ch
);

198 ià(!
ch
->
pcd©a
->
au¿
.
	`em±y
())

199 
	`±c
(
ch
, "{VAu¿: (%s{V){x\n", ch->
pcd©a
->
au¿
);

202 ià(
ch
->
comm_æags
.
	`has
(
COMM_AFK
)è
	`¡c
("You‡re AFK.\n", ch);

204 ià(!
ch
->
	`is_Åc
()èià(ch->
pcd©a
->
¶r_æags
.
	`has
(
PLR_SNOOP_PROOF
)è
	`¡c
("You‡re immuneo Nosy…eople.\n", ch);

206 ià(
ch
->
lšes
 !ğ
PAGELEN
) {

207 ià(
ch
->
lšes
)

208 
	`±c
(
ch
, "You di¥Ïy %d†še oàsüŞl.\n", ch->
lšes
);

210 
	`¡c
("SüŞÈbufãršg i off.\n", 
ch
);

213 
	`±c
(
ch
, "You¸cu¼’ˆ´om± is: %s\n", !ch->
´om±
.
	`em±y
() ? ch->prompt : "(none)");

215 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_TELL
))

216 
	`¡c
("NØÚwªt tØli¡’Øyou.\n", 
ch
);

218 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_EMOTE
))

219 
	`¡c
("You'»‚Ù f“lšg v”yƒmÙiÚ®„ighˆnow.\n", 
ch
);

221 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_NOCHANNELS
))

222 
	`¡c
("You¸mouth s“m tØb¡uck shut.\n", 
ch
);

224 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_FLAMEONLY
))

225 
	`¡c
("You oÆy f“Èlikæamšg.\n", 
ch
);

226 
	}
}

228 
SŒšg
 
	$makedrunk
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¡ršg
)

231 
	s¡ruckdrunk
 {

232 
mš_drunk_Ëv–
;

233 
numb”_of_»p
;

234 *
»¶aûm’t
[11];

235 } 
drunk
[] = {

264 ià(
ch
->
	`is_Åc
())

265  
¡ršg
;

268 
drunkËv–
 = 
ch
->
pcd©a
->
cÚd™iÚ
[
COND_DRUNK
];

270 ià(
drunkËv–
 <= 10)

271  
¡ršg
;

273 
SŒšg
 
buf
;

276 
c
: 
¡ršg
) {

277 
‹mp
 = 
	`touµ”
(
c
);

279 ià((
‹mp
 >= 'A') && (temp <= 'Z')) {

280 ià(
drunkËv–
 > 
drunk
[
‹mp
 - 'A'].
mš_drunk_Ëv–
) {

281 
¿ndomnum
 = 
	`numb”_¿nge
(0, 
drunk
[
‹mp
 - 'A'].
numb”_of_»p
);

282 
buf
 +ğ
drunk
[
‹mp
 - 'A'].
»¶aûm’t
[
¿ndomnum
];

285 
buf
 +ğ
c
;

287 ià((
‹mp
 >= '0') && (temp <= '9')) {

288 
buf
 +ğ'0' + 
	`numb”_¿nge
(0, 9);

291 
buf
 +ğ
c
;

294  (
buf
);

295 
	}
}

298 
	$glob®_aù
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
mes§ge
,

299 
de¥™e_švis
, 
cŞÜ
, cÚ¡ 
FÏgs
& 
nocomm_b™s
)

301 
DesütÜ
 *
d
;

302 
Ch¬aù”
 *
viùim
;

304 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

305 
viùim
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

307 ià(
d
->
	`is_¶ayšg
() &&

308 
d
->
ch¬aù”
 !ğ
ch
 &&

309 !
viùim
->
comm_æags
.
	`has_ªy_of
(
nocomm_b™s
) &&

310 (
ch
 =ğ
nuÎ±r
 || 
de¥™e_švis
 || 
	`ÿn_£e_who
(
viùim
, ch))) {

311 
	`£t_cŞÜ
(
viùim
, 
cŞÜ
, 
BOLD
);

312 
	`aù
(
mes§ge
, 
ch
, 
nuÎ±r
, 
d
->
ch¬aù”
, 
TO_VICT
, 
POS_SLEEPING
, 
çl£
);

313 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

316 
	}
}

318 
boŞ
 
	$sw—rcheck
(cÚ¡ 
SŒšg
& 
¬gum’t
)

321 
	ssw—r_ty³
 {

322 *
wÜd
;

323 
Ëv–
;

329 cÚ¡ 
¡d
::
veùÜ
<
sw—r_ty³
> 
sw—r_bË
 = {

346 
SŒšg
 
tobechecked
 = 
¬gum’t
.
	`uncŞÜ
();

348 cÚ¡‡uto& 
’Œy
 : 
sw—r_bË
) {

349 
’Œy
.
Ëv–
) {

351 ià(
tobechecked
.
	`has_exaù_wÜds
(
’Œy
.
wÜd
))

352  
Œue
;

355 ià(
tobechecked
.
	`has_wÜds
(
’Œy
.
wÜd
))

356  
Œue
;

360  
çl£
;

361 
	}
}

363 
boŞ
 
	$check_chªÃl_socŸl
(
Ch¬aù”
 *
ch
, 
FÏgs
::
B™
 
chªÃl
, 
cu¡om
, cÚ¡ 
SŒšg
& 
commªd
, cÚ¡ SŒšg& 
¬gum’t
)

365 
Ch¬aù”
 *
viùim
;

366 
DesütÜ
 *
d
;

367 
SocŸl
 *
™”©Ü
;

368 
boŞ
 
found
;

369 
found
 = 
çl£
;

371 
™”©Ü
 = 
socŸl_bË_h—d
->
Ãxt
; i‹¿tÜ !ğ
socŸl_bË_
; iterator = iterator->next) {

372 ià(
commªd
.
	`is_´efix_of
(
™”©Ü
->
Çme
)) {

373 
found
 = 
Œue
;

378 ià(!
found
)

379  
çl£
;

381 ià(!
ch
->
	`is_Åc
(è&& ch->
comm_æags
.
	`has
(
COMM_NOCHANNELS
)) {

382 
	`¡c
("You‡»‡Ái-socŸl!\n", 
ch
);

383  
Œue
;

386 
SŒšg
 
¬g
;

387 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

389 
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
);

390 
	`Ãw_cŞÜ
(
ch
, 
cu¡om
);

392 ià(
¬g
.
	`em±y
()) {

393 ià(!
™”©Ü
->
ch¬_no_¬g
.
	`em±y
())

394 
	`¡c
("[S] ", 
ch
);

396 
	`aù
(
™”©Ü
->
ch¬_no_¬g
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
, 
POS_SLEEPING
, 
çl£
);

398 ià(
viùim
 =ğ
nuÎ±r
) {

399 
	`¡c
("[S] They‡»‚Ù h”e.\n", 
ch
);

400  
Œue
;

402 ià(
viùim
 =ğ
ch
) {

403 ià(!
™”©Ü
->
ch¬_auto
.
	`em±y
())

404 
	`¡c
("[S] ", 
ch
);

406 
	`aù
(
™”©Ü
->
ch¬_auto
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
, 
POS_SLEEPING
, 
çl£
);

409 ià(!
™”©Ü
->
ch¬_found
.
	`em±y
())

410 
	`¡c
("[S] ", 
ch
);

412 
	`aù
(
™”©Ü
->
ch¬_found
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
, 
POS_SLEEPING
, 
çl£
);

415 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

417 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

418 
Ch¬aù”
 *
vic
;

419 
vic
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

421 ià(
d
->
	`is_¶ayšg
() &&

422 
d
->
ch¬aù”
 !ğ
ch
 &&

423 !
	`is_ignÜšg
(
vic
, 
ch
) &&

424 !
vic
->
comm_æags
.
	`has
(
chªÃl
) &&

425 !
vic
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

426 
	`Ãw_cŞÜ
(
vic
, 
cu¡om
);

428 ià(
¬g
.
	`em±y
()) {

429 ià(!
™”©Ü
->
Ùh”s_no_¬g
.
	`em±y
())

430 
	`¡c
("[S] ", 
vic
);

432 
	`aù
(
™”©Ü
->
Ùh”s_no_¬g
, 
ch
, 
nuÎ±r
, 
vic
, 
TO_VICT
, 
POS_SLEEPING
, 
çl£
);

434 ià(
viùim
 =ğ
ch
) {

435 ià(!
™”©Ü
->
Ùh”s_auto
.
	`em±y
())

436 
	`¡c
("[S] ", 
vic
);

438 
	`aù
(
™”©Ü
->
Ùh”s_auto
, 
ch
, 
vic
, 
viùim
, 
TO_WORLD
, 
POS_SLEEPING
, 
çl£
);

440 ià(
vic
 =ğ
viùim
) {

441 ià(!
™”©Ü
->
viù_found
.
	`em±y
())

442 
	`¡c
("[S] ", 
vic
);

444 
	`aù
(
™”©Ü
->
viù_found
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
, 
POS_SLEEPING
, 
çl£
);

447 ià(!
™”©Ü
->
Ùh”s_found
.
	`em±y
())

448 
	`¡c
("[S] ", 
vic
);

450 
	`aù
(
™”©Ü
->
Ùh”s_found
, 
ch
, 
vic
, 
viùim
, 
TO_WORLD
, 
POS_SLEEPING
, 
çl£
);

453 
	`£t_cŞÜ
(
vic
, 
WHITE
, 
NOBOLD
);

457  
Œue
;

458 
	}
}

461 
	$chªÃl_who
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
chªÃÊame
, cÚ¡ 
FÏgs
::
B™
& 
chªÃl
, 
cu¡om
)

463 
DesütÜ
 *
d
;

465 ià(
ch
->
	`is_Åc
())

468 
	`Ãw_cŞÜ
(
ch
, 
cu¡om
);

469 
	`±c
(
ch
, "PÏy” w™h % ON\n", 
chªÃÊame
);

471 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

472 
Ch¬aù”
 *
viùim
;

473 
viùim
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

475 ià((
chªÃl
 =ğ
COMM_NOWIZ
 && !
	`IS_IMMORTAL
(
d
->
ch¬aù”
)) ||

476 (
chªÃl
 =ğ
COMM_NOCLAN
 && !
	`is_§me_şª
(
ch
, 
viùim
)))

479 ià(
d
->
	`is_¶ayšg
() &&

480 
	`ÿn_£e_who
(
ch
, 
viùim
) &&

481 !
viùim
->
comm_æags
.
	`has
(
chªÃl
) &&

482 !
viùim
->
comm_æags
.
	`has
(
COMM_NOCHANNELS
) &&

483 !
viùim
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

484 ià(
chªÃl
 =ğ
COMM_NOFLAME
 && 
viùim
->
ûnsÜ_æags
.
	`has
(
CENSOR_CHAN
))

487 
	`±c
(
ch
, "%s\n", 
viùim
->
Çme
);

492 
	}
}

496 
	$£nd_to_qu”y
(
Ch¬aù”
 *
ch
, cÚ¡ *
¡ršg
)

500 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

501 ià(
viùim
->
	`is_Åc
()

502 || 
viùim
->
comm_æags
.
	`has
(
COMM_NOQUERY
)

503 || 
	`is_ignÜšg
(
viùim
, 
ch
))

506 ià(
¡d
::
	`fšd
(
ch
->
pcd©a
->
qu”y
.
	`cbegš
(), ch->pcd©a->qu”y.
	`ûnd
(), 
viùim
->
Çme
) != ch->pcdata->query.cend()) {

507 
	`Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_QTELL
);

508 
	`¡c
(
¡ršg
, 
viùim
);

509 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

512 
	}
}

514 
	$£nd_to_şª
(
Ch¬aù”
 *
ch
, 
CÏn
 *
rg‘
, cÚ¡ 
SŒšg
& 
‹xt
)

516 
DesütÜ
 *
d
;

518 ià(
rg‘
 =ğ
nuÎ±r
) {

519 
	`¡c
("NØsuch cÏn!\n", 
ch
);

523 ià(
‹xt
.
	`em±y
()) {

524 
	`¡c
("T–Èthem wh© ?\n", 
ch
);

528 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

529 ià(
d
->
	`is_¶ayšg
() &&

530 
d
->
ch¬aù”
->
şª
 =ğ
rg‘
)

531 
	`¡c
(
‹xt
, 
d
->
ch¬aù”
);

533 
	}
}

535 
	$wizÃt
(cÚ¡ 
SŒšg
& 
¡ršg
, 
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, cÚ¡ 
FÏgs
& 
æag
, cÚ¡ FÏgs& 
æag_sk
, 
mš_¿nk
)

537 
DesütÜ
 *
d
;

539 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

540 ià(
d
->
	`is_¶ayšg
()

541 && 
	`IS_IMMORTAL
(
d
->
ch¬aù”
)

542 && 
d
->
ch¬aù”
->
wizÃt_æags
.
	`has
(
WIZ_ON
)

543 && (
d
->
ch¬aù”
->
wizÃt_æags
.
	`has_ªy_of
(
æag
))

544 && (!
d
->
ch¬aù”
->
wizÃt_æags
.
	`has_ªy_of
(
æag_sk
))

545 && 
	`GET_RANK
(
d
->
ch¬aù”
è>ğ
mš_¿nk


546 && 
d
->
ch¬aù”
 !ğ
ch
) {

547 ià(
d
->
ch¬aù”
->
wizÃt_æags
.
	`has
(
WIZ_PREFIX
))

548 
	`¡c
("{G<W{HizNe{Gt>{x ", 
d
->
ch¬aù”
);

550 
	`aù
(
¡ršg
, 
d
->
ch¬aù”
, 
obj
, 
ch
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

553 
	}
}

555 
	$chªÃl
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
chªÃl
)

557 
DesütÜ
 *
d
;

558 
c¦Ù
 = 
chª_bË
[
chªÃl
].cslot;

560 ià(
chªÃl
 =ğ
CHAN_CLAN
) {

561 ià(!
	`is_şª
(
ch
è|| (ch->
şª
->
šd•’d’t
 && !
	`IS_IMMORTAL
(ch))) {

562 
	`¡c
("You‡»n'ˆš‡ cÏn.\n", 
ch
);

567 ià(
¬gum’t
.
	`em±y
()) {

568 
	`Ãw_cŞÜ
(
ch
, 
c¦Ù
);

570 ià(
ch
->
comm_æags
.
	`has
(
chª_bË
[
chªÃl
].
b™
)) {

571 
	`±c
(
ch
, "Th% chªÃÈi now ON.\n", 
chª_bË
[
chªÃl
].
Çme
);

572 
ch
->
comm_æags
 -ğ
chª_bË
[
chªÃl
].
b™
;

575 
	`±c
(
ch
, "Th% chªÃÈi now OFF.\n", 
chª_bË
[
chªÃl
].
Çme
);

576 
ch
->
comm_æags
 +ğ
chª_bË
[
chªÃl
].
b™
;

579 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

583 ià(
ch
->
comm_æags
.
	`has
(
COMM_QUIET
è&& 
chªÃl
 !ğ
CHAN_IMMTALK
) {

584 
	`Ãw_cŞÜ
(
ch
, 
c¦Ù
);

585 
	`¡c
("You mu¡uº ofàQUIET modfœ¡.\n", 
ch
);

586 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

590 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_NOCHANNELS
)) {

591 
	`¡c
("Thgod hav»voked you¸chªÃÈ´iviges.\n", 
ch
);

595 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_FLAMEONLY
è&& 
chªÃl
 !ğ
CHAN_FLAME
) {

596 
	`¡c
("Thgod hav»¡riùed youØthæamchªÃl.\n", 
ch
);

600 ià(
ch
->
»voke_æags
.
	`has
(
chª_bË
[
chªÃl
].
»voke_b™
)) {

601 
	`±c
(
ch
, "Thgod hav»voked you¸ab™yØu£ %s.\n", 
chª_bË
[
chªÃl
].
Çme
);

605 ià(
	`g‘_pos™iÚ
(
ch
è< 
POS_SLEEPING
) {

606 
	`¡c
("You‡» hu¹oØbad fÜh©.\n", 
ch
);

610 
SŒšg
 
¬g
;

611 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

613 ià(
¬g
 =ğ"who" && 
¬gum’t
.
	`Ëngth
() == 3) {

614 
	`chªÃl_who
(
ch
, 
chª_bË
[
chªÃl
].
Çme
, chª_bË[chªÃl].
b™
, 
c¦Ù
);

618 
ch
->
comm_æags
 -ğ
chª_bË
[
chªÃl
].
b™
;

619 
	`Ãw_cŞÜ
(
ch
, 
c¦Ù
);

621 ià(
chªÃl
 =ğ
CHAN_IMMTALK
) {

622 
´efix
[
MSL
];

624 ià(
ch
->
pcd©a
 && !ch->pcd©a->
imm´efix
.
	`em±y
())

625 
FÜm©
::
	`¥rštf
(
´efix
, "%s", 
ch
->
pcd©a
->
imm´efix
);

627 
FÜm©
::
	`¥rštf
(
´efix
, "%s:", 
ch
->
	`is_Åc
(è? ch->
shÜt_desü
 : ch->
Çme
);

629 
	`±c
(
ch
, "[%s",

630 
ch
->
£cu»_Ëv–
 =ğ
RANK_IMP
 ? "{YIMP" :

631 
ch
->
£cu»_Ëv–
 =ğ
RANK_HEAD
 ? "{BHEAD" :

633 
	`Ãw_cŞÜ
(
ch
, 
c¦Ù
);

634 
	`±c
(
ch
, "] %s", 
´efix
);

635 
	`Ãw_cŞÜ
(
ch
, 
c¦Ù
);

636 
	`±c
(
ch
, " %s{x\n", 
¬gum’t
);

639 
	`±c
(
ch
, "% {x'%s{x'\n", 
chª_bË
[
chªÃl
].
´efix_£lf
, 
¬gum’t
);

641 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

643 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

644 
Ch¬aù”
 *
viùim
;

645 
viùim
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

647 ià(
d
->
	`is_¶ayšg
(è&& d->
ch¬aù”
 !ğ
ch
) {

648 ià(
chªÃl
 =ğ
CHAN_IMMTALK
) {

649 ià(!
	`IS_IMMORTAL
(
viùim
)

650 || 
	`GET_RANK
(
viùim
è< 
ch
->
£cu»_Ëv–


651 || 
viùim
->
comm_æags
.
	`has
(
chª_bË
[
chªÃl
].
b™
))

654 
´efix
[
MSL
];

655 ià(
	`ÿn_£e_who
(
viùim
, 
ch
)) {

656 ià(
ch
->
pcd©a
 && !ch->pcd©a->
imm´efix
.
	`em±y
())

657 
FÜm©
::
	`¥rštf
(
´efix
, "%s", 
ch
->
pcd©a
->
imm´efix
);

659 
FÜm©
::
	`¥rštf
(
´efix
, "%s:", 
ch
->
	`is_Åc
(è? ch->
shÜt_desü
 : ch->
Çme
);

662 
FÜm©
::
	`¥rštf
(
´efix
, "Someone:");

664 
	`Ãw_cŞÜ
(
viùim
, 
c¦Ù
);

665 
	`±c
(
viùim
, "[%s",

666 
ch
->
£cu»_Ëv–
 =ğ
RANK_IMP
 ? "{YIMP" :

667 
ch
->
£cu»_Ëv–
 =ğ
RANK_HEAD
 ? "{BHEAD" :

669 
	`Ãw_cŞÜ
(
viùim
, 
c¦Ù
);

670 
	`±c
(
viùim
, "] %s", 
´efix
);

671 
	`Ãw_cŞÜ
(
viùim
, 
c¦Ù
);

672 
	`±c
(
viùim
, " %s{x\n", 
¬gum’t
);

673 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

677 ià(
	`is_ignÜšg
(
viùim
, 
ch
)

678 || 
viùim
->
comm_æags
.
	`has
(
chª_bË
[
chªÃl
].
b™
)

679 || 
viùim
->
comm_æags
.
	`has
(
COMM_QUIET
))

682 ià(
chªÃl
 =ğ
CHAN_PRAY
 && !
	`IS_IMMORTAL
(
viùim
))

685 ià(
chªÃl
 =ğ
CHAN_FLAME
 && 
viùim
->
ûnsÜ_æags
.
	`has
(
CENSOR_CHAN
))

688 ià(
chªÃl
 !ğ
CHAN_FLAME
 && 
	`sw—rcheck
(
¬gum’t
)) {

689 ià(
viùim
->
ûnsÜ_æags
.
	`has
(
CENSOR_CHAN
)

690 && 
chªÃl
 !ğ
CHAN_PRAY
)

693 ià(
	`IS_IMMORTAL
(
viùim
))

694 
	`¡c
("{P[C] {x", 
viùim
);

697 ià(
chªÃl
 =ğ
CHAN_CLAN
) {

698 ià(!
	`is_§me_şª
(
ch
, 
viùim
è&& !
	`IS_IMMORTAL
(victim))

701 ià(
	`IS_IMMORTAL
(
viùim
))

702 
	`±c
(
viùim
, "% ", 
ch
->
şª
->
who_Çme
);

705 
	`Ãw_cŞÜ
(
viùim
, 
c¦Ù
);

708 ià(
chªÃl
 =ğ
CHAN_PRAY
 && 
ch
->
desc
 && ch->desc->
Üigš®
)

709 
	`±c
(
viùim
, "%s (%s) imploreshe gods: \"%s{x\"\n",

710 
ch
->
desc
->
Üigš®
->
Çme
, ch->Çme, 
¬gum’t
);

712  
	`aù
(
chª_bË
[
chªÃl
].
Ùh”_¡r
,

713 
ch
, 
¬gum’t
, 
viùim
, 
TO_VICT_CHANNEL
, 
POS_SLEEPING
, 
çl£
);

715 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

719 
	}
}

721 
	$do_goss
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

723 
	`chªÃl
(
ch
, 
¬gum’t
, 
CHAN_GOSSIP
);

724 
	}
}

726 
	$do_æame
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

728 
	`chªÃl
(
ch
, 
¬gum’t
, 
CHAN_FLAME
);

729 
	}
}

731 
	$do_qwe¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

733 
	`chªÃl
(
ch
, 
¬gum’t
, 
CHAN_QWEST
);

734 
	}
}

736 
	$do_´ay
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

738 
	`chªÃl
(
ch
, 
¬gum’t
, 
CHAN_PRAY
);

739 
	}
}

741 
	$do_şªlk
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

743 
	`chªÃl
(
ch
, 
¬gum’t
, 
CHAN_CLAN
);

744 
	}
}

746 
	$do_music
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

748 
	`chªÃl
(
ch
, 
¬gum’t
, 
CHAN_MUSIC
);

749 
	}
}

751 
	$do_ic
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

753 ià(
ch
->
	`is_Åc
()) {

754 
	`¡c
("Ju¡ byour£lf,‚ØÃedØ´‘’d :)\n", 
ch
);

758 ià(!
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_OOC
)) {

759 
	`¡c
("You‡»‚Ù iÀch¬aù” (h–°ooc).\n", 
ch
);

763 
	`chªÃl
(
ch
, 
¬gum’t
, 
CHAN_IC
);

764 
	}
}

766 
	$do_g¿ts
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

768 
	`chªÃl
(
ch
, 
¬gum’t
, 
CHAN_GRATS
);

769 
	}
}

771 
	$do_immlk
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

773 
	`chªÃl
(
ch
, 
¬gum’t
, 
CHAN_IMMTALK
);

774 
	}
}

776 
	$do_que¡iÚ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

778 
	`chªÃl
(
ch
, 
¬gum’t
, 
CHAN_QA
);

779 
	}
}

781 
	$lk_auùiÚ
(cÚ¡ 
SŒšg
& 
¬gum’t
)

783 
Ch¬aù”
 *
viùim
;

784 
DesütÜ
 *
d
;

786 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

787 
viùim
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

789 ià(
d
->
	`is_¶ayšg
()

790 && 
viùim
->
ûnsÜ_æags
.
	`has
(
CENSOR_CHAN
))

791 ià(
	`sw—rcheck
(
¬gum’t
))

794 ià(
d
->
	`is_¶ayšg
()

795 && !
viùim
->
comm_æags
.
	`has
(
COMM_NOAUCTION
)

796 && !
viùim
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

797 
	`Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_AUCTION
);

798 
	`±c
(
viùim
, "AUCTION: %s", 
¬gum’t
);

799 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

802 
	}
}

804 
	$do_ªnounû
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

806 ià(
ch
->
comm_æags
.
	`has
(
COMM_NOANNOUNCE
)) {

807 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_ANNOUNCE
);

808 
	`¡c
("AÂounûm’t wÈnow bshown.\n", 
ch
);

809 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

810 
ch
->
comm_æags
 -ğ
COMM_NOANNOUNCE
;

813 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_ANNOUNCE
);

814 
	`¡c
("AÂounû chªÃÈi now OFF.\n", 
ch
);

815 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

816 
ch
->
comm_æags
 +ğ
COMM_NOANNOUNCE
;

818 
	}
}

820 
	$do_£nd_ªnounû
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

822 
Ch¬aù”
 *
viùim
;

823 
DesütÜ
 *
d
;

825 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

826 
viùim
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

828 ià(
d
->
	`is_¶ayšg
()

829 && 
d
->
ch¬aù”
 !ğ
ch


830 && !
viùim
->
comm_æags
.
	`has
(
COMM_NOANNOUNCE
)

831 && !
viùim
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

832 
	`Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_ANNOUNCE
);

833 
	`±c
(
viùim
, "[FYI] %s{x\n", 
¬gum’t
);

834 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

838 
	}
}

841 
	$do_fyi
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

843 
DesütÜ
 *
d
;

844 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_ANNOUNCE
);

845 
	`±c
(
ch
, "You FYI '%s{x'\n", 
¬gum’t
);

846 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

848 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

849 
Ch¬aù”
 *
viùim
;

850 
viùim
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

852 ià(
d
->
	`is_¶ayšg
() &&

853 
d
->
ch¬aù”
 !ğ
ch
 &&

854 
viùim
->
ûnsÜ_æags
.
	`has
(
CENSOR_CHAN
))

855 ià(
	`sw—rcheck
(
¬gum’t
))

858 ià(
d
->
	`is_¶ayšg
() &&

859 
d
->
ch¬aù”
 !ğ
ch
 &&

860 !
	`is_ignÜšg
(
viùim
, 
ch
) &&

861 !
viùim
->
comm_æags
.
	`has
(
COMM_NOANNOUNCE
) &&

862 !
viùim
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

863 
	`Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_ANNOUNCE
);

865 ià(
	`IS_IMMORTAL
(
viùim
))

866 
	`aù
("[$n{x] $t{x",

867 
ch
, 
¬gum’t
, 
d
->
ch¬aù”
, 
TO_VICT
, 
POS_SLEEPING
, 
çl£
);

869 
	`aù
("[FYI] $t{x",

870 
ch
, 
¬gum’t
, 
d
->
ch¬aù”
, 
TO_VICT
, 
POS_SLEEPING
, 
çl£
);

872 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

876 
	}
}

878 
	$do_»¶ay
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

880 ià(
ch
->
	`is_Åc
()) {

881 
	`¡c
("{YMobe ÿn'ˆwÜk‡nsw”šg machšes.{x\n", 
ch
);

885 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

886 
	`·ge_to_ch¬
(
ch
->
pcd©a
->
bufãr
, ch);

887 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

888 
ch
->
pcd©a
->
bufãr
.
	`ş—r
();

889 
	}
}

892 
	$do_glob®socŸl
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

894 
buf
[
MAX_STRING_LENGTH
];

895 
DesütÜ
 *
d
;

897 ià(
¬gum’t
.
	`em±y
()) {

898 ià(
ch
->
comm_æags
.
	`has
(
COMM_NOSOCIAL
)) {

899 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_SOCIAL
);

900 
	`¡c
("SocŸÈchªÃÈi now ON.\n", 
ch
);

901 
ch
->
comm_æags
 -ğ
COMM_NOSOCIAL
;

902 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

905 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_SOCIAL
);

906 
	`¡c
("SocŸÈchªÃÈi now OFF.\n", 
ch
);

907 
ch
->
comm_æags
 +ğ
COMM_NOSOCIAL
;

908 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

915 ià(
ch
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

916 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_SOCIAL
);

917 
	`¡c
("You mu¡uº ofàqu›ˆmodfœ¡.\n", 
ch
);

918 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

922 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_NOCHANNELS
)) {

923 
	`¡c
("Thgod hav»voked you¸chªÃÈ´iviges.\n", 
ch
);

927 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_FLAMEONLY
)) {

928 
	`¡c
("Thgod hav»¡riùed youØthæamchªÃl.\n", 
ch
);

932 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_SOCIAL
)) {

933 
	`¡c
("Thgod hav»voked you¸ab™yØu£hi chªÃl.\n", 
ch
);

937 
SŒšg
 
¬g
;

938 
SŒšg
 
¬g2
 = 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

940 ià(
¬g
.
	`is_´efix_of
("who"è&& 
¬gum’t
.
	`Ëngth
() == 3) {

941 
	`chªÃl_who
(
ch
, "SocŸl", 
COMM_NOSOCIAL
, 
CSLOT_CHAN_SOCIAL
);

945 
ch
->
comm_æags
 -ğ
COMM_NOSOCIAL
;

949 ià(
	`check_chªÃl_socŸl
(
ch
, 
COMM_NOSOCIAL
, 
CSLOT_CHAN_SOCIAL
, 
¬g
, 
¬g2
))

962 ià(
¬g
.
	`is_´efix_of
("emÙe"è&& (!
¬g2
.
	`em±y
()))

963 
FÜm©
::
	`¥rštf
(
buf
, "[E] % %s\n", 
ch
->
Çme
, 
¬g2
);

965 
FÜm©
::
	`¥rštf
(
buf
, "You socŸliz'%s{x'\n", 
¬gum’t
);

968 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_SOCIAL
);

969 
	`¡c
(
buf
, 
ch
);

970 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

979 ià(
¬g
.
	`is_´efix_of
("emÙe"è&& (!
¬g2
.
	`em±y
()))

980 
FÜm©
::
	`¥rštf
(
buf
, "[E] $À%s", 
¬g2
);

982 
FÜm©
::
	`¥rštf
(
buf
, "$ÀsocŸlize '%s{x'", 
¬gum’t
);

985 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

986 
Ch¬aù”
 *
viùim
;

987 
viùim
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

989 ià(
d
->
	`is_¶ayšg
() &&

990 
d
->
ch¬aù”
 !ğ
ch
 &&

991 
viùim
->
ûnsÜ_æags
.
	`has
(
CENSOR_CHAN
))

992 ià(
	`sw—rcheck
(
¬gum’t
))

995 ià(
d
->
	`is_¶ayšg
() &&

996 
d
->
ch¬aù”
 !ğ
ch
 &&

997 !
	`is_ignÜšg
(
viùim
, 
ch
) &&

998 !
viùim
->
comm_æags
.
	`has
(
COMM_NOSOCIAL
) &&

999 !
viùim
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

1000 
	`Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_SOCIAL
);

1001 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
, 
POS_SLEEPING
, 
çl£
);

1002 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

1006 
	}
}

1008 
	$do_işªlk
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1010 
CÏn
 *
şª
, *
oşª
;

1012 
SŒšg
 
¬g
;

1013 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1015 ià(
¬g
.
	`em±y
(è|| 
¬gum’t
.empty()) {

1016 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_CLAN
);

1017 
	`¡c
("SyÁax: işª <şª‚ame> <mes§ge>\n", 
ch
);

1018 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1022 ià((
şª
 = 
	`şª_lookup
(
¬g
)è=ğ
nuÎ±r
) {

1023 
	`¡c
("NØsuch cÏÀexi¡s,y³ cÏÆi¡ fÜ‡†i¡ oàv®id cÏns.\n", 
ch
);

1027 
oşª
 = 
ch
->
şª
;

1028 
ch
->
şª
 = clan;

1029 
	`±c
(
ch
, "% ", 
şª
->
who_Çme
);

1030 
	`do_şªlk
(
ch
, 
¬gum’t
);

1031 
ch
->
şª
 = 
oşª
;

1032 
	}
}

1035 
	$do_§y
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1037 
Ch¬aù”
 *
vch
;

1039 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

1042 ià(
¬gum’t
.
	`em±y
()) {

1043 
	`¡c
("Say wh©?\n", 
ch
);

1047 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_SAY
)) {

1048 
	`¡c
("You‡» uÇbËØlk!\n", 
ch
);

1052 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_SILENT
)) {

1053 
	`¡c
("A h—vy mi¡ dam³n ®Èsound iÀthroom.\n", 
ch
);

1057 
¬gum’t
 = 
	`makedrunk
(
ch
,‡rgument);

1059 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = vch->
Ãxt_š_room
) {

1060 ià(
vch
 !ğ
ch
 && 
	`IS_AWAKE
(vch)) {

1061 
	`Ãw_cŞÜ
(
vch
, 
CSLOT_CHAN_SAY
);

1064 ià(
¬gum’t
[ 
	`¡¾’
(argument) - 1] == '?')

1065 
	`±c
(
vch
, "% ask '%s'\n", 
	`PERS
(
ch
, vch, 
VIS_CHAR
), 
¬gum’t
);

1066 ià(
¬gum’t
[ 
	`¡¾’
(argument) - 1] == '!')

1067 
	`±c
(
vch
, "% exşaim '%s'\n", 
	`PERS
(
ch
, vch, 
VIS_CHAR
), 
¬gum’t
);

1069 
	`±c
(
vch
, "% §y '%s'\n", 
	`PERS
(
ch
, vch, 
VIS_CHAR
), 
¬gum’t
);

1071 
	`£t_cŞÜ
(
vch
, 
WHITE
, 
NOBOLD
);

1077 ià(
¬gum’t
[ 
	`¡¾’
(argument) - 1] == '?')

1078 
	`aù
("$Àask '$T'\n", 
ch
, 
nuÎ±r
, 
¬gum’t
, 
TO_VIEW
);

1079 ià(
¬gum’t
[ 
	`¡¾’
(argument) - 1] == '!')

1080 
	`aù
("$Àexşaim '$T'\n", 
ch
, 
nuÎ±r
, 
¬gum’t
, 
TO_VIEW
);

1082 
	`aù
("$À§y '$T'\n", 
ch
, 
nuÎ±r
, 
¬gum’t
, 
TO_VIEW
);

1084 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_SAY
);

1087 ià(
¬gum’t
[ 
	`¡¾’
(argument) - 1] == '?')

1088 
	`±c
(
ch
, "You‡sk '%s'\n", 
¬gum’t
);

1089 ià(
¬gum’t
[ 
	`¡¾’
(argument) - 1] == '!')

1090 
	`±c
(
ch
, "Youƒxşaim '%s'\n", 
¬gum’t
);

1092 
	`±c
(
ch
, "You say '%s'\n", 
¬gum’t
);

1094 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1095 
	`m´og_¥“ch_Œigg”
(
¬gum’t
, 
ch
);

1096 
	}
}

1098 
	$do_‹Î
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1100 
buf
[
MSL
];

1101 
Ch¬aù”
 *
viùim
;

1102 *
¡¹ime
;

1104 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_TELL
)) {

1105 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1106 
	`¡c
("ThImm hav»scšded you¸ab™yØTELL.\n", 
ch
);

1107 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1111 ià(
ch
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

1112 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1113 
	`¡c
("You mu¡uº ofàqu›ˆmodfœ¡.\n", 
ch
);

1114 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1118 ià(
ch
->
comm_æags
.
	`has
(
COMM_DEAF
)) {

1119 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1120 
	`¡c
("You mu¡uº ofàd—àmodfœ¡.\n", 
ch
);

1121 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1125 
SŒšg
 
¬g
;

1126 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1128 ià(
¬g
.
	`em±y
(è|| 
¬gum’t
.empty()) {

1129 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1130 
	`¡c
("T–Èwhom wh©?\n", 
ch
);

1131 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1136 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
)è=ğ
nuÎ±r
)

1137 ià((
viùim
 = 
	`g‘_mob_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

1138 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1139 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

1140 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1144 ià(
viùim
->
comm_æags
.
	`has_ªy_of
(
COMM_QUIET
 | 
COMM_DEAF
 | 
COMM_NOCHANNELS
è&& !
	`IS_IMMORTAL
(
ch
)) {

1145 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1146 
	`aù
("$E i nÙ„eûivšg–ls.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1147 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1151 ià(
	`is_ignÜšg
(
viùim
, 
ch
)) {

1152 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1153 
	`±c
(
ch
, "% i ignÜšg you.\n", 
viùim
->
Çme
);

1154 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1158 ià(
viùim
->
desc
 =ğ
nuÎ±r
 && !viùim->
	`is_Åc
()) {

1159 
¡¹ime
 = 
	`ùime
(&
Game
::
cu¼’t_time
);

1160 
¡¹ime
[
	`¡¾’
(strtime) - 1] = '\0';

1161 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1162 
	`aù
("$E has†ost $S†ink, but your message will gohrough when $E„eturns.",

1163 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1164 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1165 
FÜm©
::
	`¥rštf
(
buf
, "[%s] %sells you '%s{x'\n",

1166 
¡¹ime
, 
	`PERS
(
ch
, 
viùim
, 
VIS_PLR
).
	`ÿp™®ize
(), 
¬gum’t
);

1167 
viùim
->
pcd©a
->
bufãr
 +ğ
buf
;

1171 ià(
viùim
->
comm_æags
.
	`has
(
COMM_AFK
)) {

1172 ià(
viùim
->
	`is_Åc
()) {

1173 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1174 
	`aù
("$E is AFK,‡nd‚ot„eceivingells.",

1175 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1176 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1180 
¡¹ime
 = 
	`ùime
(&
Game
::
cu¼’t_time
);

1181 
¡¹ime
[
	`¡¾’
(strtime) - 1] = '\0';

1182 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1183 
	`aù
("$E is AFK, but yourell will gohrough when $E„eturns.",

1184 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1185 
	`¡c
(
viùim
->
pcd©a
->
afk
, 
ch
);

1186 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1187 
FÜm©
::
	`¥rštf
(
buf
, "[%s] %sells you '%s{x'\n",

1188 
¡¹ime
, 
	`PERS
(
ch
, 
viùim
, 
VIS_PLR
).
	`ÿp™®ize
(), 
¬gum’t
);

1189 
viùim
->
pcd©a
->
bufãr
 +ğ
buf
;

1193 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1194 
	`aù
("You–È$N '$t{x'", 
ch
, 
¬gum’t
, 
viùim
, 
TO_CHAR
, 
POS_SLEEPING
, 
çl£
);

1195 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1196 
	`Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_TELL
);

1197 
	`aù
("$À‹Î you '$t{x'", 
ch
, 
¬gum’t
, 
viùim
, 
TO_VICT
, 
POS_SLEEPING
, 
çl£
);

1198 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

1200 ià(
viùim
->
	`is_Åc
(è|| !viùim->
»¶ylock
)

1201 
viùim
->
»¶y
 = 
ch
->
Çme
;

1202 
	}
}

1204 
	$do_»¶y
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1206 
buf
[
MAX_STRING_LENGTH
];

1207 *
¡¹ime
;

1209 ià(
¬gum’t
.
	`em±y
()) {

1210 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1211 
	`¡c
("R•ly w™h wh©?\n", 
ch
);

1212 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1216 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_TELL
)) {

1217 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1218 
	`¡c
("You¸mes§gdidn'ˆg‘hrough.\n", 
ch
);

1219 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1223 ià(
ch
->
»¶y
.
	`em±y
()) {

1224 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1225 
	`¡c
("BuˆnØÚha £Á you‡–Èy‘!\n", 
ch
);

1226 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1227 
ch
->
»¶ylock
 = 
çl£
;

1231 
Ch¬aù”
 *
viùim
 = 
nuÎ±r
;

1232 autØ
vch
 : 
Game
::
	`wÜld
().
ch¬_li¡
)

1233 ià(! 
	`¡rcmp
(
ch
->
»¶y
, 
vch
->
Çme
)) {

1234 
viùim
 = 
vch
;

1238 ià(
viùim
 =ğ
nuÎ±r
) {

1239 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1240 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

1241 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1242 
ch
->
»¶ylock
 = 
çl£
;

1247 ià(
¬gum’t
 =ğ"lock" && !
ch
->
	`is_Åc
()) {

1248 
ch
->
»¶ylock
 = !ch->replylock;

1250 ià(!
ch
->
»¶ylock
)

1251 
	`±c
(
ch
, "You uÆock you¸»¶› äom %s.\n", 
	`PERS
(
viùim
, ch, 
VIS_PLR
));

1253 
	`±c
(
ch
, "You†ock you¸»¶› tØ%s.\n", 
	`PERS
(
viùim
, ch, 
VIS_PLR
));

1258 ià((
viùim
->
comm_æags
.
	`has
(
COMM_QUIET
)

1259 || 
viùim
->
comm_æags
.
	`has
(
COMM_DEAF
)

1260 || 
viùim
->
comm_æags
.
	`has
(
COMM_NOCHANNELS
))

1261 && !
	`IS_IMMORTAL
(
ch
)) {

1262 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1263 
	`aù
("$E i nÙ„eûivšg–ls.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1264 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1268 ià(
	`is_ignÜšg
(
viùim
, 
ch
)) {

1269 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1270 
	`±c
(
ch
, "% i ignÜšg you.\n", 
viùim
->
Çme
);

1271 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1275 ià(
viùim
->
desc
 =ğ
nuÎ±r
 && !viùim->
	`is_Åc
()) {

1276 
¡¹ime
 = 
	`ùime
(&
Game
::
cu¼’t_time
);

1277 
¡¹ime
[
	`¡¾’
(strtime) - 1] = '\0';

1278 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1279 
	`aù
("$N s“m tØhavmi¥Ïûd $S†šk...Œy‡gaš†©”.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1280 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1281 
FÜm©
::
	`¥rštf
(
buf
, "[%s] %sells you '%s{x'\n",

1282 
¡¹ime
, 
	`PERS
(
ch
, 
viùim
, 
VIS_PLR
).
	`ÿp™®ize
(), 
¬gum’t
);

1283 
viùim
->
pcd©a
->
bufãr
 +ğ
buf
;

1287 ià(
viùim
->
comm_æags
.
	`has
(
COMM_AFK
)) {

1288 ià(
viùim
->
	`is_Åc
()) {

1289 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1290 
	`aù
("$E is AFK,‡nd‚ot„eceivingells.",

1291 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1292 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1296 
¡¹ime
 = 
	`ùime
(&
Game
::
cu¼’t_time
);

1297 
¡¹ime
[
	`¡¾’
(strtime) - 1] = '\0';

1298 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1299 
	`aù
("$E is AFK, but yourell will gohrough when $E„eturns.",

1300 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1301 
	`aù
(
viùim
->
pcd©a
->
afk
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

1302 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1303 
FÜm©
::
	`¥rštf
(
buf
, "[%s] %sells you '%s{x'\n",

1304 
¡¹ime
, 
	`PERS
(
ch
, 
viùim
, 
VIS_PLR
).
	`ÿp™®ize
(), 
¬gum’t
);

1305 
viùim
->
pcd©a
->
bufãr
 +ğ
buf
;

1309 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_TELL
);

1310 
	`aù
("You–È$N '$t{x'", 
ch
, 
¬gum’t
, 
viùim
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

1311 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1312 
	`Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_TELL
);

1313 
	`aù
("$À‹Î you '$t{x'", 
ch
, 
¬gum’t
, 
viùim
, 
TO_VICT
, 
POS_DEAD
, 
çl£
);

1314 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

1316 ià(
viùim
->
	`is_Åc
())

1317 
viùim
->
»¶y
 = 
ch
->
Çme
;

1318 ià(!
viùim
->
»¶ylock
)

1319 
viùim
->
»¶y
 = 
ch
->
Çme
;

1320 
	}
}

1322 
	$do_y–l
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1324 
DesütÜ
 *
d
;

1326 ià(
¬gum’t
.
	`em±y
()) {

1327 
	`¡c
("You y–Èyou¸h—d ofàbuˆnØÚh—rs.\n", 
ch
);

1331 ià(!
ch
->
	`is_Åc
(è&& ch->
»voke_æags
.
	`has
(
REVOKE_NOCHANNELS
)) {

1332 
	`¡c
("Thgod hav»voked you¸chªÃÈ´iviges.\n", 
ch
);

1336 
	`aù
("You y–È'$t{x'", 
ch
, 
¬gum’t
, 
nuÎ±r
, 
TO_CHAR
);

1338 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

1339 
Ch¬aù”
 *
viùim
;

1340 
viùim
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

1342 ià(
d
->
	`is_¶ayšg
() &&

1343 
d
->
ch¬aù”
 !ğ
ch
 &&

1344 
viùim
->
ûnsÜ_æags
.
	`has
(
CENSOR_CHAN
))

1345 ià(
	`sw—rcheck
(
¬gum’t
))

1348 ià(
d
->
	`is_¶ayšg
()

1349 && 
d
->
ch¬aù”
 !ğ
ch


1350 && 
d
->
ch¬aù”
->
š_room
 !ğ
nuÎ±r


1351 && 
d
->
ch¬aù”
->
š_room
->
	`¬—
(è=ğ
ch
->in_room->area()

1352 && !
	`is_ignÜšg
(
viùim
, 
ch
)

1353 && !
d
->
ch¬aù”
->
comm_æags
.
	`has
(
COMM_QUIET
))

1354 
	`aù
("$Ày–l '$t{x'", 
ch
, 
¬gum’t
, 
d
->
ch¬aù”
, 
TO_VICT
);

1358 
	}
}

1360 
	$do_emÙe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1362 ià(!
ch
->
	`is_Åc
(è&& ch->
»voke_æags
.
	`has
(
REVOKE_EMOTE
)) {

1363 
	`¡c
("You'»‚Ù f“lšg v”yƒmÙiÚ®„ighˆnow.\n", 
ch
);

1367 ià(
¬gum’t
.
	`em±y
()) {

1368 
	`¡c
("EmÙwh©?\n", 
ch
);

1372 
	`aù
("$À$T{x", 
ch
, 
nuÎ±r
, 
¬gum’t
, 
TO_ROOM
);

1373 
	`aù
("$À$T{x", 
ch
, 
nuÎ±r
, 
¬gum’t
, 
TO_CHAR
);

1374 
	`m´og_¥“ch_Œigg”
(
¬gum’t
, 
ch
);

1376 
	}
}

1378 
	$do_pmÙe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1380 
Ch¬aù”
 *
vch
;

1381 cÚ¡ *
Ë‰”
, *
Çme
;

1382 
SŒšg
 
Ï¡
, 
‹mp
;

1383 
m©ches
 = 0;

1385 ià(!
ch
->
	`is_Åc
(è&& ch->
»voke_æags
.
	`has
(
REVOKE_EMOTE
)) {

1386 
	`¡c
("You'»‚Ù f“lšg v”yƒmÙiÚ®„ighˆnow.\n", 
ch
);

1390 ià(
¬gum’t
.
	`em±y
()) {

1391 
	`¡c
("EmÙwh©?\n", 
ch
);

1395 
	`aù
("$À$t{x", 
ch
, 
¬gum’t
, 
nuÎ±r
, 
TO_CHAR
);

1397 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = vch->
Ãxt_š_room
) {

1398 ià(
vch
->
desc
 =ğ
nuÎ±r
 || vch =ğ
ch
)

1401 ià((
Ë‰”
 = 
	`¡r¡r
(
¬gum’t
, 
vch
->
Çme
)è=ğ
nuÎ±r
) {

1402 
	`aù
("$N $t{x", 
vch
, 
¬gum’t
, 
ch
, 
TO_CHAR
);

1406 
‹mp
 = 
¬gum’t
;

1407 
‹mp
.
	`”a£
(
	`¡¾’
(
¬gum’t
è- sŒËn(
Ë‰”
));

1408 
Ï¡
.
	`ş—r
();

1409 
Çme
 = 
vch
->Çme.
	`c_¡r
();

1411 ; *
Ë‰”
 != '\0';†etter++) {

1412 ià(*
Ë‰”
 =ğ'\'' && 
m©ches
 =ğ
	`¡¾’
(
vch
->
Çme
)) {

1413 
‹mp
 += "r";

1417 ià(*
Ë‰”
 =ğ's' && 
m©ches
 =ğ
	`¡¾’
(
vch
->
Çme
)) {

1418 
m©ches
 = 0;

1422 ià(
m©ches
 =ğ
	`¡¾’
(
vch
->
Çme
))

1423 
m©ches
 = 0;

1425 ià(*
Ë‰”
 =ğ*
Çme
) {

1426 
m©ches
++;

1427 
Çme
++;

1429 ià(
m©ches
 =ğ
	`¡¾’
(
vch
->
Çme
)) {

1430 
‹mp
 += "you";

1431 
Ï¡
.
	`ş—r
();

1432 
Çme
 = 
vch
->Çme.
	`c_¡r
();

1436 
Ï¡
 +ğ
Ë‰”
[0];

1440 
m©ches
 = 0;

1441 
‹mp
 +ğ
Ï¡
;

1442 
‹mp
 +ğ
Ë‰”
[0];

1443 
Ï¡
.
	`ş—r
();

1444 
Çme
 = 
vch
->Çme.
	`c_¡r
();

1447 
	`aù
("$N $t{x", 
vch
, 
‹mp
, 
ch
, 
TO_CHAR
);

1451 
	}
}

1453 
	$do_smÙe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1455 
Ch¬aù”
 *
vch
;

1456 cÚ¡ *
Ë‰”
, *
Çme
;

1457 
SŒšg
 
Ï¡
, 
‹mp
;

1458 
m©ches
 = 0;

1460 ià(!
ch
->
	`is_Åc
(è&& ch->
comm_æags
.
	`has
(
COMM_NOCHANNELS
)) {

1461 
	`¡c
("You cªnÙ show you¸emÙiÚs.\n", 
ch
);

1465 ià(
¬gum’t
.
	`em±y
()) {

1466 
	`¡c
("S-EmÙwh©?\n", 
ch
);

1470 ià(
	`¡r¡r
(
¬gum’t
, 
ch
->
Çme
è=ğ
nuÎ±r
) {

1471 
	`¡c
("You mu¡ inşudyou¸Çmš‡Às-emÙe.\n", 
ch
);

1475 
	`¡c
(
¬gum’t
, 
ch
);

1476 
	`¡c
("\n", 
ch
);

1478 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = vch->
Ãxt_š_room
) {

1479 ià(
vch
->
desc
 =ğ
nuÎ±r
 || vch =ğ
ch
)

1482 ià((
Ë‰”
 = 
	`¡r¡r
(
¬gum’t
, 
vch
->
Çme
)è=ğ
nuÎ±r
) {

1483 
	`¡c
(
¬gum’t
, 
vch
);

1484 
	`¡c
("\n", 
vch
);

1488 
‹mp
 = 
¬gum’t
;

1489 
‹mp
.
	`”a£
(
	`¡¾’
(
¬gum’t
è- sŒËn(
Ë‰”
));

1490 
Ï¡
.
	`ş—r
();

1491 
Çme
 = 
vch
->Çme.
	`c_¡r
();

1493 ; *
Ë‰”
 != '\0';†etter++) {

1494 ià(*
Ë‰”
 =ğ'\'' && 
m©ches
 =ğ
	`¡¾’
(
vch
->
Çme
)) {

1495 
‹mp
 += "r";

1499 ià(*
Ë‰”
 =ğ's' && 
m©ches
 =ğ
	`¡¾’
(
vch
->
Çme
)) {

1500 
m©ches
 = 0;

1504 ià(
m©ches
 =ğ
	`¡¾’
(
vch
->
Çme
))

1505 
m©ches
 = 0;

1507 ià(*
Ë‰”
 =ğ*
Çme
) {

1508 
m©ches
++;

1509 
Çme
++;

1511 ià(
m©ches
 =ğ
	`¡¾’
(
vch
->
Çme
)) {

1512 
‹mp
 += "you";

1513 
Ï¡
.
	`ş—r
();

1514 
Çme
 = 
vch
->Çme.
	`c_¡r
();

1518 
Ï¡
 +ğ
Ë‰”
[0];

1522 
m©ches
 = 0;

1523 
‹mp
 +ğ
Ï¡
;

1524 
‹mp
 +ğ
Ë‰”
[0];

1525 
Ï¡
.
	`ş—r
();

1526 
Çme
 = 
vch
->Çme.
	`c_¡r
();

1529 
	`¡c
(
‹mp
, 
vch
);

1530 
	`¡c
("\n", 
vch
);

1534 
	}
}

1536 
	$do_·ge
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1538 
buf
[
MAX_STRING_LENGTH
];

1539 
Ch¬aù”
 *
viùim
;

1540 *
¡¹ime
;

1542 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_PAGE
)) {

1543 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_PAGE
);

1544 
	`¡c
("ThImm hav»scšded you¸ab™yØPAGE.\n", 
ch
);

1545 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1549 ià(
ch
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

1550 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_PAGE
);

1551 
	`¡c
("You mu¡uº ofàqu›ˆmodfœ¡.\n", 
ch
);

1552 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1556 ià(
ch
->
comm_æags
.
	`has
(
COMM_DEAF
)) {

1557 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_PAGE
);

1558 
	`¡c
("You mu¡uº ofàd—àmodfœ¡.\n", 
ch
);

1559 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1563 
SŒšg
 
¬g
;

1564 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1566 ià(
¬g
.
	`em±y
(è|| 
¬gum’t
.empty()) {

1567 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_PAGE
);

1569 ià(
ch
->
comm_æags
.
	`has
(
COMM_NOPAGE
)) {

1570 
	`¡c
("Youuº oÀyou¸·g”.\n", 
ch
);

1571 
ch
->
comm_æags
 -ğ
COMM_NOPAGE
;

1574 
	`¡c
("Youuº ofàyou¸·g”.\n", 
ch
);

1575 
ch
->
comm_æags
 +ğ
COMM_NOPAGE
;

1578 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1582 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

1583 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_PAGE
);

1584 
	`±c
(
ch
, "You faedØloÿ‹ [%s] iÀthe£„—lms.\n", 
¬g
);

1585 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1589 ià((
viùim
->
comm_æags
.
	`has
(
COMM_NOPAGE
))

1590 && !
	`IS_IMMORTAL
(
ch
)) {

1591 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_PAGE
);

1592 
	`aù
("$E dÛ nÙ hav$S…ag”uºed on.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1593 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1597 ià(
	`is_ignÜšg
(
viùim
, 
ch
)) {

1598 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_PAGE
);

1599 
	`±c
(
ch
, "% i ignÜšg you.\n", 
viùim
->
Çme
);

1600 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1604 ià(
viùim
->
desc
 =ğ
nuÎ±r
) {

1605 
¡¹ime
 = 
	`ùime
(&
Game
::
cu¼’t_time
);

1606 
¡¹ime
[
	`¡¾’
(strtime) - 1] = '\0';

1607 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_PAGE
);

1608 
	`aù
("$N seemso have misplaced $S†ink...try‡gain†ater.",

1609 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1610 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1611 
FÜm©
::
	`¥rštf
(
buf
, "{R[%s] %s PAGES '%s{x'{x\a\n",

1612 
¡¹ime
 , 
	`PERS
(
ch
, 
viùim
, 
VIS_PLR
).
	`ÿp™®ize
(), 
¬gum’t
);

1614 ià(!
viùim
->
	`is_Åc
()èviùim->
pcd©a
->
bufãr
 +ğ
buf
;

1619 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_PAGE
);

1620 
	`aù
("You PAGE $N '$t{x'", 
ch
, 
¬gum’t
, 
viùim
, 
TO_CHAR
, 
POS_SLEEPING
, 
çl£
);

1621 
	`¡c
("Thªk you fÜ usšg Comÿ¡ T–ecommuniÿtiÚs, Inc.\n", 
ch
);

1622 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1623 
	`Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_PAGE
);

1624 
	`aù
("$ÀPAGES '$t{x'\a", 
ch
, 
¬gum’t
, 
viùim
, 
TO_VICT
, 
POS_SLEEPING
, 
çl£
);

1625 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

1626 
viùim
->
»¶y
 = 
ch
->
Çme
;

1628 
	}
}

1630 
	$do_whi¥”
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1632 
Ch¬aù”
 *
viùim
;

1634 ià(
ch
->
	`is_Åc
()) {

1635 
	`¡c
("You†ackh»fšed d–iÿcy oàvoiûØwhi¥”.\n", 
ch
);

1639 ià(
ch
->
pcd©a
->
whi¥”
.
	`em±y
()) {

1640 
	`do_huh
(
ch
);

1644 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, ch->
pcd©a
->
whi¥”
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

1645 
	`±c
(
ch
, "{G% i¢'ˆh”e. :({x\n", ch->
pcd©a
->
whi¥”
);

1649 ià(
¬gum’t
.
	`em±y
()) {

1650 
	`±c
(
viùim
, "{G% whi¥” sw“ˆnÙhšg štØyou¸—r.{x\n", 
ch
->
Çme
);

1651 
	`±c
(
ch
, "{GYou whi¥” sw“ˆnÙhšg štØ%s' —r.{x\n", 
viùim
->
Çme
);

1655 
	`±c
(
viùim
, "{G% whi¥” š you¸—r, '%s{G'{x\n", 
ch
->
Çme
, 
¬gum’t
);

1656 
	`±c
(
ch
, "{GYou whi¥” iÀ%s' —r, '%s{G'{x\n", 
viùim
->
Çme
, 
¬gum’t
);

1657 
	}
}

1659 
	$do_q‹Î
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1661 
buf
[
MAX_STRING_LENGTH
];

1663 ià(
ch
->
	`is_Åc
()) {

1664 
	`¡c
("You dØnÙ hav¨qu”y†i¡.\n", 
ch
);

1668 ià(
¬gum’t
.
	`em±y
()) {

1669 ià(
ch
->
comm_æags
.
	`has
(
COMM_NOQUERY
)) {

1670 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_QTELL
);

1671 
	`¡c
("Qu”y chªÃÈi now on.\n", 
ch
);

1672 
ch
->
comm_æags
 -ğ
COMM_NOQUERY
;

1673 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1677 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_QTELL
);

1678 
	`¡c
("Qu”y chªÃÈi now off.\n", 
ch
);

1679 
ch
->
comm_æags
 +ğ
COMM_NOQUERY
;

1680 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1685 ià(
ch
->
pcd©a
->
qu”y
.
	`em±y
()) {

1686 
	`¡c
("You havnØÚÚ you¸qu”y†i¡.\n", 
ch
);

1690 ià(
ch
->
»voke_æags
.
	`has
(
REVOKE_QTELL
)) {

1691 
	`¡c
("You¸mes§gdidn'ˆg‘hrough!\n", 
ch
);

1695 ià(
ch
->
comm_æags
.
	`has
(
COMM_NOQUERY
)) {

1696 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_QTELL
);

1697 
	`¡c
("Qu”y chªÃÈi now on.\n", 
ch
);

1698 
ch
->
comm_æags
 -ğ
COMM_NOQUERY
;

1699 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1702 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_QTELL
);

1703 
	`±c
(
ch
, "You–Èthqu”y '%s{x'\n", 
¬gum’t
);

1704 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1705 
FÜm©
::
	`¥rštf
(
buf
, "% ‹Î thqu”y '%s{x'\n", 
ch
->
Çme
, 
¬gum’t
);

1706 
	`£nd_to_qu”y
(
ch
, 
buf
);

1708 
	}
}

1710 
	$do_g‹Î
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1712 
buf
[
MAX_STRING_LENGTH
];

1714 ià(
¬gum’t
.
	`em±y
()) {

1715 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_GTELL
);

1716 
	`¡c
("T–Èyou¸grou°wh©?\n", 
ch
);

1717 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1724 
FÜm©
::
	`¥rštf
(
buf
, "% ‹Î thgrou°'%s{x'\n", 
ch
->
Çme
, 
¬gum’t
);

1728 autØ
gch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

1729 ià(
	`is_§me_group
(
gch
, 
ch
)) {

1730 
	`Ãw_cŞÜ
(
gch
, 
CSLOT_CHAN_GTELL
);

1731 
	`¡c
(
buf
, 
gch
);

1732 
	`£t_cŞÜ
(
gch
, 
WHITE
, 
NOBOLD
);

1737 
	}
}

1739 
	$do_qu”y
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1741 
Ch¬aù”
 *
rch
;

1743 ià(
ch
->
desc
 =ğ
nuÎ±r
)

1744 
rch
 = 
ch
;

1746 
rch
 = 
ch
->
desc
->
Üigš®
 ? ch->desc->original : ch;

1748 ià(
rch
->
	`is_Åc
())

1751 
SŒšg
 
¬g
, 
¬g2
;

1752 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1753 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

1755 ià(
¬g
 != "+" &&‡rg != "-"

1756 && !
¬g
.
	`is_´efix_of
("list") && !arg.is_prefix_of("clear")) {

1757 
	`¡c
("SyÁax:\n", 
ch
);

1758 
	`¡c
("{RQu”y†i¡{x : Li¡ Çme š you¸qu”y.\n", 
ch
);

1759 
	`¡c
("{RQu”y +{x <{YName{x> : Add ¨ÇmtØyou¸qu”y.\n", 
ch
);

1760 
	`¡c
("{RQu”y -{x <{YName{x> : Remove ¨Çmäom qu”y.\n", 
ch
);

1761 
	`¡c
("{RQu”y cË¬{x : CË¬ you¸qu”y (»move ®ÈÇmes).\n", 
ch
);

1762 
	`¡c
(" ", 
ch
);

1763 
	`¡c
("{RQ‹Î{x : Tuº you¸qu”y chªÃÈÚ o¸off.\n", 
ch
);

1767 ià(
¬g
.
	`is_´efix_of
("list")) {

1768 ià(
rch
->
pcd©a
->
qu”y
.
	`em±y
()) {

1769 
	`¡c
("You havnØÚš you¸qu”y.\n", 
ch
);

1773 
	`¡c
("PeİË iÀyou¸qu”y:\n", 
ch
);

1775 auto& 
viù
: 
rch
->
pcd©a
->
qu”y
)

1776 
	`±c
(
ch
, " %s\n", 
viù
);

1781 ià(
¬g
.
	`is_´efix_of
("clear")) {

1782 
rch
->
pcd©a
->
qu”y
.
	`ş—r
();

1783 
	`¡c
("Qu”y cË¬ed.\n", 
ch
);

1787 ià(
¬g
.
	`is_´efix_of
("+")) {

1788 ià(
¬g2
.
	`em±y
()) {

1789 
	`¡c
("Add whØtØthqu”y†i¡?\n", 
ch
);

1793 ià(
¡d
::
	`fšd
(
rch
->
pcd©a
->
qu”y
.
	`cbegš
(),„ch->pcd©a->qu”y.
	`ûnd
(), 
¬g2
) !=„ch->pcdata->query.cend()) {

1794 
	`¡c
("Th©‚ami ®»ady iÀthqu”y.\n", 
ch
);

1798 ià(
rch
->
pcd©a
->
qu”y
.
	`size
(è>ğ
MAX_QUERY
) {

1799 
	`¡c
("ToØmªy u£r š qu”y,„emov¨Çme.\n", 
ch
);

1803 
rch
->
pcd©a
->
qu”y
.
	`push_back
(
¬g2
);

1804 
	`±c
(
ch
, "% ha b“ÀaddedØthqu”y†i¡.\n", 
¬g2
);

1808 ià(
¬g
.
	`is_´efix_of
("-")) {

1809 ià(
¬g2
.
	`em±y
()) {

1810 
	`¡c
("RemovwhØäomhqu”y†i¡?\n", 
ch
);

1814 autØ
£¬ch
 = 
¡d
::
	`fšd
(
rch
->
pcd©a
->
qu”y
.
	`begš
(),„ch->pcd©a->qu”y.
	`’d
(), 
¬g2
);

1816 ià(
£¬ch
 !ğ
rch
->
pcd©a
->
qu”y
.
	`’d
()) {

1817 
	`¡c
("Nam»moved fromhqu”y.\n", 
ch
);

1818 
rch
->
pcd©a
->
qu”y
.
	`”a£
(
£¬ch
);

1821 
	`¡c
("Th©‚amwa nÙ found iÀthqu”y†i¡.\n", 
ch
);

1823 
	}
}

	@src/clan-edit.cc

22 
	~"¬gum’t.hh
"

23 
	~"Ch¬aù”.hh
"

24 
	~"CÏn.hh
"

25 
	~"deş¬e.hh
"

26 
	~"FÏgs.hh
"

27 
	~"FÜm©.hh
"

28 
	~"lookup.hh
"

29 
	~"Loggšg.hh
"

30 
	~"m”c.hh
"

31 
	~"PÏy”.hh
"

32 
	~"sql.hh
"

33 
	~"SŒšg.hh
"

35 
	#CLAN_DIR
 "../misc/"

	)

36 
	#CLAN_FILE
 "şªs.txt"

	)

39 
­³nd_şª
(
CÏn
 *);

40 
»move_şª
(cÚ¡ 
SŒšg
&);

41 
couÁ_şªs
();

44 
CÏn
 *
	gşª_bË_h—d
;

45 
CÏn
 *
	gşª_bË_
;

47 
	$couÁ_şª_memb”s
(
CÏn
 *
şª
, 
b™
)

49 
SŒšg
 
qu”y
;

50 
couÁ
;

52 ià(
b™
 !ğ0 && b™ !ğ
GROUP_LEADER
 && b™ !ğ
GROUP_DEPUTY
)

55 
FÜm©
::
	`¥rštf
(
qu”y
, "SELECT COUNT(*èFROM…c_šdex WHERE cÏÀLIKE '%s'", 
	`db_esc
(
şª
->
Çme
));

57 ià(
b™
 != 0) {

58 
buf
[
MSL
];

59 
FÜm©
::
	`¥rštf
(
buf
, " AND cgroup&%d", 
b™
);

60 
qu”y
 +ğ
buf
;

63 ià((
couÁ
 = 
	`db_couÁ
("couÁ_şª_memb”s", 
qu”y
)) == -1)

66  
couÁ
;

67 
	}
}

69 
	$lßd_şª_bË
()

71 
CÏn
 *
şª
;

72 
couÁ
 = 0;

73 
şª_bË_h—d
 = 
Ãw
 
CÏn
;

74 
şª_bË_
 = 
Ãw
 
CÏn
;

77 ià((!
şª_bË_h—d
è|| (!
şª_bË_
)) {

78 
FÜm©
::
	`´štf
("load_clan_table: Error on memory‡lloc.\n");

82 
şª_bË_h—d
->
Ãxt
 = 
şª_bË_
;

83 
şª_bË_
->
´evious
 = 
şª_bË_h—d
;

85 ià(
	`db_qu”y
("load_clan_table",

87 "šd•’d’t, cÏnqp, gŞd, scÜe, w¬ımod FROM cÏns"è!ğ
SQL_OK
)

90 
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

98 ià((
şª
 = 
Ãw
 
CÏn
è=ğ
nuÎ±r
) {

99 
Loggšg
::
	`bug
("load_clan_table: unableo‡llocate memory for‚ew clan", 0);

103 
şª
->
Çme
 = 
	`db_g‘_cŞumn_¡r
(1);

104 
şª
->
who_Çme
 = 
	`db_g‘_cŞumn_¡r
(2);

105 
şª
->
şªÇme
 = 
	`db_g‘_cŞumn_¡r
(3);

106 
şª
->
ü—tÜ
 = 
	`db_g‘_cŞumn_¡r
(4);

107 
şª
->
»ÿÎ
 = 
	`LoÿtiÚ
(
	`db_g‘_cŞumn_št
(5));

108 
şª
->
¬—_mšvnum
 = 
	`db_g‘_cŞumn_št
(6);

109 
şª
->
¬—_maxvnum
 = 
	`db_g‘_cŞumn_št
(7);

110 
şª
->
šd•’d’t
 = 
	`db_g‘_cŞumn_št
(8);

111 
şª
->
şªqp
 = 
	`db_g‘_cŞumn_št
(9);

112 
şª
->
gŞd_b®ªû
 = 
	`db_g‘_cŞumn_št
(10);

113 
şª
->
scÜe
 = 
	`db_g‘_cŞumn_št
(11);

114 
şª
->
w¬ımod
 = 
	`db_g‘_cŞumn_št
(12);

115 
	`­³nd_şª
(
şª
);

116 
FÜm©
::
	`´štf
("Lßded cÏÀ'%s'\n", 
şª
->
Çme
);

117 
couÁ
++;

120 
FÜm©
::
	`´štf
("TÙ® oà%d cÏn lßded.\n", 
couÁ
);

121 
	}
}

123 
	$§ve_şª_bË
()

125 
CÏn
 *
şª
;

126 
couÁ
;

128 
	`db_commªd
("save_clan_table", "UPDATE clans SET current=0");

130 
şª
 = 
şª_bË_h—d
->
Ãxt
; cÏÀ!ğ
şª_bË_
; clan = clan->next) {

131 ià((
couÁ
 = 
	`db_couÁf
("save_clan_table",

132 "SELECT COUNT(*èFROM cÏn WHERE‚ame='%s'", 
şª
->
Çme
)) == -1)

135 ià(!
couÁ
) {

136 
	`db_commªdf
("save_clan_table", "INSERT INTO clans VALUES("

138 
	`db_esc
(
şª
->
Çme
),

139 
	`db_esc
(
şª
->
who_Çme
),

140 
	`db_esc
(
şª
->
şªÇme
),

141 
	`db_esc
(
şª
->
ü—tÜ
),

142 
şª
->
»ÿÎ
.
	`to_št
(),

143 
şª
->
¬—_mšvnum
,

144 
şª
->
¬—_maxvnum
,

145 
şª
->
šd•’d’t
,

146 
şª
->
şªqp
,

147 
şª
->
gŞd_b®ªû
,

148 
şª
->
scÜe
,

149 
şª
->
w¬ımod
);

153 
	`db_commªdf
("save_clan_table", "UPDATE clans SET current=1,‚ame='%s', who_name='%s', "

156 
	`db_esc
(
şª
->
Çme
),

157 
	`db_esc
(
şª
->
who_Çme
),

158 
	`db_esc
(
şª
->
şªÇme
),

159 
	`db_esc
(
şª
->
ü—tÜ
),

160 
şª
->
»ÿÎ
.
	`to_št
(),

161 
şª
->
¬—_mšvnum
,

162 
şª
->
¬—_maxvnum
,

163 
şª
->
šd•’d’t
,

164 
şª
->
şªqp
,

165 
şª
->
gŞd_b®ªû
,

166 
şª
->
scÜe
,

167 
şª
->
w¬ımod
,

168 
şª
->
Çme
);

170 
	}
}

173 
	$­³nd_şª
(
CÏn
 *
c
)

175 
c
->
´evious
 = 
şª_bË_
->previous;

176 
c
->
´evious
->
Ãxt
 = c;

177 
c
->
Ãxt
 = 
şª_bË_
;

178 
şª_bË_
->
´evious
 = 
c
;

179 
	}
}

182 
	$couÁ_şªs
()

184 
CÏn
 *
™”©Ü
;

185 
şªs
 = 0;

186 
™”©Ü
 = 
şª_bË_h—d
->
Ãxt
;

188 
™”©Ü
 !ğ
şª_bË_
) {

189 
şªs
++;

190 
™”©Ü
 = i‹¿tÜ->
Ãxt
;

193  
şªs
;

194 
	}
}

197 
	$ÿlc_ı
(
CÏn
 *
şª
, 
boŞ
 
curve
)

199 
memb”s
 = 
	`couÁ_şª_memb”s
(
şª
, 0), 
şªpow”
;

200 
şªpow”
 = ((
memb”s
 / 2è+ (
şª
->
gŞd_b®ªû
 / 10000è+ (şª->
şªqp
 / 100è+ cÏn->
w¬ımod
);

203 ià(
curve
 && 
şªpow”
 != 30 && clanpower > 0) {

204 
modtÙ®
 = 
şªpow”
, 
curved
;

205 
mod
;

207 ià(
şªpow”
 < 30)

208 
modtÙ®
 = (30 - 
şªpow”
) + 30;

210 
mod
 = ((
modtÙ®
 * 1000) + 10000) / (modtotal - 10);

211 
curved
 = (((
modtÙ®
 - 30è* 
mod
) / 1000) - (modtotal - 30);

213 ià(
şªpow”
 < 30)

214 
şªpow”
 = 30 - 
curved
;

216 
şªpow”
 = 30 + 
curved
;

219  
şªpow”
;

220 
	}
}

223 
	$»move_şª
(cÚ¡ 
SŒšg
& 
Çme
)

225 
CÏn
 *
™”©Ü
;

226 
™”©Ü
 = 
şª_bË_h—d
->
Ãxt
;

228 
™”©Ü
 !ğ
şª_bË_
) {

229 ià(!
	`¡rÿ£cmp
(
™”©Ü
->
Çme
,‚ame)) {

230 
CÏn
 *
p
 = 
™”©Ü
->
´evious
;

231 
CÏn
 *
n
 = 
™”©Ü
->
Ãxt
;

232 
p
->
Ãxt
 = 
n
;

233 
n
->
´evious
 = 
p
;

234 
d–‘e
 
™”©Ü
;

238 
™”©Ü
 = i‹¿tÜ->
Ãxt
;

240 
	}
}

242 
	$do_ûd™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

244 
CÏn
 *
cd©a
;

246 ià(
¬gum’t
.
	`em±y
()) {

247 
	`¡c
("Huh?y³ HELP CEDITØ£syÁax.\n", 
ch
);

251 
SŒšg
 
cmd
, 
şªÇme
;

252 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
cmd
);

253 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
şªÇme
);

255 ià(
şªÇme
.
	`em±y
()) {

256 
	`¡c
("Wh© cÏÀdØyou wªˆtØİ”©Ú?\n", 
ch
);

260 
cd©a
 = 
	`şª_lookup
(
şªÇme
);

262 ià(
cmd
 !ğ"Ãw" && (
cd©a
 =ğ
nuÎ±r
)) {

263 
	`¡c
("NØsuch cÏÀexi¡s.\n", 
ch
);

267 ià(
cmd
 == "delete") {

268 ià(
cd©a
 =ğ
nuÎ±r
)

269 
	`¡c
("You‚“dØ¥ecify‡ cÏÂame.\n", 
ch
);

271 
	`»move_şª
(
cd©a
->
Çme
);

272 
	`¡c
("CÏÀd–‘ed.\n", 
ch
);

273 
	`§ve_şª_bË
();

279 ià(
cmd
 == "new") {

280 
CÏn
 *
Ãw_şª
 = 
Ãw
 Clan;

282 ià(
Ãw_şª
 =ğ
nuÎ±r
) {

283 
Loggšg
::
	`bug
("Unableo‡llocate memory for‚ew clan!", 0);

284 
	`¡c
("AÎoÿtiÚ oàmemÜy fÜhÃw cÏÀçed!\n", 
ch
);

288 ià(
cd©a
 !ğ
nuÎ±r
) {

289 
	`¡c
("A cÏÀw™hh©‚am®»adyƒxi¡s.\n", 
ch
);

293 
Ãw_şª
->
Çme
 = 
şªÇme
;

294 
Ãw_şª
->
who_Çme
 = " ";

295 
Ãw_şª
->
¬—_mšvnum
 = 0;

296 
Ãw_şª
->
¬—_maxvnum
 = 0;

297 
Ãw_şª
->
šd•’d’t
 = 
çl£
;

298 
Ãw_şª
->
şªqp
 = 0;

299 
Ãw_şª
->
gŞd_b®ªû
 = 1000;

300 
Ãw_şª
->
şªÇme
 = "";

301 
Ãw_şª
->
ü—tÜ
 = "";

302 
Ãw_şª
->
scÜe
 = 0;

303 
Ãw_şª
->
w¬ımod
 = 0;

304 
	`­³nd_şª
(
Ãw_şª
);

305 
	`§ve_şª_bË
();

306 
	`¡c
("New cÏÀadded.\n", 
ch
);

310 ià(
cmd
 == "show") {

311 
	`±c
(
ch
, "{HClan: %s\n"

334 
cd©a
->
Çme
,

335 
cd©a
->
who_Çme
,

336 
cd©a
->
»ÿÎ
.
	`to_¡ršg
(),

337 
cd©a
->
¬—_mšvnum
,

338 
cd©a
->
¬—_maxvnum
,

339 
cd©a
->
šd•’d’t
 ? "Yes" : "No",

340 
cd©a
->
şªqp
,

341 
cd©a
->
gŞd_b®ªû
,

342 
cd©a
->
şªÇme
,

343 
cd©a
->
ü—tÜ
,

344 
cd©a
->
scÜe
,

345 
cd©a
->
w¬ımod
);

349 ià(
cmd
 == "whoname") {

350 
cd©a
->
who_Çme
 = 
¬gum’t
;

352 ià(
¬gum’t
.
	`em±y
())

353 
	`¡c
("Thwho-Çmi £ˆtØnÚe.\n", 
ch
);

355 
	`±c
(
ch
, "New whÚame: '%s{x'.\n", 
cd©a
->
who_Çme
);

357 
	`§ve_şª_bË
();

361 ià(
cmd
 == "hall") {

362 ià(
¬gum’t
.
	`em±y
(è|| !¬gum’t.
	`is_numb”
()) {

363 
	`¡c
("CÏÄeÿÎ s‘ØnÜm®„eÿÎ.\n", 
ch
);

364 
cd©a
->
»ÿÎ
 = 
	`LoÿtiÚ
(
	`Vnum
(3001));

367 ià(!
	`fšd_loÿtiÚ
(
ch
, 
¬gum’t
))

368 
	`¡c
("NØsuch†oÿtiÚ.\n", 
ch
);

370 
cd©a
->
»ÿÎ
 = 
	`LoÿtiÚ
(
¬gum’t
);

371 
	`±c
(
ch
, "CÏÄeÿÎ s‘Ø%s.\n", 
cd©a
->
»ÿÎ
.
	`to_¡ršg
());

375 
	`§ve_şª_bË
();

379 ià(
cmd
 == "areamin") {

380 
vnum
 = -1;

382 ià(
¬gum’t
.
	`em±y
(è|| !¬gum’t.
	`is_numb”
()) {

383 
	`¡c
("A»amš s‘Ø0.\n", 
ch
);

384 
cd©a
->
¬—_mšvnum
 = 0;

387 
vnum
 = 
	`©oi
(
¬gum’t
);

389 ià(
vnum
 < 0) {

390 
	`¡c
("A»amš mu¡ bg»©” o¸equ®Ø0.\n", 
ch
);

394 
cd©a
->
¬—_mšvnum
 = 
vnum
;

395 
	`±c
(
ch
, "A»amš s‘Ø%d.\n", 
cd©a
->
¬—_mšvnum
);

398 
	`§ve_şª_bË
();

402 ià(
cmd
 == "areamax") {

403 
vnum
 = -1;

405 ià(
¬gum’t
.
	`em±y
(è|| !¬gum’t.
	`is_numb”
()) {

406 
	`¡c
("A»amax s‘Ø0.\n", 
ch
);

407 
cd©a
->
¬—_maxvnum
 = 0;

410 
vnum
 = 
	`©oi
(
¬gum’t
);

412 ià(
vnum
 < 0) {

413 
	`¡c
("A»amax mu¡ bg»©” o¸equ®Ø0.\n", 
ch
);

417 
cd©a
->
¬—_maxvnum
 = 
vnum
;

418 
	`±c
(
ch
, "A»amax s‘Ø%d.\n", 
cd©a
->
¬—_maxvnum
);

421 
	`§ve_şª_bË
();

425 ià(
cmd
 == "independent") {

426 
šd•’d’t
 = 0;

428 ià(!
	`IS_IMP
(
ch
)) {

429 
	`¡c
("You cªnÙ makthi ª immÜÈşª.\n", 
ch
);

433 ià(
¬gum’t
.
	`em±y
(è|| !¬gum’t.
	`is_numb”
()) {

434 
	`¡c
("D•’d’ˆ£ˆtØ0 (nÙ d•’d’t)\n", 
ch
);

435 
cd©a
->
šd•’d’t
 = 0;

438 
šd•’d’t
 = 
	`©oi
(
¬gum’t
);

440 ià(
šd•’d’t
 < 0 || independent > 1) {

441 
	`¡c
("U£hv®ues: 0=NO, 1=YES\n", 
ch
);

445 
cd©a
->
šd•’d’t
 = independent;

447 ià(
šd•’d’t
)

448 
	`¡c
("Thşª i now ind•’d’t.\n", 
ch
);

450 
	`¡c
("Thşª i now d•’d’t.\n", 
ch
);

453 
	`§ve_şª_bË
();

457 ià(
cmd
 == "clanqp") {

458 
şªqp
 = -1;

460 ià(
¬gum’t
.
	`em±y
(è|| !¬gum’t.
	`is_numb”
()) {

461 
	`¡c
("You‚“dØ´ovid¨num”iÿÈ¬gum’t.\n", 
ch
);

465 
şªqp
 = 
	`©oi
(
¬gum’t
);

467 ià(
şªqp
 < 0) {

468 
	`¡c
("You‚“dØ´ovid¨pos™ivnum”iÿÈ¬gum’t.\n", 
ch
);

472 
cd©a
->
şªqp
 = clanqp;

473 
	`±c
(
ch
, "CÏnq°£ˆtØ%ld.\n", 
cd©a
->
şªqp
);

474 
	`§ve_şª_bË
();

478 ià(
cmd
 == "clangold") {

479 
gŞd_b®ªû
 = -1;

481 ià(
¬gum’t
.
	`em±y
(è|| !¬gum’t.
	`is_numb”
()) {

482 
	`¡c
("You‚“dØ´ovid¨num”iÿÈ¬gum’t.\n", 
ch
);

486 
gŞd_b®ªû
 = 
	`©oi
(
¬gum’t
);

488 ià(
gŞd_b®ªû
 < 0) {

489 
	`¡c
("You‚“dØ´ovid¨pos™ivnum”iÿÈ¬gum’t.\n", 
ch
);

493 
cd©a
->
gŞd_b®ªû
 = gold_balance;

494 
	`±c
(
ch
, "CÏngŞd s‘Ø%ld.\n", 
cd©a
->
gŞd_b®ªû
);

495 
	`§ve_şª_bË
();

499 ià(
cmd
 == "clanname") {

500 
cd©a
->
şªÇme
 = 
¬gum’t
;

502 ià(
¬gum’t
.
	`em±y
())

503 
	`¡c
("CÏÂam£ˆtØnÚe.\n", 
ch
);

505 
	`±c
(
ch
, "CÏÂam£ˆtØ'%s{x'.\n", 
cd©a
->
şªÇme
);

507 
	`§ve_şª_bË
();

511 ià(
cmd
 == "creator") {

512 
cd©a
->
ü—tÜ
 = 
¬gum’t
;

514 ià(
¬gum’t
.
	`em±y
())

515 
	`¡c
("C»©Ü s‘ØnÚe.\n", 
ch
);

517 
	`±c
(
ch
, "C»©Ü s‘Ø'%s{x'.\n", 
cd©a
->
ü—tÜ
);

519 
	`§ve_şª_bË
();

523 ià(
cmd
 == "score") {

524 
scÜe
 = 0;

526 ià(
¬gum’t
.
	`em±y
(è|| !¬gum’t.
	`is_numb”
()) {

527 
	`¡c
("You‚“dØ´ovid¨num”iÿÈ¬gum’t.\n", 
ch
);

531 
scÜe
 = 
	`©oi
(
¬gum’t
);

533 ià(
scÜe
 < 0) {

534 
	`¡c
("You‚“dØ´ovid¨pos™ivnum”iÿÈ¬gum’t.\n", 
ch
);

538 
cd©a
->
scÜe
 = score;

539 
	`±c
(
ch
, "ScÜ£ˆtØ%d.\n", 
cd©a
->
scÜe
);

540 
	`§ve_şª_bË
();

544 ià(
cmd
 == "warcpmod") {

545 
mod
 = 0;

547 ià(
¬gum’t
.
	`em±y
(è|| !¬gum’t.
	`is_numb”
()) {

548 
	`¡c
("You‚“dØ´ovid¨num”iÿÈ¬gum’t.\n", 
ch
);

552 
mod
 = 
	`©oi
(
¬gum’t
);

553 
cd©a
->
w¬ımod
 = 
mod
;

554 
	`±c
(
ch
, "Thşª‚ow ha theœ…ow” modif›d by %d.\n", 
cd©a
->
w¬ımod
);

555 
	`§ve_şª_bË
();

559 
	`¡c
("Huh?y³ HELP CEDITØ£syÁax.\n", 
ch
);

560 
	}
}

	@src/comm.cc

46 
	~<¬·/š‘.h
>

47 
	~<sys/time.h
>

48 
	~<fú.h
>

49 
	~<Ãtdb.h
>

50 
	~<sigÇl.h
>

51 
	~<uni¡d.h
>

53 
	~"aù.hh
"

54 
	~"¬gum’t.hh
"

55 
	~"A»a.hh
"

56 
	~"chªÃls.hh
"

57 
	~"Ch¬aù”.hh
"

58 
	~"CÏn.hh
"

59 
	~"deş¬e.hh
"

60 
	~"DesütÜ.hh
"

61 
	~"Ex™.hh
"

62 
	~"fe.hh
"

63 
	~"FÏgs.hh
"

64 
	~"FÜm©.hh
"

65 
	~"Game.hh
"

66 
	~"š‹½.hh
"

67 
	~"lookup.hh
"

68 
	~"Loggšg.hh
"

69 
	~"memÜy.hh
"

70 
	~"m”c.hh
"

71 
	~"MobProg.hh
"

72 
	~"MobePrÙÙy³.hh
"

73 
	~"PÏy”.hh
"

74 
	~"¿ndom.hh
"

75 
	~"Room.hh
"

76 
	~"sql.hh
"

77 
	~"SŒšg.hh
"

78 
	~"‹Ê‘.hh
"

79 
	~"vt100.hh
"

80 
	~"comm.hh
"

81 
	~"cÚn/S‹.hh
"

82 
	~"WÜld.hh
"

84 
	gka_¡ruù
;

87 
ka_¡ruù
 *
	gka
;

89 cÚ¡ 
	gecho_off_¡r
 [] = { 
IAC
, 
WILL
, 
TELOPT_ECHO
, '\0' };

90 cÚ¡ 
	gecho_Ú_¡r
 [] = { 
IAC
, 
WONT
, 
TELOPT_ECHO
, '\0' };

97 
SŒšg
 
	gexe_fe
;

102 
DesütÜ
 *
	gdesütÜ_li¡
;

103 
DesütÜ
 *
	gd_Ãxt
;

104 
boŞ
 
	ggod
;

105 
boŞ
 
	gm”c_down
;

106 
	g¡r_boÙ_time
[
MAX_INPUT_LENGTH
];

107 
time_t
 
	g»boÙ_time
 = 0;

108 
	gcÚŒŞ
;

109 
	gcommªd
[
MAX_STRING_LENGTH
];

110 
	gÏ¡_sigÇl
 = -1;

115 
game_loİ_unix
 
¬gs
((
cÚŒŞ
));

116 
š™_sock‘
 
¬gs
((
pÜt
));

117 
š™_desütÜ
 
¬gs
((
cÚŒŞ
));

118 
boŞ
 
»ad_äom_desütÜ
 
¬gs
((
DesütÜ
 *
d
));

119 
boŞ
 
wr™e_to_desütÜ
 
¬gs
((
desc
, cÚ¡ 
SŒšg
& 
txt
, 
Ëngth
));

124 
show_¡ršg
(
DesütÜ
 *
d
, 
boŞ
 
ş—r_»mašd”
);

125 
maš
 
¬gs
((
¬gc
, **
¬gv
));

126 
boŞ
 
´oûss_ouut
 
¬gs
((
DesütÜ
 *
d
, boŞ 
fProm±
));

127 
»ad_äom_bufãr
 
¬gs
((
DesütÜ
 *
d
));

128 
¡İ_idlšg
 
¬gs
((
Ch¬aù”
 *
ch
));

129 
bu¡_a_´om±
 
¬gs
((
Ch¬aù”
 *
ch
));

130 *
g‘_muÉi_commªd
 
¬gs
((
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
));

131 
SŒšg
 
ex·nd_cŞÜ_codes
(
Ch¬aù”
 *
ch
, cÚ¡ SŒšg& 
¡r
);

133 
	$echo_off
(
DesütÜ
 *
d
) {

134 
	`wr™e_to_bufãr
(
d
, (cÚ¡ *)
echo_off_¡r
);

135 
	}
}

137 
	$echo_Ú
(
DesütÜ
 *
d
) {

138 
	`wr™e_to_bufãr
(
d
, (cÚ¡ *)
echo_Ú_¡r
);

139 
	}
}

142 
	$ex™_»asÚ
(cÚ¡ *
moduË
, 
lše
, cÚ¡ *
»asÚ
)

144 
FÜm©
::
	`´štf
("ex™šg % ©†š%d beÿu£: %s\n", 
moduË
, 
lše
, 
»asÚ
);

145 
	`fæush
(
¡dout
);

146 
	}
}

148 
	#EXIT_REASON
(
l
,
r
è
	`ex™_»asÚ
("comm.c",†,„)

	)

150 
	$cİyov”_»cov”
()

152 
DesütÜ
 *
d
;

153 
FILE
 *
å
;

154 
Çme
[100];

155 
ho¡
[
MSL
], 
msg1
[MSL], 
msg2
[MSL];

156 
desc
;

157 
Loggšg
::
	`log
("Copyover„ecovery initiated");

159 ià((
å
 = 
	`fİ’
(
COPYOVER_LOG
, "r")è=ğ
nuÎ±r
) {

160 
	`³¼Ü
("copyover_recover:fopen");

161 
Loggšg
::
	`log
("Copyover†og‚ot found. Exitting.\n");

162 
	`ex™
(1);

166 
	`uÆšk
(
COPYOVER_LOG
);

168 
SŒšg
 
logÇme
 = 
	`ä—d_¡ršg
(
å
);

169 
	`fşo£
(
å
);

171 ià((
å
 = 
	`fİ’
(
COPYOVER_FILE
, "r")è=ğ
nuÎ±r
) {

172 
	`³¼Ü
("copyover_recover:fopen");

173 
Loggšg
::
	`log
("Copyover file‚ot found. Exitting.\n");

174 
	`ex™
(1);

178 
	`uÆšk
(
COPYOVER_FILE
);

182 ià(
logÇme
 == "Liriel")

183 
FÜm©
::
	`¥rštf
(
msg1
, "\nYou blink,‡nd‡ll of‡ sudden, you‡re back where you were before,\n"

185 ià(
logÇme
 == "Outsider")

186 
FÜm©
::
	`¥rštf
(
msg1
, "\nDispite‡ll ofhe confusion, you feel‚o danger inhe soft hug.\n");

187 ià(
logÇme
 == "Kenneth")

188 
FÜm©
::
	`¥rštf
(
msg1
, "\nThe hand is cold, but seemsoƒxert‚o…ressure‡t‡ll on your face.\n");

189 ià(
logÇme
 == "Montrey")

190 
FÜm©
::
	`¥rštf
(
msg1
, "\nThe world beginsoake shape before yourƒyes.\n");

191 ià(
logÇme
 == "Xenith")

192 
FÜm©
::
	`¥rštf
(
msg1
, "\nYour vision„eturns,‡s your body forms‡gain.\n");

194 
FÜm©
::
	`¥rštf
(
msg1
, "\nRestoring from copyover...\n");

197 ià(
logÇme
 == "Xenith")

198 
FÜm©
::
	`¥rštf
(
msg2
, "\nThe world begins‡new, better fromhe destruction.\n");

199 ià(
logÇme
 == "Outsider")

200 
FÜm©
::
	`¥rštf
(
msg2
, "\nThe‡ngel steps back from you,„evealing‡ cleaner,‚ewer world. You\n"

202 ià(
logÇme
 == "Montrey")

203 
FÜm©
::
	`¥rštf
(
msg2
, "\nYou blink,‡nd seehe world complete once‡gain.\n"

205 ià(
logÇme
 == "Liriel")

206 
FÜm©
::
	`¥rštf
(
msg2
, "\nThe onlyrace ofhe faerie is‡†ittle blue glimmerhat quickly winks\n"

208 ià(
logÇme
 == "Kenneth")

209 
FÜm©
::
	`¥rštf
(
msg2
, "\nHalf‡ second†ater your sight is„eturned,he man is gone,‡ndhe\n"

212 
FÜm©
::
	`¥rštf
(
msg2
, "\nCopyover„ecovery complete.\n");

215 
	`fsÿnf
(
å
, "%d % %s\n", &
desc
, 
Çme
, 
ho¡
);

217 ià(
desc
 == -1)

221 ià(!
	`wr™e_to_desütÜ
(
desc
, 
msg1
, 0)) {

222 
	`şo£
(
desc
);

226 
d
 = 
Ãw
 
	`DesütÜ
();

227 
d
->
desütÜ
 = 
desc
;

228 
d
->
ho¡
 = host;

229 
d
->
Ãxt
 = 
desütÜ_li¡
;

230 
desütÜ_li¡
 = 
d
;

231 
d
->
¡©e
 = &
cÚn
::
S‹
::
cİyov”Recov”
;

234 ià(!
	`lßd_ch¬_obj
(
d
, 
Çme
)) {

235 
	`wr™e_to_desütÜ
(
desc
, "\nSomehow, your character was†ost inhe copyover. Sorry.\n", 0);

236 
	`şo£_sock‘
(
d
);

241 
Game
::
	`wÜld
().
	`add_ch¬
(
d
->
ch¬aù”
);

242 
	`wr™e_to_desütÜ
(
desc
, 
msg2
, 0);

243 
	`ch¬_to_room
(
d
->
ch¬aù”
, d->ch¬aù”->
š_room
);

244 
	`do_look
(
d
->
ch¬aù”
, "auto");

245 
	`aù
("$Àm©”Ÿlizes!", 
d
->
ch¬aù”
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

247 
d
->
¡©e
 = &
cÚn
::
S‹
::
¶ayšg
;

249 ià(
d
->
ch¬aù”
->
³t
 !ğ
nuÎ±r
) {

250 
	`ch¬_to_room
(
d
->
ch¬aù”
->
³t
, d->ch¬aù”->
š_room
);

251 
	`aù
("$Àm©”Ÿlizes!", 
d
->
ch¬aù”
->
³t
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

254 
Game
::
»cÜd_¶ay”s_sšû_boÙ
++;

257 
	`fşo£
(
å
);

258 
	}
}

261 
	$sig_hªdË
(
sig
)

263 
Ï¡_sigÇl
 = 
sig
;

264 
	}
}

266 
	$maš
(
¬gc
, **
¬gv
)

268 
exe_fe
 = 
¬gv
[0];

270 
timev®
 
now_time
;

271 
boŞ
 
fCİyOv”
 = 
çl£
;

272 
FILE
 *
åBoÙ
 = 
nuÎ±r
;

273 
sigaùiÚ
 
sig_aù
;

276 
sig_aù
.
§_hªdËr
 = 
sig_hªdË
;

277 
	`sigem±y£t
(&
sig_aù
.
§_mask
);

278 
sig_aù
.
§_æags
 = 0;

279 
	`sigaùiÚ
(
SIGPIPE
, &
sig_aù
, 0);

282 
	`g‘timeofday
(&
now_time
, 
nuÎ±r
);

283 
Game
::
cu¼’t_time
 = (
time_t
è
now_time
.
tv_£c
;

284 
	`¡rıy
(
¡r_boÙ_time
, 
	`ùime
(&
Game
::
cu¼’t_time
));

289 
åBoÙ
 = 
	`fİ’
(
BOOT_FILE
, "w");

291 ià(
åBoÙ
)

292 
	`fşo£
(
åBoÙ
);

295 
Game
::
pÜt
 = 
DIZZYPORT
;

297 ià(
¬gc
 > 1) {

298 ià(!
	`SŒšg
(
¬gv
[1]).
	`is_numb”
()) {

299 
FÜm©
::
	`årštf
(
¡d”r
, "U§ge: % [pÜˆ#]\n", 
¬gv
[0]);

300 
	`EXIT_REASON
(433, "bad Legacy…ort‡rg");

301 
	`ex™
(1);

303 ià((
Game
::
pÜt
 = 
	`©oi
(
¬gv
[1])) <= 1024) {

304 
FÜm©
::
	`årštf
(
¡d”r
, "Port‚umber must be‡bove 1024.\n");

305 
	`EXIT_REASON
(439, "bad Legacy…ort‚umber");

306 
	`ex™
(1);

310 ià(
Game
::
pÜt
 !ğ
DIZZYPORT
) {

312 
	`uÆšk
(
BOOT_FILE
);

316 ià(
¬gc
 > 3) {

318 ià(
¬gv
[3] &&‡rgv[3][0]) {

319 ià(
¬gc
 <= 4) {

320 
FÜm©
::
	`årštf
(
¡d”r
, "Notƒnough‡rgs for COPYOVER\n");

321 
	`EXIT_REASON
(480, "notƒnough‡rgs for COPYOVER");

322 
	`ex™
(1);

325 ià(!
	`SŒšg
(
¬gv
[4]).
	`is_numb”
()) {

326 
FÜm©
::
	`årštf
(
¡d”r
, "Bad 'cÚŒŞ' v®u'%s'\n", 
¬gv
[4]);

327 
	`EXIT_REASON
(486, "bad control value for COPYOVER");

328 
	`ex™
(1);

331 
cÚŒŞ
 = 
	`©oi
(
¬gv
[4]);

332 
fCİyOv”
 = 
Œue
;

336 ià(!
fCİyOv”
)

337 
cÚŒŞ
 = 
	`š™_sock‘
(
Game
::
pÜt
);

339 #ià
	`defšed
(
SAND
)

341 
	`§nd_š™
(
SANDCLIENTPORT
, 
SANDSERVERPORT
);

344 ià(
	`lßd_cÚfig
(
CONFIG_FILE
) != 0) {

345 
Loggšg
::
	`bugf
("FaedØlßd cÚfigu¿tiÚ from %s.", 
CONFIG_FILE
);

346 
	`ex™
(1);

349 
Game
::
	`boÙ
();

350 
Loggšg
::
	`logf
("Legacy i »adyØrock oÀpÜˆ%d.", 
Game
::
pÜt
);

352 ià(
fCİyOv”
)

353 
	`cİyov”_»cov”
();

356 
	`uÆšk
(
BOOT_FILE
);

358 autØ
tch
 : 
Game
::
	`wÜld
().
ch¬_li¡
)

359 ià(
tch
->
	`is_Åc
())

360 
	`m´og_boÙ_Œigg”
(
tch
);

362 ià(
Game
::
pÜt
 =ğ
DIZZYPORT
) {

363 
FILE
 *
pidfe
;

364 
pid
 = 
	`g‘pid
();

366 ià((
pidfe
 = 
	`fİ’
(
PID_FILE
, "w")è=ğ
nuÎ±r
) {

367 
	`³¼Ü
("getpid:fopen");

368 
Loggšg
::
	`log
("pid file‚ot found. Exitting.\n");

369 
	`ex™
(1);

372 
FÜm©
::
	`årštf
(
pidfe
, "%d", 
pid
);

373 
	`fæush
(
pidfe
);

374 
	`fşo£
(
pidfe
);

377 
	`game_loİ_unix
(
cÚŒŞ
);

378 
	`şo£
(
cÚŒŞ
);

381 
	`db_şo£
();

384 
Loggšg
::
	`log
("Normalermination of game.");

385 
	`ex™
(0);

387 
	}
}

389 
	$š™_sock‘
(
pÜt
)

391 cÚ¡ 
x
 = 1;

392 
fd
;

393 #ifdeà
IPV6


394 
sockaddr_š6
 
§_z”o
;

395 
sockaddr_š6
 
§
;

397 ià((
fd
 = 
	`sock‘
(
AF_INET6
, 
SOCK_STREAM
, 0)) < 0)

399 
sockaddr_š
 
§_z”o
;

401 
sockaddr_š
 
§
;

403 ià((
fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_STREAM
, 0)) < 0)

406 
	`³¼Ü
("Init_socket: socket");

407 
	`EXIT_REASON
(527, "Init_socket()…roblem");

408 
	`ex™
(1);

411 ià(
	`£tsockİt
(
fd
, 
SOL_SOCKET
, 
SO_REUSEADDR
, (*è&
x
, (x)) < 0) {

412 
	`³¼Ü
("Init_socket: SO_REUSEADDR");

413 
	`şo£
(
fd
);

414 
	`EXIT_REASON
(536, "setsockopt(SO_REUSEADDR) failed");

415 
	`ex™
(1);

418 #ià
	`defšed
(
SO_NOSIGPIPE
)

419 
	`´štf
("setting SO_NOSIGPIPE\n");

420 ià(
	`£tsockİt
(
fd
, 
SOL_SOCKET
, 
SO_NOSIGPIPE
, (*è&
x
, (x)) < 0) {

421 
	`³¼Ü
("Init_socket: SO_NOSIGPIPE");

422 
	`şo£
(
fd
);

423 
	`EXIT_REASON
(536, "setsockopt(SO_NOSIGPIPE) failed");

424 
	`ex™
(1);

431 #ià
	`defšed
(
SO_LINGER
)

432 
	`´štf
("setting SO_LINGER\n");

434 
lšg”
 
ld
;

437 
ld
.
l_Úoff
 = 0;

438 
ld
.
l_lšg”
 = 0;

440 ià(
	`£tsockİt
(
fd
, 
SOL_SOCKET
, 
SO_LINGER
,

441 (*è&
ld
, (ld)) < 0) {

442 
	`³¼Ü
("Init_socket: SO_LINGER");

443 
	`şo£
(
fd
);

444 
	`EXIT_REASON
(552, "SO_LINGER failed");

445 
	`ex™
(1);

460 
§
 = 
§_z”o
;

461 #ifdeà
IPV6


462 
§
.
sš6_çmy
 = 
AF_INET6
;

463 
§
.
sš6_pÜt
 = 
	`htÚs
(
pÜt
);

465 
§
.
sš_çmy
 = 
AF_INET
;

466 
§
.
sš_pÜt
 = 
	`htÚs
(
pÜt
);

469 ià(
	`bšd
(
fd
, (
sockaddr
 *è&
§
, (sa)) < 0) {

470 
	`³¼Ü
("Init socket: bind");

471 
	`şo£
(
fd
);

472 
	`EXIT_REASON
(566, "bind failure");

473 
	`ex™
(1);

476 ià(
	`li¡’
(
fd
, 3) < 0) {

477 
	`³¼Ü
("Init socket:†isten");

478 
	`şo£
(
fd
);

479 
	`EXIT_REASON
(575, "listen() failure");

480 
	`ex™
(1);

483  
fd
;

484 
	}
}

486 
	$game_loİ_unix
(
cÚŒŞ
)

488 
timev®
 
nuÎ_time
;

489 
timev®
 
Ï¡_time
;

490 
	`g‘timeofday
(&
Ï¡_time
, 
nuÎ±r
);

491 
Game
::
cu¼’t_time
 = (
time_t
è
Ï¡_time
.
tv_£c
;

494 !
m”c_down
) {

495 
fd_£t
 
š_£t
;

496 
fd_£t
 
out_£t
;

497 
fd_£t
 
exc_£t
;

498 
DesütÜ
 *
d
;

499 
maxdesc
;

502 ià(
Ï¡_sigÇl
 != -1) {

503 
Ï¡_sigÇl
) {

504 
SIGPIPE
: 
Loggšg
::
	`bug
("received signal SIGPIPE", 0); ;

506 : 
Loggšg
::
	`bug
("»ûived sigÇÈ%d", 
Ï¡_sigÇl
);

509 
Ï¡_sigÇl
 = -1;

513 
	`FD_ZERO
(&
š_£t
);

514 
	`FD_ZERO
(&
out_£t
);

515 
	`FD_ZERO
(&
exc_£t
);

516 
	`FD_SET
(
cÚŒŞ
, &
š_£t
);

517 
maxdesc
 = 
cÚŒŞ
;

519 
d
 = 
desütÜ_li¡
; d; d = d->
Ãxt
) {

520 
maxdesc
 = 
¡d
::
	`max
(maxdesc, 
d
->
desütÜ
);

521 
	`FD_SET
(
d
->
desütÜ
, &
š_£t
);

522 
	`FD_SET
(
d
->
desütÜ
, &
out_£t
);

523 
	`FD_SET
(
d
->
desütÜ
, &
exc_£t
);

526 
nuÎ_time
.
tv_£c
 = 0;

527 
nuÎ_time
.
tv_u£c
 = 0;

529 ià(
	`£Ëù
(
maxdesc
 + 1, &
š_£t
, &
out_£t
, &
exc_£t
, &
nuÎ_time
) < 0) {

530 
	`³¼Ü
("Game_loop: select:…oll");

531 
	`EXIT_REASON
(793, "game_loop select() failure");

532 
	`ex™
(1);

536 ià(
	`FD_ISSET
(
cÚŒŞ
, &
š_£t
)) {

537 
	`š™_desütÜ
(
cÚŒŞ
);

541 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = 
d_Ãxt
) {

542 
d_Ãxt
 = 
d
->
Ãxt
;

544 ià(
	`FD_ISSET
(
d
->
desütÜ
, &
exc_£t
)) {

545 
	`FD_CLR
(
d
->
desütÜ
, &
š_£t
);

546 
	`FD_CLR
(
d
->
desütÜ
, &
out_£t
);

547 
Ch¬aù”
 *
ch
 = 
d
->
ch¬aù”
;

550 
SŒšg
 
log_buf
;

551 ià(
ch
 && ch->
Ëv–
 > 1) {

552 
	`§ve_ch¬_obj
(
ch
);

553 
log_buf
 = 
FÜm©
::
	`fÜm©
("Kickšg ouˆch¬ %s", 
ch
->
Çme
);

556 
log_buf
 = "Kicking out unknown char";

558 
Loggšg
::
	`log
(
log_buf
);

559 
	`wizÃt
(
log_buf
, 
nuÎ±r
,‚uÎ±r, 
WIZ_LOGINS
, 0, 0);

560 
d
->
outbuf
.
	`ş—r
();

561 
	`şo£_sock‘
(
d
);

566 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = 
d_Ãxt
) {

567 
d_Ãxt
 = 
d
->
Ãxt
;

568 
d
->
fcommªd
 = 
çl£
;

570 ià(
	`FD_ISSET
(
d
->
desütÜ
, &
š_£t
)) {

571 ià(
d
->
ch¬aù”
 !ğ
nuÎ±r
) {

572 
d
->
tim”
 = 0;

573 
d
->
ch¬aù”
->
tim”
 = 0;

576 ià(
d
->
Üigš®
 !ğ
nuÎ±r
) {

577 
d
->
Üigš®
->
tim”
 = 0;

578 
d
->
tim”
 = 0;

581 ià(!
	`»ad_äom_desütÜ
(
d
)) {

582 
	`FD_CLR
(
d
->
desütÜ
, &
out_£t
);

584 ià(
d
->
ch¬aù”
 !ğ
nuÎ±r
 && d->ch¬aù”->
Ëv–
 > 1) {

585 
	`§ve_ch¬_obj
(
d
->
ch¬aù”
);

586 
SŒšg
 
log_buf
 = 
FÜm©
::
	`fÜm©
("Ch¬ % discÚÃùed", 
d
->
ch¬aù”
->
Çme
);

587 
Loggšg
::
	`log
(
log_buf
);

588 
	`wizÃt
(
log_buf
, 
nuÎ±r
,‚uÎ±r, 
WIZ_MALLOC
, 0, 0);

591 
Loggšg
::
	`bugf
("bad„—d_äom_desütÜ: sock‘ %d discÚÃùed.", 
d
);

592 
d
->
outbuf
.
	`ş—r
();

593 
	`şo£_sock‘
(
d
);

598 ià(
d
->
ch¬aù”
 && d->ch¬aù”->
wa™
 > 0)

601 ià(
d
->
šcomm
[0] == '\0')

602 
	`»ad_äom_bufãr
(
d
);

604 ià(
d
->
šcomm
[0] != '\0') {

605 
d
->
fcommªd
 = 
Œue
;

606 
	`¡İ_idlšg
(
d
->
ch¬aù”
);

607 
SŒšg
 
commªd2
 = 
	`g‘_muÉi_commªd
(
d
, d->
šcomm
);

608 
commªd2
 = commªd2.
	`l¡r
();

610 ià(!
d
->
show¡r_h—d
.
	`em±y
())

611 
	`show_¡ršg
(
d
, !
commªd2
.
	`em±y
());

613 
d
->
¡©e
 = d->¡©e->
	`hªdËIÅut
(d, 
commªd2
);

618 
	`upd©e_hªdËr
();

621 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = 
d_Ãxt
) {

622 
d_Ãxt
 = 
d
->
Ãxt
;

624 ià((
d
->
fcommªd
 || !d->
outbuf
.
	`em±y
())

625 && 
	`FD_ISSET
(
d
->
desütÜ
, &
out_£t
)) {

626 ià(!
	`´oûss_ouut
(
d
, 
Œue
)) {

627 ià(
d
->
ch¬aù”
 !ğ
nuÎ±r
 && d->ch¬aù”->
Ëv–
 > 1)

628 
	`§ve_ch¬_obj
(
d
->
ch¬aù”
);

630 
Loggšg
::
	`bugf
("bad wr™e_to_desütÜ: sock‘ %d discÚÃùed.", 
d
);

631 
d
->
outbuf
.
	`ş—r
();

632 
	`şo£_sock‘
(
d
);

641 
timev®
 
now_time
;

642 
£cD–
;

643 
u£cD–
;

644 
	`g‘timeofday
(&
now_time
, 
nuÎ±r
);

645 
u£cD–
 = ((è
Ï¡_time
.
tv_u£c
è- ((è
now_time
.tv_usec)

646 + 1000000 / 
PULSE_PER_SECOND
;

647 
£cD–
 = ((è
Ï¡_time
.
tv_£c
è- ((è
now_time
.tv_sec);

649 
u£cD–
 < 0) {

650 
u£cD–
 += 1000000;

651 
£cD–
--;

654 
u£cD–
 >= 1000000) {

655 
u£cD–
 -= 1000000;

656 
£cD–
++;

659 ià(
£cD–
 > 0 || (£cD– =ğ0 && 
u£cD–
 > 0)) {

660 
timev®
 
¡®l_time
;

661 
¡®l_time
.
tv_u£c
 = 
u£cD–
;

662 
¡®l_time
.
tv_£c
 = 
£cD–
;

664 ià(
	`£Ëù
(0, 
nuÎ±r
,‚uÎ±r,‚uÎ±r, &
¡®l_time
) < 0) {

665 ià(
Game
::
pÜt
 =ğ
DIZZYPORT
) {

666 
	`³¼Ü
("Game_loop: select: stall");

667 
	`EXIT_REASON
(979, "game_loop select() stall");

668 
	`ex™
(1);

673 
	`g‘timeofday
(&
Ï¡_time
, 
nuÎ±r
);

674 
Game
::
cu¼’t_time
 = (
time_t
è
Ï¡_time
.
tv_£c
;

678 
	}
}

680 
	$š™_desütÜ
(
cÚŒŞ
)

682 
DesütÜ
 *
dÃw
;

683 #ifdeà
IPV6


684 
sockaddr_š6
 
sock
;

686 
sockaddr_š
 
sock
;

688 
ho¡’t
 *
äom
;

689 
desc
;

690 
size
;

691 #ià
	`defšed
(
SAND
)

692 *
tmp_Çme
;

694 
size
 = (
sock
);

695 
	`g‘sockÇme
(
cÚŒŞ
, (
sockaddr
 *è&
sock
, &
size
);

697 ià((
desc
 = 
	`acû±
(
cÚŒŞ
, (
sockaddr
 *è&
sock
, &
size
)) < 0) {

698 
	`wizÃt
("init_descriptor:ƒrror‡ccepting‚ew connection",

699 
nuÎ±r
,‚uÎ±r, 
WIZ_MALLOC
, 0, 0);

700 
	`³¼Ü
("new Descriptor:‡ccept");

704 #ià!
	`defšed
(
FNDELAY
)

705 
	#FNDELAY
 
O_NDELAY


	)

708 ià(
	`fú
(
desc
, 
F_SETFL
, 
FNDELAY
) == -1) {

709 
	`wizÃt
("init_descriptor:ƒrror setting FNDELAY",

710 
nuÎ±r
,‚uÎ±r, 
WIZ_MALLOC
, 0, 0);

711 
	`³¼Ü
("new Descriptor: fcntl: FNDELAY");

718 
dÃw
 = 
Ãw
 
	`DesütÜ
();

719 
dÃw
->
desütÜ
 = 
desc
;

721 
size
 = (
sock
);

723 ià(
	`g‘³”Çme
(
desc
, (
sockaddr
 *è&
sock
, &
size
) < 0) {

724 
	`wizÃt
("init_descriptor:ƒrror getting…eername",

725 
nuÎ±r
,‚uÎ±r, 
WIZ_MALLOC
, 0, 0);

726 
	`³¼Ü
("new Descriptor: getpeername");

727 
dÃw
->
ho¡
 = "(unknown)";

734 #ifdeà
IPV6


735 
buf
[
INET6_ADDRSTRLEN
];

736 
	`š‘_Áİ
(
AF_INET6
, &
sock
.
sš6_addr
, 
buf
, (buf));

738 
buf
[
INET_ADDRSTRLEN
];

739 
addr
 = 
	`Áohl
(
sock
.
sš_addr
.
s_addr
);

740 
FÜm©
::
	`¥rštf
(
buf
, "%d.%d.%d.%d",

741 (
addr
 >> 24) & 0xFF, (addr >> 16) & 0xFF,

742 (
addr
 >> 8) & 0xFF, (addr) & 0xFF

747 
SŒšg
 
log_buf
 = 
FÜm©
::
	`fÜm©
("š™_desütÜ: sock.sšadd¸ = %s", 
buf
);

748 
Loggšg
::
	`log
(
log_buf
);

749 
	`wizÃt
(
log_buf
, 
nuÎ±r
,‚uÎ±r, 
WIZ_MALLOC
, 0, 0);

751 
äom
 = 
nuÎ±r
;

754 #ià
	`defšed
(
SAND
)

755 
tmp_Çme
 = 
	`§nd_qu”y
(
addr
);

757 ià(
tmp_Çme
 =ğ
nuÎ±r
) {

758 
Loggšg
::
	`log
("name‚ot‡vailable");

759 
dÃw
->
ho¡
 = 
buf
;

762 
dÃw
->
ho¡
 = 
tmp_Çme
;

765 ià(
	`¡rcmp
("kyndig.com", 
dÃw
->
ho¡
)) {

766 
SŒšg
 
log_buf
 = 
FÜm©
::
	`fÜm©
("š™_desütÜ: ho¡‚amğ%s", 
dÃw
->
ho¡
);

767 
Loggšg
::
	`log
(
log_buf
);

768 
	`wizÃt
(
log_buf
, 
nuÎ±r
,‚uÎ±r, 
WIZ_SITES
, 0, 0);

774 #ifdeà
IPV6


775 
äom
 = 
	`g‘ho¡byaddr
((*è&
sock
.
sš6_addr
, (sock.sš6_addr), 
AF_INET6
);

777 
äom
 = 
	`g‘ho¡byaddr
((*è&
sock
.
sš_addr
, (sock.sš_addr), 
AF_INET
);

780 ià(
äom
 =ğ
nuÎ±r
 || from->
h_Çme
 ==‚ullptr) {

781 
Loggšg
::
	`log
("name‚ot‡vailable");

782 
dÃw
->
ho¡
 = 
buf
;

785 
dÃw
->
ho¡
 = 
äom
->
h_Çme
;

788 ià(
	`¡rcmp
("kyndig.com", 
dÃw
->
ho¡
)) {

789 
SŒšg
 
log_buf
 = 
FÜm©
::
	`fÜm©
("š™_desütÜ: ho¡‚amğ%s", 
dÃw
->
ho¡
);

790 
Loggšg
::
	`log
(
log_buf
);

791 
	`wizÃt
(
log_buf
, 
nuÎ±r
,‚uÎ±r, 
WIZ_SITES
, 0, 0);

802 
dÃw
->
Ãxt
 = 
desütÜ_li¡
;

803 
desütÜ_li¡
 = 
dÃw
;

805 
	`cwtb
(
dÃw
, 
Game
::
h–p_g»‘šg
[0] =ğ'.' ? Game::h–p_g»‘šg.
	`sub¡r
(1) : Game::help_greeting);

808 
	}
}

810 
	$şo£_sock‘
(
DesütÜ
 *
dşo£
)

812 
Ch¬aù”
 *
ch
;

813 
DesütÜ
 *
d
;

815 ià(!
dşo£
->
outbuf
.
	`em±y
())

816 
	`´oûss_ouut
(
dşo£
, 
çl£
);

818 ià(
dşo£
->
¢oİ_by
 !ğ
nuÎ±r
)

819 
	`wr™e_to_bufãr
(
dşo£
->
¢oİ_by
, "Your victim has†efthe game.\n");

821 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
)

822 ià(
d
->
¢oİ_by
 =ğ
dşo£
)

823 
d
->
¢oİ_by
 = 
nuÎ±r
;

825 ià((
ch
 = 
dşo£
->
ch¬aù”
è=ğ
nuÎ±r
) {

826 
Loggšg
::
	`logf
("Closšg†škØphªtom‡ˆsock‘ %d.", 
dşo£
->
desütÜ
);

830 
Loggšg
::
	`logf
("Closšg†škØ%s.", 
ch
->
Çme
);

832 ià(
dşo£
->
¡©e
 =ğ&
cÚn
::
S‹
::
¶ayšg
) {

833 
Ch¬aù”
 *
rch
;

835 
rch
 = 
ch
->
š_room
->
³İË
;„ch;„ch =„ch->
Ãxt_š_room
)

836 ià(!
	`IS_IMMORTAL
(
ch
è|| 
	`ÿn_£e_ch¬
(
rch
, ch))

837 
	`±c
(
rch
, "%s has†ost %s†ink.\n",

838 
	`PERS
(
ch
, 
rch
, 
VIS_CHAR
),

839 
	`GET_ATTR_SEX
(
ch
è=ğ
SEX_FEMALE
 ? "her" :

840 
	`GET_ATTR_SEX
(
ch
è=ğ
SEX_MALE
 ? "his" : "its");

842 
	`wizÃt
("$N ha lo¡†šk.", 
ch
, 
nuÎ±r
, 
WIZ_LINKS
, 0, 0);

844 ià(!
ch
->
	`is_Åc
())

845 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_LINK_DEAD
;

848 ià(
ch
->
desc
 =ğ
nuÎ±r
)

849 
Loggšg
::
	`bug
("close_socket: NPC without descriptor!", 0);

850 ià(
ch
->
desc
->
Üigš®
 !ğ
nuÎ±r


851 && 
ch
->
desc
->
Üigš®
->
pcd©a
 !ğ
nuÎ±r
)

852 
ch
->
desc
->
Üigš®
->
pcd©a
->
¶r_æags
 +ğ
PLR_LINK_DEAD
;

854 ià(
ch
->
aù_æags
.
	`has
(
ACT_MORPH
)) {

855 ià(
ch
->
desc
->
Üigš®
 !ğ
nuÎ±r
) {

856 
Room
 *
loÿtiÚ
;

858 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

859 
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_MORGUE
)));

861 
loÿtiÚ
 = 
ch
->
š_room
;

863 
	`ch¬_äom_room
(
ch
->
desc
->
Üigš®
);

864 
	`ch¬_to_room
(
ch
->
desc
->
Üigš®
, 
loÿtiÚ
);

866 ià(
ch
->
š_room
 !ğ
nuÎ±r
)

867 
	`ch¬_äom_room
(
ch
);

872 
ch
->
desc
 = 
nuÎ±r
;

875 
boŞ
 
found
 = 
çl£
;

877 autØ
wch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

878 ià(
wch
 =ğ
dşo£
->
ch¬aù”
) {

879 
Game
::
	`wÜld
().
ch¬_li¡
.
	`»move
(
wch
);

880 
found
 = 
Œue
;

885 ià(!
found
)

886 
d–‘e
 
dşo£
->
ch¬aù”
;

890 ià(
d_Ãxt
 =ğ
dşo£
)

891 
d_Ãxt
 = d_Ãxt->
Ãxt
;

893 ià(
dşo£
 =ğ
desütÜ_li¡
)

894 
desütÜ_li¡
 = desütÜ_li¡->
Ãxt
;

896 
DesütÜ
 *
d
;

898 
d
 = 
desütÜ_li¡
; d && d->
Ãxt
 !ğ
dşo£
; d = d->next)

901 ià(
d
 !ğ
nuÎ±r
)

902 
d
->
Ãxt
 = 
dşo£
->next;

904 
Loggšg
::
	`bug
("Close_socket: dclose‚ot found.", 0);

907 
FÜm©
::
	`´štf
("Closšg sock‘ %d\n", 
dşo£
->
desütÜ
);

908 
	`şo£
(
dşo£
->
desütÜ
);

909 
d–‘e
 
dşo£
;

911 
	}
}

913 
boŞ
 
	$»ad_äom_desütÜ
(
DesütÜ
 *
d
)

915 
iS¹
;

918 ià(
d
->
šcomm
[0] != '\0')

919  
Œue
;

922 
iS¹
 = 
	`¡¾’
(
d
->
šbuf
);

924 ià(
iS¹
 >ğ(
d
->
šbuf
) - 10) {

925 
Loggšg
::
	`logf
("% špuˆov”æow!", 
d
->
ho¡
);

926 
	`wr™e_to_desütÜ
(
d
->
desütÜ
,

928  
çl£
;

933 
nR—d
;

934 
nR—d
 = 
	`»ad
(
d
->
desütÜ
, d->
šbuf
 + 
iS¹
,

935 (
d
->
šbuf
è- 10 - 
iS¹
);

937 ià(
nR—d
 > 0) {

938 
iS¹
 +ğ
nR—d
;

941 ià(
d
->
šbuf
[
iS¹
 - 1] == '\n' || d->inbuf[iStart - 1] == '\r')

944 ià(
nR—d
 == 0) {

945 ià(
d
->
ch¬aù”
 && d->ch¬aù”->
Ëv–
 > 0)

946 
Loggšg
::
	`logf
("EOF oÀ»ad from ch¬ %s", 
d
->
ch¬aù”
->
Çme
);

947 ià(!
	`¡rcmp
(
d
->
ho¡
, "localhost"))

948  
çl£
;

950 
Loggšg
::
	`logf
("EOF oÀ»ad from ho¡ %s", 
d
->
ho¡
);

952  
çl£
;

954 ià(
”ºo
 =ğ
EWOULDBLOCK
)

957 
	`³¼Ü
("Read_from_descriptor");

958  
çl£
;

962 
d
->
šbuf
[
iS¹
] = '\0';

963  
Œue
;

964 
	}
}

969 
	$»ad_äom_bufãr
(
DesütÜ
 *
d
)

971 
i
, 
j
, 
k
;

976 ià(
d
->
šcomm
[0] != '\0')

982 
i
 = 0; 
d
->
šbuf
[i] != '\n' && d->inbuf[i] != '\r'; i++) {

983 ià(
d
->
šbuf
[
i
] == '\0')

990 
i
 = 0, 
k
 = 0; 
d
->
šbuf
[i] != '\n' && d->inbuf[i] != '\r'; i++) {

991 ià(
k
 >ğ
MAX_INPUT_LENGTH
 - 2) {

992 
	`wr™e_to_desütÜ
(
d
->
desütÜ
, "Lineoo†ong.\n", 0);

995 ; 
d
->
šbuf
[
i
] != '\0'; i++) {

996 ià(
d
->
šbuf
[
i
] == '\n' || d->inbuf[i] == '\r')

1000 
d
->
šbuf
[
i
] = '\n';

1001 
d
->
šbuf
[
i
 + 1] = '\0';

1005 ià(
d
->
šbuf
[
i
] =ğ'\b' && 
k
 > 0)

1006 --
k
;

1007 ià(
	`i§scii
(
d
->
šbuf
[
i
]è&& 
	`i¥ršt
(d->inbuf[i]))

1008 
d
->
šcomm
[
k
++] = d->
šbuf
[
i
];

1014 ià(
k
 == 0)

1015 
d
->
šcomm
[
k
++] = ' ';

1017 
d
->
šcomm
[
k
] = '\0';

1023 ià(
k
 > 1 || 
d
->
šcomm
[0] == '!') {

1024 ià(
d
->
šcomm
[0] !ğ'!' && 
	`¡rcmp
(d->šcomm, d->
šÏ¡
))

1025 
d
->
»³©
 = 0;

1027 ià(++
d
->
»³©
 >= 25) {

1028 
Loggšg
::
	`logf
("%s: iÅuˆ¥ammšg!", 
d
->
ho¡
);

1029 
	`wizÃt
("Andhe spammer ofhe year is: $N!!!",

1030 
d
->
ch¬aù”
, 
nuÎ±r
, 
WIZ_SPAM
, 0, 
	`GET_RANK
(d->character));

1032 ià(
d
->
šcomm
[0] == '!')

1033 
	`wizÃt
(
d
->
šÏ¡
, d->
ch¬aù”
, 
nuÎ±r
, 
WIZ_SPAM
, 0,

1034 
	`GET_RANK
(
d
->
ch¬aù”
));

1036 
	`wizÃt
(
d
->
šcomm
, d->
ch¬aù”
, 
nuÎ±r
, 
WIZ_SPAM
, 0,

1037 
	`GET_RANK
(
d
->
ch¬aù”
));

1039 
d
->
»³©
 = 0;

1052 ià(
d
->
šcomm
[0] == '!') {

1057 ià((
	`¡¾’
(
d
->
šcomm
è+ sŒËn(d->
šÏ¡
è+ 16è< 
MAX_INPUT_LENGTH
) {

1058 
‹mp_bufãr
[
MAX_INPUT_LENGTH
];

1060 
FÜm©
::
	`¥rštf
(
‹mp_bufãr
, "%s%s", 
d
->
šÏ¡
, & (d->
šcomm
[1]));

1061 
	`¡rıy
(
d
->
šcomm
, 
‹mp_bufãr
);

1064 
	`¡rıy
(
d
->
šcomm
, d->
šÏ¡
);

1067 
	`¡rıy
(
d
->
šÏ¡
, d->
šcomm
);

1072 
d
->
šbuf
[
i
] == '\n' || d->inbuf[i] == '\r')

1073 
i
++;

1075 
j
 = 0; (
d
->
šbuf
[j] = d->šbuf[
i
 + j]) != '\0'; j++)

1079 
	}
}

1084 
boŞ
 
	$´oûss_ouut
(
DesütÜ
 *
d
, 
boŞ
 
fProm±
)

1086 
boŞ
 
m”c_down
;

1089 ià(
d
->
	`is_¶ayšg
()

1090 && 
d
->
ch¬aù”
->
pcd©a


1091 && 
d
->
ch¬aù”
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_VT100
)) {

1092 
	`wr™e_to_bufãr
(
d
, 
VT_SAVECURSOR
);

1093 
	`gÙo_lše
(
d
->
ch¬aù”
, d->ch¬aù”->
lšes
 - 2, 1);

1099 ià(!
m”c_down
 && !
d
->
show¡r_h—d
.
	`em±y
())

1100 
	`wr™e_to_bufãr
(
d
, "[Hit Entero continue]\n");

1101 ià(
fProm±
 && !
m”c_down
 && 
d
->
	`is_¶ayšg
()) {

1102 
Ch¬aù”
 *
ch
;

1103 
Ch¬aù”
 *
viùim
;

1104 
ch
 = 
d
->
ch¬aù”
;

1107 ià((
viùim
 = 
ch
->
fightšg
è!ğ
nuÎ±r
) {

1108 
SŒšg
 
©b
;

1110 ià(
ch
->
comm_æags
.
	`has
(
COMM_ATBPROMPT
)) {

1111 ià(
ch
->
wa™
 > 40è
FÜm©
::
	`¥rštf
(
©b
, "{B[{C*{T*********{B]{x ");

1112 ià(
ch
->
wa™
 > 36è
FÜm©
::
	`¥rštf
(
©b
, "{B[{Y*{C*{T********{B]{x ");

1113 ià(
ch
->
wa™
 > 32è
FÜm©
::
	`¥rštf
(
©b
, "{B[{C*{Y*{C*{T*******{B]{x ");

1114 ià(
ch
->
wa™
 > 28è
FÜm©
::
	`¥rštf
(
©b
, "{B[{T*{C*{Y*{C*{T******{B]{x ");

1115 ià(
ch
->
wa™
 > 24è
FÜm©
::
	`¥rštf
(
©b
, "{B[{T**{C*{Y*{C*{T*****{B]{x ");

1116 ià(
ch
->
wa™
 > 20è
FÜm©
::
	`¥rštf
(
©b
, "{B[{T***{C*{Y*{C*{T****{B]{x ");

1117 ià(
ch
->
wa™
 > 16è
FÜm©
::
	`¥rštf
(
©b
, "{B[{T****{C*{Y*{C*{T***{B]{x ");

1118 ià(
ch
->
wa™
 > 12è
FÜm©
::
	`¥rštf
(
©b
, "{B[{T*****{C*{Y*{C*{T**{B]{x ");

1119 ià(
ch
->
wa™
 > 8è
FÜm©
::
	`¥rštf
(
©b
, "{B[{T******{C*{Y*{C*{T*{B]{x ");

1120 ià(
ch
->
wa™
 > 4è
FÜm©
::
	`¥rštf
(
©b
, "{B[{T*******{C*{Y*{C*{B]{x ");

1121 ià(
ch
->
wa™
 > 0è
FÜm©
::
	`¥rštf
(
©b
, "{B[{T********{C*{Y*{B]{x ");

1122 
FÜm©
::
	`¥rštf
(
©b
, "{B[{C**{YREADY!{C**{B]{x ");

1142 
FÜm©
::
	`¥rštf
(
©b
, "{x");

1144 ià(
	`ÿn_£e_ch¬
(
ch
, 
viùim
)) {

1145 
³rûÁ
;

1147 ià(
viùim
->
	`is_Åc
())

1148 
©b
 +ğ
viùim
->
shÜt_desü
;

1150 
©b
 +ğ
viùim
->
Çme
;

1152 ià(
	`GET_MAX_HIT
(
viùim
) > 0)

1153 
³rûÁ
 = 
viùim
->
h™
 * 100 / 
	`GET_MAX_HIT
(victim);

1155 
³rûÁ
 = -1;

1157 ià(
³rûÁ
 >ğ100è
©b
 += " is inƒxcellent condition.";

1158 ià(
³rûÁ
 >ğ90è
©b
 += " has‡ few scratches.";

1159 ià(
³rûÁ
 >ğ75è
©b
 += " has some small wounds‡nd bruises.";

1160 ià(
³rûÁ
 >ğ50è
©b
 += " has quite‡ few wounds.";

1161 ià(
³rûÁ
 >ğ30è
©b
 += " has some big‚asty wounds‡nd scratches.";

1162 ià(
³rûÁ
 >ğ15è
©b
 += "†ooks…retty hurt.";

1163 ià(
³rûÁ
 >ğ1è
©b
 += " is in‡wful condition.";

1164 ià(
³rûÁ
 >ğ0è
©b
 += " will soon beoast!!!";

1165 
©b
 += " is in‚eed of ***SERIOUS*** medical‡ttention!";

1168 
	`±c
(
ch
, "%s\n", 
©b
);

1171 
ch
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

1173 ià(!
ch
->
comm_æags
.
	`has
(
COMM_COMPACT
))

1174 
	`wr™e_to_bufãr
(
d
, "\n");

1176 ià(
ch
->
comm_æags
.
	`has
(
COMM_PROMPT
)) {

1177 
	`£t_cŞÜ
(
ch
, 
CYAN
, 
NOBOLD
);

1178 
	`bu¡_a_´om±
(
d
->
ch¬aù”
);

1179 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

1186 ià(
d
->
outbuf
.
	`em±y
())

1187  
Œue
;

1192 ià(
d
->
¢oİ_by
 !ğ
nuÎ±r
) {

1193 ià(
d
->
ch¬aù”
 !ğ
nuÎ±r
)

1194 
	`wr™e_to_bufãr
(
d
->
¢oİ_by
, (d->
ch¬aù”
)->
Çme
);

1196 
	`wr™e_to_bufãr
(
d
->
¢oİ_by
, "> ");

1197 
	`wr™e_to_bufãr
(
d
->
¢oİ_by
, d->
outbuf
);

1201 ià(
d
->
	`is_¶ayšg
()

1202 && 
d
->
ch¬aù”
->
pcd©a


1203 && 
d
->
ch¬aù”
->
pcd©a
->
video_æags
.
	`has
(
PLR_VT100
)) {

1204 
	`gÙo_lše
(
d
->
ch¬aù”
, d->ch¬aù”->
lšes
 - 1, 1);

1205 
	`wr™e_to_bufãr
(
d
, 
VT_CLEAR_LINE
);

1206 
	`wr™e_to_bufãr
(
d
, 
VT_BAR
);

1207 
	`wr™e_to_bufãr
(
d
, 
VT_RESTORECURSOR
);

1213 ià(!
	`wr™e_to_desütÜ
(
d
->
desütÜ
, d->
outbuf
, d->outbuf.
	`size
())) {

1214 
d
->
outbuf
.
	`ş—r
();

1215  
çl£
;

1218 
d
->
outbuf
.
	`ş—r
();

1219  
Œue
;

1221 
	}
}

1227 
	$bu¡_a_´om±
(
Ch¬aù”
 *
ch
)

1229 
SŒšg
 
buf
;

1231 ià(
ch
->
´om±
.
	`em±y
()) {

1232 
	`±c
(
ch
, "{W<{C%d{Th°{G%d{Hm¨{B%d{N¡{W>{x %s", ch->
h™
, ch->
mªa
, ch->
¡am
, ch->
´efix
);

1236 ià(
ch
->
comm_æags
.
	`has
(
COMM_AFK
)) {

1237 
	`¡c
("{b<AFK> {x", 
ch
);

1241 autØ
¡r
 = 
ch
->
´om±
.
	`cbegš
();

1243 
¡r
 !ğ
ch
->
´om±
.
	`ûnd
()) {

1244 ià(*
¡r
 == '{') {

1246 ++
¡r
;

1248 ià(*
¡r
 == '\0')

1251 
buf
 += '{';

1252 
buf
 +ğ*
¡r
;

1253 ++
¡r
;

1257 ià(*
¡r
 != '%') {

1258 
buf
 +ğ*
¡r
++;

1262 ++
¡r
;

1264 *
¡r
) {

1266 
buf
 += " ";

1270 
boŞ
 
found
 = 
çl£
;

1272 
doÜ
 = 0; door < 6; door++) {

1273 
Ex™
 *
³x™
;

1275 ià((
³x™
 = 
ch
->
š_room
->
ex™
[
doÜ
]è!ğ
nuÎ±r


1276 && 
³x™
 ->
to_room
 !ğ
nuÎ±r


1277 && 
	`ÿn_£e_room
(
ch
, 
³x™
->
to_room
)

1278 && 
	`ÿn_£e_š_room
(
ch
, 
³x™
->
to_room
)) {

1279 
found
 = 
Œue
;

1281 ià(!
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
))

1282 
buf
 +ğ
	`touµ”
(
Ex™
::
	`dœ_Çme
(
doÜ
)[0]);

1284 
buf
 +ğ
	`tŞow”
(
Ex™
::
	`dœ_Çme
(
doÜ
)[0]);

1288 ià(!
found
)

1289 
buf
 += "none";

1293 'c': 
buf
 += '\n'; ;

1294 'h': 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
ch
->
h™
); ;

1295 'H': 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
	`GET_MAX_HIT
(
ch
)); ;

1296 'm': 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
ch
->
mªa
); ;

1297 'M': 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
	`GET_MAX_MANA
(
ch
)); ;

1298 'v': 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
ch
->
¡am
); ;

1299 'V': 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
	`GET_MAX_STAM
(
ch
)); ;

1300 'x': 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
ch
->
exp
); ;

1302 ià(!
ch
->
	`is_Åc
())

1303 
buf
 +ğ
FÜm©
::
	`fÜm©
("%ld",

1304 (
ch
->
Ëv–
 + 1è* 
	`exp_³r_Ëv–
(ch, ch->
pcd©a
->
pošts
è- ch->
exp
);

1307 'g': 
buf
 +ğ
FÜm©
::
	`fÜm©
("%ld", 
ch
->
gŞd
); ;

1308 's': 
buf
 +ğ
FÜm©
::
	`fÜm©
("%ld", 
ch
->
sv”
); ;

1310 ià(
ch
->
Ëv–
 > 9)

1311 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
ch
->
®ignm’t
);

1313 
buf
 +ğ
	`IS_GOOD
(
ch
è? "good" : 
	`IS_EVIL
(ch) ? "evil" : "neutral";

1317 ià(
ch
->
š_room
 !ğ
nuÎ±r
)

1318 
buf
 +ğ
	`ÿn_£e_š_room
(
ch
, ch->
š_room
è? ch->š_room->
	`Çme
().
	`uncŞÜ
() : "darkness";

1320 
buf
 += ' ';

1324 ià(
	`IS_IMMORTAL
(
ch
è&& ch->
š_room
 !ğ
nuÎ±r
)

1325 
buf
 +ğ
FÜm©
::
	`fÜm©
("%s", 
ch
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
());

1327 
buf
 += ' ';

1331 ià(
ch
->
š_room
 !ğ
nuÎ±r
)

1332 
buf
 +ğ
ch
->
š_room
->
	`¬—
().
Çme
;

1334 
buf
 += ' ';

1338 ià(
ch
->
š_room
 !ğ
nuÎ±r
)

1339 
buf
 +ğ
	`£ùÜ_lookup
(
ch
->
š_room
->
	`£ùÜ_ty³
());

1341 
buf
 += ' ';

1345 ià(!
	`IS_QUESTOR
(
ch
))

1346 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
ch
->
pcd©a
->
Ãxtque¡
);

1348 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
ch
->
pcd©a
->
couÁdown
);

1352 ià(
	`IS_QUESTOR
(
ch
)) {

1354 
MobePrÙÙy³
 *
que¡šfo
;

1356 ià(
ch
->
pcd©a
->
que¡mob
 =ğ-1 || ch->pcd©a->
que¡obf
 == -1)

1357 
buf
 += "*report!*";

1358 ià(
ch
->
pcd©a
->
que¡obj
 > 0) {

1361 ià(
ch
->
pcd©a
->
que¡loc
.
	`is_v®id
())

1362 
buf
 +ğ
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
pcd©a
->
que¡loc
)->
	`Çme
().
	`uncŞÜ
();

1364 
buf
 += "Unknown";

1366 ià(
ch
->
pcd©a
->
que¡mob
 > 0) {

1367 ià((
que¡šfo
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
ch
->
pcd©a
->
que¡mob
)è!ğ
nuÎ±r
)

1368 
buf
 +ğ
que¡šfo
->
shÜt_desü
.
	`uncŞÜ
();

1370 
buf
 += "Unknown";

1373 
buf
 += "Unknown";

1378 ià(!
ch
->
	`is_Åc
())

1379 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
ch
->
pcd©a
->
que¡pošts
);

1383 ià(!
ch
->
	`is_Åc
()) {

1384 ià(!
	`IS_SQUESTOR
(
ch
))

1385 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
ch
->
pcd©a
->
Ãxtsque¡
);

1387 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
ch
->
pcd©a
->
sqcouÁdown
);

1390 
buf
 += '0';

1394 ià(
	`IS_SQUESTOR
(
ch
)) {

1395 ià(
ch
->
pcd©a
->
sque¡obj
 !ğ
nuÎ±r
 && ch->pcd©a->
sque¡mob
 ==‚ullptr) {

1396 ià(!
ch
->
pcd©a
->
sque¡objf
)

1398 
buf
 +ğ
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
pcd©a
->
sque¡loc1
)->
	`Çme
().
	`uncŞÜ
();

1400 
buf
 += "*report!*";

1402 ià(
ch
->
pcd©a
->
sque¡mob
 !ğ
nuÎ±r
 && ch->pcd©a->
sque¡obj
 ==‚ullptr) {

1403 ià(!
ch
->
pcd©a
->
sque¡mobf
)

1404 
buf
 +ğ
ch
->
pcd©a
->
sque¡mob
->
shÜt_desü
.
	`uncŞÜ
();

1406 
buf
 += "*report!*";

1408 ià(
ch
->
pcd©a
->
sque¡obj
 !ğ
nuÎ±r
 && ch->pcd©a->
sque¡mob
 !=‚ullptr) {

1409 ià(
ch
->
pcd©a
->
sque¡objf
) {

1410 ià(!
ch
->
pcd©a
->
sque¡mobf
)

1411 
buf
 +ğ
ch
->
pcd©a
->
sque¡mob
->
shÜt_desü
.
	`uncŞÜ
();

1413 
buf
 += "*report!*";

1417 
buf
 +ğ
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
pcd©a
->
sque¡loc1
)->
	`Çme
().
	`uncŞÜ
();

1420 
buf
 += "Unknown";

1425 ià(!
ch
->
	`is_Åc
())

1426 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
ch
->
pcd©a
->
skÍošts
);

1430 ià(!
ch
->
	`is_Åc
())

1431 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
ch
->
pcd©a
->
rŞ•ošts
);

1435 ià(
	`IS_IMMORTAL
(
ch
)) {

1436 ià(!
ch
->
švis_Ëv–
 && !ch->
lurk_Ëv–
)

1437 
buf
 += "VIS";

1439 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d/%d", 
ch
->
švis_Ëv–
, ch->
lurk_Ëv–
);

1441 ià(
ch
->
aù_æags
.
	`has
(
PLR_SUPERWIZ
))

1442 
buf
 += "WIZ";

1445 
buf
 += ' ';

1449 ++
¡r
;

1451 ià(*
¡r
 == '\0')

1455 
buf
 += '{';

1456 
buf
 +ğ*
¡r
;

1458 'l': 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d", 
ch
->
Ëv–
); ;

1459 '%': 
buf
 += '%'; ;

1462 ++
¡r
;

1465 
	`¡c
(
buf
, 
ch
);

1467 ià(!
ch
->
´efix
.
	`em±y
())

1468 
	`¡c
(
ch
->
´efix
, ch);

1469 
	}
}

1472 
	$cwtb
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
txt
)

1474 ià(
txt
.
	`em±y
())

1477 
	`wr™e_to_bufãr
(
d
, 
	`ex·nd_cŞÜ_codes
(d->
ch¬aù”
, 
txt
));

1478 
	}
}

1483 
	$wr™e_to_bufãr
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
txt
)

1485 ià(
d
 =ğ
nuÎ±r
)

1491 ià(
d
->
outbuf
.
	`em±y
(è&& !d->
fcommªd
) {

1492 
d
->
outbuf
 += '\n';

1493 
d
->
outbuf
 += '\r';

1499 
d
->
outbuf
 +ğ
txt
;

1501 
	}
}

1509 
boŞ
 
	$wr™e_to_desütÜ
(
desc
, cÚ¡ 
SŒšg
& 
txt
, 
Ëngth
)

1511 
iS¹
;

1512 
nWr™e
;

1513 
nBlock
;

1515 ià(
Ëngth
 <= 0)

1516 
Ëngth
 = 
	`¡¾’
(
txt
);

1518 
iS¹
 = 0; iS¹ < 
Ëngth
; iS¹ +ğ
nWr™e
) {

1519 
nBlock
 = 
¡d
::
	`mš
(
Ëngth
 - 
iS¹
, 4096);

1521 ià((
nWr™e
 = 
	`wr™e
(
desc
, 
txt
.
	`c_¡r
(è+ 
iS¹
, 
nBlock
)) < 0) {

1522 
	`³¼Ü
("Write_to_descriptor");

1530  
çl£
;

1534  
Œue
;

1535 
	}
}

1537 
	$¡İ_idlšg
(
Ch¬aù”
 *
ch
)

1539 ià(
ch
 =ğ
nuÎ±r


1540 || 
ch
->
desc
 =ğ
nuÎ±r


1541 || !
ch
->
desc
->
	`is_¶ayšg
()

1542 || 
ch
->
was_š_room
 =ğ
nuÎ±r


1543 || 
ch
->
š_room
 !ğ
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_LIMBO
))))

1546 
ch
->
desc
->
tim”
 = 0;

1547 
	`ch¬_äom_room
(
ch
);

1548 
	`ch¬_to_room
(
ch
, ch->
was_š_room
);

1549 
ch
->
was_š_room
 = 
nuÎ±r
;

1550 
	`aù
("$Àha »tuºed fromhvoid.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1552 
	}
}

1554 
SŒšg
 
	$š‹½»t_cŞÜ_code
(
Ch¬aù”
 *
ch
, 
a
)

1557 
SŒšg
 
code
;

1559 
a
) {

1561 ià(
ch
 && ch->
pcd©a
)

1562 
code
 = 
FÜm©
::
	`fÜm©
("%s%s\033[%d;%dm",

1563 
CLEAR
, 
B_BLACK
,

1564 
ch
->
pcd©a
->
Ï¡cŞÜ
[1], ch->pcdata->lastcolor[0]);

1566 
code
 = 
FÜm©
::
	`fÜm©
("%s%s", 
CLEAR
, 
B_BLACK
);

1570 'N': 
code
 = 
C_BLUE
; ;

1571 'T': 
code
 = 
C_CYAN
; ;

1572 'H': 
code
 = 
C_GREEN
; ;

1574 ià(
ch
 && ch->
pcd©a
 && ch->pcd©a->
video_æags
.
	`has
(
VIDEO_DARK_MOD
))

1575 
code
 = 
C_WHITE
;

1577 
code
 = 
C_BLACK
;

1581 'M': 
code
 = 
C_MAGENTA
; ;

1582 'R': 
code
 = 
C_RED
; ;

1583 'g': 
code
 = 
C_WHITE
; ;

1584 'b': 
code
 = 
C_YELLOW
; ;

1585 'B': 
code
 = 
C_B_BLUE
; ;

1586 'C': 
code
 = 
C_B_CYAN
; ;

1587 'G': 
code
 = 
C_B_GREEN
; ;

1588 'V': 
code
 = 
C_B_MAGENTA
; ;

1589 'P': 
code
 = 
C_B_RED
; ;

1590 'W': 
code
 = 
C_B_WHITE
; ;

1591 'Y': 
code
 = 
C_B_YELLOW
; ;

1593 ià(
ch
 && ch->
pcd©a
 && ch->pcd©a->
video_æags
.
	`has
(
VIDEO_DARK_MOD
))

1594 
code
 = 
C_WHITE
;

1596 
code
 = 
C_B_GREY
;

1601 
code
 = 
C_FLASH
;

1603 ià(
ch
 && ch->
pcd©a
) {

1604 ià(
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_FLASH_OFF
))

1605 
code
.
	`”a£
();

1607 ià(
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_FLASH_LINE
))

1608 
code
 +ğ
C_UNDERLINE
;

1613 's': 
code
 = 
C_REVERSE
; ;

1614 'e': 
code
 = 
B_GREY
; ;

1615 'r': 
code
 = 
B_RED
; ;

1616 'y': 
code
 = 
B_YELLOW
; ;

1617 'h': 
code
 = 
B_GREEN
; ;

1618 't': 
code
 = 
B_CYAN
; ;

1619 'n': 
code
 = 
B_BLUE
; ;

1620 'm': 
code
 = 
B_MAGENTA
; ;

1621 'a': 
code
 = 
B_BLACK
; ;

1622 '{': 
code
 = "{"; ;

1626  
code
;

1627 
	}
}

1629 
SŒšg
 
	$ex·nd_cŞÜ_codes
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¡r
) {

1630 
SŒšg
 
out
;

1632 autØ
™
 = 
¡r
.
	`cbegš
(); iˆ!ğ¡r.
	`ûnd
(); it++) {

1633 ià(*
™
 != '{') {

1634 
out
 +ğ*
™
;

1638 ià(++
™
 =ğ
¡r
.
	`ûnd
())

1641 
out
 +ğ
	`š‹½»t_cŞÜ_code
(
ch
, *
™
);

1644  
out
;

1645 
	}
}

1650 
	$¡c
(cÚ¡ 
SŒšg
& 
txt
, 
Ch¬aù”
 *
ch
)

1652 ià(
txt
.
	`em±y
(è|| 
ch
->
desc
 =ğ
nuÎ±r
)

1655 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
video_æags
.
	`has
(
VIDEO_CODES_SHOW
))

1656 
	`wr™e_to_bufãr
(
ch
->
desc
, 
txt
);

1657 ià(
ch
->
aù_æags
.
	`has
(
PLR_COLOR2
))

1658 
	`wr™e_to_bufãr
(
ch
->
desc
, 
	`ex·nd_cŞÜ_codes
(ch, 
txt
));

1660 
	`wr™e_to_bufãr
(
ch
->
desc
, 
txt
.
	`uncŞÜ
());

1661 
	}
}

1664 
	$show_¡ršg
(
DesütÜ
 *
d
, 
boŞ
 
ş—r_»mašd”
)

1667 ià(
ş—r_»mašd”
) {

1668 
d
->
show¡r_h—d
.
	`”a£
();

1672 
¡d
::
size_t
 
·ge_Ën
;

1675 ià(
d
->
ch¬aù”
) {

1676 
¡d
::
size_t
 
b»ak_pos
 = 
d
->
show¡r_h—d
.
	`fšd_Áh
(d->
ch¬aù”
->
lšes
, "\n");

1678 ià(
b»ak_pos
 =ğ
¡d
::
¡ršg
::
Åos
)

1679 
·ge_Ën
 = 
d
->
show¡r_h—d
.
	`size
();

1681 
·ge_Ën
 = 
b»ak_pos
 + 1;

1684 
·ge_Ën
 = 
d
->
show¡r_h—d
.
	`size
();

1686 
SŒšg
 
·ge
 = 
d
->
show¡r_h—d
.
	`sub¡r
(0, 
·ge_Ën
);

1687 
d
->
show¡r_h—d
.
	`”a£
(0, 
·ge_Ën
);

1689 ià(
d
->
ch¬aù”
)

1690 
	`¡c
(
·ge
, 
d
->
ch¬aù”
);

1692 
	`cwtb
(
d
, 
·ge
);

1693 
	}
}

1698 
	$·ge_to_ch¬
(cÚ¡ 
SŒšg
& 
txt
, 
Ch¬aù”
 *
ch
)

1700 ià(
txt
.
	`em±y
(è|| 
ch
->
desc
 =ğ
nuÎ±r
)

1703 
ch
->
desc
->
show¡r_h—d
 +ğ
txt
;

1704 
	`show_¡ršg
(
ch
->
desc
, 
çl£
);

1705 
	}
}

1707 
	$gÙo_lše
(
Ch¬aù”
 *
ch
, 
row
, 
cŞumn
)

1709 
buf
[
MAX_INPUT_LENGTH
];

1710 
FÜm©
::
	`¥rštf
(
buf
, "\033[%d;%dH", 
row
, 
cŞumn
);

1711 
	`¡c
(
buf
, 
ch
);

1712 
	}
}

1714 
	$ş—r_wšdow
(
Ch¬aù”
 *
ch
) {

1715 
	`¡c
(
VT_SETWIN_CLEAR
, 
ch
);

1716 
	}
}

1718 
	$£t_wšdow
(
Ch¬aù”
 *
ch
, 
tİ
, 
bÙtom
)

1720 
buf
[
MAX_INPUT_LENGTH
];

1721 
FÜm©
::
	`¥rštf
(
buf
, "\033[%d;%dr", 
tİ
, 
bÙtom
);

1722 
	`¡c
(
buf
, 
ch
);

1723 
	}
}

1725 
	$»£t_‹rmš®
(
Ch¬aù”
 *
ch
) {

1726 
	`¡c
(
VT_RESET_TERMINAL
, 
ch
);

1727 
	}
}

1729 *
	$g‘_muÉi_commªd
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
)

1731 *
pcom
;

1732 
pcom
 = 
commªd
;

1733 cÚ¡ *
¬g±r
 = 
¬gum’t
.
	`c_¡r
();

1735 *
¬g±r
 != '\0') {

1736 ià(
¬g±r
[0] == '|') {

1737 ià(*++
¬g±r
 != '|') {

1738 
	`¡rıy
(
d
->
šcomm
, 
¬g±r
);

1739 *
pcom
 = '\0';

1740  
commªd
;

1744 *
pcom
++ = *
¬g±r
++;

1747 *
pcom
 = '\0';

1748 
d
->
šcomm
[0] = '\0';

1749  
commªd
;

1750 
	}
}

1758 
	$do_cİyove
(
Ch¬aù”
 *
ch
)

1760 
	`±c
(
ch
, "You havtØ¥–ÈouˆCOPYOVER iàyou wªˆtØcİyov”. Sly %s.\n", ch->
Çme
);

1762 
	}
}

1764 
	$do_cİyov”
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1766 
FILE
 *
å
;

1767 
DesütÜ
 *
d
, *
d_Ãxt
;

1768 
SŒšg
 
buf
;

1769 
	`do_®l§ve
(
ch
, "");

1770 
	`§ve_şª_bË
();

1772 ià((
å
 = 
	`fİ’
(
COPYOVER_FILE
, "w")è=ğ
nuÎ±r
) {

1773 
	`¡c
("Cİyov” fnÙ wr™—bË,‡bÜ‹d.\n", 
ch
);

1774 
FÜm©
::
	`¥rštf
(
buf
, "Could‚Ù wr™tØcİyov” fe: %s", 
COPYOVER_FILE
);

1775 
Loggšg
::
	`log
(
buf
);

1776 
	`³¼Ü
("do_copyover:fopen");

1781 
d
 = 
desütÜ_li¡
; d; d = d->
Ãxt
) {

1782 
FÜm©
::
	`´štf
("found sock‘ %d, ho¡ %s\n", 
d
->
desütÜ
, d->
ho¡
);

1784 ià(
d
->
	`is_¶ayšg
()) {

1785 
Ch¬aù”
 *
och
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

1786 
	`Úe_¬gum’t
(
och
->
Çme
, 
buf
);

1787 
FÜm©
::
	`årštf
(
å
, "%d % %s\n", 
d
->
desütÜ
, 
buf
, d->
ho¡
);

1791 
FÜm©
::
	`årštf
(
å
, "-1\n");

1792 
	`fşo£
(
å
);

1794 ià((
å
 = 
	`fİ’
(
COPYOVER_LOG
, "w")è=ğ
nuÎ±r
) {

1795 
	`¡c
("Cİyov” fnÙ wr™—bË,‡bÜ‹d.\n", 
ch
);

1796 
FÜm©
::
	`¥rštf
(
buf
, "Could‚Ù wr™tØcİyov” fe: %s", 
COPYOVER_LOG
);

1797 
Loggšg
::
	`log
(
buf
);

1798 
	`³¼Ü
("do_copyover:fopen");

1802 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
ch
->
Çme
);

1803 
	`fşo£
(
å
);

1806 
	`obj¡©e_§ve_™ems
();

1811 ià(
ch
->
Çme
 == "Montrey") {

1812 
FÜm©
::
	`¥rštf
(
buf
, "\nA beam of…ure white†ight‡rcs down fromhe heavens, striking\n"

1817 ià(
ch
->
Çme
 == "Outsider") {

1818 
FÜm©
::
	`¥rštf
(
buf
, "\nAn‡ngel, clothed in white†ight,†ands before you. He stands\n"

1823 ià(
ch
->
Çme
 == "Xenith") {

1824 
FÜm©
::
	`¥rštf
(
buf
, "\nThe winds suddenly spring up,‡she storm destroyshe world.\n"

1828 ià(
ch
->
Çme
 == "Liriel") {

1829 
FÜm©
::
	`¥rštf
(
buf
, "\nAiny faerie shimmers intoƒxistence in front of you, it's magics quickly\n"

1833 ià(
ch
->
Çme
 == "Kenneth") {

1834 
FÜm©
::
	`¥rštf
(
buf
, "\nA casualap onhe shoulder causes youo spin‡round. Directly in front\n"

1838 
FÜm©
::
	`¥rštf
(
buf
, "\n*** COPYOVER by % -…Ëa£„emaš s—‹d!\n", 
ch
->
Çme
);

1841 
d
 = 
desütÜ_li¡
; d ; d = 
d_Ãxt
) {

1842 
Ch¬aù”
 *
och
;

1843 
d_Ãxt
 = 
d
->
Ãxt
;

1845 ià(
d
->
¡©e
 !ğ&
cÚn
::
S‹
::
¶ayšg
) {

1847 
FÜm©
::
	`´štf
("closing socket %d from host %s\n",

1848 
d
->
desütÜ
, d->
ho¡
);

1849 
	`wr™e_to_desütÜ
(
d
->
desütÜ
,

1852 
	`şo£_sock‘
(
d
);

1856 
och
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

1857 
FÜm©
::
	`´štf
("closing socket %d from char %s\n",

1858 
d
->
desütÜ
, 
och
->
Çme
);

1859 
	`§ve_ch¬_obj
(
och
);

1860 
	`wr™e_to_desütÜ
(
d
->
desütÜ
, 
buf
, 0);

1866 #ià
	`defšed
(
SAND
)

1867 
	`§nd_şo£
();

1870 
	`db_şo£
();

1873 
pÜtbuf
[
MSL
], 
cÚŒŞbuf
[MSL];

1874 
FÜm©
::
	`¥rštf
(
pÜtbuf
, "%d", 
Game
::
pÜt
);

1875 
FÜm©
::
	`¥rštf
(
cÚŒŞbuf
, "%d", 
cÚŒŞ
);

1876 
	`exeş
(
exe_fe
.
	`c_¡r
(),ƒxe_fe.c_¡r(), 
pÜtbuf
, "nuÎ", "cİyov”", 
cÚŒŞbuf
, "null", (*)0);

1878 
	`³¼Ü
("do_copyover:ƒxecl");

1879 
	`¡c
("Cİyov” FAILED!\n", 
ch
);

1880 
	}
}

	@src/config.cc

28 
	~<veùÜ
>

30 
	~"¬gum’t.hh
"

31 
	~"Ch¬aù”.hh
"

32 
	~"deş¬e.hh
"

33 
	~"FÏgs.hh
"

34 
	~"FÜm©.hh
"

35 
	~"Loggšg.hh
"

36 
	~"m”c.hh
"

37 
	~"PÏy”.hh
"

38 
	~"SŒšg.hh
"

39 
	~"bËs.hh
"

40 
	~"ty³Çme.hh
"

74 
	$cÚfig_cŞÜ_func
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
, 
ty³
)

76 
SŒšg
 
ty³¡r
;

77 
low
, 
high
, 
mod
, 
¦Ù
;

79 
ty³
) {

80 3: 
FÜm©
::
	`¥rštf
(
ty³¡r
, "chªÃl"); 
low
 = 0; 
high
 = 29; 
mod
 = 1; ;

81 4: 
FÜm©
::
	`¥rštf
(
ty³¡r
, "scÜe"); 
low
 = 50; 
high
 = 79; 
mod
 = -49; ;

82 5: 
FÜm©
::
	`¥rštf
(
ty³¡r
, "misûÎªeous"); 
low
 = 80; 
high
 = 99; 
mod
 = -79; ;

84 
Loggšg
::
	`bug
("cÚfig_cŞÜ_func: bady³ %d", 
ty³
);

88 ià(
¬gum’t
.
	`em±y
()) {

89 
	`¡c
("U£hcŞÜ‚amÜ '»£t'‡á”‡ÀİtiÚØmodify.\n", 
ch
);

90 
	`±c
(
ch
, "% cŞÜ s‘tšgs:\n\n", 
ty³¡r
.
	`ÿp™®ize
());

92 
¦Ù
 = 
low
; slÙ < 
high
; slot++) {

93 ià(
c£‰šg_bË
[
¦Ù
].
Çme
.
	`em±y
())

96 ià(
ty³
 == 3

97 && ((
¦Ù
 =ğ
CSLOT_CHAN_CLAN
 && !
ch
->
şª
 && !
	`IS_IMMORTAL
(ch))

98 || (
¦Ù
 =ğ
CSLOT_CHAN_SPOUSE
 && !
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_MARRIED
))

99 || (
¦Ù
 =ğ
CSLOT_CHAN_IMM
 && !
	`IS_IMMORTAL
(
ch
))))

102 
	`Ãw_cŞÜ
(
ch
, 
¦Ù
);

103 
	`±c
(
ch
, " {g%2d.{x %-43s%-s\n",

104 
¦Ù
 + 
mod
, 
c£‰šg_bË
[¦Ù].
Çme
, 
	`g‘_cu¡om_cŞÜ_Çme
(
ch
, slot));

107 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

111 
SŒšg
 
¬g1
, 
¬g2
;

112 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

113 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g2
);

115 ià(
¬g1
.
	`is_numb”
())

116 
¦Ù
 = 
	`©oi
(
¬g1
è- 
mod
;

118 
¦Ù
 = 
low
; slÙ < 
high
; slot++) {

119 ià(
c£‰šg_bË
[
¦Ù
].
Çme
.
	`em±y
())

122 ià(
ty³
 == 3

123 && ((
¦Ù
 =ğ
CSLOT_CHAN_CLAN
 && !
ch
->
şª
 && !
	`IS_IMMORTAL
(ch))

124 || (
¦Ù
 =ğ
CSLOT_CHAN_SPOUSE
 && !
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_MARRIED
))

125 || (
¦Ù
 =ğ
CSLOT_CHAN_IMM
 && !
	`IS_IMMORTAL
(
ch
))))

128 ià(
¬g1
.
	`is_´efix_of
(
c£‰šg_bË
[
¦Ù
].
Çme
))

132 ià(
c£‰šg_bË
[
¦Ù
].
Çme
.
	`em±y
(è|| slÙ > 
high
 || slÙ < 
low
) {

133 
	`±c
(
ch
, "That is‚ot‡ valid %s. Type 'config color %s' for‡†ist.\n",

134 
ty³
 =ğ3 ? "chªÃl" : "™em", 
ty³¡r
);

138 ià(
¬g2
 == "reset") {

139 
ch
->
pcd©a
->
cŞÜ
[
¦Ù
] = 0;

140 
ch
->
pcd©a
->
bŞd
 [
¦Ù
] = 0;

141 
	`¡c
("You¸£‰šg ha b“À»¡ÜedØthdeçuÉ cŞÜ.\n", 
ch
);

145 
i
;

146 
i
 = 0; i < 
cŞÜ_bË
.
	`size
(); i++)

147 ià(
¬g2
.
	`is_´efix_of
(
cŞÜ_bË
[
i
].
Çme
))

150 ià(
i
 >ğ
cŞÜ_bË
.
	`size
()) {

151 
	`¡c
("Th© i nÙ‡ cŞÜ‚ame. Ty³ 'ùe¡' fÜ‡†i¡.\n", 
ch
);

155 
ch
->
pcd©a
->
cŞÜ
[
¦Ù
] = 
cŞÜ_bË
[
i
].color;

156 
ch
->
pcd©a
->
bŞd
 [
¦Ù
] = 
cŞÜ_bË
[
i
].bold;

157 
	`£t_cŞÜ
(
ch
, 
cŞÜ_bË
[
i
].
cŞÜ
, cŞÜ_bË[i].
bŞd
);

158 
	`¡c
("CŞÜ s‘Øyou¸¥ecifiÿtiÚ! =)\n", 
ch
);

159 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

160 
	}
}

162 
	$cÚfig_cŞÜ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

164 
¬gnum
 = 0;

166 ià(
¬gum’t
.
	`em±y
()) {

167 
	`¡c
("U£ 'h–p' o¸'?'‡ ª‡rgum’ˆaá”‡ny o±iÚ fÜ d‘as.\n", 
ch
);

168 
	`¡c
("CŞÜ o±iÚs:\n\n", 
ch
);

169 
	`±c
(
ch
, " 1. Color %s\n",

170 
ch
->
aù_æags
.
	`has
(
PLR_COLOR
) ? "{CON{x" : "{POFF{x");

171 
	`±c
(
ch
, " 2. Crazy Color %s\n",

172 
ch
->
aù_æags
.
	`has
(
PLR_COLOR2
) ? "{CON{x" : "{POFF{x");

173 
	`¡c
(" 3. ChªÃls\n", 
ch
);

174 
	`¡c
(" 4. ScÜe\n", 
ch
);

175 
	`¡c
(" 5. MisûÎªeous\n", 
ch
);

176 
	`¡c
(" 6. Re£t\n", 
ch
);

180 
SŒšg
 
¬g1
;

181 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

183 ià(
¬g1
.
	`is_´efix_of
("help") ||‡rg1 == "?") {

184 
	`¡c
("Config color‡llows youo specifyhe what color options you\n"

187 "ªd oth”s. U£ w™houˆª‡rgum’ˆtØ£¨li¡ oàİtiÚs.\n", 
ch
);

191 ià(
¬g1
.
	`is_numb”
()è
¬gnum
 = 
	`©oi
(arg1);

192 ià(
¬g1
.
	`is_´efix_of
("cŞÜ")è
¬gnum
 = 1;

193 ià(
¬g1
.
	`is_´efix_of
("üazy")è
¬gnum
 = 2;

194 ià(
¬g1
.
	`is_´efix_of
("chªÃls")è
¬gnum
 = 3;

195 ià(
¬g1
.
	`is_´efix_of
("scÜe")è
¬gnum
 = 4;

196 ià(
¬g1
.
	`is_´efix_of
("misûÎªeous")è
¬gnum
 = 5;

197 ià(
¬g1
.
	`is_´efix_of
("»£t")è
¬gnum
 = 6;

199 
¬gnum
) {

203 ià(
¬gum’t
.
	`is_´efix_of
("help") ||‡rgument == "?")

204 
	`¡c
("Thi toggË cŞÜ oÀÜ off.\n", 
ch
);

205 ià(
¬gum’t
.
	`em±y
()) {

206 ià(
ch
->
aù_æags
.
	`has
(
PLR_COLOR
)) {

207 
	`¡c
("You s“hšg š ", 
ch
);

208 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

209 
	`¡c
("BLACK‡nd ", 
ch
);

210 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
BOLD
);

211 
	`¡c
("WHITE.\n", 
ch
);

212 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

213 
ch
->
aù_æags
 -ğ
PLR_COLOR
;

214 
ch
->
aù_æags
 -ğ
PLR_COLOR2
;

217 
ch
->
aù_æags
 +ğ
PLR_COLOR
;

218 
ch
->
aù_æags
 +ğ
PLR_COLOR2
;

219 
	`¡c
("{TYou {H£{bthšg {Nš {Mmªy {YC{GO{PL{BO{VR{CS{Y!{x\n", 
ch
);

223 
	`¡c
("V®id o±iÚ ¬{Ph–p{x‡nd‚Ø¬gum’ˆÑoggË).\n", 
ch
);

228 ià(
¬gum’t
.
	`is_´efix_of
("help") ||‡rgument == "?")

229 
	`¡c
("Thisoggles crazy color on or off. Crazy color is‡ feature\n"

232 "nÜm® o¸cŞÜedØyou.\n", 
ch
);

233 ià(
¬gum’t
.
	`em±y
()) {

234 ià(
ch
->
aù_æags
.
	`has
(
PLR_COLOR2
)) {

235 
ch
->
aù_æags
 -ğ
PLR_COLOR2
;

236 
	`¡c
("C¿zy CŞÜ Di§bËd =(\n", 
ch
);

239 
ch
->
aù_æags
 +ğ
PLR_COLOR2
;

240 
	`¡c
("C¿zy CŞÜ EÇbËd!!! Y—!! =)\n", 
ch
);

244 
	`¡c
("V®id o±iÚ ¬{Ph–p{x‡nd‚Ø¬gum’ˆÑoggË).\n", 
ch
);

251 
	`cÚfig_cŞÜ_func
(
ch
, 
¬gum’t
, 
¬gnum
);

255 ià(!
¬gum’t
.
	`em±y
())

256 
	`¡c
("This option, without‡n‡rgument, will„eset your…ersonal color\n"

257 "£‰šg tØtheœ deçuÉ scheme.\n", 
ch
);

259 
i
;

261 
i
 = 0; i < 
MAX_COLORS
; i++) {

262 
ch
->
pcd©a
->
cŞÜ
[
i
] = 0;

263 
ch
->
pcd©a
->
bŞd
[
i
] = 0;

266 
	`¡c
("DeçuÉ cŞÜ e¡ablished.\n", 
ch
);

272 
	`¡c
("Th© i nÙ‡ v®id cŞÜ o±iÚ.\n", 
ch
);

273 
	}
}

275 
	$cÚfig_video
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

277 
¬gnum
 = 0;

279 ià(
¬gum’t
.
	`em±y
()) {

280 
	`¡c
("U£ 'h–p' o¸'?'‡ ª‡rgum’ˆaá”‡ny o±iÚ fÜ d‘as.\n", 
ch
);

281 
	`¡c
("VideØİtiÚs:\n\n", 
ch
);

282 
	`±c
(
ch
, " 1. Flash %s\n",

283 
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_FLASH_OFF
) ?

284 
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_FLASH_LINE
) ?

286 
	`±c
(
ch
, " 2. Dark %s\n",

287 
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_DARK_MOD
) ? "{CON{x" : "{POFF{x");

288 
	`±c
(
ch
, " 3. Codes %s\n",

289 
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_CODES_SHOW
) ? "{CON{x" : "{POFF{x");

290 
	`±c
(
ch
, " 4. VT100 %s\n",

291 
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_VT100
) ? "{CON{x" : "{POFF{x");

295 
SŒšg
 
¬g1
;

296 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

298 ià(
¬g1
.
	`is_´efix_of
("help") ||‡rg1 == "?") {

299 
	`¡c
("With config video, you can set your video options, determining\n"

301 "tØyou. U£ w™houˆª‡rgum’ˆfÜ‡†i¡ oàİtiÚs.\n", 
ch
);

305 ià(
¬g1
.
	`is_numb”
()è
¬gnum
 = 
	`©oi
(arg1);

306 ià(
¬g1
.
	`is_´efix_of
("æash")è
¬gnum
 = 1;

307 ià(
¬g1
.
	`is_´efix_of
("d¬k")è
¬gnum
 = 2;

308 ià(
¬g1
.
	`is_´efix_of
("codes")è
¬gnum
 = 3;

309 ià(
¬g1
.
	`is_´efix_of
("vt100")è
¬gnum
 = 4;

311 
¬gnum
) {

315 ià(
¬gum’t
.
	`is_´efix_of
("help") ||‡rgument == "?")

316 
	`¡c
("Video flash controls how flashingext will‡ppear on your\n"

320 "sü“ÀemuÏtÜ.\n", 
ch
);

321 ià(
¬gum’t
.
	`is_´efix_of
("underline")) {

322 ià(
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_FLASH_LINE
)) {

323 
ch
->
pcd©a
->
video_æags
 -ğ
VIDEO_FLASH_LINE
;

324 
	`¡c
("FÏshšgexˆwÈnØlÚg” bcÚv”‹dØund”lšed.\n", 
ch
);

327 
ch
->
pcd©a
->
video_æags
 +ğ
VIDEO_FLASH_OFF
;

328 
ch
->
pcd©a
->
video_æags
 +ğ
VIDEO_FLASH_LINE
;

329 
	`¡c
("FÏshšgexˆshould‚ow†ook {fund”lšed{xØyou!\n", 
ch
);

332 ià(
¬gum’t
.
	`em±y
()) {

333 ià(
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_FLASH_LINE
)) {

334 
ch
->
pcd©a
->
video_æags
 -ğ
VIDEO_FLASH_LINE
;

335 
	`¡c
("FÏshšgexˆwÈnØlÚg” bcÚv”‹dØund”lšed.\n", 
ch
);

337 ià(
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_FLASH_OFF
)) {

338 
ch
->
pcd©a
->
video_æags
 -ğ
VIDEO_FLASH_OFF
;

339 
	`¡c
("You cª‚ow s“ {fæashšg{xext!\n", 
ch
);

342 
ch
->
pcd©a
->
video_æags
 +ğ
VIDEO_FLASH_OFF
;

343 
	`¡c
("FÏshšgexˆnow hŞd ¡ÈfÜ you.\n", 
ch
);

347 
	`¡c
("V®id o±iÚ ¬{Ph–p{x, {Pund”lše{x,‡nd‚Ø¬gum’ˆÑoggË).\n", 
ch
);

352 ià(
¬gum’t
.
	`is_´efix_of
("help") ||‡rgument == "?")

353 
	`¡c
("Video darkoggles whether or‚ot charcoal‡nd blackext‡re\n"

354 "cÚv”‹dØg»y.", 
ch
);

356 ià(
¬gum’t
.
	`is_´efix_of
("modify")

357 || (
¬gum’t
.
	`em±y
(è&& !
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_DARK_MOD
))) {

358 
ch
->
pcd©a
->
video_æags
 +ğ
VIDEO_DARK_MOD
;

359 
	`¡c
("You cª‚ow s“ {cch¬cßl{x‡nd {kbÏck{x!\n", 
ch
);

361 ià(
¬gum’t
.
	`is_´efix_of
("normal")

362 || (
¬gum’t
.
	`em±y
(è&& 
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_DARK_MOD
))) {

363 
ch
->
pcd©a
->
video_æags
 -ğ
VIDEO_DARK_MOD
;

364 
	`¡c
("Cª you stÈ£{cch¬cßl{x‡nd {kbÏck{x?\n", 
ch
);

367 
	`¡c
("V®id o±iÚ ¬{Ph–p{x‡nd‚Ø¬gum’ˆÑoggË).\n", 
ch
);

372 ià(
¬gum’t
.
	`is_´efix_of
("help") ||‡rgument == "?")

373 
	`¡c
("Video codesoggles whether color codes ({{)‡re shown ({CON{x)\n"

374 "Ü cÚv”‹d iÁØcŞÜ ({POFF{x).\n", 
ch
);

376 ià(
¬gum’t
.
	`is_´efix_of
("show")

377 || (
¬gum’t
.
	`em±y
(è&& !
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_CODES_SHOW
))) {

378 
ch
->
pcd©a
->
video_æags
 +ğ
VIDEO_CODES_SHOW
;

379 
	`¡c
("{RCŞÜ{x {Ccodes{x wÈnow bshown.\n", 
ch
);

381 ià(
¬gum’t
.
	`is_´efix_of
("hide")

382 || (
¬gum’t
.
	`em±y
(è&& 
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_CODES_SHOW
))) {

383 
ch
->
pcd©a
->
video_æags
 -ğ
VIDEO_CODES_SHOW
;

384 
	`¡c
("You s“‚ØmÜ{RcŞÜ{x {Ccodes{x.\n", 
ch
);

387 
	`¡c
("V®id o±iÚ ¬{Ph–p{x‡nd‚Ø¬gum’ˆÑoggË).\n", 
ch
);

392 ià(
¬gum’t
.
	`is_´efix_of
("help") ||‡rgument == "?")

393 
	`¡c
("Video VT100ƒmulation mode†ookserrible if you do‚ot have\n"

394 "¨VT100, sØÚly u£ iˆiàyou mu¡.\n", 
ch
);

395 ià(
¬gum’t
.
	`em±y
()) {

396 ià(
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_VT100
)) {

397 
ch
->
pcd©a
->
video_æags
 -ğ
VIDEO_VT100
;

398 
	`¡c
("VT100 modoff.\n", 
ch
);

401 
	`¡c
("VT100 modÚ. Ty³ {RcÚfig videØvt100{x iàyou¸sü“ÀgÛ süewy.\n", 
ch
);

402 
ch
->
pcd©a
->
video_æags
 +ğ
VIDEO_VT100
;

406 
	`¡c
("V®id o±iÚ ¬{Ph–p{x‡nd‚Ø¬gum’ˆÑoggË).\n", 
ch
);

411 
	`¡c
("Th© i nÙ‡ v®id videØİtiÚ.\n", 
ch
);

412 
	}
}

414 
	$cÚfig_ûnsÜ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

416 
¬gnum
 = 0;

418 ià(
¬gum’t
.
	`em±y
()) {

419 
	`¡c
("U£ 'h–p' o¸'?'‡ ª‡rgum’ˆaá”‡ny o±iÚ fÜ d‘as.\n", 
ch
);

420 
	`¡c
("C’sÜ o±iÚs:\n\n", 
ch
);

421 
	`±c
(
ch
, " 1. Channels %s\n",

422 
ch
->
ûnsÜ_æags
.
	`has
(
CENSOR_CHAN
) ? "{CON{x" : "{POFF{x");

423 
	`±c
(
ch
, " 2. Spam %s\n",

424 
ch
->
ûnsÜ_æags
.
	`has
(
CENSOR_SPAM
) ? "{CON{x" : "{POFF{x");

428 
SŒšg
 
¬g1
;

429 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

431 ià(
¬g1
.
	`is_´efix_of
("help") ||‡rg1 == "?") {

432 
	`¡c
("Censor‡llows…layerso specifyheir censorship settings,o\n"

434 "¬gum’ˆtØ£¨l™ oàİtiÚs.\n", 
ch
);

438 ià(
¬g1
.
	`is_numb”
()è
¬gnum
 = 
	`©oi
(arg1);

439 ià(
¬g1
.
	`is_´efix_of
("chªÃls")è
¬gnum
 = 1;

440 ià(
¬g1
.
	`is_´efix_of
("¥am")è
¬gnum
 = 2;

442 
¬gnum
) {

446 ià(
¬gum’t
.
	`is_´efix_of
("help") ||‡rgument == "?")

447 
	`¡c
("Censor channels filters channel communicationshat have‡ word\n"

453 "İtiÚ‡Îow youØ£ªd u£hFLAME chªÃl.\n", 
ch
);

454 ià(
¬gum’t
.
	`is_´efix_of
("list")) {

455 *cÚ¡ 
sw—r
 [] = {

460 
nuÎ±r


462 
x
;

464 
x
 = 0; 
sw—r
[x] !ğ
nuÎ±r
; x++) {

465 
	`±c
(
ch
, "%15s", 
sw—r
[
x
]);

467 ià(
x
 % 4 == 3)

468 
	`¡c
("\n", 
ch
);

471 ià(
x
 % 4 != 3)

472 
	`¡c
("\n", 
ch
);

474 ià(
¬gum’t
.
	`em±y
()) {

475 ià(
ch
->
ûnsÜ_æags
.
	`has
(
CENSOR_CHAN
)) {

476 
ch
->
ûnsÜ_æags
 -ğ
CENSOR_CHAN
;

477 
	`¡c
("{BL{Ce{gg{Wa{Cc{By{x i now„©ed {PR{x.\n", 
ch
);

480 
ch
->
ûnsÜ_æags
 +ğ
CENSOR_CHAN
;

481 
	`¡c
("{BL{Ce{gg{Wa{Cc{By{x i now„©ed {GPG{x.\n", 
ch
);

485 
	`¡c
("V®id o±iÚ ¬{Ph–p{x, {Pli¡{x,‡nd‚Ø¬gum’ˆÑoggË).\n", 
ch
);

490 ià(
¬gum’t
.
	`is_´efix_of
("help") ||‡rgument == "?")

491 
	`¡c
("The spam censoroggles whether or‚ot you will see‚otes\n"

494 "®lowed und”‡ny cœcum¡ªû.\n", 
ch
);

495 ià(
¬gum’t
.
	`em±y
()) {

496 ià(
ch
->
ûnsÜ_æags
.
	`has
(
CENSOR_SPAM
)) {

497 
ch
->
ûnsÜ_æags
 -ğ
CENSOR_SPAM
;

498 
	`¡c
("{BL{Ce{gg{Wa{Cc{By{x i now {GSPAMMY{x!\n", 
ch
);

501 
ch
->
ûnsÜ_æags
 +ğ
CENSOR_SPAM
;

502 
	`¡c
("{BL{Ce{gg{Wa{Cc{By{x i £ˆtØ{YLow F© SPAM{x.\n", 
ch
);

506 
	`¡c
("V®id o±iÚ ¬{Ph–p{x‡nd‚Ø¬gum’ˆÑoggË).\n", 
ch
);

511 
	`¡c
("Th© i nÙ‡ v®id c’sÜ o±iÚ.\n", 
ch
);

512 
	}
}

514 
	$cÚfig_immÜl
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

516 
¬gnum
 = 0;

518 ià(
¬gum’t
.
	`em±y
()) {

519 
	`¡c
("U£ 'h–p' o¸'?'‡ ª‡rgum’ˆaá”‡ny o±iÚ fÜ d‘as.\n", 
ch
);

520 
	`¡c
("ImmÜÈİtiÚs:\n\n", 
ch
);

521 
	`±c
(
ch
, " 1. Immprefix %s\n",

522 !
ch
->
pcd©a
->
imm´efix
.
	`em±y
() ? ch->pcdata->immprefix : "(none)");

523 
	`±c
(
ch
, " 2. Immname %s\n",

524 !
ch
->
pcd©a
->
immÇme
.
	`em±y
() ? ch->pcdata->immname : "(none)");

528 
SŒšg
 
¬g1
;

529 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

531 ià(
¬g1
.
	`is_´efix_of
("help") ||‡rg1 == "?") {

532 
	`¡c
("Various configuration options‡re‡vailable onlyohe Legacy\n"

533 "¡aff. U£ w™houˆª‡rgum’ˆtØ£¨l™ oàİtiÚs.\n", 
ch
);

537 ià(
¬g1
.
	`is_numb”
()è
¬gnum
 = 
	`©oi
(arg1);

538 ià(
¬g1
.
	`is_´efix_of
("imm´efix")è
¬gnum
 = 1;

539 ià(
¬g1
.
	`is_´efix_of
("immÇme")è
¬gnum
 = 2;

541 
¬gnum
) {

545 ià(
¬gum’t
 == "help" ||‡rgument == "?")

546 
	`¡c
("Your immprefix is what‡ppears‡the beginning ofƒach immtalk\n"

547 "lše. Iˆmu¡ inşudyou¸Çme. U£ 'nÚe' fÜhdeçuÉ.\n", 
ch
);

548 ià(
¬gum’t
.
	`em±y
())

549 
	`±c
(
ch
, "Your immtalk…refix is currently: %s{x\n",

550 !
ch
->
pcd©a
->
imm´efix
.
	`em±y
() ? ch->pcdata->immprefix : "(none)");

551 ià(
¬gum’t
 == "none") {

552 
ch
->
pcd©a
->
imm´efix
.
	`”a£
();

553 
	`¡c
("You¸immlk…»fix ha b“À»moved.\n", 
ch
);

556 
buf
[
MIL
];

557 
	`¡rıy
(
buf
, 
¬gum’t
.
	`uncŞÜ
());

559 ià(
	`¡¾’
(
buf
) > 30)

560 
	`¡c
("You¸immlk…»fix cª bnØlÚg”hª 30…rš‹d ch¬aù”s.\n", 
ch
);

561 ià(!
	`¡r¡r
(
buf
, 
ch
->
Çme
))

562 
	`¡c
("You¸immlk…»fix mu¡ inşudyou¸Çme.\n", 
ch
);

564 
ch
->
pcd©a
->
imm´efix
 = 
¬gum’t
;

565 
	`±c
(
ch
, "You¸immlk…»fix i now: %s{x\n", ch->
pcd©a
->
imm´efix
);

572 ià(
¬gum’t
 == "help" ||‡rgument == "?")

573 
	`¡c
("Your immname is what‡ppears inhe WHO†ist in…lace of‡…layer's\n"

574 "¿û, cÏss,‡nd†ev–. U£ 'nÚe' fÜhdeçuÉ.\n", 
ch
);

575 ià(
¬gum’t
.
	`em±y
())

576 
	`±c
(
ch
, "Your immname is currently: %s{x\n",

577 !
ch
->
pcd©a
->
immÇme
.
	`em±y
() ? ch->pcdata->immname : "(none)");

578 ià(
¬gum’t
 == "none") {

579 
ch
->
pcd©a
->
immÇme
.
	`”a£
();

580 
	`¡c
("You¸immÇmha b“À»moved.\n", 
ch
);

583 ià(
	`¡¾’
(
¬gum’t
.
	`uncŞÜ
()) > 15)

584 
	`±c
(
ch
, "Your immname can be‚o†ongerhan %d…rinted characters.\n", 15);

586 
ch
->
pcd©a
->
immÇme
 = 
¬gum’t
;

587 
	`±c
(
ch
, "You¸immÇmi now: %s{x\n", ch->
pcd©a
->
immÇme
);

594 
	`¡c
("Th© i nÙ‡ v®id immÜÈcÚfigu¿tiÚ o±iÚ.\n", 
ch
);

595 
	}
}

597 
	$cÚfig_wizÃt
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

599 
¬gnum
 = -1;

601 
SŒšg
 
¬g1
;

602 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

604 ià(
¬g1
.
	`is_´efix_of
("help") ||‡rg1 == "?") {

605 
	`¡c
("This‡llows youo specify your wiznet options. Turning options\n"

607 "U£ w™houˆª‡rgum’ˆtØ£¨li¡ oàwizÃˆæags.\n", 
ch
);

612 ià(
¬g1
 == "on") {

613 
	`¡c
("W–comtØWizÃt!\n", 
ch
);

614 
ch
->
wizÃt_æags
 +ğ
WIZ_ON
;

617 ià(
¬g1
 == "off") {

618 
	`¡c
("You havnow sigÃd ofàWizÃt.\n", 
ch
);

619 
ch
->
wizÃt_æags
 -ğ
WIZ_ON
;

623 ià(
¬g1
.
	`em±y
(è||‡rg1.
	`is_´efix_of
("status")) {

624 
	`¡c
("U£ 'h–p' o¸'?'‡ ª‡rgum’ˆaá”‡ny o±iÚ fÜ d‘as.\n", 
ch
);

625 
	`¡c
("S³cŸÈfÜ WizÃt: {CÚ{x, {Coff{x, {C¡©us{x, {Cshow{x\n", 
ch
);

626 
	`¡c
("WizÃˆİtiÚs:\n\n", 
ch
);

628 
æag
 = 0; fÏg < 
wizÃt_bË
.
	`size
(); flag++)

629 ià(
	`GET_RANK
(
ch
è>ğ
wizÃt_bË
[
æag
].
Ëv–
)

630 
	`±c
(
ch
, " %2d. %-15s({Y%4s{x) %s\n",

631 
æag
, 
wizÃt_bË
[æag].
Çme
.
	`ÿp™®ize
(),

632 
wizÃt_bË
[
æag
].
Ëv–
 =ğ
IMM
 ? "Imm" :

633 
wizÃt_bË
[
æag
].
Ëv–
 =ğ
HED
 ? "Head" : "Imp",

634 
ch
->
wizÃt_æags
.
	`has
(
wizÃt_bË
[
æag
].flag) ?

641 ià(
¬g1
.
	`is_´efix_of
("show")) {

642 
	`¡c
("U£ 'h–p' o¸'?'‡ ª‡rgum’ˆaá”‡ny o±iÚ fÜ d‘as.\n", 
ch
);

643 
	`¡c
("S³cŸÈfÜ WizÃt: {CÚ{x, {Coff{x, {C¡©us{x, {Cshow{x\n", 
ch
);

644 
	`¡c
("WizÃˆİtiÚs:\n\n", 
ch
);

646 cÚ¡‡uto& 
’Œy
 : 
wizÃt_bË
)

647 ià(
	`GET_RANK
(
ch
è>ğ
’Œy
.
Ëv–
)

648 
	`±c
(
ch
, "%-10 - %s\n", 
’Œy
.
Çme
,ƒÁry.
desc
);

653 ià(
¬g1
.
	`is_numb”
()) {

654 ià(()
	`©oi
(
¬g1
è< 
wizÃt_bË
.
	`size
())

655 
¬gnum
 = 
	`©oi
(
¬g1
);

658 
æag
 = 0; fÏg < 
wizÃt_bË
.
	`size
(); flag++)

659 ià(
¬g1
.
	`is_´efix_of
(
wizÃt_bË
[
æag
].
Çme
))

660 
¬gnum
 = 
æag
;

662 ià(
¬gnum
 >= 0)

663 ià(
	`GET_RANK
(
ch
è< 
wizÃt_bË
[
¬gnum
].
Ëv–
)

664 
¬gnum
 = -1;

666 ià(
¬gnum
 < 0) {

667 
	`¡c
("Th© i nÙ‡ v®id wizÃˆİtiÚ.\n", 
ch
);

671 ià(
¬gum’t
.
	`is_´efix_of
("help") ||‡rgument == "?")

672 
	`±c
(
ch
, "%s\n", 
wizÃt_bË
[
¬gnum
].
desc
);

673 ià(
¬gum’t
.
	`em±y
()) {

674 ià(
¬gnum
 == 0) {

675 ià(
ch
->
wizÃt_æags
.
	`has
(
wizÃt_bË
[
¬gnum
].
æag
)) {

676 
	`¡c
("You havnow sigÃd ofàWizÃt.\n", 
ch
);

677 
ch
->
wizÃt_æags
 -ğ
wizÃt_bË
[
¬gnum
].
æag
;

680 
	`¡c
("W–comtØWizÃt!\n", 
ch
);

681 
ch
->
wizÃt_æags
 +ğ
wizÃt_bË
[
¬gnum
].
æag
;

685 ià(
ch
->
wizÃt_æags
.
	`has
(
wizÃt_bË
[
¬gnum
].
æag
)) {

686 
ch
->
wizÃt_æags
 -ğ
wizÃt_bË
[
¬gnum
].
æag
;

687 
	`±c
(
ch
, "WizÃˆwÈnØlÚg”…rovidyou w™h: %s\n", 
wizÃt_bË
[
¬gnum
].
Çme
);

690 
ch
->
wizÃt_æags
 +ğ
wizÃt_bË
[
¬gnum
].
æag
;

691 
	`±c
(
ch
, "WizÃˆwÈnow…rovidyou w™h: %s\n", 
wizÃt_bË
[
¬gnum
].
Çme
);

696 
	`¡c
("V®id o±iÚ ¬{Ph–p{x‡nd‚Ø¬gum’ˆÑoggË).\n", 
ch
);

697 
	}
}

699 
	$do_cÚfig
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

701 
¬gnum
 = 0;

703 ià(
¬gum’t
.
	`em±y
()) {

704 
	`¡c
("CÚfigu¿tiÚ groups:\n\n", 
ch
);

707 ià(!
ch
->
	`is_Åc
()) {

708 
	`¡c
(" 5. CŞÜ\n", 
ch
);

709 
	`¡c
(" 6. Video\n", 
ch
);

712 
	`¡c
(" 7. C’sÜ\n", 
ch
);

714 ià(
	`IS_IMMORTAL
(
ch
)) {

715 
	`¡c
(" 8. ImmÜl\n", 
ch
);

716 
	`¡c
(" 9. WizÃt\n", 
ch
);

722 
SŒšg
 
¬g1
;

723 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

725 ià(
¬g1
.
	`is_numb”
()è
¬gnum
 = 
	`©oi
(arg1);

726 ià(
¬g1
.
	`is_´efix_of
("chªÃls")è
¬gnum
 = 1;

727 ià(!
ch
->
	`is_Åc
(è&& 
¬g1
.
	`is_´efix_of
("cŞÜ")è
¬gnum
 = 5;

728 ià(!
ch
->
	`is_Åc
(è&& 
¬g1
.
	`is_´efix_of
("video")è
¬gnum
 = 6;

729 ià(
¬g1
.
	`is_´efix_of
("ûnsÜ")è
¬gnum
 = 7;

730 ià(
	`IS_IMMORTAL
(
ch
è&& 
¬g1
.
	`is_´efix_of
("immÜl")è
¬gnum
 = 8;

731 ià(
	`IS_IMMORTAL
(
ch
è&& 
¬g1
.
	`is_´efix_of
("wizÃt")è
¬gnum
 = 9;

733 
¬gnum
) {

737 5: 
	`cÚfig_cŞÜ
(
ch
, 
¬gum’t
); ;

739 6: 
	`cÚfig_video
(
ch
, 
¬gum’t
); ;

741 7: 
	`cÚfig_ûnsÜ
(
ch
, 
¬gum’t
); ;

743 8: 
	`cÚfig_immÜl
(
ch
, 
¬gum’t
); ;

744 9: 
	`cÚfig_wizÃt
(
ch
, 
¬gum’t
); ;

747 
	`¡c
("Th© i nÙ‡ v®id cÚfigu¿tiÚ o±iÚ.\n", 
ch
);

748 
	}
}

754 
	$do_cŞÜ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

756 
buf
[
MIL
];

758 ià(
ch
->
	`is_Åc
()) {

759 
	`¡c
("Mobe ÿn'ˆ£cŞÜs. :)\n", 
ch
);

763 ià(
¬gum’t
.
	`em±y
())

764 
	`do_cÚfig
(
ch
, "color color");

766 
FÜm©
::
	`¥rštf
(
buf
, "cŞÜ %s", 
¬gum’t
);

767 
	`do_cÚfig
(
ch
, 
buf
);

769 
	}
}

771 
	$do_video
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

773 
buf
[
MIL
];

775 ià(
ch
->
	`is_Åc
()) {

776 
	`¡c
("Mobe ÿn'ˆ£cŞÜ ªyway. :)\n", 
ch
);

780 
FÜm©
::
	`¥rštf
(
buf
, "videØ%s", 
¬gum’t
);

781 
	`do_cÚfig
(
ch
, 
buf
);

782 
	}
}

784 
	$do_ûnsÜ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

786 
buf
[
MIL
];

787 
FÜm©
::
	`¥rštf
(
buf
, "ûnsÜ %s", 
¬gum’t
);

788 
	`do_cÚfig
(
ch
, 
buf
);

789 
	}
}

791 
	$do_wizÃt
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

793 
buf
[
MIL
];

795 ià(
ch
->
	`is_Åc
()) {

796 
	`¡c
("Tšy mobb¿š would ov”lßd w™hhpow” oàWizÃt.\n", 
ch
);

800 ià(
¬gum’t
.
	`em±y
())

801 
	`do_cÚfig
(
ch
, "wiznet wiznet");

803 
FÜm©
::
	`¥rštf
(
buf
, "wizÃˆ%s", 
¬gum’t
);

804 
	`do_cÚfig
(
ch
, 
buf
);

806 
	}
}

	@src/conn/BreakConnectState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"comm.hh
"

7 
Çme¥aû
 
	gcÚn
 {

9 
boŞ
 
©‹m±_»cÚÃù
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
Çme
);

11 
S‹
 * 
	gB»akCÚÃùS‹
::

12 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

13 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

14 
DesütÜ
 *
	gd_Şd
, *
	gd_Ãxt
;

16 
	g¬gum’t
[0]) {

19 
d_Şd
 = 
desütÜ_li¡
; 
	gd_Şd
 !ğ
nuÎ±r
; d_Şd = 
d_Ãxt
) {

20 
d_Ãxt
 = 
d_Şd
->
Ãxt
;

22 ià(
	gd_Şd
 =ğ
d
 || 
d_Şd
->
ch¬aù”
 =ğ
nuÎ±r
)

25 ià(
	gch
->
	gÇme
 !ğ(
d_Şd
->
Üigš®
 ?

26 
d_Şd
->
Üigš®
->
Çme
 : d_Şd->
ch¬aù”
->name))

29 
şo£_sock‘
(
d_Şd
);

32 ià(
©‹m±_»cÚÃù
(
d
, 
ch
->
Çme
))

33  &
	gS‹
::
¶ayšg
;

35 
±c
(
ch
, "Reconnect‡ttempt failed.\nName: ");

37 ià(
	gd
->
	gch¬aù”
 !ğ
nuÎ±r
) {

38 
d–‘e
 
d
->
ch¬aù”
;

39 
	gd
->
	gch¬aù”
 = 
nuÎ±r
;

42  &
	gS‹
::
g‘Name
;

46 
±c
(
ch
, "Name: ");

48 ià(
	gd
->
	gch¬aù”
 !ğ
nuÎ±r
) {

49 
d–‘e
 
d
->
ch¬aù”
;

50 
	gd
->
	gch¬aù”
 = 
nuÎ±r
;

53  &
	gS‹
::
g‘Name
;

56 
±c
(
ch
, "Pleaseype Y or N? ");

60  
	gthis
;

	@src/conn/ClosedState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"Loggšg.hh
"

4 
Çme¥aû
 
	gcÚn
 {

6 
S‹
 * 
	gClo£dS‹
::

7 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

9 
	gLoggšg
::
bugf
("conn::ClosedState: handleInput called");

10  
	gthis
;

	@src/conn/ConfirmNewNameState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

6 
Çme¥aû
 
	gcÚn
 {

8 
S‹
 * 
	gCÚfœmNewNameS‹
::

9 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

10 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

14 
	g¬gum’t
[0]) {

17 
¡c
("\nYou find yourself standing inhe market square of Midgaard, surrounded by\n"

19 "throughhaœ‡nd hov” š frÚˆoàyou,†ookšg you ov”‡µrovšgly.\n\n", 
ch
);

20 
±c
(
ch
, "{Y'{WWelcomeo Legacy, %s!{Y'{x she says, smiling happily. {Y'{WI hope you have\n"

21 " somä“ime,hwÜld i ¨big…Ïû‡ndh”i sØmuchØdo!{Y'{x\n\n", 
ch
->
Çme
);

22 
¡c
("{Y'{WFœ¡hšg fœ¡,hough! T–Ème, how famŸ¸¬you w™h Legacy?{Y'{x\n\n", 
ch
);

23 
¡c
("{Y1){x ... what ishis…lace? ({YNewo MUDs{x)\n"

26 "{CPËa£‡nsw” {Y1{C, {Y2{C, o¸{Y3{C.{x ", 
ch
);

28  &
	gS‹
::
g‘MudExp
;

32 
¡c
("Ok, wh© dØyou wªˆtØbÿÎed,h’? ", 
ch
);

33 
d–‘e
 
	gd
->
	gch¬aù”
;

34 
	gd
->
	gch¬aù”
 = 
nuÎ±r
;

36  &
	gS‹
::
g‘Name
;

39 
¡c
("PËa£y³ Ye Ü No? ", 
ch
);

43  
	gthis
;

	@src/conn/ConfirmNewPassState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"PÏy”.hh
"

6 
	~"¬gum’t.hh
"

7 
	~"comm.hh
"

8 
	~"m”c.hh
"

10 
Çme¥aû
 
	gcÚn
 {

12 
S‹
 * 
	gCÚfœmNewPassS‹
::

13 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

14 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

16 
SŒšg
 
	g·ss
;

17 
Úe_¬gum’t
(
¬gum’t
, 
·ss
);

19 
¡c
("\n", 
ch
);

21 ià(
¡rcmp
(
·ss
, 
ch
->
pcd©a
->
pwd
)) {

22 
¡c
("The…ixie frowns‡s you whisper‡gain.\n\n"

24 " Wh©…asswÜd dØyou wªˆtØu£?{Y'{x sh§y a shæ› şo£¸tØh—r.\n\n", 
ch
);

25 
¡c
("{CWh©…asswÜd dØyou–Èh”?{x ", 
ch
);

27  &
	gS‹
::
g‘NewPass
;

30 
echo_Ú
(
d
);

31 
±c
(
ch
, "She‚ods her‡pproval.\n\n");

32 
±c
(
ch
, "{Y'{WYes,hat's what Ihought you said.{Y'{x As your walk draws closeohe grand\n"

36 " fl› şo£Øthc™ygu¬d' —¸ªd whi¥”s,h’ fl™ backØyou¸side.\n\n", 
ch
->
Çme
);

37 
¡c
("She†eads youohe first ofheemple steps,‡nd†ands gracefully onhe\n"

41 "£th© you‡»‡...{Y'{x\n\n", 
ch
);

42 
¡c
("Here you may choose your„ace. If you‡re unsure of what you would†ike\n"

43 "tØbe, ju¡y³ {Yh–p{x fÜ infÜm©iÚ oÀth¿ûs.\n\n", 
ch
);

44 
¡c
("ThfŞlowšg„aû ¬avaabË:\n", 
ch
);

46 
	g¿û
 = 1;„aû < 
	g¿û_bË
.
size
(è&&„aû_bË[
¿û
].
	gpc_¿û
;„ace++)

47 ià(!
	gpc_¿û_bË
[
¿û
].
	g»mÜt_Ëv–
)

48 
±c
(
ch
, "%s\n", 
¿û_bË
[
¿û
].
Çme
);

50 
¡c
("\n{CWh© i you¸¿û?{x ", 
ch
);

52  &
	gS‹
::
g‘Raû
;

	@src/conn/CopyoverRecoverState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

5 
Çme¥aû
 
	gcÚn
 {

7 
S‹
 * 
	gCİyov”Recov”S‹
::

8 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

9  
	gthis
;

	@src/conn/GetAlignmentState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"m”c.hh
"

7 
Çme¥aû
 
	gcÚn
 {

9 
S‹
 * 
	gG‘Alignm’tS‹
::

10 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

11 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

13 
	g¬gum’t
[0]) {

16 ià(
ch
->
gud
 =ğ
Gud
::
·Ïdš
)

17 
ch
->
®ignm’t
 = 1000;

19 
	gch
->
	g®ignm’t
 = 750;

25 ià(
ch
->
gud
 =ğ
Gud
::
·Ïdš
)

26 
ch
->
®ignm’t
 = -1000;

28 
	gch
->
	g®ignm’t
 = -750;

36 ià(
ch
->
gud
 !ğ
Gud
::
·Ïdš
) {

37 
ch
->
®ignm’t
 = 0;

42 
±c
(
ch
, "That's‚ot‡ valid‡lignment.\nWhich‡lignment (G%s/E)? ",

43 
ch
->
gud
 =ğ
Gud
::
·Ïdš
 ? "" : "/N");

45  
	gthis
;

48 
group_add
(
ch
, "rom basics", 
çl£
);

49 
group_add
(
ch
, 
gud_bË
[ch->
gud
].
ba£_group
, 
çl£
);

50 
£t_Ë¬Ãd
(
ch
, 
skl
::
ty³
::
»ÿÎ
, 50);

51 
£t_Ë¬Ãd
(
ch
, 
skl
::
ty³
::
sÿn
, 100);

52 
SŒšg
 
	gbuf
 = "\nSelect‡ deity:\n";

54 cÚ¡‡uto& 
	g’Œy
 : 
de™y_bË
) {

55 ià(
ch
->
gud
 =ğ
Gud
::
·Ïdš
) {

56 ià(
’Œy
.
v®ue
 > 0 && 
ch
->
®ignm’t
 > 0) {

57 
buf
 +ğ
’Œy
.
®ign
;

58 
	gbuf
 +ğ
’Œy
.
Çme
;

59 
	gbuf
 += "\n";

61 ià(
	g’Œy
.
	gv®ue
 < 0 && 
	gch
->
	g®ignm’t
 < 0) {

62 
	gbuf
 +ğ
’Œy
.
®ign
;

63 
	gbuf
 +ğ
’Œy
.
Çme
;

64 
	gbuf
 += "\n";

67 ià(
	g’Œy
.
	gv®ue
 =ğ
ch
->
®ignm’t


68 || 
’Œy
.
v®ue
 == -1) {

69 
buf
 +ğ
’Œy
.
®ign
;

70 
	gbuf
 +ğ
’Œy
.
Çme
;

71 
	gbuf
 += "\n";

75 
±c
(
ch
, 
buf
);

76 
±c
(
ch
, "\nHelp file: deity\nWho is your deity? ");

78  &
	gS‹
::
g‘De™y
;

	@src/conn/GetDeityState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"PÏy”.hh
"

6 
	~"¬gum’t.hh
"

7 
	~"lookup.hh
"

8 
	~"m”c.hh
"

10 
Çme¥aû
 
	gcÚn
 {

12 
S‹
 * 
	gG‘De™yS‹
::

13 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

14 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

16 ià(
	g¬gum’t
.
has_´efix
("help")) {

17 
SŒšg
 
	g¬g1
, 
	g¬g2
;

18 
	g¬g2
 = 
Úe_¬gum’t
(
¬gum’t
, 
¬g1
);

20 ià(
	g¬g2
.
em±y
())

21 
h–p
(
ch
, "deity");

23 
h–p
(
ch
, 
¬g2
);

25 
±c
(
ch
, "Who is your deity? ");

26  
	gthis
;;

29 
	gde™y
 = 
de™y_lookup
(
¬gum’t
);

31 ià(
	gde™y
 == -1) {

32 
±c
(
ch
, "That's‚ot‡ valid deity.\nWho is your deity? ");

33  
	gthis
;

36 
	gch
->
	gpcd©a
->
	gde™y
 = 
de™y_bË
[
de™y
].
Çme
;

38 ià(
	gch
->
	gpcd©a
->
	gpošts
 < 40)

39 
	gch
->
	gŒaš
 = 40 - 
ch
->
pcd©a
->
pošts
;

41 
±c
(
ch
, "\n");

42 
±c
(
ch
, "Please…ick‡ weapon fromhe following choices:\n");

43 
SŒšg
 
	gbuf
;

45 cÚ¡‡uto& 
	g’Œy
 : 
w—pÚ_bË
)

46 ià(
g‘_Ë¬Ãd
(
ch
, 
’Œy
.
skl
) > 0) {

47 
	gbuf
 +ğ
’Œy
.
Çme
;

48 
	gbuf
 += " ";

51 
	gbuf
 += "\nYour choice? ";

52 
±c
(
ch
, 
buf
);

54  &
	gS‹
::
g‘W—pÚ
;

	@src/conn/GetGuildState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"¬gum’t.hh
"

6 
	~"lookup.hh
"

7 
	~"chªÃls.hh
"

8 
	~"Loggšg.hh
"

10 
Çme¥aû
 
	gcÚn
 {

12 
S‹
 * 
	gG‘GudS‹
::

13 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

14 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

16 ià(
	g¬gum’t
.
has_´efix
("help")) {

17 
SŒšg
 
	g¬g1
, 
	g¬g2
;

18 
	g¬g2
 = 
Úe_¬gum’t
(
¬gum’t
, 
¬g1
);

20 ià(
	g¬g2
.
em±y
())

21 
h–p
(
ch
, "class help");

23 
h–p
(
ch
, 
¬g2
);

25 
±c
(
ch
, "What is your class? ");

27  
	gthis
;

30 
	gch
->
	ggud
 = 
gud_lookup
(
¬gum’t
);

32 ià(
	gch
->
	ggud
 =ğ
Gud
::
nÚe
) {

33 
±c
(
ch
, "That is‚ot‡ class.\nWhat is your class? ");

35  
	gthis
;

38 
SŒšg
 
	glog_buf
 = 
FÜm©
::
fÜm©
("%s@% Ãw…Ïy”.", 
ch
->
Çme
, 
d
->
ho¡
);

39 
wizÃt
(
log_buf
, 
nuÎ±r
,‚uÎ±r, 
WIZ_LOGINS
, 0, 
GET_RANK
(
ch
));

40 
	gLoggšg
::
log
(
log_buf
);

41 
	glog_buf
 = 
FÜm©
::
fÜm©
("Newb›‡Ë¹! % sigh‹d.", 
ch
->
Çme
);

42 
wizÃt
(
log_buf
, 
ch
, 
nuÎ±r
, 
WIZ_NEWBIE
, 0, 0);

45 
±c
(
ch
, "\nYou may be good%s orƒvil.\nWhich‡lignment (G%s/E)? ",

46 
ch
->
gud
 =ğ
Gud
::
·Ïdš
 ? "" : ",‚eutral,",

47 
ch
->
gud
 =ğ
Gud
::
·Ïdš
 ? "" : "/N");

49  &
	gS‹
::
g‘Alignm’t
;

	@src/conn/GetMudExpState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"PÏy”.hh
"

6 
	~"comm.hh
"

8 
Çme¥aû
 
	gcÚn
 {

10 
S‹
 * 
	gG‘MudExpS‹
::

11 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

12 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

14 
	g¬gum’t
[0]) {

16 
¡c
("\nThe…ixie beams‡ smile‡t you,‡nd you shuffle your feet‚ervously.\n\n"

22 "em¶ju¡‚Üth oàthm¬k‘¶aû.\n\n", 
ch
);

23 
¡c
("{Y'{WBefore we continue, we‚eedoell your…asswordohe city guards.\n"

26 "Øbyou! Ju¡ whi¥” iˆš myƒ¬,‡nd we'Î maksu»hey„ecÜd it.{Y'{x\n\n", 
ch
);

27 
	gch
->
	gpcd©a
->
	gmud_exp
 = 
MEXP_TOTAL_NEWBIE
;

31 
¡c
("\nThe…ixie beams‡ smile‡t you.\n\n"

37 "ƒ¬,‡nd we'Î maksu»hey„ecÜd it.{Y'{x\n\n", 
ch
);

38 
	gch
->
	gpcd©a
->
	gmud_exp
 = 
MEXP_LEGACY_NEWBIE
;

42 
¡c
("\nThe…ixie grins‡t you.\n\n"

45 " we'Î maksu»hey„ecÜd it.{Y'{x\n\n", 
ch
);

46 
	gch
->
	gpcd©a
->
	gmud_exp
 = 
MEXP_LEGACY_OLDBIE
;

50 
¡c
("{CPËa£‡nsw” {Y1{C, {Y2{C, o¸{Y3{C.{x ", 
ch
);

51  
	gthis
;

54 
±c
(
ch
, "{CWhat…assword do youell her?{x ");

55 
echo_off
(
d
);

56  &
	gS‹
::
g‘NewPass
;

	@src/conn/GetNameState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"comm.hh
"

6 
	~"sql.hh
"

7 
	~"Loggšg.hh
"

8 
	~"chªÃls.hh
"

9 
	~"Game.hh
"

10 
	~"WÜld.hh
"

11 
	~"RoomPrÙÙy³.hh
"

12 
	~"m”c.hh
"

14 
boŞ
 
check_·r£_Çme
(cÚ¡ 
SŒšg
& 
Çme
);

16 
Çme¥aû
 
	gcÚn
 {

18 
boŞ
 
check_¶ay”_exi¡
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
Çme
)

20 
DesütÜ
 *
	gdŞd
;

21 
StÜedPÏy”
 *
	gexi¡
 = 
nuÎ±r
;

23 
	gdŞd
 = 
desütÜ_li¡
; dŞd; dŞd = 
dŞd
->
Ãxt
) {

24 ià(
dŞd
 !ğ
d


25 && 
dŞd
->
ch¬aù”
 !ğ
nuÎ±r


26 && 
dŞd
->
ch¬aù”
->
Ëv–
 < 1

27 && 
dŞd
->
¡©e
 !ğ&
cÚn
::
S‹
::
¶ayšg


28 && 
Çme
 =ğ(
dŞd
->
Üigš®


29 ? 
dŞd
->
Üigš®
->
Çme
 : dŞd->
ch¬aù”
->name)) {

30 
wr™e_to_bufãr
(
d
,

37  
	gŒue
;

45 ià(! 
	g¡Üage_li¡_h—d
)

46 
lßd_¡Üage_li¡
();

49 
	gexi¡
 = 
lookup_¡Üage_d©a
(
Çme
);

51 ià(
	gexi¡
) {

52 
wr™e_to_bufãr
(
d
,

59  
	gŒue
;

62  
	gçl£
;

65 
boŞ
 
check_d’y
(cÚ¡ 
SŒšg
& 
Çme
)

67 ià(
db_couÁf
("check_d’y", "SELECT COUNT(*èFROM d’› WHERE‚ame='%s'", 
Çme
) <= 0)

68  
çl£
;

70  
	gŒue
;

73 
boŞ
 
check_bª
(cÚ¡ 
SŒšg
& 
s™e
, 
ty³
)

75 
boŞ
 
	gbª
 = 
çl£
;

77 ià(
db_qu”yf
("check_bª", "SELECT fÏgs, s™FROM bª WHERE ((æags>>2)<<2)=%d", 
ty³
è!ğ
SQL_OK
)

78  
çl£
;

80 !
	gbª
 && 
db_Ãxt_row
(è=ğ
SQL_OK
) {

81 
FÏgs
 
æags
 = 
db_g‘_cŞumn_æags
(0);

82 
SŒšg
 
	g¡r
 = 
db_g‘_cŞumn_¡r
(1);

83 
boŞ
 
	g´efix
 = 
æags
.
has
(
BAN_PREFIX
);

84 
boŞ
 
	gsuffix
 = 
æags
.
has
(
BAN_SUFFIX
);

86 ià((
	g´efix
 && 
	gsuffix
 && 
	g¡r
.
is_šfix_of
(
s™e
))

87 || (
	g´efix
 && !
	gsuffix
 && 
	g¡r
.
is_suffix_of
(
s™e
))

88 || (!
	g´efix
 && 
	gsuffix
 && 
	g¡r
.
is_´efix_of
(
s™e
))

89 || (!
	g´efix
 && !
	gsuffix
 && 
	gs™e
 =ğ
¡r
))

90 
bª
 = 
Œue
;

93  
	gbª
;

99 
boŞ
 
check_»cÚÃù
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
Çme
)

101 autØ
	gch
 : 
Game
::
wÜld
().
ch¬_li¡
) {

102 ià(!
ch
->
is_Åc
()

103 && 
d
->
ch¬aù”
 !ğ
ch


104 && 
d
->
ch¬aù”
->
Çme
 =ğ
ch
->name) {

105 
d
->
ch¬aù”
->
pcd©a
->
pwd
 = 
ch
->pcdata->pwd;

106  
	gŒue
;

110  
	gçl£
;

113 
S‹
 * 
	gG‘NameS‹
::

114 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gs
) {

115 
SŒšg
 
¬gum’t
(
¬gs
);

117 ià(
	g¬gum’t
.
em±y
()) {

118 
şo£_sock‘
(
d
);

119  &
	gS‹
::
şo£d
;

122 
boŞ
 
	glogÚ_lurk
 = 
çl£
;

124 ià(
	g¬gum’t
[0] == '-') {

125 
logÚ_lurk
 = 
Œue
;

126 
	g¬gum’t
.
”a£
(0, 1);

129 
	gÇme
[
MIL
];

130 
¡rıy
(
Çme
, 
¬gum’t
);

131 
	gÇme
[0] = 
touµ”
(
Çme
[0]);

134 ià(!
check_·r£_Çme
(
Çme
)) {

135 
wr™e_to_bufãr
(
d
, "Sorry,hat‚ame cannot be used.\n"

139  
	gthis
;

142 ià(
check_¶ay”_exi¡
(
d
, 
Çme
))

143  
	gthis
;

147 
boŞ
 
	gfOld
 = 
lßd_ch¬_obj
(
d
, 
Çme
);

148 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

153 ià(!
	gfOld
 && 
mob_exi¡s
(
Çme
)) {

154 
wr™e_to_bufãr
(
d
, "Sorry, we‡lready have‡ mobile byhat‚ame.\n"

158 
d–‘e
 
	gch
;

159 
	gd
->
	gch¬aù”
 = 
nuÎ±r
;

160  
	gthis
;

163 ià(
check_d’y
(
ch
->
Çme
)) {

164 
	gLoggšg
::
logf
("D’yšg‡cûs tØ%s@%s.", 
ch
->
Çme
, 
d
->
ho¡
);

165 
wr™e_to_bufãr
(
d
, "You‡re denied‡ccesso Legacy.\n");

166 
şo£_sock‘
(
d
);

167  &
	gS‹
::
şo£d
;

170 ià(
check_bª
(
d
->
ho¡
, 
BAN_ALL
è&& !
	gch
->
	gaù_æags
.
has
(
PLR_PERMIT
)) {

171 
SŒšg
 
	glog_buf
 = 
FÜm©
::
fÜm©
("DiscÚÃùšg beÿu£ BANÃd: %s", 
d
->
ho¡
);

172 
	gLoggšg
::
log
(
log_buf
);

173 
wizÃt
(
log_buf
, 
nuÎ±r
,‚uÎ±r, 
WIZ_LOGINS
, 0, 0);

174 
wr™e_to_bufãr
(
d
, "Your site has been banned fromhis mud.\n"

178 
şo£_sock‘
(
d
);

179  &
	gS‹
::
şo£d
;

182 ià(
check_»cÚÃù
(
d
, 
Çme
))

183 
	gfOld
 = 
Œue
;

184 ià(
	gGame
::
wizlock
 && !
IS_IMMORTAL
(
ch
)) {

185 
wr™e_to_bufãr
(
d
, "Access has been†imitedo imms only‡thisime.\n");

186 
şo£_sock‘
(
d
);

187  &
	gS‹
::
şo£d
;

190 ià(
	gfOld
) {

191 ià(
	glogÚ_lurk
 && 
IS_IMMORTAL
(
ch
))

192 
	gch
->
	glurk_Ëv–
 = 
LEVEL_IMMORTAL
;

194 
wr™e_to_bufãr
(
d
, "What is your…assword? ");

195 
echo_off
(
d
);

196  &
	gS‹
::
g‘OldPass
;

199 ià(
	gGame
::
Ãwlock
) {

200 
wr™e_to_bufãr
(
d
, "Dueoechnical difficulties, we‡re‚ot‡ccepting‚ew…layers\n"

202 
şo£_sock‘
(
d
);

203  &
	gS‹
::
şo£d
;

206 ià(
check_bª
(
d
->
ho¡
, 
BAN_NEWBIES
)) {

207 
SŒšg
 
	glog_buf
 = 
FÜm©
::
fÜm©
("DiscÚÃùšg beÿu£ Newb›BANÃd: %s", 
d
->
ho¡
);

208 
	gLoggšg
::
log
(
log_buf
);

209 
wizÃt
(
log_buf
, 
nuÎ±r
,‚uÎ±r, 
WIZ_LOGINS
, 0, 0);

210 
wr™e_to_bufãr
(
d
, "New…layers‡re‚ot‡llowed from your site.\n"

214 
şo£_sock‘
(
d
);

215  &
	gS‹
::
şo£d
;

218 
SŒšg
 
	gbuf
;

219 
	gFÜm©
::
¥rštf
(
buf
, "You wish fÜ hi¡ÜyØ»memb” you‡ % (Y/N)? ", 
Çme
);

220 
wr™e_to_bufãr
(
d
, 
buf
);

222  &
	gS‹
::
cÚfœmNewName
;

	@src/conn/GetNewPassState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"PÏy”.hh
"

6 
	~"¬gum’t.hh
"

8 
Çme¥aû
 
	gcÚn
 {

10 
S‹
 * 
	gG‘NewPassS‹
::

11 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

12 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

14 
SŒšg
 
	g·ss
;

15 
Úe_¬gum’t
(
¬gum’t
, 
·ss
);

17 
¡c
("\n", 
ch
);

19 ià(
	g·ss
.
Ëngth
() < 5) {

20 
¡c
("You whisper in herƒar,‡nd she giggles.\n\n"

22 "†—¡ fivË‰” lÚg!{Y'{x sh§ys,‡nd fl› u°şo£Øh—¸you whi¥”.\n\n", 
ch
);

23 
¡c
("{CWh©…asswÜd dØyou–Èh”?{x ", 
ch
);

24  
	gthis
;

27 
	gch
->
	gpcd©a
->
	gpwd
 = 
·ss
;

28 
¡c
("The…ixie smiles‡s you whisper in herƒar.\n\n"

29 "{Y'{WGood,h© wÈdØniûly. Ju¡Ømaksu» I hav™, say iˆÚmÜtime.{Y'{x\n\n", 
ch
);

30 
¡c
("{CPËa£„•—ˆth·sswÜd.{x ", 
ch
);

32  &
	gS‹
::
cÚfœmNewPass
;

	@src/conn/GetOldPassState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"comm.hh
"

6 
	~"Game.hh
"

7 
	~"Loggšg.hh
"

8 
	~"chªÃls.hh
"

9 
	~"sql.hh
"

10 
	~"WÜld.hh
"

11 
	~"Room.hh
"

13 
Çme¥aû
 
	gcÚn
 {

18 
boŞ
 
check_¶ayšg
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
Çme
)

20 
DesütÜ
 *
	gdŞd
;

22 
	gdŞd
 = 
desütÜ_li¡
; dŞd; dŞd = 
dŞd
->
Ãxt
) {

23 ià(
dŞd
 !ğ
d


24 && 
dŞd
->
ch¬aù”
 !ğ
nuÎ±r


25 && 
dŞd
->
¡©e
 !ğ&
cÚn
::
S‹
::
g‘Name


26 && 
dŞd
->
¡©e
 !ğ&
cÚn
::
S‹
::
g‘OldPass


27 && 
Çme
 =ğ(
dŞd
->
Üigš®


28 ? 
dŞd
->
Üigš®
->
Çme
 : dŞd->
ch¬aù”
->name)) {

29 
wr™e_to_bufãr
(
d
, "That character is‡lready…laying.\n");

30 
wr™e_to_bufãr
(
d
, "Do you wisho connect‡nyway (Y/N)?");

31  
	gŒue
;

35  
	gçl£
;

41 
boŞ
 
©‹m±_»cÚÃù
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
Çme
)

43 autØ
	gch
 : 
Game
::
wÜld
().
ch¬_li¡
) {

44 ià(!
ch
->
is_Åc
()

45 && 
d
->
ch¬aù”
 !ğ
ch


46 && 
ch
->
desc
 =ğ
nuÎ±r


47 && 
d
->
ch¬aù”
->
Çme
 =ğ
ch
->name) {

48 
Ch¬aù”
 *
rch
;

49 
d–‘e
 
	gd
->
	gch¬aù”
;

50 
	gd
->
	gch¬aù”
 = 
ch
;

51 
	gch
->
	gdesc
 = 
d
;

52 
	gch
->
	gdesc
->
	gtim”
 = 0;

53 
¡c
("RecÚÃùšg...\n", 
ch
);

55 ià(!
	gch
->
is_Åc
())

56 ià(!
	gch
->
	gpcd©a
->
	gbufãr
.
em±y
())

57 
¡c
("You havmes§ges: Ty³ '»¶ay'\n", 
ch
);

59 
	grch
 = 
ch
->
š_room
->
³İË
;„ch;„ch = 
rch
->
Ãxt_š_room
)

60 ià(
ch
 !ğ
rch
 && 
ÿn_£e_ch¬
(rch, ch))

61 
±c
(
rch
, "% ha »cÚÃùed.\n", 
PERS
(
ch
,„ch, 
VIS_CHAR
));

63 
	gLoggšg
::
logf
("%s@% »cÚÃùed.", 
ch
->
Çme
, 
d
->
ho¡
);

64 
wizÃt
("$N„eclaimshe fullness of $S†ink.",

65 
ch
, 
nuÎ±r
, 
WIZ_LINKS
, 0, 0);

67 
Room
 *
	groom
 = 
ch
->
š_room
;

69 ià(
	groom
 !ğ
nuÎ±r
) {

70 
ch¬_äom_room
(
ch
);

71 
ch¬_to_room
(
ch
, 
room
);

74 
	gch
->
	gpcd©a
->
	g¶r_æags
 -ğ
PLR_LINK_DEAD
;

75  
	gŒue
;

79  
	gçl£
;

82 cÚ¡ 
SŒšg
 
s™e_to_ss™e
(cÚ¡ SŒšg& 
s™e
)

84 
boŞ
 
	g®pha
 = 
çl£
;

85 
	gdÙcouÁ
 = 0;

90 cÚ¡ *
	gp
 = 
s™e
.
c_¡r
(); *p;…++) {

91 ià(*
	gp
 == '.')

92 
dÙcouÁ
++;

93 ià(!
isdig™
(*
p
))

94 
	g®pha
 = 
Œue
;

97 ià(
	g®pha
) {

98 ià(
	gdÙcouÁ
 < 3)

99  
	gs™e
;

101  
	gs™e
.
sub¡r
(
s™e
.
fšd_Áh
(
dÙcouÁ
 - 2, "."));

104  
	gs™e
.
sub¡r
(0, 
s™e
.
fšd_Áh
(3, "."));

107 
upd©e_s™e
(cÚ¡ 
Ch¬aù”
 *
ch
)

109 
SŒšg
 
	gshÜts™e
 = 
s™e_to_ss™e
(
ch
->
desc
->
ho¡
);

111 ià(
db_couÁf
("update_site",

112 "SELECT COUNT(*èFROM s™e WHERE‚ame='%s' AND ss™e='%s'", 
ch
->
Çme
, 
shÜts™e
) > 0)

113 
db_commªdf
("update_site", "UPDATE sites SET†astlog=DATE(), site='%s' WHERE‚ame='%s' AND ssite='%s'",

114 
db_esc
(
ch
->
desc
->
ho¡
), db_esc(ch->
Çme
), db_esc(
shÜts™e
));

116 
db_commªdf
("update_site", "INSERT INTO sites VALUES('%s','%s','%s',DATE())",

117 
db_esc
(
ch
->
Çme
), db_esc(ch->
desc
->
ho¡
), db_esc(
shÜts™e
));

120 
S‹
 * 
	gG‘OldPassS‹
::

121 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

122 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

124 
wr™e_to_bufãr
(
d
, "\n");

126 ià(
¡rcmp
(
¬gum’t
, 
ch
->
pcd©a
->
pwd
)) {

127 
¡c
("{bIncÜ»ù…asswÜd!{x\n", 
ch
);

128 
şo£_sock‘
(
d
);

129  &
	gS‹
::
şo£d
;

132 
echo_Ú
(
d
);

134 ià(
check_¶ayšg
(
d
, 
ch
->
Çme
))

135  &
	gS‹
::
b»akCÚÃù
;

137 ià(
©‹m±_»cÚÃù
(
d
, 
ch
->
Çme
))

138  &
	gS‹
::
¶ayšg
;

140 
	gch
->
	gpcd©a
->
	g¶r_æags
 -ğ
PLR_LINK_DEAD
;

141 
que¡_ş—nup
(
ch
);

142 
sq_ş—nup
(
ch
);

144 
SŒšg
 
	glog_buf
 = 
FÜm©
::
fÜm©
("%s@% ha cÚÃùed.", 
ch
->
Çme
, 
d
->
ho¡
);

145 
	gLoggšg
::
log
(
log_buf
);

146 
wizÃt
(
log_buf
, 
nuÎ±r
,‚uÎ±r, 
WIZ_SITES
, 
WIZ_LOGINS
, 
GET_RANK
(
ch
));

148 
	glog_buf
 = 
FÜm©
::
fÜm©
("Last Site: %s",

149 !
ch
->
pcd©a
->
Ï¡_ls™e
.
em±y
() ? ch->pcdata->last_lsite : "Not Available");

150 
wizÃt
(
log_buf
, 
nuÎ±r
,‚uÎ±r, 
WIZ_SITES
, 
WIZ_LOGINS
, 
GET_RANK
(
ch
));

152 
upd©e_s™e
(
ch
);

154 ià(
IS_IMMORTAL
(
ch
)) {

155 
£t_cŞÜ
(
ch
, 
RED
, 
BOLD
);

156 
h–p
(
ch
, "imotd");

157 
£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

158  &
	gS‹
::
»adIMOTD
;

161 
£t_cŞÜ
(
ch
, 
CYAN
, 
NOBOLD
);

162 
h–p
(
ch
, "automotd");

163 
£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

165  &
	gS‹
::
»adMOTD
;

	@src/conn/GetRaceState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"¬gum’t.hh
"

5 
	~"Ch¬aù”.hh
"

6 
	~"lookup.hh
"

7 
	~"m”c.hh
"

8 
	~"afãù/Afãù.hh
"

10 
Çme¥aû
 
	gcÚn
 {

12 
S‹
 * 
	gG‘RaûS‹
::

13 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

14 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

16 ià(
	g¬gum’t
.
has_´efix
("help")) {

17 
SŒšg
 
	g¬g
;

18 
SŒšg
 
	g¬g2
 = 
Úe_¬gum’t
(
¬gum’t
, 
¬g
);

20 ià(
	g¬g2
.
em±y
())

21 
h–p
(
ch
, "races");

23 
h–p
(
ch
, 
¬g2
);

25 
±c
(
ch
, "\nWhat is your„ace? ");

26  
	gthis
;

29 
	g¿û
 = 
¿û_lookup
(
¬gum’t
);

31 ià(
	g¿û
 < 1

32 || !
	g¿û_bË
[
¿û
].
	gpc_¿û


33 || 
	gpc_¿û_bË
[
¿û
].
	g»mÜt_Ëv–
) {

34 
±c
(
ch
, "That is‚ot‡ valid„ace.\nWhat is your„ace? ");

35  
	gthis
;

38 
	gch
->
	g¿û
 = 
¿û
;

41 
	g¡©
 = 0; sˆ< 
	gMAX_STATS
; stat++)

42 
ATTR_BASE
(
ch
, 
¡©_to_©Œ
(
¡©
)èğ
pc_¿û_bË
[
¿û
].
¡©s
[stat];

44 
	gafãù
::
add_¿cŸl_to_ch¬
(
ch
);

46 
	gch
->
	gfÜm_æags
 = 
¿û_bË
[
¿û
].
fÜm
;

47 
	gch
->
	g·¹s_æags
 = 
¿û_bË
[
¿û
].
·¹s
;

48 
	gch
->
	gpcd©a
->
	gpošts
 = 
pc_¿û_bË
[
¿û
].
pošts
;

49 
	gch
->
	gsize
 = 
pc_¿û_bË
[
¿û
].
size
;

52 
	gi
 = 0; i < 5 && !
	gpc_¿û_bË
[
¿û
].
	gskls
[
i
].
em±y
(); i++)

53 
group_add
(
ch
, 
pc_¿û_bË
[
¿û
].
skls
[
i
], 
çl£
);

55 
±c
(
ch
, "\n");

56 
±c
(
ch
, "Here‡re your default stats:\n");

57 
±c
(
ch
, "Str: %d Int: %d Wis: %d Dex: %d Con: %d Chr: %d\n",

58 
ATTR_BASE
(
ch
, 
APPLY_STR
), ATTR_BASE(ch, 
APPLY_INT
),

59 
ATTR_BASE
(
ch
, 
APPLY_WIS
), ATTR_BASE(ch, 
APPLY_DEX
),

60 
ATTR_BASE
(
ch
, 
APPLY_CON
), ATTR_BASE(ch, 
APPLY_CHR
));

61 
±c
(
ch
, "Would you†ikeo„oll for‚ew stats? [Y/N] ");

63  &
	gS‹
::
rŞlSts
;

	@src/conn/GetSexState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"PÏy”.hh
"

6 
	~"m”c.hh
"

8 
Çme¥aû
 
	gcÚn
 {

10 
S‹
 * 
	gG‘SexS‹
::

11 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

12 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

14 
	g¬gum’t
[0]) {

17 
ATTR_BASE
(
ch
, 
APPLY_SEX
èğ
SEX_MALE
;

22 
ATTR_BASE
(
ch
, 
APPLY_SEX
èğ
SEX_FEMALE
;

26 
±c
(
ch
, "That's‚ot‡ sex.\n(M/F)? ");

27  
	gthis
;

30 
±c
(
ch
, "\n");

31 
SŒšg
 
	gbuf
 = "Select‡ class [";

33 
	gi
 = 
Gud
::
fœ¡
; i < 
	gGud
::
size
; i++) {

34 ià(
	gi
 > 
	gGud
::
fœ¡
)

35 
buf
 += " ";

37 
	gbuf
 +ğ
gud_bË
[
i
].
Çme
;

40 
	gbuf
 += "]\nHelp file: class\nWhat is your class? ";

41 
±c
(
ch
, 
buf
);

43  &
	gS‹
::
g‘Gud
;

	@src/conn/GetWeaponState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"lookup.hh
"

6 
	~"m”c.hh
"

8 
Çme¥aû
 
	gcÚn
 {

10 
S‹
 * 
	gG‘W—pÚS‹
::

11 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

12 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

14 
±c
(
ch
, "\n");

15 
	gw—pÚ
 = 
w—pÚ_lookup
(
¬gum’t
);

17 ià(
	gw—pÚ
 =ğ-1 || 
g‘_Ë¬Ãd
(
ch
, 
w—pÚ_bË
[
w—pÚ
].
skl
) <= 0) {

18 
±c
(
ch
, "That is‚ot‡ valid selection. Your choice? \n");

19  
	gthis
;

22 
£t_Ë¬Ãd
(
ch
, 
w—pÚ_bË
[
w—pÚ
].
skl
, 40);

23 
±c
(
ch
, "\n");

25 
£t_cŞÜ
(
ch
, 
CYAN
, 
BOLD
);

26 
h–p
(
ch
, "automotd");

27 
£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

29  &
	gS‹
::
»adMOTD
;

	@src/conn/PlayingState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

5 
sub¡™u‹_®Ÿs
(
DesütÜ
 *
d
, 
SŒšg
 
šput
);

7 
Çme¥aû
 
	gcÚn
 {

9 
S‹
 * 
	gPÏyšgS‹
::

10 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

11 
sub¡™u‹_®Ÿs
(
d
, 
¬gum’t
);

12  
	gthis
;

	@src/conn/ReadIMOTDState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

6 
Çme¥aû
 
	gcÚn
 {

8 
S‹
 * 
	gR—dIMOTDS‹
::

9 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

10 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

12 
±c
(
ch
, "\n");

13 
£t_cŞÜ
(
ch
, 
CYAN
, 
NOBOLD
);

14 
h–p
(
ch
, "automotd");

15 
£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

17  &
	gS‹
::
»adMOTD
;

	@src/conn/ReadMOTDState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"Game.hh
"

7 
Çme¥aû
 
	gcÚn
 {

9 
S‹
 * 
	gR—dMOTDS‹
::

10 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

11 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

13 
£t_cŞÜ
(
ch
, 
WHITE
, 
BOLD
);

15 ià(!
	gGame
::
mÙd
.
em±y
())

16 
¡c
(
Game
::
mÙd
, 
ch
);

18 
¡c
("\n{x[H™ EÁ”ØcÚtšue]", 
ch
);

19 
£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

21  &
	gS‹
::
»adNewMOTD
;

	@src/conn/ReadNewMOTDState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"Game.hh
"

6 
	~"š‹½.hh
"

7 
	~"Loggšg.hh
"

8 
	~"comm.hh
"

9 
	~"chªÃls.hh
"

10 
	~"aù.hh
"

11 
	~"sql.hh
"

12 
	~"fe.hh
"

13 
	~"WÜld.hh
"

14 
	~"RoomPrÙÙy³.hh
"

15 
	~"m”c.hh
"

17 
Çme¥aû
 
	gcÚn
 {

19 
upd©e_»cÜds
()

21 
DesütÜ
 *
	gd
;

22 
	gcouÁ
 = 0;

24 ià(
	gGame
::
pÜt
 !ğ
DIZZYPORT
)

27 
db_commªd
("update_records", "UPDATE„ecords SET†ogins=logins+1");

29 
	gd
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = 
d
->
Ãxt
)

30 ià(
d
->
is_¶ayšg
())

31 
couÁ
++;

33 
	gGame
::
»cÜd_¶ay”s_sšû_boÙ
 = 
¡d
::
max
(
couÁ
, 
Game
::record_players_since_boot);

35 ià(
	gGame
::
»cÜd_¶ay”s_sšû_boÙ
 > 
Game
::
»cÜd_¶ay”s
) {

36 
Game
::
»cÜd_¶ay”s
 = Game::
»cÜd_¶ay”s_sšû_boÙ
;

37 
db_commªdf
("upd©e_»cÜds", "UPDATE„ecÜd SET…Ïy”s=%d", 
Game
::
»cÜd_¶ay”s_sšû_boÙ
);

40  ++
	gGame
::
»cÜd_logšs
;

43 
S‹
 * 
	gR—dNewMOTDS‹
::

44 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

45 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

47 
£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

49 ià(
	gch
->
	gpcd©a
 =ğ
nuÎ±r
 || 
ch
->
pcd©a
->
pwd
.
em±y
()) {

50 
±c
(
ch
, "Warning! Null…assword!\n");

51 
±c
(
ch
, "Please„eport old…assword with 'bug'.\n");

52 
±c
(
ch
, "Type 'password‚ull <new…assword>'o fix.\n");

55 
	gGame
::
wÜld
().
add_ch¬
(
ch
);

57 ià(
	gch
->
	gËv–
 == 0) {

58 
Objeù
 *
obj
;

59 
ATTR_BASE
(
ch
, 
¡©_to_©Œ
(
gud_bË
[ch->
gud
].
¡©_´ime
)) += 3;

60 
	gch
->
	gËv–
 = 1;

61 
	gch
->
	gexp
 = 
exp_³r_Ëv–
(
ch
, ch->
pcd©a
->
pošts
);

62 
	gch
->
	gh™
 = 
GET_MAX_HIT
(
ch
);

63 
	gch
->
	gmªa
 = 
GET_MAX_MANA
(
ch
);

64 
	gch
->
	g¡am
 = 
GET_MAX_STAM
(
ch
);

65 
	gch
->
	gŒaš
 += 3;

66 
	gch
->
	g´aùiû
 += 5;

67 
£t_t™Ë
(
ch
, "({VNewbie Aura{x)");

68 
do_outf™
(
ch
, "");

74 
	gobj
 = 
ü—‹_objeù
(
Game
::
wÜld
().
g‘_obj_´ÙÙy³
(
OBJ_VNUM_MAP
), 0);

75 
obj_to_ch¬
(
obj
, 
ch
);

77 
	gobj
 = 
ü—‹_objeù
(
Game
::
wÜld
().
g‘_obj_´ÙÙy³
(
OBJ_VNUM_TOKEN
), 0);

78 
obj_to_ch¬
(
obj
, 
ch
);

80 
ch¬_to_room
(
ch
, 
Game
::
wÜld
().
g‘_room
(
LoÿtiÚ
(
Vnum
(
ROOM_VNUM_SCHOOL
))));

81 
¡c
("\n", 
ch
);

82 
£t_cŞÜ
(
ch
, 
PURPLE
, 
BOLD
);

83 
h–p
(
ch
, "NEWBIE INFO");

84 
£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

85 
¡c
("\n", 
ch
);

87 ià(
	gch
->
	gš_room
 !ğ
nuÎ±r
)

88 
ch¬_to_room
(
ch
, ch->
š_room
);

89 ià(
IS_IMMORTAL
(
ch
))

90 
ch¬_to_room
(
ch
, 
Game
::
wÜld
().
g‘_room
(
LoÿtiÚ
(
Vnum
(
ROOM_VNUM_CHAT
))));

92 
ch¬_to_room
(
ch
, 
Game
::
wÜld
().
g‘_room
(
LoÿtiÚ
(
Vnum
(
ROOM_VNUM_TEMPLE
))));

94 ià(
	gch
->
	gpcd©a
->
	gema
.
em±y
()) {

95 
£t_cŞÜ
(
ch
, 
RED
, 
BOLD
);

96 
¡c
("You¸e-ma ha nÙ b“À£t,…Ëa£ upd©you¸ema‡dd»ss\n", 
ch
);

97 
¡c
("w™hhema commªd!\n\n", 
ch
);

98 
£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

101 
DesütÜ
 *
	gsd
 = 
desütÜ_li¡
; sd !ğ
nuÎ±r
; sd = 
sd
->
Ãxt
) {

102 
Ch¬aù”
 *
viùim
 = 
sd
->
Üigš®
 ? sd->Üigš® : sd->
ch¬aù”
;

104 ià(
	gsd
->
is_¶ayšg
()

105 && 
	gsd
->
	gch¬aù”
 !ğ
ch


106 && 
ÿn_£e_who
(
viùim
, 
ch
)

107 && !
	gviùim
->
	gcomm_æags
.
has
(
COMM_NOANNOUNCE
)

108 && !
	gviùim
->
	gcomm_æags
.
has
(
COMM_QUIET
)) {

109 ià(
	gch
->
	gpcd©a
 && !ch->pcd©a->
	ggameš
.
em±y
()) {

110 
£t_cŞÜ
(
viùim
, 
GREEN
, 
BOLD
);

111 
±c
(
viùim
, "[%s] %s\n", 
ch
->
Çme
, ch->
pcd©a
->
gameš
);

114 
Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_ANNOUNCE
);

115 
±c
(
viùim
, "[FYI] % ha ’‹»dhgame.\n", 
ch
->
Çme
);

118 
£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

122 
do_look
(
ch
, "auto");

123 
wizÃt
("$N ha Ëá„—Èliã behšd.", 
ch
, 
nuÎ±r
, 
WIZ_LOGINS
, 
WIZ_SITES
, 
GET_RANK
(ch));

125 ià(
	gch
->
	g³t
 !ğ
nuÎ±r
) {

126 
ch¬_to_room
(
ch
->
³t
, ch->
š_room
);

127 
aù
("$Àha ’‹»dhgame.", 
ch
->
³t
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

130 
do_uÄ—d
(
ch
, "");

131 
¡c
("\n", 
ch
);

133 ià(!
	gch
->
	gûnsÜ_æags
.
has
(
CENSOR_CHAN
))

134 
¡c
("{BL{Ce{gg{Wa{Cc{By{x i cu¼’y„©ed {PR{x.\n", 
ch
);

136 
¡c
("{BL{Ce{gg{Wa{Cc{By{x i cu¼’y„©ed {GPG{x.\n", 
ch
);

138 ià(
g‘_¶ay_£cÚds
(
ch
è- 
	gch
->
	gpcd©a
->
	gbackup
 >= 3600) {

139 
Ï¡
 = (
g‘_¶ay_£cÚds
(
ch
è- ch->
pcd©a
->
backup
) / 3600;

141 ià(
	gch
->
	gpcd©a
->
	gbackup
 == 0)

142 
¡c
("{W{fTh”i cu¼’y‚Øbacku°fÜ you¸ch¬aù”.{x\n", 
ch
);

144 
±c
(
ch
, "%sYou have‚ot backed up for %s%d%s hour%s of gameplay.{x\n",

145 
Ï¡
 > 24 ? "{P" : "{W",

146 
Ï¡
 > 24 ? "{V" : "{G",

147 
Ï¡
,

148 
Ï¡
 > 24 ? "{P" : "{W",

149 
Ï¡
 > 1 ? "s" : "");

152 
±c
(
ch
, "\nYour†ast†ogin was from [{W%s{x] %s",

153 !
ch
->
pcd©a
->
Ï¡_ls™e
.
em±y
() ? ch->pcdata->last_lsite : "Not Available",

154 
ch
->
pcd©a
->
Ï¡_Éime
 !ğ(
time_t
è0 ? 
dizzy_ùime
(&ch->pcdata->last_ltime) : "00:00:00");

155 
	gch
->
	gpcd©a
->
	gÏ¡_Éime
 = 
Game
::
cu¼’t_time
;

156 
	gch
->
	gpcd©a
->
	gÏ¡_ls™e
 = 
d
->
ho¡
;

157 
±c
(
ch
, "\n{VYou‡»¿v–” [%lu] oàLegacy!!!{x\n", 
upd©e_»cÜds
());

158 
upd©e_pc_šdex
(
ch
, 
çl£
);

161 ià(
	gch
->
	gpcd©a
 && ch->pcd©a->
	gvideo_æags
.
has
(
PLR_VT100
)) {

162 
gÙo_lše
(
ch
, 1, 1);

163 
ş—r_wšdow
(
ch
);

164 
£t_wšdow
(
ch
, 1, ch->
lšes
 - 2);

165 
gÙo_lše
(
ch
, ch->
lšes
, 1);

168  &
	gS‹
::
¶ayšg
;

	@src/conn/RollStatsState.cc

1 
	~"cÚn/S‹.hh
"

2 
	~"DesütÜ.hh
"

3 
	~"SŒšg.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"¿ndom.hh
"

6 
	~"m”c.hh
"

8 
Çme¥aû
 
	gcÚn
 {

10 
rŞl_¡©
(cÚ¡ 
Ch¬aù”
 *
ch
, 
¡©
)

12 
	g³rûÁ
, 
	gbÚus
, 
	g‹mp
, 
	glow
, 
	ghigh
;

13 
	g³rûÁ
 = 
numb”_³rûÁ
();

15 ià(
	g³rûÁ
 > 99)

16 
	gbÚus
 = 2;

17 ià(
	g³rûÁ
 > 95)

18 
	gbÚus
 = 1;

19 ià(
	g³rûÁ
 < 5)

20 
	gbÚus
 = -1;

22 
	gbÚus
 = 0;

24 
	ghigh
 = 
pc_¿û_bË
[
ch
->
¿û
].
max_¡©s
[
¡©
] - (3 - 
bÚus
);

25 
	glow
 = 
pc_¿û_bË
[
ch
->
¿û
].
¡©s
[
¡©
] - (3 - 
bÚus
);

26 
	g‹mp
 = (
numb”_¿nge
(
low
, 
high
));

27  
	g‹mp
;

30 
S‹
 * 
	gRŞlStsS‹
::

31 
hªdËIÅut
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
¬gum’t
) {

32 
Ch¬aù”
 *
	gch
 = 
d
->
ch¬aù”
;

34 
	g¬gum’t
[0]) {

37 
±c
(
ch
, "\n");

38 
±c
(
ch
, "What is your sex (M/F)? ");

40  &
	gS‹
::
g‘Sex
;

44 
¡©
 = 0; 
	g¡©
 < 
	gMAX_STATS
; stat++)

45 
ATTR_BASE
(
ch
, 
¡©_to_©Œ
(
¡©
)èğ
rŞl_¡©
(ch, stat);

47 
±c
(
ch
, "\nStr: %d Int: %d Wis: %d Dex: %d Con: %d Chr: %d\n",

48 
ATTR_BASE
(
ch
, 
APPLY_STR
), ATTR_BASE(ch, 
APPLY_INT
),

49 
ATTR_BASE
(
ch
, 
APPLY_WIS
), ATTR_BASE(ch, 
APPLY_DEX
),

50 
ATTR_BASE
(
ch
, 
APPLY_CON
), ATTR_BASE(ch, 
APPLY_CHR
));

51 
±c
(
ch
, "Would you†ikeo„oll for‚ew stats? [Y/N] ");

55 
±c
(
ch
, "Yes or No? ");

59  
	gthis
;

	@src/conn/State.cc

1 
	~"cÚn/S‹.hh
"

3 
Çme¥aû
 
	gcÚn
 {

5 
Clo£dS‹
 
	gS‹
::
şo£d
;

6 
G‘NameS‹
 
	gS‹
::
g‘Name
;

7 
CÚfœmNewNameS‹
 
	gS‹
::
cÚfœmNewName
;

8 
CÚfœmNewPassS‹
 
	gS‹
::
cÚfœmNewPass
;

9 
G‘OldPassS‹
 
	gS‹
::
g‘OldPass
;

10 
G‘NewPassS‹
 
	gS‹
::
g‘NewPass
;

11 
B»akCÚÃùS‹
 
	gS‹
::
b»akCÚÃù
;

12 
R—dMOTDS‹
 
	gS‹
::
»adMOTD
;

13 
R—dNewMOTDS‹
 
	gS‹
::
»adNewMOTD
;

14 
R—dIMOTDS‹
 
	gS‹
::
»adIMOTD
;

15 
G‘MudExpS‹
 
	gS‹
::
g‘MudExp
;

16 
G‘RaûS‹
 
	gS‹
::
g‘Raû
;

17 
RŞlStsS‹
 
	gS‹
::
rŞlSts
;

18 
G‘SexS‹
 
	gS‹
::
g‘Sex
;

19 
G‘GudS‹
 
	gS‹
::
g‘Gud
;

20 
G‘Alignm’tS‹
 
	gS‹
::
g‘Alignm’t
;

21 
G‘De™yS‹
 
	gS‹
::
g‘De™y
;

22 
G‘W—pÚS‹
 
	gS‹
::
g‘W—pÚ
;

24 
Cİyov”Recov”S‹
 
	gS‹
::
cİyov”Recov”
;

25 
PÏyšgS‹
 
	gS‹
::
¶ayšg
;

	@src/const.cc

28 
	~<veùÜ
>

29 
	~<m­
>

31 
	~"afãù/Afãù.hh
"

32 
	~"deş¬e.hh
"

33 
	~"FÏgs.hh
"

34 
	~"magic.hh
"

35 
	~"m”c.hh
"

36 
	~"skl/skl.hh
"

39 cÚ¡ 
	g¡d
::
veùÜ
<
™em_ty³
> 
™em_bË
 = {

40 { 
ITEM_LIGHT
, "light" },

41 { 
ITEM_SCROLL
, "scroll" },

42 { 
ITEM_WAND
, "wand" },

43 { 
ITEM_STAFF
, "staff" },

44 { 
ITEM_WEAPON
, "weapon" },

45 { 
ITEM_TREASURE
, "treasure" },

46 { 
ITEM_ARMOR
, "armor" },

47 { 
ITEM_POTION
, "potion" },

48 { 
ITEM_CLOTHING
, "clothing" },

49 { 
ITEM_FURNITURE
, "furniture" },

50 { 
ITEM_TRASH
, "trash" },

51 { 
ITEM_CONTAINER
, "container" },

52 { 
ITEM_DRINK_CON
, "drink" },

53 { 
ITEM_KEY
, "key" },

54 { 
ITEM_FOOD
, "food" },

55 { 
ITEM_MONEY
, "money" },

56 { 
ITEM_BOAT
, "boat" },

57 { 
ITEM_CORPSE_NPC
, "npc_corpse" },

58 { 
ITEM_CORPSE_PC
, "pc_corpse" },

59 { 
ITEM_FOUNTAIN
, "fountain" },

60 { 
ITEM_PILL
, "pill" },

61 { 
ITEM_MAP
, "map" },

62 { 
ITEM_PORTAL
, "portal" },

63 { 
ITEM_WARP_STONE
, "warp_stone" },

64 { 
ITEM_GEM
, "gem" },

65 { 
ITEM_JEWELRY
, "jewelry" },

66 { 
ITEM_JUKEBOX
, "jukebox" },

69 { 
ITEM_MATERIAL
, "material" },

70 { 
ITEM_ANVIL
, "anvil" },

72 { 
ITEM_WEDDINGRING
, "weddingring" },

73 { 
ITEM_TOKEN
, "token" },

74 { 
ITEM_WARP_CRYSTAL
, "warp_crystal" },

79 cÚ¡ 
	g¡d
::
veùÜ
<
w—pÚ_bË_t
> 
w—pÚ_bË
 = {

80 { "swÜd", 
OBJ_VNUM_SCHOOL_SWORD
, 
WEAPON_SWORD
, 
skl
::
ty³
::
swÜd
 },

81 { "maû", 
OBJ_VNUM_SCHOOL_MACE
, 
WEAPON_MACE
, 
skl
::
ty³
::
maû
 },

82 { "dagg”", 
OBJ_VNUM_SCHOOL_DAGGER
, 
WEAPON_DAGGER
, 
skl
::
ty³
::
dagg”
 },

83 { "axe", 
OBJ_VNUM_SCHOOL_AXE
, 
WEAPON_AXE
, 
skl
::
ty³
::
axe
 },

84 { "¡aff", 
OBJ_VNUM_SCHOOL_STAFF
, 
WEAPON_SPEAR
, 
skl
::
ty³
::
¥—r
 },

85 { "æa", 
OBJ_VNUM_SCHOOL_FLAIL
, 
WEAPON_FLAIL
, 
skl
::
ty³
::
æa
 },

86 { "wh", 
OBJ_VNUM_SCHOOL_WHIP
, 
WEAPON_WHIP
, 
skl
::
ty³
::
wh
 },

87 { "pŞ—rm", 
OBJ_VNUM_SCHOOL_POLEARM
, 
WEAPON_POLEARM
, 
skl
::
ty³
::
pŞ—rm
 },

88 { "bow", 
OBJ_VNUM_SCHOOL_BOW
, 
WEAPON_BOW
, 
skl
::
ty³
::
¬ch”y
 },

92 cÚ¡ 
	g¡d
::
veùÜ
<
©ck_ty³
> 
©ck_bË
 = {

93 { "nÚe", "h™", 
DAM_BASH
 },

94 { "¦iû", "¦iû", 
DAM_SLASH
 },

95 { "¡ab", "¡ab", 
DAM_PIERCE
 },

96 { "¦ash", "¦ash", 
DAM_SLASH
 },

97 { "wh", "wh", 
DAM_SLASH
 },

98 { "şaw", "şaw", 
DAM_SLASH
 },

99 { "bÏ¡", "bÏ¡", 
DAM_BASH
 },

100 { "pound", "pound", 
DAM_BASH
 },

101 { "üush", "üush", 
DAM_BASH
 },

102 { "g»p", "g»p", 
DAM_SLASH
 },

103 { "b™e", "b™e", 
DAM_PIERCE
 },

104 { "p›rû", "p›rû", 
DAM_PIERCE
 },

105 { "suùiÚ", "suùiÚ", 
DAM_BASH
 },

106 { "b—tšg", "b—tšg", 
DAM_BASH
 },

107 { "dige¡iÚ", "dige¡iÚ", 
DAM_ACID
 },

108 { "ch¬ge", "ch¬ge", 
DAM_BASH
 },

109 { "¦­", "¦­", 
DAM_BASH
 },

110 { "punch", "punch", 
DAM_BASH
 },

111 { "w¿th", "w¿th", 
DAM_ENERGY
 },

112 { "magic", "magic", 
DAM_ENERGY
 },

113 { "divše", "divšpow”", 
DAM_HOLY
 },

114 { "ş—ve", "ş—ve", 
DAM_SLASH
 },

115 { "sü©ch", "sü©ch", 
DAM_PIERCE
 },

116 { "³ck", "³ck", 
DAM_PIERCE
 },

117 { "³ckb", "³ck", 
DAM_BASH
 },

118 { "chİ", "chİ", 
DAM_SLASH
 },

119 { "¡šg", "¡šg", 
DAM_PIERCE
 },

120 { "smash", "smash", 
DAM_BASH
 },

121 { "shb™e", "shockšg b™e", 
DAM_ELECTRICITY
 },

122 { "æb™e", "æamšg b™e", 
DAM_FIRE
 },

123 { "äb™e", "ä“zšg b™e", 
DAM_COLD
 },

124 { "acb™e", "acidiøb™e", 
DAM_ACID
 },

125 { "chomp", "chomp", 
DAM_PIERCE
 },

126 { "d¿š", "liã d¿š", 
DAM_NEGATIVE
 },

127 { "thru¡", "thru¡", 
DAM_PIERCE
 },

128 { "¦ime", "¦ime", 
DAM_ACID
 },

129 { "shock", "shock", 
DAM_ELECTRICITY
 },

130 { "thwack", "thwack", 
DAM_BASH
 },

131 { "æame", "æame", 
DAM_FIRE
 },

132 { "chl", "chl", 
DAM_COLD
 },

133 { "h¡rike", "hˆ¡rike", 
DAM_BASH
 },

134 { "¬row", "¬row", 
DAM_PIERCE
 },

135 { "acŞd", "{Ci{Wc{Cy {ga{Wur{ga", 
DAM_COLD
 },

136 { "afœe", "{Pf{Ri{be{Rr{Py {ga{Wur{ga", 
DAM_FIRE
 },

137 { "®ight", "{Yli{bgh{Tt{bni{Yng {ga{Wur{ga", 
DAM_ELECTRICITY
 },

138 { "aw©”", "{Nw{B©{N” {ga{Wur{ga", 
DAM_WATER
 },

139 { "f¡rike", "{RF{bu{Pri{bou{R {WSt{gri{Wke{x", 
DAM_SLASH
 },

143 cÚ¡ 
	g¡d
::
veùÜ
<
¿û_ty³
> 
¿û_bË
 = {

152 { "unique", 
çl£
, 0, 0, 0, 0, 0, 0, 0, 0 },

157 "humª", 
Œue
,

160 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J
|FÏgs::
K


163 "–f", 
Œue
,

165 0, 
RES_CHARM
, 
VULN_IRON
,

166 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J
|FÏgs::
K


169 "dw¬f", 
Œue
,

170 0, 
AFF_NIGHT_VISION
, 0,

171 0, 
RES_POISON
 | 
RES_DISEASE
, 
VULN_DROWNING
,

172 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J
|FÏgs::
K


175 "gŸÁ", 
Œue
,

177 0, 
RES_FIRE
 | 
RES_COLD
, 
VULN_MENTAL
 | 
VULN_CHARM
,

178 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J
|FÏgs::
K


181 "ã¿l", 
Œue
,

182 0, 
AFF_NIGHT_VISION
, 
OFF_DODGE
,

183 0, 0, 
VULN_DROWNING
 | 
VULN_ELECTRICITY
,

184 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J
|FÏgs::
K


187 "vampœe", 
Œue
,

188 0, 
AFF_FLYING
, 0,

189 0, 
RES_NEGATIVE
 | 
RES_CHARM
, 
VULN_LIGHT
 | 
VULN_HOLY
,

190 
FÏgs
::
A
|FÏgs::
D
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::D|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::
H
|FÏgs::
I
|FÏgs::
J
|FÏgs::
K
|FÏgs::
P


193 "œda", 
Œue
,

196 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J


199 "ç”›", 
Œue
,

200 0, 
AFF_FLYING
 | 
AFF_HASTE
, 0,

202 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J
|FÏgs::
K
|FÏgs::
P


205 "d¿gÚ", 
Œue
,

206 0, 
AFF_FLYING
, 0,

207 0, 
RES_SLASH
 | 
RES_BASH
, 
VULN_PIERCE
,

208 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
Z
, FÏgs::A|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J
|FÏgs::
K
|FÏgs::
P
|FÏgs::
Q
|FÏgs::
U
|FÏgs::
V
|FÏgs::
X


211 "wŞf", 
Œue
,

213 0, 
RES_COLD
, 
VULN_FIRE
,

214 
FÏgs
::
A
|FÏgs::
D
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::D|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::
H
|FÏgs::
I
|FÏgs::
J
|FÏgs::
K


217 "£¿ph", 
Œue
,

218 0, 
AFF_FLYING
, 0,

219 0, 
RES_HOLY
 | 
RES_LIGHT
, 
VULN_NEGATIVE
,

220 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J
|FÏgs::
P


223 "su³rhumª", 
Œue
,

226 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J


229 "ŒŞl", 
Œue
,

230 0, 
AFF_REGENERATION
, 0,

231 0, 
RES_PIERCE
 | 
RES_POISON
, 
VULN_FIRE
 | 
VULN_ACID
,

232 
FÏgs
::
A
|FÏgs::
B
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::B|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::
H
|FÏgs::
I
|FÏgs::
J
|FÏgs::
K
|FÏgs::
L
|FÏgs::
U
|FÏgs::
W
|FÏgs::
Y


238 "b©", 
çl£
,

239 0, 
AFF_FLYING
, 
OFF_DODGE
 | 
OFF_FAST
,

240 0, 0, 
VULN_LIGHT
,

241 
FÏgs
::
A
|FÏgs::
G
|FÏgs::
V
, FÏgs::A|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
H
|FÏgs::
J
|FÏgs::
K
|FÏgs::
P


244 "b—r", 
çl£
,

245 0, 0, 
OFF_CRUSH
 | 
OFF_DISARM
 | 
OFF_BERSERK
,

246 0, 
RES_BASH
 | 
RES_COLD
, 0,

247 
FÏgs
::
A
|FÏgs::
G
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
H
|FÏgs::
J
|FÏgs::
K
|FÏgs::
U
|Flags::V

250 "ÿt", 
çl£
,

251 0, 0, 
OFF_FAST
 | 
OFF_DODGE
,

253 
FÏgs
::
A
|FÏgs::
G
|FÏgs::
V
, FÏgs::A|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
H
|FÏgs::
J
|FÏgs::
K
|FÏgs::
Q
|FÏgs::
U
|Flags::V

256 "ûÁede", 
çl£
,

258 0, 
RES_PIERCE
 | 
RES_COLD
, 
VULN_BASH
,

259 
FÏgs
::
A
|FÏgs::
B
|FÏgs::
G
|FÏgs::
O
, FÏgs::A|FÏgs::
C
|FÏgs::
K


262 "üy¡®", 
çl£
,

263 0, 
AFF_REGENERATION
, 0,

264 0, 0, 
VULN_FIRE
,

265 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J
|FÏgs::
K


268 "dog", 
çl£
,

269 0, 0, 
OFF_FAST
,

271 
FÏgs
::
A
|FÏgs::
G
|FÏgs::
V
, FÏgs::A|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
H
|FÏgs::
J
|FÏgs::
K
|FÏgs::
U
|Flags::V

274 "dŞl", 
çl£
,

276 
IMM_COLD
 | 
IMM_POISON
 | 
IMM_HOLY
 | 
IMM_NEGATIVE
 | 
IMM_MENTAL
 | 
IMM_DISEASE
 | 
IMM_DROWNING
,

277 
RES_BASH
 | 
RES_LIGHT
,

278 
VULN_SLASH
 | 
VULN_FIRE
 | 
VULN_ACID
 | 
VULN_ELECTRICITY
 | 
VULN_ENERGY
,

279 
FÏgs
::
E
|FÏgs::
J
|FÏgs::
M
|FÏgs::
c
, FÏgs::
A
|FÏgs::
B
|FÏgs::
C
|FÏgs::
G
|FÏgs::
H
|FÏgs::
K


282 "fido", 
çl£
,

283 0, 0, 
OFF_DODGE
 | 
ASSIST_RACE
,

284 0, 0, 
VULN_MAGIC
,

285 
FÏgs
::
A
|FÏgs::
B
|FÏgs::
G
|FÏgs::
V
, FÏgs::A|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
H
|FÏgs::
J
|FÏgs::
K
|FÏgs::
Q
|Flags::V

288 "fox", 
çl£
,

289 0, 0, 
OFF_FAST
 | 
OFF_DODGE
,

291 
FÏgs
::
A
|FÏgs::
G
|FÏgs::
V
, FÏgs::A|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
H
|FÏgs::
J
|FÏgs::
K
|FÏgs::
Q
|Flags::V

294 "goblš", 
çl£
,

295 0, 
AFF_NIGHT_VISION
, 0,

296 0, 
RES_DISEASE
, 
VULN_MAGIC
,

297 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J
|FÏgs::
K


300 "hobgoblš", 
çl£
,

301 0, 
AFF_NIGHT_VISION
, 0,

302 0, 
RES_DISEASE
 | 
RES_POISON
, 0,

303 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J
|FÏgs::
K
|FÏgs::
Y


306 "hÜ£", 
çl£
,

309 
FÏgs
::
A
|FÏgs::
G
|FÏgs::
V
, FÏgs::A|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
H
|FÏgs::
J
|FÏgs::
K


312 "kobŞd", 
çl£
,

313 0, 
AFF_NIGHT_VISION
, 0,

314 0, 
RES_POISON
, 
VULN_MAGIC
,

315 
FÏgs
::
A
|FÏgs::
B
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::B|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J
|FÏgs::
K
|FÏgs::
Q


318 "liz¬d", 
çl£
,

320 0, 
RES_POISON
, 
VULN_COLD
,

321 
FÏgs
::
A
|FÏgs::
G
|FÏgs::
X
|FÏgs::
c
, FÏgs::A|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
H
|FÏgs::
K
|FÏgs::
Q
|FÏgs::
V


324 "modrÚ", 
çl£
,

325 0, 
AFF_NIGHT_VISION
, 
ASSIST_RACE
 | 
ASSIST_ALIGN
,

326 
IMM_CHARM
 | 
IMM_DISEASE
 | 
IMM_MENTAL
 | 
IMM_HOLY
 | 
IMM_NEGATIVE
, 
RES_FIRE
 | 
RES_COLD
 | 
RES_ACID
, 0,

327 
FÏgs
::
H
, FÏgs::
A
|FÏgs::
B
|FÏgs::
C
|FÏgs::
G
|FÏgs::H|FÏgs::
J
|FÏgs::
K


330 "Üc", 
çl£
,

331 0, 
AFF_NIGHT_VISION
, 0,

332 0, 
RES_DISEASE
, 
VULN_LIGHT
,

333 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J
|FÏgs::
K


336 "pig", 
çl£
,

339 
FÏgs
::
A
|FÏgs::
G
|FÏgs::
V
, FÏgs::A|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
H
|FÏgs::
J
|FÏgs::
K


342 "¿bb™", 
çl£
,

343 0, 0, 
OFF_DODGE
 | 
OFF_FAST
,

345 
FÏgs
::
A
|FÏgs::
G
|FÏgs::
V
, FÏgs::A|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
H
|FÏgs::
J
|FÏgs::
K


348 "schoŞ mÚ¡”", 
çl£
,

349 
ACT_NOALIGN
|
ACT_NOSUMMON
, 0, 0,

350 
IMM_CHARM
, 0, 
VULN_MAGIC
,

351 
FÏgs
::
A
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
H
|FÏgs::
J
|FÏgs::
K
|FÏgs::
Q
|FÏgs::
U


354 "¢ake", 
çl£
,

356 0, 
RES_POISON
, 
VULN_COLD
,

357 
FÏgs
::
A
|FÏgs::
G
|FÏgs::
X
|FÏgs::
Y
|FÏgs::
c
, FÏgs::A|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
K
|FÏgs::
L
|FÏgs::
Q
|FÏgs::
V
|Flags::X

360 "sÚg bœd", 
çl£
,

361 0, 
AFF_FLYING
, 
OFF_FAST
 | 
OFF_DODGE
,

363 
FÏgs
::
A
|FÏgs::
G
|FÏgs::
W
, FÏgs::A|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
H
|FÏgs::
K
|FÏgs::
P


366 "‹y§", 
çl£
,

368 0, 
RES_HOLY
, 
VULN_BASH
 | 
VULN_FIRE
 | 
VULN_ACID
,

369 
FÏgs
::
A
|FÏgs::
H
|FÏgs::
M
|FÏgs::
V
, FÏgs::A|FÏgs::
B
|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
G
|FÏgs::H|FÏgs::
I
|FÏgs::
J
|FÏgs::
K


372 "w©” fowl", 
çl£
,

373 0, 
AFF_FLYING
, 0,

374 0, 
RES_DROWNING
, 0,

375 
FÏgs
::
A
|FÏgs::
G
|FÏgs::
W
, FÏgs::A|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
H
|FÏgs::
K
|FÏgs::
P


378 "wyv”n", 
çl£
,

379 0, 
AFF_FLYING
 | 
AFF_DETECT_INVIS
 | 
AFF_DETECT_HIDDEN
, 
OFF_BASH
 | 
OFF_FAST
 | 
OFF_DODGE
,

380 
IMM_POISON
, 0, 
VULN_LIGHT
,

381 
FÏgs
::
A
|FÏgs::
B
|FÏgs::
G
|FÏgs::
Z
, FÏgs::A|FÏgs::
C
|FÏgs::
D
|FÏgs::
E
|FÏgs::
F
|FÏgs::
H
|FÏgs::
J
|FÏgs::
K
|FÏgs::
Q
|FÏgs::
V
|FÏgs::
X


385 cÚ¡ 
	g¡d
::
veùÜ
<
pc_¿û_ty³
> 
pc_¿û_bË
 = {

400 { 13, 13, 13, 13, 13, 13 }, { 18, 18, 18, 18, 18, 18 }, 
SIZE_MEDIUM
, 0,

405 { 11, 15, 13, 15, 11, 14 }, { 16, 21, 18, 21, 16, 18 }, 
SIZE_SMALL
, 0,

410 { 15, 12, 14, 10, 17, 11 }, { 21, 16, 20, 15, 21, 16 }, 
SIZE_MEDIUM
, 0,

415 { 17, 10, 12, 12, 17, 12 }, { 23, 14, 17, 16, 22, 18 }, 
SIZE_HUGE
, 0,

420 { 14, 15, 13, 18, 13, 12 }, { 18, 19, 18, 22, 18, 17 }, 
SIZE_MEDIUM
, 0,

425 { 16, 16, 16, 15, 12, 14 }, { 19, 20, 22, 20, 17, 19 }, 
SIZE_MEDIUM
, 0,

430 { 12, 16, 16, 13, 13, 11 }, { 18, 21, 21, 18, 18, 15 }, 
SIZE_MEDIUM
, 0,

435 { 12, 16, 12, 17, 13, 14 }, { 15, 22, 18, 22, 18, 19 }, 
SIZE_SMALL
, 0,

440 { 15, 15, 15, 12, 15, 13 }, { 20, 19, 20, 16, 20, 18 }, 
SIZE_LARGE
, 0,

445 { 15, 13, 14, 16, 16, 14 }, { 20, 18, 18, 20, 21, 18 }, 
SIZE_MEDIUM
, 0,

450 { 16, 14, 14, 13, 15, 16 }, { 21, 18, 20, 17, 20, 21 }, 
SIZE_MEDIUM
, 0,

457 { 16, 16, 16, 16, 16, 16 }, { 20, 20, 20, 20, 20, 20 }, 
SIZE_MEDIUM
, 10,

462 { 16, 13, 13, 15, 17, 12 }, { 20, 17, 17, 19, 21, 16 }, 
SIZE_HUGE
, 999,

471 cÚ¡ 
	g¡d
::
veùÜ
<
de™y_ty³
> 
de™y_bË
 = {

488 cÚ¡ 
	g¡d
::
veùÜ
<
gud_ty³
> 
gud_bË
 = {

497 "mage", "Mag", 
STAT_INT
, 
OBJ_VNUM_SCHOOL_DAGGER
,

502 "ş”ic", "CË", 
STAT_WIS
, 
OBJ_VNUM_SCHOOL_MACE
,

507 "th›f", "Thi", 
STAT_DEX
, 
OBJ_VNUM_SCHOOL_DAGGER
,

512 "w¬riÜ", "W¬", 
STAT_STR
, 
OBJ_VNUM_SCHOOL_SWORD
,

517 "Ãüomªûr", "Nec", 
STAT_INT
, 
OBJ_VNUM_SCHOOL_POLEARM
,

522 "·Ïdš", "Pld", 
STAT_CHR
, 
OBJ_VNUM_SCHOOL_SWORD
,

527 "b¬d", "B¬", 
STAT_DEX
, 
OBJ_VNUM_SCHOOL_FLAIL
,

532 "¿ng”", "Rª", 
STAT_CON
, 
OBJ_VNUM_SCHOOL_AXE
,

542 cÚ¡ 
¡r_­p_ty³
 
	g¡r_­p
[26] = {

572 cÚ¡ 
št_­p_ty³
 
	gšt_­p
[26] = {

602 cÚ¡ 
wis_­p_ty³
 
	gwis_­p
[26] = {

632 cÚ¡ 
dex_­p_ty³
 
	gdex_­p
[26] = {

662 cÚ¡ 
cÚ_­p_ty³
 
	gcÚ_­p
 [26] = {

692 cÚ¡ 
chr_­p_ty³
 
	gchr_­p
[26] = {

725 cÚ¡ 
	g¡d
::
veùÜ
<
liq_ty³
> 
liq_bË
 = {

774 cÚ¡ 
	g¡d
::
m­
<
skl
::
ty³
, 
	gskl
::
skl_bË_t
> 
skl_bË
 = {

814 { 
skl
::
ty³
::
unknown
, {

817 0, 
TAR_IGNORE
, 
POS_STANDING
,

818 0, 0, "", 
Gud
::
nÚe
,

822 { 
skl
::
ty³
::
acid_bÏ¡
, {

825 
¥–l_acid_bÏ¡
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

826 20, 12, "acid bÏ¡", 
Gud
::
nÚe
,

829 { 
skl
::
ty³
::
acid_b»©h
, {

832 
¥–l_acid_b»©h
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

833 50, 12, "bÏ¡ oàacid", 
Gud
::
nÚe
,

836 { 
skl
::
ty³
::
acid_¿š
, {

839 
¥–l_acid_¿š
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

840 30, 12, "acid„aš", 
Gud
::
nÚe
,

843 { 
skl
::
ty³
::
age
, {

846 
¥–l_age
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

847 35, 12, "¥–l", 
Gud
::
nÚe
,

850 { 
skl
::
ty³
::
ªim©e_sk–‘Ú
, {

853 
¥–l_ªim©e_sk–‘Ú
, 
TAR_IGNORE
, 
POS_STANDING
,

854 50, 12, "", 
Gud
::
nÚe
,

857 { 
skl
::
ty³
::
ªim©e_w¿™h
, {

860 
¥–l_ªim©e_w¿™h
, 
TAR_IGNORE
, 
POS_STANDING
,

861 50, 12, "", 
Gud
::
nÚe
,

864 { 
skl
::
ty³
::
ªim©e_g¬goyË
, {

867 
¥–l_ªim©e_g¬goyË
, 
TAR_IGNORE
, 
POS_STANDING
,

868 50, 12, "", 
Gud
::
nÚe
,

871 { 
skl
::
ty³
::
ªim©e_zomb›
, {

874 
¥–l_ªim©e_zomb›
, 
TAR_IGNORE
, 
POS_STANDING
,

875 50, 12, "", 
Gud
::
nÚe
,

878 { 
skl
::
ty³
::
¬mÜ
, {

881 
¥–l_¬mÜ
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

882 5, 12, "", 
Gud
::
nÚe
,

885 { 
skl
::
ty³
::
bËss
, {

888 
¥–l_bËss
, 
TAR_OBJ_CHAR_DEF
, 
POS_STANDING
,

889 5, 12, "", 
Gud
::
nÚe
,

892 { 
skl
::
ty³
::
blšdÃss
, {

895 
¥–l_blšdÃss
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

896 5, 12, "", 
Gud
::
nÚe
,

899 { 
skl
::
ty³
::
blizz¬d
, {

902 
¥–l_blizz¬d
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

903 30, 12, "¢ow flu¼y", 
Gud
::
nÚe
,

906 { 
skl
::
ty³
::
blood_moÚ
, {

909 
¥–l_blood_moÚ
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

910 5, 12, "", 
Gud
::
nÚe
,

913 { 
skl
::
ty³
::
blood_bÏde
, {

916 
¥–l_blood_bÏde
, 
TAR_OBJ_INV
, 
POS_STANDING
,

917 100, 12, "", 
Gud
::
nÚe
,

920 { 
skl
::
ty³
::
buºšg_hªds
, {

923 
¥–l_buºšg_hªds
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

924 6, 12, "buºšg hªds", 
Gud
::
nÚe
,

927 { 
skl
::
ty³
::
ÿÎ_lighŠšg
, {

930 
¥–l_ÿÎ_lighŠšg
, 
TAR_IGNORE
, 
POS_FIGHTING
,

931 10, 12, "lighŠšg bŞt", 
Gud
::
nÚe
,

934 { 
skl
::
ty³
::
ÿlm
, {

937 
¥–l_ÿlm
, 
TAR_IGNORE
, 
POS_FIGHTING
,

938 30, 12, "", 
Gud
::
nÚe
,

941 { 
skl
::
ty³
::
ÿnûÎ©iÚ
, {

944 
¥–l_ÿnûÎ©iÚ
, 
TAR_CHAR_DEFENSIVE
, 
POS_FIGHTING
,

945 20, 12, "", 
Gud
::
nÚe
,

948 { 
skl
::
ty³
::
ÿu£_light
, {

951 
¥–l_ÿu£_light
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

952 5, 12, "¥–l", 
Gud
::
nÚe
,

955 { 
skl
::
ty³
::
ÿu£_£rious
, {

958 
¥–l_ÿu£_£rious
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

959 7, 12, "¥–l", 
Gud
::
nÚe
,

962 { 
skl
::
ty³
::
ÿu£_ü™iÿl
, {

965 
¥–l_ÿu£_ü™iÿl
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

966 10, 12, "¥–l", 
Gud
::
nÚe
,

969 { 
skl
::
ty³
::
chaš_lighŠšg
, {

972 
¥–l_chaš_lighŠšg
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

973 25, 12, "lighŠšg", 
Gud
::
nÚe
,

976 { 
skl
::
ty³
::
chªge_£x
, {

979 
¥–l_chªge_£x
, 
TAR_CHAR_DEFENSIVE
, 
POS_FIGHTING
,

980 15, 12, "", 
Gud
::
nÚe
,

983 { 
skl
::
ty³
::
chªÃl
, {

986 
¥–l_chªÃl
, 
TAR_IGNORE
, 
POS_STANDING
,

987 10, 12, "", 
Gud
::
nÚe
,

990 { 
skl
::
ty³
::
ch¬m_³rsÚ
, {

993 
¥–l_ch¬m_³rsÚ
, 
TAR_CHAR_OFFENSIVE
, 
POS_STANDING
,

994 5, 12, "", 
Gud
::
nÚe
,

997 { 
skl
::
ty³
::
chl_touch
, {

1000 
¥–l_chl_touch
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1001 5, 12, "chlšgouch", 
Gud
::
nÚe
,

1004 { 
skl
::
ty³
::
cŞour_¥¿y
, {

1007 
¥–l_cŞour_¥¿y
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1008 11, 12, "cŞou¸¥¿y", 
Gud
::
nÚe
,

1011 { 
skl
::
ty³
::
cÚtšu®_light
, {

1014 
¥–l_cÚtšu®_light
, 
TAR_IGNORE
, 
POS_STANDING
,

1015 7, 12, "", 
Gud
::
nÚe
,

1018 { 
skl
::
ty³
::
cÚŒŞ_w—th”
, {

1021 
¥–l_cÚŒŞ_w—th”
, 
TAR_IGNORE
, 
POS_STANDING
,

1022 25, 12, "", 
Gud
::
nÚe
,

1025 { 
skl
::
ty³
::
ü—‹_food
, {

1028 
¥–l_ü—‹_food
, 
TAR_IGNORE
, 
POS_STANDING
,

1029 5, 12, "", 
Gud
::
nÚe
,

1032 { 
skl
::
ty³
::
ü—‹_·rchm’t
, {

1035 
¥–l_ü—‹_·rchm’t
, 
TAR_IGNORE
, 
POS_STANDING
,

1036 30, 12, "", 
Gud
::
nÚe
,

1039 { 
skl
::
ty³
::
ü—‹_ro£
, {

1042 
¥–l_ü—‹_ro£
, 
TAR_IGNORE
, 
POS_STANDING
,

1043 30, 12, "", 
Gud
::
nÚe
,

1046 { 
skl
::
ty³
::
ü—‹_sign
, {

1049 
¥–l_ü—‹_sign
, 
TAR_IGNORE
, 
POS_STANDING
,

1050 45, 12, "", 
Gud
::
nÚe
,

1053 { 
skl
::
ty³
::
ü—‹_¥ršg
, {

1056 
¥–l_ü—‹_¥ršg
, 
TAR_IGNORE
, 
POS_STANDING
,

1057 20, 12, "", 
Gud
::
nÚe
,

1060 { 
skl
::
ty³
::
ü—‹_vŸl
, {

1063 
¥–l_ü—‹_vŸl
, 
TAR_IGNORE
, 
POS_STANDING
,

1064 30, 12, "", 
Gud
::
nÚe
,

1067 { 
skl
::
ty³
::
ü—‹_w©”
, {

1070 
¥–l_ü—‹_w©”
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1071 5, 12, "", 
Gud
::
nÚe
,

1074 { 
skl
::
ty³
::
cu»_blšdÃss
, {

1077 
¥–l_cu»_blšdÃss
, 
TAR_CHAR_DEFENSIVE
, 
POS_FIGHTING
,

1078 5, 12, "", 
Gud
::
nÚe
,

1081 { 
skl
::
ty³
::
cu»_ü™iÿl
, {

1084 
¥–l_cu»_ü™iÿl
, 
TAR_CHAR_DEFENSIVE
, 
POS_FIGHTING
,

1085 20, 12, "", 
Gud
::
nÚe
,

1088 { 
skl
::
ty³
::
cu»_di£a£
, {

1091 
¥–l_cu»_di£a£
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1092 20, 12, "", 
Gud
::
nÚe
,

1095 { 
skl
::
ty³
::
cu»_light
, {

1098 
¥–l_cu»_light
, 
TAR_CHAR_DEFENSIVE
, 
POS_FIGHTING
,

1099 10, 12, "", 
Gud
::
nÚe
,

1102 { 
skl
::
ty³
::
cu»_poisÚ
, {

1105 
¥–l_cu»_poisÚ
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1106 5, 12, "", 
Gud
::
nÚe
,

1109 { 
skl
::
ty³
::
cu»_£rious
, {

1112 
¥–l_cu»_£rious
, 
TAR_CHAR_DEFENSIVE
, 
POS_FIGHTING
,

1113 15, 12, "", 
Gud
::
nÚe
,

1116 { 
skl
::
ty³
::
cur£
, {

1119 
¥–l_cur£
, 
TAR_OBJ_CHAR_OFF
, 
POS_FIGHTING
,

1120 20, 12, "cur£", 
Gud
::
nÚe
,

1123 { 
skl
::
ty³
::
d¬kÃss
, {

1126 
¥–l_d¬kÃss
, 
TAR_IGNORE
, 
POS_STANDING
,

1127 60, 18, "", 
Gud
::
nÚe
,

1130 { 
skl
::
ty³
::
dazzlšg_light
, {

1133 
¥–l_dazzlšg_light
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1134 50, 12, "", 
Gud
::
nÚe
,

1137 { 
skl
::
ty³
::
demÚfœe
, {

1140 
¥–l_demÚfœe
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1141 18, 12, "tÜm’ts", 
Gud
::
nÚe
,

1144 { 
skl
::
ty³
::
d‘eù_ev
, {

1147 
¥–l_d‘eù_ev
, 
TAR_CHAR_SELF
, 
POS_STANDING
,

1148 5, 12, "", 
Gud
::
nÚe
,

1151 { 
skl
::
ty³
::
d‘eù_good
, {

1154 
¥–l_d‘eù_good
, 
TAR_CHAR_SELF
, 
POS_STANDING
,

1155 5, 12, "", 
Gud
::
nÚe
,

1158 { 
skl
::
ty³
::
d‘eù_hidd’
, {

1161 
¥–l_d‘eù_hidd’
, 
TAR_CHAR_SELF
, 
POS_STANDING
,

1162 5, 12, "", 
Gud
::
nÚe
,

1165 { 
skl
::
ty³
::
d‘eù_švis
, {

1168 
¥–l_d‘eù_švis
, 
TAR_CHAR_SELF
, 
POS_STANDING
,

1169 5, 12, "", 
Gud
::
nÚe
,

1172 { 
skl
::
ty³
::
d‘eù_magic
, {

1175 
¥–l_d‘eù_magic
, 
TAR_CHAR_SELF
, 
POS_STANDING
,

1176 5, 12, "", 
Gud
::
nÚe
,

1179 { 
skl
::
ty³
::
d‘eù_poisÚ
, {

1182 
¥–l_d‘eù_poisÚ
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1183 5, 12, "", 
Gud
::
nÚe
,

1186 { 
skl
::
ty³
::
di¥–_ev
, {

1189 
¥–l_di¥–_ev
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1190 10, 12, "di¥–ƒv", 
Gud
::
nÚe
,

1193 { 
skl
::
ty³
::
di¥–_good
, {

1196 
¥–l_di¥–_good
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1197 10, 12, "di¥– good", 
Gud
::
nÚe
,

1200 { 
skl
::
ty³
::
di¥–_magic
, {

1203 
¥–l_di¥–_magic
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1204 15, 12, "", 
Gud
::
nÚe
,

1207 { 
skl
::
ty³
::
divše_h—lšg
, {

1210 
¥–l_divše_h—lšg
, 
TAR_CHAR_DEFENSIVE
, 
POS_FIGHTING
,

1211 150, 12, "", 
Gud
::
nÚe
,

1214 { 
skl
::
ty³
::
divše_»g’”©iÚ
, {

1217 
¥–l_divše_»g’”©iÚ
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1218 50, 12, "", 
Gud
::
nÚe
,

1221 { 
skl
::
ty³
::
—¹hquake
, {

1224 
¥–l_—¹hquake
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1225 8, 12, "—¹hquake", 
Gud
::
nÚe
,

1228 { 
skl
::
ty³
::
’ÿmpm’t
, {

1231 
¥–l_’ÿmpm’t
, 
TAR_IGNORE
, 
POS_STANDING
,

1232 28, 12, "", 
Gud
::
nÚe
,

1235 { 
skl
::
ty³
::
’chªt_¬mÜ
, {

1238 
¥–l_’chªt_¬mÜ
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1239 100, 24, "", 
Gud
::
nÚe
,

1242 { 
skl
::
ty³
::
’chªt_w—pÚ
, {

1245 
¥–l_’chªt_w—pÚ
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1246 100, 24, "", 
Gud
::
nÚe
,

1249 { 
skl
::
ty³
::
’”gy_d¿š
, {

1252 
¥–l_’”gy_d¿š
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1253 40, 12, "’”gy d¿š", 
Gud
::
nÚe
,

1256 { 
skl
::
ty³
::
ç”›_fœe
, {

1259 
¥–l_ç”›_fœe
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1260 5, 12, "ç”› fœe", 
Gud
::
nÚe
,

1263 { 
skl
::
ty³
::
ç”›_fog
, {

1266 
¥–l_ç”›_fog
, 
TAR_IGNORE
, 
POS_STANDING
,

1267 12, 12, "ç”› fog", 
Gud
::
nÚe
,

1270 { 
skl
::
ty³
::
çrsight
, {

1273 
¥–l_çrsight
, 
TAR_IGNORE
, 
POS_STANDING
,

1274 36, 20, "çrsight", 
Gud
::
nÚe
,

1277 { 
skl
::
ty³
::
ã¬
, {

1280 
¥–l_ã¬
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1281 20, 12, "ã¬", 
Gud
::
nÚe
,

1284 { 
skl
::
ty³
::
fœe_b»©h
, {

1287 
¥–l_fœe_b»©h
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1288 60, 12, "bÏ¡ oàæame", 
Gud
::
nÚe
,

1291 { 
skl
::
ty³
::
fœeb®l
, {

1294 
¥–l_fœeb®l
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1295 10, 12, "fœeb®l", 
Gud
::
nÚe
,

1298 { 
skl
::
ty³
::
fœ•roof
, {

1301 
¥–l_fœ•roof
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1302 10, 12, "", 
Gud
::
nÚe
,

1305 { 
skl
::
ty³
::
fœe¡Üm
, {

1308 
¥–l_fœe¡Üm
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1309 35, 12, "fœe¡Üm", 
Gud
::
nÚe
,

1312 { 
skl
::
ty³
::
æame_bÏde
, {

1315 
¥–l_æame_bÏde
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1316 100, 12, "", 
Gud
::
nÚe
,

1319 { 
skl
::
ty³
::
æamesh›ld
, {

1322 
¥–l_æamesh›ld
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1323 45, 12, "æamesh›ld", 
Gud
::
nÚe
,

1326 { 
skl
::
ty³
::
æame¡rike
, {

1329 
¥–l_æame¡rike
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1330 12, 12, "æame¡rike", 
Gud
::
nÚe
,

1333 { 
skl
::
ty³
::
æy
, {

1336 
¥–l_æy
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1337 10, 12, "", 
Gud
::
nÚe
,

1340 { 
skl
::
ty³
::
æßtšg_disc
, {

1343 
¥–l_æßtšg_disc
, 
TAR_IGNORE
, 
POS_STANDING
,

1344 40, 24, "", 
Gud
::
nÚe
,

1347 { 
skl
::
ty³
::
ä’zy
, {

1350 
¥–l_ä’zy
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1351 30, 12, "", 
Gud
::
nÚe
,

1354 { 
skl
::
ty³
::
äo¡_bÏde
, {

1357 
¥–l_äo¡_bÏde
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1358 100, 12, "", 
Gud
::
nÚe
,

1361 { 
skl
::
ty³
::
äo¡_b»©h
, {

1364 
¥–l_äo¡_b»©h
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1365 50, 12, "bÏ¡ oàäo¡", 
Gud
::
nÚe
,

1368 { 
skl
::
ty³
::
gas_b»©h
, {

1371 
¥–l_gas_b»©h
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1372 45, 12, "bÏ¡ oàgas", 
Gud
::
nÚe
,

1375 { 
skl
::
ty³
::
g©e
, {

1378 
¥–l_g©e
, 
TAR_IGNORE
, 
POS_STANDING
,

1379 80, 12, "", 
Gud
::
nÚe
,

1382 { 
skl
::
ty³
::
g’”®_pu½o£
, {

1385 
¥–l_g’”®_pu½o£
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1386 5, 12, "g’”®…u½o£‡mmo", 
Gud
::
nÚe
,

1389 { 
skl
::
ty³
::
gŸÁ_¡»ngth
, {

1392 
¥–l_gŸÁ_¡»ngth
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1393 20, 12, "", 
Gud
::
nÚe
,

1396 { 
skl
::
ty³
::
h¬m
, {

1399 
¥–l_h¬m
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1400 20, 12, "h¬m s³Î", 
Gud
::
nÚe
,

1403 { 
skl
::
ty³
::
ha¡e
, {

1406 
¥–l_ha¡e
, 
TAR_CHAR_DEFENSIVE
, 
POS_FIGHTING
,

1407 30, 12, "", 
Gud
::
nÚe
,

1410 { 
skl
::
ty³
::
h—l
, {

1413 
¥–l_h—l
, 
TAR_CHAR_DEFENSIVE
, 
POS_FIGHTING
,

1414 50, 12, "", 
Gud
::
nÚe
,

1417 { 
skl
::
ty³
::
h—t_m‘®
, {

1420 
¥–l_h—t_m‘®
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1421 25, 18, "¥–l", 
Gud
::
nÚe
,

1424 { 
skl
::
ty³
::
high_ex¶osive
, {

1427 
¥–l_high_ex¶osive
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1428 5, 12, "highƒx¶osivammo", 
Gud
::
nÚe
,

1431 { 
skl
::
ty³
::
hŞy_wÜd
, {

1434 
¥–l_hŞy_wÜd
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1435 200, 24, "divšw¿th", 
Gud
::
nÚe
,

1438 { 
skl
::
ty³
::
id’tify
, {

1441 
¥–l_id’tify
, 
TAR_OBJ_HERE
, 
POS_STANDING
,

1442 12, 12, "", 
Gud
::
nÚe
,

1445 { 
skl
::
ty³
::
night_visiÚ
, {

1448 
¥–l_šäavisiÚ
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1449 5, 18, "", 
Gud
::
nÚe
,

1452 { 
skl
::
ty³
::
švis
, {

1455 
¥–l_švis
, 
TAR_OBJ_CHAR_DEF
, 
POS_STANDING
,

1456 5, 12, "", 
Gud
::
nÚe
,

1459 { 
skl
::
ty³
::
know_®ignm’t
, {

1462 
¥–l_know_®ignm’t
, 
TAR_CHAR_DEFENSIVE
, 
POS_FIGHTING
,

1463 9, 12, "", 
Gud
::
nÚe
,

1466 { 
skl
::
ty³
::
light_of_Œuth
, {

1469 
¥–l_light_of_Œuth
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1470 100, 12, "", 
Gud
::
nÚe
,

1473 { 
skl
::
ty³
::
lighŠšg_bŞt
, {

1476 
¥–l_lighŠšg_bŞt
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1477 8, 12, "lighŠšg bŞt", 
Gud
::
nÚe
,

1480 { 
skl
::
ty³
::
lighŠšg_b»©h
, {

1483 
¥–l_lighŠšg_b»©h
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1484 65, 12, "bÏ¡ oàlighŠšg", 
Gud
::
nÚe
,

1487 { 
skl
::
ty³
::
loÿ‹_liã
, {

1490 
¥–l_loÿ‹_liã
, 
TAR_IGNORE
, 
POS_STANDING
,

1491 20, 18, "", 
Gud
::
nÚe
,

1494 { 
skl
::
ty³
::
loÿ‹_objeù
, {

1497 
¥–l_loÿ‹_objeù
, 
TAR_IGNORE
, 
POS_STANDING
,

1498 20, 18, "", 
Gud
::
nÚe
,

1501 { 
skl
::
ty³
::
magic_misse
, {

1504 
¥–l_magic_misse
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1505 5, 12, "magiømisse", 
Gud
::
nÚe
,

1508 { 
skl
::
ty³
::
mass_h—lšg
, {

1511 
¥–l_mass_h—lšg
, 
TAR_IGNORE
, 
POS_STANDING
,

1512 100, 36, "", 
Gud
::
nÚe
,

1515 { 
skl
::
ty³
::
mass_švis
, {

1518 
¥–l_mass_švis
, 
TAR_IGNORE
, 
POS_STANDING
,

1519 20, 24, "", 
Gud
::
nÚe
,

1522 { 
skl
::
ty³
::
Ãxus
, {

1525 
¥–l_Ãxus
, 
TAR_IGNORE
, 
POS_STANDING
,

1526 150, 36, "", 
Gud
::
nÚe
,

1529 { 
skl
::
ty³
::
·ss_doÜ
, {

1532 
¥–l_·ss_doÜ
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1533 20, 12, "", 
Gud
::
nÚe
,

1536 { 
skl
::
ty³
::
¶ague
, {

1539 
¥–l_¶ague
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1540 20, 12, "sickÃss", 
Gud
::
nÚe
,

1543 { 
skl
::
ty³
::
poisÚ
, {

1546 
¥–l_poisÚ
, 
TAR_OBJ_CHAR_OFF
, 
POS_FIGHTING
,

1547 10, 12, "poisÚ", 
Gud
::
nÚe
,

1550 { 
skl
::
ty³
::
pow”_wÜd
, {

1553 
¥–l_pow”_wÜd
, 
TAR_CHAR_OFFENSIVE
, 
POS_STANDING
,

1554 50, 12, "pow” wÜd", 
Gud
::
nÚe
,

1557 { 
skl
::
ty³
::
pŞymÜph
, {

1560 
¥–l_pŞymÜph
, 
TAR_IGNORE
, 
POS_STANDING
,

1561 100, 18, "", 
Gud
::
nÚe
,

1564 { 
skl
::
ty³
::
pÜl
, {

1567 
¥–l_pÜl
, 
TAR_IGNORE
, 
POS_STANDING
,

1568 100, 24, "", 
Gud
::
nÚe
,

1571 { 
skl
::
ty³
::
´Ùeù_cÚš”
, {

1574 
¥–l_´Ùeù_cÚš”
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1575 50, 18, "", 
Gud
::
nÚe
,

1578 { 
skl
::
ty³
::
´ÙeùiÚ_ev
, {

1581 
¥–l_´ÙeùiÚ_ev
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1582 5, 12, "", 
Gud
::
nÚe
,

1585 { 
skl
::
ty³
::
´ÙeùiÚ_good
, {

1588 
¥–l_´ÙeùiÚ_good
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1589 5, 12, "", 
Gud
::
nÚe
,

1592 { 
skl
::
ty³
::
¿ybª
, {

1595 
¥–l_¿ybª
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1596 5, 12, "", 
Gud
::
nÚe
,

1599 { 
skl
::
ty³
::
¿y_of_Œuth
, {

1602 
¥–l_¿y_of_Œuth
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1603 18, 12, "¿y oàŒuth", 
Gud
::
nÚe
,

1606 { 
skl
::
ty³
::
»ch¬ge
, {

1609 
¥–l_»ch¬ge
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1610 60, 24, "", 
Gud
::
nÚe
,

1613 { 
skl
::
ty³
::
»äesh
, {

1616 
¥–l_»äesh
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1617 12, 18, "»äesh", 
Gud
::
nÚe
,

1620 { 
skl
::
ty³
::
»su¼eù
, {

1623 
¥–l_»su¼eù
, 
TAR_IGNORE
, 
POS_STANDING
,

1624 100, 15, "", 
Gud
::
nÚe
,

1627 { 
skl
::
ty³
::
»g’”©iÚ
, {

1630 
¥–l_»g’”©iÚ
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1631 20, 12, "", 
Gud
::
nÚe
,

1634 { 
skl
::
ty³
::
»move_®ignm’t
, {

1637 
¥–l_»move_®ignm’t
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1638 75, 18, "", 
Gud
::
nÚe
,

1641 { 
skl
::
ty³
::
»move_švis
, {

1644 
¥–l_»move_švis
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1645 40, 18, "", 
Gud
::
nÚe
,

1648 { 
skl
::
ty³
::
»move_cur£
, {

1651 
¥–l_»move_cur£
, 
TAR_OBJ_CHAR_DEF
, 
POS_STANDING
,

1652 5, 12, "", 
Gud
::
nÚe
,

1655 { 
skl
::
ty³
::
§nùu¬y
, {

1658 
¥–l_§nùu¬y
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1659 75, 12, "§nùu¬y", 
Gud
::
nÚe
,

1662 { 
skl
::
ty³
::
süy
, {

1665 
¥–l_süy
, 
TAR_IGNORE
, 
POS_RESTING
,

1666 30, 20, "", 
Gud
::
nÚe
,

1669 { 
skl
::
ty³
::
sh›ld
, {

1672 
¥–l_sh›ld
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1673 12, 12, "", 
Gud
::
nÚe
,

1676 { 
skl
::
ty³
::
shock_bÏde
, {

1679 
¥–l_shock_bÏde
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1680 100, 12, "", 
Gud
::
nÚe
,

1683 { 
skl
::
ty³
::
shockšg_g¿¥
, {

1686 
¥–l_shockšg_g¿¥
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1687 7, 12, "shockšg g¿¥", 
Gud
::
nÚe
,

1690 { 
skl
::
ty³
::
shršk
, {

1693 
¥–l_shršk
, 
TAR_OBJ_INV
, 
POS_STANDING
,

1694 100, 12, "", 
Gud
::
nÚe
,

1697 { 
skl
::
ty³
::
¦“p
, {

1700 
¥–l_¦“p
, 
TAR_CHAR_OFFENSIVE
, 
POS_STANDING
,

1701 15, 12, "", 
Gud
::
nÚe
,

1704 { 
skl
::
ty³
::
¦ow
, {

1707 
¥–l_¦ow
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1708 30, 12, "", 
Gud
::
nÚe
,

1711 { 
skl
::
ty³
::
smokesü“n
, {

1714 
¥–l_smokesü“n
, 
TAR_IGNORE
, 
POS_STANDING
,

1715 25, 12, "", 
Gud
::
nÚe
,

1718 { 
skl
::
ty³
::
¡¬ve
, {

1721 
¥–l_¡¬ve
, 
TAR_CHAR_OFFENSIVE
, 
POS_STANDING
,

1722 10, 8, "", 
Gud
::
nÚe
,

1725 { 
skl
::
ty³
::
¡“l_mi¡
, {

1728 
¥–l_¡“l_mi¡
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1729 35, 12, "", 
Gud
::
nÚe
,

1732 { 
skl
::
ty³
::
¡Úe_skš
, {

1735 
¥–l_¡Úe_skš
, 
TAR_CHAR_SELF
, 
POS_STANDING
,

1736 12, 12, "", 
Gud
::
nÚe
,

1739 { 
skl
::
ty³
::
summÚ
, {

1742 
¥–l_summÚ
, 
TAR_IGNORE
, 
POS_STANDING
,

1743 50, 12, "", 
Gud
::
nÚe
,

1746 { 
skl
::
ty³
::
summÚ_objeù
, {

1749 
¥–l_summÚ_objeù
, 
TAR_IGNORE
, 
POS_STANDING
,

1750 65, 12, "", 
Gud
::
nÚe
,

1753 { 
skl
::
ty³
::
suÄay
, {

1756 
¥–l_suÄay
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1757 40, 12, "suÄay", 
Gud
::
nÚe
,

1760 { 
skl
::
ty³
::
lÚ
, {

1763 
¥–l_lÚ
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

1764 25, 12, "", 
Gud
::
nÚe
,

1767 { 
skl
::
ty³
::
‹ËpÜt
, {

1770 
¥–l_‹ËpÜt
, 
TAR_CHAR_SELF
, 
POS_FIGHTING
,

1771 35, 12, "", 
Gud
::
nÚe
,

1774 { 
skl
::
ty³
::
‹ËpÜt_objeù
, {

1777 
¥–l_‹ËpÜt_objeù
, 
TAR_IGNORE
, 
POS_STANDING
,

1778 25, 18, "", 
Gud
::
nÚe
,

1781 { 
skl
::
ty³
::
undo_¥–l
, {

1784 
¥–l_undo_¥–l
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1785 15, 18, "", 
Gud
::
nÚe
,

1788 { 
skl
::
ty³
::
v’Œoqu©e
, {

1791 
¥–l_v’Œoqu©e
, 
TAR_IGNORE
, 
POS_STANDING
,

1792 5, 12, "", 
Gud
::
nÚe
,

1795 { 
skl
::
ty³
::
visiÚ
, {

1798 
¥–l_visiÚ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1799 80, 12, "", 
Gud
::
nÚe
,

1802 { 
skl
::
ty³
::
w—k’
, {

1805 
¥–l_w—k’
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1806 20, 12, "¥–l", 
Gud
::
nÚe
,

1809 { 
skl
::
ty³
::
wÜd_of_»ÿÎ
, {

1812 
¥–l_wÜd_of_»ÿÎ
, 
TAR_CHAR_SELF
, 
POS_RESTING
,

1813 5, 12, "", 
Gud
::
nÚe
,

1816 { 
skl
::
ty³
::
w¿th
, {

1819 
¥–l_w¿th
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1820 30, 12, "w¿th", 
Gud
::
nÚe
,

1826 { 
skl
::
ty³
::
axe
, {

1829 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1830 0, 0, "", 
Gud
::
nÚe
,

1833 { 
skl
::
ty³
::
dagg”
, {

1836 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1837 0, 0, "", 
Gud
::
nÚe
,

1840 { 
skl
::
ty³
::
æa
, {

1843 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1844 0, 0, "", 
Gud
::
nÚe
,

1847 { 
skl
::
ty³
::
maû
, {

1850 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1851 0, 0, "", 
Gud
::
nÚe
,

1854 { 
skl
::
ty³
::
pŞ—rm
, {

1857 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1858 0, 0, "", 
Gud
::
nÚe
,

1861 { 
skl
::
ty³
::
¥—r
, {

1864 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1865 0, 0, "", 
Gud
::
nÚe
,

1868 { 
skl
::
ty³
::
swÜd
, {

1871 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1872 0, 0, "", 
Gud
::
nÚe
,

1875 { 
skl
::
ty³
::
wh
, {

1878 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1879 0, 0, "", 
Gud
::
nÚe
,

1882 { 
skl
::
ty³
::
¬ch”y
, {

1885 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

1886 0, 0, "", 
Gud
::
nÚe
,

1889 { 
skl
::
ty³
::
sh›ld_block
, {

1892 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1893 0, 0, "", 
Gud
::
nÚe
,

1896 { 
skl
::
ty³
::
b»w
, {

1899 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

1900 15, 24, "", 
Gud
::
nÚe
,

1903 { 
skl
::
ty³
::
süibe
, {

1906 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

1907 15, 24, "", 
Gud
::
nÚe
,

1910 { 
skl
::
ty³
::
back¡ab
, {

1913 
¥–l_nuÎ
, 
TAR_CHAR_OFFENSIVE
, 
POS_STANDING
,

1914 30, 24, "back¡ab", 
Gud
::
nÚe
,

1917 { 
skl
::
ty³
::
bash
, {

1920 
¥–l_nuÎ
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1921 15, 24, "bash", 
Gud
::
nÚe
,

1924 { 
skl
::
ty³
::
b”£rk
, {

1927 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1928 30, 24, "", 
Gud
::
nÚe
,

1931 { 
skl
::
ty³
::
cœşe
, {

1934 
¥–l_nuÎ
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1935 20, 36, "cœşe", 
Gud
::
nÚe
,

1938 { 
skl
::
ty³
::
üush
, {

1941 
¥–l_nuÎ
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1942 15, 12, "üushšg blow", 
Gud
::
nÚe
,

1945 { 
skl
::
ty³
::
dœt_kickšg
, {

1948 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1949 10, 24, "kicked dœt", 
Gud
::
nÚe
,

1952 { 
skl
::
ty³
::
di§rm
, {

1955 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1956 15, 24, "", 
Gud
::
nÚe
,

1959 { 
skl
::
ty³
::
dodge
, {

1962 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1963 0, 0, "", 
Gud
::
nÚe
,

1966 { 
skl
::
ty³
::
’hªûd_damage
, {

1969 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1970 0, 0, "", 
Gud
::
nÚe
,

1973 { 
skl
::
ty³
::
’v’om
, {

1976 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_RESTING
,

1977 10, 36, "", 
Gud
::
nÚe
,

1980 { 
skl
::
ty³
::
hªd_to_hªd
, {

1983 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

1984 0, 0, "", 
Gud
::
nÚe
,

1987 { 
skl
::
ty³
::
kick
, {

1990 
¥–l_nuÎ
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1991 15, 12, "kick", 
Gud
::
nÚe
,

1995 { 
skl
::
ty³
::
roundhou£
, {

1998 
¥–l_nuÎ
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

1999 15, 12, "roundhou£", 
Gud
::
nÚe
,

2003 { 
skl
::
ty³
::
foÙsw“p
, {

2006 
¥–l_nuÎ
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

2007 15, 12, "foÙsw“p", 
Gud
::
nÚe
,

2011 { 
skl
::
ty³
::
·¼y
, {

2014 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

2015 0, 0, "", 
Gud
::
nÚe
,

2018 { 
skl
::
ty³
::
»scue
, {

2021 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

2022 5, 12, "", 
Gud
::
nÚe
,

2025 { 
skl
::
ty³
::
Œ
, {

2028 
¥–l_nuÎ
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

2029 15, 24, "Œ", 
Gud
::
nÚe
,

2032 { 
skl
::
ty³
::
£cÚd_©ck
, {

2035 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

2036 0, 0, "", 
Gud
::
nÚe
,

2039 { 
skl
::
ty³
::
thœd_©ck
, {

2042 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

2043 0, 0, "", 
Gud
::
nÚe
,

2046 { 
skl
::
ty³
::
du®_w›ld
, {

2049 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

2050 0, 0, "", 
Gud
::
nÚe
,

2053 { 
skl
::
ty³
::
huÁ
, {

2056 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2057 20, 12, "", 
Gud
::
nÚe
,

2060 { 
skl
::
ty³
::
uÇrmed
, {

2063 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

2064 0, 0, "smash", 
Gud
::
nÚe
,

2070 { 
skl
::
ty³
::
swimmšg
, {

2073 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

2074 0, 0, "swimmšg", 
Gud
::
nÚe
,

2077 { 
skl
::
ty³
::
ç¡_h—lšg
, {

2080 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_SLEEPING
,

2081 0, 0, "", 
Gud
::
nÚe
,

2084 { 
skl
::
ty³
::
fœebudšg
, {

2087 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2088 5, 24, "", 
Gud
::
nÚe
,

2091 { 
skl
::
ty³
::
fÜge
, {

2094 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2095 20, 24, "", 
Gud
::
nÚe
,

2098 { 
skl
::
ty³
::
»·œ
, {

2101 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2102 15, 24, "", 
Gud
::
nÚe
,

2105 { 
skl
::
ty³
::
rÙ©e
, {

2108 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2109 5, 24, "", 
Gud
::
nÚe
,

2112 { 
skl
::
ty³
::
Ïnguages
, {

2115 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2116 0, 24, "", 
Gud
::
nÚe
,

2119 { 
skl
::
ty³
::
haggË
, {

2122 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_RESTING
,

2123 0, 0, "", 
Gud
::
nÚe
,

2126 { 
skl
::
ty³
::
hide
, {

2129 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_RESTING
,

2130 15, 12, "", 
Gud
::
nÚe
,

2133 { 
skl
::
ty³
::
lÜe
, {

2136 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_RESTING
,

2137 5, 36, "", 
Gud
::
nÚe
,

2140 { 
skl
::
ty³
::
med™©iÚ
, {

2143 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_SLEEPING
,

2144 0, 0, "", 
Gud
::
nÚe
,

2147 { 
skl
::
ty³
::
³ek
, {

2150 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2151 5, 0, "", 
Gud
::
nÚe
,

2154 { 
skl
::
ty³
::
pick_lock
, {

2157 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2158 15, 12, "", 
Gud
::
nÚe
,

2161 { 
skl
::
ty³
::
sÿn
, {

2164 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2165 0, 12, "", 
Gud
::
nÚe
,

2168 { 
skl
::
ty³
::
¢—k
, {

2171 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2172 15, 12, "", 
Gud
::
nÚe
,

2175 { 
skl
::
ty³
::
¡—l
, {

2178 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2179 10, 24, "", 
Gud
::
nÚe
,

2182 { 
skl
::
ty³
::
sšg
, {

2185 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2186 15, 24, "", 
Gud
::
nÚe
,

2189 { 
skl
::
ty³
::
süŞls
, {

2192 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2193 10, 18, "", 
Gud
::
nÚe
,

2196 { 
skl
::
ty³
::
¥ou£g©e
, {

2199 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2200 25, 12, "", 
Gud
::
nÚe
,

2203 { 
skl
::
ty³
::
¡aves
, {

2206 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2207 10, 18, "", 
Gud
::
nÚe
,

2210 { 
skl
::
ty³
::
wªds
, {

2213 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2214 10, 18, "", 
Gud
::
nÚe
,

2217 { 
skl
::
ty³
::
»ÿÎ
, {

2220 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2221 0, 12, "", 
Gud
::
nÚe
,

2224 { 
skl
::
ty³
::
Ïy_Ú_hªds
, {

2227 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_RESTING
,

2228 0, 24, "", 
Gud
::
nÚe
,

2231 { 
skl
::
ty³
::
çmŸr
, {

2234 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_RESTING
,

2235 0, 20, "", 
Gud
::
nÚe
,

2238 { 
skl
::
ty³
::
d›_h¬d
, {

2241 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_DEAD
,

2242 0, 4, "", 
Gud
::
nÚe
,

2284 { 
skl
::
ty³
::
sh“n
, {

2287 
¥–l_sh“n
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

2288 80, 12, "sh“n", 
Gud
::
mage
,

2291 { 
skl
::
ty³
::
focus
, {

2294 
¥–l_focus
, 
TAR_CHAR_SELF
, 
POS_STANDING
,

2295 200, 12, "focus", 
Gud
::
mage
,

2298 { 
skl
::
ty³
::
·¿lyze
, {

2301 
¥–l_·¿lyze
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

2302 50, 12, "·¿lyze", 
Gud
::
mage
,

2315 { 
skl
::
ty³
::
b¬r›r
, {

2318 
¥–l_b¬r›r
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

2319 150, 12, "b¬r›r", 
Gud
::
ş”ic
,

2322 { 
skl
::
ty³
::
dazzË
, {

2325 
¥–l_dazzË
, 
TAR_CHAR_DEFENSIVE
, 
POS_FIGHTING
,

2326 50, 12, "dazzË", 
Gud
::
ş”ic
,

2329 { 
skl
::
ty³
::
fuÎ_h—l
, {

2332 
¥–l_fuÎ_h—l
, 
TAR_CHAR_DEFENSIVE
, 
POS_FIGHTING
,

2333 100, 12, "fuÎ h—l", 
Gud
::
ş”ic
,

2339 { 
skl
::
ty³
::
midnight
, {

2342 
¥–l_midnight
, 
TAR_CHAR_DEFENSIVE
, 
POS_STANDING
,

2343 100, 12, "midnight", 
Gud
::
th›f
,

2346 { 
skl
::
ty³
::
shadow_fÜm
, {

2349 
¥–l_nuÎ
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

2350 50, 36, "shadow fÜm", 
Gud
::
th›f
,

2353 { 
skl
::
ty³
::
hÚe
, {

2356 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2357 40, 24, "", 
Gud
::
th›f
,

2363 { 
skl
::
ty³
::
ro¡e
, {

2366 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2367 0, 0, "ro¡e", 
Gud
::
w¬riÜ
,

2370 { 
skl
::
ty³
::
fou¹h_©ck
, {

2373 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

2374 0, 0, "", 
Gud
::
w¬riÜ
,

2377 { 
skl
::
ty³
::
¿ge
, {

2380 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

2381 40, 36, "¿ge", 
Gud
::
w¬riÜ
,

2384 { 
skl
::
ty³
::
blšd_fight
, {

2387 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2388 0, 0, "", 
Gud
::
w¬riÜ
,

2394 { 
skl
::
ty³
::
§p
, {

2397 
¥–l_§p
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

2398 80, 12, "§p", 
Gud
::
Ãüomªûr
,

2401 { 
skl
::
ty³
::
·š
, {

2404 
¥–l_·š
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

2405 50, 12, "tÜm’ts", 
Gud
::
Ãüomªûr
,

2408 { 
skl
::
ty³
::
hex
, {

2411 
¥–l_hex
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

2412 100, 12, "hex", 
Gud
::
Ãüomªûr
,

2415 { 
skl
::
ty³
::
bÚe_w®l
, {

2418 
¥–l_bÚe_w®l
, 
TAR_CHAR_SELF
, 
POS_STANDING
,

2419 80, 12, "w®ÈoàbÚes", 
Gud
::
Ãüomªûr
,

2425 { 
skl
::
ty³
::
hamm”¡rike
, {

2428 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

2429 0, 36, "hamm”¡rike", 
Gud
::
·Ïdš
,

2432 { 
skl
::
ty³
::
fÜû_sh›ld
, {

2435 
¥–l_fÜû
, 
TAR_CHAR_DEFENSIVE
, 
POS_FIGHTING
,

2436 150, 12, "fÜû sh›ld", 
Gud
::
·Ïdš
,

2439 { 
skl
::
ty³
::
hŞy_swÜd
, {

2442 
¥–l_hŞy_swÜd
, 
TAR_IGNORE
, 
POS_STANDING
,

2443 40, 36, "", 
Gud
::
·Ïdš
,

2449 { 
skl
::
ty³
::
®ign
, {

2452 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2453 5, 0, "", 
Gud
::
b¬d
,

2456 { 
skl
::
ty³
::
blur
, {

2459 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

2460 0, 0, "", 
Gud
::
b¬d
,

2463 { 
skl
::
ty³
::
du®_£cÚd
, {

2466 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

2467 0, 0, "", 
Gud
::
b¬d
,

2470 { 
skl
::
ty³
::
quick
, {

2473 
¥–l_quick
, 
TAR_IGNORE
, 
POS_FIGHTING
,

2474 60, 12, "quick", 
Gud
::
b¬d
,

2480 { 
skl
::
ty³
::
¡ªdç¡
, {

2483 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_FIGHTING
,

2484 0, 0, "", 
Gud
::
¿ng”
,

2487 { 
skl
::
ty³
::
m¬k
, {

2490 
¥–l_nuÎ
, 
TAR_IGNORE
, 
POS_STANDING
,

2491 50, 0, "", 
Gud
::
¿ng”
,

2494 { 
skl
::
ty³
::
ü™iÿl_blow
, {

2497 
¥–l_nuÎ
, 
TAR_CHAR_OFFENSIVE
, 
POS_FIGHTING
,

2498 30, 36, "ü™iÿÈblow", 
Gud
::
¿ng”
,

2505 cÚ¡ 
	g¡d
::
veùÜ
<
group_ty³
> 
group_bË
 = {

	@src/debug.cc

28 
	~"¬gum’t.hh
"

29 
	~"afãù/Afãù.hh
"

30 
	~"A»a.hh
"

31 
	~"Ch¬aù”.hh
"

32 
	~"deş¬e.hh
"

33 
	~"fšd.hh
"

34 
	~"FÏgs.hh
"

35 
	~"Game.hh
"

36 
	~"GameTime.hh
"

37 
	~"loÙv2.hh
"

38 
	~"m”c.hh
"

39 
	~"Objeù.hh
"

40 
	~"ObjeùPrÙÙy³.hh
"

41 
	~"PÏy”.hh
"

42 
	~"¿ndom.hh
"

43 
	~"Room.hh
"

44 
	~"SŒšg.hh
"

45 
	~"W—th”.hh
"

46 
	~"ut/Image.hh
"

47 
	~"WÜld.hh
"

52 
	$do_debug
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

54 
SŒšg
 
subfunc
;

55 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
subfunc
);

57 ià(
subfunc
.
	`em±y
()) {

58 
	`¡c
("Currently defined DEBUG subfunctions‡re:\n"

71 "‡ffÿÎ - i‹¿‹hrough‡fãùs\n", 
ch
);

80 ià(
subfunc
 == "printimg") {

81 ià(
¬gum’t
.
	`em±y
()) {

82 
	`±c
(
ch
, "Need‡ filename.\n");

86 
ut
::
Image
 
image
;

87 ià(!
image
.
	`lßd
(
¬gum’t
)) {

88 
	`±c
(
ch
, "Couldn't†oad it.\n");

92 
SŒšg
 
buf
;

93 
rgb
 = 
ut
::
Image
::
»d
;„gb <ğut::Image::
®pha
;„gb++) {

94 
buf
 +ğ
FÜm©
::
	`fÜm©
("rgb = %d, x = %d, y = %d\n", 
rgb
, 
image
.
	`width
(), image.
	`height
());

95 
y
 = 0; y < 
image
.
	`height
(); y++) {

96 
x
 = 0; x < 
image
.
	`width
(); x++)

97 
buf
 +ğ
FÜm©
::
	`fÜm©
("%02x", 
image
.
	`v®ue
((
ut
::
Image
::
ChªÃl
)
rgb
, 
x
, 
y
));

98 
buf
 += "\n";

102 
	`±c
(
ch
, 
buf
);

106 ià(
subfunc
 == "objstate") {

107 
	`obj¡©e_§ve_™ems
();

111 ià(
subfunc
 == "strtest") {

112 
row
 = 4;„ow < 16;„ow++) {

113 
cŞ
 = 0; col < 8; col++) {

114 
v
 = 
row
 * 8 + 
cŞ
;

115 
	`±c
(
ch
, "%3d: {Y%1c{x ", 
v
, v);

117 
	`¡c
("\n", 
ch
);

122 ià(
subfunc
 == "crash") {

123 
Ch¬aù”
 *
v
 = 
nuÎ±r
;

124 
v
->
Çme
 = "test";

182 ià(!
	`¡rcmp
(
subfunc
, "geneq")) {

183 
SŒšg
 
¬g
;

184 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

186 ià(
¬g
.
	`em±y
(è|| !¬g.
	`is_numb”
()) {

187 
	`¡c
("U§ge: debug g’eq <Ëv–>\n", 
ch
);

191 
Ëv–
 = 
	`©oi
(
¬g
);

193 ià(
Ëv–
 < 1 ||†evel > 100) {

194 
	`¡c
("Lev– i b‘w“À1‡nd 100.\n", 
ch
);

198 
Objeù
 *
obj
 = 
	`g’”©e_eq
(
Ëv–
);

200 ià(
obj
)

201 
	`obj_to_ch¬
(
obj
, 
ch
);

203 
	`¡c
("LoÙ RŞËd\n", 
ch
);

207 ià(!
	`¡rcmp
(
subfunc
, "rng")) {

208 
™”©iÚs
 = 
	`©Ş
(
¬gum’t
.
	`c_¡r
());

210 
nums
[100];

212 
i
 = 0; i < 100; i++)

213 
nums
[
i
] = 0;

215 
i
 = 0; i < 
™”©iÚs
; i++)

216 
nums
[
	`numb”_¿nge
(1,100)-1]++;

218 
sum
 = 0;

220 
i
 = 0; i < 100; i++) {

221 
sum
 +ğ
nums
[
i
];

222 
	`±c
(
ch
, "[%3d] %.4f %.4f (%ld)\n",

223 
i
 + 1,

224 100 * 
nums
[
i
] / ()
™”©iÚs
,

225 100 * 
sum
 / ()
™”©iÚs
,

226 
nums
[
i
]

233 ià(!
	`¡rcmp
(
subfunc
, "rng2")) {

234 
™”©iÚs
 = 
	`©Ş
(
¬gum’t
.
	`c_¡r
());

236 
nums
[100];

238 
i
 = 0; i < 100; i++)

239 
nums
[
i
] = 0;

241 
i
 = 0; i < 
™”©iÚs
; i++)

242 
nums
[
	`numb”_³rûÁ
()-1]++;

244 
sum
 = 0;

246 
i
 = 0; i < 100; i++) {

247 
sum
 +ğ
nums
[
i
];

248 
	`±c
(
ch
, "[%3d] %.4f %.4f (%ld)\n",

249 
i
 + 1,

250 100 * 
nums
[
i
] / ()
™”©iÚs
,

251 100 * 
sum
 / ()
™”©iÚs
,

252 
nums
[
i
]

259 ià(!
	`¡rcmp
(
subfunc
, "aversion")) {

260 auto& 
·œ
 : 
Game
::
	`wÜld
().
¬—s
)

261 
	`±c
(
ch
, "%-20s%d\n", 
·œ
.
£cÚd
->
fe_Çme
,…aœ.£cÚd->
v”siÚ
);

266 ià(!
	`¡rcmp
(
subfunc
, "compart")) {

267 
Objeù
 *
cÚš”
, *
obj
;

269 
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt
) {

270 ià((
cÚš”
 = 
obj
->
š_obj
è=ğ
nuÎ±r
)

273 ià(
obj
 =ğ
cÚš”
) {

274 
	`±c
(
ch
, "obj %d i š it£lf.\n", 
obj
->
pIndexD©a
->
vnum
);

278 ià(
cÚš”
->
™em_ty³
 !ğ
ITEM_CONTAINER
)

279 
	`±c
(
ch
, "%s (%d) is in‚on-container %s (%d).%s\n",

280 
obj
->
shÜt_desü
, obj->
pIndexD©a
->
vnum
,

281 
cÚš”
->
shÜt_desü
, cÚš”->
pIndexD©a
->
vnum
,

282 
	`IS_OBJ_STAT
(
cÚš”
, 
ITEM_COMPARTMENT
) ? " ({PCOMPARTMENT{x)" : "");

288 ià(!
	`¡rcmp
(
subfunc
, "rcheck")) {

289 cÚ¡‡uto& 
¬—_·œ
 : 
Game
::
	`wÜld
().
¬—s
) {

290 cÚ¡‡uto& 
·œ
 : 
¬—_·œ
.
£cÚd
->
rooms
) {

291 cÚ¡‡uto& 
room_id
 = 
·œ
.
fœ¡
;

292 cÚ¡ 
Room
 *
room
 = 
·œ
.
£cÚd
;

294 ià(!
room
->
	`æags
().
	`has
(
ROOM_NO_RECALL
))

297 
boŞ
 
found
 = 
çl£
;

298 
x
 = 0; x <= 5; x++)

299 ià(
room
->
ex™
[
x
] !ğ
nuÎ±r
)

300 
found
 = 
Œue
;

302 ià(!
found
)

303 
	`±c
(
ch
, "{W[{P%5d{W]{x %s\n", 
room_id
.
	`to_¡ršg
(), 
room
->
	`Çme
());

310 ià(!
	`¡rcmp
(
subfunc
, "rcheck2")) {

311 cÚ¡‡uto& 
¬—_·œ
 : 
Game
::
	`wÜld
().
¬—s
) {

312 cÚ¡‡uto& 
·œ
 : 
¬—_·œ
.
£cÚd
->
rooms
) {

313 cÚ¡‡uto& 
room_id
 = 
·œ
.
fœ¡
;

314 cÚ¡ 
Room
 *
room
 = 
·œ
.
£cÚd
;

316 ià(
room
->
	`æags
().
	`has
(
ROOM_NOLIGHT
))

317 
	`±c
(
ch
, "{W[{P%5d{W]{x %s\n", 
room_id
.
	`to_¡ršg
(), 
room
->
	`Çme
());

324 ià(!
	`¡rcmp
(
subfunc
, "qtz")) {

326 
Ch¬aù”
 *
que¡Ü
;

328 
SŒšg
 
¬g
;

329 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

331 ià(
¬g
 == "all") {

332 autØ
que¡Ü
 : 
Game
::
	`wÜld
().
ch¬_li¡
)

333 ià(!
que¡Ü
->
	`is_Åc
(è&& !
	`IS_IMMORTAL
(questor)) {

334 
que¡Ü
->
pcd©a
->
Ãxtque¡
 = 0;

335 
que¡Ü
->
pcd©a
->
Ãxtsque¡
 = 0;

336 
	`¡c
("You may‚ow que¡‡gaš.\n", 
que¡Ü
);

339 
	`¡c
("OK,ƒv”yÚmay que¡‡gaš immedŸ‹ly.\n", 
ch
);

343 ià((
que¡Ü
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

344 
	`±c
(
ch
, "NØ¶ay”‚amed '%s' found iÀgame, sÜry!\n", 
¬g
);

348 
que¡Ü
->
pcd©a
->
Ãxtque¡
 = 0;

349 
que¡Ü
->
pcd©a
->
Ãxtsque¡
 = 0;

350 
	`±c
(
ch
, "OK, % may que¡‡gaš immedŸ‹ly.\n", 
que¡Ü
->
Çme
);

354 ià(!
	`¡rcmp
(
subfunc
, "tick")) {

355 
couÁ
, 
numb”
 = 1;

356 
ch¬_upd©e
 
	`¬gs
(());

357 
obj_upd©e
 
	`¬gs
(());

358 
room_upd©e
 
	`¬gs
(());

360 ià(!
¬gum’t
.
	`em±y
(è&&‡rgum’t.
	`is_numb”
())

361 
numb”
 = 
	`URANGE
(1, 
	`©oi
(
¬gum’t
), 100);

363 
couÁ
 = 0; couÁ < 
numb”
; count++) {

364 
Game
::
	`wÜld
().
time
.
	`upd©e
();

365 
Game
::
	`wÜld
().
w—th”
.
	`upd©e
();

366 
Game
::
	`wÜld
().
	`upd©e
();

367 
	`ch¬_upd©e
();

368 
	`obj_upd©e
();

369 
	`room_upd©e
();

372 
	`±c
(
ch
, "You‡dvªûimby %d hour%s.\n", 
numb”
,‚umber > 1 ? "s" : "");

376 
	`¡c
("UnknowÀDEBUG subfunùiÚ.\n", 
ch
);

377 
	}
}

	@src/departed.cc

8 
	~"deş¬e.hh
"

9 
	~"D•¬‹dPÏy”.hh
"

10 
	~"fe.hh
"

11 
	~"FÜm©.hh
"

12 
	~"Loggšg.hh
"

13 
	~"m”c.hh
"

14 
	~"SŒšg.hh
"

16 
D•¬‹dPÏy”
 *
	gd•¬‹d_li¡_h—d
;

17 
D•¬‹dPÏy”
 *
	gd•¬‹d_li¡_
;

19 *
	gd•¬‹d_li¡_lše
 = " {c| {g\\{WV{g/ {c| {k.{W";

21 
	$lßd_d•¬‹d_li¡
()

23 
FILE
 *
å
;

24 
d•¬‹d_li¡_h—d
 = 
Ãw
 
D•¬‹dPÏy”
;

25 
d•¬‹d_li¡_
 = 
Ãw
 
D•¬‹dPÏy”
;

26 
d•¬‹d_li¡_h—d
->
Ãxt
 = 
d•¬‹d_li¡_
;

27 
d•¬‹d_li¡_
->
´evious
 = 
d•¬‹d_li¡_h—d
;

29 ià((
å
 = 
	`fİ’
(
DEPARTED_FILE
, "r")è=ğ
nuÎ±r
) {

30 
Loggšg
::
	`bug
("Departed: failed†oading departed_file.", 0);

31 
baout
;

35 
SŒšg
 
buf
 = 
	`ä—d_wÜd
(
å
);

37 ià(
buf
[0] == '#')

40 
	`š£¹_d•¬‹d
(
buf
);

43 
	`fşo£
(
å
);

44 
baout
:

46 
	}
}

48 
	$§ve_d•¬‹d_li¡
()

50 
D•¬‹dPÏy”
 *
™”©Ü
;

51 
FILE
 *
å
;

53 ià((
å
 = 
	`fİ’
(
DEPARTED_FILE
, "w")è=ğ
nuÎ±r
) {

54 
Loggšg
::
	`bug
("Departed: failed saving departed_file.", 0);

55 
baout
;

58 
™”©Ü
 = 
d•¬‹d_li¡_h—d
->
Ãxt
;

60 
™”©Ü
 !ğ
d•¬‹d_li¡_
) {

61 
FÜm©
::
	`årštf
(
å
, "%s\n", 
™”©Ü
->
Çme
);

62 
™”©Ü
 = i‹¿tÜ->
Ãxt
;

65 
FÜm©
::
	`årštf
(
å
, "#\n");

66 
	`fşo£
(
å
);

67 
baout
:

69 
	}
}

71 
	$š£¹_d•¬‹d
(cÚ¡ 
SŒšg
& 
Çme
)

73 
D•¬‹dPÏy”
 *
™”©Ü
, *
ÃwD•¬‹d
;

74 
™”©Ü
 = 
d•¬‹d_li¡_h—d
->
Ãxt
;

75 
ÃwD•¬‹d
 = 
Ãw
 
D•¬‹dPÏy”
;

76 
ÃwD•¬‹d
->
Çme
 =‚ame;

78 
™”©Ü
 !ğ
d•¬‹d_li¡_
) {

79 ià(
	`¡rÿ£cmp
(
ÃwD•¬‹d
->
Çme
, 
™”©Ü
->name) < 1) {

80 
ÃwD•¬‹d
->
´evious
 = 
™”©Ü
->previous;

81 
ÃwD•¬‹d
->
´evious
->
Ãxt
 =‚ewDeparted;

82 
ÃwD•¬‹d
->
Ãxt
 = 
™”©Ü
;

83 
™”©Ü
->
´evious
 = 
ÃwD•¬‹d
;

87 
™”©Ü
 = i‹¿tÜ->
Ãxt
;

90 
™”©Ü
 = i‹¿tÜ->
´evious
;

91 
™”©Ü
->
Ãxt
 = 
ÃwD•¬‹d
;

92 
ÃwD•¬‹d
->
´evious
 = 
™”©Ü
;

93 
ÃwD•¬‹d
->
Ãxt
 = 
d•¬‹d_li¡_
;

94 
d•¬‹d_li¡_
->
´evious
 = 
ÃwD•¬‹d
;

95 
	}
}

97 
	$»move_d•¬‹d
(cÚ¡ 
SŒšg
& 
Çme
)

99 
D•¬‹dPÏy”
 *
™”©Ü
;

100 
™”©Ü
 = 
d•¬‹d_li¡_h—d
->
Ãxt
;

102 
™”©Ü
 !ğ
d•¬‹d_li¡_
) {

103 ià(!
	`¡rÿ£cmp
(
Çme
, 
™”©Ü
->name)) {

104 
D•¬‹dPÏy”
 *
n
 = 
™”©Ü
->
Ãxt
;

105 
D•¬‹dPÏy”
 *
p
 = 
™”©Ü
->
´evious
;

106 
p
->
Ãxt
 = 
n
;

107 
n
->
´evious
 = 
p
;

108 
d–‘e
 
™”©Ü
;

112 
™”©Ü
 = i‹¿tÜ->
Ãxt
;

114 
	}
}

116 
boŞ
 
	$has_d•¬‹d
(cÚ¡ 
SŒšg
& 
Çme
)

118 
D•¬‹dPÏy”
 *
™”©Ü
;

119 
™”©Ü
 = 
d•¬‹d_li¡_h—d
->
Ãxt
;

121 
™”©Ü
 !ğ
d•¬‹d_li¡_
) {

122 ià(!
	`¡rÿ£cmp
(
Çme
, 
™”©Ü
->name))

123  
Œue
;

125 
™”©Ü
 = i‹¿tÜ->
Ãxt
;

128  
çl£
;

129 
	}
}

	@src/deps/cJSON/cJSON.c

26 
	~<¡ršg.h
>

27 
	~<¡dio.h
>

28 
	~<m©h.h
>

29 
	~<¡dlib.h
>

30 
	~<æßt.h
>

31 
	~<lim™s.h
>

32 
	~<ùy³.h
>

33 
	~"cJSON.h
"

35 cÚ¡ *
	gglob®_•
;

37 cÚ¡ *
	$cJSON_G‘E¼ÜPŒ
(è{ 
glob®_•
;
	}
}

39 
	$cJSON_¡rÿ£cmp
(cÚ¡ *
s1
,cÚ¡ *
s2
)

41 ià(!
s1
è (s1==
s2
)?0:1;if (!s2)  1;

42 ; 
	`tŞow”
(*
s1
è=ğtŞow”(*
s2
); ++s1, ++s2) if(*s1 == 0)  0;

43  
	`tŞow”
(*(cÚ¡ *)
s1
è-Şow”(*(cÚ¡ *)
s2
);

44 
	}
}

46 *(*
	gcJSON_m®loc
)(
size_t
 
	gsz
èğ
m®loc
;

47 (*
cJSON_ä“
)(*
±r
èğ
ä“
;

49 * 
	$cJSON_¡rdup
(cÚ¡ * 
¡r
)

51 
size_t
 
Ën
;

52 * 
cİy
;

54 
Ën
 = 
	`¡¾’
(
¡r
) + 1;

55 ià(!(
cİy
 = (*)
	`cJSON_m®loc
(
Ën
)))  0;

56 
	`memıy
(
cİy
,
¡r
,
Ën
);

57  
cİy
;

58 
	}
}

60 
	$cJSON_In™Hooks
(
cJSON_Hooks
* 
hooks
)

62 ià(!
hooks
) {

63 
cJSON_m®loc
 = 
m®loc
;

64 
cJSON_ä“
 = 
ä“
;

68 
cJSON_m®loc
 = (
hooks
->
m®loc_â
)?hooks->m®loc_â:
m®loc
;

69 
cJSON_ä“
 = (
hooks
->
ä“_â
)?hooks->ä“_â:
ä“
;

70 
	}
}

73 
cJSON
 *
	$cJSON_New_I‹m
()

75 
cJSON
* 
node
 = (cJSON*)
	`cJSON_m®loc
((cJSON));

76 ià(
node
è
	`mem£t
Òode,0,(
cJSON
));

77  
node
;

78 
	}
}

81 
	$cJSON_D–‘e
(
cJSON
 *
c
)

83 
cJSON
 *
Ãxt
;

84 
c
)

86 
Ãxt
=
c
->next;

87 ià(!(
c
->
ty³
&
cJSON_IsReã»nû
è&& c->
chd
è
	`cJSON_D–‘e
(c->child);

88 ià(!(
c
->
ty³
&
cJSON_IsReã»nû
è&& c->
v®ue¡ršg
è
	`cJSON_ä“
(c->valuestring);

89 ià(!(
c
->
ty³
&
cJSON_SŒšgIsCÚ¡
è&& c->
¡ršg
è
	`cJSON_ä“
(c->string);

90 
	`cJSON_ä“
(
c
);

91 
c
=
Ãxt
;

93 
	}
}

96 cÚ¡ *
	$·r£_numb”
(
cJSON
 *
™em
,cÚ¡ *
num
)

98 
n
=0,
sign
=1,
sÿË
=0;
subsÿË
=0,
signsubsÿË
=1;

100 ià(*
num
=='-'è
sign
=-1,num++;

101 ià(*
num
=='0')‚um++;

102 ià(*
num
>='1' && *num<='9'èdØ
n
=(n*10.0)+(*num++ -'0'); *num>='0' && *num<='9');

103 ià(*
num
=='.' &&‚um[1]>='0' &&‚um[1]<='9'è{num++; dØ
n
=Ò*10.0)+(*num++ -'0'),
sÿË
--; *num>='0' && *num<='9');}

104 ià(*
num
=='e' || *num=='E')

105 { 
num
++;ià(*num=='+'ènum++; ià(*num=='-'è
signsubsÿË
=-1,num++;

106 *
num
>='0' && *num<='9'è
subsÿË
=(subscale*10)+(*num++ - '0');

109 
n
=
sign
*n*
	`pow
(10.0,(
sÿË
+
subsÿË
*
signsubsÿË
));

111 
™em
->
v®uedoubË
=
n
;

112 
™em
->
v®uešt
=()
n
;

113 
™em
->
ty³
=
cJSON_Numb”
;

114  
num
;

115 
	}
}

117 
	$pow2gt
 (
x
è{ --x; x|=x>>1; x|=x>>2; x|=x>>4; x|=x>>8; x|=x>>16;  x+1; 
	}
}

119 ¡ruù {*
	mbufãr
; 
	mËngth
; 
	moff£t
; } 
	t´štbufãr
;

121 * 
	$’su»
(
´štbufãr
 *
p
,
Ãeded
)

123 *
Ãwbufãr
;
Ãwsize
;

124 ià(!
p
 || !p->
bufãr
)  0;

125 
Ãeded
+=
p
->
off£t
;

126 ià(
Ãeded
<=
p
->
Ëngth
è…->
bufãr
+p->
off£t
;

128 
Ãwsize
=
	`pow2gt
(
Ãeded
);

129 
Ãwbufãr
=(*)
	`cJSON_m®loc
(
Ãwsize
);

130 ià(!
Ãwbufãr
è{
	`cJSON_ä“
(
p
->
bufãr
);p->
Ëngth
=0,p->buffer=0; 0;}

131 ià(
Ãwbufãr
è
	`memıy
Òewbufãr,
p
->
bufãr
,p->
Ëngth
);

132 
	`cJSON_ä“
(
p
->
bufãr
);

133 
p
->
Ëngth
=
Ãwsize
;

134 
p
->
bufãr
=
Ãwbufãr
;

135  
Ãwbufãr
+
p
->
off£t
;

136 
	}
}

138 
	$upd©e
(
´štbufãr
 *
p
)

140 *
¡r
;

141 ià(!
p
 || !p->
bufãr
)  0;

142 
¡r
=
p
->
bufãr
+p->
off£t
;

143  
p
->
off£t
+
	`¡¾’
(
¡r
);

144 
	}
}

147 *
	$´št_numb”
(
cJSON
 *
™em
,
´štbufãr
 *
p
)

149 *
¡r
=0;

150 
d
=
™em
->
v®uedoubË
;

151 ià(
d
==0)

153 ià(
p
è
¡r
=
	`’su»
(p,2);

154 
¡r
=(*)
	`cJSON_m®loc
(2);

155 ià(
¡r
è
	`¡rıy
(str,"0");

157 ià(
	`çbs
((()
™em
->
v®uešt
)-
d
)<=
DBL_EPSILON
 && d<=
INT_MAX
 && d>=
INT_MIN
)

159 ià(
p
è
¡r
=
	`’su»
(p,21);

160 
¡r
=(*)
	`cJSON_m®loc
(21);

161 ià(
¡r
è
	`¥rštf
(¡r,"%d",
™em
->
v®uešt
);

165 ià(
p
è
¡r
=
	`’su»
(p,64);

166 
¡r
=(*)
	`cJSON_m®loc
(64);

167 ià(
¡r
)

169 ià(
d
*0!=0è
	`¥rštf
(
¡r
,"null");

170 ià(
	`çbs
(
	`æoÜ
(
d
)-d)<=
DBL_EPSILON
 && fabs(d)<1.0e60è
	`¥rštf
(
¡r
,"%.0f",d);

171 ià(
	`çbs
(
d
)<1.0e-6 || fabs(d)>1.0e9è
	`¥rštf
(
¡r
,"%e",d);

172 
	`¥rštf
(
¡r
,"%f",
d
);

175  
¡r
;

176 
	}
}

178 
	$·r£_hex4
(cÚ¡ *
¡r
)

180 
h
=0;

181 ià(*
¡r
>='0' && *¡r<='9'è
h
+=(*str)-'0'; if (*str>='A' && *str<='F') h+=10+(*str)-'A'; if (*str>='a' && *str<='f') h+=10+(*str)-'a';  0;

182 
h
=h<<4;
¡r
++;

183 ià(*
¡r
>='0' && *¡r<='9'è
h
+=(*str)-'0'; if (*str>='A' && *str<='F') h+=10+(*str)-'A'; if (*str>='a' && *str<='f') h+=10+(*str)-'a';  0;

184 
h
=h<<4;
¡r
++;

185 ià(*
¡r
>='0' && *¡r<='9'è
h
+=(*str)-'0'; if (*str>='A' && *str<='F') h+=10+(*str)-'A'; if (*str>='a' && *str<='f') h+=10+(*str)-'a';  0;

186 
h
=h<<4;
¡r
++;

187 ià(*
¡r
>='0' && *¡r<='9'è
h
+=(*str)-'0'; if (*str>='A' && *str<='F') h+=10+(*str)-'A'; if (*str>='a' && *str<='f') h+=10+(*str)-'a';  0;

188  
h
;

189 
	}
}

192 cÚ¡ 
	gfœ¡By‹M¬k
[7] = { 0x00, 0x00, 0xC0, 0xE0, 0xF0, 0xF8, 0xFC };

193 cÚ¡ *
	$·r£_¡ršg
(
cJSON
 *
™em
,cÚ¡ *
¡r
,cÚ¡ **
•
)

195 cÚ¡ *
±r
=
¡r
+1,*
’d_±r
=¡r+1;*
±r2
;*
out
;
Ën
=0;
uc
,
uc2
;

196 ià(*
¡r
!='\"'è{*
•
=str; 0;}

198 *
’d_±r
!='\"' && *’d_±¸&& ++
Ën
)

200 ià(*
’d_±r
++ == '\\')

202 ià(*
’d_±r
 == '\0')

207 
’d_±r
++;

211 
out
=(*)
	`cJSON_m®loc
(
Ën
+1);

212 ià(!
out
)  0;

213 
™em
->
v®ue¡ršg
=
out
;

214 
™em
->
ty³
=
cJSON_SŒšg
;

216 
±r
=
¡r
+1;
±r2
=
out
;

217 
±r
 < 
’d_±r
)

219 ià(*
±r
!='\\'è*
±r2
++=*ptr++;

222 
±r
++;

223 *
±r
)

225 'b': *
±r2
++='\b'; ;

226 'f': *
±r2
++='\f'; ;

227 'n': *
±r2
++='\n'; ;

228 'r': *
±r2
++='\r'; ;

229 't': *
±r2
++='\t'; ;

231 
uc
=
	`·r£_hex4
(
±r
+1);ptr+=4;

232 ià(
±r
 >ğ
’d_±r
è{*
•
=
¡r
; 0;}

234 ià((
uc
>=0xDC00 && uc<=0xDFFFè|| uc==0è{*
•
=
¡r
; 0;}

236 ià(
uc
>=0xD800 && uc<=0xDBFF)

238 ià(
±r
+6 > 
’d_±r
è{*
•
=
¡r
; 0;}

239 ià(
±r
[1]!='\\' ||…Œ[2]!='u'è{*
•
=
¡r
; 0;}

240 
uc2
=
	`·r£_hex4
(
±r
+3);ptr+=6;

241 ià(
uc2
<0xDC00 || uc2>0xDFFFè{*
•
=
¡r
; 0;}

242 
uc
=0x10000 + (((uc&0x3FF)<<10è| (
uc2
&0x3FF));

245 
Ën
=4;ià(
uc
<0x80èËn=1;ià(uc<0x800èËn=2;ià(uc<0x10000èËn=3; 
±r2
+=len;

247 
Ën
) {

248 4: *--
±r2
 =((
uc
 | 0x80) & 0xBF); uc >>= 6;

249 3: *--
±r2
 =((
uc
 | 0x80) & 0xBF); uc >>= 6;

250 2: *--
±r2
 =((
uc
 | 0x80) & 0xBF); uc >>= 6;

251 1: *--
±r2
 =(
uc
 | 
fœ¡By‹M¬k
[
Ën
]);

253 
±r2
+=
Ën
;

255 : *
±r2
++=*
±r
; ;

257 
±r
++;

260 *
±r2
=0;

261 ià(*
±r
=='\"')…tr++;

262  
±r
;

263 
	}
}

266 *
	$´št_¡ršg_±r
(cÚ¡ *
¡r
,
´štbufãr
 *
p
)

268 cÚ¡ *
±r
;*
±r2
,*
out
;
Ën
=0,
æag
=0;
tok’
;

270 ià(!
¡r
)

272 ià(
p
è
out
=
	`’su»
(p,3);

273 
out
=(*)
	`cJSON_m®loc
(3);

274 ià(!
out
)  0;

275 
	`¡rıy
(
out
,"\"\"");

276  
out
;

279 
±r
=
¡r
;*±r;±r++è
æag
|=((*ptr>0 && *ptr<32)||(*ptr=='\"')||(*ptr=='\\'))?1:0;

280 ià(!
æag
)

282 
Ën
=
±r
-
¡r
;

283 ià(
p
è
out
=
	`’su»
Õ,
Ën
+3);

284 
out
=(*)
	`cJSON_m®loc
(
Ën
+3);

285 ià(!
out
)  0;

286 
±r2
=
out
;*ptr2++='\"';

287 
	`¡rıy
(
±r2
,
¡r
);

288 
±r2
[
Ën
]='\"';

289 
±r2
[
Ën
+1]=0;

290  
out
;

293 
±r
=
¡r
;(
tok’
=*±rè&& ++
Ën
è{ià(
	`¡rchr
("\"\\\b\f\n\r\t",token))†en++; if (token<32)†en+=5;ptr++;}

295 ià(
p
è
out
=
	`’su»
Õ,
Ën
+3);

296 
out
=(*)
	`cJSON_m®loc
(
Ën
+3);

297 ià(!
out
)  0;

299 
±r2
=
out
;
±r
=
¡r
;

300 *
±r2
++='\"';

301 *
±r
)

303 ià(()*
±r
>31 && *±r!='\"' && *±r!='\\'è*
±r2
++=*ptr++;

306 *
±r2
++='\\';

307 
tok’
=*
±r
++)

309 '\\': *
±r2
++='\\'; ;

310 '\"': *
±r2
++='\"'; ;

311 '\b': *
±r2
++='b'; ;

312 '\f': *
±r2
++='f'; ;

313 '\n': *
±r2
++='n'; ;

314 '\r': *
±r2
++='r'; ;

315 '\t': *
±r2
++='t'; ;

316 : 
	`¥rštf
(
±r2
,"u%04x",
tok’
);ptr2+=5; ;

320 *
±r2
++='\"';*ptr2++=0;

321  
out
;

322 
	}
}

324 *
	$´št_¡ršg
(
cJSON
 *
™em
,
´štbufãr
 *
p
è{ 
	`´št_¡ršg_±r
(™em->
v®ue¡ršg
,p);
	}
}

327 cÚ¡ *
·r£_v®ue
(
cJSON
 *
™em
,cÚ¡ *
v®ue
,cÚ¡ **
•
);

328 *
´št_v®ue
(
cJSON
 *
™em
,
d•th
,
fmt
,
´štbufãr
 *
p
);

329 cÚ¡ *
·r£_¬¿y
(
cJSON
 *
™em
,cÚ¡ *
v®ue
,cÚ¡ **
•
);

330 *
´št_¬¿y
(
cJSON
 *
™em
,
d•th
,
fmt
,
´štbufãr
 *
p
);

331 cÚ¡ *
·r£_objeù
(
cJSON
 *
™em
,cÚ¡ *
v®ue
,cÚ¡ **
•
);

332 *
´št_objeù
(
cJSON
 *
™em
,
d•th
,
fmt
,
´štbufãr
 *
p
);

335 cÚ¡ *
	$sk
(cÚ¡ *
š
è{š && *š && ()*š<=32èš++;  in;
	}
}

338 
cJSON
 *
	$cJSON_P¬£W™hO±s
(cÚ¡ *
v®ue
,cÚ¡ **
»tuº_·r£_’d
,
»quœe_nuÎ_‹rmš©ed
)

340 cÚ¡ *
’d
=0,**
•
=
»tuº_·r£_’d
?»tuº_·r£_’d:&
glob®_•
;

341 
cJSON
 *
c
=
	`cJSON_New_I‹m
();

342 *
•
=0;

343 ià(!
c
)  0;

345 
’d
=
	`·r£_v®ue
(
c
,
	`sk
(
v®ue
),
•
);

346 ià(!
’d
è{
	`cJSON_D–‘e
(
c
); 0;}

349 ià(
»quœe_nuÎ_‹rmš©ed
è{
’d
=
	`sk
Ónd);ià(*’dè{
	`cJSON_D–‘e
(
c
);*
•
=end; 0;}}

350 ià(
»tuº_·r£_’d
è*»tuº_·r£_’d=
’d
;

351  
c
;

352 
	}
}

354 
cJSON
 *
	$cJSON_P¬£
(cÚ¡ *
v®ue
è{ 
	`cJSON_P¬£W™hO±s
(v®ue,0,0);
	}
}

357 *
	$cJSON_Pršt
(
cJSON
 *
™em
è{ 
	`´št_v®ue
(™em,0,1,0);
	}
}

358 *
	$cJSON_PrštUnfÜm©‹d
(
cJSON
 *
™em
è{ 
	`´št_v®ue
(™em,0,0,0);
	}
}

360 *
	$cJSON_PrštBufã»d
(
cJSON
 *
™em
,
´ebufãr
,
fmt
)

362 
´štbufãr
 
p
;

363 
p
.
bufãr
=(*)
	`cJSON_m®loc
(
´ebufãr
);

364 
p
.
Ëngth
=
´ebufãr
;

365 
p
.
off£t
=0;

366  
	`´št_v®ue
(
™em
,0,
fmt
,&
p
);

367 
	}
}

371 cÚ¡ *
	$·r£_v®ue
(
cJSON
 *
™em
,cÚ¡ *
v®ue
,cÚ¡ **
•
)

373 ià(!
v®ue
)  0;

374 ià(!
	`¡ºcmp
(
v®ue
,"nuÎ",4)è{ 
™em
->
ty³
=
cJSON_NULL
;  value+4; }

375 ià(!
	`¡ºcmp
(
v®ue
,"çl£",5)è{ 
™em
->
ty³
=
cJSON_F®£
;  value+5; }

376 ià(!
	`¡ºcmp
(
v®ue
,"Œue",4)è{ 
™em
->
ty³
=
cJSON_True
; i‹m->
v®uešt
=1;  value+4; }

377 ià(*
v®ue
=='\"'è{  
	`·r£_¡ršg
(
™em
,v®ue,
•
); }

378 ià(*
v®ue
=='-' || (*v®ue>='0' && *v®ue<='9')è{  
	`·r£_numb”
(
™em
,value); }

379 ià(*
v®ue
=='['è{  
	`·r£_¬¿y
(
™em
,v®ue,
•
); }

380 ià(*
v®ue
=='{'è{  
	`·r£_objeù
(
™em
,v®ue,
•
); }

382 *
•
=
v®ue
; 0;

383 
	}
}

386 *
	$´št_v®ue
(
cJSON
 *
™em
,
d•th
,
fmt
,
´štbufãr
 *
p
)

388 *
out
=0;

389 ià(!
™em
)  0;

390 ià(
p
)

392 (
™em
->
ty³
)&255)

394 
cJSON_NULL
: {
out
=
	`’su»
(
p
,5); ià(outè
	`¡rıy
(out,"null"); ;}

395 
cJSON_F®£
: {
out
=
	`’su»
(
p
,6); ià(outè
	`¡rıy
(out,"false"); ;}

396 
cJSON_True
: {
out
=
	`’su»
(
p
,5); ià(outè
	`¡rıy
(out,"true"); ;}

397 
cJSON_Numb”
: 
out
=
	`´št_numb”
(
™em
,
p
);;

398 
cJSON_SŒšg
: 
out
=
	`´št_¡ršg
(
™em
,
p
);;

399 
cJSON_A¼ay
: 
out
=
	`´št_¬¿y
(
™em
,
d•th
,
fmt
,
p
);;

400 
cJSON_Objeù
: 
out
=
	`´št_objeù
(
™em
,
d•th
,
fmt
,
p
);;

405 (
™em
->
ty³
)&255)

407 
cJSON_NULL
: 
out
=
	`cJSON_¡rdup
("null"); ;

408 
cJSON_F®£
: 
out
=
	`cJSON_¡rdup
("false");;

409 
cJSON_True
: 
out
=
	`cJSON_¡rdup
("true"); ;

410 
cJSON_Numb”
: 
out
=
	`´št_numb”
(
™em
,0);;

411 
cJSON_SŒšg
: 
out
=
	`´št_¡ršg
(
™em
,0);;

412 
cJSON_A¼ay
: 
out
=
	`´št_¬¿y
(
™em
,
d•th
,
fmt
,0);;

413 
cJSON_Objeù
: 
out
=
	`´št_objeù
(
™em
,
d•th
,
fmt
,0);;

416  
out
;

417 
	}
}

420 cÚ¡ *
	$·r£_¬¿y
(
cJSON
 *
™em
,cÚ¡ *
v®ue
,cÚ¡ **
•
)

422 
cJSON
 *
chd
;

423 ià(*
v®ue
!='['è{*
•
=value; 0;}

425 
™em
->
ty³
=
cJSON_A¼ay
;

426 
v®ue
=
	`sk
(value+1);

427 ià(*
v®ue
==']')  value+1;

429 
™em
->
chd
=chd=
	`cJSON_New_I‹m
();

430 ià(!
™em
->
chd
)  0;

431 
v®ue
=
	`sk
(
	`·r£_v®ue
(
chd
,sk(v®ue),
•
));

432 ià(!
v®ue
)  0;

434 *
v®ue
==',')

436 
cJSON
 *
Ãw_™em
;

437 ià(!(
Ãw_™em
=
	`cJSON_New_I‹m
()))  0;

438 
chd
->
Ãxt
=
Ãw_™em
;Ãw_™em->
´ev
=child;child=new_item;

439 
v®ue
=
	`sk
(
	`·r£_v®ue
(
chd
,sk(v®ue+1),
•
));

440 ià(!
v®ue
)  0;

443 ià(*
v®ue
==']')  value+1;

444 *
•
=
v®ue
; 0;

445 
	}
}

448 *
	$´št_¬¿y
(
cJSON
 *
™em
,
d•th
,
fmt
,
´štbufãr
 *
p
)

450 **
’Œ›s
;

451 *
out
=0,*
±r
,*
»t
;
Ën
=5;

452 
cJSON
 *
chd
=
™em
->child;

453 
num’Œ›s
=0,
i
=0,
ç
=0;

454 
size_t
 
tm¶’
=0;

457 
chd
è
num’Œ›s
++,chd=chd->
Ãxt
;

459 ià(!
num’Œ›s
)

461 ià(
p
è
out
=
	`’su»
(p,3);

462 
out
=(*)
	`cJSON_m®loc
(3);

463 ià(
out
è
	`¡rıy
(out,"[]");

464  
out
;

467 ià(
p
)

470 
i
=
p
->
off£t
;

471 
±r
=
	`’su»
(
p
,1);ià(!±rè 0; *±r='[';…->
off£t
++;

472 
chd
=
™em
->child;

473 
chd
 && !
ç
)

475 
	`´št_v®ue
(
chd
,
d•th
+1,
fmt
,
p
);

476 
p
->
off£t
=
	`upd©e
(p);

477 ià(
chd
->
Ãxt
è{
Ën
=
fmt
?2:1;
±r
=
	`’su»
(
p
,Ën+1);ià(!±rè 0;*±r++=',';if(fmt)*±r++=' ';*±r=0;p->
off£t
+=len;}

478 
chd
=chd->
Ãxt
;

480 
±r
=
	`’su»
(
p
,2);if (!ptr)  0; *ptr++=']';*ptr=0;

481 
out
=(
p
->
bufãr
)+
i
;

486 
’Œ›s
=(**)
	`cJSON_m®loc
(
num’Œ›s
*(*));

487 ià(!
’Œ›s
)  0;

488 
	`mem£t
(
’Œ›s
,0,
num’Œ›s
*(*));

490 
chd
=
™em
->child;

491 
chd
 && !
ç
)

493 
»t
=
	`´št_v®ue
(
chd
,
d•th
+1,
fmt
,0);

494 
’Œ›s
[
i
++]=
»t
;

495 ià(
»t
è
Ën
+=
	`¡¾’
Ô‘)+2+(
fmt
?1:0); 
ç
=1;

496 
chd
=chd->
Ãxt
;

500 ià(!
ç
è
out
=(*)
	`cJSON_m®loc
(
Ën
);

502 ià(!
out
è
ç
=1;

505 ià(
ç
)

507 
i
=0;i<
num’Œ›s
;i++èià(
’Œ›s
[i]è
	`cJSON_ä“
(entries[i]);

508 
	`cJSON_ä“
(
’Œ›s
);

513 *
out
='[';

514 
±r
=
out
+1;*ptr=0;

515 
i
=0;i<
num’Œ›s
;i++)

517 
tm¶’
=
	`¡¾’
(
’Œ›s
[
i
]);
	`memıy
(
±r
,entries[i],tmplen);ptr+=tmplen;

518 ià(
i
!=
num’Œ›s
-1è{*
±r
++=',';if(
fmt
)*ptr++=' ';*ptr=0;}

519 
	`cJSON_ä“
(
’Œ›s
[
i
]);

521 
	`cJSON_ä“
(
’Œ›s
);

522 *
±r
++=']';*ptr++=0;

524  
out
;

525 
	}
}

528 cÚ¡ *
	$·r£_objeù
(
cJSON
 *
™em
,cÚ¡ *
v®ue
,cÚ¡ **
•
)

530 
cJSON
 *
chd
;

531 ià(*
v®ue
!='{'è{*
•
=value; 0;}

533 
™em
->
ty³
=
cJSON_Objeù
;

534 
v®ue
=
	`sk
(value+1);

535 ià(*
v®ue
=='}')  value+1;

537 
™em
->
chd
=chd=
	`cJSON_New_I‹m
();

538 ià(!
™em
->
chd
)  0;

539 
v®ue
=
	`sk
(
	`·r£_¡ršg
(
chd
,sk(v®ue),
•
));

540 ià(!
v®ue
)  0;

541 
chd
->
¡ršg
=chd->
v®ue¡ršg
;child->valuestring=0;

542 ià(*
v®ue
!=':'è{*
•
=value; 0;}

543 
v®ue
=
	`sk
(
	`·r£_v®ue
(
chd
,sk(v®ue+1),
•
));

544 ià(!
v®ue
)  0;

546 *
v®ue
==',')

548 
cJSON
 *
Ãw_™em
;

549 ià(!(
Ãw_™em
=
	`cJSON_New_I‹m
()))  0;

550 
chd
->
Ãxt
=
Ãw_™em
;Ãw_™em->
´ev
=child;child=new_item;

551 
v®ue
=
	`sk
(
	`·r£_¡ršg
(
chd
,sk(v®ue+1),
•
));

552 ià(!
v®ue
)  0;

553 
chd
->
¡ršg
=chd->
v®ue¡ršg
;child->valuestring=0;

554 ià(*
v®ue
!=':'è{*
•
=value; 0;}

555 
v®ue
=
	`sk
(
	`·r£_v®ue
(
chd
,sk(v®ue+1),
•
));

556 ià(!
v®ue
)  0;

559 ià(*
v®ue
=='}')  value+1;

560 *
•
=
v®ue
; 0;

561 
	}
}

564 *
	$´št_objeù
(
cJSON
 *
™em
,
d•th
,
fmt
,
´štbufãr
 *
p
)

566 **
’Œ›s
=0,**
Çmes
=0;

567 *
out
=0,*
±r
,*
»t
,*
¡r
;
Ën
=7,
i
=0,
j
;

568 
cJSON
 *
chd
=
™em
->child;

569 
num’Œ›s
=0,
ç
=0;

570 
size_t
 
tm¶’
=0;

572 
chd
è
num’Œ›s
++,chd=chd->
Ãxt
;

574 ià(!
num’Œ›s
)

576 ià(
p
è
out
=
	`’su»
Õ,
fmt
?
d•th
+4:3);

577 
out
=(*)
	`cJSON_m®loc
(
fmt
?
d•th
+4:3);

578 ià(!
out
)  0;

579 
±r
=
out
;*ptr++='{';

580 ià(
fmt
è{*
±r
++='\n';
i
=0;i<
d•th
;i++) *ptr++='\t';}

581 *
±r
++='}';*ptr++=0;

582  
out
;

584 ià(
p
)

587 
i
=
p
->
off£t
;

588 
Ën
=
fmt
?2:1; 
±r
=
	`’su»
(
p
,len+1); if (!ptr)  0;

589 *
±r
++='{'; ià(
fmt
è*±r++='\n'; *±r=0; 
p
->
off£t
+=
Ën
;

590 
chd
=
™em
->chd;
d•th
++;

591 
chd
)

593 ià(
fmt
)

595 
±r
=
	`’su»
(
p
,
d•th
); if (!ptr)  0;

596 
j
=0;j<
d•th
;j++è*
±r
++='\t';

597 
p
->
off£t
+=
d•th
;

599 
	`´št_¡ršg_±r
(
chd
->
¡ršg
,
p
);

600 
p
->
off£t
=
	`upd©e
(p);

602 
Ën
=
fmt
?2:1;

603 
±r
=
	`’su»
(
p
,
Ën
); if (!ptr)  0;

604 *
±r
++=':';ià(
fmt
) *ptr++='\t';

605 
p
->
off£t
+=
Ën
;

607 
	`´št_v®ue
(
chd
,
d•th
,
fmt
,
p
);

608 
p
->
off£t
=
	`upd©e
(p);

610 
Ën
=(
fmt
?1:0)+(
chd
->
Ãxt
?1:0);

611 
±r
=
	`’su»
(
p
,
Ën
+1); if (!ptr)  0;

612 ià(
chd
->
Ãxt
è*
±r
++=',';

613 ià(
fmt
è*
±r
++='\n';*ptr=0;

614 
p
->
off£t
+=
Ën
;

615 
chd
=chd->
Ãxt
;

617 
±r
=
	`’su»
(
p
,
fmt
?(
d•th
+1):2); if (!ptr)  0;

618 ià(
fmt
è
i
=0;i<
d•th
-1;i++è*
±r
++='\t';

619 *
±r
++='}';*ptr=0;

620 
out
=(
p
->
bufãr
)+
i
;

625 
’Œ›s
=(**)
	`cJSON_m®loc
(
num’Œ›s
*(*));

626 ià(!
’Œ›s
)  0;

627 
Çmes
=(**)
	`cJSON_m®loc
(
num’Œ›s
*(*));

628 ià(!
Çmes
è{
	`cJSON_ä“
(
’Œ›s
); 0;}

629 
	`mem£t
(
’Œ›s
,0,(*)*
num’Œ›s
);

630 
	`mem£t
(
Çmes
,0,(*)*
num’Œ›s
);

633 
chd
=
™em
->chd;
d•th
++;ià(
fmt
è
Ën
+=depth;

634 
chd
 && !
ç
)

636 
Çmes
[
i
]=
¡r
=
	`´št_¡ršg_±r
(
chd
->
¡ršg
,0);

637 
’Œ›s
[
i
++]=
»t
=
	`´št_v®ue
(
chd
,
d•th
,
fmt
,0);

638 ià(
¡r
 && 
»t
è
Ën
+=
	`¡¾’
Ô‘)+¡¾’(¡r)+2+(
fmt
?2+
d•th
:0); 
ç
=1;

639 
chd
=chd->
Ãxt
;

643 ià(!
ç
è
out
=(*)
	`cJSON_m®loc
(
Ën
);

644 ià(!
out
è
ç
=1;

647 ià(
ç
)

649 
i
=0;i<
num’Œ›s
;i++è{ià(
Çmes
[i]è
	`cJSON_ä“
Òames[i]);ià(
’Œ›s
[i]) cJSON_free(entries[i]);}

650 
	`cJSON_ä“
(
Çmes
);cJSON_ä“(
’Œ›s
);

655 *
out
='{';
±r
=out+1;ià(
fmt
)*ptr++='\n';*ptr=0;

656 
i
=0;i<
num’Œ›s
;i++)

658 ià(
fmt
è
j
=0;j<
d•th
;j++è*
±r
++='\t';

659 
tm¶’
=
	`¡¾’
(
Çmes
[
i
]);
	`memıy
(
±r
,names[i],tmplen);ptr+=tmplen;

660 *
±r
++=':';ià(
fmt
) *ptr++='\t';

661 
	`¡rıy
(
±r
,
’Œ›s
[
i
]);±r+=
	`¡¾’
(entries[i]);

662 ià(
i
!=
num’Œ›s
-1è*
±r
++=',';

663 ià(
fmt
è*
±r
++='\n';*ptr=0;

664 
	`cJSON_ä“
(
Çmes
[
i
]);cJSON_ä“(
’Œ›s
[i]);

667 
	`cJSON_ä“
(
Çmes
);cJSON_ä“(
’Œ›s
);

668 ià(
fmt
è
i
=0;i<
d•th
-1;i++è*
±r
++='\t';

669 *
±r
++='}';*ptr++=0;

671  
out
;

672 
	}
}

675 
	$cJSON_G‘A¼aySize
(
cJSON
 *
¬¿y
è{cJSON *
c
÷¼ay->
chd
;
i
=0;c)i++,c=c->
Ãxt
; i;
	}
}

676 
cJSON
 *
	$cJSON_G‘A¼ayI‹m
(
cJSON
 *
¬¿y
,
™em
è{cJSON *
c
÷¼ay?¬¿y->
chd
:0;ø&& i‹m>0è™em--,c=c->
Ãxt
;  c;
	}
}

677 
cJSON
 *
	$cJSON_G‘ObjeùI‹m
(
cJSON
 *
objeù
,cÚ¡ *
¡ršg
è{cJSON *
c
=objeù?objeù->
chd
:0;ø&& 
	`cJSON_¡rÿ£cmp
(c->¡ršg,¡ršg)èc=c->
Ãxt
;  c;
	}
}

678 
	$cJSON_HasObjeùI‹m
(
cJSON
 *
objeù
,cÚ¡ *
¡ršg
è{ 
	`cJSON_G‘ObjeùI‹m
(objeù,¡ršg)?1:0;
	}
}

681 
	$suffix_objeù
(
cJSON
 *
´ev
,cJSON *
™em
è{´ev->
Ãxt
=™em;™em->´evõ»v;
	}
}

683 
cJSON
 *
	$ü—‹_»ã»nû
(
cJSON
 *
™em
è{cJSON *
»f
=
	`cJSON_New_I‹m
();ià(!»fè 0;
	`memıy
Ôef,™em,(cJSON));»f->
¡ršg
=0;»f->
ty³
|=
cJSON_IsReã»nû
;»f->
Ãxt
ôef->
´ev
=0;„ef;
	}
}

686 
	$cJSON_AddI‹mToA¼ay
(
cJSON
 *
¬¿y
, cJSON *
™em
è{cJSON *
c
÷¼ay->
chd
;ià(!™emè; ià(!cè{¬¿y->chd=™em;} {ø&& c->
Ãxt
èc=c->Ãxt; 
	`suffix_objeù
(c,™em);}
	}
}

687 
	$cJSON_AddI‹mToObjeù
(
cJSON
 *
objeù
,cÚ¡ *
¡ršg
,cJSON *
™em
è{ià(!™emè; ià(™em->¡ršgè
	`cJSON_ä“
(™em->¡ršg);™em->¡ršg=
	`cJSON_¡rdup
(¡ršg);
	`cJSON_AddI‹mToA¼ay
(objeù,™em);
	}
}

688 
	$cJSON_AddI‹mToObjeùCS
(
cJSON
 *
objeù
,cÚ¡ *
¡ršg
,cJSON *
™em
è{ià(!™emè; ià(!(™em->
ty³
&
cJSON_SŒšgIsCÚ¡
è&& i‹m->¡ršgè
	`cJSON_ä“
(™em->¡ršg);™em->¡ršg=(*)¡ršg;™em->ty³|=cJSON_SŒšgIsCÚ¡;
	`cJSON_AddI‹mToA¼ay
(objeù,™em);
	}
}

689 
	$cJSON_AddI‹mReã»nûToA¼ay
(
cJSON
 *
¬¿y
, cJSON *
™em
è{
	`cJSON_AddI‹mToA¼ay
×¼ay,
	`ü—‹_»ã»nû
(™em));
	}
}

690 
	$cJSON_AddI‹mReã»nûToObjeù
(
cJSON
 *
objeù
,cÚ¡ *
¡ršg
,cJSON *
™em
è{
	`cJSON_AddI‹mToObjeù
(objeù,¡ršg,
	`ü—‹_»ã»nû
(™em));
	}
}

692 
cJSON
 *
	$cJSON_D‘achI‹mFromA¼ay
(
cJSON
 *
¬¿y
,
which
è{cJSON *
c
÷¼ay->
chd
;ø&& which>0èc=c->
Ãxt
,which--;if (!c)  0;

693 ià(
c
->
´ev
èc->´ev->
Ãxt
=c->Ãxt;ià(c->Ãxtèc->Ãxt->´ev=c->´ev;ià(c==
¬¿y
->
chd
è¬¿y->chd=c->Ãxt;c->´ev=c->Ãxt=0; c;
	}
}

694 
	$cJSON_D–‘eI‹mFromA¼ay
(
cJSON
 *
¬¿y
,
which
è{
	`cJSON_D–‘e
(
	`cJSON_D‘achI‹mFromA¼ay
×¼ay,which));
	}
}

695 
cJSON
 *
	$cJSON_D‘achI‹mFromObjeù
(
cJSON
 *
objeù
,cÚ¡ *
¡ršg
è{
i
=0;cJSON *
c
=objeù->
chd
;ø&& 
	`cJSON_¡rÿ£cmp
(c->¡ršg,¡ršg)èi++,c=c->
Ãxt
;ià(cè 
	`cJSON_D‘achI‹mFromA¼ay
(objeù,i); 0;
	}
}

696 
	$cJSON_D–‘eI‹mFromObjeù
(
cJSON
 *
objeù
,cÚ¡ *
¡ršg
è{
	`cJSON_D–‘e
(
	`cJSON_D‘achI‹mFromObjeù
(objeù,¡ršg));
	}
}

699 
	$cJSON_In£¹I‹mInA¼ay
(
cJSON
 *
¬¿y
,
which
,cJSON *
Ãw™em
è{cJSON *
c
÷¼ay->
chd
;ø&& which>0èc=c->
Ãxt
,which--;ià(!cè{
	`cJSON_AddI‹mToA¼ay
(array,newitem);;}

700 
Ãw™em
->
Ãxt
=
c
;Ãw™em->
´ev
=c->´ev;c->´evòew™em;ià(c==
¬¿y
->
chd
è¬¿y->chdòew™em; Ãw™em->´ev->Ãxtòew™em;
	}
}

701 
	$cJSON_R•ÏûI‹mInA¼ay
(
cJSON
 *
¬¿y
,
which
,cJSON *
Ãw™em
è{cJSON *
c
÷¼ay->
chd
;ø&& which>0èc=c->
Ãxt
,which--;if (!c) ;

702 
Ãw™em
->
Ãxt
=
c
->Ãxt;Ãw™em->
´ev
=c->prev;if (newitem->next)‚ewitem->next->prev=newitem;

703 ià(
c
==
¬¿y
->
chd
è¬¿y->chd=
Ãw™em
; Ãw™em->
´ev
->
Ãxt
òew™em;c->Ãxt=c->´ev=0;
	`cJSON_D–‘e
(c);
	}
}

704 
	$cJSON_R•ÏûI‹mInObjeù
(
cJSON
 *
objeù
,cÚ¡ *
¡ršg
,cJSON *
Ãw™em
){
i
=0;cJSON *
c
=objeù->
chd
;ø&& 
	`cJSON_¡rÿ£cmp
(c->¡ršg,¡ršg))i++,c=c->
Ãxt
;if(c){Ãw™em->¡ršg=
	`cJSON_¡rdup
(¡ršg);
	`cJSON_R•ÏûI‹mInA¼ay
(objeù,i,Ãw™em);}
	}
}

707 
cJSON
 *
	$cJSON_C»©eNuÎ
(è{
cJSON
 *
™em
=
	`cJSON_New_I‹m
();if(™em)™em->
ty³
=
cJSON_NULL
; i‹m;
	}
}

708 
cJSON
 *
	$cJSON_C»©eTrue
(è{
cJSON
 *
™em
=
	`cJSON_New_I‹m
();if(™em)™em->
ty³
=
cJSON_True
; i‹m;
	}
}

709 
cJSON
 *
	$cJSON_C»©eF®£
(è{
cJSON
 *
™em
=
	`cJSON_New_I‹m
();if(™em)™em->
ty³
=
cJSON_F®£
; i‹m;
	}
}

710 
cJSON
 *
	$cJSON_C»©eBoŞ
(
b
è{
cJSON
 *
™em
=
	`cJSON_New_I‹m
();if(™em)™em->
ty³
=b?
cJSON_True
:
cJSON_F®£
; i‹m;
	}
}

711 
cJSON
 *
	$cJSON_C»©eNumb”
(
num
è{
cJSON
 *
™em
=
	`cJSON_New_I‹m
();if(™em){™em->
ty³
=
cJSON_Numb”
;™em->
v®uedoubË
òum;™em->
v®uešt
=(êum;} i‹m;
	}
}

712 
cJSON
 *
	$cJSON_C»©eSŒšg
(cÚ¡ *
¡ršg
è{
cJSON
 *
™em
=
	`cJSON_New_I‹m
();if(™em){™em->
ty³
=
cJSON_SŒšg
;™em->
v®ue¡ršg
=
	`cJSON_¡rdup
(¡ršg);if(!™em->v®ue¡ršg){
	`cJSON_D–‘e
(™em); 0;}} i‹m;
	}
}

713 
cJSON
 *
	$cJSON_C»©eA¼ay
(è{
cJSON
 *
™em
=
	`cJSON_New_I‹m
();if(™em)™em->
ty³
=
cJSON_A¼ay
; i‹m;
	}
}

714 
cJSON
 *
	$cJSON_C»©eObjeù
(è{
cJSON
 *
™em
=
	`cJSON_New_I‹m
();if(™em)™em->
ty³
=
cJSON_Objeù
; i‹m;
	}
}

717 
cJSON
 *
	$cJSON_C»©eIÁA¼ay
(cÚ¡ *
numb”s
,
couÁ
è{
i
;
cJSON
 *
n
=0,*
p
=0,*
a
=
	`cJSON_C»©eA¼ay
();i=0;¨&& i<couÁ;i++){n=
	`cJSON_C»©eNumb”
Òumb”s[i]);if(!n){
	`cJSON_D–‘e
×); 0;}if(!iï->
chd
ò;
	`suffix_objeù
Õ,n);pò;}‡;
	}
}

718 
cJSON
 *
	$cJSON_C»©eFlßtA¼ay
(cÚ¡ *
numb”s
,
couÁ
è{
i
;
cJSON
 *
n
=0,*
p
=0,*
a
=
	`cJSON_C»©eA¼ay
();i=0;¨&& i<couÁ;i++){n=
	`cJSON_C»©eNumb”
Òumb”s[i]);if(!n){
	`cJSON_D–‘e
×); 0;}if(!iï->
chd
ò;
	`suffix_objeù
Õ,n);pò;}‡;
	}
}

719 
cJSON
 *
	$cJSON_C»©eDoubËA¼ay
(cÚ¡ *
numb”s
,
couÁ
è{
i
;
cJSON
 *
n
=0,*
p
=0,*
a
=
	`cJSON_C»©eA¼ay
();i=0;¨&& i<couÁ;i++){n=
	`cJSON_C»©eNumb”
Òumb”s[i]);if(!n){
	`cJSON_D–‘e
×); 0;}if(!iï->
chd
ò;
	`suffix_objeù
Õ,n);pò;}‡;
	}
}

720 
cJSON
 *
	$cJSON_C»©eSŒšgA¼ay
(cÚ¡ **
¡ršgs
,
couÁ
è{
i
;
cJSON
 *
n
=0,*
p
=0,*
a
=
	`cJSON_C»©eA¼ay
();i=0;¨&& i<couÁ;i++){n=
	`cJSON_C»©eSŒšg
(¡ršgs[i]);if(!n){
	`cJSON_D–‘e
×); 0;}if(!iï->
chd
ò;
	`suffix_objeù
Õ,n);pò;}‡;
	}
}

723 
cJSON
 *
	$cJSON_Du¶iÿ‹
(
cJSON
 *
™em
,
»cur£
)

725 
cJSON
 *
Ãw™em
,*
ıŒ
,*
ÅŒ
=0,*
Ãwchd
;

727 ià(!
™em
)  0;

729 
Ãw™em
=
	`cJSON_New_I‹m
();

730 ià(!
Ãw™em
)  0;

732 
Ãw™em
->
ty³
=
™em
->ty³&(~
cJSON_IsReã»nû
),Ãw™em->
v®uešt
=™em->v®uešt,Ãw™em->
v®uedoubË
=item->valuedouble;

733 ià(
™em
->
v®ue¡ršg
è{
Ãw™em
->v®ue¡ršg=
	`cJSON_¡rdup
(™em->v®ue¡ršg); ià(!Ãw™em->v®ue¡ršgè{
	`cJSON_D–‘e
(newitem); 0;}}

734 ià(
™em
->
¡ršg
è{
Ãw™em
->¡ršg=
	`cJSON_¡rdup
(™em->¡ršg); ià(!Ãw™em->¡ršgè{
	`cJSON_D–‘e
(newitem); 0;}}

736 ià(!
»cur£
è 
Ãw™em
;

738 
ıŒ
=
™em
->
chd
;

739 
ıŒ
)

741 
Ãwchd
=
	`cJSON_Du¶iÿ‹
(
ıŒ
,1);

742 ià(!
Ãwchd
è{
	`cJSON_D–‘e
(
Ãw™em
); 0;}

743 ià(
ÅŒ
è{ÅŒ->
Ãxt
=
Ãwchd
,Ãwchd->
´ev
=nptr;nptr=newchild;}

744 {
Ãw™em
->
chd
=
Ãwchd
;
ÅŒ
=newchild;}

745 
ıŒ
=ıŒ->
Ãxt
;

747  
Ãw™em
;

748 
	}
}

750 
	$cJSON_Mšify
(*
jsÚ
)

752 *
što
=
jsÚ
;

753 *
jsÚ
)

755 ià(*
jsÚ
==' ') json++;

756 ià(*
jsÚ
=='\t') json++;

757 ià(*
jsÚ
=='\r') json++;

758 ià(*
jsÚ
=='\n') json++;

759 ià(*
jsÚ
=='/' && json[1]=='/') *json && *json!='\n') json++;

760 ià(*
jsÚ
=='/' && json[1]=='*') {*json && !(*json=='*' && json[1]=='/')) json++;json+=2;}

761 ià(*
jsÚ
=='\"'){*
što
++=*json++;*json && *json!='\"'){if (*json=='\\') *into++=*json++;*into++=*json++;}*into++=*json++;}

762 *
što
++=*
jsÚ
++;

764 *
što
=0;

765 
	}
}

	@src/deps/cJSON/cJSON.h

23 #iâdeà
cJSON__h


24 
	#cJSON__h


	)

26 #ifdeà
__ılu¥lus


28 
	~<c¡dlib
>

34 
	#cJSON_F®£
 (1 << 0)

	)

35 
	#cJSON_True
 (1 << 1)

	)

36 
	#cJSON_NULL
 (1 << 2)

	)

37 
	#cJSON_Numb”
 (1 << 3)

	)

38 
	#cJSON_SŒšg
 (1 << 4)

	)

39 
	#cJSON_A¼ay
 (1 << 5)

	)

40 
	#cJSON_Objeù
 (1 << 6)

	)

42 
	#cJSON_IsReã»nû
 256

	)

43 
	#cJSON_SŒšgIsCÚ¡
 512

	)

46 
	scJSON
 {

47 
cJSON
 *
Ãxt
,*
´ev
;

48 
cJSON
 *
chd
;

50 
ty³
;

52 *
v®ue¡ršg
;

53 
v®uešt
;

54 
v®uedoubË
;

56 *
¡ršg
;

57 } 
	tcJSON
;

59 
	scJSON_Hooks
 {

60 *(*
m®loc_â
)(
size_t
 
sz
);

61 (*
ä“_â
)(*
±r
);

62 } 
	tcJSON_Hooks
;

65 
cJSON_In™Hooks
(
cJSON_Hooks
* 
hooks
);

69 
cJSON
 *
cJSON_P¬£
(cÚ¡ *
v®ue
);

71 *
cJSON_Pršt
(
cJSON
 *
™em
);

73 *
cJSON_PrštUnfÜm©‹d
(
cJSON
 *
™em
);

75 *
cJSON_PrštBufã»d
(
cJSON
 *
™em
,
´ebufãr
,
fmt
);

77 
cJSON_D–‘e
(
cJSON
 *
c
);

80 
cJSON_G‘A¼aySize
(
cJSON
 *
¬¿y
);

82 
cJSON
 *
cJSON_G‘A¼ayI‹m
(cJSON *
¬¿y
,
™em
);

84 
cJSON
 *
cJSON_G‘ObjeùI‹m
(cJSON *
objeù
,cÚ¡ *
¡ršg
);

85 
cJSON_HasObjeùI‹m
(
cJSON
 *
objeù
,cÚ¡ *
¡ršg
);

87 cÚ¡ *
cJSON_G‘E¼ÜPŒ
();

90 
cJSON
 *
cJSON_C»©eNuÎ
();

91 
cJSON
 *
cJSON_C»©eTrue
();

92 
cJSON
 *
cJSON_C»©eF®£
();

93 
cJSON
 *
cJSON_C»©eBoŞ
(
b
);

94 
cJSON
 *
cJSON_C»©eNumb”
(
num
);

95 
cJSON
 *
cJSON_C»©eSŒšg
(cÚ¡ *
¡ršg
);

96 
cJSON
 *
cJSON_C»©eA¼ay
();

97 
cJSON
 *
cJSON_C»©eObjeù
();

100 
cJSON
 *
cJSON_C»©eIÁA¼ay
(cÚ¡ *
numb”s
,
couÁ
);

101 
cJSON
 *
cJSON_C»©eFlßtA¼ay
(cÚ¡ *
numb”s
,
couÁ
);

102 
cJSON
 *
cJSON_C»©eDoubËA¼ay
(cÚ¡ *
numb”s
,
couÁ
);

103 
cJSON
 *
cJSON_C»©eSŒšgA¼ay
(cÚ¡ **
¡ršgs
,
couÁ
);

106 
cJSON_AddI‹mToA¼ay
(
cJSON
 *
¬¿y
, cJSON *
™em
);

107 
cJSON_AddI‹mToObjeù
(
cJSON
 *
objeù
,cÚ¡ *
¡ršg
,cJSON *
™em
);

108 
cJSON_AddI‹mToObjeùCS
(
cJSON
 *
objeù
,cÚ¡ *
¡ršg
,cJSON *
™em
);

110 
cJSON_AddI‹mReã»nûToA¼ay
(
cJSON
 *
¬¿y
, cJSON *
™em
);

111 
cJSON_AddI‹mReã»nûToObjeù
(
cJSON
 *
objeù
,cÚ¡ *
¡ršg
,cJSON *
™em
);

114 
cJSON
 *
cJSON_D‘achI‹mFromA¼ay
(cJSON *
¬¿y
,
which
);

115 
cJSON_D–‘eI‹mFromA¼ay
(
cJSON
 *
¬¿y
,
which
);

116 
cJSON
 *
cJSON_D‘achI‹mFromObjeù
(cJSON *
objeù
,cÚ¡ *
¡ršg
);

117 
cJSON_D–‘eI‹mFromObjeù
(
cJSON
 *
objeù
,cÚ¡ *
¡ršg
);

120 
cJSON_In£¹I‹mInA¼ay
(
cJSON
 *
¬¿y
,
which
,cJSON *
Ãw™em
);

121 
cJSON_R•ÏûI‹mInA¼ay
(
cJSON
 *
¬¿y
,
which
,cJSON *
Ãw™em
);

122 
cJSON_R•ÏûI‹mInObjeù
(
cJSON
 *
objeù
,cÚ¡ *
¡ršg
,cJSON *
Ãw™em
);

125 
cJSON
 *
cJSON_Du¶iÿ‹
(cJSON *
™em
,
»cur£
);

132 
cJSON
 *
cJSON_P¬£W™hO±s
(cÚ¡ *
v®ue
,cÚ¡ **
»tuº_·r£_’d
,
»quœe_nuÎ_‹rmš©ed
);

134 
cJSON_Mšify
(*
jsÚ
);

137 
	#cJSON_AddNuÎToObjeù
(
objeù
,
Çme
è
	`cJSON_AddI‹mToObjeù
(objeù,‚ame, 
	`cJSON_C»©eNuÎ
())

	)

138 
	#cJSON_AddTrueToObjeù
(
objeù
,
Çme
è
	`cJSON_AddI‹mToObjeù
(objeù,‚ame, 
	`cJSON_C»©eTrue
())

	)

139 
	#cJSON_AddF®£ToObjeù
(
objeù
,
Çme
è
	`cJSON_AddI‹mToObjeù
(objeù,‚ame, 
	`cJSON_C»©eF®£
())

	)

140 
	#cJSON_AddBoŞToObjeù
(
objeù
,
Çme
,
b
è
	`cJSON_AddI‹mToObjeù
(objeù,‚ame, 
	`cJSON_C»©eBoŞ
(b))

	)

141 
	#cJSON_AddNumb”ToObjeù
(
objeù
,
Çme
,
n
è
	`cJSON_AddI‹mToObjeù
(objeù,‚ame, 
	`cJSON_C»©eNumb”
Ò))

	)

142 
	#cJSON_AddSŒšgToObjeù
(
objeù
,
Çme
,
s
è
	`cJSON_AddI‹mToObjeù
(objeù,‚ame, 
	`cJSON_C»©eSŒšg
(s))

	)

145 
	#cJSON_S‘IÁV®ue
(
objeù
,
v®
è((objeù)?(objeù)->
v®uešt
=(objeù)->
v®uedoubË
=(v®):(v®))

	)

146 
	#cJSON_S‘Numb”V®ue
(
objeù
,
v®
è((objeù)?(objeù)->
v®uešt
=(objeù)->
v®uedoubË
=(v®):(v®))

	)

149 
	#cJSON_A¼ayFÜEach
(
pos
, 
h—d
èpo ğ(h—d)->
chd
;…o !ğ
NULL
;…o ğpos->
Ãxt
)

	)

151 #ifdeà
__ılu¥lus


	@src/dispel.cc

1 
	~"aù.hh
"

2 
	~"afãù/Afãù.hh
"

3 
	~"Ch¬aù”.hh
"

4 
	~"deş¬e.hh
"

5 
	~"m”c.hh
"

6 
	~"¿ndom.hh
"

8 
	sdi¥–_ty³
 {

9 
boŞ
 
	mÿn_undo
;

10 
boŞ
 
	mÿn_ÿnûl
;

11 
boŞ
 
	mÿn_di¥–
;

12 cÚ¡ 
SŒšg
 
	mmsg_to_room
;

24 cÚ¡ 
	g¡d
::
m­
<
afãù
::
ty³
, cÚ¡ 
	gdi¥–_ty³
> 
	gdi¥–_bË
 = {

25 { 
afãù
::
ty³
::
age
, { 
Œue
, 
çl£
, false }},

26 { 
afãù
::
ty³
::
¬mÜ
, { 
Œue
,rue,rue }},

27 { 
afãù
::
ty³
::
b¬r›r
, { 
Œue
, 
çl£
, false }},

28 { 
afãù
::
ty³
::
bËss
, { 
Œue
,rue,rue }},

29 { 
afãù
::
ty³
::
blšdÃss
, { 
çl£
, false, false }},

30 { 
afãù
::
ty³
::
blood_moÚ
, { 
Œue
,rue,rue }},

31 { 
afãù
::
ty³
::
bÚe_w®l
, { 
Œue
, 
çl£
, false }},

32 { 
afãù
::
ty³
::
ÿlm
, { 
Œue
, 
çl£
,rue }},

33 { 
afãù
::
ty³
::
chªge_£x
, { 
Œue
, 
çl£
, false }},

34 { 
afãù
::
ty³
::
ch¬m_³rsÚ
, { 
Œue
, 
çl£
,rue }},

35 { 
afãù
::
ty³
::
chªge_£x
, { 
Œue
, 
çl£
, false }},

36 { 
afãù
::
ty³
::
chl_touch
, { 
Œue
, 
çl£
, false }},

37 { 
afãù
::
ty³
::
cur£
, { 
çl£
, false, false }},

38 { 
afãù
::
ty³
::
d‘eù_ev
, { 
Œue
,rue,rue }},

39 { 
afãù
::
ty³
::
d‘eù_good
, { 
Œue
,rue,rue }},

40 { 
afãù
::
ty³
::
d‘eù_hidd’
, { 
Œue
,rue,rue }},

41 { 
afãù
::
ty³
::
d‘eù_švis
, { 
Œue
,rue,rue }},

42 { 
afãù
::
ty³
::
d‘eù_magic
, { 
Œue
,rue,rue }},

43 { 
afãù
::
ty³
::
divše_»g’”©iÚ
,{ 
Œue
,rue,rue }},

44 { 
afãù
::
ty³
::
ç”›_fœe
, { 
Œue
,rue, 
çl£
 }},

45 { 
afãù
::
ty³
::
ã¬
, { 
Œue
, 
çl£
, false }},

46 { 
afãù
::
ty³
::
æamesh›ld
, { 
Œue
,rue,rue }},

47 { 
afãù
::
ty³
::
æy
, { 
Œue
,rue,rue }},

48 { 
afãù
::
ty³
::
focus
, { 
Œue
, 
çl£
, false }},

49 { 
afãù
::
ty³
::
fÜû_sh›ld
, { 
Œue
, 
çl£
, false }},

50 { 
afãù
::
ty³
::
ä’zy
, { 
Œue
,rue,rue }},

51 { 
afãù
::
ty³
::
gŸÁ_¡»ngth
, { 
Œue
,rue,rue }},

52 { 
afãù
::
ty³
::
ha¡e
, { 
Œue
,rue,rue }},

53 { 
afãù
::
ty³
::
hex
, { 
Œue
, 
çl£
, false }},

54 { 
afãù
::
ty³
::
night_visiÚ
, { 
Œue
,rue,rue }},

55 { 
afãù
::
ty³
::
švis
, { 
Œue
,rue,rue }},

57 { 
afãù
::
ty³
::
·¿lyze
, { 
Œue
, 
çl£
, false }},

58 { 
afãù
::
ty³
::
·ss_doÜ
, { 
Œue
,rue,rue }},

59 { 
afãù
::
ty³
::
¶ague
, { 
çl£
, false, false }},

60 { 
afãù
::
ty³
::
poisÚ
, { 
çl£
, false, false }},

61 { 
afãù
::
ty³
::
´ÙeùiÚ_ev
, { 
Œue
,rue,rue }},

62 { 
afãù
::
ty³
::
´ÙeùiÚ_good
, { 
Œue
,rue,rue }},

63 { 
afãù
::
ty³
::
¿ybª
, { 
Œue
,rue,rue }},

64 { 
afãù
::
ty³
::
»g’”©iÚ
, { 
Œue
,rue,rue }},

65 { 
afãù
::
ty³
::
§nùu¬y
, { 
Œue
,rue,rue }},

66 { 
afãù
::
ty³
::
sh“n
, { 
Œue
, 
çl£
, false }},

67 { 
afãù
::
ty³
::
sh›ld
, { 
Œue
,rue,rue }},

68 { 
afãù
::
ty³
::
¦“p
, { 
Œue
,rue, 
çl£
 }},

69 { 
afãù
::
ty³
::
¦ow
, { 
Œue
, 
çl£
, false }},

70 { 
afãù
::
ty³
::
smokesü“n
, { 
Œue
, 
çl£
,rue }},

71 { 
afãù
::
ty³
::
¡“l_mi¡
, { 
Œue
,rue,rue }},

72 { 
afãù
::
ty³
::
¡Úe_skš
, { 
Œue
,rue,rue }},

73 { 
afãù
::
ty³
::
lÚ
, { 
Œue
,rue,rue }},

74 { 
afãù
::
ty³
::
w—k’
, { 
Œue
, 
çl£
, false }}

78 
boŞ
 
	$Ëv–_§ve
(
dis_Ëv–
, 
§ve_Ëv–
)

80 
§ve
;

81 
§ve
 = 20 + ((
§ve_Ëv–
 - 
dis_Ëv–
) / 2);

82 
§ve
 = 
	`URANGE
(5, save, 95);

83  
	`rŞl_chªû
(
§ve
);

84 
	}
}

87 
boŞ
 
	$§ves_¥–l
(
Ëv–
, 
Ch¬aù”
 *
viùim
, 
dam_ty³
)

89 
§ve
 = 20;

90 
§ve
 +ğ(
viùim
->
Ëv–
 -†evel) / 2;

91 
§ve
 -ğ
	`GET_ATTR_SAVES
(
viùim
);

93 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
b”£rk
))

94 
§ve
 += save / 4;

96 
def
 = 
	`GET_DEFENSE_MOD
(
viùim
, 
dam_ty³
);

98 ià(
def
 >= 100)

99  
Œue
;

101 
§ve
 +ğ40 * 
def
 / 100;

102 
§ve
 = 
	`URANGE
(5, save, 95);

104  
	`rŞl_chªû
(
§ve
);

105 
	}
}

107 
	sdi¥–_·¿ms
 {

108 *
	mrg‘
;

109 
	mËv–
;

110 
	mafãù
::
ty³
ype;

111 
boŞ
 
	m§ve
;

112 
	mcouÁ
;

115 
	$afãù_â_di¥–_obj
(
afãù
::
Afãù
 *
node
, *
d©a
) {

116 
di¥–_·¿ms
 *
·¿ms
 = (di¥–_·¿m *)
d©a
;

118 ià(
node
->
ty³
 !ğ
·¿ms
->type)

121 ià(
node
->
³rmª’t
)

124 
dis_Ëv–
 = 
·¿ms
->
Ëv–
;

127 ià(
node
->
du¿tiÚ
 == -1)

128 
dis_Ëv–
 -= 3;

130 ià(
dis_Ëv–
 >ğ
MAX_LEVEL


131 || (!
·¿ms
->
§ve
 && !
	`Ëv–_§ve
(
dis_Ëv–
, 
node
->
Ëv–
))) {

132 
node
->
m¬k
 = 
Œue
;

133 
·¿ms
->
couÁ
++;

136 
node
->
Ëv–
 -ğ
	`numb”_¿nge
(1,3);

139 
	}
}

141 
	$afãù_â_di¥–_ch¬
(
afãù
::
Afãù
 *
node
, *
d©a
) {

142 
di¥–_·¿ms
 *
·¿ms
 = (di¥–_·¿m *)
d©a
;

144 ià(
node
->
ty³
 !ğ
·¿ms
->type)

147 ià(
node
->
³rmª’t
)

150 
dis_Ëv–
 = 
·¿ms
->
Ëv–
;

151 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *)
·¿ms
->
rg‘
;

153 ià(
node
->
du¿tiÚ
 == -1)

154 
dis_Ëv–
 -= 3;

156 ià(
dis_Ëv–
 >ğ
MAX_LEVEL


157 || (
·¿ms
->
§ve
 && !
	`§ves_¥–l
(
dis_Ëv–
, 
viùim
, 
DAM_OTHER
))

158 || (!
·¿ms
->
§ve
 && !
	`Ëv–_§ve
(
dis_Ëv–
, 
node
->
Ëv–
))) {

159 
node
->
m¬k
 = 
Œue
;

160 
·¿ms
->
couÁ
++;

163 
node
->
Ëv–
 -ğ
	`numb”_¿nge
(1,3);

166 
	}
}

169 
boŞ
 
	$check_di¥–_obj
(
dis_Ëv–
, 
Objeù
 *
obj
, 
afãù
::
ty³
y³, 
boŞ
 
§ve
)

171 
di¥–_·¿ms
 
·¿ms
 = {

172 .
rg‘
 = 
obj
,

173 .
Ëv–
 = 
dis_Ëv–
,

174 .
ty³
 =ype,

175 .
§ve
 = save,

176 .
couÁ
 = 0

180 
afãù
::
	`™”©e_ov”_obj
(
obj
, 
afãù_â_di¥–_obj
, &
·¿ms
);

182 ià(
·¿ms
.
couÁ
 == 0)

183  
çl£
;

185 
afãù
::
	`»move_m¬ked_äom_obj
(
obj
);

186  
Œue
;

187 
	}
}

190 
boŞ
 
	$check_di¥–_ch¬
(
dis_Ëv–
, 
Ch¬aù”
 *
viùim
, 
afãù
::
ty³
y³, 
boŞ
 
§ve
)

192 
di¥–_·¿ms
 
·¿ms
 = {

193 .
rg‘
 = 
viùim
,

194 .
Ëv–
 = 
dis_Ëv–
,

195 .
ty³
 =ype,

196 .
§ve
 = save,

197 .
couÁ
 = 0

201 
afãù
::
	`™”©e_ov”_ch¬
(
viùim
, 
afãù_â_di¥–_ch¬
, &
·¿ms
);

203 ià(
·¿ms
.
couÁ
 == 0)

204  
çl£
;

206 
afãù
::
	`»move_m¬ked_äom_ch¬
(
viùim
);

208 ià(!
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
, 
ty³
)) {

209 cÚ¡‡uto& 
’Œy
 = 
afãù
::
	`lookup
(
ty³
);

211 ià(!
’Œy
.
msg_room
.
	`em±y
())

212 
	`aù
(
’Œy
.
msg_room
, 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

214 ià(!
’Œy
.
msg_off
.
	`em±y
())

215 
	`±c
(
viùim
, "%s\n", 
’Œy
.
msg_off
);

218  
Œue
;

219 
	}
}

222 
boŞ
 
	$undo_¥–l
(
dis_Ëv–
, 
Ch¬aù”
 *
viùim
, 
afãù
::
ty³
y³, 
boŞ
 
§ve
) {

223 cÚ¡‡uto& 
·œ
 = 
di¥–_bË
.
	`fšd
(
ty³
);

225 ià(
·œ
 !ğ
di¥–_bË
.
	`ûnd
()

226 && 
·œ
->
£cÚd
.
ÿn_undo
)

227  
	`check_di¥–_ch¬
(
dis_Ëv–
, 
viùim
, 
ty³
, 
§ve
);

229  
çl£
;

230 
	}
}

233 
boŞ
 
	$di¥–_ch¬
(
Ch¬aù”
 *
viùim
, 
Ëv–
, 
boŞ
 
ÿnûÎ©iÚ
)

235 
boŞ
 
found
 = 
çl£
;

237 cÚ¡‡uto& 
’Œy
 : 
di¥–_bË
) {

238 ià(
ÿnûÎ©iÚ
 && !
’Œy
.
£cÚd
.
ÿn_ÿnûl
)

241 ià(!
ÿnûÎ©iÚ
 && !
’Œy
.
£cÚd
.
ÿn_di¥–
)

244 ià(
	`check_di¥–_ch¬
(
Ëv–
, 
viùim
, 
’Œy
.
fœ¡
, !
ÿnûÎ©iÚ
))

245 
found
 = 
Œue
;

248  
found
;

249 
	}
}

	@src/duel.cc

6 
	~"aù.hh
"

7 
	~"¬gum’t.hh
"

8 
	~"afãù/Afãù.hh
"

9 
	~"Ch¬aù”.hh
"

10 
	~"CÏn.hh
"

11 
	~"deş¬e.hh
"

12 
	~"DesütÜ.hh
"

13 
	~"Du–.hh
"

14 
	~"fe.hh
"

15 
	~"fšd.hh
"

16 
	~"FÏgs.hh
"

17 
	~"FÜm©.hh
"

18 
	~"Game.hh
"

19 
	~"š‹½.hh
"

20 
	~"Loggšg.hh
"

21 
	~"m”c.hh
"

22 
	~"PÏy”.hh
"

23 
	~"¿ndom.hh
"

24 
	~"Room.hh
"

25 
	~"SŒšg.hh
"

26 
	~"WÜld.hh
"

27 
	~"RoomPrÙÙy³.hh
"

29 
	#ARENA_DIR
 "../misc/"

	)

30 
	#ARENA_FILE
 "¬’a.txt"

	)

32 
»move_du–
(
Du–
 *
c
);

33 
Room
 *
g‘_¿ndom_¬’a_room
(
Du–
::
A»Ç
 *
¬’a
, cÚ¡ 
LoÿtiÚ
& 
nÙloc
);

34 
du–_ªnounû
(*
buf
, 
Du–
 *
du–
);

35 
ş—r_¬’a
(
Du–
::
A»Ç
 *
¬’a
);

37 
Du–
 *
	gdu–_bË_h—d
;

38 
Du–
 *
	gdu–_bË_
;

39 
	gDu–
::
A»Ç
 *
¬’a_bË_h—d
;

40 
	gDu–
::
A»Ç
 *
¬’a_bË_
;

43 
	$du–_upd©e
()

45 
buf
[
MSL
];

46 
Du–
 *
c
, *
c_Ãxt
;

47 
Room
 *
room
;

48 
c
 = 
du–_bË_h—d
->
Ãxt
;

50 
c
 !ğ
du–_bË_
) {

51 ià(
c
->
acû±_tim”
 > 0) {

52 ià(--
c
->
acû±_tim”
 == 0) {

53 
FÜm©
::
	`¥rštf
(
buf
, "%s seemso have fallen‡sleep, %s had better find somebody‡wakeo duel!",

54 
c
->
deãnd”
->
Çme
, c->
ch®Ëng”
->name);

55 
	`du–_ªnounû
(
buf
, 
c
);

56 
	`±c
(
c
->
deãnd”
, "{P[{RDUEL{P] {WYou didn't„espondo %s's challenge, it has been withdrawn.{x\n",

57 
c
->
ch®Ëng”
->
Çme
);

58 
	`±c
(
c
->
ch®Ëng”
, "{P[{RDUEL{P] {W%s didn't„espondo your challenge, it has been withdrawn.{x\n",

59 
c
->
deãnd”
->
Çme
);

60 
c_Ãxt
 = 
c
->
Ãxt
;

61 
	`»move_du–
(
c
);

62 
c
 = 
c_Ãxt
;

67 ià(
c
->
´•_tim”
 > 0) {

68 ià(--
c
->
´•_tim”
 == 0) {

69 
Ch¬aù”
 *
wch
;

71 
wch
 = 
c
->
¬’a
->
v›wroom
->
³İË
; wch !ğ
nuÎ±r
; wch = wch->
Ãxt_š_room
)

72 
	`¡c
("{P[{RDUEL{P] {WThdu– ha begun!{x\n", 
wch
);

74 
room
 = 
	`g‘_¿ndom_¬’a_room
(
c
->
¬’a
, 
	`LoÿtiÚ
());

75 
	`ch¬_äom_room
(
c
->
ch®Ëng”
);

76 
	`ch¬_to_room
(
c
->
ch®Ëng”
, 
room
);

77 
	`do_look
(
c
->
ch®Ëng”
, "auto");

78 
room
 = 
	`g‘_¿ndom_¬’a_room
(
c
->
¬’a
,„oom->
loÿtiÚ
);

79 
	`ch¬_äom_room
(
c
->
deãnd”
);

80 
	`ch¬_to_room
(
c
->
deãnd”
, 
room
);

81 
	`do_look
(
c
->
deãnd”
, "auto");

82 
	`¡c
("\n{P[{RDUEL{P] {WThdu– ha begun. Luck bw™h ye!{x\n", 
c
->
ch®Ëng”
);

83 
	`¡c
("\n{P[{RDUEL{P] {WThdu– ha begun. Luck bw™h ye!{x\n", 
c
->
deãnd”
);

87 
c
 = c->
Ãxt
;

89 
	}
}

91 
	$lßd_¬’a_bË
()

93 
FILE
 *
å
;

94 
i
, 
maxA»Çs
;

95 
Du–
::
A»Ç
 *
Ãw_¬’a
;

97 ià((
å
 = 
	`fİ’
(
ARENA_DIR
 
ARENA_FILE
, "r")è!ğ
nuÎ±r
) {

98 
	`fsÿnf
(
å
, "%d\n", &
maxA»Çs
);

99 
¬’a_bË_h—d
 = 
Ãw
 
Du–
::
A»Ç
;

100 
¬’a_bË_
 = 
Ãw
 
Du–
::
A»Ç
;

101 
¬’a_bË_h—d
->
Ãxt
 = 
¬’a_bË_
;

102 
¬’a_bË_
->
´evious
 = 
¬’a_bË_h—d
;

103 
du–_bË_h—d
 = 
Ãw
 
	`Du–
();

104 
du–_bË_
 = 
Ãw
 
	`Du–
();

105 
du–_bË_h—d
->
Ãxt
 = 
du–_bË_
;

106 
du–_bË_
->
´evious
 = 
du–_bË_h—d
;

108 
i
 = 0; i < 
maxA»Çs
; i++) {

109 
Ãw_¬’a
 = 
Ãw
 
Du–
::
A»Ç
;

110 
Ãw_¬’a
->
keywÜd
 = 
	`ä—d_¡ršg
(
å
);

111 
Ãw_¬’a
->
Çme
 = 
	`ä—d_¡ršg
(
å
);

112 
Ãw_¬’a
->
desc
 = 
	`ä—d_¡ršg
(
å
);

113 
Ãw_¬’a
->
mšvnum
 = 
	`©oi
(
	`ä—d_¡ršg
(
å
));

114 
Ãw_¬’a
->
maxvnum
 = 
	`©oi
(
	`ä—d_¡ršg
(
å
));

115 
Ãw_¬’a
->
ch®´•
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
	`©oi
(
	`ä—d_¡ršg
(
å
)))));

116 
Ãw_¬’a
->
deå»p
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
	`©oi
(
	`ä—d_¡ršg
(
å
)))));

117 
Ãw_¬’a
->
v›wroom
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
	`©oi
(
	`ä—d_¡ršg
(
å
)))));

119 ià(
Ãw_¬’a
->
ch®´•
 =ğ
nuÎ±r


120 || 
Ãw_¬’a
->
deå»p
 =ğ
nuÎ±r


121 || 
Ãw_¬’a
->
v›wroom
 =ğ
nuÎ±r
) {

122 
FÜm©
::
	`´štf
("Bad‡rena„oom!");

123 
	`ex™
(1);

126 
Ãw_¬’a
->
´evious
 = 
¬’a_bË_
->previous;

127 
Ãw_¬’a
->
´evious
->
Ãxt
 =‚ew_arena;

128 
Ãw_¬’a
->
Ãxt
 = 
¬’a_bË_
;

129 
¬’a_bË_
->
´evious
 = 
Ãw_¬’a
;

132 
	`fşo£
(
å
);

135 
Loggšg
::
	`bug
("Could‚Ù o³À" 
ARENA_FILE
 " for„eading!", 0);

136 
	}
}

138 
	$­³nd_du–
(
Du–
 *
c
)

140 
c
->
´evious
 = 
du–_bË_
->previous;

141 
c
->
´evious
->
Ãxt
 = c;

142 
c
->
Ãxt
 = 
du–_bË_
;

143 
du–_bË_
->
´evious
 = 
c
;

144 
c
->
ch®Ëng”
->
pcd©a
->
du–
 = c;

145 
c
->
deãnd”
->
pcd©a
->
du–
 = c;

146 
	}
}

148 
	$»move_du–
(
Du–
 *
c
)

150 
c
->
´evious
->
Ãxt
 = c->next;

151 
c
->
Ãxt
->
´evious
 = c->previous;

153 autØ
ch
 : 
Game
::
	`wÜld
().
ch¬_li¡
)

154 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
du–
 =ğ
c
)

155 
ch
->
pcd©a
->
du–
 = 
nuÎ±r
;

157 
	`ş—r_¬’a
(
c
->
¬’a
);

158 
d–‘e
 
c
;

159 
	}
}

161 
	$du–_ªnounû
(*
buf
, 
Du–
 *
du–
)

163 
bufãr
[
MSL
];

164 
DesütÜ
 *
d
;

165 
FÜm©
::
	`¥rštf
(
bufãr
, "{P[{RDUEL{P] {W%s{x\n", 
buf
);

167 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
)

168 ià(
d
->
	`is_¶ayšg
()

169 && 
d
->
ch¬aù”
 !ğ
du–
->
ch®Ëng”


170 && 
d
->
ch¬aù”
 !ğ
du–
->
deãnd”


171 && !
d
->
ch¬aù”
->
comm_æags
.
	`has
(
COMM_NOANNOUNCE
)

172 && !
d
->
ch¬aù”
->
comm_æags
.
	`has
(
COMM_QUIET
))

173 
	`¡c
(
bufãr
, 
d
->
ch¬aù”
);

174 
	}
}

176 
boŞ
 
	$ch¬_š_d¬’a_room
(
Ch¬aù”
 *
ch
)

178 
Du–
::
A»Ç
 *
¬’a
 = 
¬’a_bË_h—d
->
Ãxt
;

180 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

181  
çl£
;

183 
¬’a
 !ğ
¬’a_bË_
) {

184 ià(
ch
->
š_room
->
´ÙÙy³
.
vnum
 >ğ
¬’a
->
mšvnum


185 && 
ch
->
š_room
->
´ÙÙy³
.
vnum
 <ğ
¬’a
->
maxvnum
)

186  
Œue
;

188 
¬’a
 =‡»Ç->
Ãxt
;

191  
çl£
;

192 
	}
}

194 
boŞ
 
	$ch¬_š_du–_room
(
Ch¬aù”
 *
ch
)

196 
Du–
::
A»Ç
 *
¬’a
 = 
¬’a_bË_h—d
->
Ãxt
;

198 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

199  
çl£
;

201 
¬’a
 !ğ
¬’a_bË_
) {

202 ià(
ch
->
š_room
 =ğ
¬’a
->
ch®´•


203 || 
ch
->
š_room
 =ğ
¬’a
->
deå»p


204 || (
ch
->
š_room
->
´ÙÙy³
.
vnum
 >ğ
¬’a
->
mšvnum


205 && 
ch
->
š_room
->
´ÙÙy³
.
vnum
 <ğ
¬’a
->
maxvnum
))

206  
Œue
;

208 
¬’a
 =‡»Ç->
Ãxt
;

211  
çl£
;

212 
	}
}

214 
boŞ
 
	$ch¬_š_d¬’a
(
Ch¬aù”
 *
ch
)

216 
Du–
 *
du–
;

218 ià((
du–
 = 
	`g‘_du–
(
ch
)è=ğ
nuÎ±r
)

219  
çl£
;

221 ià(
du–
->
acû±_tim”
 =ğ0 && du–->
´•_tim”
 == 0)

222  
Œue
;

224  
çl£
;

225 
	}
}

227 
boŞ
 
	$ch¬_š_du–
(
Ch¬aù”
 *
ch
)

229 
Du–
 *
du–
;

231 ià((
du–
 = 
	`g‘_du–
(
ch
)è=ğ
nuÎ±r
)

232  
çl£
;

234 ià(
du–
->
acû±_tim”
 == 0)

235  
Œue
;

237  
çl£
;

238 
	}
}

241 
Du–
 *
	$g‘_du–
(
Ch¬aù”
 *
ch
)

243 
Du–
 *
du–
;

244 
Ch¬aù”
 *
İp
 = 
nuÎ±r
;

245 
boŞ
 
cgr
 = 
çl£
;

247 ià(
ch
->
	`is_Åc
(è|| ch->
š_room
 =ğ
nuÎ±r
 || ch->
pcd©a
 =ğnuÎ±¸|| ch->pcd©a->
du–
 ==‚ullptr)

248  
nuÎ±r
;

250 
du–
 = 
ch
->
pcd©a
->duel;

252 ià(
du–
->
ch®Ëng”
 =ğ
ch
) {

253 
cgr
 = 
Œue
;

255 ià((
İp
 = 
du–
->
deãnd”
è=ğ
nuÎ±r
) {

256 
Loggšg
::
	`bug
("get_duel: defender is‚ullptr", 0);

257 
bombout
;

260 ià(
du–
->
deãnd”
 =ğ
ch
) {

261 
cgr
 = 
çl£
;

263 ià((
İp
 = 
du–
->
ch®Ëng”
è=ğ
nuÎ±r
) {

264 
Loggšg
::
	`bug
("get_duel: challenger is‚ullptr", 0);

265 
bombout
;

269 
Loggšg
::
	`bug
("get_duel: ch‚ot in duel", 0);

270 
bombout
;

273 ià(
İp
 =ğ
ch
) {

274 
Loggšg
::
	`bug
("get_duel: opp == ch", 0);

275 
bombout
;

278 ià(
İp
->
pcd©a
->
du–
 =ğ
nuÎ±r
) {

279 
Loggšg
::
	`bug
("get_duel: opp->pcdata->duel ==‚ullptr", 0);

280 
bombout
;

283 ià(
İp
->
pcd©a
->
du–
 != duel) {

284 
Loggšg
::
	`bug
("get_duel: opp->pcdata->duel != duel", 0);

285 
bombout
;

288 ià(
İp
->
š_room
 =ğ
nuÎ±r
) {

289 
Loggšg
::
	`bug
("get_duel: opp->in_room ==‚ullptr", 0);

290 
bombout
;

293 ià(
du–
->
¬’a
 =ğ
nuÎ±r
) {

294 
Loggšg
::
	`bug
("get_duel:‡rena is‚ullptr", 0);

295 
bombout
;

298 ià(
du–
->
acû±_tim”
 == 0) {

299 ià(
du–
->
´•_tim”
 == 0) {

300 ià(
ch
->
š_room
->
´ÙÙy³
.
vnum
 > 
du–
->
¬’a
->
maxvnum


301 || 
ch
->
š_room
->
´ÙÙy³
.
vnum
 < 
du–
->
¬’a
->
mšvnum
) {

302 
Loggšg
::
	`bug
("get_duel:imers 0, ch‚ot in‡rena", 0);

303 
bombout
;

306 ià(
İp
->
š_room
->
´ÙÙy³
.
vnum
 > 
du–
->
¬’a
->
maxvnum


307 || 
İp
->
š_room
->
´ÙÙy³
.
vnum
 < 
du–
->
¬’a
->
mšvnum
) {

308 
Loggšg
::
	`bug
("get_duel:imers 0, opp‚ot in‡rena", 0);

309 
bombout
;

313 ià(
cgr
) {

314 ià(
ch
->
š_room
 !ğ
du–
->
¬’a
->
ch®´•
) {

315 
Loggšg
::
	`bug
("get_duel:‡ccept 0, ch‚ot in chalprep", 0);

316 
bombout
;

319 ià(
İp
->
š_room
 !ğ
du–
->
¬’a
->
deå»p
) {

320 
Loggšg
::
	`bug
("get_duel:‡ccept 0, opp‚ot in defprep", 0);

321 
bombout
;

325 ià(
ch
->
š_room
 !ğ
du–
->
¬’a
->
deå»p
) {

326 
Loggšg
::
	`bug
("get_duel:‡ccept 0, ch‚ot in defprep", 0);

327 
bombout
;

330 ià(
İp
->
š_room
 !ğ
du–
->
¬’a
->
ch®´•
) {

331 
Loggšg
::
	`bug
("get_duel:‡ccept 0, opp‚ot in chalprep", 0);

332 
bombout
;

338  
du–
;

339 
bombout
:

340 
	`»move_du–
(
du–
);

341  
nuÎ±r
;

342 
	}
}

344 
	gDu–
::
A»Ç
 *
	$g‘_¿ndom_¬’a
()

346 
Du–
::
A»Ç
 *
¬’a
;

347 
couÁ
 = 0, 
numb”
;

349 
¬’a
 = 
¬’a_bË_h—d
->
Ãxt
;‡»Ç !ğ
¬’a_bË_
;‡rena =‡rena->next)

350 
couÁ
++;

352 
numb”
 = 
	`numb”_¿nge
(1, 
couÁ
);

353 
couÁ
 = 0;

355 
¬’a
 = 
¬’a_bË_h—d
->
Ãxt
;‡»Ç !ğ
¬’a_bË_
;‡rena =‡rena->next) {

356 
couÁ
++;

358 ià(
numb”
 =ğ
couÁ
)

363 ià(
¬’a
 =ğ
¬’a_bË_
)

364  
nuÎ±r
;

366  
¬’a
;

367 
	}
}

369 
Room
 *
	$g‘_¿ndom_¬’a_room
(
Du–
::
A»Ç
 *
¬’a
, cÚ¡ 
LoÿtiÚ
& 
nÙloc
)

371 
Room
 *
room
;

374 
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
	`numb”_¿nge
(
¬’a
->
mšvnum
.
	`v®ue
(),‡»Ç->
maxvnum
.value()))));

376 
room
 =ğ
nuÎ±r
 ||„oom->
loÿtiÚ
 =ğ
nÙloc
);

378  
room
;

379 
	}
}

381 
	$v›w_room_hpb¬
(
Ch¬aù”
 *
ch
)

383 
SŒšg
 
ch®block
, 
defblock
;

384 
lše
[
MSL
];

385 
Du–
 *
du–
;

386 
Ch¬aù”
 *
ch®
, *
def
, *
vch
;

387 
i
, 
ch®pù
, 
deåù
;

389 ià((
du–
 = 
	`g‘_du–
(
ch
)è=ğ
nuÎ±r
)

392 ià(
du–
->
acû±_tim”
 !ğ0 || du–->
´•_tim”
 != 0)

398 ià(
du–
->
deãnd”
 =ğ
ch
 && du–->
ch®Ëng”
->
fightšg
)

401 
ch®
 = 
du–
->
ch®Ëng”
;

402 
def
 = 
du–
->
deãnd”
;

403 
ch®pù
 = 
	`URANGE
(1, 10 * 
ch®
->
h™
 / 
	`GET_MAX_HIT
(chal), 10);

404 
deåù
 = 
	`URANGE
(1, 10 * 
def
->
h™
 / 
	`GET_MAX_HIT
(def), 10);

405 
FÜm©
::
	`¥rštf
(
ch®block
, "{C%s{C [", 
ch®
->
Çme
);

407 ià(
ch®pù
 <ğ3è
ch®block
 += "{P";

408 
ch®block
 += "{G";

410 
i
 = 1; i < 11; i++) {

411 ià(
ch®pù
 =ğ
i
) {

412 
ch®block
 += "{Y*";

414 ià(
ch®pù
 <ğ3è
ch®block
 += "{R";

415 
ch®block
 += "{H";

420 
ch®block
 += "*";

423 
ch®block
 += "{C]";

424 
FÜm©
::
	`¥rštf
(
defblock
, "{C[");

426 ià(
deåù
 <ğ3è
defblock
 += "{P";

427 
defblock
 += "{G";

429 
i
 = 1; i < 11; i++) {

430 ià(
deåù
 =ğ
i
) {

431 
defblock
 += "{Y*";

433 ià(
deåù
 <ğ3è
defblock
 += "{R";

434 
defblock
 += "{H";

439 
defblock
 += "*";

442 
defblock
 += "{C] ";

443 
defblock
 +ğ
def
->
Çme
;

444 
FÜm©
::
	`¥rštf
(
lše
, "%30 %-30s{x\n", 
ch®block
, 
defblock
);

446 
vch
 = 
du–
->
¬’a
->
v›wroom
->
³İË
; vch !ğ
nuÎ±r
; vch = vch->
Ãxt_š_room
)

447 
	`¡c
(
lše
, 
vch
);

448 
	}
}

450 
	$ş—r_¬’a
(
Du–
::
A»Ç
 *
¬’a
)

452 
Room
 *
room
;

453 
Ch¬aù”
 *
wch
;

455 
Vnum
 
i
 = 
¬’a
->
mšvnum
; i <ğ¬’a->
maxvnum
; i = i.
	`v®ue
()+1)

456 ià((
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
i
)))è!ğ
nuÎ±r
 &&„oom->
³İË
)

457 
wch
 = 
room
->
³İË
; wch !ğ
nuÎ±r
; wch = wch->
Ãxt_š_room
)

458 ià(!
	`IS_IMMORTAL
(
wch
))

459 
	`exŒaù_ch¬
(
wch
, !wch->
	`is_Åc
());

461 ià(
¬’a
->
ch®´•
->
³İË
)

462 
wch
 = 
¬’a
->
ch®´•
->
³İË
; wch !ğ
nuÎ±r
; wch = wch->
Ãxt_š_room
)

463 ià(!
	`IS_IMMORTAL
(
wch
))

464 
	`exŒaù_ch¬
(
wch
, !wch->
	`is_Åc
());

466 ià(
¬’a
->
deå»p
->
³İË
)

467 
wch
 = 
¬’a
->
deå»p
->
³İË
; wch !ğ
nuÎ±r
; wch = wch->
Ãxt_š_room
)

468 ià(!
	`IS_IMMORTAL
(
wch
))

469 
	`exŒaù_ch¬
(
wch
, !wch->
	`is_Åc
());

470 
	}
}

472 
	$du–_kl
(
Ch¬aù”
 *
viùim
)

474 
buf
[
MSL
];

475 
Ch¬aù”
 *
ch
, *
wch
;

476 
Du–
 *
du–
;

477 
Room
 *
room
;

478 
du–
 = 
	`g‘_du–
(
viùim
);

480 ià(
du–
->
ch®Ëng”
 =ğ
viùim
)

481 
ch
 = 
du–
->
deãnd”
;

483 
ch
 = 
du–
->
ch®Ëng”
;

485 
	`ch¬_äom_room
(
ch
);

486 
	`ch¬_äom_room
(
viùim
);

488 ià(
ch
->
şª
) {

489 
	`ch¬_to_room
(
ch
, 
Game
::
	`wÜld
().
	`g‘_room
(ch->
şª
->
»ÿÎ
));

490 
	`¡c
("You fšd your£làback iÀyou¸şªh®l.\n", 
ch
);

493 
	`ch¬_to_room
(
ch
, 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_ALTAR
))));

494 
	`¡c
("You fšd your£là©h®¸oàMÙa.\n", 
ch
);

497 ià(
viùim
->
şª
) {

498 
	`ch¬_to_room
(
viùim
, 
Game
::
	`wÜld
().
	`g‘_room
(viùim->
şª
->
»ÿÎ
));

499 
	`¡c
("You fšd your£làback iÀyou¸şªh®l.\n", 
viùim
);

502 
	`ch¬_to_room
(
viùim
, 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_ALTAR
))));

503 
	`¡c
("You fšd your£là©h®¸oàMÙa.\n", 
viùim
);

507 
Vnum
 
room_vnum
 = 
du–
->
¬’a
->
mšvnum
;„oom_vnum <ğdu–->¬’a->
maxvnum
;„oom_vnum =„oom_vnum.
	`v®ue
()+1) {

508 
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
room_vnum
)));

510 ià(! 
room
)

511 
Loggšg
::
	`bug
("Error with Game::world().get_room() in duel_kill() in duel.c.", 0);

513 ià(
room
->
³İË
)

514 
wch
 = 
room
->
³İË
; wch !ğ
nuÎ±r
; wch = wch->
Ãxt_š_room
)

515 ià(
wch
->
ma¡”
 =ğ
ch
 || wch->ma¡” =ğ
viùim
) {

516 
	`ch¬_äom_room
(
wch
);

517 
	`ch¬_to_room
(
wch
, wch->
ma¡”
->
š_room
);

521 ià(
	`ch¬_İpÚ’ts
(
ch
, 
viùim
))

522 
FÜm©
::
	`¥rštf
(
buf
, "%s {Whas wonhis victory, may %s {Wleadhemo‡nother.",

523 
ch
->
şª
->
şªÇme
, ch->
Çme
);

525 
FÜm©
::
	`¥rštf
(
buf
, "%s {Whasƒmerged victorious! Better†uck‚extime, %s{W.",

526 
ch
->
Çme
, 
viùim
->name);

528 
	`du–_ªnounû
(
buf
, 
du–
);

529 
	`»move_du–
(
du–
);

530 
	`§ve_ch¬_obj
(
ch
);

531 
	`§ve_ch¬_obj
(
viùim
);

532 
	}
}

534 
	$´•¬e_ch¬
(
Ch¬aù”
 *
ch
, 
Du–
 *
du–
)

536 
	`ch¬_äom_room
(
ch
);

538 ià(
du–
->
ch®Ëng”
 =ğ
ch
)

539 
	`ch¬_to_room
(
ch
, 
du–
->
¬’a
->
ch®´•
);

541 
	`ch¬_to_room
(
ch
, 
du–
->
¬’a
->
deå»p
);

544 
afãù
::
	`»move_®l_äom_ch¬
(
ch
, 
çl£
);

546 
ch
->
h™
 = 
	`GET_MAX_HIT
(ch);

547 
ch
->
mªa
 = 
	`GET_MAX_MANA
(ch);

548 
ch
->
¡am
 = 
	`GET_MAX_STAM
(ch);

549 
	`do_look
(
ch
, "auto");

550 
	}
}

552 
	$do_du–
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

554 
buf
[
MSL
];

555 
Du–
 *
du–
;

556 
Ch¬aù”
 *
viùim
 = 
nuÎ±r
;

557 
Du–
::
A»Ç
 *
¬’a
;

559 ià(
ch
->
	`is_Åc
()) {

560 
	`¡c
("You havnØÃedØch®Ëng¶ay”s.\n", 
ch
);

564 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
;

565 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

566 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

567 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g3
);

569 ià(
¬g1
.
	`is_´efix_of
("arena")) {

570 ià(
¬g2
.
	`em±y
()) {

571 
	`¡c
("KeywÜd: Name:\n", 
ch
);

573 
¬’a
 = 
¬’a_bË_h—d
->
Ãxt
;‡»Ç !ğ
¬’a_bË_
;‡rena =‡rena->next)

574 
	`±c
(
ch
, "%-16s%s\n", 
¬’a
->
keywÜd
,‡»Ç->
Çme
);

576 
	`¡c
("\nTy³ 'du–‡»Ç <keywÜd>' fÜ mÜšfÜm©iÚ.\n", 
ch
);

580 
¬’a
 = 
¬’a_bË_h—d
->
Ãxt
;‡»Ç !ğ
¬’a_bË_
;‡rena =‡rena->next)

581 ià(
¬g2
.
	`is_´efix_of
(
¬’a
->
keywÜd
))

584 ià(
¬’a
 =ğ
¬’a_bË_
) {

585 
	`¡c
("A»Ç‚Ù found. Ty³ 'du–‡»Ç'Ø£thchoiûs.\n", 
ch
);

589 
	`±c
(
ch
, "%s\n\n%s\n", 
¬’a
->
Çme
,‡»Ç->
desc
);

593 ià(
¬g1
.
	`is_´efix_of
("decline")) {

594 ià((
du–
 = 
	`g‘_du–
(
ch
)è=ğ
nuÎ±r
 || du–->
deãnd”
 != ch) {

595 
	`¡c
("NØdu– ha b“ÀissuedØyou.\n", 
ch
);

599 ià(
du–
->
acû±_tim”
 == 0) {

600 
	`¡c
("ToØÏ‹, g‘„—dyØfight!\n", 
ch
);

604 ià(
	`ch¬_İpÚ’ts
(
ch
, 
du–
->
ch®Ëng”
))

605 
FÜm©
::
	`¥rštf
(
buf
, "%s {Whas declined %s{W's challenge, %s {Whad better find‡nother fighter!",

606 
ch
->
Çme
, 
du–
->
ch®Ëng”
->Çme, ch->
şª
->
şªÇme
);

608 
FÜm©
::
	`¥rštf
(
buf
, "%s {Whas declined %s{W's challenge, what‡ wuss!",

609 
ch
->
Çme
, 
du–
->
ch®Ëng”
->name);

611 
	`du–_ªnounû
(
buf
, 
du–
);

612 
	`±c
(
ch
, "{P[{RDUEL{P] {WYou deşš%s{W' ch®Ënge.{x\n", 
du–
->
ch®Ëng”
->
Çme
);

613 
	`±c
(
du–
->
ch®Ëng”
, "{P[{RDUEL{P] {W% {Wdeşše you¸ch®Ënge.{x\n", 
ch
->
Çme
);

614 
	`»move_du–
(
du–
);

618 ià(
¬g1
.
	`is_´efix_of
("ignore")) {

619 ià(
	`IS_IMMORTAL
(
ch
)) {

620 
	`¡c
("ImmÜl ÿÂÙ du–.\n", 
ch
);

624 ià(
	`g‘_du–
(
ch
)) {

625 
	`¡c
("You hav¨du– iÀ´og»ss, d—Èw™h iˆfœ¡.\n", 
ch
);

629 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_DUEL_IGNORE
)) {

630 
ch
->
pcd©a
->
¶r_æags
 -ğ
PLR_DUEL_IGNORE
;

631 
	`¡c
("Oth” ÿÀch®Ëngyou‚ow.\n", 
ch
);

634 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_DUEL_IGNORE
;

635 
	`¡c
("You‚ØlÚg” fighˆš du–s.\n", 
ch
);

641 ià(!
¬g1
.
	`em±y
(è&& 
ch
->
š_room
 !ğ
nuÎ±r
 && ch->š_room->
loÿtiÚ
 =ğ
	`LoÿtiÚ
(
	`Vnum
(1212))) {

642 
	`¡c
("Puˆyou¸no£ back iÀthcÜÃr, you dÚ'ˆÃedØdu–.\n", 
ch
);

646 ià(
¬g1
.
	`is_´efix_of
("issue")) {

647 ià(
ch
->
Ëv–
 < 10 && !
	`IS_REMORT
(ch)) {

648 
	`¡c
("You cªnÙ du– uÁ you‡»†ev– 10.\n", 
ch
);

652 ià(
¬g2
.
	`em±y
()) {

653 
	`¡c
("SyÁax: du– issu<viùim> <¬’¨Çm(İtiÚ®)>\n", 
ch
);

657 ià(
	`IS_IMMORTAL
(
ch
)) {

658 
	`¡c
("ImmÜl ÿÂÙ du–.\n", 
ch
);

662 ià(
	`g‘_du–
(
ch
)) {

663 
	`¡c
("You‡»‡Ì—dy invŞved iÀ¨du–, d—Èw™h iˆfœ¡.\n", 
ch
);

667 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g2
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

668 
	`¡c
("You s“‚ØÚbyh©‚am¬ound.\n", 
ch
);

672 ià(
ch
 =ğ
viùim
) {

673 
	`¡c
("You sÏ°your£là¬ound‡ b™.\n", 
ch
);

677 ià(
	`IS_IMMORTAL
(
viùim
)) {

678 
	`¡c
("ImmÜl ÿÂÙ du–.\n", 
ch
);

682 ià(
viùim
->
Ëv–
 < 10 && !
	`IS_REMORT
(victim)) {

683 
	`¡c
("You cªnÙ du– w™h‚ewb›s.\n", 
ch
);

687 ià(
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_LINK_DEAD
)

688 || 
viùim
->
comm_æags
.
	`has
(
COMM_AFK
)) {

689 
	`¡c
("They‡»‚Ù w™h u ©…»£Á, wa™ uÁhey„‘uº.\n", 
ch
);

693 ià(
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_DUEL_IGNORE
)) {

694 
	`¡c
("They‡»‚Ù‡cû±šg du–s.\n", 
ch
);

698 ià(
	`ch¬_İpÚ’ts
(
ch
, 
viùim
)

699 && ((
ch
->
Ëv–
 - 
viùim
->level) > 10

700 || (
viùim
->
Ëv–
 - 
ch
->level) > 10)) {

701 
	`¡c
("You mu¡ bw™hš’†ev– oàyou¸İpÚ’ˆtØdu– iÀw¬.\n", 
ch
);

705 ià(
	`g‘_du–
(
viùim
)) {

706 
	`¡c
("They‡»‡Ì—dy invŞved iÀ¨du–.\n", 
ch
);

710 ià(
¬g3
.
	`em±y
()) {

711 ià((
¬’a
 = 
	`g‘_¿ndom_¬’a
()è=ğ
nuÎ±r
) {

712 
	`¡c
("SÜry,h”¬nØ¬’a righˆnow.\n", 
ch
);

717 
¬’a
 = 
¬’a_bË_h—d
->
Ãxt
;‡»Ç !ğ
¬’a_bË_
;‡rena =‡rena->next)

718 ià(
¬’a
->
keywÜd
.
	`has_wÜds
(
¬g3
))

721 ià(
¬’a
 =ğ
¬’a_bË_
) {

722 
	`¡c
("Th© i nÙ‡À¬’a.\n", 
ch
);

727 
du–
 = 
Ãw
 
	`Du–
();

728 
du–
->
ch®Ëng”
 = 
ch
;

729 
du–
->
deãnd”
 = 
viùim
;

730 
du–
->
¬’a
 =‡rena;

731 
du–
->
acû±_tim”
 = 600;

732 
du–
->
´•_tim”
 = 0;

733 
	`­³nd_du–
(
du–
);

734 
	`±c
(
ch
, "{P[{RDUEL{P] {WYou ch®Ëng% {WtØ¨du–!{x\n", 
viùim
->
Çme
);

735 
	`±c
(
viùim
, "{P[{RDUEL{P] {W% {Wha ch®Ënged youØ¨du–!{x\n", 
ch
->
Çme
);

737 ià(
	`ch¬_İpÚ’ts
(
ch
, 
viùim
))

738 
FÜm©
::
	`¥rštf
(
buf
, "%s {Whas challenged %s {Wto‡ duel forhe honor of %s!",

739 
ch
->
Çme
, 
viùim
->Çme, viùim->
şª
->
şªÇme
);

741 
FÜm©
::
	`¥rštf
(
buf
, "%s {Whas challenged %s {Wto‡ duel!\n",

742 
ch
->
Çme
, 
viùim
->name);

744 
	`du–_ªnounû
(
buf
, 
du–
);

748 ià(
¬g1
.
	`is_´efix_of
("accept")) {

749 ià(
	`IS_IMMORTAL
(
ch
)) {

750 
	`¡c
("ImmÜl ÿÂÙ du–.\n", 
ch
);

754 
du–
 = 
du–_bË_h—d
->
Ãxt
;

756 
du–
 !ğ
du–_bË_
) {

757 ià(
du–
->
acû±_tim”
 == 0) {

758 ià(
ch
->
pcd©a
->
du–
 == duel)

759 
	`¡c
("You hav®»ady‡cû±ed.\n", 
ch
);

761 
	`¡c
("A du– i ®»ady iÀ´og»ss.\n", 
ch
);

766 
du–
 = du–->
Ãxt
;

769 ià((
du–
 = 
	`g‘_du–
(
ch
)è=ğ
nuÎ±r
 || du–->
deãnd”
 != ch) {

770 
	`¡c
("You havnÙ b“Àch®ËngedØ¨du–.\n", 
ch
);

774 
	`ş—r_¬’a
(
du–
->
¬’a
);

775 
viùim
 = 
du–
->
ch®Ëng”
;

776 
	`´•¬e_ch¬
(
ch
, 
du–
);

777 
	`´•¬e_ch¬
(
viùim
, 
du–
);

778 
du–
->
acû±_tim”
 = 0;

779 
du–
->
´•_tim”
 = 60;

780 
	`¡c
("{P[{RDUEL{P] {WYou‡cû±hch®Ënge,…»·» fÜ comb©!{x\n", 
ch
);

781 
	`±c
(
viùim
, "{P[{RDUEL{P] {W% {Wacû± you¸ch®Ënge,…»·» fÜ comb©!{x\n", 
ch
->
Çme
);

782 
FÜm©
::
	`¥rštf
(
buf
, "%s {Whas‡ccepted %s{W's challenge,he duel is goingo start!",

783 
ch
->
Çme
, 
viùim
->name);

784 
	`du–_ªnounû
(
buf
, 
du–
);

788 ià(
¬g1
.
	`is_´efix_of
("view")) {

789 
du–
 = 
du–_bË_h—d
->
Ãxt
;

791 
du–
 !ğ
du–_bË_
) {

792 ià(
du–
->
acû±_tim”
 == 0)

795 
du–
 = du–->
Ãxt
;

798 ià(
du–
 =ğ
du–_bË_
) {

799 
	`¡c
("NØdu– havcomm’ûd.\n", 
ch
);

803 ià(
ch
->
pcd©a
->
du–
 == duel) {

804 
	`¡c
("You cª'ˆv›w you¸owÀdu–!\n", 
ch
);

808 ià(
ch
->
fightšg
) {

809 
	`¡c
("D—Èw™hhi fighˆfœ¡!\n", 
ch
);

813 ià(
ch
->
š_room
 =ğ
nuÎ±r
 || ch->š_room =ğ
du–
->
¬’a
->
v›wroom
) {

814 
	`¡c
("You'»‡Ì—dyh”e!\n", 
ch
);

818 
	`aù
("$ÀËave tØw©chhdu–!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

819 
	`ch¬_äom_room
(
ch
);

820 
	`ch¬_to_room
(
ch
, 
du–
->
¬’a
->
v›wroom
);

821 
	`aù
("$Àha ¬rivedØw©chhdu–!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

822 
	`do_look
(
ch
, "auto");

826 
	`¡c
("SyÁax:\n", 
ch
);

827 
	`¡c
(" du– issu<İpÚ’t> <¬’¨(İtiÚ®)>\n", 
ch
);

828 
	`¡c
(" du–‡cû±\n", 
ch
);

829 
	`¡c
(" du– deşše\n", 
ch
);

830 
	`¡c
(" du– v›w\n", 
ch
);

831 
	`¡c
(" du– ignÜe\n", 
ch
);

832 
	`¡c
(" du–‡»Ç\n", 
ch
);

833 
	`¡c
(" du–‡»Ç <¬’¨Çme>\n", 
ch
);

834 
	}
}

	@src/edit.cc

57 
	~"¬gum’t.hh
"

58 
	~"Ch¬aù”.hh
"

59 
	~"deş¬e.hh
"

60 
	~"Ed™.hh
"

61 
	~"FÏgs.hh
"

62 
	~"FÜm©.hh
"

63 
	~"Loggšg.hh
"

64 
	~"memÜy.hh
"

65 
	~"NÙe.hh
"

66 
	~"PÏy”.hh
"

67 
	~"Room.hh
"

68 
	~"sql.hh
"

69 
	~"SŒšg.hh
"

71 
	#MAX_EDIT_LENGTH
 4000

	)

72 
	#WRAP_WIDTH
 70

	)

73 
	#ARG_1
 
FÏgs
::
A


	)

74 
	#ARG_2
 
FÏgs
::
B


	)

78 
	gnum1
, 
	gnum2
;

79 
FÏgs
 
	gnum”ic_¬gs
;

80 
Ed™
 *
	ged
;

83 *
	$Ãxt_lše
(*
cu¼’t_lše
)

85 *
lim™
 = &
ed
->
ed™_¡ršg
[
MAX_STRING_LENGTH
 - 1];

87 *
¶
 = 
cu¼’t_lše
;…È< 
lim™
 && *pl != '\0';…l++)

88 ià(*
¶
 == '\n')

89  ++
¶
;

91  
cu¼’t_lše
;

92 
	}
}

94 
	$couÁ_lšes
()

96 
Æšes
 = 0;

97 *
lše
, *
Ãxt
;

99 ià(
ed
 =ğ
nuÎ±r
) {

100 
Loggšg
::
	`bug
("count_lines():‚otƒditing‡nything", 0);

104 
lše
 = 
ed
->
ed™_¡ršg
; (
Ãxt
 = 
	`Ãxt_lše
(line)) !=†ine;†ine =‚ext)

105 
Æšes
++;

107  
Æšes
;

108 
	}
}

110 *
	$fšd_lše
(
lš’o
)

112 
lše
 = 1;

113 *
¶
 = 
ed
->
ed™_¡ršg
;

115 ià(
lš’o
 < 1) {

116 
Loggšg
::
	`bug
("find_line(0)", 0);

117  
¶
;

120 ià(
lš’o
 > 
ed
->
ed™_Æšes
 + 1) {

121 
Loggšg
::
	`bug
("fšd_lše(): Lšouˆoà¿nge", 
lš’o
);

122  
¶
;

125 
lše
++ < 
lš’o
)

126 
¶
 = 
	`Ãxt_lše
(pl);

128  
¶
;

129 
	}
}

131 
	$li¡lše
(
SŒšg
& 
dbuf
, 
lš’o
, *
lše
)

133 
buf
[
MAX_STRING_LENGTH
];

134 *
bp
;

136 ià(
lš’o
 =ğ
ed
->
ed™_lše
)

137 
FÜm©
::
	`¥rštf
(
buf
, "{W<%3d> {x", 
lš’o
);

138 ià(
lš’o
 <ğ
ed
->
ed™_Æšes
)

139 
FÜm©
::
	`¥rštf
(
buf
, "{x %3d: {x", 
lš’o
);

141 
FÜm©
::
	`¥rštf
(
buf
, "{x : {x");

143 
dbuf
 +ğ
buf
;

144 
bp
 = 
buf
;

146 ià(
lš’o
 == 0)

147 
dbuf
 += "~~~TOP~~~";

148 ià(
lš’o
 =ğ
ed
->
ed™_Æšes
 + 1)

149 
dbuf
 += "~~~END~~~";

151 *
lše
 != '\n' && *line != '\0') {

152 *
bp
++ = *
lše
++;

156 
	`¡rıy
(
bp
, "{x\n");

157 
dbuf
 +ğ
buf
;

158 
	}
}

160 
	$ed™_li¡1
(
Ch¬aù”
 *
ch
, 
äomlše
, 
tŞše
)

162 
jlše
;

163 *
ı
;

164 
SŒšg
 
dbuf
;

165 
äomlše
 = 
¡d
::
	`max
(fromline, 0);

166 
äomlše
 = 
¡d
::
	`mš
(äomlše, 
ed
->
ed™_Æšes
);

167 
tŞše
 = 
¡d
::
	`max
ÑŞše, 
äomlše
);

168 
tŞše
 = 
¡d
::
	`mš
ÑŞše, 
ed
->
ed™_Æšes
 + 1);

170 ià(
äomlše
 == 0) {

171 
	`li¡lše
(
dbuf
, 0, "");

172 
äomlše
 = 1;

175 
ı
 = 
	`fšd_lše
(
äomlše
);

177 
jlše
 = 
äomlše
; jlš<ğ
tŞše
; jline++) {

178 
	`li¡lše
(
dbuf
, 
jlše
, 
ı
);

179 
ı
 = 
	`Ãxt_lše
(cp);

182 
	`·ge_to_ch¬
(
dbuf
, 
ch
);

183 
	}
}

185 
	$li¡_wšdow
(
Ch¬aù”
 *
ch
)

187 
äomlše
, 
tŞše
;

189 ià(
ed
 =ğ
nuÎ±r
) {

190 
	`¡c
("{P~~~ You‡»‚Ùƒd™šg‡nythšg‡ˆthmom’t. ~~~{x\n", 
ch
);

194 ià(
ed
->
ed™_Æšes
 <= 0) {

195 
	`¡c
("{P~~~ Ed™ bufã¸i em±y ~~~{x\n", 
ch
);

199 
äomlše
 = 
¡d
::
	`max
(
ed
->
ed™_lše
 - 2, 0);

200 
tŞše
 = 
¡d
::
	`mš
(
ed
->
ed™_lše
 + 2,ƒd->
ed™_Æšes
 + 1);

201 
	`ed™_li¡1
(
ch
, 
äomlše
, 
tŞše
);

202 
	}
}

204 
	$ed™_¡©us
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

206 
buf
[
MAX_STRING_LENGTH
];

208 ià(
ch
->
ed™
 =ğ
nuÎ±r
) {

209 
	`¡c
("{PYou‡»n'ˆed™šg‡nythšg y‘.{x\n", 
ch
);

211 ià(
ch
->
²Ùe
 =ğ
nuÎ±r
) {

212 
	`¡c
(

214 "ªdh’y³ {REDIT NOTE{xØed™ it.\n", 
ch
);

217 
FÜm©
::
	`¥rštf
(
buf
, "You have started writing‡(n) {Y%s{x.\n",

218 
bßrd_šdex
[
ch
->
²Ùe
->
ty³
].
bßrd_lÚg
);

219 
	`¡c
(
buf
, 
ch
);

220 
	`¡c
("You could u£ {REDIT NOTE{xØed™ it.\n", 
ch
);

223 
	`¡c
("O¸you could u£ {REDIT DESC{xØed™ {Yyou¸desütiÚ{x.\n", 
ch
);

227 
ed
 = 
ch
->
ed™
;

229 
ed
->
ed™_ty³
) {

230 
EDIT_TYPE_NONE
:

231 
	`¡c
("{PSŒªge, you‡»ƒd™šg NOTHING!{x\n", 
ch
);

232 
Loggšg
::
	`bug
("editing‚othing!", 0);

235 
EDIT_TYPE_NOTE
:

236 ià(
ch
->
²Ùe
 =ğ
nuÎ±r
) {

237 
	`¡c
(

238 "{P You *w”e*ƒd™šg‡‚ÙoàsomsÜt.{x\n", 
ch
);

239 
	`¡c
(

241 
ch
);

242 
ed
->
ed™_ty³
 = 
EDIT_TYPE_NONE
;

246 
FÜm©
::
	`¥rštf
(
buf
, "You‡re currentlyƒditing‡(n) {Y%s{x.\n",

247 
bßrd_šdex
[
ch
->
²Ùe
->
ty³
].
bßrd_lÚg
);

248 
	`¡c
(
buf
, 
ch
);

251 
EDIT_TYPE_DESC
:

252 
	`¡c
("You‡» cu¼’yƒd™šg {Yyou¸desütiÚ{x.\n", 
ch
);

255 
EDIT_TYPE_ROOM
:

256 
	`¡c
("You‡» cu¼’yƒd™šg‡ {Yroom desütiÚ{x.\n", 
ch
);

259 
EDIT_TYPE_HELP
:

260 
	`±c
(
ch
, "You‡» cu¼’yƒd™šgh{Yh–°‹xt{x fÜ ID %d.\n", 
ed
->
ed™_id
);

264 
	`¡c
("SŒªge, I dÚ'ˆknow {PWHAT{x you'»ƒd™šg!\n", 
ch
);

265 
Loggšg
::
	`bug
("Unknownƒditype", 0);

269 
FÜm©
::
	`¥rštf
(
buf
, "You‡re on†ine {C%d{x of {C%d{x.\n",

270 
ed
->
ed™_lše
,ƒd->
ed™_Æšes
);

271 
	`¡c
(
buf
, 
ch
);

272 
	`¡c
(

275 "{x {x {RED{xIT {RDO{xNE / {RCANCEL{x / {RUNDO{x\n", 
ch
);

276 
	`¡c
(

277 "S“ {RHELP EDIT{x fÜ d‘as.\n", 
ch
);

278 
	`li¡_wšdow
(
ch
);

279 
	}
}

281 
boŞ
 
	$check_lše
(
Ch¬aù”
 *
ch
, 
lše
)

283 
buf
[
MAX_INPUT_LENGTH
];

285 ià(
lše
 < 0 ||†š> 
ed
->
ed™_Æšes
) {

286 
FÜm©
::
	`¥rštf
(
buf
, "{PTh”i nØlšnumb” %d{x.\n", 
lše
);

287 
	`¡c
(
buf
, 
ch
);

288  
çl£
;

291  
Œue
;

292 
	}
}

294 
boŞ
 
	$check_¿nge
(
Ch¬aù”
 *
ch
, *
äomlše
, *
tŞše
)

296 
buf
[
MAX_INPUT_LENGTH
];

298 ià(
num”ic_¬gs
.
	`has
(
ARG_2
)) {

299 ià(!
	`check_lše
(
ch
, 
num1
è|| !check_lše(ch, 
num2
))

300  
çl£
;

302 ià(
num2
 > 
ed
->
ed™_Æšes
) {

303 
num2
 = 
ed
->
ed™_Æšes
;

304 
FÜm©
::
	`¥rštf
(
buf
, "{PLa¡†šadju¡edØ{Y%d{x.\n", 
num2
);

305 
	`¡c
(
buf
, 
ch
);

307 ià(
num2
 < 
num1
) {

308 
	`¡c
("{PLšnumb” ouˆoà£qu’û.{x\n", 
ch
);

309  
çl£
;

312 *
äomlše
 = 
num1
;

313 *
tŞše
 = 
num2
;

315 ià(
num”ic_¬gs
.
	`has
(
ARG_1
)) {

316 ià(!
	`check_lše
(
ch
, 
num1
))

317  
çl£
;

319 *
äomlše
 = 
num1
;

320 *
tŞše
 = 
num1
;

323 *
äomlše
 = 
ed
->
ed™_lše
;

324 *
tŞše
 = 
ed
->
ed™_lše
;

327  
Œue
;

328 
	}
}

330 
	$ed™_gÙo1
(
Ch¬aù”
 *
ch
, 
lš’o
)

332 ià(
lš’o
 < 0 ||†š’Ø> 
ed
->
ed™_Æšes
) {

334 
lš’o
 = 
¡d
::
	`max
(lineno, 0);

335 
lš’o
 = 
¡d
::
	`mš
Öš’o, 
ed
->
ed™_Æšes
);

338 
ed
->
ed™_lše
 = 
lš’o
;

339 
	}
}

341 
boŞ
 
	$is_bÏnk_lše
(*
lše
)

343 *
lše
 != 0 && *line != '\n') {

344 ià(*
lše
 > ' ')

345  
çl£
;

347 
lše
++;

350  
Œue
;

351 
	}
}

353 
	$backup
()

355 
	`¡rıy
(
ed
->
ed™_backup
,ƒd->
ed™_¡ršg
);

356 
ed
->
ed™_undo_ok
 = 
Œue
;

357 
	}
}

361 
	$ed™_ÿnûl
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

363 
d–‘e
 
ed
;

364 
ch
->
ed™
 = 
nuÎ±r
;

365 
ed
 = 
nuÎ±r
;

366 
	`¡c
("OK,ƒd™šg sessiÚ‡bÜ‹d, {YnÙhšg chªged{x.\n", 
ch
);

367 
	}
}

369 
	$ed™_chªge
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

371 
this_lše
 = 
ed
->
ed™_lše
;

372 *
h”e
, *
Ãxt
;

373 *
wh”e
;

374 *
’d_pos
;

375 
’d_ch¬
;

376 
SŒšg
 
dbuf
;

378 ià(
num”ic_¬gs
.
	`has
(
ARG_1
)) {

379 ià(!
	`check_lše
(
ch
, 
num1
))

382 
this_lše
 = 
num1
;

385 
	`ed™_gÙo1
(
ch
, 
this_lše
);

387 
SŒšg
 
¬g1
, 
¬g2
;

388 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

389 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

391 ià(
¬g1
.
	`em±y
()) {

392 
	`¡c
("{PYou mu¡ s³cify‡ sŒšgØchªge.{x\n", 
ch
);

396 ià(
	`¡¾’
(
¬g2
è> sŒËn(
¬g1
)

397 && 
	`¡¾’
(
ed
->
ed™_¡ršg
è+ sŒËn(
¬g2
è- sŒËn(
¬g1
è> 
MAX_EDIT_LENGTH
) {

398 
	`¡c
("{PEd™†im™ƒxûeded - you cªnÙ‡dd‡ny mÜ‹xt.{x\n", 
ch
);

402 
h”e
 = 
	`fšd_lše
(
this_lše
);

403 
Ãxt
 = 
	`Ãxt_lše
(
h”e
);

405 
’d_pos
 = 
Ãxt
 - 1;

406 
’d_ch¬
 = *
’d_pos
;

407 *
’d_pos
 = '\0';

409 
wh”e
 = 
	`¡r¡r
(
h”e
, 
¬g1
);

410 *
’d_pos
 = 
’d_ch¬
;

412 ià(
wh”e
 =ğ
nuÎ±r
) {

413 
FÜm©
::
	`¥rštf
(
¬g2
, "{PS—rch sŒšg '%s{P'‚Ù found iÀcu¼’ˆlše.{x\n", 
¬g1
);

414 
	`¡c
(
¬g2
, 
ch
);

418 
	`backup
();

419 
dbuf
 +ğ
¬g2
;

420 
dbuf
 +ğ
wh”e
 + 
	`¡¾’
(
¬g1
);

421 
	`¡rıy
(
wh”e
, 
dbuf
);

422 
	}
}

424 
	$ed™_d–‘e
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

426 
lšeäom
 = 
ed
->
ed™_lše
;

427 
lš‘o
 = 
ed
->
ed™_lše
;

428 *
lše1
, *
lše9
;

430 ià(!
	`check_¿nge
(
ch
, &
lšeäom
, &
lš‘o
))

433 ià(
lšeäom
 == 0) {

434 
	`¡c
("{PCªnÙ d–‘lš0{x.\n", 
ch
);

438 
lše1
 = 
	`fšd_lše
(
lšeäom
);

439 
	`backup
();

441 ià(
lš‘o
 >ğ
ed
->
ed™_Æšes
)

442 *
lše1
 = '\0';

444 
lše9
 = 
	`fšd_lše
(
lš‘o
 + 1);

445 
	`¡rıy
(
lše1
, 
lše9
);

448 
ed
->
ed™_Æšes
 = 
	`couÁ_lšes
();

449 
ed
->
ed™_lše
 = 
¡d
::
	`max
(0, 
lšeäom
 - 1);

450 
	}
}

452 
	$ed™_desc
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

454 ià(
ch
->
ed™
 !ğ
nuÎ±r
) {

455 
	`¡c
("{PBuˆyou‡»‡Ì—dyƒd™šg som‘hšg!{x\n", 
ch
);

456 
	`ed™_¡©us
(
ch
, "");

460 
ed
 = 
Ãw
 
Ed™
;

461 
ch
->
ed™
 = 
ed
;

462 
ed
->
ed™_ty³
 = 
EDIT_TYPE_DESC
;

463 
	`¡rıy
(
ed
->
ed™_¡ršg
, 
ch
->
lÚg_desü
);

464 
	`backup
();

465 
ed
->
ed™_Æšes
 = 
	`couÁ_lšes
();

466 
	`ed™_gÙo1
(
ch
, 1);

467 
	`ed™_¡©us
(
ch
, "");

468 
	}
}

470 
	$ed™_dÚe
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

472 
buf
[
MAX_INPUT_LENGTH
];

474 
ed
->
ed™_ty³
) {

476 
	`¡c
("{POİs, I†o¡¿ck oàmy£lf.{x\n", 
ch
);

477 
Loggšg
::
	`bug
("edit_done(): unknownƒditype", 0);

480 
EDIT_TYPE_NONE
:

481 
	`¡c
("{PHmm,†ook likyou w”’'ˆed™šg‡nythšg.{x\n", 
ch
);

482 
Loggšg
::
	`bug
("edit_done():ƒditype NONE", 0);

485 
EDIT_TYPE_NOTE
:

486 ià(
ch
->
²Ùe
 =ğ
nuÎ±r
) {

487 
	`¡c
("{PI'm‡fraid your‚ote is‚othere‡ny more.{x\n"

488 "{PYou¸ed™edexˆi gošg dowÀthd¿š‚ow.{x\n", 
ch
);

491 
FÜm©
::
	`¥rštf
(
buf
, "OK, I'm saving your {Y%s{x.\n",

492 
bßrd_šdex
[
ch
->
²Ùe
->
ty³
].
bßrd_lÚg
);

493 
	`¡c
(
buf
, 
ch
);

494 
	`¡c
("DÚ'ˆfÜg‘Ø{RPOST{x it!\n", 
ch
);

495 
ch
->
²Ùe
->
‹xt
 = 
ed
->
ed™_¡ršg
;

500 
EDIT_TYPE_DESC
:

501 
	`¡c
("OK, I'm savšg {Yyou¸desütiÚ{x.\n", 
ch
);

502 
ch
->
desütiÚ
 = 
ed
->
ed™_¡ršg
;

515 
EDIT_TYPE_HELP
:

516 ià(
	`db_commªdf
("ed™_dÚe", "upd©h–p £ˆ‹xt='%s' wh”id=%d", 
	`db_esc
(
ed
->
ed™_¡ršg
),ƒd->
ed™_id
))

517 
	`±c
(
ch
, "OK, I'm savšgh{Yh–°‹xt{x fÜ ID %d.\n", 
ed
->
ed™_id
);

519 
	`¡c
("I wa¢'ˆabËØ§vth‹xˆrighˆnow.\n", 
ch
);

524 
d–‘e
 
ed
;

525 
ch
->
ed™
 = 
nuÎ±r
;

526 
ed
 = 
nuÎ±r
;

527 
	}
}

529 
	$ed™_gÙo
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

531 ià(
	`check_lše
(
ch
, 
num1
))

532 
	`ed™_gÙo1
(
ch
, 
num1
);

533 
	}
}

535 
	$ed™_š£¹
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

537 *
Í
;

538 
SŒšg
 
dbuf
;

539 
aá”_lše
 = 
ed
->
ed™_lše
 + 1;

541 ià(
num”ic_¬gs
.
	`has
(
ARG_1
)) {

542 ià(!
	`check_lše
(
ch
, 
num1
))

545 
aá”_lše
 = 
num1
 + 1;

548 ià(
	`¡¾’
(
¬gum’t
è+ sŒËn(
ed
->
ed™_¡ršg
è+ 1 > 
MAX_EDIT_LENGTH
) {

549 
	`¡c
("{PEd™†im™ƒxûeded - you cªnÙ‡dd‡ny mÜ‹xt.{x\n", 
ch
);

553 
	`backup
();

554 
dbuf
 +ğ
¬gum’t
;

555 
dbuf
 += "\n";

556 
Í
 = 
	`fšd_lše
(
aá”_lše
);

557 
dbuf
 +ğ
Í
;

558 
	`¡rıy
(
Í
, 
dbuf
);

559 
ed
->
ed™_Æšes
 = 
	`couÁ_lšes
();

560 
	`ed™_gÙo1
(
ch
, 
aá”_lše
);

561 
	}
}

563 
	$ed™_li¡
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

565 
äomlše
, 
tŞše
;

568 ià(
num”ic_¬gs
.
	`em±y
()) {

569 
	`ed™_li¡1
(
ch
, 0, 
ed
->
ed™_Æšes
 + 1);

573 ià(!
	`check_¿nge
(
ch
, &
äomlše
, &
tŞše
))

576 
	`ed™_li¡1
(
ch
, 
äomlše
, 
tŞše
);

577 
	}
}

579 
	$ed™_nÙe
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

581 ià(
ch
->
ed™
 !ğ
nuÎ±r
) {

582 
	`¡c
("{PBuˆyou‡»‡Ì—dyƒd™šg som‘hšg!{x\n", 
ch
);

583 
	`ed™_¡©us
(
ch
, "");

587 ià(
ch
->
²Ùe
 =ğ
nuÎ±r
) {

588 
	`¡c
("{PBuˆyou hav’'ˆ¡¬‹d wr™šg‡ny‚Ùy‘!{x\n", 
ch
);

592 
ed
 = 
Ãw
 
Ed™
;

593 
ch
->
ed™
 = 
ed
;

594 
ed
->
ed™_ty³
 = 
EDIT_TYPE_NOTE
;

595 
	`¡rıy
(
ed
->
ed™_¡ršg
, 
ch
->
²Ùe
->
‹xt
);

596 
	`backup
();

597 
ed
->
ed™_Æšes
 = 
	`couÁ_lšes
();

598 
	`ed™_gÙo1
(
ch
, 1);

599 
	`ed™_¡©us
(
ch
, "");

600 
	}
}

626 
	$ed™_h–p
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

628 ià(
ch
->
ed™
 !ğ
nuÎ±r
) {

629 
	`¡c
("{PBuˆyou‡»‡Ì—dyƒd™šg som‘hšg!{x\n", 
ch
);

630 
	`ed™_¡©us
(
ch
, "");

634 ià(
¬gum’t
.
	`em±y
(è|| !¬gum’t.
	`is_numb”
()) {

635 
	`¡c
("You mu¡ s³cify‡ h–°IDØed™ it.", 
ch
);

639 
id
 = 
	`©oi
(
¬gum’t
);

641 ià(
	`db_qu”yf
("ed™_h–p", "£Ëùexˆäom h–p wh”id=%d", 
id
è=ğ
SQL_ERROR
) {

642 
	`¡c
("Qu”yƒ¼Ü, couldn'ˆacûs h–ps.\n", 
ch
);

646 ià(
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

647 
ed
 = 
Ãw
 
Ed™
;

648 
ch
->
ed™
 = 
ed
;

649 
ed
->
ed™_ty³
 = 
EDIT_TYPE_HELP
;

650 
	`¡rıy
(
ed
->
ed™_¡ršg
, 
	`db_g‘_cŞumn_¡r
(0));

651 
	`backup
();

652 
ed
->
ed™_Æšes
 = 
	`couÁ_lšes
();

653 
ed
->
ed™_id
 = 
id
;

654 
	`ed™_gÙo1
(
ch
, 1);

655 
	`ed™_¡©us
(
ch
, "");

658 
	`¡c
("Couldn'ˆ»Œ›v¨h–°w™hh© ID.\n", 
ch
);

661 
	}
}

663 
	$ed™_¥l™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

665 
buf
[
MAX_INPUT_LENGTH
];

666 
this_lše
 = 
ed
->
ed™_lše
;

667 *
h”e
, *
Ãxt
;

668 *
wh”e
;

669 *
’d_pos
;

670 
’d_ch¬
;

671 
SŒšg
 
dbuf
;

673 ià(
num”ic_¬gs
.
	`has
(
ARG_1
)) {

674 ià(!
	`check_lše
(
ch
, 
num1
))

677 
this_lše
 = 
num1
;

680 
	`ed™_gÙo1
(
ch
, 
this_lše
);

682 ià(
¬gum’t
.
	`em±y
()) {

683 
	`¡c
("{PYou mu¡ s³cify‡ sŒšgØ¥l™ befÜe.{x\n", 
ch
);

687 
SŒšg
 
tok’
;

688 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
tok’
);

690 
h”e
 = 
	`fšd_lše
(
ed
->
ed™_lše
);

691 
Ãxt
 = 
	`Ãxt_lše
(
h”e
);

693 
’d_pos
 = 
Ãxt
 - 1;

694 
’d_ch¬
 = *
’d_pos
;

695 *
’d_pos
 = '\0';

696 
wh”e
 = 
	`¡r¡r
(
h”e
, 
tok’
);

697 *
’d_pos
 = 
’d_ch¬
;

699 ià(
wh”e
 =ğ
nuÎ±r
) {

700 
FÜm©
::
	`¥rštf
(
buf
, "{PCh¬aù” '%s{P'‚Ù found iÀcu¼’ˆlše.{x\n", 
tok’
);

701 
	`¡c
(
buf
, 
ch
);

705 
	`backup
();

706 
dbuf
 +ğ
wh”e
;

707 
	`¡rıy
(
wh”e
, "\n");

708 
	`¡rÿt
(
wh”e
, 
dbuf
);

709 
ed
->
ed™_Æšes
 = 
	`couÁ_lšes
();

710 
	}
}

712 
	$ed™_undo
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
junk
)

714 ià(!
ed
->
ed™_undo_ok
) {

715 
	`¡c
("{PSorry, you have‡lready undone your most„ecent change!{x\n",

716 
ch
);

720 
	`¡rıy
(
ed
->
ed™_¡ršg
,ƒd->
ed™_backup
);

721 
ed
->
ed™_Æšes
 = 
	`couÁ_lšes
();

723 ià(
ed
->
ed™_lše
 >ƒd->
ed™_Æšes
)

724 
	`ed™_gÙo1
(
ch
, 
ed
->
ed™_lše
);

726 
	`¡c
("{POK{x, your most„ecent change (if‡ny) has been {Pundone{x.\n",

727 
ch
);

728 
ed
->
ed™_undo_ok
 = 
çl£
;

729 
	}
}

731 
	$ed™_w¿p
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

733 
´ev_bÏnk_lše
 = 0;

734 
lšeäom
, 
lš‘o
;

735 
fŞl_bÏnk_lše
 = 
ed
->
ed™_Æšes
 + 1;

736 
lš’o
, 
lš–’
, 
wÜdËn
;

737 *
¡¬t
, *
aá”
;

738 *
ı
, *
wp
, *
Í
;

739 
SŒšg
 
dbuf
;

740 
wÜd
[
MAX_STRING_LENGTH
];

741 
lše
[
MAX_INPUT_LENGTH
];

742 
boŞ
 
š_wÜd
;

744 ià(
num”ic_¬gs
.
	`em±y
()) {

746 
lš’o
 = 1;

747 
Í
 = 
ed
->
ed™_¡ršg
;

749 
lš’o
 <ğ
ed
->
ed™_Æšes
) {

750 ià(
	`is_bÏnk_lše
(
Í
)) {

751 ià(
lš’o
 < 
ed
->
ed™_lše
)

752 
´ev_bÏnk_lše
 = 
lš’o
;

753 ià(
lš’o
 > 
ed
->
ed™_lše
) {

754 
fŞl_bÏnk_lše
 = 
lš’o
;

763 
Í
 = 
	`Ãxt_lše
(lp);

764 
lš’o
 ++;

768 ià(!
	`check_¿nge
(
ch
, &
lšeäom
, &
lš‘o
))

771 
´ev_bÏnk_lše
 = 
¡d
::
	`max
(
lšeäom
 - 1, 0);

772 
fŞl_bÏnk_lše
 = 
¡d
::
	`mš
(
lš‘o
 + 1, 
ed
->
ed™_Æšes
 + 1);

777 
lš’o
 = 
´ev_bÏnk_lše
 + 1;

778 
¡¬t
 = 
	`fšd_lše
(
lš’o
);

780 ià(
fŞl_bÏnk_lše
 <ğ
ed
->
ed™_Æšes
)

781 
aá”
 = 
	`fšd_lše
(
fŞl_bÏnk_lše
);

783 
aá”
 = 
nuÎ±r
;

785 
	`backup
();

786 
wp
 = 
wÜd
;

787 
Í
 = 
lše
;

788 
lš–’
 = 0;

789 
š_wÜd
 = 
çl£
;

791 
ı
 = 
¡¬t
; 
lš’o
 < 
fŞl_bÏnk_lše
; cp++) {

792 ià(*
ı
 > ' ') {

794 *
wp
++ = *
ı
;

795 
š_wÜd
 = 
Œue
;

798 ià(*
ı
 == '\n')

799 
lš’o
++;

801 ià(
š_wÜd
) {

803 *
wp
 = '\0';

804 
š_wÜd
 = 
çl£
;

806 ià(
	`¡¾’
(
wÜd
) == 0)

809 
wÜdËn
 = 
	`SŒšg
(
wÜd
).
	`uncŞÜ
().
	`size
();

812 
lš–’
 + 1 + 
wÜdËn
 > 
WRAP_WIDTH
) {

813 ià(
lš–’
 == 0) {

814 
wp
 = 
wÜd
; 
	`SŒšg
(
lše
).
	`uncŞÜ
().
	`size
(è< 
WRAP_WIDTH
;)

815 *
Í
++ = *
wp
++;

817 
	`¡rıy
(
wÜd
, --
wp
);

818 
wÜdËn
 = 
	`SŒšg
(
wÜd
).
	`uncŞÜ
().
	`size
();

819 
Í
--;

822 
	`¡rıy
(
Í
, "\n");

823 
dbuf
 +ğ
lše
;

824 
Í
 = 
lše
;

825 
lš–’
 = 0;

828 ià(
	`¡¾’
(
wÜd
) == 0)

831 ià(
lš–’
 > 0) {

832 *
Í
++ = ' ';

833 
lš–’
++;

836 
	`¡rıy
(
Í
, 
wÜd
);

837 
Í
 +ğ
	`¡¾’
(
wÜd
);

838 
lš–’
 +ğ
wÜdËn
;

839 
wp
 = 
wÜd
;

845 ià(
Í
 > 
lše
) {

846 
	`¡rıy
(
Í
, "\n");

847 
dbuf
 +ğ
lše
;

850 ià(
aá”
 !ğ
nuÎ±r
)

851 
dbuf
 +ğ
aá”
;

853 
	`¡rıy
(
¡¬t
, 
dbuf
);

854 
ed
->
ed™_Æšes
 = 
	`couÁ_lšes
();

855 
	`ed™_gÙo1
(
ch
, 
´ev_bÏnk_lše
 + 1);

856 
	}
}

859 
	$do_ed™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

861 
buf
[
MAX_INPUT_LENGTH
];

862 cÚ¡ *
Ãw_¬g
;

863 
SŒšg
 
¬g
;

865 
num”ic_¬gs
.
	`ş—r
();

868 ià(!
¬gum’t
.
	`em±y
()) {

869 
Ãw_¬g
 = 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

871 ià(
¬g
.
	`is_numb”
()) {

872 
num1
 = 
	`©oi
(
¬g
);

873 
num”ic_¬gs
 +ğ
ARG_1
;

874 
¬gum’t
 = 
Ãw_¬g
;

878 ià(
num”ic_¬gs
.
	`has
(
ARG_1
è&& !
¬gum’t
.
	`em±y
()) {

879 
Ãw_¬g
 = 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

881 ià(
¬g
.
	`is_numb”
()) {

882 
num2
 = 
	`©oi
(
¬g
);

883 
num”ic_¬gs
 +ğ
ARG_2
;

884 
¬gum’t
 = 
Ãw_¬g
;

888 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

890 ià(
¬g
.
	`em±y
(è&& 
num”ic_¬gs
.empty()) {

891 
	`ed™_¡©us
(
ch
, 
¬gum’t
);

895 ià(
	`¡¾’
(
¬g
è>ğ3 &&‡rg.
	`is_´efix_of
("description")) {

896 
	`ed™_desc
(
ch
, 
¬gum’t
);

900 ià(
¬g
.
	`is_´efix_of
("note")) {

901 
	`ed™_nÙe
(
ch
, 
¬gum’t
);

905 ià(
	`IS_IMMORTAL
(
ch
è&& 
¬g
.
	`is_´efix_of
("room")) {

906 
	`¡c
("SÜry,ƒd™šg„oom i cu¼’y di§bËd.\n", 
ch
);

911 ià(
	`IS_IMMORTAL
(
ch
è&& 
¬g
.
	`is_´efix_of
("help")) {

912 
	`ed™_h–p
(
ch
, 
¬gum’t
);

916 ià(
ch
->
ed™
 =ğ
nuÎ±r
) {

917 
ed
 = 
nuÎ±r
;

918 
	`li¡_wšdow
(
ch
);

922 
ed
 = 
ch
->
ed™
;

926 ià(
¬g
.
	`em±y
()) {

927 
	`ed™_gÙo
(
ch
, 
¬gum’t
);

928 
	`li¡_wšdow
(
ch
);

934 ià(
¬g
.
	`is_´efix_of
("change")) {

935 
	`ed™_chªge
(
ch
, 
¬gum’t
);

936 
	`li¡_wšdow
(
ch
);

940 ià(
¬g
.
	`is_´efix_of
("insert")) {

941 
	`ed™_š£¹
(
ch
, 
¬gum’t
);

942 
	`li¡_wšdow
(
ch
);

946 ià(
¬g
.
	`is_´efix_of
("split")) {

947 
	`ed™_¥l™
(
ch
, 
¬gum’t
);

948 
	`li¡_wšdow
(
ch
);

954 ià(
¬g
 == "cancel") {

955 
	`ed™_ÿnûl
(
ch
, 
¬gum’t
);

959 ià(
¬g
.
	`is_´efix_of
("cance")) {

960 
	`¡c
(

962 
ch
);

966 ià(
¬g
.
	`is_´efix_of
("delete")) {

967 
	`ed™_d–‘e
(
ch
, 
¬gum’t
);

968 
	`li¡_wšdow
(
ch
);

972 ià(
¬g
.
	`is_´efix_of
("done")) {

973 
	`ed™_dÚe
(
ch
, 
¬gum’t
);

977 ià(
¬g
.
	`is_´efix_of
("list")) {

978 
	`ed™_li¡
(
ch
, 
¬gum’t
);

982 ià(
¬g
 == "undo") {

983 
	`ed™_undo
(
ch
, 
¬gum’t
);

984 
	`li¡_wšdow
(
ch
);

988 ià(
¬g
.
	`is_´efix_of
("und")) {

989 
	`¡c
(

991 
ch
);

995 ià(
¬g
.
	`is_´efix_of
("wrap")) {

996 
	`ed™_w¿p
(
ch
, 
¬gum’t
);

997 
	`li¡_wšdow
(
ch
);

1001 
FÜm©
::
	`¥rštf
(
buf
, "{PUnknowÀ{CEDIT{x funùiÚ '{R%s{P'.{x\n", 
¬g
);

1002 
	`¡c
(
buf
, 
ch
);

1003 
	`ed™_¡©us
(
ch
, "");

1004 
	}
}

	@src/effects.cc

28 
	~"aù.hh
"

29 
	~"afãù/Afãù.hh
"

30 
	~"Ch¬aù”.hh
"

31 
	~"deş¬e.hh
"

32 
	~"di¥–.hh
"

33 
	~"FÏgs.hh
"

34 
	~"m”c.hh
"

35 
	~"Objeù.hh
"

36 
	~"ObjeùV®ue.hh
"

37 
	~"PÏy”.hh
"

38 
	~"¿ndom.hh
"

39 
	~"Room.hh
"

41 
	$acid_efãù
(*
vo
, 
Ëv–
, 
dam
, 
rg‘
, 
evŞutiÚ
)

43 ià(
rg‘
 =ğ
TARGET_ROOM
) {

44 
Room
 *
room
 = (Room *è
vo
;

45 
Objeù
 *
obj
, *
obj_Ãxt
;

47 
obj
 = 
room
->
cÚ‹Ás
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

48 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

49 
	`acid_efãù
(
obj
, 
Ëv–
, 
dam
, 
TARGET_OBJ
, 
evŞutiÚ
);

55 ià(
rg‘
 =ğ
TARGET_CHAR
) {

56 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

57 
Objeù
 *
obj
, *
obj_Ãxt
;

60 ià(!
	`IS_IMMORTAL
(
viùim
)) {

61 
obj
 = 
viùim
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

62 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

63 
	`acid_efãù
(
obj
, 
Ëv–
, 
dam
, 
TARGET_OBJ
, 
evŞutiÚ
);

70 ià(
rg‘
 =ğ
TARGET_OBJ
) {

71 
Objeù
 *
obj
 = (Objeù *è
vo
;

72 
chªû
;

73 *
msg
;

74 
Ch¬aù”
 *
owÃr
;

77 ià((
owÃr
 = 
obj
->
ÿ¼›d_by
è!ğ
nuÎ±r


78 && 
afãù
::
	`exi¡s_Ú_ch¬
(
owÃr
,‡fãù::
ty³
::
sh“n
))

81 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BURN_PROOF
)

82 || 
	`IS_OBJ_STAT
(
obj
, 
ITEM_NOPURGE
)

83 || 
	`rŞl_chªû
(20))

86 
chªû
 = 
Ëv–
 / 4 + 
dam
 / 10;

88 ià(
chªû
 > 25)

89 
chªû
 = (chance - 25) / 2 + 25;

91 ià(
chªû
 > 50)

92 
chªû
 = (chance - 50) / 2 + 50;

94 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
))

95 
chªû
 -= 5;

97 
chªû
 -ğ
obj
->
Ëv–
 * 2;

99 
obj
->
™em_ty³
) {

103 
ITEM_CONTAINER
:

104 
ITEM_CORPSE_PC
:

105 
ITEM_CORPSE_NPC
:

106 
msg
 = "$p fumes‡nd dissolves.";

109 
ITEM_ARMOR
:

110 
msg
 = "$p is…itted‡ndƒtched.";

113 
ITEM_CLOTHING
:

114 
msg
 = "$p is corroded into scrap.";

117 
ITEM_STAFF
:

118 
ITEM_WAND
:

119 
chªû
 -= 10;

120 
msg
 = "$p corrodes‡nd breaks.";

123 
ITEM_SCROLL
:

124 
chªû
 += 10;

125 
msg
 = "$p is burned into waste.";

129 
chªû
 = 
	`URANGE
(5, chance, 95);

131 ià(
	`numb”_³rûÁ
(è> 
chªû
)

134 ià(
obj
->
™em_ty³
 !ğ
ITEM_ARMOR
) {

135 ià(
obj
->
ÿ¼›d_by
 !ğ
nuÎ±r
)

136 
	`aù
(
msg
, 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

137 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

138 
	`aù
(
msg
, 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

141 
obj
->
cÚd™iÚ
 -ğ
	`numb”_¿nge
(5, 10);

143 ià(
obj
->
cÚd™iÚ
 > 0) {

144 
¶aû
 = 
	`numb”_¿nge
(0, 3);

145 
amouÁ
 = 
¡d
::
	`mš
(
obj
->
v®ue
[
¶aû
].
	`v®ue
(), 
	`numb”_¿nge
(1, 4));

147 ià(
amouÁ
 <= 0)

150 ià(
obj
->
ÿ¼›d_by
 !ğ
nuÎ±r
)

151 
	`aù
("$°i p™‹d‡ndƒtched.", 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

152 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

153 
	`aù
("$°i p™‹d‡ndƒtched.", 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

155 
obj
->
v®ue
[
¶aû
] -ğ
amouÁ
;

157 ià(
obj
->
ÿ¼›d_by
 !ğ
nuÎ±r
 && obj->
w—r_loc
 !ğ
WEAR_NONE
)

158 
obj
->
ÿ¼›d_by
->
¬mÜ_ba£
[
¶aû
] +ğ
amouÁ
;

163 ià(
obj
->
ÿ¼›d_by
)

164 
	`aù
("$°i dissŞved byhacid!", 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

165 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

166 
	`aù
("$°i dissŞved byhacid!", 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

169 ià(
obj
->
cÚšs
) {

170 
Objeù
 *
t_obj
, *
n_obj
;

172 ià(
obj
->
ÿ¼›d_by
) {

173 ià(!
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

174 
	`aù
("$p' cÚ‹Á sÿ‰” oÀthground.", 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

176 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

177 
	`aù
("$p' cÚ‹Á sÿ‰” oÀthground.", 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

179 
t_obj
 = 
obj
->
cÚšs
;_obj !ğ
nuÎ±r
;_obj = 
n_obj
) {

180 
n_obj
 = 
t_obj
->
Ãxt_cÚ‹Á
;

181 
	`obj_äom_obj
(
t_obj
);

183 ià(
obj
->
ÿ¼›d_by
) {

184 ià(
obj
->
ÿ¼›d_by
->
š_room
 =ğ
nuÎ±r
)

185 
	`exŒaù_obj
(
t_obj
);

186 ià(
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

187 
	`obj_to_ch¬
(
t_obj
, 
obj
->
ÿ¼›d_by
);

189 
	`obj_to_room
(
t_obj
, 
obj
->
ÿ¼›d_by
->
š_room
);

191 ià(
obj
->
š_room
 !ğ
nuÎ±r
)

192 
	`obj_to_room
(
t_obj
, 
obj
->
š_room
);

194 
	`exŒaù_obj
(
t_obj
);

198 
	`acid_efãù
(
t_obj
, 
Ëv–
 / 2, 
dam
 / 2, 
TARGET_OBJ
, 
evŞutiÚ
);

202 ià(
obj
->
gems
) {

203 
Objeù
 *
t_obj
, *
n_obj
;

205 ià(
obj
->
ÿ¼›d_by
) {

206 ià(!
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

207 
	`aù
("$p' gem sÿ‰” oÀthground.", 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

209 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

210 
	`aù
("$p' gem sÿ‰” oÀthground.", 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

212 
t_obj
 = 
obj
->
gems
;_obj !ğ
nuÎ±r
;_obj = 
n_obj
) {

213 
n_obj
 = 
t_obj
->
Ãxt_cÚ‹Á
;

214 
	`obj_äom_obj
(
t_obj
);

216 ià(
obj
->
ÿ¼›d_by
) {

217 ià(
obj
->
ÿ¼›d_by
->
š_room
 =ğ
nuÎ±r
)

218 
	`exŒaù_obj
(
t_obj
);

219 ià(
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

220 
	`obj_to_ch¬
(
t_obj
, 
obj
->
ÿ¼›d_by
);

222 
	`obj_to_room
(
t_obj
, 
obj
->
ÿ¼›d_by
->
š_room
);

224 ià(
obj
->
š_room
 !ğ
nuÎ±r
)

225 
	`obj_to_room
(
t_obj
, 
obj
->
š_room
);

227 
	`exŒaù_obj
(
t_obj
);

231 
	`acid_efãù
(
t_obj
, 
Ëv–
 / 2, 
dam
 / 2, 
TARGET_OBJ
, 
evŞutiÚ
);

235 
	`exŒaù_obj
(
obj
);

237 
	}
}

239 
	$cŞd_efãù
(*
vo
, 
Ëv–
, 
dam
, 
rg‘
, 
evŞutiÚ
)

241 ià(
rg‘
 =ğ
TARGET_ROOM
) {

242 
Room
 *
room
 = (Room *è
vo
;

243 
Objeù
 *
obj
, *
obj_Ãxt
;

245 
obj
 = 
room
->
cÚ‹Ás
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

246 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

247 
	`cŞd_efãù
(
obj
, 
Ëv–
, 
dam
, 
TARGET_OBJ
, 
evŞutiÚ
);

253 ià(
rg‘
 =ğ
TARGET_CHAR
) {

254 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

255 
Objeù
 *
obj
, *
obj_Ãxt
;

258 ià(!
	`§ves_¥–l
(
Ëv–
 / 4 + 
dam
 / 20, 
viùim
, 
DAM_COLD
)) {

259 
	`aù
("$Àtuº bluªd shiv”s.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

260 
	`aù
("A chÈsšk d“°štØyou¸bÚes.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

262 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

263 
afãù
::
ty³
::
chl_touch
,

264 
Ëv–
,

266 
	`URANGE
(1, 
evŞutiÚ
 - 1, 4),

267 
çl£


272 ià(!
viùim
->
	`is_Åc
())

273 
	`gaš_cÚd™iÚ
(
viùim
, 
COND_HUNGER
, 
dam
 / 20);

276 ià(!
	`IS_IMMORTAL
(
viùim
)) {

277 
obj
 = 
viùim
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

278 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

279 
	`cŞd_efãù
(
obj
, 
Ëv–
, 
dam
, 
TARGET_OBJ
, 
evŞutiÚ
);

286 ià(
rg‘
 =ğ
TARGET_OBJ
) {

287 
Objeù
 *
obj
 = (Objeù *è
vo
;

288 
chªû
;

289 *
msg
;

290 
Ch¬aù”
 *
owÃr
;

293 ià((
owÃr
 = 
obj
->
ÿ¼›d_by
è!ğ
nuÎ±r


294 && 
afãù
::
	`exi¡s_Ú_ch¬
(
owÃr
,‡fãù::
ty³
::
sh“n
))

297 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BURN_PROOF
)

298 || 
	`IS_OBJ_STAT
(
obj
, 
ITEM_NOPURGE
)

299 || 
	`rŞl_chªû
(20))

302 
chªû
 = 
Ëv–
 / 4 + 
dam
 / 10;

304 ià(
chªû
 > 25)

305 
chªû
 = (chance - 25) / 2 + 25;

307 ià(
chªû
 > 50)

308 
chªû
 = (chance - 50) / 2 + 50;

310 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
))

311 
chªû
 -= 5;

313 
chªû
 -ğ
obj
->
Ëv–
 * 2;

315 
obj
->
™em_ty³
) {

319 
ITEM_POTION
:

320 
msg
 = "$p freezes‡nd EXPLODES!";

321 
chªû
 += 25;

324 
ITEM_DRINK_CON
:

325 
msg
 = "$p freezes‡nd EXPLODES!";

326 
chªû
 += 5;

330 
chªû
 = 
	`URANGE
(5, chance, 95);

332 ià(
	`numb”_³rûÁ
(è> 
chªû
)

335 ià(
obj
->
ÿ¼›d_by
)

336 
	`aù
(
msg
, 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

337 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

338 
	`aù
(
msg
, 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

340 ià(
obj
->
cÚšs
) {

341 
Objeù
 *
t_obj
, *
n_obj
;

343 ià(
obj
->
ÿ¼›d_by
) {

344 ià(!
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

345 
	`aù
("$p' cÚ‹Á sÿ‰” oÀthground.", 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

347 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

348 
	`aù
("$p' cÚ‹Á sÿ‰” oÀthground.", 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

350 
t_obj
 = 
obj
->
cÚšs
;_obj !ğ
nuÎ±r
;_obj = 
n_obj
) {

351 
n_obj
 = 
t_obj
->
Ãxt_cÚ‹Á
;

352 
	`obj_äom_obj
(
t_obj
);

354 ià(
obj
->
ÿ¼›d_by
) {

355 ià(
obj
->
ÿ¼›d_by
->
š_room
 =ğ
nuÎ±r
)

356 
	`exŒaù_obj
(
t_obj
);

358 ià(
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

359 
	`obj_to_ch¬
(
t_obj
, 
obj
->
ÿ¼›d_by
);

361 
	`obj_to_room
(
t_obj
, 
obj
->
ÿ¼›d_by
->
š_room
);

363 ià(
obj
->
š_room
 !ğ
nuÎ±r
)

364 
	`obj_to_room
(
t_obj
, 
obj
->
š_room
);

366 
	`exŒaù_obj
(
t_obj
);

370 
	`cŞd_efãù
(
t_obj
, 
Ëv–
 / 2, 
dam
 / 2, 
TARGET_OBJ
, 
evŞutiÚ
);

374 ià(
obj
->
gems
) {

375 
Objeù
 *
t_obj
, *
n_obj
;

377 ià(
obj
->
ÿ¼›d_by
) {

378 ià(!
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

379 
	`aù
("$p' gem sÿ‰” oÀthground.", 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

381 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

382 
	`aù
("$p' gem sÿ‰” oÀthground.", 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

384 
t_obj
 = 
obj
->
gems
;_obj !ğ
nuÎ±r
;_obj = 
n_obj
) {

385 
n_obj
 = 
t_obj
->
Ãxt_cÚ‹Á
;

386 
	`obj_äom_obj
(
t_obj
);

388 ià(
obj
->
ÿ¼›d_by
) {

389 ià(
obj
->
ÿ¼›d_by
->
š_room
 =ğ
nuÎ±r
)

390 
	`exŒaù_obj
(
t_obj
);

392 ià(
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

393 
	`obj_to_ch¬
(
t_obj
, 
obj
->
ÿ¼›d_by
);

395 
	`obj_to_room
(
t_obj
, 
obj
->
ÿ¼›d_by
->
š_room
);

397 ià(
obj
->
š_room
 !ğ
nuÎ±r
)

398 
	`obj_to_room
(
t_obj
, 
obj
->
š_room
);

400 
	`exŒaù_obj
(
t_obj
);

404 
	`cŞd_efãù
(
t_obj
, 
Ëv–
 / 2, 
dam
 / 2, 
TARGET_OBJ
, 
evŞutiÚ
);

408 
	`exŒaù_obj
(
obj
);

410 
	}
}

412 
	$fœe_efãù
(*
vo
, 
Ëv–
, 
dam
, 
rg‘
, 
evŞutiÚ
)

414 ià(
rg‘
 =ğ
TARGET_ROOM
) {

415 
Room
 *
room
 = (Room *è
vo
;

416 
Objeù
 *
obj
, *
obj_Ãxt
;

418 
obj
 = 
room
->
cÚ‹Ás
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

419 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

420 
	`fœe_efãù
(
obj
, 
Ëv–
, 
dam
, 
TARGET_OBJ
, 
evŞutiÚ
);

426 ià(
rg‘
 =ğ
TARGET_CHAR
) {

427 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

428 
Objeù
 *
obj
, *
obj_Ãxt
;

431 ià(!
	`is_blšded
(
viùim
)

432 && !
	`§ves_¥–l
(
Ëv–
 / 4 + 
dam
 / 20, 
viùim
, 
DAM_FIRE
)) {

433 
	`aù
("$Ài blšded by smoke!", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

434 
	`aù
("Yourƒyesear up from smoke...you can't see‡hing!",

435 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

437 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

438 
afãù
::
ty³
::
fœe_b»©h
,

439 
Ëv–
,

440 
	`numb”_¿nge
(0, 2),

441 
	`URANGE
(1, 
evŞutiÚ
 - 1, 4),

442 
çl£


447 ià(!
viùim
->
	`is_Åc
())

448 
	`gaš_cÚd™iÚ
(
viùim
, 
COND_THIRST
, 
dam
 / 20);

451 ià(!
	`IS_IMMORTAL
(
viùim
)) {

452 
obj
 = 
viùim
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

453 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

454 
	`fœe_efãù
(
obj
, 
Ëv–
, 
dam
, 
TARGET_OBJ
, 
evŞutiÚ
);

461 ià(
rg‘
 =ğ
TARGET_OBJ
) {

462 
Objeù
 *
obj
 = (Objeù *è
vo
;

463 
chªû
;

464 *
msg
;

465 
Ch¬aù”
 *
owÃr
;

468 ià((
owÃr
 = 
obj
->
ÿ¼›d_by
è!ğ
nuÎ±r


469 && 
afãù
::
	`exi¡s_Ú_ch¬
(
owÃr
,‡fãù::
ty³
::
sh“n
))

472 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BURN_PROOF
)

473 || 
	`IS_OBJ_STAT
(
obj
, 
ITEM_NOPURGE
)

474 || 
	`rŞl_chªû
(20))

477 
chªû
 = 
Ëv–
 / 4 + 
dam
 / 10;

479 ià(
chªû
 > 25)

480 
chªû
 = (chance - 25) / 2 + 25;

482 ià(
chªû
 > 50)

483 
chªû
 = (chance - 50) / 2 + 50;

485 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
))

486 
chªû
 -= 5;

488 
chªû
 -ğ
obj
->
Ëv–
 * 2;

490 
obj
->
™em_ty³
) {

494 
ITEM_CONTAINER
:

495 
msg
 = "$p ignites‡nd burns!";

498 
ITEM_POTION
:

499 
chªû
 += 25;

500 
msg
 = "$p bubbles‡nd boils!";

503 
ITEM_SCROLL
:

504 
chªû
 += 50;

505 
msg
 = "$p crackles‡nd burns!";

508 
ITEM_STAFF
:

509 
chªû
 += 10;

510 
msg
 = "$p smokes‡nd chars!";

513 
ITEM_WAND
:

514 
msg
 = "$p sparks‡nd sputters!";

517 
ITEM_FOOD
:

518 
msg
 = "$p blackens‡nd crisps!";

521 
ITEM_PILL
:

522 
msg
 = "$p melts‡nd drips!";

526 
chªû
 = 
	`URANGE
(5, chance, 95);

528 ià(
	`numb”_³rûÁ
(è> 
chªû
)

531 ià(
obj
->
ÿ¼›d_by
)

532 
	`aù
(
msg
, 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

533 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

534 
	`aù
(
msg
, 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

536 ià(
obj
->
cÚšs
) {

537 
Objeù
 *
t_obj
, *
n_obj
;

539 ià(
obj
->
ÿ¼›d_by
) {

540 ià(!
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

541 
	`aù
("$p' cÚ‹Á sÿ‰” oÀthground.", 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

543 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

544 
	`aù
("$p' cÚ‹Á sÿ‰” oÀthground.", 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

546 
t_obj
 = 
obj
->
cÚšs
;_obj !ğ
nuÎ±r
;_obj = 
n_obj
) {

547 
n_obj
 = 
t_obj
->
Ãxt_cÚ‹Á
;

548 
	`obj_äom_obj
(
t_obj
);

550 ià(
obj
->
ÿ¼›d_by
) {

551 ià(
obj
->
ÿ¼›d_by
->
š_room
 =ğ
nuÎ±r
)

552 
	`exŒaù_obj
(
t_obj
);

554 ià(
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

555 
	`obj_to_ch¬
(
t_obj
, 
obj
->
ÿ¼›d_by
);

557 
	`obj_to_room
(
t_obj
, 
obj
->
ÿ¼›d_by
->
š_room
);

559 ià(
obj
->
š_room
 !ğ
nuÎ±r
)

560 
	`obj_to_room
(
t_obj
, 
obj
->
š_room
);

562 
	`exŒaù_obj
(
t_obj
);

566 
	`fœe_efãù
(
t_obj
, 
Ëv–
 / 2, 
dam
 / 2, 
TARGET_OBJ
, 
evŞutiÚ
);

570 ià(
obj
->
gems
) {

571 
Objeù
 *
t_obj
, *
n_obj
;

573 ià(
obj
->
ÿ¼›d_by
) {

574 ià(!
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

575 
	`aù
("$p' gem sÿ‰” oÀthground.", 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

577 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

578 
	`aù
("$p' gem sÿ‰” oÀthground.", 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

580 
t_obj
 = 
obj
->
gems
;_obj !ğ
nuÎ±r
;_obj = 
n_obj
) {

581 
n_obj
 = 
t_obj
->
Ãxt_cÚ‹Á
;

582 
	`obj_äom_obj
(
t_obj
);

584 ià(
obj
->
ÿ¼›d_by
) {

585 ià(
obj
->
ÿ¼›d_by
->
š_room
 =ğ
nuÎ±r
)

586 
	`exŒaù_obj
(
t_obj
);

588 ià(
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

589 
	`obj_to_ch¬
(
t_obj
, 
obj
->
ÿ¼›d_by
);

591 
	`obj_to_room
(
t_obj
, 
obj
->
ÿ¼›d_by
->
š_room
);

593 ià(
obj
->
š_room
 !ğ
nuÎ±r
)

594 
	`obj_to_room
(
t_obj
, 
obj
->
š_room
);

596 
	`exŒaù_obj
(
t_obj
);

600 
	`fœe_efãù
(
t_obj
, 
Ëv–
 / 2, 
dam
 / 2, 
TARGET_OBJ
, 
evŞutiÚ
);

604 
	`exŒaù_obj
(
obj
);

606 
	}
}

608 
	$poisÚ_efãù
(*
vo
, 
Ëv–
, 
dam
, 
rg‘
, 
evŞutiÚ
)

610 ià(
rg‘
 =ğ
TARGET_ROOM
) {

611 
Room
 *
room
 = (Room *è
vo
;

612 
Objeù
 *
obj
, *
obj_Ãxt
;

614 
obj
 = 
room
->
cÚ‹Ás
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

615 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

616 
	`poisÚ_efãù
(
obj
, 
Ëv–
, 
dam
, 
TARGET_OBJ
, 
evŞutiÚ
);

622 ià(
rg‘
 =ğ
TARGET_CHAR
) {

623 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

624 
Objeù
 *
obj
, *
obj_Ãxt
;

627 ià(!
	`§ves_¥–l
(
Ëv–
 / 4 + 
dam
 / 20, 
viùim
, 
DAM_POISON
)) {

628 
	`¡c
("You feel…oison coursinghrough your veins.\n",

629 
viùim
);

630 
	`aù
("$Àlook v”y iÎ.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

632 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

633 
afãù
::
ty³
::
poisÚ
,

634 
Ëv–
,

635 
Ëv–
 / 2,

636 
	`URANGE
(1, 
evŞutiÚ
 - 1, 4),

637 
çl£


642 ià(!
	`IS_IMMORTAL
(
viùim
)) {

643 
obj
 = 
viùim
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

644 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

645 
	`poisÚ_efãù
(
obj
, 
Ëv–
, 
dam
, 
TARGET_OBJ
, 
evŞutiÚ
);

652 ià(
rg‘
 =ğ
TARGET_OBJ
) {

653 
Objeù
 *
obj
 = (Objeù *è
vo
;

654 
chªû
;

656 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BURN_PROOF
)

657 || 
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
)

658 || 
	`rŞl_chªû
(20))

661 
chªû
 = 
Ëv–
 / 4 + 
dam
 / 10;

663 ià(
chªû
 > 25)

664 
chªû
 = (chance - 25) / 2 + 25;

666 ià(
chªû
 > 50)

667 
chªû
 = (chance - 50) / 2 + 50;

669 
chªû
 -ğ
obj
->
Ëv–
 * 2;

671 
obj
->
™em_ty³
) {

675 
ITEM_FOOD
:

678 
ITEM_DRINK_CON
:

679 ià(
obj
->
v®ue
[0] == obj->value[1])

685 
chªû
 = 
	`URANGE
(5, chance, 95);

687 ià(
	`numb”_³rûÁ
(è> 
chªû
)

690 
obj
->
v®ue
[3] = 1;

693 
	}
}

695 
	$shock_efãù
(*
vo
, 
Ëv–
, 
dam
, 
rg‘
, 
evŞutiÚ
)

697 ià(
rg‘
 =ğ
TARGET_ROOM
) {

698 
Room
 *
room
 = (Room *è
vo
;

699 
Objeù
 *
obj
, *
obj_Ãxt
;

701 
obj
 = 
room
->
cÚ‹Ás
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

702 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

703 
	`shock_efãù
(
obj
, 
Ëv–
, 
dam
, 
TARGET_OBJ
, 
evŞutiÚ
);

709 ià(
rg‘
 =ğ
TARGET_CHAR
) {

710 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

711 
Objeù
 *
obj
, *
obj_Ãxt
;

714 ià(!
	`§ves_¥–l
(
Ëv–
 / 4 + 
dam
 / 20, 
viùim
, 
DAM_ELECTRICITY
)) {

715 
	`¡c
("You¸musşe ¡İ„e¥Údšg.\n", 
viùim
);

716 
	`DAZE_STATE
(
viùim
, 
¡d
::
	`max
(12, 
Ëv–
 / 4 + 
dam
 / 20));

720 ià(!
	`IS_IMMORTAL
(
viùim
)) {

721 
obj
 = 
viùim
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

722 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

723 
	`shock_efãù
(
obj
, 
Ëv–
, 
dam
, 
TARGET_OBJ
, 
evŞutiÚ
);

730 ià(
rg‘
 =ğ
TARGET_OBJ
) {

731 
Objeù
 *
obj
 = (Objeù *è
vo
;

732 
chªû
;

733 *
msg
;

734 
Ch¬aù”
 *
owÃr
;

737 ià((
owÃr
 = 
obj
->
ÿ¼›d_by
è!ğ
nuÎ±r


738 && 
afãù
::
	`exi¡s_Ú_ch¬
(
owÃr
,‡fãù::
ty³
::
sh“n
))

741 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BURN_PROOF
)

742 || 
	`IS_OBJ_STAT
(
obj
, 
ITEM_NOPURGE
)

743 || 
	`rŞl_chªû
(20))

746 
chªû
 = 
Ëv–
 / 4 + 
dam
 / 10;

748 ià(
chªû
 > 25)

749 
chªû
 = (chance - 25) / 2 + 25;

751 ià(
chªû
 > 50)

752 
chªû
 = (chance - 50) / 2 + 50;

754 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
))

755 
chªû
 -= 5;

757 
chªû
 -ğ
obj
->
Ëv–
 * 2;

759 
obj
->
™em_ty³
) {

763 
ITEM_WAND
:

764 
ITEM_STAFF
:

765 
chªû
 += 10;

766 
msg
 = "$p overloads‡ndƒxplodes!";

769 
ITEM_JEWELRY
:

770 
chªû
 -= 10;

771 
msg
 = "$p is fused into‡ worthless†ump.";

774 
chªû
 = 
	`URANGE
(5, chance, 95);

776 ià(
	`numb”_³rûÁ
(è> 
chªû
)

779 ià(
obj
->
ÿ¼›d_by
)

780 
	`aù
(
msg
, 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

781 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

782 
	`aù
(
msg
, 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

784 ià(
obj
->
cÚšs
) {

785 
Objeù
 *
t_obj
, *
n_obj
;

787 ià(
obj
->
ÿ¼›d_by
) {

788 ià(!
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

789 
	`aù
("$p' cÚ‹Á sÿ‰” oÀthground.", 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

791 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

792 
	`aù
("$p' cÚ‹Á sÿ‰” oÀthground.", 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

794 
t_obj
 = 
obj
->
cÚšs
;_obj !ğ
nuÎ±r
;_obj = 
n_obj
) {

795 
n_obj
 = 
t_obj
->
Ãxt_cÚ‹Á
;

796 
	`obj_äom_obj
(
t_obj
);

798 ià(
obj
->
ÿ¼›d_by
) {

799 ià(
obj
->
ÿ¼›d_by
->
š_room
 =ğ
nuÎ±r
)

800 
	`exŒaù_obj
(
t_obj
);

802 ià(
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

803 
	`obj_to_ch¬
(
t_obj
, 
obj
->
ÿ¼›d_by
);

805 
	`obj_to_room
(
t_obj
, 
obj
->
ÿ¼›d_by
->
š_room
);

807 ià(
obj
->
š_room
 !ğ
nuÎ±r
)

808 
	`obj_to_room
(
t_obj
, 
obj
->
š_room
);

810 
	`exŒaù_obj
(
t_obj
);

814 
	`shock_efãù
(
t_obj
, 
Ëv–
 / 2, 
dam
 / 2, 
TARGET_OBJ
, 
evŞutiÚ
);

818 ià(
obj
->
gems
) {

819 
Objeù
 *
t_obj
, *
n_obj
;

821 ià(
obj
->
ÿ¼›d_by
) {

822 ià(!
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

823 
	`aù
("$p' gem sÿ‰” oÀthground.", 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

825 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

826 
	`aù
("$p' gem sÿ‰” oÀthground.", 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

828 
t_obj
 = 
obj
->
gems
;_obj !ğ
nuÎ±r
;_obj = 
n_obj
) {

829 
n_obj
 = 
t_obj
->
Ãxt_cÚ‹Á
;

830 
	`obj_äom_obj
(
t_obj
);

832 ià(
obj
->
ÿ¼›d_by
) {

833 ià(
obj
->
ÿ¼›d_by
->
š_room
 =ğ
nuÎ±r
)

834 
	`exŒaù_obj
(
t_obj
);

836 ià(
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

837 
	`obj_to_ch¬
(
t_obj
, 
obj
->
ÿ¼›d_by
);

839 
	`obj_to_room
(
t_obj
, 
obj
->
ÿ¼›d_by
->
š_room
);

841 ià(
obj
->
š_room
 !ğ
nuÎ±r
)

842 
	`obj_to_room
(
t_obj
, 
obj
->
š_room
);

844 
	`exŒaù_obj
(
t_obj
);

848 
	`shock_efãù
(
t_obj
, 
Ëv–
 / 2, 
dam
 / 2, 
TARGET_OBJ
, 
evŞutiÚ
);

852 
	`exŒaù_obj
(
obj
);

854 
	}
}

	@src/event/Dispatcher.cc

1 
	~"ev’t/Di¥©ch”.hh
"

3 
	~"ev’t/ev’t.hh
"

4 
	~"ev’t/HªdËr.hh
"

6 
Çme¥aû
 
	gev’t
 {

8 
	gDi¥©ch”
::

9 
fœe
(
Ty³
 
ty³
, 
Args
 
¬gs
) {

10 autØ
	g¿nge
 = 
subsüib”s
.
equ®_¿nge
(
ty³
);

11 autØ
	g™
 = 
¿nge
.
fœ¡
;

17 
	g™
 !ğ
¿nge
.
£cÚd
) {

18 
HªdËr
 *
p
 = 
™
->
£cÚd
;

19 
	gp
->
nÙify
(
ty³
, 
¬gs
);

21 ià(
	g™
->
	g£cÚd
 =ğ
p
)

22 ++
™
;

26 
	gDi¥©ch”
::

27 
subsüibe
(
Ty³
 
ty³
, 
HªdËr
 *
s
) {

31 autØ
	gpos
 = 
subsüib”s
.
cbegš
();

32 
	gsubsüib”s
.
em¶aû_hšt
(
pos
, 
ty³
, 
s
);

35 
	gDi¥©ch”
::

36 
unsubsüibe
(
Ty³
 
ty³
, 
HªdËr
 *
s
) {

37 autØ
	g¿nge
 = 
subsüib”s
.
equ®_¿nge
(
ty³
);

38 autØ
	g™
 = 
¿nge
.
fœ¡
;

40 
	g™
 !ğ
¿nge
.
£cÚd
) {

41 ià(
™
->
£cÚd
 =ğ
s
)

42 
™
 = 
subsüib”s
.
”a£
(it);

44 ++
	g™
;

	@src/fight.cc

28 
	~<veùÜ
>

30 
	~"aù.hh
"

31 
	~"¬gum’t.hh
"

32 
	~"afãù/Afãù.hh
"

33 
	~"A»a.hh
"

34 
	~"B©e.hh
"

35 
	~"chªÃls.hh
"

36 
	~"Ch¬aù”.hh
"

37 
	~"CÏn.hh
"

38 
	~"deş¬e.hh
"

39 
	~"di¥–.hh
"

40 
	~"DesütÜ.hh
"

41 
	~"ev’t/ev’t.hh
"

42 
	~"Ex™.hh
"

43 
	~"fšd.hh
"

44 
	~"FÏgs.hh
"

45 
	~"FÜm©.hh
"

46 
	~"Game.hh
"

47 
	~"GameTime.hh
"

48 
	~"š‹½.hh
"

49 
	~"Loggšg.hh
"

50 
	~"loÙv2.hh
"

51 
	~"magic.hh
"

52 
	~"memÜy.hh
"

53 
	~"m”c.hh
"

54 
	~"MobProg.hh
"

55 
	~"MobePrÙÙy³.hh
"

56 
	~"Objeù.hh
"

57 
	~"ObjeùV®ue.hh
"

58 
	~"PÏy”.hh
"

59 
	~"Que¡A»a.hh
"

60 
	~"¿ndom.hh
"

61 
	~"Room.hh
"

62 
	~"skl/skl.hh
"

63 
	~"SŒšg.hh
"

64 
	~"bËs.hh
"

65 
	~"W—th”.hh
"

66 
	~"WÜld.hh
"

68 
	#PKTIME
 10

	)

71 
w—r_obj
 
¬gs
((
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, 
boŞ
 
fR•Ïû
));

76 
check_assi¡
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
));

77 
check_cÚd
 
¬gs
((
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
));

78 
check_®l_cÚd
 
¬gs
((
Ch¬aù”
 *
ch
));

79 
check_kËr
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
));

80 
boŞ
 
check_dodge
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
, 
©ck_ty³
));

81 
boŞ
 
check_blur
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
, 
©ck_ty³
));

82 
boŞ
 
check_shblock
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
, 
©ck_ty³
));

83 
boŞ
 
check_·¼y
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
, 
©ck_ty³
));

84 
boŞ
 
check_du®_·¼y
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
, 
©ck_ty³
));

85 
do_ro¡e
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
));

86 
dam_mes§ge
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
dam
, 
skl
::
ty³
 
©ck_skl
, 
©ck_ty³
, 
boŞ
 
immuÃ
, boŞ 
§nc_immuÃ
));

87 
d—th_üy
 
¬gs
((
Ch¬aù”
 *
ch
));

89 
group_gaš
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
));

90 
xp_compu‹
 
¬gs
((
Ch¬aù”
 *
gch
, Ch¬aù” *
viùim
, 
tÙ®_Ëv–s
, 
diff_şas£s
));

91 
boŞ
 
is_§ã
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, boŞ 
showmsg
));

92 
make_cÜp£
 
¬gs
((
Ch¬aù”
 *
ch
));

93 
boŞ
 
check_pul£
 
¬gs
((
Ch¬aù”
 *
viùim
));

94 
kl_off
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
));

95 
Úe_h™
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
, 
boŞ
 
£cÚd¬y
));

96 
mob_h™
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
));

97 
¿w_kl
 
¬gs
((
Ch¬aù”
 *
viùim
));

98 
£t_fightšg
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
));

99 
comb©_»g’
 
¬gs
((
Ch¬aù”
 *
ch
));

100 
nÚcomb©_»g’
 
¬gs
((
Ch¬aù”
 *
ch
));

101 
do_Ïy_Ú_hªds
 
¬gs
((
Ch¬aù”
 *
ch
, cÚ¡ *
¬gum’t
));

102 
boŞ
 
deãn£_h—l
 
¬gs
((
Ch¬aù”
 *
viùim
, 
chªû
, 
³rûÁ
));

106 
	ggxp
;

109 
boŞ
 
	gfocus
 = 
Œue
;

110 
boŞ
 
	gglob®_quick
 = 
çl£
;

114 
	$viŞ’û_upd©e
()

116 
Ch¬aù”
 *
viùim
;

119 autØ
ch
 : 
Game
::
	`wÜld
().
ch¬_li¡
)

120 ià(
ch
->
fightšg
)

121 
	`check_assi¡
(
ch
, ch->
fightšg
);

123 autØ
ch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

124 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

132 
	`©Œibu‹_check
(
Ch¬aù”
 *
ch
);

133 
	`©Œibu‹_check
(
ch
);

136 ià(
ch
->
	`is_Åc
()

137 && 
ch
->
fightšg
 =ğ
nuÎ±r


138 && 
	`IS_AWAKE
(
ch
)

139 && 
ch
->
huÁšg
 !ğ
nuÎ±r
) {

140 
	`huÁ_viùim
(
ch
);

144 ià((
viùim
 = 
ch
->
fightšg
è=ğ
nuÎ±r
) {

147 ià(!
ch
->
	`is_Åc
()) {

148 ià(
ch
->
pcd©a
->
pktim”


149 && --
ch
->
pcd©a
->
pktim”
 == 0

150 && 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
shadow_fÜm
))

151 
afãù
::
	`»move_ty³_äom_ch¬
(
ch
,‡fãù::
ty³
::
shadow_fÜm
);

153 ià(
ch
->
pcd©a
->
comb©tim”
 > 0)

154 
ch
->
pcd©a
->
comb©tim”
--;

156 
	`nÚcomb©_»g’
(
ch
);

163 ià(!
ch
->
	`is_Åc
())

164 
ch
->
pcd©a
->
comb©tim”
 = 5;

166 
	`comb©_»g’
(
ch
);

170 ià(
ch
->
wa™
 =ğ0 && 
	`g‘_pos™iÚ
(chè< 
POS_FIGHTING
) {

171 
	`aù
("You cÏmb”Øyou¸ã‘.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

172 
	`aù
("$Àşamb” tØ$ ã‘.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

175 ià(
ch
->
	`is_Åc
())

176 
ch
->
wa™
 = 1;

178 
Ch¬aù”
 *
rch
;

180 
rch
 = 
ch
->
š_room
->
³İË
;„ch;„ch =„ch->
Ãxt_š_room
)

181 ià(
rch
->
	`is_Åc
()

182 && 
rch
->
fightšg
 =ğ
ch


183 && 
	`g‘_pos™iÚ
(
rch
è=ğ
POS_FIGHTING
)

184 
rch
->
wa™
 = 
¡d
::
	`max
(rch->wait, 1);

187 
ch
->
pos™iÚ
 = 
POS_STANDING
;

189 ià(
ch
->
¡¬t_pos
 =ğ
POS_FLYING
 && 
	`CAN_FLY
(ch))

190 
	`do_æy
(
ch
, "");

193 ià(
	`IS_AWAKE
(
ch
è&& ch->
š_room
 =ğ
viùim
->in_room)

194 
	`muÉi_h™
(
ch
, 
viùim
, 
skl
::
ty³
::
unknown
);

196 
	`¡İ_fightšg
(
ch
, 
çl£
);

198 ià(
ch
 =ğ
nuÎ±r
 || ch->
fightšg
 ==‚ullptr)

203 ià(
ch
->
wa™
 > 0)

207 ià(
ch
->
	`is_Åc
()) {

208 ià((
ch
->
aù_æags
.
	`has
(
ACT_WIMPY
)

209 && 
	`numb”_b™s
(2) == 0

210 && 
ch
->
h™
 < 
	`GET_MAX_HIT
(ch) / 5)

211 || (
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
)

212 && 
ch
->
ma¡”
 !ğ
nuÎ±r


213 && 
ch
->
ma¡”
->
š_room
 != ch->in_room))

214 
	`do_æ“
(
ch
, "");

216 ià(
ch
->
h™
 > 0 && ch->h™ <ğch->
wimpy
)

217 
	`do_æ“
(
ch
, "");

219 ià(
ch
->
fightšg
 =ğ
nuÎ±r
)

222 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ã¬
))

223 
	`do_æ“
(
ch
, "");

225 ià((
viùim
 = 
ch
->
fightšg
è=ğ
nuÎ±r
)

229 ià(
ch
->
	`is_Åc
()

230 && 
viùim
->
	`is_Åc
()

231 && 
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ch¬m_³rsÚ
)

232 && 
viùim
->
ma¡”
 !ğ
nuÎ±r


233 && 
viùim
->
ma¡”
->
š_room
 =ğ
ch
->in_room

234 && 
	`rŞl_chªû
(15)) {

235 ià(!
	`ÿn_£e_ch¬
(
ch
, 
viùim
->
ma¡”
)) {

236 ià(
	`rŞl_chªû
(50))

237 
	`do_æ“
(
ch
, "");

240 
	`aù
("$Àchªge thfocu oà$ ©cks.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

241 
	`¡İ_fightšg
(
ch
, 
çl£
);

242 
	`£t_fightšg
(
ch
, 
viùim
->
ma¡”
);

247 ià((
viùim
 = 
ch
->
fightšg
è=ğ
nuÎ±r
)

250 
	`m´og_h™´út_Œigg”
(
ch
, 
viùim
);

252 ià(
ch
->
	`is_g¬bage
(è|| 
viùim
->is_garbage())

255 
	`m´og_fight_Œigg”
(
ch
, 
viùim
);

257 
	}
}

259 
	$nÚcomb©_»g’
(
Ch¬aù”
 *
ch
) {

260 
h™gaš
 = 
	`GET_MAX_HIT
(
ch
)/10;

261 
mªagaš
 = 
	`GET_MAX_MANA
(
ch
)/10;

262 
¡amgaš
 = 
	`GET_MAX_STAM
(
ch
)/10;

264 ià(
ch
->
h™
 < 
	`GET_MAX_HIT
(ch)

265 || 
ch
->
mªa
 < 
	`GET_MAX_MANA
(ch)

266 || 
ch
->
¡am
 < 
	`GET_MAX_STAM
(ch)) {

267 
ch
->
h™
 = 
¡d
::
	`mš
(
	`GET_MAX_HIT
(ch), ch->h™ + 
h™gaš
);

268 
ch
->
mªa
 = 
¡d
::
	`mš
(
	`GET_MAX_MANA
(ch), ch->mª¨+ 
mªagaš
);

269 
ch
->
¡am
 = 
¡d
::
	`mš
(
	`GET_MAX_STAM
(ch), ch->¡am + 
¡amgaš
);

272 ià(
ch
->
h™
 =ğ
	`GET_MAX_HIT
(ch)

273 && 
ch
->
mªa
 =ğ
	`GET_MAX_MANA
(ch)

274 && 
ch
->
¡am
 =ğ
	`GET_MAX_STAM
(ch)

275 && 
ch
->
pcd©a
->
comb©tim”
 == 0) {

276 
	`¡c
("You havfuÎy„ecov”ed from comb©.\n", 
ch
);

277 
ch
->
pcd©a
->
comb©tim”
 = -1;

279 
	}
}

281 
	$comb©_»g’
(
Ch¬aù”
 *
ch
)

283 
h™gaš
 = 0, 
mªagaš
 = 0, 
¡amgaš
 = 0;

286 ià(
ch
->
¿û
 =ğ6 && !ch->
	`is_Åc
()) {

287 
sun_damage
;

288 
GameTime
::
Sun
 
sun
 = 
ch
->
š_room
->
	`¬—
().
wÜld
.
time
.
suÆight
;

289 
W—th”
::
Sky
 
sky
 = 
ch
->
š_room
->
	`¬—
().
wÜld
.
w—th”
.sky;

292 ià(
ch
->
š_room
->
	`æags
().
	`has_ªy_of
(
ROOM_DARK
 | 
ROOM_INDOORS
)

293 || 
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
šside


294 || 
sun
 =ğ
GameTime
::
Night
)

295 
h™gaš
 +ğ(
ch
->
Ëv–
 / 10) + 1;

298 
sun_damage
 = (
ch
->
Ëv–
 / 20) + 1;

301 ià(
sun
 =ğ
GameTime
::
SuÄi£


302 || 
sun
 =ğ
GameTime
::
Sun£t
)

303 
sun_damage
 = (sun_damage * 3) / 4;

306 ià(
sky
 !ğ
W—th”
::
CloudËss
)

307 
sun_damage
 = (sun_damage * 4) / 5;

309 ià(
sun_damage
 < 0)

310 
sun_damage
 = 1;

312 
sun_damage
 -ğsun_damag* 
	`GET_DEFENSE_MOD
(
ch
, 
DAM_LIGHT
) / 100;

314 ià(
sun_damage
 > 0) {

315 
	`damage
(
ch
->
fightšg
, ch, 
sun_damage
, 
skl
::
ty³
::
unknown
, -1, 
DAM_NONE
, 
çl£
, 
Œue
);

317 ià(
ch
->
	`is_g¬bage
())

324 ià(
	`HAS_RAFF
(
ch
, 
RAFF_MAGEREGEN
è&& ch->
mªa
 < 
	`GET_MAX_MANA
(ch))

325 
mªagaš
 +ğ(
ch
->
Ëv–
 / 20) + 1;

328 ià(
	`HAS_RAFF
(
ch
, 
RAFF_VAMPREGEN
è&& ch->
h™
 < 
	`GET_MAX_HIT
(ch))

329 
h™gaš
 +ğ(
ch
->
Ëv–
 / 20) + 1;

333 ià(
	`GET_ATTR
(
ch
, 
SET_WARRIOR_BESERKER
) >= 3)

334 
h™gaš
 +ğ(
	`GET_MAX_HIT
(
ch
) * 5 / 100);

338 ià(
	`GET_ATTR
(
ch
, 
SET_THIEF_CUTPURSE
) >= 3)

339 
¡amgaš
 +ğ(
	`GET_MAX_STAM
(
ch
) * 5 / 100);

341 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
»g’”©iÚ
è&& ch->
¡am
 < 
	`GET_MAX_STAM
(ch))

342 
	`g‘_afãù_evŞutiÚ
(
ch
, 
afãù
::
ty³
::
»g’”©iÚ
)) {

343 2: 
¡amgaš
 +ğ
ch
->
Ëv–
 / 30 + 2; ;

345 3: 
¡amgaš
 +ğ
ch
->
Ëv–
 / 15 + 3; ;

347 4: 
¡amgaš
 +ğ
ch
->
Ëv–
 / 10 + 4; ;

352 ià(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
med™©iÚ
è&& ch->
mªa
 < 
	`GET_MAX_MANA
(ch))

353 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
med™©iÚ
)) {

354 2: 
mªagaš
 +ğ
ch
->
Ëv–
 / 30 + 2; ;

356 3: 
mªagaš
 +ğ
ch
->
Ëv–
 / 15 + 3; ;

358 4: 
mªagaš
 +ğ
ch
->
Ëv–
 / 10 + 4; ;

363 ià(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
ç¡_h—lšg
è&& ch->
h™
 < 
	`GET_MAX_HIT
(ch))

364 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
ç¡_h—lšg
)) {

365 2: 
h™gaš
 +ğ
ch
->
Ëv–
 / 30 + 2; ;

367 3: 
h™gaš
 +ğ
ch
->
Ëv–
 / 15 + 3; ;

369 4: 
h™gaš
 +ğ
ch
->
Ëv–
 / 10 + 4; ;

374 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
divše_»g’”©iÚ
)) {

375 
gaš
 = 0;

377 
	`g‘_afãù_evŞutiÚ
(
ch
, 
afãù
::
ty³
::
divše_»g’”©iÚ
)) {

378 2: 
gaš
 = 
ch
->
Ëv–
 / 30; ;

380 3: 
gaš
 = 
ch
->
Ëv–
 / 15; ;

382 4: 
gaš
 = 
ch
->
Ëv–
 / 10; ;

387 
h™gaš
 +ğ
gaš
;

388 
mªagaš
 +ğ
gaš
;

389 
¡amgaš
 +ğ
gaš
;

392 ià(
ch
->
h™
 < 
	`GET_MAX_HIT
(ch)èch->h™ = 
¡d
::
	`mš
(GET_MAX_HIT(ch), ch->h™ + 
h™gaš
);

394 ià(
ch
->
mªa
 < 
	`GET_MAX_MANA
(ch)èch->mª¨ğ
¡d
::
	`mš
(GET_MAX_MANA(ch), ch->mª¨+ 
mªagaš
);

396 ià(
ch
->
¡am
 < 
	`GET_MAX_STAM
(ch)èch->¡am = 
¡d
::
	`mš
(GET_MAX_STAM(ch), ch->¡am + 
¡amgaš
);

397 
	}
}

399 
	$check_®l_cÚd
(
Ch¬aù”
 *
ch
)

401 
iW—r
;

402 
Objeù
 *
obj
;

404 ià(
ch
->
	`is_Åc
(è|| 
	`IS_IMMORTAL
(ch))

407 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
sh“n
))

410 
iW—r
 = 0; iW—¸< 
MAX_WEAR
; iWear++) {

411 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
iW—r
)è=ğ
nuÎ±r
 || obj->
cÚd™iÚ
 == -1)

414 
	`check_cÚd
(
ch
, 
obj
);

416 
	}
}

418 
	$check_cÚd
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
)

420 ià(
	`IS_IMMORTAL
(
ch
))

423 ià(
obj
->
cÚd™iÚ
 == -1)

427 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
sh“n
))

430 ià((
	`numb”_¿nge
(0, 500)) != 100)

433 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¡“l_mi¡
))

434 
obj
->
cÚd™iÚ
 -ğ
	`numb”_¿nge
(1, 4);

436 
obj
->
cÚd™iÚ
 -ğ
	`numb”_¿nge
(1, 8);

438 ià(
obj
->
cÚd™iÚ
 <= 0) {

439 
	`aù
("{W$p{x ha b“À{Wde¡royed{x iÀcomb©!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

441 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a
 && !
	`ch¬_š_d¬’a_room
(ch)) {

442 ià(
obj
->
cÚšs
) {

443 
	`aù
("$°sÿ‰” ™' cÚ‹Á Úhground.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

444 
	`aù
("$n' $°b»aks, sÿ‰”šg it' cÚ‹Á Úhground.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

446 ià(
obj
->
gems
) {

447 
	`aù
("$°sÿ‰” ™' gem Úhground.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

448 
	`aù
("$n' $°b»aks, sÿ‰”šg it' gem Úhground.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

452 
	`de¡roy_obj
(
obj
);

455 
	`aù
("{W$p{x ha b“À{Wdamaged{x iÀcomb©!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

456 
	}
}

459 
	$check_assi¡
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

461 
Ch¬aù”
 *
rch
, *
rch_Ãxt
;

463 
rch
 = 
ch
->
š_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch = 
rch_Ãxt
) {

464 
rch_Ãxt
 = 
rch
->
Ãxt_š_room
;

466 ià(!
	`IS_AWAKE
(
rch
))

469 ià(
rch
->
fightšg
 !ğ
nuÎ±r
)

472 
Ch¬aù”
 *
rg‘
 = 
nuÎ±r
;

474 ià(
ch
->
	`is_Åc
()) {

475 ià(
rch
->
	`is_Åc
()) {

479 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
)) {

480 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
rch
,‡fãù::
ty³
::
ch¬m_³rsÚ
)

481 && 
	`is_§me_group
(
ch
, 
rch
))

482 
rg‘
 = 
viùim
;

485 ià(
rch
->
off_æags
.
	`has
(
ASSIST_ALL
)

486 || 
	`is_§me_group
(
ch
, 
rch
)

487 || (
rch
->
off_æags
.
	`has
(
ASSIST_RACE
è&&„ch->
¿û
 =ğ
ch
->race)

488 || (
rch
->
off_æags
.
	`has
(
ASSIST_ALIGN
)

489 && ((
	`IS_GOOD
(
rch
è&& IS_GOOD(
ch
))

490 || (
	`IS_EVIL
(
rch
è&& IS_EVIL(
ch
))

491 || (
	`IS_NEUTRAL
(
rch
è&& IS_NEUTRAL(
ch
))))

492 || (
rch
->
off_æags
.
	`has
(
ASSIST_VNUM
è&&„ch->
pIndexD©a
 =ğ
ch
->pIndexData)) {

493 
numb”
 = 0;

495 ià(
	`rŞl_chªû
(50))

498 
Ch¬aù”
 *
vch
 = 
ch
->
š_room
->
³İË
; vch; vch = vch->
Ãxt_š_room
) {

499 ià(
	`ÿn_£e_ch¬
(
rch
, 
vch
)

500 && 
	`is_§me_group
(
vch
, 
viùim
)

501 && 
	`numb”_¿nge
(0, 
numb”
) == 0) {

502 
rg‘
 = 
vch
;

503 
numb”
++;

510 ià(
rch
->
aù_æags
.
	`has
(
PLR_AUTOASSIST
)

511 && 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
)

512 && 
	`is_§me_group
(
ch
, 
rch
))

513 
rg‘
 = 
viùim
;

517 ià(
rch
->
	`is_Åc
()) {

518 ià(
rch
->
off_æags
.
	`has
(
ASSIST_PLAYERS
)

519 && 
rch
->
Ëv–
 + 6 > 
viùim
->level) {

520 
rg‘
 = 
viùim
;

522 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
rch
,‡fãù::
ty³
::
ch¬m_³rsÚ
)

523 && 
	`is_§me_group
(
ch
, 
rch
))

524 
rg‘
 = 
viùim
;

529 ià(
rch
->
aù_æags
.
	`has
(
PLR_AUTOASSIST
)

530 && 
	`is_§me_group
(
ch
, 
rch
))

531 
rg‘
 = 
viùim
;

535 ià(
rg‘
 =ğ
nuÎ±r
)

538 ià(
	`is_§ã
(
rch
, 
rg‘
, 
çl£
))

541 ià(
rch
->
	`is_Åc
())

542 
	`do_emÙe
(
rch
, "screams‡nd‡ttacks!");

544 
	`muÉi_h™
(
rch
, 
rg‘
, 
skl
::
ty³
::
unknown
);

546 
	}
}

548 
	$check_´ÙeùiÚ_au¿
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
) {

550 ià((
	`IS_EVIL
(
ch
)

551 && 
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
´ÙeùiÚ_ev
))

552 || (
	`IS_GOOD
(
ch
)

553 && 
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
´ÙeùiÚ_good
))) {

554 cÚ¡ 
afãù
::
Afãù
 *
·f
 = 
	`IS_EVIL
(
ch
) ?

555 
afãù
::
	`fšd_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
´ÙeùiÚ_ev
) :

556 
afãù
::
	`fšd_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
´ÙeùiÚ_good
);

558 ià(
·f
 !ğ
nuÎ±r
) {

559 ià(
·f
->
evŞutiÚ
 >= 2) {

560 ià(
	`rŞl_chªû
(
·f
->
evŞutiÚ
 * 3)) {

561 
buf
[
MSL
];

562 
	`DAZE_STATE
(
ch
, 2 * 
PULSE_VIOLENCE
);

564 
FÜm©
::
	`¥rštf
(
buf
, "The impact with $N's %s‡ura sends‡‚umbing shockhrough your‡rm!",

565 
	`IS_EVIL
(
ch
) ? "holy" : "unholy");

566 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

567 
FÜm©
::
	`¥rštf
(
buf
, "Your %s‡ura shocks $n's‡rm!",

568 
	`IS_EVIL
(
ch
) ? "holy" : "unholy");

569 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

570 
FÜm©
::
	`¥rštf
(
buf
, "$N's %s‡ura shocks $n's‡rm!",

571 
	`IS_EVIL
(
ch
) ? "holy" : "unholy");

572 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

576 ià(
·f
->
evŞutiÚ
 >= 3) {

577 ià(
	`rŞl_chªû
(
·f
->
evŞutiÚ
)) {

578 
buf
[
MSL
];

579 
	`WAIT_STATE
(
ch
, 2 * 
PULSE_VIOLENCE
);

581 
FÜm©
::
	`¥rštf
(
buf
, "$N's %s‡ura knocks you back, momentarily stunning you!",

582 
	`IS_EVIL
(
ch
) ? "holy" : "unholy");

583 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

584 
FÜm©
::
	`¥rštf
(
buf
, "Your %s‡ura knocks $n back, momentarily stunning $s!",

585 
	`IS_EVIL
(
ch
) ? "holy" : "unholy");

586 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

587 
FÜm©
::
	`¥rštf
(
buf
, "$N's %s‡ura knocks $n back, momentarily stunning $n!",

588 
	`IS_EVIL
(
ch
) ? "holy" : "unholy");

589 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

594 
	}
}

596 
	$muÉi_h™
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
)

598 
Objeù
 *
obj
;

599 
chªû
;

604 ià(!
ch
->
	`is_Åc
())

605 
ch
->
pcd©a
->
comb©tim”
 = 5;

608 ià(
	`g‘_pos™iÚ
(
ch
è< 
POS_RESTING
)

611 ià(
ch
->
	`is_Åc
()) {

612 
	`mob_h™
(
ch
, 
viùim
, 
©ck_skl
);

616 
	`Úe_h™
(
ch
, 
viùim
, 
©ck_skl
, 
çl£
);

618 ià(!
ch
->
fightšg
)

621 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_SECONDARY
)) {

622 
chªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
du®_w›ld
);

624 ià(
	`CAN_USE_RSKILL
(
ch
, 
skl
::
ty³
::
du®_£cÚd
))

625 
chªû
 +ğ
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
du®_£cÚd
) / 10;

627 
chªû
 +ğ((
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
du®_w›ld
) - 1) * 5);

629 ià(
	`rŞl_chªû
(
chªû
)) {

630 
	`Úe_h™
(
ch
, 
viùim
, 
©ck_skl
, 
Œue
);

631 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
du®_w›ld
, 
Œue
, 6);

633 ià(!
ch
->
fightšg
)

637 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
du®_w›ld
, 
çl£
, 6);

640 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ha¡e
))

641 
	`Úe_h™
(
ch
, 
viùim
, 
©ck_skl
, 
çl£
);

643 ià(!
ch
->
fightšg
 || 
©ck_skl
 =ğ
skl
::
ty³
::
back¡ab
)

646 
chªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
£cÚd_©ck
) / 2;

648 ià(
	`CAN_USE_RSKILL
(
ch
, 
skl
::
ty³
::
fou¹h_©ck
))

649 
chªû
 +ğ
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
fou¹h_©ck
) / 10;

651 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
))

652 
chªû
 /= 2;

654 ià(
	`rŞl_chªû
(
chªû
)) {

655 
	`Úe_h™
(
ch
, 
viùim
, 
©ck_skl
, 
çl£
);

656 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
£cÚd_©ck
, 
Œue
, 5);

658 ià(!
ch
->
fightšg
)

662 
chªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
thœd_©ck
) / 4;

664 ià(
	`CAN_USE_RSKILL
(
ch
, 
skl
::
ty³
::
fou¹h_©ck
))

665 
chªû
 +ğ
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
fou¹h_©ck
) / 10;

667 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
))

668 
chªû
 = 0;

670 ià(
	`rŞl_chªû
(
chªû
)) {

671 
	`Úe_h™
(
ch
, 
viùim
, 
©ck_skl
, 
çl£
);

672 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
thœd_©ck
, 
Œue
, 6);

674 ià(!
ch
->
fightšg
)

678 
chªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
fou¹h_©ck
) / 2;

680 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
è|| !
	`CAN_USE_RSKILL
(ch, 
skl
::ty³::
fou¹h_©ck
))

681 
chªû
 = 0;

683 ià(
	`rŞl_chªû
(
chªû
)) {

684 
	`Úe_h™
(
ch
, 
viùim
, 
©ck_skl
, 
çl£
);

685 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
fou¹h_©ck
, 
Œue
, 6);

687 ià(!
ch
->
fightšg
)

691 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_SECONDARY
)) {

692 
chªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
du®_£cÚd
) / 2;

694 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
è|| !
	`CAN_USE_RSKILL
(ch, 
skl
::ty³::
du®_£cÚd
))

695 
chªû
 = 0;

697 
chªû
 +ğ((
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
du®_w›ld
) - 1) * 5);

699 ià(
	`rŞl_chªû
(
chªû
)) {

700 
	`Úe_h™
(
ch
, 
viùim
, 
©ck_skl
, 
Œue
);

701 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
du®_£cÚd
, 
Œue
, 6);

703 ià(!
ch
->
fightšg
)

707 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
du®_£cÚd
, 
çl£
, 6);

710 
	`check_´ÙeùiÚ_au¿
(
ch
, 
viùim
);

712 ià(
©ck_skl
 =ğ
skl
::
ty³
::
shadow_fÜm
 ||‡‰ack_skÈ=ğskl::ty³::
cœşe
)

716 ià(
	`HAS_RAFF
(
ch
, 
RAFF_CLUMSY
è&& 
	`g‘_pos™iÚ
(chè> 
POS_RESTING
) {

717 ià(
	`rŞl_chªû
(1)) {

718 
	`aù
("IÀ¨¥eùacuÏ¸di¥Ïy oàşumsšess, $ÀçÎ down!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

719 
	`¡c
("You†o£ you¸foÙšg‡voidšghÃxˆ¡rike,‡nd f®Èdown! DOH!!\n", 
ch
);

720 
	`DAZE_STATE
(
ch
, 3 * 
PULSE_VIOLENCE
);

721 
	`WAIT_STATE
(
ch
, 3 * 
PULSE_VIOLENCE
);

722 
ch
->
pos™iÚ
 = 
POS_RESTING
;

727 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
)è!ğ
nuÎ±r


728 && !
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
lÚ
)

729 && !
	`IS_OBJ_STAT
(
obj
, 
ITEM_NOREMOVE
)

730 && 
	`HAS_RAFF
(
ch
, 
RAFF_WEAKGRIP
)) {

731 ià(
	`rŞl_chªû
(1)) {

732 
	`aù
("$ÀgÛ tØ¡¬t tØ©ck, buˆ$ w—pÚ fl› äom $ gr!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

733 
	`¡c
("{PCur£s! You'vdrİ³d you¸w—pÚ‡gaš!{x\n", 
ch
);

734 
	`obj_äom_ch¬
(
obj
);

736 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_NODROP
)

737 || 
	`IS_OBJ_STAT
(
obj
, 
ITEM_INVENTORY
)

738 || 
ch
->
š_room
 =ğ
nuÎ±r


739 || 
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


740 || 
	`ch¬_š_d¬’a_room
(
ch
))

741 
	`obj_to_ch¬
(
obj
, 
ch
);

743 
	`obj_to_room
(
obj
, 
ch
->
š_room
);

746 
	}
}

749 
	$mob_h™
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
)

751 
Ch¬aù”
 *
vch
, *
vch_Ãxt
;

752 
chªû
, 
numb”
;

758 ià(
©ck_skl
 !ğ
skl
::
ty³
::
back¡ab


759 && 
ch
->
fightšg
 =ğ
nuÎ±r


760 && 
viùim
->
h™
 =ğ
	`GET_MAX_HIT
(victim)

761 && (
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
è!ğ
nuÎ±r
)

762 && 
ch
->
off_æags
.
	`has
(
OFF_BACKSTAB
)

763 && 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
back¡ab
)) {

764 
	`do_back¡ab
(
ch
, 
viùim
->
Çme
);

768 
	`Úe_h™
(
ch
, 
viùim
, 
©ck_skl
, 
çl£
);

770 ià(!
ch
->
fightšg
)

773 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_SECONDARY
è&& (
	`numb”_³rûÁ
(è< (ch->
Ëv–
 * 2))) {

774 
	`Úe_h™
(
ch
, 
viùim
, 
©ck_skl
, 
Œue
);

776 ià(!
ch
->
fightšg
)

781 ià(
ch
->
off_æags
.
	`has
(
OFF_AREA_ATTACK
)) {

782 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = 
vch_Ãxt
) {

783 
vch_Ãxt
 = 
vch
->
Ãxt_š_room
;

785 ià((
vch
 !ğ
viùim
 && vch->
fightšg
 =ğ
ch
 && 
	`rŞl_chªû
(33)))

786 
	`Úe_h™
(
ch
, 
vch
, 
©ck_skl
, 
çl£
);

790 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ha¡e
)

791 || (
ch
->
off_æags
.
	`has
(
OFF_FAST
è&& !
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
¦ow
)))

792 
	`Úe_h™
(
ch
, 
viùim
, 
©ck_skl
, 
çl£
);

794 ià(!
ch
->
fightšg
 || 
©ck_skl
 =ğ
skl
::
ty³
::
back¡ab
)

797 
chªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
£cÚd_©ck
) / 2;

799 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
è&& !ch->
off_æags
.
	`has
(
OFF_FAST
))

800 
chªû
 /= 2;

802 ià(
	`rŞl_chªû
(
chªû
)) {

803 
	`Úe_h™
(
ch
, 
viùim
, 
©ck_skl
, 
çl£
);

805 ià(!
ch
->
fightšg
)

809 
chªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
thœd_©ck
) / 4;

811 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
è&& !ch->
off_æags
.
	`has
(
OFF_FAST
))

812 
chªû
 = 0;

814 ià(
	`rŞl_chªû
(
chªû
)) {

815 
	`Úe_h™
(
ch
, 
viùim
, 
©ck_skl
, 
çl£
);

817 ià(!
ch
->
fightšg
)

821 
chªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
fou¹h_©ck
) / 6;

823 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
è&& !ch->
off_æags
.
	`has
(
OFF_FAST
))

824 
chªû
 = 0;

826 ià(
	`rŞl_chªû
(
chªû
)) {

827 
	`Úe_h™
(
ch
, 
viùim
, 
©ck_skl
, 
çl£
);

829 ià(!
ch
->
fightšg
)

833 
	`check_´ÙeùiÚ_au¿
(
ch
, 
viùim
);

835 ià(
ch
->
wa™
 > 0 || 
	`g‘_pos™iÚ
(chè< 
POS_FIGHTING
)

839 
numb”
 = 
	`numb”_¿nge
(0, 6);

841 
numb”
) {

843 ià(
ch
->
off_æags
.
	`has
(
OFF_BASH
))

844 
	`do_bash
(
ch
, "");

849 ià(
ch
->
off_æags
.
	`has
(
OFF_BERSERK
è&& !
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
b”£rk
))

850 
	`do_b”£rk
(
ch
, "");

855 ià(
ch
->
off_æags
.
	`has
(
OFF_DISARM
)

856 || (
	`g‘_w—pÚ_skl
(
ch
, 
çl£
è!ğ
skl
::
ty³
::
hªd_to_hªd


857 && (
ch
->
aù_æags
.
	`has
(
ACT_WARRIOR
)

858 || 
ch
->
aù_æags
.
	`has
(
ACT_THIEF
))))

859 
	`do_di§rm
(
ch
, "");

864 ià(
ch
->
off_æags
.
	`has
(
OFF_KICK
))

865 
	`do_kick
(
ch
, "");

870 ià(
ch
->
off_æags
.
	`has
(
OFF_KICK_DIRT
))

871 
	`do_dœt
(
ch
, "");

876 ià(
ch
->
off_æags
.
	`has
(
OFF_TRIP
))

877 
	`do_Œ
(
ch
, "");

882 ià(
ch
->
off_æags
.
	`has
(
OFF_CRUSH
))

883 
	`do_üush
(
ch
, "");

887 
	}
}

890 
	$Úe_h™
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
, 
boŞ
 
£cÚd¬y
)

892 
Objeù
 *
w›ld
;

893 
viùim_ac
;

894 
thac0
;

895 
thac0_00
;

896 
thac0_32
;

897 
dam
;

898 
diûrŞl
;

899 
skl
;

900 
bÚus
 = 0;

901 
boŞ
 
»suÉ
;

902 
boŞ
 
ro¡e
 = 
çl£
;

903 
boŞ
 
shadow
 = 
çl£
;

904 
boŞ
 
no_w—pÚ
 = 
çl£
;

907 ià(
viùim
 =ğ
ch
 || ch =ğ
nuÎ±r
 || victim ==‚ullptr)

911 ià(
	`g‘_pos™iÚ
(
viùim
è=ğ
POS_DEAD
 || 
ch
->
š_room
 != victim->in_room)

914 ià(
©ck_skl
 =ğ
skl
::
ty³
::
ro¡e
)

915 
ro¡e
 = 
Œue
;

917 ià(
©ck_skl
 =ğ
skl
::
ty³
::
shadow_fÜm
) {

918 
shadow
 = 
Œue
;

919 
bÚus
 = ((
ch
->
Ëv–
 * 2è+ (
viùim
->level * 2));

920 
©ck_skl
 = 
skl
::
ty³
::
back¡ab
;

924 ià(!
£cÚd¬y
)

925 
w›ld
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
);

927 
w›ld
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_SECONDARY
);

936 
©ck_ty³
 = 0;

938 ià(
w›ld
 !ğ
nuÎ±r
 && w›ld->
™em_ty³
 =ğ
ITEM_WEAPON
)

939 
©ck_ty³
 = 
w›ld
->
v®ue
[3];

941 
©ck_ty³
 = 
ch
->
dam_ty³
;

942 
no_w—pÚ
 = 
Œue
;

946 ià(
©ck_ty³
 < 0 || (ï‰ack_ty³ > 
©ck_bË
.
	`size
()) {

947 
Loggšg
::
	`bugf
("damage(): unknowÀ©cky³ %d", 
©ck_ty³
);

948 
©ck_ty³
 = 0;

951 
dam_ty³
 = 
©ck_bË
[
©ck_ty³
].
damage
;

954 
skl
::
ty³
 
¢
 = 
	`g‘_w—pÚ_skl
(
ch
, 
£cÚd¬y
);

955 
skl
 = 20 + 
	`g‘_w—pÚ_Ë¬Ãd
(
ch
, 
¢
);

960 ià((
no_w—pÚ
è&& (
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
uÇrmed
) > 1)) {

961 
skl
 +ğ
	`g‘_skl_Ëv–
(
ch
, skl::
ty³
::
uÇrmed
);

962 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
uÇrmed
, 
Œue
, 1);

966 ià(
ch
->
	`is_Åc
()) {

967 
thac0_00
 = 20;

968 
thac0_32
 = -4;

970 ià(
ch
->
aù_æags
.
	`has
(
ACT_WARRIOR
))

971 
thac0_32
 = -10;

972 ià(
ch
->
aù_æags
.
	`has
(
ACT_THIEF
))

973 
thac0_32
 = -4;

974 ià(
ch
->
aù_æags
.
	`has
(
ACT_CLERIC
))

975 
thac0_32
 = 2;

976 ià(
ch
->
aù_æags
.
	`has
(
ACT_MAGE
))

977 
thac0_32
 = 6;

980 
šdex
 = 
ch
->
gud
 =ğ
Gud
::
nÚe
 ? Gud::
w¬riÜ
 : ch->guild;

981 
thac0_00
 = 
gud_bË
[
šdex
].thac0_00;

982 
thac0_32
 = 
gud_bË
[
šdex
].thac0_32;

985 
thac0
 = 
	`š‹½Ş©e
(
ch
->
Ëv–
, 
thac0_00
, 
thac0_32
);

987 ià(
thac0
 < 0)

988 
thac0
 =hac0 / 2;

990 ià(
thac0
 < -5)

991 
thac0
 = -5 + (thac0 + 5) / 2;

993 
thac0
 -ğ(
	`GET_ATTR_HITROLL
(
ch
è* 
skl
) / 100;

994 
thac0
 +ğ(5 * (100 - 
skl
)) / 100;

996 ià(
©ck_skl
 =ğ
skl
::
ty³
::
back¡ab
)

997 
thac0
 -ğ10 * (100 - 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
back¡ab
));

999 ià(
©ck_skl
 =ğ
skl
::
ty³
::
cœşe
)

1000 
thac0
 -ğ10 * (100 - 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
cœşe
));

1002 ià(
©ck_skl
 =ğ
skl
::
ty³
::
¿ge
)

1003 
thac0
 -ğ10 * (100 - 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
¿ge
));

1005 
dam_ty³
) {

1006 (
DAM_PIERCE
): 
viùim_ac
 = 
	`GET_AC
(
viùim
, 
AC_PIERCE
) / 10; ;

1008 (
DAM_BASH
): 
viùim_ac
 = 
	`GET_AC
(
viùim
, 
AC_BASH
) / 10; ;

1010 (
DAM_SLASH
): 
viùim_ac
 = 
	`GET_AC
(
viùim
, 
AC_SLASH
) / 10; ;

1012 : 
viùim_ac
 = 
	`GET_AC
(
viùim
, 
AC_EXOTIC
) / 10; ;

1015 ià(
viùim_ac
 < -15)

1016 
viùim_ac
 = (victim_ac + 15) / 5 - 15;

1018 ià(!
	`ÿn_£e_ch¬
(
ch
, 
viùim
))

1019 
viùim_ac
 -= 4;

1021 ià(
	`g‘_pos™iÚ
(
viùim
è< 
POS_FIGHTING
)

1022 
viùim_ac
 += 4;

1024 ià(
	`g‘_pos™iÚ
(
viùim
è< 
POS_RESTING
)

1025 
viùim_ac
 += 6;

1028 (
diûrŞl
 = 
	`numb”_b™s
(5)) >= 20)

1032 ià(!
ro¡e
 && !
shadow
) {

1033 ià(
diûrŞl
 =ğ0 || (diûrŞÈ!ğ19 && diûrŞÈ< 
thac0
 - 
viùim_ac
)) {

1035 
	`damage
(
ch
, 
viùim
, 0, 
©ck_skl
, 
©ck_ty³
, 
dam_ty³
, 
Œue
, 
çl£
);

1041 ià(
ch
->
	`is_Åc
(è&& 
w›ld
 =ğ
nuÎ±r
)

1042 
dam
 = 
	`diû
(
ch
->
damage
[
DICE_NUMBER
], ch->damage[
DICE_TYPE
]);

1044 ià(
¢
 !ğ
skl
::
ty³
::
unknown
)

1045 
	`check_im´ove
(
ch
, 
¢
, 
Œue
, 5);

1047 ià(
w›ld
 !ğ
nuÎ±r
) {

1048 
dam
 = (1L * 
	`diû
(
w›ld
->
v®ue
[1], w›ld->v®ue[2]è* 
skl
) / 100L;

1050 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_SHIELD
è=ğ
nuÎ±r
)

1051 
dam
 = dam * 11 / 10;

1054 ià(
afãù
::
	`exi¡s_Ú_obj
(
w›ld
,‡fãù::
ty³
::
w—pÚ_sh¬p
)) {

1055 
³rûÁ
;

1057 ià((
³rûÁ
 = 
	`numb”_³rûÁ
()è<ğ(
skl
 / 8))

1058 
dam
 = 2 * dam + (dam * 2 * 
³rûÁ
 / 100);

1062 
dam
 = 
	`numb”_¿nge
(1 + 4 * 
skl
 / 100, 2 * 
ch
->
Ëv–
 / 3 * skill / 100);

1066 ià(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
’hªûd_damage
)

1067 && (
diûrŞl
 = 
	`numb”_³rûÁ
()è<ğ
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
’hªûd_damage
)) {

1068 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
’hªûd_damage
, 
Œue
, 6);

1069 
dam
 +ğ2 * (dam * 
diûrŞl
 / 300);

1072 ià(!
	`IS_AWAKE
(
viùim
))

1073 
dam
 *= 2;

1074 ià(
	`g‘_pos™iÚ
(
viùim
è< 
POS_FIGHTING
)

1075 
dam
 = dam * 3 / 2;

1077 ià(
©ck_skl
 =ğ
skl
::
ty³
::
back¡ab
 && 
w›ld
 !ğ
nuÎ±r
) {

1078 ià(
w›ld
->
v®ue
[0] != 2)

1079 
dam
 *ğ2 + (
ch
->
Ëv–
 / 10);

1081 
dam
 *ğ2 + (
ch
->
Ëv–
 / 8);

1083 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
back¡ab
)) {

1088 
dam
 += ((10 * dam ) / 100);

1092 
dam
 += ((20 * dam ) / 100);

1099 ià(
	`GET_ATTR
 (
ch
, 
SET_THIEF_CUTPURSE
) >= 5 )

1100 
dam
 += (dam * 20 / 100);

1103 ià(
©ck_skl
 =ğ
skl
::
ty³
::
cœşe
 && 
w›ld
 !ğ
nuÎ±r
) {

1104 ià(
w›ld
->
v®ue
[0] != 2)

1105 
dam
 *ğ2 + ((
ch
->
Ëv–
 - 30) / 30);

1107 
dam
 *ğ2 + ((
ch
->
Ëv–
 - 30) / 24);

1110 ià(
	`GET_ATTR
 (
ch
, 
SET_THIEF_CUTPURSE
) >= 5 )

1111 
dam
 += (dam * 20 / 100);

1114 ià(
©ck_skl
 =ğ
skl
::
ty³
::
¿ge
 && 
w›ld
 !ğ
nuÎ±r
) {

1115 ià(
w›ld
->
v®ue
[0] != 1

1116 && 
w›ld
->
v®ue
[0] != 5)

1117 
dam
 *ğ2 + ((
ch
->
Ëv–
 - 30) / 30);

1119 
dam
 *ğ2 + ((
ch
->
Ëv–
 - 30) / 24);

1122 
dam
 +ğ
	`GET_ATTR_DAMROLL
(
ch
è* 
¡d
::
	`mš
(100, 
skl
) / 100;

1124 ià(
dam
 <= 0)

1125 
dam
 = 1;

1128 ià(
	`GET_ATTR
 (
ch
, 
SET_THIEF_CUTPURSE
) >= 5 )

1129 
bÚus
 += (bonus * 20 / 100);

1131 
dam
 +ğ
bÚus
;

1132 
»suÉ
 = 
	`damage
(
ch
, 
viùim
, 
dam
, 
©ck_skl
, 
©ck_ty³
, 
dam_ty³
, 
Œue
, 
çl£
);

1135 ià(
»suÉ
 && 
w›ld
 !ğ
nuÎ±r
) {

1136 cÚ¡ 
afãù
::
Afãù
 *
w—pÚaff
;

1137 
dam
, 
Ëv–
, 
evŞutiÚ
;

1139 ià(
ch
->
fightšg
 =ğ
viùim


1140 && (
w—pÚaff
 = 
afãù
::
	`fšd_Ú_obj
(
w›ld
,‡fãù::
ty³
::
poisÚ
)è!ğ
nuÎ±r
) {

1141 
Ëv–
 = 
w—pÚaff
->level;

1142 
evŞutiÚ
 = 
w—pÚaff
->evolution;

1144 ià(!
	`§ves_¥–l
(
Ëv–
 / 2, 
viùim
, 
DAM_POISON
)) {

1145 
	`¡c
("You f“ÈpoisÚ coursšghrough you¸vešs.\n", 
viùim
);

1146 
	`aù
("$Ài poisÚed byhv’om oÀ$p.", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1148 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

1149 
afãù
::
ty³
::
poisÚ
,

1150 
Ëv–
,

1151 
Ëv–
 / 2,

1152 
evŞutiÚ
,

1153 
çl£


1158 ià(
w—pÚaff
 !ğ
nuÎ±r
) {

1159 
afãù
::
â_d©a_cÚš”_ty³
 
cÚš”
 = {‡fãù::
ty³
::
poisÚ
 };

1160 
afãù
::
	`™”©e_ov”_obj
(

1161 
w›ld
,

1162 
afãù
::
â_çde_¥–l
,

1163 &
cÚš”


1166 ià(
w—pÚaff
->
du¿tiÚ
 == 0)

1167 
	`aù
("ThpoisÚ oÀ$°ha wÜÀoff.", 
ch
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1171 ià(
ch
->
fightšg
 =ğ
viùim


1172 && (
w—pÚaff
 = 
afãù
::
	`fšd_Ú_obj
(
w›ld
,‡fãù::
ty³
::
w—pÚ_vampœic
)è!ğ
nuÎ±r
) {

1173 
evŞutiÚ
 = 
w—pÚaff
->evolution;

1175 
dam
 = 
	`numb”_¿nge
(1, 
w›ld
->
Ëv–
 / 5 + 1);

1177 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a


1178 && 
ch
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
şª¬’a


1179 && (
ch
->
š_room
->
	`¬—
(è!ğ
Game
::
	`wÜld
().
que¡
.¬—(è|| !Game::wÜld().que¡.
pk
))

1180 
	`gaš_exp
(
viùim
, 0 - 
	`numb”_¿nge
(
ch
->
Ëv–
 / 20, 3 * ch->level / 20));

1182 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a


1183 && 
ch
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
şª¬’a


1184 && (
ch
->
š_room
->
	`¬—
(è!ğ
Game
::
	`wÜld
().
que¡
.¬—(è|| !Game::wÜld().que¡.
pk
)

1185 && 
ch
->
gud
 !ğ
Gud
::
·Ïdš
)

1186 
ch
->
®ignm’t
 = 
¡d
::
	`max
(-1000, ch->alignment - 1);

1188 
	`aù
("$°d¿w liã from $n.", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1189 
	`aù
("You f“È$°d¿wšg you¸liã‡way.", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1190 
	`damage
(
ch
, 
viùim
, 
dam
, 
skl
::
ty³
::
unknown
, -1, 
DAM_NEGATIVE
, 
çl£
, 
Œue
);

1198 
gaš
 = (
dam
 / 2);

1199 
gaš
 +ğgaš * 
	`GET_ATTR
(
ch
, 
APPLY_VAMP_BONUS_PCT
) / 100;

1200 
ch
->
h™
 +ğ
gaš
;

1203 ià(
ch
->
fightšg
 =ğ
viùim


1204 && (
w—pÚaff
 = 
afãù
::
	`fšd_Ú_obj
(
w›ld
,‡fãù::
ty³
::
w—pÚ_vÜ·l
)è!ğ
nuÎ±r
) {

1205 
dam
 = 
	`numb”_¿nge
(1, 
w›ld
->
Ëv–
 / 4 + 1);

1206 
	`aù
("$Ài im·Ëd by $p.", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1207 
	`aù
("$°im·Ë you¸body.", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1208 
	`damage
(
ch
, 
viùim
, 
dam
, 
skl
::
ty³
::
unknown
, -1, 
DAM_PIERCE
, 
çl£
, false);

1211 ià(
ch
->
fightšg
 =ğ
viùim


1212 && (
w—pÚaff
 = 
afãù
::
	`fšd_Ú_obj
(
w›ld
,‡fãù::
ty³
::
w—pÚ_acidic
)è!ğ
nuÎ±r
) {

1213 
evŞutiÚ
 = 
w—pÚaff
->evolution;

1215 
dam
 = 
	`numb”_¿nge
(1, 
w›ld
->
Ëv–
 / 4 + 2);

1216 
	`aù
("$Ài buºed byhacid $p.", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1217 
	`aù
("Thacid oÀ$°¡¬t tØbuº you¸æesh.", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1219 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a


1220 && 
ch
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
şª¬’a


1221 && (
ch
->
š_room
->
	`¬—
(è!ğ
Game
::
	`wÜld
().
que¡
.¬—(è|| !Game::wÜld().que¡.
pk
))

1222 
	`acid_efãù
((*è
viùim
, 
w›ld
->
Ëv–
 / 2, 
dam
, 
TARGET_CHAR
, 
evŞutiÚ
);

1224 
	`damage
(
ch
, 
viùim
, 
dam
, 
skl
::
ty³
::
unknown
, -1, 
DAM_ACID
, 
çl£
, false);

1227 ià(
ch
->
fightšg
 =ğ
viùim


1228 && (
w—pÚaff
 = 
afãù
::
	`fšd_Ú_obj
(
w›ld
,‡fãù::
ty³
::
w—pÚ_æamšg
)è!ğ
nuÎ±r
) {

1229 
evŞutiÚ
 = 
w—pÚaff
->evolution;

1231 
dam
 = 
	`numb”_¿nge
(1, 
w›ld
->
Ëv–
 / 4 + 1);

1232 
	`aù
("$Ài buºed by $p.", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1233 
	`aù
("$°£¬ you¸æesh.", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1235 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a


1236 && 
ch
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
şª¬’a


1237 && (
ch
->
š_room
->
	`¬—
(è!ğ
Game
::
	`wÜld
().
que¡
.¬—(è|| !Game::wÜld().que¡.
pk
))

1238 
	`fœe_efãù
((*è
viùim
, 
w›ld
->
Ëv–
 / 2, 
dam
, 
TARGET_CHAR
, 
evŞutiÚ
);

1240 
	`damage
(
ch
, 
viùim
, 
dam
, 
skl
::
ty³
::
unknown
, -1, 
DAM_FIRE
, 
çl£
, false);

1243 ià(
ch
->
fightšg
 =ğ
viùim


1244 && (
w—pÚaff
 = 
afãù
::
	`fšd_Ú_obj
(
w›ld
,‡fãù::
ty³
::
w—pÚ_äo¡
)è!ğ
nuÎ±r
) {

1245 
evŞutiÚ
 = 
w—pÚaff
->evolution;

1247 
dam
 = 
	`numb”_¿nge
(1, 
w›ld
->
Ëv–
 / 6 + 2);

1248 
	`aù
("$°ä“ze $n.", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1249 
	`aù
("ThcŞdouch oà$°su¼ound you w™h iû.", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1251 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a


1252 && 
ch
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
şª¬’a


1253 && (
ch
->
š_room
->
	`¬—
(è!ğ
Game
::
	`wÜld
().
que¡
.¬—(è|| !Game::wÜld().que¡.
pk
))

1254 
	`cŞd_efãù
(
viùim
, 
w›ld
->
Ëv–
 / 2, 
dam
, 
TARGET_CHAR
, 
evŞutiÚ
);

1256 
	`damage
(
ch
, 
viùim
, 
dam
, 
skl
::
ty³
::
unknown
, -1, 
DAM_COLD
, 
çl£
, false);

1259 ià(
ch
->
fightšg
 =ğ
viùim


1260 && (
w—pÚaff
 = 
afãù
::
	`fšd_Ú_obj
(
w›ld
,‡fãù::
ty³
::
w—pÚ_shockšg
)è!ğ
nuÎ±r
) {

1261 
evŞutiÚ
 = 
w—pÚaff
->evolution;

1263 
dam
 = 
	`numb”_¿nge
(1, 
w›ld
->
Ëv–
 / 5 + 2);

1264 
	`aù
("$Ài ¡ruck by†ighŠšg from $p.", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1265 
	`aù
("You‡» shocked by $p.", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1267 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a


1268 && 
ch
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
şª¬’a


1269 && (
ch
->
š_room
->
	`¬—
(è!ğ
Game
::
	`wÜld
().
que¡
.¬—(è|| !Game::wÜld().que¡.
pk
))

1270 
	`shock_efãù
(
viùim
, 
w›ld
->
Ëv–
 / 2, 
dam
, 
TARGET_CHAR
, 
evŞutiÚ
);

1272 
	`damage
(
ch
, 
viùim
, 
dam
, 
skl
::
ty³
::
unknown
, -1, 
DAM_ELECTRICITY
, 
çl£
, false);

1275 ià(
ch
->
fightšg
 =ğ
viùim


1276 && 
	`GET_ATTR
(
ch
, 
SET_THIEF_CUTPURSE
) >= 5){

1277 ià(
©ck_skl
 =ğ
skl
::
ty³
::
cœşe
) {

1278 ià(
	`numb”_³rûÁ
() > 90) {

1279 
	`numb”_¿nge
 (1,5)){

1281 
	`¡c
("You sŒik© you¸İpÚ’t' eyes!\n", 
ch
);

1282 
	`¡c
("You¸İpÚ’ˆ¡rike © you¸eyes!!\n", 
viùim
);

1283 
	`¥–l_blšdÃss
(
skl
::
ty³
::
blšdÃss
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1286 
	`¡c
("You sŒik© you¸İpÚ’t chak¿s!\n", 
ch
);

1287 
	`¡c
("You¸İpÚ’ˆ¡rike © you¸chak¿s!!\n", 
viùim
);

1288 
	`¥–l_cur£
(
skl
::
ty³
::
cur£
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1291 
	`¡c
("You¸w—pÚ glow w™h‡ g»’‡u¿!\n", 
ch
);

1292 
	`¡c
("You¸İpÚ’t w—pÚ glow g»’!\n", 
viùim
);

1293 
	`¥–l_¶ague
(
skl
::
ty³
::
¶ague
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1296 
	`¡c
("You sŒik© you¸İpÚ’t' ªkËs!\n", 
ch
);

1297 
	`¡c
("You¸İpÚ’ˆ¡rike © you¸ªkËs!!\n", 
viùim
);

1298 
	`¥–l_¦ow
(
skl
::
ty³
::
¦ow
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1301 
	`¡c
("You sŒik© you¸İpÚ’t' Ãrvou sy¡em!\n", 
ch
);

1302 
	`¡c
("You¸İpÚ’ˆ¡rike © you¸Ãrvou sy¡em!!\n", 
viùim
);

1303 
	`¥–l_w—k’
(
skl
::
ty³
::
w—k’
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1308 ià(
©ck_skl
 =ğ
skl
::
ty³
::
back¡ab
){

1309 ià(
	`numb”_³rûÁ
() > 75) {

1310 
	`numb”_¿nge
 (1,5)){

1312 
	`¡c
("You sŒik© you¸İpÚ’t' eyes!\n", 
ch
);

1313 
	`¡c
("You¸İpÚ’ˆ¡rike © you¸eyes!!\n", 
viùim
);

1314 
	`¥–l_blšdÃss
(
skl
::
ty³
::
blšdÃss
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1317 
	`¡c
("You sŒik© you¸İpÚ’t chak¿s!\n", 
ch
);

1318 
	`¡c
("You¸İpÚ’ˆ¡rike © you¸chak¿s!!\n", 
viùim
);

1319 
	`¥–l_cur£
(
skl
::
ty³
::
cur£
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1322 
	`¡c
("You¸w—pÚ glow w™h‡ g»’‡u¿!\n", 
ch
);

1323 
	`¡c
("You¸İpÚ’t w—pÚ glow g»’!\n", 
viùim
);

1324 
	`¥–l_¶ague
(
skl
::
ty³
::
¶ague
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1327 
	`¡c
("You sŒik© you¸İpÚ’t' ªkËs!\n", 
ch
);

1328 
	`¡c
("You¸İpÚ’ˆ¡rike © you¸ªkËs!!\n", 
viùim
);

1329 
	`¥–l_¦ow
(
skl
::
ty³
::
¦ow
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1332 
	`¡c
("You sŒik© you¸İpÚ’t' Ãrvou sy¡em!\n", 
ch
);

1333 
	`¡c
("You¸İpÚ’ˆ¡rike © you¸Ãrvou sy¡em!!\n", 
viùim
);

1334 
	`¥–l_w—k’
(
skl
::
ty³
::
w—k’
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1339 ià(
shadow
){

1340 ià(
	`numb”_³rûÁ
() > 65) {

1341 
	`numb”_¿nge
 (1,5)){

1343 
	`¡c
("You sŒik© you¸İpÚ’t' eyes!\n", 
ch
);

1344 
	`¡c
("You¸İpÚ’ˆ¡rike © you¸eyes!!\n", 
viùim
);

1345 
	`¥–l_blšdÃss
(
skl
::
ty³
::
blšdÃss
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1348 
	`¡c
("You sŒik© you¸İpÚ’t chak¿s!\n", 
ch
);

1349 
	`¡c
("You¸İpÚ’ˆ¡rike © you¸chak¿s!!\n", 
viùim
);

1350 
	`¥–l_cur£
(
skl
::
ty³
::
cur£
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1353 
	`¡c
("You¸w—pÚ glow w™h‡ g»’‡u¿!\n", 
ch
);

1354 
	`¡c
("You¸İpÚ’t w—pÚ glow g»’!\n", 
viùim
);

1355 
	`¥–l_¶ague
(
skl
::
ty³
::
¶ague
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1358 
	`¡c
("You sŒik© you¸İpÚ’t' ªkËs!\n", 
ch
);

1359 
	`¡c
("You¸İpÚ’ˆ¡rike © you¸ªkËs!!\n", 
viùim
);

1360 
	`¥–l_¦ow
(
skl
::
ty³
::
¦ow
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1363 
	`¡c
("You sŒik© you¸İpÚ’t' Ãrvou sy¡em!\n", 
ch
);

1364 
	`¡c
("You¸İpÚ’ˆ¡rike © you¸Ãrvou sy¡em!!\n", 
viùim
);

1365 
	`¥–l_w—k’
(
skl
::
ty³
::
w—k’
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1378 ià(
»suÉ
 && (
	`GET_ATTR
(
ch
, 
APPLY_NECRO_PIERCE_UNIQUE
)!= 0)) {

1379 
unique_chªû
 = 
	`GET_ATTR
(
ch
, 
APPLY_NECRO_PIERCE_UNIQUE
);

1380 iàĞ
	`numb”_³rûÁ
(è< 
unique_chªû
 ){

1381 
	`numb”_¿nge
 (1,9)){

1383 
	`aù
("$°glow d¬kow¬d $À{Rbuˆth’ brigh‹n up{x.", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1384 
	`aù
("{RYou s“ $°{Rglow d¬k buˆth’ iˆsubsides.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1388 
	`aù
("$°{Rem™ d¬k„ay © $n{R' eyes.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1389 
	`aù
("{RYou s“ $°{Rem™ d¬k„ays.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1390 
	`¥–l_blšdÃss
(
skl
::
ty³
::
blšdÃss
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1393 
	`aù
("$°{Rgrow d¬k’dr th©ƒx‹ndow¬d $n.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1394 
	`aù
("{RYou s“ $°grow d¬k’dr th© comaá” you.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1395 
	`¥–l_w—k’
(
skl
::
ty³
::
w—k’
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1398 
	`aù
("$°{R¡¬t em™tšg‡ g»’ish ga tow¬d $n.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1399 
	`aù
("{RYou s“ $°{Rbecomcov”ed iÀ¨g»’ish gas.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1400 
	`¥–l_poisÚ
(
skl
::
ty³
::
poisÚ
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1403 
	`aù
("$°{R¡¬t chªtšg‡nc›Á mu‰”šg © $n.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1404 
	`aù
("{RYou begš h—ršg d¬k chªtšg from $p.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1405 
	`¥–l_cur£
(
skl
::
ty³
::
cur£
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1408 
	`aù
("$°{R¡¬t ¥™tšg ouˆbÏck d—th‡ˆ$n.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1409 
	`aù
("{RYou s“ $°{RbegšØ¥ew bÏck d—th.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1410 
	`¥–l_¶ague
(
skl
::
ty³
::
¶ague
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1413 
	`aù
("$°{Rd¬k glow fÜm ¨şock who' hªd ¬¦owšg dowÀwhpoštšg‡ˆ$n.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1414 
	`aù
("{RYou s“ $p' {Rglow fÜm‡ clock who' hªd ¬¦owšg down.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1415 
	`¥–l_¦ow
(
skl
::
ty³
::
¦ow
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1418 
	`aù
("$°{Rem™ ¨high…™chow¬d $n.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1419 
	`aù
("{RYou h—¸$°{Rhummšg‡ high…™ch.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1420 
	`¥–l_¡¬ve
(
skl
::
ty³
::
¡¬ve
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1423 
	`aù
("$°{RfÜm ¨d¬k glowšg clock, it hªd ¥“dšg u°whpoštšg‡ˆ$n.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_ROOM
);

1424 
	`aù
("{RYou s“ $°{RfÜm‡ d¬k glowšg clock, it hªd ¥“dšg up.{x", 
viùim
, 
w›ld
, 
nuÎ±r
, 
TO_CHAR
);

1425 
	`¥–l_age
(
skl
::
ty³
::
age
, 
w›ld
->
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1440 ià(
	`GET_ATTR
(
ch
, 
SET_WARRIOR_BESERKER
) >= 5){

1441 ià(
	`numb”_³rûÁ
() < 11){

1442 
f¡rikedam
 = 
dam
 -= dam / 2;

1443 
f¡rikedam
 +ğ(
ch
->
Ëv–
 / 2);

1444 
	`¡c
("{GYou†ash ouˆ© you¸viùim{x.\n", 
viùim
);

1445 
	`damage
(
ch
, 
viùim
, 
f¡rikedam
, 
skl
::
ty³
::
unknown
, 46, 
DAM_SLASH
, 
Œue
, 
çl£
);

1451 
	}
}

1454 
	$afãù_ÿÎback_w—k’_bÚew®l
(
afãù
::
Afãù
 *
node
, *
nuÎ
) {

1455 ià(
node
->
ty³
 =ğ
afãù
::ty³::
bÚe_w®l
) {

1456 
node
->
du¿tiÚ
 = 
¡d
::
	`max
(0,‚ode->duration - 1);

1458 ià(
node
->
Ëv–
 > 5)

1459 
node
->
Ëv–
--;

1462 
	}
}

1467 
boŞ
 
	$damage
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
dam
, 
skl
::
ty³
 
©ck_skl
, 
©ck_ty³
, 
dam_ty³
, 
boŞ
 
show
, boŞ 
¥–l
)

1475 
boŞ
 
immuÃ
, 
§nc_immuÃ
;

1480 ià(
	`g‘_pos™iÚ
(
viùim
è=ğ
POS_DEAD
)

1481  
çl£
;

1500 ià(
¥–l
) {

1502 
damrŞl
 = 
	`g‘_un¥–Ëd_damrŞl
(
ch
);

1504 ià(
©ck_skl
 =ğ
skl
::
ty³
::
magic_misse
) {

1505 
dam
 +ğ
damrŞl
;

1508 
©ck_skl
 =ğ
skl
::
ty³
::
chaš_lighŠšg


1509 || 
©ck_skl
 =ğ
skl
::
ty³
::
blizz¬d


1510 || 
©ck_skl
 =ğ
skl
::
ty³
::
acid_¿š


1511 || 
©ck_skl
 =ğ
skl
::
ty³
::
fœe¡Üm
) {

1512 
dam
 +ğ
damrŞl
/5;

1515 
dam
 +ğ
damrŞl
;

1518 ià(
focus
 && 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::focus))

1519 
dam
 +ğ
	`numb”_¿nge
((dam / 4), (dam * 5 / 4));

1527 
dam
 +ğ(dam * 
	`GET_ATTR
(
ch
, 
APPLY_SPELL_DAMAGE_PCT
) / 100);

1532 ià(
	`GET_ATTR
(
ch
, 
SET_MAGE_INVOKER
) >= 2)

1533 
dam
 += (dam * 10 / 100);

1537 ià(
dam
 > 35)

1538 
dam
 = (dam - 35) / 2 + 35;

1542 ià(
dam
 > 80)

1543 
dam
 = (dam - 80) / 2 + 80;

1548 ià(!
viùim
->
	`is_Åc
(è&& 
dam
 > 0 && !
¥–l
) {

1549 
¡d_ac
, 
viù_ac
;

1550 
çùÜ
, 
ldam
 = 
dam
;

1552 
dam_ty³
) {

1553 
AC_PIERCE
:

1554 
viù_ac
 = 
	`GET_AC
(
viùim
, 
AC_PIERCE
);

1555 
¡d_ac
 = -5 * 
viùim
->
Ëv–
;

1558 
AC_BASH
:

1559 
viù_ac
 = 
	`GET_AC
(
viùim
, 
AC_BASH
);

1560 
¡d_ac
 = -5 * 
viùim
->
Ëv–
;

1563 
AC_SLASH
:

1564 
viù_ac
 = 
	`GET_AC
(
viùim
, 
AC_SLASH
);

1565 
¡d_ac
 = -5 * 
viùim
->
Ëv–
;

1569 
viù_ac
 = 
	`GET_AC
(
viùim
, 
AC_EXOTIC
);

1570 
¡d_ac
 = (-9 * 
viùim
->
Ëv–
) / 2;

1574 ià(
viù_ac
 < 0) {

1575 
çùÜ
 = 200L * (
¡d_ac
 - 101è/ (¡d_aø+ 
viù_ac
 - 202);

1577 ià(
çùÜ
 == 0L) factor = 1L;

1579 
ldam
 = (ldam * 
çùÜ
 * factor) / 10000L;

1580 
dam
 = 
ldam
;

1586 ià(
viùim
 !ğ
ch
) {

1588 ià(
	`is_§ã
(
ch
, 
viùim
, 
Œue
))

1589  
çl£
;

1591 
	`check_kËr
(
ch
, 
viùim
);

1593 ià(
	`g‘_pos™iÚ
(
viùim
è> 
POS_STUNNED
) {

1594 ià(!
ch
->
	`is_Åc
(è&& !
viùim
->is_Åc(è&& ch->
fightšg
 =ğ
nuÎ±r
) {

1595 
buf
[
MAX_STRING_LENGTH
];

1596 
viùim
->
aù_æags
 -ğ
PLR_NOPK
;

1597 
FÜm©
::
	`¥rštf
(
buf
, "% i ouˆfÜ blood - EÀgu¬de, %s!", 
ch
->
Çme
, 
viùim
->name);

1598 
	`do_£nd_ªnounû
(
ch
, 
buf
);

1599 
FÜm©
::
	`¥rštf
(
buf
, "$N i ©‹m±šgØmurd” %s", 
viùim
->
Çme
);

1600 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_FLAGS
, 0, 0);

1602 ià(!
viùim
->
pcd©a
->
pktim”
)

1603 
viùim
->
pcd©a
->
pktim”
 = 
PKTIME
;

1605 
ch
->
pcd©a
->
pktim”
 = 
PKTIME
;

1608 ià(
viùim
->
wa™
 =ğ0 && 
	`g‘_pos™iÚ
(viùimè< 
POS_FIGHTING
) {

1609 
	`aù
("You cÏmb”Øyou¸ã‘.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

1610 
	`aù
("$Àşamb” tØ$ ã‘.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1612 
viùim
->
pos™iÚ
 = 
POS_STANDING
;

1614 ià(
viùim
->
¡¬t_pos
 =ğ
POS_FLYING
 && 
	`CAN_FLY
(victim))

1615 
	`do_æy
(
viùim
, "");

1618 ià(
viùim
->
fightšg
 =ğ
nuÎ±r
)

1619 
	`£t_fightšg
(
viùim
, 
ch
);

1621 ià(
ch
->
fightšg
 =ğ
nuÎ±r
)

1622 
	`£t_fightšg
(
ch
, 
viùim
);

1626 ià(
viùim
->
ma¡”
 =ğ
ch
)

1627 
	`¡İ_fŞlow”
(
viùim
);

1631 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
švis
)

1632 || 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
midnight
)) {

1633 
afãù
::
	`»move_ty³_äom_ch¬
(
ch
,‡fãù::
ty³
::
švis
);

1634 
afãù
::
	`»move_ty³_äom_ch¬
(
ch
,‡fãù::
ty³
::
midnight
);

1635 
	`aù
("$Àçde štØexi¡’û.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1639 ià(!
viùim
->
	`is_Åc
()) {

1640 ià(
dam
 > 1 && 
viùim
->
pcd©a
->
cÚd™iÚ
[
COND_DRUNK
] > 10)

1641 
dam
 = 9 * dam / 10;

1643 ià(
dam
 > 1 && 
viùim
->
gud
 =ğ
Gud
::
·Ïdš
)

1645 ià((
	`IS_GOOD
(
viùim
è&& 
	`IS_EVIL
(
ch
))

1646 || (
	`IS_EVIL
(
viùim
è&& 
	`IS_GOOD
(
ch
)))

1647 
dam
 -= dam / 4;

1653 ià(
dam
 > 1 && 
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
b¬r›r
))

1654 
dam
 -= dam / 4;

1659 ià(
dam
 > 1 && 
	`GET_ATTR
(
viùim
, 
APPLY_TANK_UNIQUE
) != 0)

1660 
dam
 -= dam / 4;

1665 ià(
dam
 > 1 && 
	`GET_ATTR
(
viùim
, 
SET_PALADIN_GRACE
) >= 2)

1666 
dam
 -= dam * 10 / 100;

1670 
§nc_immuÃ
 = 
çl£
;

1672 ià(
dam
 > 1 && 
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
§nùu¬y
)) {

1673 
	`g‘_afãù_evŞutiÚ
(
viùim
, 
afãù
::
ty³
::
§nùu¬y
)) {

1675 
dam
 = (dam * 60) / 100;

1679 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
cur£
))

1680 
dam
 = (dam * 45) / 100;

1682 
dam
 = (dam * 55) / 100;

1687 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
cur£
))

1688 
dam
 = (dam * 40) / 100;

1690 
dam
 = (dam * 50) / 100;

1695 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
cur£
)) {

1696 
dam
 = (dam * 35) / 100;

1698 ià(
dam
 % 10 == 0) {

1699 
§nc_immuÃ
 = 
Œue
;

1700 
dam
 = 0;

1704 
dam
 = (dam * 45) / 100;

1712 ià((
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
´ÙeùiÚ_ev
è&& 
	`IS_EVIL
(
ch
))

1713 || (
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
´ÙeùiÚ_good
è&& 
	`IS_GOOD
(
ch
)))

1714 
dam
 -= dam / 4;

1719 ià(
	`HAS_RAFF
(
ch
, 
RAFF_MOREDAMAGE
))

1720 
dam
 += dam / 20;

1723 ià(
	`HAS_RAFF
(
ch
, 
RAFF_LESSDAMAGE
))

1724 
dam
 -= dam / 20;

1727 ià(
	`GET_ATTR
(
ch
, 
SET_WARRIOR_BESERKER
) >= 2)

1728 
dam
 += (dam * 10 / 100);

1733 ià(
	`GET_ATTR
(
ch
, 
SET_THIEF_CUTPURSE
) >= 2)

1734 
dam
 += (dam * 10 / 100);

1738 
immuÃ
 = 
çl£
;

1740 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
fÜû_sh›ld
è&& (
dam
 % 4 =ğ0è&& !
§nc_immuÃ
) {

1741 
immuÃ
 = 
Œue
;

1742 
dam
 = 0;

1748 ià(
©ck_skl
 =ğ
skl
::
ty³
::
unknown


1749 && 
©ck_ty³
 >= 0

1750 && 
©ck_ty³
 != 42

1751 && 
©ck_ty³
 != 43

1752 && 
©ck_ty³
 != 44

1753 && 
©ck_ty³
 != 45

1754 && 
©ck_ty³
 != 46

1755 && 
ch
 !ğ
viùim
) {

1756 ià(
	`IS_AWAKE
(
viùim
è&& !
glob®_quick
) {

1757 ià(
	`check_dodge
(
ch
, 
viùim
, 
©ck_skl
, 
©ck_ty³
))

1758  
çl£
;

1761 ià(
ch
->
	`is_g¬bage
(è|| 
viùim
->is_garbage())

1762  
çl£
;

1764 ià(
	`check_blur
(
ch
, 
viùim
, 
©ck_skl
, 
©ck_ty³
))

1765  
çl£
;

1767 ià(
ch
->
	`is_g¬bage
(è|| 
viùim
->is_garbage())

1768  
çl£
;

1770 ià(
	`check_shblock
(
ch
, 
viùim
, 
©ck_skl
, 
©ck_ty³
))

1771  
çl£
;

1773 ià(
ch
->
	`is_g¬bage
(è|| 
viùim
->is_garbage())

1774  
çl£
;

1776 ià(
	`check_·¼y
(
ch
, 
viùim
, 
©ck_skl
, 
©ck_ty³
))

1777  
çl£
;

1779 ià(
ch
->
	`is_g¬bage
(è|| 
viùim
->is_garbage())

1780  
çl£
;

1782 ià(
	`check_du®_·¼y
(
ch
, 
viùim
, 
©ck_skl
, 
©ck_ty³
))

1783  
çl£
;

1785 ià(
ch
->
	`is_g¬bage
(è|| 
viùim
->is_garbage())

1786  
çl£
;

1790 ià(!
¥–l
) {

1791 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
è!ğ
nuÎ±r
)

1792 
	`check_cÚd
(
ch
, 
	`g‘_eq_ch¬
(ch, 
WEAR_WIELD
));

1797 ià(
	`GET_ATTR
(
viùim
, 
APPLY_LIDDA_AURA_UNIQUE
) > 1){

1798 
damm
 = (
	`numb”_¿nge
((
viùim
->
Ëv–
 / 2) , (victim->level / 4 + 3)));

1799 ià(
	`numb”_³rûÁ
(è< 
	`GET_ATTR
(
viùim
, 
APPLY_LIDDA_AURA_UNIQUE
)){

1800 
	`numb”_¿nge
(0, 3)){

1802 
	`¡c
("{GYou¸{ga{Wur{g¨{Gæashe tØª {Ci{Wc{Cy {G­³¬ªû{x.\n", 
viùim
);

1804 
	`damage
(
viùim
, 
ch
, 
damm
, 
skl
::
ty³
::
unknown
, 42, 
DAM_COLD
, 
Œue
, 
çl£
);

1807 
	`¡c
("{GYou¸{ga{Wur{g¨{Gke Ú‡ {Næ{Bu{Nid {G­³¬ªû{x.\n", 
viùim
);

1809 
	`damage
(
viùim
, 
ch
, 
damm
, 
skl
::
ty³
::
unknown
, 45, 
DAM_WATER
, 
Œue
, 
çl£
);

1812 
	`¡c
("{GYou¸{ga{Wur{g¨{Gbur¡ štØ¨glÜiou {Pf{Rl{ba{Rm{Pe{x.\n", 
viùim
);

1814 
	`damage
(
viùim
, 
ch
, 
damm
, 
skl
::
ty³
::
unknown
, 43, 
DAM_FIRE
, 
Œue
, 
çl£
);

1817 
	`¡c
("{GYou¸{ga{Wur{g¨{Gbegš tØüackË w™h„aw {Ye{bn{T”{bg{Yy{x.\n", 
viùim
);

1819 
	`damage
(
viùim
, 
ch
, 
damm
, 
skl
::
ty³
::
unknown
, 44, 
DAM_ELECTRICITY
, 
Œue
, 
çl£
);

1825 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
æamesh›ld
)

1826 && !
	`§ves_¥–l
(
viùim
->
Ëv–
, 
ch
, 
DAM_FIRE
)

1827 && 
©ck_ty³
 != 42

1828 && 
©ck_ty³
 != 43

1829 && 
©ck_ty³
 != 44

1830 && 
©ck_ty³
 != 45

1831 && 
©ck_ty³
 != 46){

1832 
	`damage
(
viùim
, 
ch
, 5, 
skl
::
ty³
::
æamesh›ld
, -1, 
DAM_FIRE
, 
Œue
,rue);

1835 ià(
ch
->
	`is_g¬bage
())

1836  
çl£
;

1838 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
§nùu¬y
)

1839 && 
	`g‘_afãù_evŞutiÚ
(
viùim
, 
afãù
::
ty³
::
§nùu¬y
) >= 3

1840 && !
	`§ves_¥–l
(
viùim
->
Ëv–
, 
ch
, 
DAM_HOLY
)

1841 && 
©ck_ty³
 != 42

1842 && 
©ck_ty³
 != 43

1843 && 
©ck_ty³
 != 44

1844 && 
©ck_ty³
 != 45

1845 && 
©ck_ty³
 != 46)

1846 
	`damage
(
viùim
, 
ch
, 5, 
skl
::
ty³
::
§nùu¬y
, -1, 
DAM_HOLY
, 
Œue
,rue);

1848 ià(
ch
->
	`is_g¬bage
())

1849  
çl£
;

1851 cÚ¡ 
afãù
::
Afãù
 *
·f
;

1852 ià((
·f
 = 
afãù
::
	`fšd_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
bÚe_w®l
)è!ğ
nuÎ±r


1853 && !
	`§ves_¥–l
(
·f
->
Ëv–
, 
ch
, 
DAM_PIERCE
)

1854 && !
viùim
->
	`is_g¬bage
()) {

1855 
	`damage
(
viùim
, 
ch
,

1856 
¡d
::
	`max
(
	`numb”_¿nge
(
·f
->
Ëv–
 * 3 / 4,…af->level * 5 / 4), 5),

1857 
skl
::
ty³
::
bÚe_w®l
, -1, 
DAM_PIERCE
, 
Œue
,rue);

1859 
afãù
::
	`™”©e_ov”_ch¬
(
viùim
, 
afãù_ÿÎback_w—k’_bÚew®l
, 
nuÎ±r
);

1862 ià(
ch
->
	`is_g¬bage
())

1863  
çl£
;

1867 ià(!
ch
->
fightšg
)

1868  
çl£
;

1871 
def_mod
 = 
	`GET_DEFENSE_MOD
(
viùim
, 
dam_ty³
);

1873 ià(
def_mod
 >= 100)

1874 
immuÃ
 = 
Œue
;

1876 
dam
 -ğdam * 
def_mod
 / 100;

1886 
dam
 +ğ(dam * 
	`GET_ATTR
(
ch
, 
APPLY_WPN_DAMAGE_PCT
) / 100);

1890 ià(
show
)

1891 
	`dam_mes§ge
(
ch
, 
viùim
, 
dam
, 
©ck_skl
, 
©ck_ty³
, 
immuÃ
, 
§nc_immuÃ
);

1896 ià(!
¥–l
)

1897 
	`check_®l_cÚd
(
viùim
);

1900 
viùim
->
h™
 -ğ
dam
;

1909 ià(
	`GET_ATTR
(
viùim
, 
SET_CLERIC_DIVINE
) >= 5){

1910 ià(
	`numb”_³rûÁ
() < 15){

1911 
d£th—l
 = 
dam
 * 10 / 100;

1912 
	`±c
(
viùim
, "{BDivšpow” cÚv”ˆsomoàthdamagtØh—lšg!! {H[{Y%d{H]{x,\n", 
d£th—l
);

1913 
	`±c
(
ch
, "{BA divšau¿ fÏshe äom {Y%s{x \n", ch->
Çme
);

1914 
viùim
->
h™
 +ğ
d£th—l
;

1918 ià(
dam
 > 
	`GET_MAX_HIT
(
viùim
) / 4)

1919 
	`¡c
("{PTh©„—Îy did HURT!{x\n", 
viùim
);

1921 ià(
viùim
->
h™
 < 
	`GET_MAX_HIT
(victim) / 4)

1922 
	`¡c
("{PYou su»‡» BLEEDING!{x\n", 
viùim
);

1925 ià(!
	`check_pul£
(
viùim
)) {

1926 
	`kl_off
(
ch
, 
viùim
);

1927  
Œue
;

1931 ià(!
	`IS_AWAKE
(
viùim
))

1932 
	`¡İ_fightšg
(
viùim
, 
çl£
);

1934 ià(
viùim
 =ğ
ch
)

1935  
Œue
;

1938 ià(!
viùim
->
	`is_Åc
(è&& viùim->
desc
 =ğ
nuÎ±r
) {

1939 ià(
	`numb”_¿nge
(0, 
viùim
->
wa™
) == 0) {

1940 
	`do_»ÿÎ
(
viùim
, "");

1941  
Œue
;

1945  
Œue
;

1946 
	}
}

1948 
boŞ
 
	$check_pul£
(
Ch¬aù”
 *
viùim
)

1950 ià(
	`IS_IMMORTAL
(
viùim
è&& viùim->
h™
 < 1)

1951 
viùim
->
h™
 = 1;

1957 
d›_h¬d_skl
 = 
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
d›_h¬d
);

1959 ià(
d›_h¬d_skl
 >ğ1 && 
viùim
->
h™
 < 1) {

1960 ià(
	`rŞl_chªû
(
d›_h¬d_skl
)) {

1962 
viùim
->
h™
 +ğ(
	`GET_ATTR_CON
(viùimè/ 10è* (
d›_h¬d_skl
 / 10);

1964 ià(
viùim
->
h™
 > 
	`GET_MAX_HIT
(victim))

1965 
viùim
->
h™
 = 
	`GET_MAX_HIT
(victim);

1967 
	`¡c
("You makªƒffÜˆtØpuÎ your£làtog‘h”!\n", 
viùim
);

1968 
	`aù
("$ÀpuÎ them£làtog‘h”!\n", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1969 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
d›_h¬d
, 
Œue
, 2);

1972 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
d›_h¬d
, 
çl£
, 2);

1975 
	`upd©e_pos
(
viùim
);

1977 
	`g‘_pos™iÚ
(
viùim
)) {

1978 
POS_MORTAL
:

1979 
	`aù
("$Ài mÜÎy wounded,‡nd wÈd› soÚ, iànÙ‡ided.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1980 
	`¡c
("You‡» mÜÎy wounded,‡nd wÈd› soÚ, iànÙ‡ided.\n", 
viùim
);

1981  
Œue
;

1983 
POS_INCAP
:

1984 
	`aù
("$Ài šÿ·c™©ed‡nd wÈ¦owly d›, iànÙ‡ided.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1985 
	`¡c
("You‡» inÿ·c™©ed‡nd wÈ¦owly d›, iànÙ‡ided.\n", 
viùim
);

1986  
Œue
;

1988 
POS_STUNNED
:

1989 
	`aù
("$Ài ¡uÂed, buˆwÈ´obably„ecov”.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1990 
	`¡c
("You‡» stuÂed, buˆwÈ´obably„ecov”.\n", 
viùim
);

1991  
Œue
;

1993 
POS_DEAD
:

1994 
	`aù
("$Ài DEAD!!", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1995 
	`¡c
("You havb“ÀKILLED!!\n\n", 
viùim
);

1997 ià(
viùim
->
Ëv–
 < 50)

1998 
	`¡c
("You¸cÜp£ cª bloÿ‹d iÀthMÜgue, dowÀäomhp™.\n", 
viùim
);

2000  
çl£
;

2003  
Œue
;

2005 
	}
}

2007 
	$kl_off
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

2009 
buf
[
MAX_STRING_LENGTH
];

2012 ià(!
viùim
->
	`is_Åc
()) {

2013 
Loggšg
::
	`logf
("% kËd by % © %s", 
viùim
->
Çme
,

2014 (
ch
->
	`is_Åc
(è? ch->
shÜt_desü
 : ch->
Çme
), 
viùim
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
());

2015 
SŒšg
 
log_buf
 = 
FÜm©
::
	`fÜm©
("<PK> %s was slain by %s‡t [{W%s{x] [{W%d Exp{x]",

2016 
viùim
->
Çme
, (
ch
->
	`is_Åc
(è? ch->
shÜt_desü
 : ch->name),

2017 
ch
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(), ch->
	`is_Åc
(è? 0 : 
gxp
);

2018 
	`wizÃt
(
log_buf
, 
nuÎ±r
,‚uÎ±r, 
WIZ_DEATHS
, 0, 0);

2019 
FÜm©
::
	`¥rštf
(
buf
, "% ha b“À¦aš by %s.", 
viùim
->
Çme
, (
ch
->
	`is_Åc
(è? ch->
shÜt_desü
 : ch->name));

2020 
	`do_£nd_ªnounû
(
viùim
, 
buf
);

2023 
SŒšg
 
log_buf
 = 
FÜm©
::
	`fÜm©
("%s got ToAsTeD by %s‡t [{W%s{x] [{W%d Exp{x]",

2024 (
viùim
->
	`is_Åc
(è? viùim->
shÜt_desü
 : viùim->
Çme
),

2025 (
ch
->
	`is_Åc
(è? ch->
shÜt_desü
 : ch->
Çme
), ch->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(), 
gxp
);

2026 
	`wizÃt
(
log_buf
, 
nuÎ±r
,‚uÎ±r, 
WIZ_MOBDEATHS
, 0, 0);

2030 
Ëa¡_exp_aw¬ded
 = 
	`group_gaš
(
ch
, 
viùim
);

2034 
boŞ
 
was_NPC
 = 
viùim
->
	`is_Åc
();

2035 
boŞ
 
is_suicide
 = (
ch
 =ğ
viùim
);

2038 
	`¿w_kl
(
viùim
);

2041 ià(
is_suicide
)

2044 ià((
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
è&& !
was_NPC
 && (
b©e
.
¡¬t
))

2045 
	`deduù_co¡
(
ch
, -
b©e
.
ãe
);

2048 ià(!
ch
->
	`is_Åc
(è&& 
was_NPC
) {

2049 
Objeù
 *
cÜp£
, *
obj
, *
obj_Ãxt
;

2051 ià((
cÜp£
 = 
	`g‘_obj_li¡
(
ch
, "cÜp£", ch->
š_room
->
cÚ‹Ás
)è=ğ
nuÎ±r


2052 || !
	`ÿn_£e_obj
(
ch
, 
cÜp£
))

2055 ià(
	`rŞl_chªû
(30)

2056 && 
Ëa¡_exp_aw¬ded
 > 0

2057 && 
ch
->
aù_æags
.
	`has
(
PLR_AUTOLOOT
)){

2058 
obj
 = 
	`g’”©e_eq
(
ch
->
Ëv–
);

2059 ià(
obj
){

2060 
	`obj_to_obj
(
obj
, 
cÜp£
);

2061 
	`g‘_obj
(
ch
, 
obj
, 
cÜp£
);

2066 ià(
cÜp£
->
cÚšs
) {

2067 
obj
 = 
cÜp£
->
cÚšs
; obj; obj = 
obj_Ãxt
) {

2068 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

2070 ià(
obj
->
Çme
.
	`has_wÜds
("gcash")

2071 && !
ch
->
aù_æags
.
	`has
(
PLR_AUTOGOLD
))

2073 ià(!
ch
->
aù_æags
.
	`has
(
PLR_AUTOLOOT
))

2076 ià(
	`ÿn_£e_obj
(
ch
, 
obj
))

2077 
	`g‘_obj
(
ch
, 
obj
, 
cÜp£
);

2081 ià(
ch
->
aù_æags
.
	`has
(
PLR_AUTOSAC
)) {

2082 ià(
ch
->
aù_æags
.
	`has_ªy_of
(
PLR_AUTOLOOT
 | 
PLR_AUTOGOLD
è&& 
cÜp£
->
cÚšs
)

2085 
	`do_§üifiû
(
ch
, "corpse");

2089 ià(
was_NPC
)

2095 ià(
viùim
->
exp
 > 
	`exp_³r_Ëv–
(viùim, viùim->
pcd©a
->
pošts
è* viùim->
Ëv–


2096 && 
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a


2097 && 
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
şª¬’a


2098 && (
ch
->
š_room
->
	`¬—
(è!ğ
Game
::
	`wÜld
().
que¡
.¬—(è|| !Game::wÜld().que¡.
pk
))

2099 
	`gaš_exp
(
viùim
,

2100 (2 * (
	`exp_³r_Ëv–
(
viùim
, viùim->
pcd©a
->
pošts
)*viùim->
Ëv–
 - viùim->
exp
) / 3));

2102 ià(!
ch
->
	`is_Åc
()) {

2104 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


2105 || 
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
şª¬’a


2106 || (
ch
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.¬—(è&& Game::wÜld().que¡.
pk
)) {

2107 
ch
->
pcd©a
->
¬’akls
++;

2109 ià(!
	`IS_IMMORTAL
(
ch
))

2110 
viùim
->
pcd©a
->
¬’akËd
++;

2120 ià(
	`ch¬_İpÚ’ts
(
ch
, 
viùim
))

2121 
	`w¬_kl
(
ch
, 
viùim
);

2123 
ch
->
pcd©a
->
pckls
++;

2124 
viùim
->
pcd©a
->
pckËd
++;

2126 ià(
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
))

2127 
viùim
->
pcd©a
->
¶r_æags
 -ğ
PLR_PK
;

2129 ià(
viùim
->
pcd©a
->
pk¿nk
 >ğ
ch
->pcdata->pkrank) {

2130 ià(
ch
->
pcd©a
->
pk¿nk
 < 5)

2131 
ch
->
pcd©a
->
pk¿nk
++;

2133 ià(
viùim
->
pcd©a
->
pk¿nk
 > 0)

2134 
viùim
->
pcd©a
->
pk¿nk
--;

2138 
	}
}

2141 
boŞ
 
	$is_§ã_ch¬
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
boŞ
 
showmsg
)

2143 ià(
	`IS_IMMORTAL
(
ch
))

2144  
çl£
;

2146 ià(
viùim
->
fightšg
 =ğ
ch
 || victim == ch)

2147  
çl£
;

2150 ià(
viùim
->
	`is_Åc
()) {

2151 ià(
viùim
->
pIndexD©a
->
pShİ
 !ğ
nuÎ±r
) {

2152 ià(
showmsg
)

2153 
	`¡c
("Buˆth’ whØwould you buy suµl› äom?!\n", 
ch
);

2155  
Œue
;

2159 ià(
viùim
->
aù_æags
.
	`has
(
ACT_TRAIN
)

2160 || 
viùim
->
aù_æags
.
	`has
(
ACT_PRACTICE
)

2161 || 
viùim
->
aù_æags
.
	`has
(
ACT_IS_HEALER
)

2162 || 
viùim
->
aù_æags
.
	`has
(
ACT_IS_CHANGER
)) {

2163 ià(
showmsg
)

2164 
	`¡c
("Havyou‚ØmÜ® fib» wh©sÛv”?!\n", 
ch
);

2166  
Œue
;

2169 ià(!
ch
->
	`is_Åc
()) {

2171 ià(
viùim
->
aù_æags
.
	`has
(
ACT_PET
è&& 
afãù
::
	`exi¡s_Ú_ch¬
(viùim,‡fãù::
ty³
::
ch¬m_³rsÚ
)) {

2172 ià(
showmsg
)

2173 
	`aù
("Buˆ$N†ook sØcu‹‡nd cuddly.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2175  
Œue
;

2179 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& 
ch
 !ğviùim->
ma¡”
) {

2180 ià(
showmsg
)

2181 
	`¡c
("Th© i nÙ you¸ch¬med c»©u»!\n", 
ch
);

2183  
Œue
;

2188 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ch¬m_³rsÚ
)

2189 && 
ch
->
ma¡”
 !ğ
nuÎ±r
 && 
viùim
->master !=‚ullptr

2190 && !
ch
->
ma¡”
->
	`is_Åc
(è&& !
viùim
->master->is_npc()

2191 && 
ch
->
ma¡”
 !ğ
viùim
->master

2192 && 
	`is_§ã_ch¬
(
ch
->
ma¡”
, 
viùim
->ma¡”, 
çl£
)) {

2193 ià(
showmsg
)

2194 
	`¡c
("Theœ ma¡” would cÚsid”h©‡Àunä›ndly‡ù.\n", 
ch
);

2196  
Œue
;

2203 ià(
ch
->
	`is_Åc
()) {

2205 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 !ğ
nuÎ±r


2206 && 
ch
->
ma¡”
->
fightšg
 !ğ
viùim
) {

2207 ià(
showmsg
)

2208 
	`¡c
("PÏy” ¬you¸ä›nds!\n", 
ch
);

2210  
Œue
;

2215 ià(
viùim
->
aù_æags
.
	`has
(
PLR_KILLER
è|| viùim->aù_æags.has(
PLR_THIEF
))

2216  
çl£
;

2218 ià(
viùim
->
Ëv–
 > 
ch
->level + 8 || ch->level > victim->level + 8) {

2219 ià(
showmsg
)

2220 
	`¡c
("Pick oÀsomeÚyou¸owÀsize.\n", 
ch
);

2222  
Œue
;

2225 ià(
	`ch¬_İpÚ’ts
(
ch
, 
viùim
))

2226  
çl£
;

2228 ià(!
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
)) {

2229 ià(
showmsg
)

2230 
	`¡c
("They‡»‚Ù iÀthmoodØPK„ighˆnow.\n", 
ch
);

2232  
Œue
;

2235 ià(!
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
)) {

2236 ià(
showmsg
)

2237 
	`¡c
("You‡»‚Ù iÀthmoodØPK„ighˆnow.\n", 
ch
);

2239  
Œue
;

2244  
çl£
;

2245 
	}
}

2247 
boŞ
 
	$is_§ã
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
boŞ
 
showmsg
)

2249 ià(
viùim
->
š_room
 =ğ
nuÎ±r
 || 
ch
->in_room ==‚ullptr)

2250  
Œue
;

2256 ià(
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
)) {

2257 ià(
showmsg
)

2258 
	`¡c
("Oddlyƒnough, iÀthi room you f“È³aûful.\n", 
ch
);

2260  
Œue
;

2263 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


2264 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
şª¬’a


2265 || 
	`ch¬_š_d¬’a_room
(
viùim
))

2266  
çl£
;

2269 ià(
Game
::
	`wÜld
().
que¡
.
pk


2270 && 
viùim
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()

2271 && 
ch
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area())

2272  
çl£
;

2274  
	`is_§ã_ch¬
(
ch
, 
viùim
, 
showmsg
);

2275 
	}
}

2277 
boŞ
 
	$is_§ã_¥–l
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
boŞ
 
¬—
)

2279 ià(
viùim
->
š_room
 =ğ
nuÎ±r
 || 
ch
->in_room ==‚ullptr)

2280  
Œue
;

2285 ià(
	`IS_IMMORTAL
(
ch
è&& !
¬—
)

2286  
çl£
;

2288 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
))

2289  
Œue
;

2291 ià(
viùim
 =ğ
ch
 && 
¬—
)

2292  
Œue
;

2294 ià(
viùim
->
fightšg
 =ğ
ch
 || victim == ch)

2295  
çl£
;

2297 ià(!
	`IS_IMMORTAL
(
ch
è&& IS_IMMORTAL(
viùim
))

2298  
Œue
;

2300 ià(!
	`IS_IMMORTAL
(
ch
è&& 
viùim
->
švis_Ëv–
 > ch->
Ëv–
)

2301  
Œue
;

2303 ià((
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


2304 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
şª¬’a
)

2305 && (
b©e
.
¡¬t
))

2306  
çl£
;

2308 ià(
	`ch¬_š_d¬’a_room
(
viùim
))

2309  
çl£
;

2311 ià(
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
ACT_MORPH
è&& !
viùim
->is_npc())

2312  
Œue
;

2314 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ã¬
))

2315  
Œue
;

2318 ià(
viùim
->
	`is_Åc
()) {

2320 ià(
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
))

2321  
Œue
;

2323 ià(
viùim
->
pIndexD©a
->
pShİ
 !ğ
nuÎ±r
)

2324  
Œue
;

2327 ià(
viùim
->
aù_æags
.
	`has
(
ACT_TRAIN
)

2328 || 
viùim
->
aù_æags
.
	`has
(
ACT_PRACTICE
)

2329 || 
viùim
->
aù_æags
.
	`has
(
ACT_IS_HEALER
)

2330 || 
viùim
->
aù_æags
.
	`has
(
ACT_IS_CHANGER
))

2331  
Œue
;

2333 ià(!
ch
->
	`is_Åc
()) {

2335 ià(
viùim
->
aù_æags
.
	`has
(
ACT_PET
))

2336  
Œue
;

2339 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& (
¬—
 || 
ch
 !ğviùim->
ma¡”
))

2340  
Œue
;

2343 ià(
viùim
->
fightšg
 !ğ
nuÎ±r
 && !
	`is_§me_group
(
ch
, victim->fighting))

2344  
Œue
;

2347 ià(
¬—
 && !
	`is_§me_group
(
viùim
, 
ch
->
fightšg
))

2348  
Œue
;

2352 ià(
¬—
 && 
	`IS_IMMORTAL
(
viùim
))

2353  
Œue
;

2356 ià(
ch
->
	`is_Åc
()) {

2358 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 !ğ
nuÎ±r


2359 && 
ch
->
ma¡”
->
fightšg
 !ğ
viùim
)

2360  
Œue
;

2363 ià(
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
))

2364  
Œue
;

2367 ià(
ch
->
fightšg
 !ğ
nuÎ±r
 && !
	`is_§me_group
(ch->fightšg, 
viùim
))

2368  
Œue
;

2372 ià(
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
))

2373  
Œue
;

2376 ià(
Game
::
	`wÜld
().
que¡
.
pk


2377 && 
ch
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()

2378 && 
viùim
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area())

2379  
çl£
;

2381 ià(
viùim
->
aù_æags
.
	`has
(
PLR_KILLER
è|| viùim->aù_æags.has(
PLR_THIEF
))

2382  
çl£
;

2384 ià(
ch
->
Ëv–
 > 
viùim
->level + 8)

2385  
Œue
;

2387 ià(
	`ch¬_İpÚ’ts
(
ch
, 
viùim
))

2388  
çl£
;

2390 ià(!
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
)

2391 || !
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PK
))

2392  
Œue
;

2396  
çl£
;

2397 
	}
}

2400 
	$check_kËr
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

2404 
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& viùim->
ma¡”
 !ğ
nuÎ±r
)

2405 
viùim
 = viùim->
ma¡”
;

2408 ià(
viùim
->
	`is_Åc
()

2409 || 
viùim
->
aù_æags
.
	`has
(
PLR_KILLER
)

2410 || 
viùim
->
aù_æags
.
	`has
(
PLR_THIEF
)

2411 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


2412 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
şª¬’a


2413 || 
	`ch¬_š_d¬’a
(
viùim
))

2417 ià(
Game
::
	`wÜld
().
que¡
.
pk


2418 && 
viùim
->
š_room
 !ğ
nuÎ±r


2419 && 
viùim
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()

2420 && 
ch
->
š_room
 !ğ
nuÎ±r


2421 && 
ch
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area())

2425 ià(
	`ch¬_İpÚ’ts
(
ch
, 
viùim
))

2429 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
)) {

2430 ià(
ch
->
ma¡”
 =ğ
nuÎ±r
) {

2431 
buf
[
MAX_STRING_LENGTH
];

2432 
FÜm©
::
	`¥rštf
(
buf
, "Check_kËr: % ch¬med w™h‚Øma¡”", 
ch
->
	`is_Åc
(è? ch->
shÜt_desü
 : ch->
Çme
);

2433 
Loggšg
::
	`bug
(
buf
, 0);

2434 
afãù
::
	`»move_ty³_äom_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
);

2438 
	`¡İ_fŞlow”
(
ch
);

2446 ià(
ch
->
	`is_Åc
()

2447 || 
ch
 =ğ
viùim


2448 || 
	`IS_IMMORTAL
(
ch
)

2449 || 
ch
->
aù_æags
.
	`has
(
PLR_KILLER
)

2450 || 
ch
->
fightšg
 =ğ
viùim
)

2454 ià(
viùim
->
pcd©a
->
pktim”
 != 0)

2458 ià((
	`g‘_pos™iÚ
(
viùim
è>ğ
POS_RESTING
è|| (
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦“p
)))

2461 
	`¡c
("{P*** You‡»‚ow‡ KILLER!! ***{x\n", 
ch
);

2462 
ch
->
aù_æags
 +ğ
PLR_KILLER
;

2463 
ch
->
aù_æags
 +ğ
PLR_NOPK
;

2464 
ch
->
pcd©a
->
æag_kËr
 = 
MAX_KILLER
;

2465 
	`§ve_ch¬_obj
(
ch
);

2466 
	}
}

2469 
boŞ
 
	$check_·¼y
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
, 
©ck_ty³
)

2471 
Objeù
 *
obj
;

2472 
buf
[
MAX_STRING_LENGTH
];

2473 
chªû
;

2474 
SŒšg
 
©ck
;

2476 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
·¿lyze
)) {

2477 ià(
	`rŞl_chªû
(30))

2478  
çl£
;

2481 ià(!
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
·¼y
))

2482  
çl£
;

2484 
chªû
 = 
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
·¼y
) * 2 / 3;

2486 ià(
	`g‘_eq_ch¬
(
viùim
, 
WEAR_WIELD
è=ğ
nuÎ±r
) {

2487 ià(
viùim
->
	`is_Åc
())

2488 
chªû
 /= 2;

2490  
çl£
;

2494 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
)è!ğ
nuÎ±r
) {

2495 
skl
;

2497 
obj
->
v®ue
[0]) {

2498 
WEAPON_SWORD
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
swÜd
); ;

2500 
WEAPON_DAGGER
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
dagg”
); ;

2502 
WEAPON_SPEAR
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
¥—r
); ;

2504 
WEAPON_MACE
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
maû
); ;

2506 
WEAPON_AXE
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
axe
); ;

2508 
WEAPON_FLAIL
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
æa
); ;

2510 
WEAPON_WHIP
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
wh
); ;

2512 
WEAPON_POLEARM
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
pŞ—rm
); ;

2514 
WEAPON_BOW
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
¬ch”y
); ;

2516 : 
skl
 = 
¡d
::
	`mš
(100, 
viùim
->
Ëv–
 * 3); ;

2519 
chªû
 -ğ(100 - 
skl
) / 4;

2522 ià(!
	`ÿn_£e_ch¬
(
viùim
, 
ch
))

2523 
chªû
 /= 2;

2525 
chªû
 +ğ
viùim
->
Ëv–
 - 
ch
->level;

2527 #ifdeà
DEBUG_CHANCE


2528 
	`±c
(
ch
, "Õ¬ry %d%%)", 
chªû
);

2529 
	`±c
(
viùim
, "Õ¬ry %d%%)", 
chªû
);

2532 ià(
	`numb”_³rûÁ
(è>ğ
chªû
) {

2533 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
·¼y
, 
çl£
, 10);

2534  
çl£
;

2538 ià(
©ck_skl
 !ğ
skl
::
ty³
::
unknown
)

2539 
©ck
 = 
skl
::
	`lookup
(
©ck_skl
).
noun_damage
;

2541 ià(
©ck_ty³
 < 0 || (ï‰ack_ty³ >ğ
©ck_bË
.
	`size
()) {

2542 
Loggšg
::
	`bug
("Dam_mes§ge: bad‡‰ack_ty³ %d.", 
©ck_ty³
);

2543 
©ck_ty³
 = 0;

2546 
©ck
 = 
©ck_bË
[
©ck_ty³
].
noun
;

2549 ià(!
viùim
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

2550 
FÜm©
::
	`¥rštf
(
buf
, "{BYou…¬ry $n' {B%s.{x", 
©ck
);

2551 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2554 ià(!
ch
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

2555 
FÜm©
::
	`¥rštf
(
buf
, "{R$N{R…¬r› you¸%s.{x", 
©ck
);

2556 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2559 ià(
	`g‘_eq_ch¬
(
viùim
, 
WEAR_WIELD
è!ğ
nuÎ±r
)

2560 
	`check_cÚd
(
viùim
, 
	`g‘_eq_ch¬
(viùim, 
WEAR_WIELD
));

2562 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
·¼y
, 
Œue
, 6);

2565 ià(
	`CAN_USE_RSKILL
(
viùim
, 
skl
::
ty³
::
ro¡e
))

2566 
	`do_ro¡e
(
viùim
, 
ch
);

2569 ià(
	`GET_ATTR
(
viùim
, 
SET_PALADIN_GRACE
) >= 5){

2571 ià(!
viùim
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
è&& 
	`deãn£_h—l
(victim, 15, 20)) {

2572 
	`¡c
("{BMÚŒey' G¿û h—l you!!!!{x\n", 
viùim
);

2574 ià(!
ch
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

2575 
	`¡c
("{BYou¸İpÚ’ˆglow w™h‡ {Wwh™ligh{Bt!!!!{x\n", 
ch
);

2580  
Œue
;

2581 
	}
}

2584 
boŞ
 
	$check_du®_·¼y
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
, 
©ck_ty³
)

2586 
Objeù
 *
obj
;

2587 
buf
[
MAX_STRING_LENGTH
];

2588 
chªû
;

2589 
SŒšg
 
©ck
;

2591 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
·¿lyze
)) {

2592 ià(
	`rŞl_chªû
(30))

2593  
çl£
;

2596 ià(!
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
du®_w›ld
)

2597 || !
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
·¼y
)

2598 || !
	`g‘_eq_ch¬
(
viùim
, 
WEAR_SECONDARY
)

2599 || 
	`g‘_evŞutiÚ
(
viùim
, 
skl
::
ty³
::
du®_w›ld
) < 2

2600 || (
©ck_skl
 =ğ
skl
::
ty³
::
ro¡e
 && 
	`g‘_evŞutiÚ
(
viùim
, skl::ty³::
du®_w›ld
) < 3))

2601  
çl£
;

2603 
chªû
 = 
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
du®_w›ld
) / 3;

2606 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
)è!ğ
nuÎ±r
) {

2607 
skl
;

2609 
obj
->
v®ue
[0]) {

2610 
WEAPON_SWORD
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
swÜd
); ;

2612 
WEAPON_DAGGER
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
dagg”
); ;

2614 
WEAPON_SPEAR
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
¥—r
); ;

2616 
WEAPON_MACE
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
maû
); ;

2618 
WEAPON_AXE
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
axe
); ;

2620 
WEAPON_FLAIL
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
æa
); ;

2622 
WEAPON_WHIP
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
wh
); ;

2624 
WEAPON_POLEARM
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
pŞ—rm
); ;

2626 
WEAPON_BOW
: 
skl
 = 
	`g‘_skl_Ëv–
(
viùim
, skl::
ty³
::
¬ch”y
); ;

2628 : 
skl
 = 
¡d
::
	`mš
(100, 
viùim
->
Ëv–
 * 3); ;

2631 
chªû
 -ğ(100 - 
skl
) / 5;

2634 ià(!
	`ÿn_£e_ch¬
(
viùim
, 
ch
))

2635 
chªû
 /= 2;

2637 
chªû
 +ğ
viùim
->
Ëv–
 - 
ch
->level;

2639 #ifdeà
DEBUG_CHANCE


2640 
	`±c
(
ch
, "(dÍ¬ry %d%%)", 
chªû
);

2641 
	`±c
(
viùim
, "(dÍ¬ry %d%%)", 
chªû
);

2644 ià(!
	`rŞl_chªû
(
chªû
)) {

2645 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
du®_w›ld
, 
çl£
, 10);

2646  
çl£
;

2650 ià(
©ck_skl
 !ğ
skl
::
ty³
::
unknown
)

2651 
©ck
 = 
skl
::
	`lookup
(
©ck_skl
).
noun_damage
;

2653 ià(
©ck_ty³
 < 0 || (ï‰ack_ty³ >ğ
©ck_bË
.
	`size
()) {

2654 
Loggšg
::
	`bug
("Dam_mes§ge: bad‡‰ack_ty³ %d.", 
©ck_ty³
);

2655 
©ck_ty³
 = 0;

2658 
©ck
 = 
©ck_bË
[
©ck_ty³
].
noun
;

2661 ià(!
viùim
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

2662 
FÜm©
::
	`¥rštf
(
buf
, "{BYou…¬ry $n' {B% w™h you¸£cÚd w—pÚ!{x", 
©ck
);

2663 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2666 ià(!
ch
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

2667 
FÜm©
::
	`¥rštf
(
buf
, "{R$N{R…¬r› you¸% w™h $S secÚd w—pÚ!{x", 
©ck
);

2668 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2671 
	`check_cÚd
(
viùim
, 
	`g‘_eq_ch¬
(viùim, 
WEAR_SECONDARY
));

2672 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
du®_w›ld
, 
Œue
, 10);

2675 ià(
	`g‘_evŞutiÚ
(
viùim
, 
skl
::
ty³
::
du®_w›ld
) < 3

2676 || (
©ck_skl
 =ğ
skl
::
ty³
::
ro¡e
 && 
	`g‘_evŞutiÚ
(
viùim
, skl::ty³::
du®_w›ld
) < 4))

2677  
Œue
;

2679 
chªû
 = ((
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
du®_w›ld
è+ g‘_skl_Ëv–(viùim, skl::ty³::
hªd_to_hªd
)) / 3);

2681 ià(!
	`ÿn_£e_ch¬
(
viùim
, 
ch
))

2682 
chªû
 /= 2;

2684 ià(!
	`rŞl_chªû
(
chªû
 + 
viùim
->
Ëv–
 - 
ch
->level))

2685  
Œue
;

2688 
©ck_ty³
 = 
©ck_bË
.
	`size
() - 1;‡ttack_type >= 0;‡ttack_type--)

2689 ià(
©ck_bË
[
©ck_ty³
].
Çme
 == "hstrike")

2692 ià(
©ck_ty³
 < 0) {

2693 
Loggšg
::
	`bug
("check_dual_parry: unableo find hilt strike damageype", 0);

2694  
Œue
;

2698 ià(
	`check_dodge
(
viùim
, 
ch
, 
skl
::
ty³
::
unknown
, 
©ck_ty³
))

2699  
Œue
;

2701 ià(
	`check_blur
(
viùim
, 
ch
, 
skl
::
ty³
::
unknown
, 
©ck_ty³
))

2702  
Œue
;

2704 ià(
	`check_shblock
(
viùim
, 
ch
, 
skl
::
ty³
::
unknown
, 
©ck_ty³
))

2705  
Œue
;

2707 
	`damage
(
viùim
, 
ch
, (
	`numb”_¿nge
(1, viùim->
Ëv–
è+ 
	`GET_ATTR_DAMROLL
(victim)) / 2,

2708 
skl
::
ty³
::
unknown
, 
©ck_ty³
, 
DAM_BASH
, 
Œue
, 
çl£
);

2709 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
hªd_to_hªd
, 
Œue
, 8);

2712 ià(
	`GET_ATTR
(
viùim
, 
SET_PALADIN_GRACE
) >= 5){

2714 ià(!
viùim
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
è&& 
	`deãn£_h—l
(victim, 15, 20)) {

2715 
	`¡c
("{BMÚŒey' G¿û h—l you!!!!{x\n", 
viùim
);

2717 ià(!
ch
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

2718 
	`¡c
("{BYou¸İpÚ’ˆglow w™h‡ {Wwh™ligh{Bt!!!!{x\n", 
ch
);

2723  
Œue
;

2724 
	}
}

2727 
boŞ
 
	$check_shblock
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
, 
©ck_ty³
)

2729 
buf
[
MAX_STRING_LENGTH
];

2730 
buf2
[
MAX_STRING_LENGTH
];

2731 
Objeù
 *
obj
 = (
	`g‘_eq_ch¬
(
viùim
, 
WEAR_SHIELD
));

2733 
chªû
;

2734 
SŒšg
 
©ck
;

2736 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
·¿lyze
)) {

2737 ià(
	`rŞl_chªû
(30))

2738  
çl£
;

2741 ià(!
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
sh›ld_block
))

2742  
çl£
;

2744 ià(
	`g‘_eq_ch¬
(
viùim
, 
WEAR_SHIELD
è=ğ
nuÎ±r
)

2745  
çl£
;

2747 
chªû
 = 
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
sh›ld_block
) * 2 / 5;

2749 
chªû
 +ğ(
viùim
->
Ëv–
 - 
ch
->level);

2752 #ifdeà
DEBUG_CHANCE


2753 
	`±c
(
ch
, "(shblock %d%%)", 
chªû
);

2754 
	`±c
(
viùim
, "(shblock %d%%)", 
chªû
);

2757 ià(
	`numb”_³rûÁ
(è>ğ
chªû
) {

2758 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
sh›ld_block
, 
çl£
, 10);

2759  
çl£
;

2763 ià(
©ck_skl
 !ğ
skl
::
ty³
::
unknown
)

2764 
©ck
 = 
skl
::
	`lookup
(
©ck_skl
).
noun_damage
;

2766 ià(
©ck_ty³
 < 0 || (ï‰ack_ty³ >ğ
©ck_bË
.
	`size
()) {

2767 
Loggšg
::
	`bug
("Dam_mes§ge: bad‡‰ack_ty³ %d.", 
©ck_ty³
);

2768 
©ck_ty³
 = 0;

2771 
©ck
 = 
©ck_bË
[
©ck_ty³
].
noun
;

2774 ià(!
viùim
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

2775 
FÜm©
::
	`¥rštf
(
buf
, "{BYou block $n' {B% w™h you¸sh›ld.{x", 
©ck
);

2776 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2780 ià(
	`GET_ATTR
(
viùim
, 
APPLY_HP_BLOCK_PCT
) != 0){

2781 
liã_»¡Üed
 = (
	`numb”_¿nge
(1, 
obj
->
Ëv–
 / 2è+ 
	`GET_ATTR
(
viùim
, 
APPLY_HP_BLOCK_PCT
));

2782 
viùim
->
h™
 +ğ
liã_»¡Üed
;

2783 
FÜm©
::
	`¥rštf
(
buf2
, "{BYou¸block„e¡Üe %d oàyou¸liã.{x\n", 
liã_»¡Üed
);

2784 
	`¡c
(
buf2
, 
viùim
);

2786 ià(
	`GET_ATTR
(
viùim
, 
APPLY_MANA_BLOCK_PCT
) != 0){

2787 
mªa_»¡Üed
 = (
	`numb”_¿nge
(1, 
obj
->
Ëv–
 / 2è+ 
	`GET_ATTR
(
viùim
, 
APPLY_MANA_BLOCK_PCT
));

2788 
viùim
->
mªa
 +ğ
mªa_»¡Üed
;

2789 
FÜm©
::
	`¥rštf
(
buf2
, "{BYou¸block„e¡Üe %d oàyou¸mªa.{x\n", 
mªa_»¡Üed
);

2790 
	`¡c
(
buf2
, 
viùim
);

2793 ià(!
ch
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

2794 
FÜm©
::
	`¥rštf
(
buf
, "{R$N{R block you¸% w™h‡ sh›ld.{x", 
©ck
);

2795 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2798 
	`check_cÚd
(
viùim
, 
	`g‘_eq_ch¬
(viùim, 
WEAR_SHIELD
));

2799 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
sh›ld_block
, 
Œue
, 6);

2802 ià(
	`GET_ATTR
(
viùim
, 
SET_PALADIN_GRACE
) >= 5){

2804 ià(!
viùim
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
è&& 
	`deãn£_h—l
(victim, 15, 20)) {

2805 
	`¡c
("{BMÚŒey' G¿û h—l you!!!!{x\n", 
viùim
);

2807 ià(!
ch
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

2808 
	`¡c
("{BYou¸İpÚ’ˆglow w™h‡ {Wwh™ligh{Bt!!!!{x\n", 
ch
);

2813  
Œue
;

2814 
	}
}

2817 
boŞ
 
	$check_dodge
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
, 
©ck_ty³
)

2819 
buf
[
MAX_STRING_LENGTH
];

2820 
chªû
;

2821 
SŒšg
 
©ck
;

2823 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
·¿lyze
)) {

2824 ià(
	`rŞl_chªû
(30))

2825  
çl£
;

2828 ià(!
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
dodge
))

2829  
çl£
;

2831 
chªû
 = 
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
dodge
) / 2;

2833 
chªû
 -ğ(
viùim
->
size
 - 
SIZE_MEDIUM
) * 5;

2836 
chªû
 +ğ3 * ((
	`GET_ATTR_DEX
(
viùim
)è- (GET_ATTR_DEX(
ch
)));

2839 ià(
viùim
->
off_æags
.
	`has
(
OFF_FAST
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(viùim,‡fãù::
ty³
::
ha¡e
))

2840 
chªû
 += 15;

2842 ià(
ch
->
off_æags
.
	`has
(
OFF_FAST
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
ha¡e
))

2843 
chªû
 -= 15;

2845 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
¦ow
))

2846 
chªû
 -= 15;

2848 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
))

2849 
chªû
 += 15;

2851 ià(!
	`ÿn_£e_ch¬
(
viùim
, 
ch
))

2852 
chªû
 -= 20;

2854 ià(!
	`ÿn_£e_ch¬
(
ch
, 
viùim
))

2855 
chªû
 += 20;

2859 
chªû
 +ğ(
viùim
->
Ëv–
 - 
ch
->level) * 2;

2863 #ifdeà
DEBUG_CHANCE


2864 
	`±c
(
ch
, "(dodg%d%%)", 
chªû
);

2865 
	`±c
(
viùim
, "(dodg%d%%)", 
chªû
);

2868 
chªû
 = 
	`URANGE
(5, chance, 95);

2872 ià(
	`numb”_³rûÁ
(è>ğ
chªû
) {

2873 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
dodge
, 
çl£
, 10);

2874  
çl£
;

2878 ià(
©ck_skl
 !ğ
skl
::
ty³
::
unknown
)

2879 
©ck
 = 
skl
::
	`lookup
(
©ck_skl
).
noun_damage
;

2881 ià(
©ck_ty³
 < 0 || (ï‰ack_ty³ >ğ
©ck_bË
.
	`size
()) {

2882 
Loggšg
::
	`bug
("Dam_mes§ge: bad‡‰ack_ty³ %d.", 
©ck_ty³
);

2883 
©ck_ty³
 = 0;

2886 
©ck
 = 
©ck_bË
[
©ck_ty³
].
noun
;

2889 ià(!
viùim
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

2890 
FÜm©
::
	`¥rštf
(
buf
, "{BYou dodg$n' {B%s.{x", 
©ck
);

2891 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2894 ià(!
ch
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

2895 
FÜm©
::
	`¥rštf
(
buf
, "{R$N{R dodge you¸%s.{x", 
©ck
);

2896 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2900 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
dodge
, 
Œue
, 6);

2903 ià(
	`GET_ATTR
(
viùim
, 
SET_PALADIN_GRACE
) >= 5){

2905 ià(!
viùim
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
è&& 
	`deãn£_h—l
(victim, 15, 20)) {

2906 
	`¡c
("{BMÚŒey' G¿û h—l you!!!!{x\n", 
viùim
);

2908 ià(!
ch
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

2909 
	`¡c
("{BYou¸İpÚ’ˆglow w™h‡ {Wwh™ligh{Bt!!!!{x\n", 
ch
);

2914  
Œue
;

2915 
	}
}

2918 
boŞ
 
	$check_blur
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 
©ck_skl
, 
©ck_ty³
)

2920 
buf
[
MAX_STRING_LENGTH
];

2921 
chªû
;

2922 
SŒšg
 
©ck
;

2924 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
·¿lyze
)) {

2925 ià(
	`rŞl_chªû
(30))

2926  
çl£
;

2929 ià(!
	`CAN_USE_RSKILL
(
viùim
, 
skl
::
ty³
::
blur
))

2930  
çl£
;

2932 
chªû
 = 
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
blur
) / 3;

2934 
chªû
 -ğ(
viùim
->
size
 - 
SIZE_MEDIUM
) * 5;

2937 
chªû
 +ğ3 * ((
	`GET_ATTR_DEX
(
viùim
)è- (GET_ATTR_DEX(
ch
)));

2940 ià(
viùim
->
off_æags
.
	`has
(
OFF_FAST
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(viùim,‡fãù::
ty³
::
ha¡e
))

2941 
chªû
 += 10;

2943 ià(
ch
->
off_æags
.
	`has
(
OFF_FAST
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
ha¡e
))

2944 
chªû
 -= 10;

2946 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
¦ow
))

2947 
chªû
 -= 10;

2949 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
))

2950 
chªû
 += 10;

2952 ià(!
	`ÿn_£e_ch¬
(
viùim
, 
ch
))

2953 
chªû
 -= 20;

2955 ià(!
	`ÿn_£e_ch¬
(
ch
, 
viùim
))

2956 
chªû
 += 20;

2960 
chªû
 +ğ(
viùim
->
Ëv–
 - 
ch
->level) * 2;

2964 #ifdeà
DEBUG_CHANCE


2965 
	`±c
(
ch
, "(blu¸%d%%)", 
chªû
);

2966 
	`±c
(
viùim
, "(blu¸%d%%)", 
chªû
);

2969 
chªû
 = 
	`URANGE
(5, chance, 95);

2971 ià(
	`numb”_³rûÁ
(è>ğ
chªû
) {

2972 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
blur
, 
çl£
, 10);

2973  
çl£
;

2977 ià(
©ck_skl
 !ğ
skl
::
ty³
::
unknown
)

2978 
©ck
 = 
skl
::
	`lookup
(
©ck_skl
).
noun_damage
;

2980 ià(
©ck_ty³
 < 0 || (ï‰ack_ty³ >ğ
©ck_bË
.
	`size
()) {

2981 
Loggšg
::
	`bug
("Dam_mes§ge: bad‡‰ack_ty³ %d.", 
©ck_ty³
);

2982 
©ck_ty³
 = 0;

2985 
©ck
 = 
©ck_bË
[
©ck_ty³
].
noun
;

2988 ià(!
viùim
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

2989 
FÜm©
::
	`¥rštf
(
buf
, "{V$n' {V% i nØm©ch fÜ you¸¥“d.{x", 
©ck
);

2990 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2993 ià(!
ch
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

2994 
FÜm©
::
	`¥rštf
(
buf
, "{M$N {Mblur w™h s³ed‡ $Eƒvade you¸%s.{x", 
©ck
);

2995 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2999 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
blur
, 
Œue
, 6);

3002 ià(
	`GET_ATTR
(
viùim
, 
SET_PALADIN_GRACE
) >= 5){

3004 ià(!
viùim
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
è&& 
	`deãn£_h—l
(victim, 15, 20)) {

3005 
	`¡c
("{BMÚŒey' G¿û h—l you!!!!{x\n", 
viùim
);

3007 ià(!
ch
->
aù_æags
.
	`has
(
PLR_DEFENSIVE
)) {

3008 
	`¡c
("{BYou¸İpÚ’ˆglow w™h‡ {Wwh™ligh{Bt!!!!{x\n", 
ch
);

3013  
Œue
;

3014 
	}
}

3021 
boŞ
 
	$deãn£_h—l
(
Ch¬aù”
 *
viùim
, 
chªû
, 
³rûÁ
)

3023 
mod_hp
 = 0;

3024 
mod_mªa
 = 0;

3025 
mod_¡am
 = 0;

3027 
mod_hp
 +ğ(
	`GET_MAX_HIT
(
viùim
è* 
³rûÁ
 / 100);

3028 
mod_mªa
 +ğ(
	`GET_MAX_MANA
(
viùim
è* 
³rûÁ
 / 100);

3029 
mod_¡am
 +ğ(
	`GET_MAX_STAM
(
viùim
è* 
³rûÁ
 / 100);

3031 ià(
	`rŞl_chªû
(
chªû
)){

3033 
viùim
->
h™
 +ğ
mod_hp
;

3034 
viùim
->
mªa
 +ğ
mod_mªa
;

3035 
viùim
->
¡am
 +ğ
mod_¡am
;

3037  
Œue
;

3039  
çl£
;

3040 
	}
}

3043 
	$upd©e_pos
(
Ch¬aù”
 *
viùim
)

3045 ià(
viùim
->
h™
 > 0) {

3046 ià(
viùim
->
pos™iÚ
 <ğ
POS_STUNNED
)

3047 
viùim
->
pos™iÚ
 = 
POS_STANDING
;

3049 ià((
viùim
->
	`is_Åc
(è&& viùim->
h™
 < 1)

3050 || (
viùim
->
h™
 <= -11))

3051 
viùim
->
pos™iÚ
 = 
POS_DEAD
;

3052 ià(
viùim
->
h™
 <= -6)

3053 
viùim
->
pos™iÚ
 = 
POS_MORTAL
;

3054 ià(
viùim
->
h™
 <= -3)

3055 
viùim
->
pos™iÚ
 = 
POS_INCAP
;

3057 
viùim
->
pos™iÚ
 = 
POS_STUNNED
;

3058 
	}
}

3061 
	$£t_fightšg
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

3063 ià(
ch
->
fightšg
 !ğ
nuÎ±r
) {

3064 
Loggšg
::
	`bug
("Set_fighting:‡lready fighting", 0);

3068 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦“p
))

3069 
afãù
::
	`»move_ty³_äom_ch¬
(
ch
,‡fãù::
ty³
::
¦“p
);

3071 
ch
->
fightšg
 = 
viùim
;

3073 ià(
ch
->
wa™
 =ğ0 && ch->
pos™iÚ
 < 
POS_STANDING
) {

3074 
ch
->
pos™iÚ
 = 
POS_STANDING
;

3076 ià(
ch
->
¡¬t_pos
 =ğ
POS_FLYING
 && 
	`CAN_FLY
(ch))

3077 
ch
->
pos™iÚ
 = 
POS_FLYING
;

3079 
	}
}

3082 
	$¡İ_fightšg
(
Ch¬aù”
 *
ch
, 
boŞ
 
fBÙh
)

3084 autØ
fch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

3085 ià(
fch
 =ğ
ch
 || (
fBÙh
 && fch->
fightšg
 == ch)) {

3086 
fch
->
fightšg
 = 
nuÎ±r
;

3087 
fch
->
pos™iÚ
 = fch->
	`is_Åc
(è? fch->
deçuÉ_pos
 : fch->
¡¬t_pos
;

3088 
	`upd©e_pos
(
fch
);

3091 
	}
}

3094 
	$make_cÜp£
(
Ch¬aù”
 *
ch
)

3096 
Objeù
 *
cÜp£
;

3097 
Objeù
 *
obj
;

3098 
Objeù
 *
obj_Ãxt
;

3099 
SŒšg
 
Çme
;

3101 ià(
ch
->
	`is_Åc
()) {

3102 
Çme
 = 
ch
->
shÜt_desü
;

3103 
cÜp£
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_CORPSE_NPC
), 0);

3105 ià(! 
cÜp£
) {

3106 
Loggšg
::
	`bug
("Error creating corpse in make_corpse.", 0);

3110 
cÜp£
->
tim”
 = 
	`numb”_¿nge
(3, 6);

3112 ià(
ch
->
gŞd
 > 0) {

3113 
	`obj_to_obj
(
	`ü—‹_mÚey
(
ch
->
gŞd
, ch->
sv”
), 
cÜp£
);

3114 
ch
->
gŞd
 = 0;

3115 
ch
->
sv”
 = 0;

3118 
cÜp£
->
co¡
 = 
¡d
::
	`max
(1, (
ch
->
Ëv–
 * 3));

3121 
Çme
 = 
ch
->name;

3122 
cÜp£
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_CORPSE_PC
), 0);

3124 ià(! 
cÜp£
) {

3125 
Loggšg
::
	`bug
("Memoryƒrror making corpse in make_corpse.", 0);

3129 
cÜp£
->
tim”
 = 
	`numb”_¿nge
(25, 40);

3130 
ch
->
aù_æags
 -ğ
PLR_CANLOOT
;

3131 
cÜp£
->
owÃr
 = 
ch
->
Çme
;

3141 
cÜp£
->
co¡
 = 1;

3144 
cÜp£
->
Ëv–
 = 
ch
->level;

3145 
cÜp£
->
shÜt_desü
 = 
FÜm©
::
	`fÜm©
(cÜp£->shÜt_desü, 
Çme
);

3146 
cÜp£
->
desütiÚ
 = 
FÜm©
::
	`fÜm©
(cÜp£->desütiÚ, 
Çme
);

3156 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
)è!ğ
nuÎ±r
)

3157 
	`uÃqu_ch¬
(
ch
, 
obj
);

3159 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

3160 
boŞ
 
æßtšg
 = 
çl£
;

3161 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

3163 ià(
obj
->
w—r_loc
 =ğ
WEAR_FLOAT
)

3164 
æßtšg
 = 
Œue
;

3166 
	`obj_äom_ch¬
(
obj
);

3168 ià(
obj
->
™em_ty³
 =ğ
ITEM_POTION
)

3169 
obj
->
tim”
 = 
	`numb”_¿nge
(500, 1000);

3171 ià(
obj
->
™em_ty³
 =ğ
ITEM_SCROLL
)

3172 
obj
->
tim”
 = 
	`numb”_¿nge
(1000, 2500);

3174 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_ROT_DEATH
è&& !
æßtšg
) {

3175 
obj
->
tim”
 = 
	`numb”_¿nge
(5, 10);

3176 
obj
->
exŒa_æags
 -ğ
ITEM_ROT_DEATH
;

3179 
obj
->
exŒa_æags
 -ğ
ITEM_VIS_DEATH
;

3181 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_INVENTORY
))

3182 
	`exŒaù_obj
(
obj
);

3183 ià(
æßtšg
) {

3184 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_ROT_DEATH
)) {

3185 ià(
obj
->
cÚšs
 !ğ
nuÎ±r
) {

3186 
	`aù
("$°deÿys, sÿ‰”šg it cÚ‹Ás.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3189 
	`aù
("$°deÿys.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3191 
	`de¡roy_obj
(
obj
);

3194 
	`aù
("$°çÎ tØthæoÜ.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3195 
	`obj_to_room
(
obj
, 
ch
->
š_room
);

3199 
	`obj_to_obj
(
obj
, 
cÜp£
);

3202 ià(
	`ch¬_©_w¬
(
ch
))

3203 
	`obj_to_room
(
cÜp£
, 
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
şª
->
»ÿÎ
));

3204 ià(
ch
->
	`is_Åc
(è|| ch->
Ëv–
 >= 50)

3205 
	`obj_to_room
(
cÜp£
, 
ch
->
š_room
);

3207 
	`obj_to_room
(
cÜp£
, 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_MORGUE
))));

3208 
	}
}

3211 
	$d—th_üy
(
Ch¬aù”
 *
ch
)

3213 
Room
 *
was_š_room
;

3214 *
msg
;

3215 
doÜ
, 
vnum
;

3216 
vnum
 = 0;

3217 
msg
 = "You hear $n's death cry.";

3219 
	`numb”_b™s
(4)) {

3221 
msg
 = "$n collapses‡t your feet ... DEAD.";

3225 ià(
ch
->
m©”Ÿl
.
	`em±y
())

3226 
msg
 = "$n splatters blood‡ll over you,he ground,ƒverything...Eeeeeeew!";

3231 ià(
ch
->
·¹s_æags
.
	`has
(
PART_GUTS
)) {

3232 
msg
 = "$n spills $s guts‡ll overhe floor.";

3233 
vnum
 = 
OBJ_VNUM_GUTS
;

3239 ià(
ch
->
·¹s_æags
.
	`has
(
PART_HEAD
)) {

3240 
msg
 = "$n's severed head…lops onhe ground.";

3241 
vnum
 = 
OBJ_VNUM_SEVERED_HEAD
;

3247 ià(
ch
->
·¹s_æags
.
	`has
(
PART_HEART
)) {

3248 
msg
 = "$n's heart isorn from $s chest‡nd†ays beating‡t your feet.";

3249 
vnum
 = 
OBJ_VNUM_TORN_HEART
;

3255 ià(
ch
->
·¹s_æags
.
	`has
(
PART_ARMS
)) {

3256 
msg
 = "$n's‡rm is sliced from $s dead body.";

3257 
vnum
 = 
OBJ_VNUM_SLICED_ARM
;

3263 ià(
ch
->
·¹s_æags
.
	`has
(
PART_LEGS
)) {

3264 
msg
 = "$n's†eg is sliced from $s dead body.";

3265 
vnum
 = 
OBJ_VNUM_SLICED_LEG
;

3271 ià(
ch
->
·¹s_æags
.
	`has
(
PART_BRAINS
)) {

3272 
msg
 = "$n's head is shattered,‡nd $s brains splash‡ll over you.";

3273 
vnum
 = 
OBJ_VNUM_BRAINS
;

3277 
	`aù
(
msg
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_NOTVIEW
);

3279 ià(
vnum
 != 0) {

3280 
Objeù
 *
obj
;

3281 
SŒšg
 
Çme
;

3282 
Çme
 = 
ch
->
	`is_Åc
(è? ch->
shÜt_desü
 : ch->name;

3283 
obj
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
vnum
), 0);

3285 ià(! 
obj
) {

3286 
Loggšg
::
	`bug
("Memoryƒrror creating object in death_cry.", 0);

3290 
obj
->
tim”
 = 
	`numb”_¿nge
(4, 7);

3291 
obj
->
shÜt_desü
 = 
FÜm©
::
	`fÜm©
(obj->shÜt_desü, 
Çme
);

3292 
obj
->
desütiÚ
 = 
FÜm©
::
	`fÜm©
(obj->desütiÚ, 
Çme
);

3294 ià(
obj
->
™em_ty³
 =ğ
ITEM_FOOD
) {

3295 ià(
ch
->
fÜm_æags
.
	`has
(
FORM_POISON
))

3296 
obj
->
v®ue
[3] = 1;

3297 ià(!
ch
->
fÜm_æags
.
	`has
(
FORM_EDIBLE
))

3298 
obj
->
™em_ty³
 = 
ITEM_TRASH
;

3301 
	`obj_to_room
(
obj
, 
ch
->
š_room
);

3304 ià(
ch
->
	`is_Åc
())

3305 
msg
 = "Nearby, you hear someone's death cry.";

3307 
msg
 = "You hearhe death cry of‡ fellow…layer, maybe friend.";

3309 
was_š_room
 = 
ch
->
š_room
;

3311 
doÜ
 = 0; door <= 5; door++) {

3312 
Ex™
 *
³x™
;

3314 ià((
³x™
 = 
was_š_room
->
ex™
[
doÜ
]è!ğ
nuÎ±r


3315 && 
³x™
->
to_room
 !ğ
nuÎ±r


3316 && 
³x™
->
to_room
 !ğ
was_š_room
) {

3317 
ch
->
š_room
 = 
³x™
->
to_room
;

3318 
	`aù
(
msg
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_NOTVIEW
);

3322 
ch
->
š_room
 = 
was_š_room
;

3323 
	}
}

3325 
	$¿w_kl
(
Ch¬aù”
 *
viùim
)

3327 
	`¡İ_fightšg
(
viùim
, 
Œue
);

3328 
	`m´og_d—th_Œigg”
(
viùim
);

3330 ià(
viùim
->
	`is_g¬bage
())

3333 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a


3334 && 
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
şª¬’a


3335 && (
viùim
->
š_room
->
	`¬—
(è!ğ
Game
::
	`wÜld
().
que¡
.¬—(è|| !Game::wÜld().que¡.
pk
)

3336 && !
	`ch¬_š_du–_room
(
viùim
))

3337 
	`make_cÜp£
(
viùim
);

3339 ià(
viùim
->
	`is_Åc
()) {

3340 
viùim
->
pIndexD©a
->
kËd
++;

3341 
	`exŒaù_ch¬
(
viùim
, 
Œue
);

3347 
viùim
->
pcd©a
->
pktim”
 = 0;

3349 
afãù
::
	`»move_®l_äom_ch¬
(
viùim
, 
çl£
);

3351 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a


3352 && 
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
şª¬’a


3353 && (
viùim
->
š_room
->
	`¬—
(è!ğ
Game
::
	`wÜld
().
que¡
.¬—(è|| !Game::wÜld().que¡.
pk
)

3354 && !
	`ch¬_š_du–_room
(
viùim
)) {

3355 
	`exŒaù_ch¬
(
viùim
, 
çl£
);

3357 
i
 = 0; i < 4; i++) {

3358 
viùim
->
¬mÜ_ba£
[
i
] = 100;

3362 ià(
	`ch¬_š_du–
(
viùim
))

3363 
	`du–_kl
(
viùim
);

3365 
	`ch¬_äom_room
(
viùim
);

3366 
	`ch¬_to_room
(
viùim
, 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_ALTAR
))));

3370 
viùim
->
pos™iÚ
 = 
POS_RESTING
;

3371 
viùim
->
h™
 = 
¡d
::
	`max
(1, victim->hit);

3372 
viùim
->
mªa
 = 
¡d
::
	`max
(1, victim->mana);

3373 
viùim
->
¡am
 = 
¡d
::
	`max
(1, victim->stam);

3375 
	`§ve_ch¬_obj
(
viùim
);

3379 
	`obj¡©e_§ve_™ems
();

3381 
	}
}

3384 
	$group_gaš
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

3386 
buf
[
MAX_STRING_LENGTH
];

3387 
Ch¬aù”
 *
gch
;

3388 
Ch¬aù”
 *
lch
;

3389 
xp
;

3390 
memb”s
 = 0;

3391 
group_Ëv–s
 = 0;

3392 
highe¡Ëv–
 = 0;

3393 
FÏgs
 
v¬y_št
;

3394 
diff_şas£s
 = 1;

3395 cÚ¡ 
FÏgs
::
B™
 
v¬y_b™
 [] =

3396 { 
FÏgs
::
A
, FÏgs::
B
, FÏgs::
C
, FÏgs::
D
, FÏgs::
E
, FÏgs::
F
, FÏgs::
G
, FÏgs::
H
 };

3399 
lowe¡_xp
 = 1000000;

3405 ià(
viùim
 =ğ
ch
){

3406 
xp
 = 0;

3407 
lowe¡_xp
 = 0;

3410 ià(
ch
->
gud
 !ğ
Gud
::
nÚe
)

3411 
v¬y_št
 +ğ
v¬y_b™
[
ch
->
gud
];

3414 
gch
 = 
ch
->
š_room
->
³İË
; gch !ğ
nuÎ±r
; gch = gch->
Ãxt_š_room
) {

3415 ià(
	`is_§me_group
(
gch
, 
ch
)) {

3416 
memb”s
++;

3417 
group_Ëv–s
 +ğ
gch
->
	`is_Åc
(è? gch->
Ëv–
 / 2 : gch->level;

3420 ià(
gch
->
gud
 !ğ
Gud
::
nÚe


3421 && !
v¬y_št
.
	`has
(
v¬y_b™
[
gch
->
gud
])) {

3422 
v¬y_št
 +ğ
v¬y_b™
[
gch
->
gud
];

3423 
diff_şas£s
++;

3428 ià(
memb”s
 == 0) {

3429 
Loggšg
::
	`bug
("Group_gaš: memb”s.", 
memb”s
);

3430 
memb”s
 = 1;

3431 
group_Ëv–s
 = 
ch
->
Ëv–
;

3435 
lch
 = 
ch
->
š_room
->
³İË
;†ch !ğ
nuÎ±r
;†ch =†ch->
Ãxt_š_room
) {

3436 ià(!
	`is_§me_group
(
lch
, 
ch
è||†ch->
	`is_Åc
())

3439 ià(
lch
->
Ëv–
 > 
highe¡Ëv–
)

3440 
highe¡Ëv–
 = 
lch
->
Ëv–
;

3444 
gch
 = 
ch
->
š_room
->
³İË
; gch !ğ
nuÎ±r
; gch = gch->
Ãxt_š_room
) {

3445 
Objeù
 *
obj
;

3446 
Objeù
 *
obj_Ãxt
;

3448 ià(!
	`is_§me_group
(
gch
, 
ch
è|| gch->
	`is_Åc
())

3451 ià(
gch
->
Ëv–
 - 
highe¡Ëv–
 <= -7) {

3452 
	`¡c
("You¸pow” would bu£Ës tØsuch‡Àadvªûd grou°oàadv’tu»rs.\n", 
gch
);

3456 
xp
 = 
	`xp_compu‹
(
gch
, 
viùim
, 
group_Ëv–s
, 
diff_şas£s
);

3457 
gxp
 = 
xp
;

3459 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


3460 || 
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
şª¬’a


3461 || (
ch
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.¬—(è&& Game::wÜld().que¡.
pk
))

3462 
xp
 = 0;

3465 ià(
xp
 < 
lowe¡_xp
)

3466 
lowe¡_xp
 = 
xp
;

3472 
xp
 +ğx°* 
	`GET_ATTR
(
gch
, 
APPLY_EXP_PCT
) / 100;

3474 
	`±c
(
gch
, "{PYou„eûiv%dƒx³r›nû…ošts.{x\n", 
xp
);

3477 ià(!
ch
->
»voke_æags
.
	`has
(
REVOKE_EXP
))

3478 
	`gaš_exp
(
gch
, 
xp
);

3481 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

3482 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

3484 ià(
obj
->
w—r_loc
 =ğ
WEAR_NONE
)

3487 ià((
	`IS_OBJ_STAT
(
obj
, 
ITEM_ANTI_EVIL
è&& 
	`IS_EVIL
(
ch
))

3488 || (
	`IS_OBJ_STAT
(
obj
, 
ITEM_ANTI_GOOD
è&& 
	`IS_GOOD
(
ch
))

3489 || (
	`IS_OBJ_STAT
(
obj
, 
ITEM_ANTI_NEUTRAL
è&& 
	`IS_NEUTRAL
(
ch
))) {

3490 
	`aù
("You‡» z­³d by $°ªd ha¡y drİ it.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3491 
	`aù
("$Ài z­³d by $°ªd ha¡y drİ ™.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3492 
	`obj_äom_ch¬
(
obj
);

3493 
	`obj_to_room
(
obj
, 
ch
->
š_room
);

3497 ià(
	`IS_QUESTOR
(
gch
è&& 
viùim
->
	`is_Åc
()) {

3498 ià(
gch
->
pcd©a
->
que¡mob
 =ğ
viùim
->
pIndexD©a
->
vnum
) {

3499 
	`¡c
("{YYou hav®mo¡ com¶‘ed you¸QUEST!{x\n", 
gch
);

3500 
	`¡c
("{YR‘uºØthque¡ma¡” befÜyou¸timrun out!{x\n", 
gch
);

3501 
gch
->
pcd©a
->
que¡mob
 = -1;

3502 
FÜm©
::
	`¥rštf
(
buf
, "{Y:QUEST: {x$N ha ¦aš %s", 
viùim
->
shÜt_desü
);

3503 
	`wizÃt
(
buf
, 
gch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

3508  
lowe¡_xp
;

3509 
	}
}

3512 
	$xp_compu‹
(
Ch¬aù”
 *
gch
, Ch¬aù” *
viùim
, 
tÙ®_Ëv–s
, 
diff_şas£s
)

3514 
Ëv–_¿nge
 = 
viùim
->
Ëv–
 - 
gch
->level;

3517 ià(
	`IS_REMORT
(
gch
)) {

3518 
»mÜt_mod
 = ((
gch
->
pcd©a
->
»mÜt_couÁ
 * gch->
Ëv–
) / 100);

3520 ià(
Ëv–_¿nge
 < 
»mÜt_mod
)

3521 
Ëv–_¿nge
 -ğ((
»mÜt_mod
 / 10) + 1);

3524 
ba£_exp
 = 0;

3527 
Ëv–_¿nge
) {

3528 -9 : 
ba£_exp
 = 1; ;

3530 -8 : 
ba£_exp
 = 2; ;

3532 -7 : 
ba£_exp
 = 5; ;

3534 -6 : 
ba£_exp
 = 9; ;

3536 -5 : 
ba£_exp
 = 11; ;

3538 -4 : 
ba£_exp
 = 22; ;

3540 -3 : 
ba£_exp
 = 33; ;

3542 -2 : 
ba£_exp
 = 50; ;

3544 -1 : 
ba£_exp
 = 66; ;

3546 0 : 
ba£_exp
 = 83; ;

3548 1 : 
ba£_exp
 = 99; ;

3550 2 : 
ba£_exp
 = 121; ;

3552 3 : 
ba£_exp
 = 143; ;

3554 4 : 
ba£_exp
 = 165; ;

3557 ià(
Ëv–_¿nge
 > 4)

3558 
ba£_exp
 = 160 + 20 * (
Ëv–_¿nge
 - 4);

3563 ià(!
viùim
->
aù_æags
.
	`has
(
ACT_NOALIGN
)

3564 && 
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a


3565 && 
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
şª¬’a


3566 && (
viùim
->
š_room
->
	`¬—
(è!ğ
Game
::
	`wÜld
().
que¡
.¬—(è|| !Game::wÜld().que¡.
pk
)

3567 && 
gch
->
gud
 !ğ
Gud
::
·Ïdš
)

3570 
®ign
 = 
viùim
->
®ignm’t
 - 
gch
->alignment;

3571 
chªge
;

3573 ià(
®ign
 > 500) {

3574 
chªge
 = (
®ign
 - 500è* 
ba£_exp
 / 500 * 
gch
->
Ëv–
 / 
tÙ®_Ëv–s
;

3575 
chªge
 = 
¡d
::
	`max
(1, change);

3576 
gch
->
®ignm’t
 -ğ
chªge
;

3578 ià(
®ign
 < -500) {

3579 
chªge
 = (-1 * 
®ign
 - 500è* 
ba£_exp
 / 500 * 
gch
->
Ëv–
 / 
tÙ®_Ëv–s
;

3580 
chªge
 = 
¡d
::
	`max
(1, change);

3581 
gch
->
®ignm’t
 +ğ
chªge
;

3584 
chªge
 = 
gch
->
®ignm’t
 * 
ba£_exp
 / 500 * gch->
Ëv–
 / 
tÙ®_Ëv–s
;

3585 
gch
->
®ignm’t
 -ğ
chªge
;

3588 
gch
->
®ignm’t
 = 
	`URANGE
(-1000, gch->alignment, 1000);

3591 
xp
 = 
ba£_exp
;

3628 ià(
gch
->
Ëv–
 < 6)

3629 
xp
 = 10 * x°/ (
gch
->
Ëv–
 + 4);

3632 ià(
gch
->
Ëv–
 > 35)

3633 
xp
 = 15 * x°/ (
gch
->
Ëv–
 - 25);

3647 
y—rs
 = 
	`g‘_¶ay_£cÚds
(
gch
è/ (
MUD_YEAR
 * 
MUD_MONTH
 * 
MUD_DAY
 * 
MUD_HOUR
)

3648 + 
	`GET_ATTR_MOD
(
gch
, 
APPLY_AGE
);

3649 
xp
 = x°- (x°/ 3è+ ((x°/ 3è* (
	`URANGE
(1, 
y—rs
, 50) / 50));

3652 ià(
	`HAS_RAFF
(
gch
, 
RAFF_FAVORGOD
è&& 
	`rŞl_chªû
(25)) {

3653 
	`¡c
("Thgod smupÚ you.\n", 
gch
);

3654 
xp
 = (
	`rŞl_chªû
(25) ? (roll_chance(25) ? (xp * 4) : (xp * 3)) : (xp * 2));

3658 ià(
	`HAS_RAFF
(
gch
, 
RAFF_LAUGHTERGOD
è&& 
	`rŞl_chªû
(25)) {

3659 
	`¡c
("ThÏugh‹¸oàthgod çÎ upÚ you¸—rs.\n", 
gch
);

3660 
xp
 = (
	`rŞl_chªû
(25) ? (roll_chance(25) ? (xp / 4) : (xp / 3)) : (xp / 2));

3664 ià(
	`HAS_RAFF
(
gch
, 
RAFF_MOREEXP
))

3665 
xp
 += xp / 10;

3668 ià(
	`HAS_RAFF
(
gch
, 
RAFF_LESSEXP
))

3669 
xp
 -= xp / 10;

3672 
xp
 = 
	`numb”_¿nge
(xp * 3 / 4, xp * 5 / 4);

3673 
xp90
 = 90 * 
xp
 / 100;

3675 
xp
 = x°* 
gch
->
Ëv–
 / (
¡d
::
	`max
(1, 
tÙ®_Ëv–s
 - 1));

3678 ià(
gch
->
Ëv–
 !ğ
tÙ®_Ëv–s
) {

3680 
xp
 = (130 + (
diff_şas£s
 * 5)) * xp / 100;

3682 ià(
xp
 > 
xp90
) xp = xp90;

3687  
xp
;

3688 
	}
}

3691 
	$dam_mes§ge
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
dam
, 
skl
::
ty³
 
©ck_skl
, 
©ck_ty³
, 
boŞ
 
immuÃ
, boŞ 
§nc_immuÃ
)

3693 
buf1
[
MAX_INPUT_LENGTH
], 
buf2
[MAX_INPUT_LENGTH], 
buf3
[MAX_INPUT_LENGTH];

3694 cÚ¡ *
vp
;

3695 
SŒšg
 
©ck
;

3696 
punù
;

3698 ià(
ch
 =ğ
nuÎ±r
 || 
viùim
 ==‚ullptr)

3701 ià(
dam
 < 0è
vp
 = "{Gheals{x";

3702 ià(
dam
 =ğ0è
vp
 = "{Ymisses{x";

3703 ià(
dam
 <ğ4è
vp
 = "{bscratches{x";

3704 ià(
dam
 <ğ8è
vp
 = "{Ggrazes{x";

3705 ià(
dam
 <ğ12è
vp
 = "{Hhits{x";

3706 ià(
dam
 <ğ16è
vp
 = "{Ninjures{x";

3707 ià(
dam
 <ğ20è
vp
 = "{Cwounds{x";

3708 ià(
dam
 <ğ24è
vp
 = "{Bmauls{x";

3709 ià(
dam
 <ğ28è
vp
 = "{Mdecimates{x";

3710 ià(
dam
 <ğ32è
vp
 = "{Vdevastates{x";

3711 ià(
dam
 <ğ36è
vp
 = "{Pmaims{x";

3712 ià(
dam
 <ğ40è
vp
 = "{PM{cU{PT{cI{PL{cA{PT{cE{PS{x";

3713 ià(
dam
 <ğ44è
vp
 = "{BDI{NSE{BMB{NOW{BEL{NS{x";

3714 ià(
dam
 <ğ48è
vp
 = "{MDI{YSM{MEM{YBE{MRS{x";

3715 ià(
dam
 <ğ52è
vp
 = "{BDE{bCA{BPI{bTA{BTE{bS{x";

3716 ià(
dam
 <ğ56è
vp
 = "{c::: {RDEMOLISHES {c:::{x";

3717 ià(
dam
 <ğ60è
vp
 = "{T*** {CSTOMPS {T***{x";

3718 ià(
dam
 <ğ75è
vp
 = "{M@@@ {VINCINERATES {M@@@{x";

3719 ià(
dam
 <ğ100è
vp
 = "{N=== {BOBLITERATES {N==={x";

3720 ià(
dam
 <ğ125è
vp
 = "{H>>> {GANNIHILATES {H<<<{x";

3721 ià(
dam
 <ğ150è
vp
 = "{b<<< {YERADICATES {b>>>{x";

3722 ià(
dam
 <ğ170è
vp
 = "{R[#[ {PVAPORIZES {R]#]{x";

3723 ià(
dam
 <= 200)

3724 
vp
 = "{cdoes {PUN{RSP{PEA{RKA{PBL{RE {cthingso{x";

3726 
vp
 = "{Tbrings‡ouch of {RD{cE{RA{cT{RH {Tto{x";

3728 
punù
 = (
dam
 <= 24) ? '.' : '!';

3730 ià(
©ck_skl
 !ğ
skl
::
ty³
::
unknown
)

3731 
©ck
 = 
skl
::
	`lookup
(
©ck_skl
).
noun_damage
;

3733 ià(
©ck_ty³
 < 0 || (ï‰ack_ty³ >ğ
©ck_bË
.
	`size
()) {

3734 
Loggšg
::
	`bug
("Dam_mes§ge: bad‡‰ack_ty³ %d.", 
©ck_ty³
);

3735 
©ck_ty³
 = 0;

3738 
©ck
 = 
©ck_bË
[
©ck_ty³
].
noun
;

3741 ià(
immuÃ
) {

3742 ià(
ch
 =ğ
viùim
) {

3743 
FÜm©
::
	`¥rštf
(
buf1
, "$Ài uÇfãùed by $ owÀ%s.", 
©ck
);

3744 
FÜm©
::
	`¥rštf
(
buf2
, "Luckily, you‡re immuneohat.");

3747 
FÜm©
::
	`¥rštf
(
buf1
, "$N i uÇfãùed by $n' %s!", 
©ck
);

3748 
FÜm©
::
	`¥rštf
(
buf2
, "$N i uÇfãùed by you¸%s!", 
©ck
);

3749 
FÜm©
::
	`¥rštf
(
buf3
, "$n' % i pow”Ës agaš¡ you.", 
©ck
);

3752 ià(
§nc_immuÃ
) {

3753 ià(
ch
 =ğ
viùim
) {

3754 
FÜm©
::
	`¥rštf
(
buf1
, "$n' hŞy‡u¿…rÙeù $m from $ owÀ%s.", 
©ck
);

3755 
FÜm©
::
	`¥rštf
(
buf2
, "You¸§nùu¬y…rÙeù you from you¸owÀ%s.", 
©ck
);

3758 
FÜm©
::
	`¥rštf
(
buf1
, "$N' §nùu¬y„•– $n' cur£d %s!", 
©ck
);

3759 
FÜm©
::
	`¥rštf
(
buf2
, "$N' §nùu¬y„•– you¸cur£d %s!", 
©ck
);

3760 
FÜm©
::
	`¥rštf
(
buf3
, "$n' % ç tØ³ÃŒ©you¸§nùu¬y.", 
©ck
);

3764 ià(
ch
 =ğ
viùim
) {

3765 
FÜm©
::
	`¥rštf
(
buf1
, "$n' % % $m%ø[%d]" , 
©ck
, 
vp
, 
punù
, 
dam
);

3766 
FÜm©
::
	`¥rštf
(
buf2
, "You¸% % you%ø[%d]", 
©ck
, 
vp
, 
punù
, 
dam
);

3769 
FÜm©
::
	`¥rštf
(
buf1
, "$n' % % $N%ø[%d]" , 
©ck
, 
vp
, 
punù
, 
dam
);

3770 
FÜm©
::
	`¥rštf
(
buf2
, "You¸% % $N%ø[%d]" , 
©ck
, 
vp
, 
punù
, 
dam
);

3771 
FÜm©
::
	`¥rštf
(
buf3
, "$n' % % you%ø[%d]", 
©ck
, 
vp
, 
punù
, 
dam
);

3775 ià(
ch
 =ğ
viùim
) {

3776 
	`aù
(
buf1
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3777 
	`aù
(
buf2
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

3780 
	`aù
(
buf1
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

3781 
	`£t_cŞÜ
(
ch
, 
GREEN
, 
NOBOLD
);

3782 
	`aù
(
buf2
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3783 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

3784 
	`£t_cŞÜ
(
viùim
, 
YELLOW
, 
BOLD
);

3785 
	`aù
(
buf3
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

3786 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

3788 
	}
}

3790 
	$do_b”£rk
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3792 
chªû
, 
hp_³rûÁ
;

3794 ià((
chªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
b”£rk
)) == 0) {

3795 
	`¡c
("Youuº„ed iÀthçû, buˆnÙhšg h­³ns.\n", 
ch
);

3799 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
b”£rk
è||‡fãù::exi¡s_Ú_ch¬(ch,‡fãù::ty³::b”£rkè||‡fãù::exi¡s_Ú_ch¬(ch,‡fãù::ty³::
ä’zy
)) {

3800 
	`¡c
("You g‘‡†™madd”.\n", 
ch
);

3804 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ÿlm
)) {

3805 
	`¡c
("You'» f“lšgØm–lowØb”£rk.\n", 
ch
);

3809 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
b”£rk
))

3815 ià(
ch
->
fightšg
)

3816 
chªû
 += 10;

3819 
hp_³rûÁ
 = 100 * 
ch
->
h™
 / 
	`GET_MAX_HIT
(ch);

3820 
chªû
 +ğ25 - 
hp_³rûÁ
 / 2;

3822 ià(
	`numb”_³rûÁ
(è< 
chªû
) {

3823 
	`WAIT_STATE
(
ch
, 
PULSE_VIOLENCE
);

3825 
ch
->
h™
 +ğch->
Ëv–
 * 2;

3826 
ch
->
h™
 = 
¡d
::
	`mš
(ch->h™, 
	`GET_MAX_HIT
(ch));

3827 
	`¡c
("You¸pul£„aû a you‡» cÚsumed by„age!\n", 
ch
);

3828 
	`aù
("$Àg‘ ¨wd†ook iÀ$ eyes.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3829 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
b”£rk
, 
Œue
, 2);

3831 
afãù
::
	`add_ty³_to_ch¬
(
ch
,

3832 
afãù
::
ty³
::
b”£rk
,

3833 
ch
->
Ëv–
,

3834 
	`numb”_fuzzy
(
ch
->
Ëv–
 / 8),

3835 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
b”£rk
),

3836 
çl£


3840 
	`WAIT_STATE
(
ch
, 3 * 
PULSE_VIOLENCE
);

3841 
	`¡c
("You¸pul£ s³ed up, buˆnÙhšg h­³ns.\n", 
ch
);

3842 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
b”£rk
, 
çl£
, 2);

3844 
	}
}

3846 
	$do_bash
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3848 
Ch¬aù”
 *
viùim
;

3849 
chªû
;

3850 
kdtime
;

3851 
evŞutiÚ_Ëv–
;

3853 ià(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
bash
) == 0) {

3854 
	`¡c
("Bashšg? Wh©' th©?\n", 
ch
);

3858 
SŒšg
 
¬g
;

3859 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

3861 ià(
¬g
.
	`em±y
()) {

3862 
viùim
 = 
ch
->
fightšg
;

3864 ià(
viùim
 =ğ
nuÎ±r
) {

3865 
	`¡c
("Buˆyou‡»n'ˆfightšg‡nyÚe!\n", 
ch
);

3869 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

3870 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

3874 ià(
	`g‘_pos™iÚ
(
ch
è< 
POS_FIGHTING
) {

3875 
	`aù
("TØbash from you¸cu¼’ˆpos™iÚ would b¨Ã©rick!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

3879 ià(
	`g‘_pos™iÚ
(
viùim
è< 
POS_FIGHTING
) {

3880 
	`aù
("You'Î havtØËˆ$M g‘ back u°fœ¡.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3884 ià(
viùim
 =ğ
ch
) {

3885 
	`¡c
("YouryØbash you¸b¿š out, buˆç.\n", 
ch
);

3889 ià(
	`is_§ã
(
ch
, 
viùim
, 
Œue
)) {

3890 
	`aù
("Iˆi nÙ‡ saã¬g‘!", 
ch
, 
viùim
, 
nuÎ±r
, 
TO_CHAR
);

3894 ià(
viùim
->
	`is_Åc
()

3895 && 
viùim
->
fightšg
 !ğ
nuÎ±r


3896 && !
	`is_§me_group
(
ch
, 
viùim
->
fightšg
)) {

3897 
	`¡c
("KÈ¡—lšg i nÙ…”m™‹d.\n", 
ch
);

3901 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 =ğ
viùim
) {

3902 
	`aù
("Buˆ$N i you¸ä›nd!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3906 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
bash
))

3910 
evŞutiÚ_Ëv–
 = 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
bash
);

3916 
	`check_kËr
(
ch
, 
viùim
);

3918 ià(
ch
->
fightšg
 =ğ
nuÎ±r
)

3919 
	`£t_fightšg
(
ch
, 
viùim
);

3922 ià(
	`check_dodge
(
ch
, 
viùim
, 
skl
::
ty³
::
bash
, 0)

3923 || 
	`check_blur
(
ch
, 
viùim
, 
skl
::
ty³
::
bash
, 0)) {

3925 ià(
evŞutiÚ_Ëv–
 < 2) {

3926 
	`aù
("You f®Èæ© oÀyou¸çû!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3927 
	`aù
("$ÀçÎ æ© oÀ$ çû.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

3928 
	`aù
("Youƒvad$n' bash, causšg $mØçÎ fÏˆÚ $ çû.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

3929 
ch
->
pos™iÚ
 = 
POS_RESTING
;

3932 
	`aù
("You miss, buˆmªagtØk“°you¸foÙšg.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3933 
	`aù
("$Àmis£s, buˆk“p $ foÙšg.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

3934 
	`aù
("Youƒvad$n' bash, buˆ$m k“p $ ã‘.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

3937 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
bash
).
b—ts
 * 3 / 2);

3938 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
bash
, 
çl£
, 1);

3943 
chªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
bash
) / 2;

3946 
chªû
 +ğ(
ch
->
size
 - 
viùim
->size) * 10;

3950 
chªû
 -ğ
	`g‘_un¥–Ëd_ac
(
viùim
, 
AC_BASH
) / 50;

3963 
chªû
 +ğ3 * (
	`GET_ATTR_STR
(
ch
è- GET_ATTR_STR(
viùim
));

3965 
chªû
 = chªû * 
	`GET_MAX_STAM
(
viùim
è/ 
¡d
::
	`max
(viùim->
¡am
, 1);

3970 
chªû
 +ğ(
ch
->
Ëv–
 - 
viùim
->level);

3973 
chªû
 +ğ(
evŞutiÚ_Ëv–
 - 1) * 10;

3976 ià(
	`CAN_USE_RSKILL
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
)) {

3977 
chªû
 = chªû * (100 - 
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
));

3978 
chªû
 /= 100;

3981 #ifdeà
DEBUG_CHANCE


3982 
	`±c
(
ch
, "(bash %d%%)", 
chªû
);

3983 
	`±c
(
viùim
, "(bash %d%%)", 
chªû
);

3986 
chªû
 = 
	`URANGE
(5, chance, 95);

3989 ià(
	`numb”_³rûÁ
(è< 
chªû
) {

3990 
kdtime
 = 
	`numb”_¿nge
((
PULSE_VIOLENCE
 + 2), 3 * PULSE_VIOLENCEè+ (
	`g‘_ÿ¼y_weight
(
viùim
) / 400);

3991 
	`aù
("$À£nd you s´awlšg w™h‡…ow”fuÈbash!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

3992 
	`aù
("You sÏm iÁØ$N,‡nd s’d $M flyšg!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3993 
	`aù
("$À£nd $N s´awlšg w™h‡…ow”fuÈbash.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

3994 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
bash
, 
Œue
, 1);

3995 
	`DAZE_STATE
(
viùim
, 
kdtime
);

3996 
	`WAIT_STATE
(
viùim
, 
kdtime
);

3997 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
bash
).
b—ts
);

3998 
	`damage
(
ch
, 
viùim
, 
	`numb”_¿nge
(ch->
Ëv–
 * 2 / 3, (ch->Ëv– * 3 / 2è+ 
chªû
 / 10), 
skl
::
ty³
::
bash
, -1, 
DAM_BASH
, 
Œue
, 
çl£
);

4000 ià(!
viùim
->
	`is_g¬bage
()) {

4001 
viùim
->
pos™iÚ
 = 
POS_RESTING
;

4003 ià(
	`CAN_USE_RSKILL
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
))

4004 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
, 
çl£
, 1);

4008 ià(
ch
->
fightšg
 =ğ
nuÎ±r
è
	`£t_fightšg
(ch, 
viùim
);

4010 
	`aù
("$Àüashe štØyou, buˆç tØaccom¶ish‡nythšg!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

4011 
	`aù
("Youhrow your£làštØ$N, buˆçØknockhem down!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4012 
	`aù
("$À¦am štØ$N, buˆÃ™h” oàthem†o£ theœ foÙšg.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

4013 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
bash
, 
Œue
, 1);

4014 
	`DAZE_STATE
(
viùim
, 
PULSE_VIOLENCE
);

4015 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
bash
).
b—ts
);

4017 ià(
	`CAN_USE_RSKILL
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
))

4018 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
, 
Œue
, 1);

4020 
	}
}

4022 
	$do_dœt
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4024 
Ch¬aù”
 *
viùim
;

4025 
chªû
;

4027 
SŒšg
 
¬g
;

4028 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

4030 ià((
chªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
dœt_kickšg
)) == 0) {

4031 
	`¡c
("You g‘ you¸ã‘ dœty.\n", 
ch
);

4035 ià(
¬g
.
	`em±y
()) {

4036 
viùim
 = 
ch
->
fightšg
;

4038 ià(
viùim
 =ğ
nuÎ±r
) {

4039 
	`¡c
("Buˆyou‡»n'ˆš comb©!\n", 
ch
);

4043 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

4044 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

4048 ià(
	`is_blšded
(
viùim
)) {

4049 
	`aù
("$E ha ®»ady b“Àblšded.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4053 ià(
	`IS_FLYING
(
ch
))

4055 
	`¡c
("How dØyouƒx³ùØkick dœˆwhæyšg?\n", 
ch
);

4059 ià(
viùim
 =ğ
ch
) {

4060 
	`¡c
("V”y fuÂy.\n", 
ch
);

4064 ià(
	`is_§ã
(
ch
, 
viùim
, 
Œue
)) {

4065 
	`¡c
("Th© dÛ¢'ˆ£emØwÜk oÀthi İpÚ’t.\n", 
ch
);

4069 ià(
viùim
->
	`is_Åc
()

4070 && 
viùim
->
fightšg
 !ğ
nuÎ±r


4071 && !
	`is_§me_group
(
ch
, 
viùim
->
fightšg
)) {

4072 
	`¡c
("KÈ¡—lšg i nÙ…”m™‹d.\n", 
ch
);

4076 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 =ğ
viùim
) {

4077 
	`aù
("Buˆ$N i such‡ good fr›nd!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4081 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
dœt_kickšg
))

4086 
chªû
 +ğ
	`GET_ATTR_DEX
(
ch
);

4087 
chªû
 -ğ2 * 
	`GET_ATTR_DEX
(
viùim
);

4090 ià(
ch
->
off_æags
.
	`has
(
OFF_FAST
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
ha¡e
))

4091 
chªû
 += 10;

4093 ià(
viùim
->
off_æags
.
	`has
(
OFF_FAST
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(viùim,‡fãù::
ty³
::
ha¡e
))

4094 
chªû
 -= 25;

4097 
chªû
 +ğ(
ch
->
Ëv–
 - 
viùim
->level) * 2;

4100 ià(
chªû
 % 5 == 0)

4101 
chªû
 += 1;

4104 
ch
->
š_room
->
	`£ùÜ_ty³
()) {

4105 (
SeùÜ
::
šside
): 
chªû
 -= 20; ;

4106 (
SeùÜ
::
c™y
): 
chªû
 -= 10; ;

4107 (
SeùÜ
::
f›ld
): 
chªû
 += 5; ;

4108 (
SeùÜ
::
mouÁaš
): 
chªû
 -= 10; ;

4109 (
SeùÜ
::
w©”_swim
): 
chªû
 = 0; ;

4110 (
SeùÜ
::
w©”_noswim
): 
chªû
 = 0; ;

4111 (
SeùÜ
::
aœ
): 
chªû
 = 0; ;

4112 (
SeùÜ
::
de£¹
): 
chªû
 += 10; ;

4117 ià(
chªû
 == 0) {

4118 
	`¡c
("Th”i¢'ˆªy dœˆtØkick.\n", 
ch
);

4123 
	`check_kËr
(
ch
, 
viùim
);

4125 ià(
	`numb”_³rûÁ
(è< 
chªû
) {

4126 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
¿ybª
)) {

4127 
	`aù
("You kick dœˆš $n' eyes, buˆ™ dÛ¢'ˆafãù $m!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4128 
	`aù
("$Àkick dœˆš you¸eyes, buˆyou¸ey´ÙeùiÚ save you¸visiÚ!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

4131 
	`aù
("$Ài blšded byhdœˆš $ eyes!", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4132 
	`aù
("$Àkick dœˆš you¸eyes!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

4133 
	`damage
(
ch
, 
viùim
, 
	`numb”_¿nge
(2, 5), 
skl
::
ty³
::
dœt_kickšg
, -1, 
DAM_NONE
, 
çl£
, false);

4135 ià(!
viùim
->
	`is_g¬bage
()) {

4136 
	`¡c
("You cª'ˆ£¨thšg!\n", 
viùim
);

4138 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

4139 
afãù
::
ty³
::
dœt_kickšg
,

4140 
ch
->
Ëv–
,

4142 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
dœt_kickšg
),

4143 
çl£


4148 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
dœt_kickšg
, 
Œue
, 2);

4149 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
dœt_kickšg
).
b—ts
);

4152 
	`aù
("You¸kicked dœˆMISSES $N!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4153 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
dœt_kickšg
, 
çl£
, 2);

4154 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
dœt_kickšg
).
b—ts
);

4156 
	}
}

4159 
boŞ
 
	$Œ
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
chªû
, 
skl
::
ty³
 
©ck_skl
)

4163 ià(
ch
->
size
 < 
viùim
->size)

4164 
chªû
 +ğ(
ch
->
size
 - 
viùim
->size) * 10;

4167 
chªû
 +ğ
	`GET_ATTR_DEX
(
ch
);

4168 
chªû
 -ğ
	`GET_ATTR_DEX
(
viùim
) * 3 / 2;

4171 ià(
ch
->
off_æags
.
	`has
(
OFF_FAST
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
ha¡e
))

4172 
chªû
 += 10;

4174 ià(
viùim
->
off_æags
.
	`has
(
OFF_FAST
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(viùim,‡fãù::
ty³
::
ha¡e
))

4175 
chªû
 -= 20;

4178 
chªû
 +ğ(
ch
->
Ëv–
 - 
viùim
->level) * 2;

4180 
	`check_kËr
(
ch
, 
viùim
);

4183 ià(
	`CAN_USE_RSKILL
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
)) {

4184 
chªû
 = chªû * (100 - 
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
));

4185 
chªû
 /= 100;

4188 ià(
	`numb”_³rûÁ
(è< 
chªû
) {

4189 
	`DAZE_STATE
(
viùim
, 2 * 
PULSE_VIOLENCE
);

4190 
	`WAIT_STATE
(
viùim
, 2 * 
PULSE_VIOLENCE
);

4191 
viùim
->
pos™iÚ
 = 
POS_RESTING
;

4192 
	`damage
(
ch
, 
viùim
, 
	`numb”_¿nge
(2, 2 + 2 * viùim->
size
), 
©ck_skl
, -1, 
DAM_BASH
, 
Œue
, 
çl£
);

4194 ià(!
viùim
->
	`is_g¬bage
()) {

4195 ià(
	`CAN_USE_RSKILL
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
))

4196 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
, 
çl£
, 1);

4199  
Œue
;

4202 
	`damage
(
ch
, 
viùim
, 0, 
©ck_skl
, -1, 
DAM_BASH
, 
Œue
, 
çl£
);

4204 ià(!
viùim
->
	`is_g¬bage
()) {

4205 ià(
	`CAN_USE_RSKILL
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
))

4206 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
, 
Œue
, 1);

4209  
çl£
;

4211 
	}
}

4213 
	$do_Œ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4215 
Ch¬aù”
 *
viùim
;

4216 
chªû
;

4218 
SŒšg
 
¬g
;

4219 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

4221 ià((
chªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
Œ
)) == 0) {

4222 
	`¡c
("Trpšg? Wh©' th©?\n", 
ch
);

4226 ià(
¬g
.
	`em±y
()) {

4227 
viùim
 = 
ch
->
fightšg
;

4229 ià(
viùim
 =ğ
nuÎ±r
) {

4230 
	`¡c
("Buˆyou‡»n'ˆfightšg‡nyÚe!\n", 
ch
);

4235 
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
);

4237 ià(
viùim
 =ğ
nuÎ±r
) {

4238 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

4243 ià(
	`is_§ã
(
ch
, 
viùim
, 
Œue
))

4246 ià(
viùim
->
	`is_Åc
()

4247 && 
viùim
->
fightšg
 !ğ
nuÎ±r


4248 && !
	`is_§me_group
(
ch
, 
viùim
->
fightšg
)) {

4249 
	`¡c
("KÈ¡—lšg i nÙ…”m™‹d.\n", 
ch
);

4253 ià(
	`IS_FLYING
(
viùim
)) {

4254 
	`aù
("$S f“ˆ¬’'ˆÚhground.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4258 ià(
	`g‘_pos™iÚ
(
viùim
è< 
POS_FIGHTING
) {

4259 
	`aù
("$N i ®»ady down.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4263 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 =ğ
viùim
) {

4264 
	`aù
("$N i you¸b–oved ma¡”.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4268 ià(
viùim
 =ğ
ch
) {

4269 
	`¡c
("You f®Èæ© oÀyou¸çû!\n", 
ch
);

4270 
	`WAIT_STATE
(
ch
, 2 * 
skl
::
	`lookup
(skl::
ty³
::
Œ
).
b—ts
);

4271 
	`aù
("$ÀŒ ov” $ owÀã‘!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4275 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
Œ
))

4278 ià(
	`Œ
(
ch
, 
viùim
, 
chªû
, 
skl
::
ty³
::
Œ
)) {

4279 
	`aù
("$ÀŒ you‡nd you gØdown!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

4280 
	`aù
("Your $N‡nd $E gÛ down!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4281 
	`aù
("$ÀŒ $N, s’dšg $MØthground.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

4282 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
Œ
, 
Œue
, 1);

4283 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
Œ
).
b—ts
);

4286 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
Œ
, 
çl£
, 1);

4287 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
Œ
).
b—ts
 * 2 / 3);

4289 
	}
}

4291 
boŞ
 
	$check_©ck_ok
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
) {

4292 ià((
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
è&& (!
b©e
.
¡¬t
)) {

4293 
	`¡c
("HŞd you¸hÜ£s,hb©ha¢'ˆbeguÀy‘!\n", 
ch
);

4294  
çl£
;

4297 ià(
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
ACT_MORPH
è&& !
viùim
->is_npc()) {

4298 
	`¡c
("MÜphed…Ïy” ÿÂÙ‡‰ack PC's.\n", 
ch
);

4299 
	`wizÃt
("$N i ©‹m±šg PK whmÜphed.", 
ch
, 
nuÎ±r
, 
WIZ_CHEAT
, 0, 
	`GET_RANK
(ch));

4300  
çl£
;

4303 ià(
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
ACT_MORPH
è&& 
viùim
->aù_æags.has(
ACT_PET
)) {

4304 
	`¡c
("MÜphed…Ïy” ÿÂÙ‡‰ack…‘s.\n", 
ch
);

4305 
	`wizÃt
("$N i ©‹m±šgØkÈ¨³ˆwhmÜphed.", 
ch
, 
nuÎ±r
, 
WIZ_CHEAT
, 0, 
	`GET_RANK
(ch));

4306  
çl£
;

4309 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ã¬
)) {

4310 
	`¡c
("Buˆthey would b—ˆth¡uffšg ouˆoàyou!!\n", 
ch
);

4311  
çl£
;

4314 ià(
viùim
 =ğ
ch
) {

4315 
	`¡c
("I b–›vyou‡» sufãršg from‡ md ca£ oàschizİh»nŸ.\n", 
ch
);

4316  
çl£
;

4319 ià(
	`is_§ã
(
ch
, 
viùim
, 
Œue
))

4320  
çl£
;

4322 ià(
viùim
->
fightšg
 !ğ
nuÎ±r


4323 && !
	`is_§me_group
(
ch
, 
viùim
->
fightšg
)) {

4324 
	`¡c
("KÈ¡—lšg i nÙ…”m™‹d.\n", 
ch
);

4325  
çl£
;

4328 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 =ğ
viùim
) {

4329 
	`aù
("$N i you¸b–oved ma¡”.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4330  
çl£
;

4333  
Œue
;

4334 
	}
}

4336 
	$do_kl
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4338 
Ch¬aù”
 *
viùim
;

4340 ià(
¬gum’t
.
	`em±y
()) {

4341 
	`¡c
("KÈwhom?\n", 
ch
);

4345 
SŒšg
 
¬g
;

4346 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

4349 ià(
	`CAN_USE_RSKILL
(
ch
, 
skl
::
ty³
::
blšd_fight
)) {

4350 
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 0);

4352 ià(!
viùim
) {

4353 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

4358 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

4359 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

4364 ià(!
	`check_©ck_ok
(
ch
, 
viùim
))

4367 ià(
ch
->
fightšg
) {

4368 
	`¡c
("You dØthbe¡ you cª!\n", 
ch
);

4372 
	`WAIT_STATE
(
ch
, 1 * 
PULSE_VIOLENCE
);

4373 
	`check_kËr
(
ch
, 
viùim
);

4374 
	`muÉi_h™
(
ch
, 
viùim
, 
skl
::
ty³
::
unknown
);

4375 
	}
}

4378 
	$do_b©e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4380 
buf
[
MAX_STRING_LENGTH
];

4381 
low
, 
high
, 
ãe
;

4382 
Room
 *
loÿtiÚ
;

4383 
DesütÜ
 *
d
;

4384 
Ch¬aù”
 *
ach
;

4386 ià(
ch
->
	`is_Åc
())

4389 ià(
	`IS_IMMORTAL
(
ch
)) {

4390 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
;

4391 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

4392 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

4393 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g3
);

4395 ià(!
	`¡rcmp
(
¬g1
, "start")) {

4396 ià(
b©e
.
issued
) {

4397 
	`¡c
("Thb©begšs!\n", 
ch
);

4398 
b©e
.
¡¬t
 = 
Œue
;

4399 
FÜm©
::
	`¥rštf
(
buf
, "[FYI] $n has closedhe‡rena‡nd battle has begun.\n");

4400 
	`glob®_aù
(
ch
, 
buf
, 
Œue
, 
RED
, 
COMM_QUIET
 | 
COMM_NOANNOUNCE
);

4404 
	`¡c
("NØb©ha b“Àissued y‘.\n", 
ch
);

4409 ià(!
	`¡rcmp
(
¬g1
, "stop")) {

4410 ià(
b©e
.
issued
) {

4411 
	`¡c
("Thb©’ds. Bsu»Ø‹ËpÜˆthviùÜ ouˆoàth¬’a.\n", 
ch
);

4412 
b©e
.
¡¬t
 = 
çl£
;

4413 
b©e
.
issued
 = 
çl£
;

4414 
b©e
.
ãe
 = 0;

4415 
b©e
.
low
 = 0;

4416 
b©e
.
high
 = 0;

4420 
	`¡c
("Th”i nØb©tØ¡İ y‘.\n", 
ch
);

4425 ià(!
	`¡rcmp
(
¬g1
, "status")) {

4426 
	`¡c
("B©¡©u i a fŞlows:\n", 
ch
);

4428 ià(!
b©e
.
issued
) {

4429 
	`¡c
("NØb©š…rog»ss.\n", 
ch
);

4433 
	`±c
(
ch
, "Rªge: %d - %d\n", 
b©e
.
low
, b©e.
high
);

4434 
	`±c
(
ch
, "F“: %d sv”\n", 
b©e
.
ãe
);

4435 
	`¡c
("A ch®Ëngha b“Àissued.\n", 
ch
);

4437 ià(
b©e
.
¡¬t
)

4438 
	`¡c
("A b©i š…rog»ss.\n", 
ch
);

4441 
	`¡c
("PÏy” cu¼’y iÀthA»Ç:\n", 
ch
);

4443 
d
 = 
desütÜ_li¡
; d; d = d->
Ãxt
) {

4444 
ach
 = 
d
->
ch¬aù”
;

4446 ià(
d
->
	`is_¶ayšg
()

4447 && !
ach
->
	`is_Åc
()

4448 && 
ach
->
š_room
 !ğ
nuÎ±r


4449 && 
ach
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


4450 && 
	`ÿn_£e_ch¬
(
ch
, 
ach
))

4451 
	`±c
(
ch
, "{G[%3d] {P%s{x\n", 
ach
->
Ëv–
,‡ch->
Çme
);

4457 ià(
b©e
.
issued
) {

4458 
	`¡c
("A b©i ®»ady iÀ´og»ss.\n", 
ch
);

4462 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.em±y(è|| 
¬g3
.empty()) {

4463 
	`¡c
("SyÁax: <low> <high> <ãe>\n", 
ch
);

4467 ià(!
¬g1
.
	`is_numb”
(è|| !
¬g2
.is_numb”(è|| !
¬g3
.is_number()) {

4468 
	`¡c
("V®ue mu¡ bnum”ic.\n", 
ch
);

4472 ià((
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_ARENACENTER
)))è=ğ
nuÎ±r
) {

4473 
	`¡c
("Th¬’¨i missšg.\n", 
ch
);

4477 
couÁ
 = 
loÿtiÚ
->
	`¬—
().
	`num_¶ay”s
();

4478 ià(
couÁ
 > 0) {

4479 
	`±c
(
ch
, "You‚“dØş—¸%d ch¬aù” fromh¬’¨fœ¡.\n", 
couÁ
);

4483 
low
 = 
	`©oi
(
¬g1
);

4484 
high
 = 
	`©oi
(
¬g2
);

4485 
ãe
 = 
	`©oi
(
¬g3
);

4487 ià((
low
 < 0 ||†ow > 100è|| (
high
 < 0 || high > 100)) {

4488 
	`¡c
("Lev–„ªge ¬0Ø100.\n", 
ch
);

4492 ià(
ãe
 < 0 || fee > 100000) {

4493 
	`¡c
("F“„ªge i 0Ø10000.\n", 
ch
);

4497 
b©e
.
low
 =†ow;

4498 
b©e
.
high
 = high;

4499 
b©e
.
ãe
 = fee;

4500 
b©e
.
issued
 = 
Œue
;

4501 
	`±c
(
ch
, "You openhe‡renao†evels %do %d, fee %d silver\n",

4502 
b©e
.
low
, b©e.
high
, b©e.
ãe
);

4503 
FÜm©
::
	`¥rštf
(
buf
, "[FYI] $n has openedhe‡renao†evels %d - %d for‡ %d silver fee.\n",

4504 
b©e
.
low
, b©e.
high
, b©e.
ãe
);

4505 
	`glob®_aù
(
ch
, 
buf
, 
Œue
, 
RED
, 
COMM_QUIET
 | 
COMM_NOANNOUNCE
);

4508 ià(
	`ch¬_š_du–
(
ch
)) {

4509 
	`¡c
("D—Èw™hhi b©fœ¡.\n", 
ch
);

4513 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
) {

4514 
	`¡c
("You‡»‡Ì—dy w™hšhw®l oàth¬’a.\n", 
ch
);

4518 ià(!
b©e
.
issued
) {

4519 
	`¡c
("NØch®Ëngha b“Àissued by‡ÀimmÜl.\n", 
ch
);

4523 ià(
b©e
.
¡¬t
) {

4524 
	`¡c
("Thb©ha ®»ady begun,ry‡gaš†©”.\n", 
ch
);

4528 ià((
ch
->
Ëv–
 < 
b©e
.
low
è|| (ch->Ëv– > b©e.
high
)) {

4529 
	`¡c
("You‡»‚Ù w™hšhËv–„ªgfÜ b©e.\n", 
ch
);

4533 ià((
ch
->
sv”
 + 100 * ch->
gŞd
è< 
b©e
.
ãe
) {

4534 
	`¡c
("You cªnÙ‡ffÜdØ’gagš b©e.\n", 
ch
);

4538 ià((
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_ARENACENTER
)))è=ğ
nuÎ±r
) {

4539 
	`¡c
("Th¬’¨i missšg.\n", 
ch
);

4543 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

4546 ià(
ch
->
fightšg
 !ğ
nuÎ±r
) {

4547 
	`¡c
("Buˆyou‡»‡Ì—dy iÀcomb©!\n", 
ch
);

4551 
	`aù
("$ÀÿckË a $i ‹ËpÜ‹dØth¬’a.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4552 
	`ch¬_äom_room
(
ch
);

4553 
	`ch¬_to_room
(
ch
, 
loÿtiÚ
);

4554 
	`deduù_co¡
(
ch
, 
b©e
.
ãe
);

4555 
	`aù
("$À’‹r th¬’¨ªd…»·» tØd¿w blood.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4556 
	`¡c
("You havb“À‹ËpÜ‹dØth¬’a.\n", 
ch
);

4557 
FÜm©
::
	`¥rštf
(
buf
, "% ha jošedhb©šh¬’a.\n", 
ch
->
Çme
);

4558 
	`do_£nd_ªnounû
(
ch
, 
buf
);

4559 
	`do_look
(
ch
, "auto");

4561 
	}
}

4564 
	$do_sšg
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4566 
Ch¬aù”
 *
viùim
;

4567 
sšgchªû
;

4569 ià(
¬gum’t
.
	`em±y
()) {

4570 
	`¡c
("You sšg‡ sim¶m–ody fÜ‡ÎØ’joy.\n", 
ch
);

4574 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬gum’t
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

4575 
	`¡c
("NØÚbyh©‚ami h”tØsšgo.\n", 
ch
);

4579 ià(
	`is_§ã
(
ch
, 
viùim
, 
Œue
))

4582 ià(
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_LAW
)) {

4583 
	`¡c
("ThmayÜ dÛ nÙ‡µrovoàyou¸¶ayšg styË.\n", 
ch
);

4587 ià(
viùim
 =ğ
ch
) {

4588 
	`¡c
("You‡»‡ÀexûÎªˆmusicŸn, B¿vo!!\n", 
ch
);

4592 ià(!
viùim
->
	`is_Åc
()) {

4593 
	`¡c
("They ignÜyou¸sšgšg.\n", 
ch
);

4597 
	`¡c
("You sšg‡ b—utifuÈm–ody.\n", 
ch
);

4599 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
sšg
))

4602 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
sšg
))

4605 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
sšg
).
b—ts
);

4607 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ch¬m_³rsÚ
)

4608 || 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
))

4611 
sšgchªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
sšg
) / 2;

4614 ià(
ch
->
Ëv–
 < 
viùim
->level)

4615 
sšgchªû
 -ğ(
viùim
->
Ëv–
 - 
ch
->level) * 4;

4617 
sšgchªû
 +ğ(
ch
->
Ëv–
 - 
viùim
->level) * 2;

4620 
sšgchªû
 +ğ
ch
->
pcd©a
->
»mÜt_couÁ
 / 2;

4622 
sšgchªû
 +ğ(
	`GET_ATTR_CHR
(
ch
));

4623 
sšgchªû
 -ğ(
	`GET_ATTR_INT
(
viùim
è+ 
	`GET_ATTR_WIS
(victim)) / 2;

4625 ià(!
ch
->
	`is_Åc
(è&& ch->
gud
 =ğ
Gud
::
b¬d
)

4626 
sšgchªû
 += singchance / 3;

4628 
sšgchªû
 -ğsšgchªû * 
	`GET_DEFENSE_MOD
(
viùim
, 
DAM_CHARM
) / 100;

4631 
sšgchªû
 = 
	`URANGE
(0, sšgchªû, (101 - (
viùim
->
Ëv–
 / 2)));

4634 ià(!
	`rŞl_chªû
(
sšgchªû
)) {

4636 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
sšg
, 
çl£
, 8);

4640 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
sšg
, 
Œue
, 8);

4643 ià(
viùim
->
ma¡”
)

4644 
	`¡İ_fŞlow”
(
viùim
);

4646 
	`add_fŞlow”
(
viùim
, 
ch
);

4647 
viùim
->
Ëad”
 = 
ch
;

4649 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

4650 
afãù
::
ty³
::
ch¬m_³rsÚ
,

4651 
ch
->
Ëv–
,

4652 
	`numb”_fuzzy
(
ch
->
Ëv–
/4),

4653 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
ch¬m_³rsÚ
),

4654 
çl£


4657 
	`aù
("I¢'ˆ$n' musiøb—utiful?", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

4659 ià(
ch
 !ğ
viùim
)

4660 
	`aù
("$N„—Îy†ove you¸music.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4663 
	}
}

4665 
	$do_back¡ab
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4667 
Ch¬aù”
 *
viùim
;

4668 
Objeù
 *
obj
;

4669 
evo
 = 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
back¡ab
);

4671 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
back¡ab
)) {

4672 
	`do_huh
(
ch
);

4676 ià(
¬gum’t
.
	`em±y
()) {

4677 
	`¡c
("Back¡ab whom?\n", 
ch
);

4681 
SŒšg
 
¬g
;

4682 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

4684 ià(
ch
->
fightšg
 !ğ
nuÎ±r
) {

4685 
	`¡c
("You'» facšghwrÚgƒnd.\n", 
ch
);

4688 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

4689 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

4693 ià(
viùim
 =ğ
ch
) {

4694 
	`¡c
("How cª you sÃak u°Ú your£lf?\n", 
ch
);

4698 ià(
	`is_§ã
(
ch
, 
viùim
, 
Œue
))

4701 ià(
viùim
->
	`is_Åc
()

4702 && 
viùim
->
fightšg
 !ğ
nuÎ±r


4703 && !
	`is_§me_group
(
ch
, 
viùim
->
fightšg
)) {

4704 
	`¡c
("KÈ¡—lšg i nÙ…”m™‹d.\n", 
ch
);

4708 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
)è=ğ
nuÎ±r
) {

4709 
	`¡c
("You‚“dØw›ld‡ w—pÚØback¡ab.\n", 
ch
);

4713 ià(
viùim
->
h™
 < 
	`GET_MAX_HIT
(victim)) {

4714 
	`aù
("$N i hu¹‡nd su¥iciou ... you cª'ˆ¢—k up.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4718 ià(
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
ACT_MORPH
è&& !
viùim
->is_npc()) {

4719 
	`¡c
("MÜphed…Ïy” ÿÂÙ back¡ab PC's.\n", 
ch
);

4720 
	`wizÃt
("$N i ©‹m±šg PK whmÜphed.", 
ch
, 
nuÎ±r
, 
WIZ_CHEAT
, 0, 
	`GET_RANK
(ch));

4724 ià(
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
ACT_MORPH
è&& 
viùim
->aù_æags.has(
ACT_PET
)) {

4725 
	`¡c
("MÜphed…Ïy” ÿÂÙ back¡ab…‘s.\n", 
ch
);

4726 
	`wizÃt
("$N i ©‹m±šgØkÈ¨³ˆwhmÜphed.", 
ch
, 
nuÎ±r
, 
WIZ_CHEAT
, 0, 
	`GET_RANK
(ch));

4730 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
back¡ab
))

4733 ià(
ch
->
	`is_Åc
()) {

4734 
	`mob_h™
(
ch
, 
viùim
, 
skl
::
ty³
::
back¡ab
);

4738 
	`check_kËr
(
ch
, 
viùim
);

4739 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
back¡ab
).
b—ts
);

4741 ià(
	`numb”_³rûÁ
(è< 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
back¡ab
)

4742 || (
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
back¡ab
è>ğ2 && !
	`IS_AWAKE
(
viùim
))) {

4743 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
back¡ab
, 
Œue
, 4);

4744 
	`muÉi_h™
(
ch
, 
viùim
, 
skl
::
ty³
::
back¡ab
);

4745 ià(
evo
 >=3 && 
	`rŞl_chªû
(50)) {

4747 
	`¡c
("{YYou¸sklfuÈblow sŒike ¨ÃrvÚ you¸İpÚ’t!{x\n", 
ch
);

4748 
Ëv–
 = (
ch
->level);

4749 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

4750 
afãù
::
ty³
::
·¿lyze
,

4751 
Ëv–
,

4754 
çl£


4759 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
back¡ab
, 
çl£
, 4);

4760 
	`damage
(
ch
, 
viùim
, 0, 
skl
::
ty³
::
back¡ab
, -1, 
DAM_NONE
, 
Œue
, 
çl£
);

4762 
	}
}

4765 
	$do_shadow
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4767 
Ch¬aù”
 *
viùim
;

4768 
Objeù
 *
obj
;

4770 ià(!
	`CAN_USE_RSKILL
(
ch
, 
skl
::
ty³
::
shadow_fÜm
)) {

4771 
	`¡c
("Huh?\n", 
ch
);

4775 ià(
ch
->
fightšg
 =ğ
nuÎ±r
) {

4776 
	`¡c
("You mu¡ bfightšg iÀÜd”Ø’‹¸shadow fÜm.\n", 
ch
);

4780 
SŒšg
 
¬g
;

4781 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

4783 ià(
¬g
.
	`em±y
())

4784 
viùim
 = 
ch
->
fightšg
;

4786 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

4787 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

4791 ià(
viùim
->
fightšg
 =ğ
nuÎ±r
 || !
	`is_§me_group
(
ch
, victim->fighting)) {

4792 
	`¡c
("You‡»‚Ù fightšgh© oµÚ’t.\n", 
ch
);

4797 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
shadow_fÜm
)) {

4798 
	`aù
("$N ha £’ shadow fÜm befÜªd couldƒasy‡voidh©ck.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4802 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
)è=ğ
nuÎ±r
) {

4803 
	`¡c
("You‚“dØw›ld‡ w—pÚ fÜ shadow fÜmØdØªy h¬m!\n", 
ch
);

4807 
	`check_kËr
(
ch
, 
viùim
);

4809 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
shadow_fÜm
))

4812 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
shadow_fÜm
).
b—ts
);

4814 ià(
	`numb”_³rûÁ
(è< 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
shadow_fÜm
)) {

4815 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
shadow_fÜm
, 
Œue
, 1);

4816 
	`muÉi_h™
(
ch
, 
viùim
, 
skl
::
ty³
::
shadow_fÜm
);

4819 
	`¡c
("YouƒÁ” shadow fÜm, buˆyou¸rg‘‡void you¸¡rike.\n", 
ch
);

4820 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
shadow_fÜm
, 
çl£
, 1);

4821 
	`damage
(
ch
, 
viùim
, 0, 
skl
::
ty³
::
shadow_fÜm
, -1, 
DAM_NONE
, 
Œue
, 
çl£
);

4824 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

4825 
afãù
::
ty³
::
shadow_fÜm
,

4826 
ch
->
Ëv–
,

4828 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
shadow_fÜm
),

4829 
çl£


4831 
	}
}

4833 
	$do_cœşe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4835 
Ch¬aù”
 *
viùim
;

4836 
Objeù
 *
obj
;

4838 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
cœşe
)) {

4839 
	`¡c
("YouwœÈ¬ound i ¨cœşe! wh““!!!!\n", 
ch
);

4843 ià(
ch
->
fightšg
 =ğ
nuÎ±r
) {

4844 
	`¡c
("You mu¡ bfightšg iÀÜd”Øcœşe.\n", 
ch
);

4848 
SŒšg
 
¬g
;

4849 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

4851 ià(
¬g
.
	`em±y
())

4852 
viùim
 = 
ch
->
fightšg
;

4854 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

4855 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

4859 ià(
viùim
->
fightšg
 =ğ
nuÎ±r
 || !
	`is_§me_group
(
ch
, victim->fighting)) {

4860 
	`¡c
("You‡»‚Ù fightšgh© oµÚ’t.\n", 
ch
);

4865 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
)è=ğ
nuÎ±r
) {

4866 
	`¡c
("You‚“dØw›ld‡ w—pÚØcœşe.\n", 
ch
);

4870 
	`check_kËr
(
ch
, 
viùim
);

4872 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
cœşe
))

4875 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
cœşe
).
b—ts
);

4877 ià(
	`numb”_³rûÁ
(è< 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
cœşe
)) {

4878 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
cœşe
, 
Œue
, 1);

4879 
	`muÉi_h™
(
ch
, 
viùim
, 
skl
::
ty³
::
cœşe
);

4882 
	`¡c
("You cœşyou¸İpÚ’t, buˆyou¸ha¡y sŒikmis£s.\n", 
ch
);

4883 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
cœşe
, 
çl£
, 1);

4884 
	`damage
(
ch
, 
viùim
, 0, 
skl
::
ty³
::
cœşe
, -1, 
DAM_NONE
, 
Œue
, 
çl£
);

4886 
	}
}

4888 
	$do_æ“
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4890 
Ex™
 *
³x™
;

4891 
Room
 *
was_š
;

4892 
Room
 *
now_š
;

4893 
Ch¬aù”
 *
viùim
, *
vch
;

4894 
Ch¬aù”
 *
huÁed
;

4895 
dex
, 
tİp
 = 0, 
chªû
, 
dœ
;

4897 
weight
, 
wis
;

4899 ià(
ch
->
wa™
 > 0)

4902 ià((
viùim
 = 
ch
->
fightšg
è=ğ
nuÎ±r
) {

4903 
	`¡c
("You‡»n'ˆfightšg‡nyÚe.\n", 
ch
);

4907 ià(
	`g‘_pos™iÚ
(
ch
è< 
POS_FIGHTING
) {

4908 
	`¡c
("You'Î havtØg‘ u°fœ¡!\n", 
ch
);

4914 
dex
 = 
	`GET_ATTR_DEX
(
ch
);

4915 
wis
 = 
	`GET_ATTR_WIS
(
ch
);

4916 
weight
 = 
	`g‘_ÿ¼y_weight
(
ch
);

4918 
weight
 = weight / 1000;

4923 
chªû
 = ((
dex
 - 9è* 6è- 
weight
;

4924 
chªû
 +ğ(
wis
 - 9) * 6;

4925 
chªû
 = chance / 2;

4927 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = vch->
Ãxt_š_room
) {

4928 ià(
vch
->
fightšg
 !ğ
ch
)

4932 
chªû
 +ğ((
dex
 - 
	`GET_ATTR_DEX
(
vch
)) * 5) +

4933 ((
wis
 - 
	`GET_ATTR_WIS
(
vch
)) * 5) /

4936 ià(
tİp
)

4937 
chªû
 -= 10;

4939 
tİp
++;

4942 
tİp
 = 0;

4943 
was_š
 = 
ch
->
š_room
;

4946 
dœ
 = 0; dir < 6; dir++) {

4947 ià((
³x™
 = 
was_š
->
ex™
[
dœ
]) == 0

4948 || 
³x™
->
to_room
 =ğ
nuÎ±r


4949 || !
	`ÿn_£e_room
(
ch
, 
³x™
->
to_room
)

4950 || (
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
)

4951 && (!
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
·ss_doÜ
)

4952 || 
³x™
->
ex™_æags
.
	`has
(
EX_NOPASS
)))

4953 || (
ch
->
	`is_Åc
(è&& 
³x™
->
to_room
->
	`æags
().
	`has
(
ROOM_NO_MOB
)))

4956 
tİp
++;

4960 ià(
tİp
)

4961 
chªû
 /ğ
tİp
;

4963 
	`¡c
("Th”i nowh”tØrun!\n", 
ch
);

4967 
chªû
 = 
	`URANGE
(10, chance, 90);

4969 
dœ
 = 0; dir < 6; dir++) {

4970 ià((
³x™
 = 
was_š
->
ex™
[
dœ
]) == 0

4971 || 
³x™
->
to_room
 =ğ
nuÎ±r


4972 || !
	`ÿn_£e_room
(
ch
, 
³x™
->
to_room
)

4973 || (
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
)

4974 && (!
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
·ss_doÜ
)

4975 || 
³x™
->
ex™_æags
.
	`has
(
EX_NOPASS
)))

4976 || (
ch
->
	`is_Åc
(è&& 
³x™
->
to_room
->
	`æags
().
	`has
(
ROOM_NO_MOB
)))

4979 ià(!
	`rŞl_chªû
(
chªû
))

4982 
	`move_ch¬
(
ch
, 
dœ
, 
çl£
);

4984 ià((
now_š
 = 
ch
->
š_room
è=ğ
was_š
)

4987 
	`¡İ_fightšg
(
ch
, 
Œue
);

4988 
ch
->
š_room
 = 
was_š
;

4989 
	`aù
("$Àha æed!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4990 
ch
->
š_room
 = 
now_š
;

4992 ià(!
ch
->
	`is_Åc
()) {

4993 
	`aù
("You fË$T from comb©!", 
ch
, 
nuÎ±r
, 
Ex™
::
	`dœ_Çme
(
dœ
), 
TO_CHAR
);

4995 ià(
ch
->
gud
 =ğ
Gud
::
th›f
)

4996 
	`¡c
("You snuck‡way saãly.\n", 
ch
);

4998 ià(
ch
->
gud
 =ğ
Gud
::
·Ïdš
) {

4999 
	`¡c
("You†o£ 50ƒxp.\n", 
ch
);

5000 
	`gaš_exp
(
ch
, -50);

5003 
	`¡c
("You†o£ 10ƒxp.\n", 
ch
);

5004 
	`gaš_exp
(
ch
, -10);

5009 ià(
viùim
->
	`is_Åc
(è&& (viùim->
aù_æags
.
	`has
(
ACT_AGGRESSIVE
))) {

5010 ià((
huÁed
 = 
	`g‘_ch¬_¬—
(
viùim
, 
ch
->
Çme
, 
VIS_CHAR
)è!ğ
nuÎ±r
) {

5011 
viùim
->
huÁšg
 = 
huÁed
;

5012 
	`WAIT_STATE
(
viùim
, 3 * 
PULSE_VIOLENCE
);

5019 
	`WAIT_STATE
(
ch
, 
PULSE_VIOLENCE
 * 2 / 3);

5020 
	`¡c
("PANIC! You couldn'ˆesÿ³!\n", 
ch
);

5021 
	}
}

5023 
	$do_»scue
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5025 
Ch¬aù”
 *
viùim
;

5026 
Ch¬aù”
 *
fch
;

5028 ià(
¬gum’t
.
	`em±y
()) {

5029 
	`¡c
("Rescuwhom?\n", 
ch
);

5033 
SŒšg
 
¬g
;

5034 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

5036 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

5037 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

5041 ià(
viùim
 =ğ
ch
) {

5042 
	`¡c
("Wh©‡bouˆæ“šg in¡—d?\n", 
ch
);

5046 ià(
ch
->
fightšg
 =ğ
viùim
) {

5047 
	`¡c
("You dÚ'ˆÃedØ»scuthem from your£lf.\n", 
ch
);

5051 ià(!
	`is_§me_group
(
ch
, 
viùim
)) {

5052 
	`¡c
("KÈ¡—lšg i nÙ…”m™‹d.\n", 
ch
);

5056 ià(
viùim
->
fightšg
 =ğ
nuÎ±r
) {

5057 
	`¡c
("Th©…”sÚ i nÙ fightšg„ighˆnow.\n", 
ch
);

5063 
fch
 = 
ch
->
š_room
->
³İË
; fch !ğ
nuÎ±r
; fch = fch->
Ãxt_š_room
)

5064 ià(
fch
->
fightšg
 =ğ
viùim
)

5067 ià(
fch
 =ğ
nuÎ±r
) {

5068 
	`¡c
("NØÚi ©ckšgh©…”sÚ„ighˆnow.\n", 
ch
);

5072 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
»scue
))

5075 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
»scue
).
b—ts
);

5077 ià(
	`numb”_³rûÁ
(è> 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
»scue
)) {

5078 
	`¡c
("You fah»scue.\n", 
ch
);

5079 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
»scue
, 
çl£
, 1);

5083 
	`aù
("You„escu$N!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5084 
	`aù
("$À»scue you!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

5085 
	`aù
("$À»scue $N!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

5086 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
»scue
, 
Œue
, 1);

5087 
	`¡İ_fightšg
(
fch
, 
çl£
);

5088 
	`¡İ_fightšg
(
viùim
, 
çl£
);

5089 
	`¡İ_fightšg
(
ch
, 
çl£
);

5090 
	`check_kËr
(
ch
, 
fch
);

5091 
	`£t_fightšg
(
ch
, 
fch
);

5092 
	`£t_fightšg
(
fch
, 
ch
);

5093 
	}
}

5095 
	$do_kick
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5097 
Ch¬aù”
 *
viùim
;

5098 
skl
, 
amouÁ
;

5100 ià((
skl
 = 
	`g‘_skl_Ëv–
(
ch
, skl::
ty³
::
kick
)) == 0) {

5101 
	`¡c
("You'd b‘‹¸Ëavthm¬tŸÈ¬t tØfigh‹rs.\n", 
ch
);

5105 ià((
viùim
 = 
ch
->
fightšg
è=ğ
nuÎ±r
) {

5106 
	`¡c
("You‡»n'ˆfightšg‡nyÚe.\n", 
ch
);

5110 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
kick
))

5113 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
kick
).
b—ts
);

5114 
	`check_kËr
(
ch
, 
viùim
);

5116 ià(
skl
 >ğ
	`numb”_³rûÁ
()) {

5117 
amouÁ
 = 
	`numb”_¿nge
((
ch
->
Ëv–
 / 3), ch->level);

5118 
amouÁ
 +ğ
	`GET_ATTR_DAMROLL
(
ch
);

5120 ià(
	`g‘_pos™iÚ
(
viùim
è< 
POS_FIGHTING
)

5121 
amouÁ
 =‡mount * 5 / 4;

5123 
	`damage
(
ch
, 
viùim
, 
amouÁ
, 
skl
::
ty³
::
kick
, -1, 
DAM_BASH
, 
Œue
, 
çl£
);

5125 ià(
viùim
->
	`is_g¬bage
())

5128 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
kick
, 
Œue
, 1);

5129 
evo
 = 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
kick
);

5131 ià(
evo
 >= 2) {

5132 ià(
	`g‘_pos™iÚ
(
viùim
è=ğ
POS_FIGHTING


5133 && 
	`rŞl_chªû
((
evo
 - 1) * 20 + 10)) {

5134 
	`¡c
("You bršg you¸foÙ‡round fÜ‡ secÚd h™.\n", 
ch
);

5135 
	`damage
(
ch
, 
viùim
, 
amouÁ
, 
skl
::
ty³
::
roundhou£
, -1, 
DAM_BASH
, 
Œue
, 
çl£
);

5136 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
kick
, 
Œue
, 1);

5140 ià(
viùim
->
	`is_g¬bage
())

5143 ià(
evo
 >= 3) {

5144 ià(
	`g‘_pos™iÚ
(
viùim
è=ğ
POS_FIGHTING


5145 && !
	`IS_FLYING
(
viùim
)

5146 && 
	`rŞl_chªû
(30)) {

5147 ià(
	`Œ
(
ch
, 
viùim
, 
skl
, skl::
ty³
::
foÙsw“p
)) {

5148 
	`aù
("$Àsw“p you¸ã‘ ouˆäom und” you!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

5149 
	`aù
("You sw“°$N' ã‘‡nd $E gÛ down!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5150 
	`aù
("$ÀŒ $N, s’dšg $MØthground.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

5161 
	`damage
(
ch
, 
viùim
, 0, 
skl
::
ty³
::
kick
, -1, 
DAM_BASH
, 
Œue
, 
çl£
);

5162 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
kick
, 
çl£
, 1);

5164 
	}
}

5166 
	$do_üush
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5168 
Ch¬aù”
 *
viùim
;

5170 ià(!
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
üush
)) {

5171 
	`¡c
("You‡»‚Ù skËd‡ˆg¿µlšg.\n", 
ch
);

5175 ià((
viùim
 = 
ch
->
fightšg
è=ğ
nuÎ±r
) {

5176 
	`¡c
("You‡»n'ˆfightšg‡nyÚe.\n", 
ch
);

5180 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
üush
).
b—ts
);

5182 ià(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
üush
è> 
	`numb”_³rûÁ
()) {

5183 
	`damage
(
ch
, 
viùim
, 
	`numb”_¿nge
(3, 3 * ch->
Ëv–
), 
skl
::
ty³
::
üush
, -1, 
DAM_BASH
, 
Œue
, 
çl£
);

5184 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
üush
, 
Œue
, 1);

5187 
	`damage
(
ch
, 
viùim
, 0, 
skl
::
ty³
::
üush
, -1, 
DAM_BASH
, 
Œue
, 
çl£
);

5188 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
üush
, 
çl£
, 1);

5191 
	`check_kËr
(
ch
, 
viùim
);

5192 
	}
}

5194 
	$do_di§rm
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5196 
Ch¬aù”
 *
viùim
;

5198 ià(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
di§rm
) <= 0) {

5199 
	`¡c
("You dÚ'ˆknow howØdi§rm oµÚ’ts.\n", 
ch
);

5203 ià(
¬gum’t
.
	`em±y
()) {

5204 ià((
viùim
 = 
ch
->
fightšg
è=ğ
nuÎ±r
) {

5205 
	`¡c
("You‡»n'ˆfightšg‡nyÚe.\n", 
ch
);

5210 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬gum’t
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

5211 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

5215 ià(
viùim
 =ğ
ch
) {

5216 
	`¡c
("And ju¡ how dØyou…ÏÀtØdØth©?\n", 
ch
);

5221 ià(
	`is_§ã
(
ch
, 
viùim
, 
Œue
))

5224 
evo
 = 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
di§rm
);

5227 
blšd_fight_skl
 = 
	`CAN_USE_RSKILL
(
ch
, 
skl
::
ty³
::
blšd_fight
è? 
	`g‘_skl_Ëv–
(ch, skill::type::blind_fight) : 0;

5228 
sight_modif›r
 = 0;

5231 ià(
viùim
->
fightšg
 && viùim->fightšg !ğ
ch
) {

5232 ià(!
ch
->
fightšg
) {

5233 
	`¡c
("They‡»‡Ì—dy iÀcomb©.\n", 
ch
);

5237 ià(
ch
->
fightšg
 !ğ
viùim
) {

5238 
	`¡c
("D—Èw™h you¸owÀfights!\n", 
ch
);

5242 ià(
evo
 < 3) {

5243 
	`¡c
("They dØnÙ hav¨w—pÚ d¿wÀagaš¡ you.\n", 
ch
);

5248 ià(!
	`ÿn_£e_ch¬
(
ch
, 
viùim
))

5249 
sight_modif›r
 -ğ20 * (100 - 
blšd_fight_skl
) / 100;

5253 ià(!
	`ÿn_£e_ch¬
(
ch
, 
viùim
)) {

5254 
evo
) {

5255 1: 
sight_modif›r
 -ğ100 * (100 - 
blšd_fight_skl
) / 100; ;

5256 2: 
sight_modif›r
 -ğ60 * (100 - 
blšd_fight_skl
) / 100; ;

5257 3: 
sight_modif›r
 -ğ30 * (100 - 
blšd_fight_skl
) / 100; ;

5262 ià(
sight_modif›r
 <= -100) {

5263 
	`¡c
("You cª'ˆ£theœ w—pÚ w–È’oughØdi§rmhem.\n", 
ch
);

5267 
Objeù
 *
w—pÚ
 = 
	`g‘_eq_ch¬
(
viùim
, 
WEAR_WIELD
);

5269 ià(
w—pÚ
 =ğ
nuÎ±r
) {

5270 
	`¡c
("You¸İpÚ’ˆi nÙ w›ldšg‡ w—pÚ.\n", 
ch
);

5275 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
è=ğ
nuÎ±r


5276 && 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
hªd_to_hªd
) == 0) {

5277 
	`¡c
("You mu¡ w›ld‡ w—pÚØdi§rm.\n", 
ch
);

5281 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
di§rm
))

5284 
	`damage
(
ch
, 
viùim
, 0, 
skl
::
ty³
::
di§rm
, -1, 
DAM_BASH
, 
çl£
, false);

5285 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
di§rm
).
b—ts
);

5288 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
lÚ
)) {

5289 
lÚchªû
 = 75;

5291 
	`g‘_afãù_evŞutiÚ
(
viùim
, 
afãù
::
ty³
::
lÚ
)) {

5292 2: 
lÚchªû
 += 10; ;

5294 3: 
lÚchªû
 += 25; ;

5299 ià(
	`rŞl_chªû
(
lÚchªû
)) {

5300 
	`aù
("$N' viû-likgr…»v’t you from di§rmšg $M!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5301 
	`aù
("$N' viû-likgr…»v’t $M from bešg di§rmed!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

5302 
	`aù
("You¸viû-likgr…»v’t $Àäom di§rmšg you!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

5303 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
di§rm
, 
çl£
, 1);

5309 ià(
	`IS_OBJ_STAT
(
w—pÚ
, 
ITEM_NOREMOVE
)) {

5310 ià(!
	`rŞl_chªû
(10 * (
evo
 - 1))) {

5311 
	`aù
("$S w—pÚ wÚ'ˆbudge!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5312 
	`aù
("$ÀŒ› tØdi§rm you, buˆyou¸w—pÚ wÚ'ˆbudge!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

5313 
	`aù
("$ÀŒ› tØdi§rm $N, buˆçs.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

5314 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
di§rm
, 
çl£
, 1);

5320 
chªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
di§rm
) * 7 / 10;

5323 
ch_w—pÚ_skl
 = 
	`g‘_w—pÚ_Ë¬Ãd
(
ch
, 
	`g‘_w—pÚ_skl
(ch, 
çl£
));

5324 
viù_w—pÚ_skl
 = 
	`g‘_w—pÚ_Ë¬Ãd
(
viùim
, 
	`g‘_w—pÚ_skl
(viùim, 
çl£
));

5325 
ch_viù_w—pÚ_skl
 = 
	`g‘_w—pÚ_Ë¬Ãd
(
ch
, 
	`g‘_w—pÚ_skl
(
viùim
, 
çl£
));

5328 ià(
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
è=ğ
nuÎ±r
)

5329 
chªû
 = chªû * 
ch_w—pÚ_skl
 / 150;

5331 
chªû
 = chªû * 
ch_w—pÚ_skl
 / 100;

5334 
chªû
 +ğ(
ch_w—pÚ_skl
 - 
viù_w—pÚ_skl
) / 7;

5337 
chªû
 +ğ(
ch_viù_w—pÚ_skl
 - 
viù_w—pÚ_skl
) / 10;

5340 
chªû
 +ğ
	`GET_ATTR_DEX
(
ch
);

5341 
chªû
 +ğ
	`GET_ATTR_STR
(
ch
);

5342 
chªû
 -ğ2 * 
	`GET_ATTR_STR
(
viùim
);

5345 
chªû
 +ğ(
ch
->
Ëv–
 - 
viùim
->level);

5346 
chªû
 +ğ
sight_modif›r
 / 5;

5349 ià(
	`rŞl_chªû
(
chªû
)) {

5350 
Room
 *
Ãxt_room
 = 
nuÎ±r
;

5351 
Ex™
 *
³x™
 = 
nuÎ±r
;

5352 
buf
[
MAX_STRING_LENGTH
];

5353 
doÜ
;

5355 
evo
) {

5357 
	`aù
("$À*** DISARMS *** you‡nd s’d you¸w—pÚ flyšg!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

5358 
	`aù
("You di§rm $N!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5359 
	`aù
("$Àdi§rm $N!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

5363 
	`aù
("W™h‡„šgšg blow, $Àknock you¸w—pÚ‡way from you!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

5364 
	`aù
("W™h‡„šgšg blow, you knock $N' w—pÚ‡way from $M!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5365 
	`aù
("W™h‡„šgšg blow, $Àknock $N' w—pÚ‡way from $M!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

5369 
	`aù
("IÀ¨¥eùacuÏ¸cou³, $Àknock you¸w—pÚ‡way from you!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

5370 
	`aù
("IÀ¨¥eùacuÏ¸cou³, you knock $N' w—pÚ‡way from $M!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5371 
	`aù
("IÀ¨¥eùacuÏ¸cou³, $Àknock $N' w—pÚ‡way from $M!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

5375 
	`aù
("$n' deva¡©šg cutov”„ you¸w—pÚ from you¸g¿¥!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

5376 
	`aù
("You¸deva¡©šg cutov”„ $N' w—pÚ from $S g¿¥!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5377 
	`aù
("$n' deva¡©šg cutov”„ $N' w—pÚ from $S g¿¥!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

5381 
	`obj_äom_ch¬
(
w—pÚ
);

5383 ià(
	`IS_OBJ_STAT
(
w—pÚ
, 
ITEM_NODROP
)

5384 || 
	`IS_OBJ_STAT
(
w—pÚ
, 
ITEM_INVENTORY
)

5385 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


5386 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
şª¬’a
)

5387 
	`obj_to_ch¬
(
w—pÚ
, 
viùim
);

5390 ià((
evo
 =ğ2 && 
	`rŞl_chªû
(5))

5391 || (
evo
 =ğ3 && 
	`rŞl_chªû
(15))

5392 || (
evo
 =ğ4 && 
	`rŞl_chªû
(25))) {

5393 
doÜ
 = 
	`numb”_doÜ
();

5395 ià((
³x™
 = 
viùim
->
š_room
->
ex™
[
doÜ
]) != 0

5396 && (
Ãxt_room
 = 
³x™
->
to_room
è!ğ
nuÎ±r


5397 && 
	`ÿn_£e_room
(
viùim
, 
Ãxt_room
)) {

5398 ià(
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
)) {

5399 
FÜm©
::
	`¥rštf
(
buf
, "$p slams‡gainsthe $d‡nd clattersohe %s!",

5400 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
šside
 ? "floor" : "ground");

5401 
	`aù
(
buf
, 
ch
, 
w—pÚ
, 
³x™
->
	`keywÜd
(), 
TO_CHAR
);

5402 
	`aù
(
buf
, 
ch
, 
w—pÚ
, 
³x™
->
	`keywÜd
(), 
TO_ROOM
);

5403 
	`obj_to_room
(
w—pÚ
, 
viùim
->
š_room
);

5406 
FÜm©
::
	`¥rštf
(
buf
, "$p flieshroughhe‡ir‡nd disappears %s%s!",

5407 
doÜ
 < 4 ? "tØth" : "", 
Ex™
::
	`dœ_Çme
(door));

5408 
	`aù
(
buf
, 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_CHAR
);

5409 
	`aù
(
buf
, 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_ROOM
);

5411 ià(
Ãxt_room
->
³İË
 !ğ
nuÎ±r
) {

5412 
FÜm©
::
	`¥rštf
(
buf
, "$p flies in from %s%s‡nd clattersohe %s!",

5413 
Ex™
::
	`»v_dœ
(
doÜ
è< 4 ? "th" : "", Ex™::
	`dœ_Çme
(doÜ, 
Œue
),

5414 
Ãxt_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
šside
 ? "floor" : "ground");

5415 
	`aù
(
buf
, 
Ãxt_room
->
³İË
, 
w—pÚ
, 
nuÎ±r
, 
TO_CHAR
);

5416 
	`aù
(
buf
, 
Ãxt_room
->
³İË
, 
w—pÚ
, 
nuÎ±r
, 
TO_ROOM
);

5419 
	`obj_to_room
(
w—pÚ
, 
Ãxt_room
);

5423 ià(
doÜ
 < 4)

5424 
FÜm©
::
	`¥rštf
(
buf
, "$p slams‡gainsthe %s wall‡nd clattersohe %s!",

5425 
Ex™
::
	`dœ_Çme
(
doÜ
),

5426 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
šside
 ? "floor" : "ground");

5427 ià(
doÜ
 < 5)

5428 
FÜm©
::
	`¥rštf
(
buf
, "$p clattersohe %s.",

5429 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
šside
 ? "floor" : "ground");

5431 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
šside
)

5432 
FÜm©
::
	`¥rštf
(
buf
, "$p flies up‡nd strikeshe ceiling,hen clattersohe floor!");

5434 
FÜm©
::
	`¥rštf
(
buf
, "$p flies intohe‡ir,‡nd falls hardohe ground!");

5437 
	`aù
(
buf
, 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_CHAR
);

5438 
	`aù
(
buf
, 
ch
, 
w—pÚ
, 
nuÎ±r
, 
TO_ROOM
);

5439 
	`obj_to_room
(
w—pÚ
, 
viùim
->
š_room
);

5443 
	`obj_to_room
(
w—pÚ
, 
viùim
->
š_room
);

5445 ià(
evo
 > 1)

5446 
	`WAIT_STATE
(
viùim
, (12 + (
evo
 * 6)));

5449 ià(
viùim
->
	`is_Åc
(è&& viùim->
wa™
 =ğ0 && 
	`ÿn_£e_obj
(viùim, 
w—pÚ
)) {

5450 
	`g‘_obj
(
viùim
, 
w—pÚ
, 
nuÎ±r
);

5451 
	`w—r_obj
(
viùim
, 
w—pÚ
, 
çl£
);

5455 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
di§rm
, 
Œue
, 1);

5458 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
di§rm
).
b—ts
);

5459 
	`aù
("You faØdi§rm $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5460 
	`aù
("$ÀŒ› tØdi§rm you, buˆçs.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

5461 
	`aù
("$ÀŒ› tØdi§rm $N, buˆçs.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

5462 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
di§rm
, 
çl£
, 1);

5465 ià(
	`is_blšded
(
ch
è&& (
blšd_fight_skl
 > 0))

5466 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
blšd_fight
, 
çl£
, 1);

5467 
	}
}

5469 
	$do_¦a
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5471 
	`¡c
("Iàyou wªˆtØSLAY, s³Î iˆout.\n", 
ch
);

5472 
	}
}

5474 
	$do_¦ay
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5476 
buf
[
MAX_STRING_LENGTH
];

5477 
Ch¬aù”
 *
viùim
;

5479 ià(
¬gum’t
.
	`em±y
()) {

5480 
	`¡c
("SÏy whom?\n", 
ch
);

5484 
SŒšg
 
¬g
;

5485 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

5487 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

5488 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

5492 ià(
ch
 =ğ
viùim
) {

5493 
	`¡c
("Suicidi ¨mÜÈsš.\n", 
ch
);

5497 ià(
	`IS_IMMORTAL
(
viùim
)) {

5498 
	`aù
("FÜg‘tšgh© $E i immÜl, you foŞishly‡‰em±Ø¦ay $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5499 
	`aù
("$À©‹m± tØ¦ay you iÀcŞd blood!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

5500 
	`aù
("$ÀfoŞishly‡‰em± tØ¦ayhimmÜl, $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

5504 
	`aù
("You sÏy $M iÀcŞd blood!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5505 
	`aù
("$À¦ay you iÀcŞd blood!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

5506 
	`aù
("$À¦ay $N iÀcŞd blood!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

5509 ià(!
viùim
->
	`is_Åc
()) {

5510 
FÜm©
::
	`¥rštf
(
buf
, "% ha b“À¦aš by %s.", 
viùim
->
Çme
, (
ch
->
	`is_Åc
(è? ch->
shÜt_desü
 : ch->name));

5511 
	`do_£nd_ªnounû
(
viùim
, 
buf
);

5514 
	`¿w_kl
(
viùim
);

5516 
	}
}

5518 
	$do_rÙ©e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5520 
Ch¬aù”
 *
viùim
;

5522 ià(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
rÙ©e
) == 0) {

5523 
	`¡c
("DØwh©?", 
ch
);

5527 ià(
¬gum’t
.
	`em±y
()) {

5528 
	`¡c
("RÙ©you¸©ckØwhom?\n", 
ch
);

5532 
SŒšg
 
¬g
;

5533 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

5535 ià(
ch
->
fightšg
 =ğ
nuÎ±r
) {

5536 
	`¡c
("You'»‚Ù iÀcomb©, ju¡…ick someÚe!\n", 
ch
);

5540 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

5541 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

5545 ià(
viùim
 =ğ
ch
) {

5546 
	`¡c
("Suicidi nÙ‡ÀİtiÚ?\n", 
ch
);

5550 ià(
	`is_§ã
(
ch
, 
viùim
, 
Œue
))

5553 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
rÙ©e
))

5556 
	`check_kËr
(
ch
, 
viùim
);

5557 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
rÙ©e
).
b—ts
);

5559 ià(
	`numb”_³rûÁ
(è< 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
rÙ©e
)) {

5560 
	`¡c
("You deály shiáhfocu oàyou¸blows.\n", 
ch
);

5561 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
rÙ©e
, 
Œue
, 4);

5562 
ch
->
fightšg
 = 
viùim
;

5565 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
rÙ©e
, 
çl£
, 4);

5566 
	`¡c
("You faØsw™ch dªcšg…¬Š”s.\n", 
ch
);

5568 
	}
}

5570 
	$do_hamm”¡rike
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5572 
chªû
;

5574 ià(!
	`CAN_USE_RSKILL
(
ch
, 
skl
::
ty³
::
hamm”¡rike
)) {

5575 
	`¡c
("Huh?\n", 
ch
);

5579 
chªû
 = 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
hamm”¡rike
);

5581 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
hamm”¡rike
)) {

5582 
	`¡c
("A» you in§Ã?!?\n", 
ch
);

5586 ià(
	`numb”_³rûÁ
(è< 
chªû
) {

5587 
	`WAIT_STATE
(
ch
, 
PULSE_VIOLENCE
);

5588 
ch
->
¡am
 -= ch->stam / 3;

5589 
	`¡c
("Thgod ¡rikyou w™h‡†ighŠšg bŞˆoàpow”!\n", 
ch
);

5590 
	`aù
("$Ài l™ oÀfœby‡ blubŞˆoàgodly…ow”.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5591 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
hamm”¡rike
, 
Œue
, 2);

5593 
afãù
::
	`add_ty³_to_ch¬
(
ch
,

5594 
afãù
::
ty³
::
hamm”¡rike
,

5595 
ch
->
Ëv–
,

5596 
	`numb”_fuzzy
(
ch
->
Ëv–
/15),

5597 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
hamm”¡rike
),

5598 
çl£


5602 
	`WAIT_STATE
(
ch
, 3 * 
PULSE_VIOLENCE
);

5603 
ch
->
¡am
 = ch->stam / 3;

5604 
	`¡c
("You c®ÈfÜ…ow” fromhgods, buˆyou g‘‚Øªsw”.\n", 
ch
);

5605 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
hamm”¡rike
, 
çl£
, 2);

5607 
	}
}

5609 
	$do_ü™iÿl_blow
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5611 
Objeù
 *
w—pÚ
;

5612 
chªû
;

5614 ià(!
	`CAN_USE_RSKILL
(
ch
, 
skl
::
ty³
::
ü™iÿl_blow
)) {

5615 
	`¡c
("Huh?\n", 
ch
);

5619 ià((
w—pÚ
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
)è=ğ
nuÎ±r
) {

5620 
	`¡c
("You mu¡ w›ld‡ w—pÚØü™iÿÈblow.\n", 
ch
);

5624 ià(
ch
->
fightšg
 =ğ
nuÎ±r
) {

5625 
	`¡c
("You'»‚Ù iÀcomb©, ju¡…ick someÚe!\n", 
ch
);

5629 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
ü™iÿl_blow
))

5632 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
ü™iÿl_blow
).
b—ts
);

5634 ià(!
ch
->
fightšg
->
	`is_Åc
(è&& 
	`IS_IMMORTAL
(ch->fighting)) {

5635 
	`¡c
("You fa mi£¿bly.\n", 
ch
);

5639 ià(
	`numb”_³rûÁ
(è> 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
ü™iÿl_blow
)) {

5640 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
ü™iÿl_blow
, 
çl£
, 2);

5641 
	`¡c
("You¸İpÚ’ˆ¥Ù‹d you¸move,‡nd you¸¡rikmis£s.\n", 
ch
);

5642 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
ü™iÿl_blow
).
b—ts
);

5646 
chªû
 = 100 - (((
ch
->
fightšg
->
h™
 * 100è/ 
	`GET_MAX_HIT
(ch->fighting)) * 3);

5648 ià(!
chªû
)

5649 
chªû
 = 1;

5651 ià(
	`numb”_³rûÁ
(è<ğ
chªû
) {

5652 
	`±c
(
ch
, "Youhrust your weaponhrough %s's chest, killinghem instantly!\n",

5653 
ch
->
fightšg
->
shÜt_desü
);

5654 
ch
->
fightšg
->
h™
 = -10;

5655 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
ü™iÿl_blow
, 
Œue
, 2);

5658 
	`±c
(
ch
, "Youryo give %she blow of death, but you fail.\n",

5659 
ch
->
fightšg
->
shÜt_desü
);

5660 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
ü™iÿl_blow
, 
çl£
, 2);

5663 ià(
w—pÚ
->
cÚd™iÚ
 !ğ-1 && 
	`rŞl_chªû
(10)) {

5664 
w—pÚ
->
cÚd™iÚ
 -ğ
	`numb”_¿nge
(1, 8);

5666 ià(
w—pÚ
-> 
cÚd™iÚ
 <= 0) {

5667 
	`¡c
("You¸çed‡‰ack ha {Pde¡royed{x you¸w—pÚ!\n", 
ch
);

5668 
	`de¡roy_obj
(
w—pÚ
);

5669 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
ü™iÿl_blow
).
b—ts
);

5673 
	`¡c
("You¸çed‡‰ack ha {Wdamaged{x you¸w—pÚ!\n", 
ch
);

5677 
	`Úe_h™
(
ch
, ch->
fightšg
, 
skl
::
ty³
::
ü™iÿl_blow
, 
çl£
);

5678 
	}
}

5681 
	$do_ro¡e
(
Ch¬aù”
 *
viùim
, Ch¬aù” *
ch
)

5683 
chªû
 = (
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
ro¡e
));

5685 ià(!
chªû
)

5688 
chªû
 +ğ(
viùim
->
Ëv–
 - 
ch
->level);

5690 ià(
	`numb”_³rûÁ
(è> 
chªû
) {

5691 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
ro¡e
, 
çl£
, 6);

5696 ià(
	`check_dodge
(
viùim
, 
ch
, 
skl
::
ty³
::
ro¡e
, 0))

5699 ià(
	`check_blur
(
viùim
, 
ch
, 
skl
::
ty³
::
ro¡e
, 0))

5702 ià(
	`check_shblock
(
viùim
, 
ch
, 
skl
::
ty³
::
ro¡e
, 0))

5705 ià(
	`check_du®_·¼y
(
viùim
, 
ch
, 
skl
::
ty³
::
ro¡e
, 0))

5709 
	`aù
("{GIÀ¨brlŸÁ„o¡e, you sŒikback‡ˆ$n{G!{x", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

5710 
	`Úe_h™
(
viùim
, 
ch
, 
skl
::
ty³
::
ro¡e
, 
çl£
);

5711 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
ro¡e
, 
Œue
, 6);

5712 
	}
}

5715 
	$do_¿ge
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5717 
Ch¬aù”
 *
vch
;

5718 
Ch¬aù”
 *
vch_Ãxt
;

5719 
µlh™
 = 0;

5721 ià(!
	`CAN_USE_RSKILL
(
ch
, 
skl
::
ty³
::
¿ge
)) {

5722 
	`¡c
("You¸m—g” skÈw™h w—pÚ ´ev’t ™.\n", 
ch
);

5726 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
è&& !
	`IS_IMMORTAL
(ch)) {

5727 
	`¡c
("Oddlyƒnough, iÀthi room you f“È³aûful.", 
ch
);

5731 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
¿ge
))

5734 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
¿ge
).
b—ts
);

5736 ià(
	`numb”_³rûÁ
(è> 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
¿ge
)) {

5737 
	`¡c
("You sü—m‡ b©eüy buˆçØuÆ—sh you¸šÃ¸¿ge.\n", 
ch
);

5738 
	`aù
("$À¡¬t štØ¨wd s”› oà©cks, buˆ$ timšg i off.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5739 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
¿ge
, 
çl£
, 2);

5744 
	`aù
("You sü—m‡ b©üy‡nd uÆ—sh you¸¿ge!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

5745 
	`aù
("$Àsü—m ¨b©üy,‡nd gÛ štØ¨wd s”› oà©cks!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5747 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = 
vch_Ãxt
) {

5748 
vch_Ãxt
 = 
vch
->
Ãxt_š_room
;

5750 ià(
ch
 =ğ
vch
)

5753 ià(
	`is_§me_group
(
ch
, 
vch
))

5756 ià(
	`is_§ã_¥–l
(
ch
, 
vch
, 
Œue
))

5759 
	`check_kËr
(
ch
, 
vch
);

5760 
	`muÉi_h™
(
ch
, 
vch
, 
skl
::
ty³
::
¿ge
);

5762 ià(++
µlh™
 > 4)

5766 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
¿ge
, 
Œue
, 2);

5767 
	}
}

5769 
	$do_Ïy_Ú_hªds
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5771 
h—l
, 
skl
;

5772 
Ch¬aù”
 *
viùim
;

5774 ià(
ch
->
	`is_Åc
())

5777 
skl
 = 
	`g‘_skl_Ëv–
(
ch
, skl::
ty³
::
Ïy_Ú_hªds
);

5779 ià(
skl
 <= 1) {

5780 
	`¡c
("You dÚ'ˆknow howØu£ Lay oÀHªds.\n", 
ch
);

5784 ià(
¬gum’t
.
	`em±y
()) {

5785 
	`¡c
("Syntax:†ay <target>\n"

5786 "†ay couÁ\n", 
ch
);

5790 
SŒšg
 
¬g
;

5791 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

5793 ià(
¬g
.
	`is_´efix_of
("count")) {

5794 
	`±c
(
ch
, "You may use Lay on Hands %d moreimesoday.\n",

5795 
ch
->
pcd©a
->
Ïys
);

5799 ià(
ch
->
pcd©a
->
Ïys
 <= 0) {

5800 
	`¡c
("You¸pow” oàLay oÀHªd ha ruÀout.\n", 
ch
);

5804 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

5805 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

5817 ià(
viùim
 =ğ
ch
) {

5818 
	`¡c
("TØLay oÀHªd Ú your£lài u£Ëss.\n", 
ch
);

5822 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
Ïy_Ú_hªds
))

5825 
	`aù
("$ÀÏy $ hªd Ú $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

5826 
	`aù
("You†ay you¸hªd Ú $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5827 
	`aù
("$ÀÏy $ hªd Ú you.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

5828 
ch
->
pcd©a
->
Ïys
--;

5829 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
Ïy_Ú_hªds
).
b—ts
);

5830 
h—l
 = 
ch
->
Ëv–
;

5831 
h—l
 = (h—È* 
skl
) / 100;

5832 
viùim
->
h™
 = 
¡d
::
	`mš
(viùim->h™ + 
h—l
, 
	`GET_MAX_HIT
(victim));

5833 
	`upd©e_pos
(
viùim
);

5834 
	`¡c
("You f“Èb‘‹r.\n", 
viùim
);

5835 
	`¡c
("You¸hªd glow soály‡ ¨£n£ oàdivšpow”¿v– through you.\n", 
ch
);

5836 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
Ïy_Ú_hªds
, 
Œue
, 1);

5838 
	}
}

5840 
	$do_shoÙ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

5842 
Ch¬aù”
 *
viùim
 = 
nuÎ±r
;

5844 ià(
ch
->
	`is_Åc
())

5848 
Objeù
 *
w›ld
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
);

5849 
dœ
 = -1;

5851 ià(
w›ld
 =ğ
nuÎ±r
) {

5852 
	`¡c
("You‡»‚Ù w›ldšg‡nythšg.\n", 
ch
);

5856 ià(
w›ld
->
v®ue
[0] !ğ
WEAPON_BOW
) {

5857 
	`¡c
("You‡»‚Ù w›ldšg‡ bow.\n", 
ch
);

5861 ià(
¬gum’t
.
	`em±y
()) {

5862 
viùim
 = 
ch
->
fightšg
;

5864 ià(
viùim
 =ğ
nuÎ±r
) {

5865 
	`¡c
("Whom dØyou wªˆtØshoÙ?\n", 
ch
);

5870 
SŒšg
 
dœ_¡r
, 
dœ_¬g
;

5871 
SŒšg
 
rg‘_¡r
 = 
	`Úe_¬gum’t
(
¬gum’t
, 
dœ_¬g
);

5872 
Room
 *
rg‘_room
 = 
nuÎ±r
;

5873 
di¡ªû
 = 
MAX_BOW_DISTANCE
;

5874 
boŞ
 
Ã¬e¡
 = 
çl£
;

5877 ià(
	`isdig™
(
dœ_¬g
[0]))

5878 
di¡ªû
 = 
¡d
::
	`mš
(
	`numb”_¬gum’t
(
dœ_¬g
, 
dœ_¡r
), 
MAX_BOW_DISTANCE
);

5880 
Ã¬e¡
 = 
Œue
;

5881 
dœ_¡r
 = 
dœ_¬g
;

5884 ià(
dœ_¡r
.
	`is_´efix_of
("nÜth")è
dœ
 = 
DIR_NORTH
;

5885 ià(
dœ_¡r
.
	`is_´efix_of
("—¡")è
dœ
 = 
DIR_EAST
;

5886 ià(
dœ_¡r
.
	`is_´efix_of
("south")è
dœ
 = 
DIR_SOUTH
;

5887 ià(
dœ_¡r
.
	`is_´efix_of
("we¡")è
dœ
 = 
DIR_WEST
;

5888 ià(
dœ_¡r
.
	`is_´efix_of
("up")è
dœ
 = 
DIR_UP
;

5889 ià(
dœ_¡r
.
	`is_´efix_of
("down")è
dœ
 = 
DIR_DOWN
;

5892 ià(
dœ
 == -1) {

5893 
rg‘_¡r
 = 
¬gum’t
;

5894 
rg‘_room
 = 
ch
->
š_room
;

5897 ià(
rg‘_¡r
.
	`em±y
()) {

5898 
	`¡c
("Whom dØyou wªˆtØshoÙ?\n", 
ch
);

5902 
Room
 *
room
 = 
ch
->
š_room
;

5903 
Room
 *
to_room
;

5904 
Ex™
 *
³x™
;

5906 ià(
Ã¬e¡
) {

5909 
i
 = 0; i < 
MAX_BOW_DISTANCE
; i++) {

5910 ià((
³x™
 = 
room
->
ex™
[
dœ
]è=ğ
nuÎ±r


5911 || (
to_room
 = 
³x™
->to_roomè=ğ
nuÎ±r


5912 || !
	`ÿn_£e_room
(
ch
, 
to_room
)

5913 || (
³x™
->
ex™_æags
.
	`has
(
EX_ISDOOR
)

5914 && 
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
)))

5917 ià(
	`g‘_ch¬_room
(
ch
, 
to_room
, 
rg‘_¡r
, 
VIS_CHAR
)) {

5918 
rg‘_room
 = 
to_room
;

5922 
room
 = 
to_room
;

5926 
i
 = 0; i < 
di¡ªû
; i++) {

5927 ià((
³x™
 = 
room
->
ex™
[
dœ
]è=ğ
nuÎ±r


5928 || (
to_room
 = 
³x™
->to_roomè=ğ
nuÎ±r


5929 || !
	`ÿn_£e_room
(
ch
, 
to_room
)) {

5930 
	`±c
(
ch
, "AÏs, you cªnÙ shoÙ% šh© dœeùiÚ.\n", 
i
 == 0 ? "" : "hat far");

5935 ià(
³x™
->
ex™_æags
.
	`has
(
EX_ISDOOR
)

5936 && 
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
)) {

5937 
	`¡c
("A doÜ block th·th oàth¬row.\n", 
ch
);

5941 
room
 = 
to_room
;

5944 
rg‘_room
 = 
room
;

5948 ià(
rg‘_room
 !ğ
nuÎ±r
)

5949 
viùim
 = 
	`g‘_ch¬_room
(
ch
, 
rg‘_room
, 
rg‘_¡r
, 
VIS_CHAR
);

5952 ià(
viùim
 =ğ
nuÎ±r
) {

5953 
	`¡c
("You dØnÙ s“ you¸rg‘ iÀth© dœeùiÚ.\n", 
ch
);

5957 ià(!
	`check_©ck_ok
(
ch
, 
viùim
))

5961 
	`¡c
("You†‘ you¸¬row fly!\n", 
ch
);

5963 ià(
	`ÿn_£e_š_room
(
viùim
, viùim->
š_room
)) {

5964 ià(
viùim
->
š_room
 =ğ
ch
->in_room)

5965 
	`aù
("$ÀshoÙ ª‡¼ow‡ˆyou!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

5967 cÚ¡ 
SŒšg
 
dœ_Çme
 [] =

5970 
	`±c
(
viùim
, "AÀ¬row fl› © you from %s!", 
dœ_Çme
[
Ex™
::
	`»v_dœ
(
dœ
)]);

5974 
	`¡c
("SomeÚi shoÙšg‡ˆyou!\n", 
viùim
);

5978 
Room
 *
Şd_room
 = 
ch
->
š_room
;

5979 
boŞ
 
was_su³rwiz
 = 
ch
->
aù_æags
.
	`has
(
PLR_SUPERWIZ
);

5981 ià(
Şd_room
 !ğ
viùim
->
š_room
) {

5982 
	`ch¬_äom_room
(
ch
);

5983 
	`ch¬_to_room
(
ch
, 
viùim
->
š_room
);

5984 
ch
->
aù_æags
 +ğ
PLR_SUPERWIZ
;

5988 
	`Úe_h™
(
ch
, 
viùim
, 
skl
::
ty³
::
unknown
, 
çl£
);

5991 ià(
Şd_room
 !ğ
viùim
->
š_room
) {

5992 
	`ch¬_äom_room
(
ch
);

5993 
	`ch¬_to_room
(
ch
, 
Şd_room
);

5995 ià(!
was_su³rwiz
)

5996 
ch
->
aù_æags
 -ğ
PLR_SUPERWIZ
;

5999 ià(
viùim
->
	`is_Åc
()) {

6000 
viùim
->
huÁšg
 = 
ch
;

6001 
	`huÁ_viùim
(
viùim
);

6005 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
back¡ab
).
b—ts
);

6006 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
¬ch”y
, 
Œue
, 5);

6007 
	}
}

	@src/file.cc

11 
	~"cÚ¡ªts.hh
"

12 
	~"fe.hh
"

14 
	~"FÏgs.hh
"

15 
	~"Loggšg.hh
"

16 
	~"SŒšg.hh
"

17 
	~"Game.hh
"

20 
	$ä—d_Ë‰”
(
FILE
 *
å
)

22 
c
;

25 
c
 = 
	`g‘c
(
å
);

27 
	`is¥aû
(
c
));

29  
c
;

30 
	}
}

33 
	$ä—d_numb”
(
FILE
 *
å
)

35 
numb”
 = 0;

36 
boŞ
 
sign
 = 
çl£
;

37 
c
;

40 
c
 = 
	`g‘c
(
å
);

42 
	`is¥aû
(
c
));

44 ià(
c
 == '+')

45 
c
 = 
	`g‘c
(
å
);

46 ià(
c
 == '-') {

47 
sign
 = 
Œue
;

48 
c
 = 
	`g‘c
(
å
);

51 ià(!
	`isdig™
(
c
)) {

52 
Loggšg
::
	`bug
("Fread_number: bad format.", 0);

53 
numb”
 = 0;

54  
numb”
;

57 
	`isdig™
(
c
)) {

58 
numb”
 =‚umb” * 10 + 
c
 - '0';

59 
c
 = 
	`g‘c
(
å
);

62 ià(
sign
)

63 
numb”
 = 0 -‚umber;

65 ià(
c
 == '|')

66 
numb”
 +ğ
	`ä—d_numb”
(
å
);

67 ià(
c
 != ' ')

68 
	`ung‘c
(
c
, 
å
);

70  
numb”
;

71 
	}
}

73 cÚ¡ 
FÏgs
 
	$ä—d_æag
(
FILE
 *
å
)

75  
	`FÏgs
(
	`ä—d_wÜd
(
å
));

76 
	}
}

78 
SŒšg
 
	$ä—d_¡ršg
(
FILE
 *
å
, 
to_ch¬
)

80 
c
;

84 
c
 = 
	`g‘c
(
å
);

86 
	`is¥aû
(
c
));

88 ià(
c
 =ğ
to_ch¬
)

91 
SŒšg
 
buf
;

92 
buf
 = 
c
;

94 
Œue
) {

95 
c
 = 
	`g‘c
(
å
);

97 
c
) {

98 
EOF
:

99 
Loggšg
::
	`bug
("Fread_string: EOF", 0);

100  
buf
;

104 ià(
c
 =ğ
to_ch¬
)

105  
buf
;

107 
buf
 +ğ
c
;

111 
	}
}

113 
SŒšg
 
	$ä—d_¡ršg_eŞ
(
FILE
 *
å
)

115  
	`ä—d_¡ršg
(
å
, '\n');

116 
	}
}

121 
	$ä—d_to_eŞ
(
FILE
 *
å
)

123 
c
;

126 
c
 = 
	`g‘c
(
å
);

128 
c
 != '\n' && c != '\r');

131 
c
 = 
	`g‘c
(
å
);

133 
c
 == '\n' || c == '\r');

135 
	`ung‘c
(
c
, 
å
);

136 
	}
}

141 
SŒšg
 
	$ä—d_wÜd
(
FILE
 *
å
)

143 
wÜd
[
MIL
];

144 *
pwÜd
;

145 
cEnd
;

148 
cEnd
 = 
	`g‘c
(
å
);

150 
	`is¥aû
(
cEnd
));

152 ià(
cEnd
 == '\'' || cEnd == '"')

153 
pwÜd
 = 
wÜd
;

155 
wÜd
[0] = 
cEnd
;

156 
pwÜd
 = 
wÜd
 + 1;

157 
cEnd
 = ' ';

160 ; 
pwÜd
 < 
wÜd
 + 
MIL
;…word++) {

161 *
pwÜd
 = 
	`g‘c
(
å
);

163 ià(
cEnd
 =ğ' ' ? 
	`is¥aû
(*
pwÜd
) : *pword == cEnd) {

164 ià(
cEnd
 == ' ')

165 
	`ung‘c
(*
pwÜd
, 
å
);

167 *
pwÜd
 = '\0';

168  
wÜd
;

172 
Loggšg
::
	`bug
("Fread_word: wordoo†ong.", 0);

175 
	}
}

178 
	$çµ’d
(cÚ¡ 
SŒšg
& 
fe
, cÚ¡ SŒšg& 
¡r
)

180 
FILE
 *
å
;

182 ià(
¡r
.
	`em±y
())

185 ià((
å
 = 
	`fİ’
(
fe
.
	`c_¡r
(), "a")è!ğ
nuÎ±r
) {

186 
	`åuts
(
¡r
.
	`c_¡r
(), 
å
);

187 
	`fşo£
(
å
);

190 
Loggšg
::
	`bugf
("çµ’d(): could‚Ù o³À%s", 
fe
);

191 
	}
}

208 cÚ¡ 
SŒšg
 
	gday_Çmes
[] =

210 cÚ¡ 
SŒšg
 
	gmÚth_Çmes
[] = {

215 cÚ¡ *
	$dizzy_ùime
(
time_t
 *
tim•
)

217 
ùime_buf
[40];

218 
tm
 
loc_tm
;

219 
loc_tm
 = *
	`loÿÉime
(
tim•
);

220 
FÜm©
::
	`¥rštf
(
ùime_buf
, "%s %s %02d %02d:%02d:%02d %04d\n",

221 
day_Çmes
[
loc_tm
.
tm_wday
],

222 
mÚth_Çmes
[
loc_tm
.
tm_mÚ
],

223 
loc_tm
.
tm_mday
,

224 
loc_tm
.
tm_hour
,†oc_tm.
tm_mš
,†oc_tm.
tm_£c
,

225 1900 + 
loc_tm
.
tm_y—r
);

226  
ùime_buf
;

227 
	}
}

234 
time_t
 
	$dizzy_sÿÁime
(cÚ¡ 
SŒšg
& 
ùime
)

236 
cdow
[4], 
cmÚ
[4];

237 
y—r
, 
mÚth
, 
day
, 
hour
, 
mšu‹
, 
£cÚd
;

238 
msg
[
MAX_INPUT_LENGTH
];

239 
tm
 
loc_tm
;

241 
loc_tm
 = *
	`loÿÉime
(&
Game
::
cu¼’t_time
);

243 ià(
	`ssÿnf
(
ùime
.
	`c_¡r
(), " %3s %3s %d %d:%d:%d %d",

244 
cdow
, 
cmÚ
, &
day
, &
hour
, &
mšu‹
, &
£cÚd
, &
y—r
) < 7) {

245 
FÜm©
::
	`¥rštf
(
msg
, "dizzy_sÿÁime(): E¼Ü sÿÂšg d©e/time: '%s'", 
ùime
);

246 
Loggšg
::
	`bug
(
msg
, 0);

247 
’doáime
;

250 
mÚth
 = 0; month < 12; month++) {

251 ià(
mÚth_Çmes
[
mÚth
].
	`is_´efix_of
(
ùime
.
	`sub¡r
(4)))

255 ià(
mÚth
 >= 12) {

256 
FÜm©
::
	`¥rštf
(
msg
, "dizzy_sÿÁime(): Bad mÚth iÀ%s", 
ùime
);

257 
Loggšg
::
	`bug
(
msg
, 0);

258 
’doáime
;

261 
loc_tm
.
tm_mÚ
 = 
mÚth
;

262 
loc_tm
.
tm_mday
 = 
day
;

263 
loc_tm
.
tm_hour
 = 
hour
;

264 
loc_tm
.
tm_mš
 = 
mšu‹
;

265 
loc_tm
.
tm_£c
 = 
£cÚd
;

266 
loc_tm
.
tm_y—r
 = 
y—r
 - 1900;

267 
’doáime
:

268  
	`mktime
(&
loc_tm
);

269 
	}
}

	@src/find.cc

8 
	~"¬gum’t.hh
"

9 
	~"A»a.hh
"

10 
	~"Ch¬aù”.hh
"

11 
	~"deş¬e.hh
"

12 
	~"FÏgs.hh
"

13 
	~"Game.hh
"

14 
	~"Loggšg.hh
"

15 
	~"m”c.hh
"

16 
	~"MobePrÙÙy³.hh
"

17 
	~"Objeù.hh
"

18 
	~"PÏy”.hh
"

19 
	~"Room.hh
"

20 
	~"SŒšg.hh
"

21 
	~"WÜld.hh
"

38 
	#CHARTYPE_TEST
(
chx
è(((chx)->
	`is_Åc
()è? 
ENTITY_M
 : 
ENTITY_P
)

	)

39 
	#CHARTYPE_MATCH
(
chx
,
ù
è(((
	`CHARTYPE_TEST
(chx)è& ctè!ğ0)

	)

42 
Ch¬aù”
 *
	$g‘_mob_h”e
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
)

44 
Ch¬aù”
 *
rch
;

45 
couÁ
 = 0, 
vnum
 = 0;

46 
SŒšg
 
¬g
;

47 
FÏgs
::
B™
 
‘y³
 = 
	`’t™y_¬gum’t
(
¬gum’t
, 
¬g
);

48 
numb”
 = 
	`numb”_¬gum’t
(
¬g
,‡rg);

50 ià(
‘y³
 =ğ
ENTITY_VM
)

51 
vnum
 = 
	`©oi
(
¬g
);

53 ià(
¬g
 == "self")

54  
ch
;

56 
rch
 = 
ch
->
š_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
) {

57 ià(
rch
->
š_room
 =ğ
nuÎ±r
)

60 ià(!
rch
->
	`is_Åc
())

63 ià(
‘y³
 =ğ
ENTITY_VM
) {

64 ià(!
rch
->
	`is_Åc
(è|| !rch->
pIndexD©a
 ||„ch->pIndexD©a->
vnum
 != vnum)

68 ià(
‘y³
 !ğ0 && !
	`CHARTYPE_MATCH
(
rch
,ƒtype))

71 ià(!
¬g
.
	`em±y
(è&& !
rch
->
Çme
.
	`has_wÜds
(arg))

75 
vis
) {

76 
VIS_PLR
: ià(!
	`ÿn_£e_who
(
ch
, 
rch
)) ; ;

78 
VIS_CHAR
: ià(!
	`ÿn_£e_ch¬
(
ch
, 
rch
)) ; ;

83 ià(++
couÁ
 =ğ
numb”
)

84  
rch
;

87  
nuÎ±r
;

88 
	}
}

92 
Ch¬aù”
 *
	$g‘_mob_¬—
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
)

94 
Ch¬aù”
 *
ach
;

96 ià((
ach
 = 
	`g‘_mob_h”e
(
ch
, 
¬gum’t
, 
vis
)è!ğ
nuÎ±r
)

97  
ach
;

99 
couÁ
 = 0;

100 
SŒšg
 
¬g
;

101 
FÏgs
::
B™
 
‘y³
 = 
	`’t™y_¬gum’t
(
¬gum’t
, 
¬g
);

102 
numb”
 = 
	`numb”_¬gum’t
(
¬g
,‡rg);

104 autØ
ach
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

105 ià(!
ach
->
	`is_Åc
())

108 ià(
ach
->
š_room
 =ğ
nuÎ±r
)

111 ià(
‘y³
 !ğ0 && !
	`CHARTYPE_MATCH
(
ach
,ƒtype))

114 ià(
ach
->
š_room
->
	`¬—
(è!ğ
ch
->in_room->area()

115 || (!
¬g
.
	`em±y
(è&& !
ach
->
Çme
.
	`has_wÜds
(arg)))

118 
vis
) {

119 
VIS_PLR
: ià(!
	`ÿn_£e_who
(
ch
, 
ach
)) ; ;

121 
VIS_CHAR
: ià(!
	`ÿn_£e_ch¬
(
ch
, 
ach
)) ; ;

126 ià(++
couÁ
 =ğ
numb”
)

127  
ach
;

130  
nuÎ±r
;

131 
	}
}

135 
Ch¬aù”
 *
	$g‘_mob_wÜld
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
)

137 
Ch¬aù”
 *
wch
;

139 ià((
wch
 = 
	`g‘_mob_h”e
(
ch
, 
¬gum’t
, 
vis
)è!ğ
nuÎ±r
)

140  
wch
;

142 
couÁ
 = 0, 
vnum
 = 0;

143 
SŒšg
 
¬g
;

144 
FÏgs
::
B™
 
‘y³
 = 
	`’t™y_¬gum’t
(
¬gum’t
, 
¬g
);

145 
numb”
 = 
	`numb”_¬gum’t
(
¬g
,‡rg);

147 ià(
‘y³
 =ğ
ENTITY_VM
)

148 
vnum
 = 
	`©oi
(
¬g
);

150 autØ
wch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

151 ià(!
wch
->
	`is_Åc
())

154 ià(
wch
->
š_room
 =ğ
nuÎ±r
)

157 ià(
‘y³
 =ğ
ENTITY_VM
) {

158 ià(!
wch
->
	`is_Åc
(è|| !wch->
pIndexD©a
 || wch->pIndexD©a->
vnum
 != vnum)

162 ià(
‘y³
 !ğ0 && !
	`CHARTYPE_MATCH
(
wch
,ƒtype))

165 ià(!
¬g
.
	`em±y
(è&& !
wch
->
Çme
.
	`has_wÜds
(arg))

169 
vis
) {

170 
VIS_PLR
: ià(!
	`ÿn_£e_who
(
ch
, 
wch
)) ; ;

172 
VIS_CHAR
: ià(!
	`ÿn_£e_ch¬
(
ch
, 
wch
)) ; ;

177 ià(++
couÁ
 =ğ
numb”
)

178  
wch
;

181  
nuÎ±r
;

182 
	}
}

186 
Ch¬aù”
 *
	$g‘_ch¬_h”e
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
)

188 
Ch¬aù”
 *
rch
;

189 
couÁ
 = 0, 
vnum
 = 0;

190 
SŒšg
 
¬g
;

191 
FÏgs
::
B™
 
‘y³
 = 
	`’t™y_¬gum’t
(
¬gum’t
, 
¬g
);

192 
numb”
 = 
	`numb”_¬gum’t
(
¬g
,‡rg);

194 ià(
‘y³
 =ğ
ENTITY_VM
)

195 
vnum
 = 
	`©oi
(
¬g
);

197 ià(
¬g
 == "self")

198  
ch
;

200 
rch
 = 
ch
->
š_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
) {

201 ià(
rch
->
š_room
 =ğ
nuÎ±r
)

204 ià(
‘y³
 =ğ
ENTITY_VM
) {

205 ià(!
rch
->
	`is_Åc
(è|| !rch->
pIndexD©a
 ||„ch->pIndexD©a->
vnum
 != vnum)

209 ià(
‘y³
 !ğ0 && !
	`CHARTYPE_MATCH
(
rch
,ƒtype))

212 ià(!
¬g
.
	`em±y
(è&& !
rch
->
Çme
.
	`has_wÜds
(arg))

216 
vis
) {

217 
VIS_PLR
: ià(!
	`ÿn_£e_who
(
ch
, 
rch
)) ; ;

219 
VIS_CHAR
: ià(!
	`ÿn_£e_ch¬
(
ch
, 
rch
)) ; ;

224 ià(++
couÁ
 =ğ
numb”
)

225  
rch
;

228  
nuÎ±r
;

229 
	}
}

237 
Ch¬aù”
 *
	$g‘_ch¬_room
(
Ch¬aù”
 *
ch
, 
Room
 *
room
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
)

239 
Ch¬aù”
 *
rch
;

240 
couÁ
 = 0, 
vnum
 = 0;

241 
SŒšg
 
¬g
;

242 
FÏgs
::
B™
 
‘y³
 = 
	`’t™y_¬gum’t
(
¬gum’t
, 
¬g
);

243 
numb”
 = 
	`numb”_¬gum’t
(
¬g
,‡rg);

245 ià(
‘y³
 =ğ
ENTITY_VM
)

246 
vnum
 = 
	`©oi
(
¬g
);

248 ià(
¬g
 == "self")

249  
ch
;

251 
rch
 = 
room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
) {

252 ià(
rch
->
š_room
 =ğ
nuÎ±r
)

255 ià(
‘y³
 =ğ
ENTITY_VM
) {

256 ià(!
rch
->
	`is_Åc
(è|| !rch->
pIndexD©a
 ||„ch->pIndexD©a->
vnum
 != vnum)

260 ià(
‘y³
 !ğ0 && !
	`CHARTYPE_MATCH
(
rch
,ƒtype))

263 ià(!
¬g
.
	`em±y
(è&& !
rch
->
Çme
.
	`has_wÜds
(arg))

267 
vis
) {

268 
VIS_PLR
: ià(!
	`ÿn_£e_who
(
ch
, 
rch
)) ; ;

270 
VIS_CHAR
: ià(!
	`ÿn_£e_ch¬
(
ch
, 
rch
)) ; ;

275 ià(++
couÁ
 =ğ
numb”
)

276  
rch
;

279  
nuÎ±r
;

280 
	}
}

284 
Ch¬aù”
 *
	$g‘_ch¬_¬—
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
)

286 
Ch¬aù”
 *
ach
;

288 ià((
ach
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬gum’t
, 
vis
)è!ğ
nuÎ±r
)

289  
ach
;

291 
couÁ
 = 0;

292 
SŒšg
 
¬g
;

293 
FÏgs
::
B™
 
‘y³
 = 
	`’t™y_¬gum’t
(
¬gum’t
, 
¬g
);

294 
numb”
 = 
	`numb”_¬gum’t
(
¬g
,‡rg);

296 autØ
ach
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

297 ià(
ach
->
š_room
 =ğ
nuÎ±r
)

300 ià(
‘y³
 !ğ0 && !
	`CHARTYPE_MATCH
(
ach
,ƒtype))

303 ià(
ach
->
š_room
->
	`¬—
(è!ğ
ch
->in_room->area()

304 || (!
¬g
.
	`em±y
(è&& !
ach
->
Çme
.
	`has_wÜds
(arg)))

307 
vis
) {

308 
VIS_PLR
: ià(!
	`ÿn_£e_who
(
ch
, 
ach
)) ; ;

310 
VIS_CHAR
: ià(!
	`ÿn_£e_ch¬
(
ch
, 
ach
)) ; ;

315 ià(++
couÁ
 =ğ
numb”
)

316  
ach
;

319  
nuÎ±r
;

320 
	}
}

324 
Ch¬aù”
 *
	$g‘_ch¬_wÜld
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
)

326 
Ch¬aù”
 *
wch
;

328 ià((
wch
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬gum’t
, 
vis
)è!ğ
nuÎ±r
)

329  
wch
;

331 
couÁ
 = 0, 
vnum
 = 0;

332 
SŒšg
 
¬g
;

333 
FÏgs
::
B™
 
‘y³
 = 
	`’t™y_¬gum’t
(
¬gum’t
, 
¬g
);

334 
numb”
 = 
	`numb”_¬gum’t
(
¬g
,‡rg);

336 ià(
‘y³
 =ğ
ENTITY_VM
)

337 
vnum
 = 
	`©oi
(
¬g
);

339 autØ
wch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

340 ià(
wch
->
š_room
 =ğ
nuÎ±r
)

343 ià(
‘y³
 =ğ
ENTITY_VM
) {

344 ià(!
wch
->
	`is_Åc
(è|| !wch->
pIndexD©a
 || wch->pIndexD©a->
vnum
 != vnum)

348 ià(
‘y³
 !ğ0 && !
	`CHARTYPE_MATCH
(
wch
,ƒtype))

351 ià(!
¬g
.
	`em±y
(è&& !
wch
->
Çme
.
	`has_wÜds
(arg))

355 
vis
) {

356 
VIS_PLR
: ià(!
	`ÿn_£e_who
(
ch
, 
wch
)) ; ;

358 
VIS_CHAR
: ià(!
	`ÿn_£e_ch¬
(
ch
, 
wch
)) ; ;

363 ià(++
couÁ
 =ğ
numb”
)

364  
wch
;

367  
nuÎ±r
;

368 
	}
}

372 
Ch¬aù”
 *
	$g‘_¶ay”_h”e
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
)

374 
Ch¬aù”
 *
rch
;

376 ià(
¬gum’t
 == "self")

377  
ch
;

379 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

380  
nuÎ±r
;

382 
rch
 = 
ch
->
š_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
) {

383 
vis
) {

384 
VIS_PLR
: ià(!
	`ÿn_£e_who
(
ch
, 
rch
)) ; ;

386 
VIS_CHAR
: ià(!
	`ÿn_£e_ch¬
(
ch
, 
rch
)) ; ;

391 ià(!
rch
->
	`is_Åc
()

392 && 
rch
->
Çme
.
	`has_wÜds
(
¬gum’t
))

393  
rch
;

396  
nuÎ±r
;

397 
	}
}

401 
Ch¬aù”
 *
	$g‘_¶ay”_¬—
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
)

403 ià(
¬gum’t
 == "self")

404  
ch
;

406 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

407  
nuÎ±r
;

409 autØ
ach
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

410 ià(
ach
->
	`is_Åc
())

413 
vis
) {

414 
VIS_PLR
: ià(!
	`ÿn_£e_who
(
ch
, 
ach
)) ; ;

416 
VIS_CHAR
: ià(!
	`ÿn_£e_ch¬
(
ch
, 
ach
)) ; ;

421 ià(
ach
->
š_room
 !ğ
nuÎ±r


422 && 
ach
->
š_room
->
	`¬—
(è=ğ
ch
->in_room->area()

423 && 
ach
->
Çme
.
	`has_wÜds
(
¬gum’t
))

424  
ach
;

427  
nuÎ±r
;

428 
	}
}

432 
Ch¬aù”
 *
	$g‘_¶ay”_wÜld
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
)

434 ià(
¬gum’t
 == "self")

435  
ch
;

437 ià(
¬gum’t
.
	`em±y
())

438  
nuÎ±r
;

440 autØ
wch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

441 ià(
wch
->
	`is_Åc
())

444 
vis
) {

445 
VIS_PLR
: ià(!
	`ÿn_£e_who
(
ch
, 
wch
)) ; ;

447 
VIS_CHAR
: ià(!
	`ÿn_£e_ch¬
(
ch
, 
wch
)) ; ;

452 ià(
wch
->
š_room
 !ğ
nuÎ±r


453 && 
wch
->
Çme
.
	`has_wÜds
(
¬gum’t
))

454  
wch
;

457  
nuÎ±r
;

458 
	}
}

461 
Objeù
 *
	$g‘_obj_li¡
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
Objeù
 *
li¡
)

463 
Objeù
 *
obj
;

464 
numb”
, 
couÁ
 = 0;

465 
SŒšg
 
¬g
;

466 
numb”
 = 
	`numb”_¬gum’t
(
¬gum’t
, 
¬g
);

468 
obj
 = 
li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
)

469 ià(
	`ÿn_£e_obj
(
ch
, 
obj
è&& (
¬g
.
	`em±y
(è|| obj->
Çme
.
	`has_wÜds
(arg)))

470 ià(++
couÁ
 =ğ
numb”
)

473  
obj
;

474 
	}
}

477 
Objeù
 *
	$g‘_obj_w—r
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

479 
Objeù
 *
obj
;

480 
numb”
, 
couÁ
 = 0;

481 
SŒšg
 
¬g
;

482 
numb”
 = 
	`numb”_¬gum’t
(
¬gum’t
, 
¬g
);

484 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
)

485 ià(
obj
->
w—r_loc
 !ğ
WEAR_NONE


486 && 
	`ÿn_£e_obj
(
ch
, 
obj
)

487 && (
¬g
.
	`em±y
(è|| 
obj
->
Çme
.
	`has_wÜds
(arg)))

488 ià(++
couÁ
 =ğ
numb”
)

491  
obj
;

492 
	}
}

495 
Objeù
 *
	$g‘_obj_ÿ¼y
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

497 
Objeù
 *
obj
;

498 
numb”
, 
couÁ
 = 0;

499 
SŒšg
 
¬g
;

500 
numb”
 = 
	`numb”_¬gum’t
(
¬gum’t
, 
¬g
);

502 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
)

503 ià(
obj
->
w—r_loc
 =ğ
WEAR_NONE


504 && 
	`ÿn_£e_obj
(
ch
, 
obj
)

505 && (
¬g
.
	`em±y
(è|| 
obj
->
Çme
.
	`has_wÜds
(arg)))

506 ià(++
couÁ
 =ğ
numb”
)

509  
obj
;

510 
	}
}

513 
Objeù
 *
	$g‘_obj_h”e
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

515 
Objeù
 *
obj
;

517 ià((
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬gum’t
, ch->
š_room
->
cÚ‹Ás
)è!ğ
nuÎ±r
)

518  
obj
;

520 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬gum’t
)è!ğ
nuÎ±r
)

521  
obj
;

523 ià((
obj
 = 
	`g‘_obj_w—r
(
ch
, 
¬gum’t
)è!ğ
nuÎ±r
)

524  
obj
;

526  
nuÎ±r
;

527 
	}
}

530 
Objeù
 *
	$g‘_obj_wÜld
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

532 
Objeù
 *
obj
;

533 
numb”
, 
couÁ
 = 0;

535 ià((
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬gum’t
)è!ğ
nuÎ±r
)

536  
obj
;

538 
SŒšg
 
¬g
;

539 
numb”
 = 
	`numb”_¬gum’t
(
¬gum’t
, 
¬g
);

541 
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj; obj = obj->
Ãxt
)

542 ià(
	`ÿn_£e_obj
(
ch
, 
obj
)

543 && (
¬g
.
	`em±y
(è|| 
obj
->
Çme
.
	`has_wÜds
(arg)))

544 ià(++
couÁ
 =ğ
numb”
)

547  
obj
;

548 
	}
}

	@src/flag.cc

28 
	~<veùÜ
>

30 
	~"¬gum’t.hh
"

31 
	~"A»a.hh
"

32 
	~"Ch¬aù”.hh
"

33 
	~"deş¬e.hh
"

34 
	~"fšd.hh
"

35 
	~"FÏgs.hh
"

36 
	~"FÜm©.hh
"

37 
	~"Game.hh
"

38 
	~"š‹½.hh
"

39 
	~"m”c.hh
"

40 
	~"MobePrÙÙy³.hh
"

41 
	~"Objeù.hh
"

42 
	~"ObjeùPrÙÙy³.hh
"

43 
	~"PÏy”.hh
"

44 
	~"Room.hh
"

45 
	~"SŒšg.hh
"

46 
	~"bËs.hh
"

47 
	~"WÜld.hh
"

49 
	$do_æag
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

51 
wh©
[
MIL
];

52 
Ch¬aù”
 *
viùim
 = 
nuÎ±r
;

53 
Objeù
 *
objeù
;

54 
Room
 *
room
;

55 
FÏgs
 *
æag
, 
Şd
, 
nw
, 
m¬ked
;

56 
f›ld±r
;

57 
ty³
;

59 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
, 
wÜd
;

60 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

61 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

62 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g3
);

63 
ty³
 = 
¬gum’t
[0];

65 ià(
ty³
 == '=' ||ype == '-' ||ype == '+')

66 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
wÜd
);

68 ià(
¬g1
.
	`em±y
()) {

69 
	`¡c
("Syntax:\n"

80 " U£ 'æag£¬ch'Øfšdhšg w™h c”š fÏgs.\n", 
ch
);

84 ià(
¬g2
.
	`em±y
()) {

85 
	`¡c
("Wh© dØyou wishØ£ˆæag Ú?\n", 
ch
);

89 ià(
¬g3
.
	`em±y
()) {

90 
	`¡c
("You‚“dØ¥ecify‡ f›ldØmodify.\n", 
ch
);

91 
	`do_æagli¡
(
ch
, "");

95 
f›ld±r
 = 0; f›ld±¸< 
æag_f›lds
.
	`size
(); fieldptr++)

96 ià(
¬g3
.
	`is_´efix_of
(
æag_f›lds
[
f›ld±r
].
Çme
))

99 ià(
f›ld±r
 =ğ
æag_f›lds
.
	`size
()) {

100 
	`¡c
("Th© i nÙ‡ v®id fÏg f›ld.\n", 
ch
);

101 
	`do_æagli¡
(
ch
, "");

105 ià(
¬gum’t
.
	`em±y
()) {

106 
	`¡c
("Which fÏg dØyou wishØchªge?\n", 
ch
);

107 
	`do_æagli¡
(
ch
, 
¬g3
);

111 ià(
¬g1
.
	`is_´efix_of
("mobile") ||‡rg1.is_prefix_of("character") ||‡rg1.is_prefix_of("player")) {

112 ià(
æag_f›lds
[
f›ld±r
].
ÿnd
 !ğ
CAND_CHAR


113 && 
æag_f›lds
[
f›ld±r
].
ÿnd
 !ğ
CAND_MOB


114 && 
æag_f›lds
[
f›ld±r
].
ÿnd
 !ğ
CAND_PLAYER
) {

115 
	`¡c
("Th© i nÙ‡ ch¬aù” f›ld.\n", 
ch
);

119 ià(
¬g1
.
	`is_´efix_of
("mobile"))

120 
viùim
 = 
	`g‘_mob_wÜld
(
ch
, 
¬g2
, 
VIS_CHAR
);

121 ià(
¬g1
.
	`is_´efix_of
("player"))

122 
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g2
, 
VIS_PLR
);

124 
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g2
, 
VIS_CHAR
);

126 ià(
viùim
 =ğ
nuÎ±r
) {

127 
	`¡c
("You cª'ˆfšdhem.\n", 
ch
);

131 ià(
viùim
->
	`is_Åc
()) {

132 ià(
æag_f›lds
[
f›ld±r
].
ÿnd
 =ğ
CAND_PLAYER
) {

133 
	`¡c
("Th© f›ld may‚Ù bchªged oÀmobes.\n", 
ch
);

137 ià(
	`GET_RANK
(
ch
è< 
æag_f›lds
[
f›ld±r
].
mod_mob
) {

138 
	`¡c
("You‡»‚Ù highƒnough†ev–Øchªgth© f›ld oÀmobes.\n", 
ch
);

142 
f›ld±r
) {

143 
FIELD_ACT
: 
æag
 = &
viùim
->
aù_æags
; ;

144 
FIELD_OFF
: 
æag
 = &
viùim
->
off_æags
; ;

145 
FIELD_FORM
: 
æag
 = &
viùim
->
fÜm_æags
; ;

146 
FIELD_PART
: 
æag
 = &
viùim
->
·¹s_æags
; ;

147 
FIELD_COMM
: 
æag
 = &
viùim
->
comm_æags
; ;

148 
FIELD_CENSOR
: 
æag
 = &
viùim
->
ûnsÜ_æags
; ;

149 
FIELD_REVOKE
: 
æag
 = &
viùim
->
»voke_æags
; ;

152 
	`±c
(
ch
, "Th© i nÙ‡Àacû±abË % æag.\n", 
¬g1
);

153 
	`do_æagli¡
(
ch
, 
¬g3
);

158 ià(
æag_f›lds
[
f›ld±r
].
ÿnd
 =ğ
CAND_MOB
) {

159 
	`¡c
("Th© f›ld may‚Ù bchªged oÀ¶ay”s.\n", 
ch
);

163 ià(
	`GET_RANK
(
ch
è< 
æag_f›lds
[
f›ld±r
].
mod_¶r
) {

164 
	`¡c
("You‡»‚Ù highƒnough†ev–Øchªgth© f›ld oÀ¶ay”s.\n", 
ch
);

168 
f›ld±r
) {

169 
FIELD_PLAYER
: 
æag
 = &
viùim
->
aù_æags
; ;

170 
FIELD_PCDATA
: 
æag
 = &
viùim
->
pcd©a
->
¶r_æags
; ;

171 
FIELD_WIZNET
: 
æag
 = &
viùim
->
wizÃt_æags
; ;

172 
FIELD_CGROUP
: 
æag
 = &
viùim
->
pcd©a
->
cgroup_æags
; ;

173 
FIELD_COMM
: 
æag
 = &
viùim
->
comm_æags
; ;

174 
FIELD_CENSOR
: 
æag
 = &
viùim
->
ûnsÜ_æags
; ;

175 
FIELD_REVOKE
: 
æag
 = &
viùim
->
»voke_æags
; ;

178 
	`±c
(
ch
, "Th© i nÙ‡Àacû±abË % æag.\n", 
¬g1
);

179 
	`do_æagli¡
(
ch
, 
¬g3
);

184 
FÜm©
::
	`¥rštf
(
wh©
, "%s", 
	`PERS
(
viùim
, 
ch
, 
VIS_PLR
));

186 ià(
¬g1
.
	`is_´efix_of
("obj")) {

187 ià(
æag_f›lds
[
f›ld±r
].
ÿnd
 !ğ
CAND_OBJ
) {

188 
	`¡c
("Th© i nÙ‡Àobjeù f›ld.\n", 
ch
);

192 ià(
	`GET_RANK
(
ch
è< 
æag_f›lds
[
f›ld±r
].
mod_mob
) {

193 
	`¡c
("You‡»‚Ù highƒnough†ev–Øchªgth© f›ld.\n", 
ch
);

197 ià((
objeù
 = 
	`g‘_obj_wÜld
(
ch
, 
¬g2
)è=ğ
nuÎ±r
) {

198 
	`¡c
("You cª'ˆfšd it.\n", 
ch
);

202 
FÜm©
::
	`¥rštf
(
wh©
, "%s", 
objeù
->
Çme
);

204 
f›ld±r
) {

205 
FIELD_EXTRA
: 
æag
 = &
objeù
->
exŒa_æags
; ;

207 
FIELD_WEAR
: 
æag
 = &
objeù
->
w—r_æags
; ;

208 
FIELD_WEAPON
:

209 ià(
objeù
->
™em_ty³
 !ğ
ITEM_WEAPON
) {

210 
	`¡c
("Th© i nÙ‡ w—pÚ.\n", 
ch
);

215 
	`¡c
("W—pÚ fÏggšg ha b“À‹mpÜ¬y„emoved.\n", 
ch
);

219 
	`¡c
("Th©' nÙ‡Àacû±abË objeù fÏg.\n", 
ch
);

220 
	`do_æagli¡
(
ch
, 
¬g3
);

224 ià(
¬g1
.
	`is_´efix_of
("room")) {

225 ià(
æag_f›lds
[
f›ld±r
].
ÿnd
 !ğ
CAND_ROOM
) {

226 
	`¡c
("Th© i nÙ‡„oom f›ld.\n", 
ch
);

230 ià(
	`GET_RANK
(
ch
è< 
æag_f›lds
[
f›ld±r
].
mod_mob
) {

231 
	`¡c
("You‡»‚Ù highƒnough†ev–Øchªgth© f›ld.\n", 
ch
);

235 ià(!
¬g2
.
	`is_numb”
()) {

236 
	`¡c
("U£hroom' vnum o¸coÜdš©es.\n", 
ch
);

240 ià((
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
¬g2
))è=ğ
nuÎ±r
) {

241 
	`±c
(
ch
, "Room % dÛ nÙƒxi¡.\n", 
¬g2
);

245 
FÜm©
::
	`¥rštf
(
wh©
, "%s", 
room
->
	`Çme
());

247 ià(
f›ld±r
 =ğ
FIELD_ROOM
è
æag
 = &
room
->
room_æags
;

249 
	`¡c
("Th©' nÙ‡Àacû±abË„oom fÏg.\n", 
ch
);

250 
	`do_æagli¡
(
ch
, 
¬g3
);

255 
	`¡c
("PËa£ s³cify : mob, ch¬,…Ïy”, obj o¸room.\n", 
ch
);

259 
Şd
 = *
æag
;

260 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
>& 
æag_bË
 = 
æag_f›lds
[
f›ld±r
].flag_table;

262 ià(
ty³
 != '=')

263 
nw
 = 
Şd
;

267 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
wÜd
);

269 ià(
wÜd
.
	`em±y
())

272 ià(
wÜd
.
	`size
() == 1) {

273 
FÏgs
 
	`æag
(
wÜd
);

275 ià(
æag
.
	`em±y
()) {

276 
	`¡c
("Th© fÏg dÛ¢'ˆexi¡!\n", 
ch
);

277 
	`do_æagli¡
(
ch
, 
¬g3
);

281 
m¬ked
 +ğ
æag
;

284 
pos
 = 
	`æag_šdex_lookup
(
wÜd
, 
æag_bË
);

286 ià(
pos
 < 0) {

287 
	`¡c
("Th© fÏg dÛ¢'ˆexi¡!\n", 
ch
);

288 
	`do_æagli¡
(
ch
, 
¬g3
);

292 
m¬ked
 +ğ
æag_bË
[
pos
].
b™
;

295 cÚ¡‡uto& 
’Œy
 : 
æag_bË
) {

296 ià(!
’Œy
.
£‰abË
 && 
Şd
.
	`has
ÓÁry.
b™
)) {

297 
nw
 +ğ
’Œy
.
b™
;

301 ià(
m¬ked
.
	`has
(
’Œy
.
b™
)) {

302 
ty³
) {

305 
nw
 +ğ
’Œy
.
b™
;

306 
	`±c
(
ch
, "%s %s bit set on %s.\n",

307 
’Œy
.
Çme
, 
¬g3
, 
wh©
);

311 
nw
 -ğ
’Œy
.
b™
;

312 
	`±c
(
ch
, "%s %s bit„emoved from %s.\n",

313 
’Œy
.
Çme
, 
¬g3
, 
wh©
);

317 ià(
nw
.
	`has
(
’Œy
.
b™
)) {

318 
nw
 -ğ
’Œy
.
b™
;

319 
	`±c
(
ch
, "%s %s bit„emoved from %s.\n",

320 
’Œy
.
Çme
, 
¬g3
, 
wh©
);

323 
nw
 +ğ
’Œy
.
b™
;

324 
	`±c
(
ch
, "%s %s bit set on %s.\n",

325 
’Œy
.
Çme
, 
¬g3
, 
wh©
);

333 *
æag
 = 
nw
;

334 
	}
}

336 
	$do_ty³li¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

338 ià(
¬gum’t
.
	`em±y
()) {

339 
	`¡c
("V®id†i¡s:†iquid,‡‰ack\n", 
ch
);

343 ià(
¬gum’t
.
	`is_´efix_of
("liquid")) {

344 
x
 = 0; x < 
liq_bË
.
	`size
(); x++)

345 
	`±c
(
ch
, "[%2d][%20s][%20s]\n", 
x
, 
liq_bË
[x].
Çme
,†iq_bË[x].
cŞÜ
);

347 ià(
¬gum’t
.
	`is_´efix_of
("attack")) {

348 
x
 = 0; x < 
©ck_bË
.
	`size
(); x++)

349 
	`±c
(
ch
, "[%2d][%20s][%20s]\n", 
x
, 
©ck_bË
[x].
Çme
,‡‰ack_bË[x].
noun
);

352 
	`¡c
("V®id†i¡s:†iquid,‡‰ack\n", 
ch
);

353 
	}
}

355 
	$do_æagli¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

357 ià(
¬gum’t
.
	`em±y
()) {

358 
	`¡c
("FÏg f›ld ¬e:\n", 
ch
);

360 cÚ¡‡uto& 
’Œy
 : 
æag_f›lds
)

361 ià(
	`GET_RANK
(
ch
è>ğ
’Œy
.
£e_mob


362 || 
	`GET_RANK
(
ch
è>ğ
’Œy
.
£e_¶r
)

363 
	`±c
(
ch
, "%-30s%s\n", 
’Œy
.
Çme
,

364 
f›ld_ÿnd
[
’Œy
.
ÿnd
]);

369 
x
;

370 
x
 = 0; x < 
æag_f›lds
.
	`size
(); x++)

371 ià(
	`GET_RANK
(
ch
è>ğ
æag_f›lds
[
x
].
£e_mob


372 || 
	`GET_RANK
(
ch
è>ğ
æag_f›lds
[
x
].
£e_¶r
)

373 ià(
¬gum’t
.
	`is_´efix_of
(
æag_f›lds
[
x
].
Çme
))

376 ià(
x
 >ğ
æag_f›lds
.
	`size
()) {

377 
	`¡c
("Th”i nØsuch f›ld.\n", 
ch
);

381 
	`±c
(
ch
, "FÏg šh% f›ld:\n", 
æag_f›lds
[
x
].
Çme
);

383 cÚ¡‡uto& 
’Œy
 : 
æag_f›lds
[
x
].
æag_bË
)

384 
	`±c
(
ch
, "[%2s] %s\n", 
	`FÏgs
(
’Œy
.
b™
).
	`to_¡ršg
(),ƒÁry.
Çme
);

385 
	}
}

389 
	$f£¬ch_¶ay”
(
Ch¬aù”
 *
ch
, 
f›ld±r
, cÚ¡ 
FÏgs
& 
m¬ked
)

391 
buf
[
MSL
];

392 
SŒšg
 
ouut
;

393 
couÁ
 = 0;

394 
FÏgs
 
æag
;

395 
ouut
 += "{VCount {YRoom{x\n";

397 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

398 ià(
viùim
->
	`is_Åc
()

399 || 
viùim
->
š_room
 =ğ
nuÎ±r


400 || !
	`ÿn_£e_ch¬
(
ch
, 
viùim
)

401 || !
	`ÿn_£e_room
(
ch
, 
viùim
->
š_room
))

405 
f›ld±r
) {

406 
FIELD_PLAYER
: 
æag
 = 
viùim
->
aù_æags
; ;

408 
FIELD_PCDATA
: 
æag
 = 
viùim
->
pcd©a
->
¶r_æags
; ;

410 
FIELD_WIZNET
: 
æag
 = 
viùim
->
wizÃt_æags
; ;

412 
FIELD_CGROUP
: 
æag
 = 
viùim
->
pcd©a
->
cgroup_æags
; ;

414 
FIELD_COMM
: 
æag
 = 
viùim
->
comm_æags
; ;

416 
FIELD_CENSOR
: 
æag
 = 
viùim
->
ûnsÜ_æags
; ;

418 
FIELD_REVOKE
: 
æag
 = 
viùim
->
»voke_æags
; ;

423 ià(!
æag
.
	`has_®l_of
(
m¬ked
))

426 ià(++
couÁ
 > 500)

429 
FÜm©
::
	`¥rštf
(
buf
, "{M[{V%3d{M]{b[{Y%9s{b]{x %s{x.\n",

430 
couÁ
,

431 
viùim
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(
çl£
),

432 
viùim
->
shÜt_desü
);

433 
ouut
 +ğ
buf
;

436 ià(
couÁ
 > 0)

437 
	`·ge_to_ch¬
(
ouut
, 
ch
);

439  
couÁ
;

440 
	}
}

442 
	$f£¬ch_mobe
(
Ch¬aù”
 *
ch
, 
f›ld±r
, cÚ¡ 
FÏgs
& 
m¬ked
)

444 
buf
[
MSL
];

445 
SŒšg
 
ouut
;

446 
couÁ
 = 0;

447 
FÏgs
 
æag
;

448 
ouut
 += "{VCount {YRoom {GMob{x\n";

450 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

451 ià(!
viùim
->
	`is_Åc
()

452 || 
viùim
->
š_room
 =ğ
nuÎ±r


453 || !
	`ÿn_£e_ch¬
(
ch
, 
viùim
)

454 || !
	`ÿn_£e_room
(
ch
, 
viùim
->
š_room
))

458 
f›ld±r
) {

459 
FIELD_ACT
: 
æag
 = 
viùim
->
aù_æags
; ;

461 
FIELD_OFF
: 
æag
 = 
viùim
->
off_æags
; ;

463 
FIELD_FORM
: 
æag
 = 
viùim
->
fÜm_æags
; ;

465 
FIELD_PART
: 
æag
 = 
viùim
->
·¹s_æags
; ;

467 
FIELD_COMM
: 
æag
 = 
viùim
->
comm_æags
; ;

469 
FIELD_CENSOR
: 
æag
 = 
viùim
->
ûnsÜ_æags
; ;

471 
FIELD_REVOKE
: 
æag
 = 
viùim
->
»voke_æags
; ;

476 ià(!
æag
.
	`has_®l_of
(
m¬ked
))

479 ià(++
couÁ
 > 500)

482 
FÜm©
::
	`¥rštf
(
buf
, "{M[{V%3d{M]{b[{Y%9s{b]{H[{G%5d{H]{x %s{x.\n",

483 
couÁ
,

484 
viùim
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(
çl£
),

485 
viùim
->
pIndexD©a
->
vnum
,

486 
viùim
->
shÜt_desü
);

487 
ouut
 +ğ
buf
;

490 ià(
couÁ
 > 0)

491 
	`·ge_to_ch¬
(
ouut
, 
ch
);

493  
couÁ
;

494 
	}
}

496 
	$f£¬ch_ch¬
(
Ch¬aù”
 *
ch
, 
f›ld±r
, cÚ¡ 
FÏgs
& 
m¬ked
, 
boŞ
 
mobe
, boŞ 
¶ay”
)

498 
buf
[
MSL
];

499 
SŒšg
 
ouut
;

500 
mobecouÁ
 = 0, 
¶ay”couÁ
 = 0;

502 ià(
mobe
è
mobecouÁ
 = 
	`f£¬ch_mobe
(
ch
, 
f›ld±r
, 
m¬ked
);

504 ià(
¶ay”
è
¶ay”couÁ
 = 
	`f£¬ch_¶ay”
(
ch
, 
f›ld±r
, 
m¬ked
);

507 ià(
mobe
) {

508 ià(
mobecouÁ
 == 0)

509 
FÜm©
::
	`¥rštf
(
buf
, "You found‚o mobiles matching your search criteria.\n");

511 
FÜm©
::
	`¥rštf
(
buf
, "You found %d matching mobile%s%s.\n",

512 
mobecouÁ
,

513 
mobecouÁ
 > 1 ? "s" : "",

514 
mobecouÁ
 > 500 ? ", of which 500‡re shown" : "");

516 
ouut
 +ğ
buf
;

519 ià(
¶ay”
) {

520 ià(
¶ay”couÁ
 == 0)

521 
FÜm©
::
	`¥rštf
(
buf
, "You found‚o…layers matching your search criteria.\n");

523 
FÜm©
::
	`¥rštf
(
buf
, "You found %d matching…layer%s%s.\n",

524 
¶ay”couÁ
,

525 
¶ay”couÁ
 > 1 ? "s" : "",

526 
¶ay”couÁ
 > 500 ? ", of which 500‡re shown" : "");

528 
ouut
 +ğ
buf
;

531 
	`·ge_to_ch¬
(
ouut
, 
ch
);

532 
	}
}

534 
	$f£¬ch_room
(
Ch¬aù”
 *
ch
, 
f›ld±r
, cÚ¡ 
FÏgs
& 
m¬ked
)

536 
buf
[
MSL
];

537 
SŒšg
 
ouut
;

538 
couÁ
 = 0;

539 
FÏgs
 
æag
;

540 
ouut
 += "{VCount {GVnum{x\n";

542 auto& 
¬—_·œ
 : 
Game
::
	`wÜld
().
¬—s
) {

543 cÚ¡‡uto& 
·œ
 : 
¬—_·œ
.
£cÚd
->
rooms
) {

544 cÚ¡ 
RoomID
& 
loÿtiÚ
 = 
·œ
.
fœ¡
;

545 cÚ¡ 
Room
* 
room
 = 
·œ
.
£cÚd
;

547 ià(!
	`ÿn_£e_room
(
ch
, 
room
))

550 
f›ld±r
) {

551 
FIELD_ROOM
: 
æag
 = 
room
->
	`æags
(); ;

556 ià(!
æag
.
	`has_®l_of
(
m¬ked
))

559 ià(++
couÁ
 > 500)

562 
FÜm©
::
	`¥rštf
(
buf
, "{M[{V%3d{M]{H[{G%5d{H]{x %s{x.\n",

563 
couÁ
,

564 
loÿtiÚ
.
	`to_¡ršg
(),

565 
room
->
	`Çme
());

566 
ouut
 +ğ
buf
;

570 ià(
couÁ
 == 0)

571 
	`¡c
("You found‚Øroom m©chšg you¸£¬ch cr™”Ÿ.\n", 
ch
);

573 
FÜm©
::
	`¥rštf
(
buf
, "You found %d matching„oom%s%s.\n",

574 
couÁ
,

575 
couÁ
 > 1 ? "s" : "",

576 
couÁ
 > 500 ? ", of which 500‡re shown" : "");

577 
ouut
 +ğ
buf
;

578 
	`·ge_to_ch¬
(
ouut
, 
ch
);

581 
	}
}

583 
	$f£¬ch_obj
(
Ch¬aù”
 *
ch
, 
f›ld±r
, cÚ¡ 
FÏgs
& 
m¬ked
)

585 
buf
[
MSL
];

586 
SŒšg
 
ouut
;

587 
Objeù
 *
obj
, *
š_obj
;

588 
couÁ
 = 1;

589 
FÏgs
 
æag
;

590 
ouut
 += "{VCount {YRoom {GObject{x\n";

593 
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt
) {

595 
f›ld±r
) {

596 
FIELD_EXTRA
: 
æag
 = 
obj
->
exŒa_æags
; ;

598 
FIELD_WEAR
: 
æag
 = 
obj
->
w—r_æags
; ;

600 
FIELD_WEAPON
: 
æag
 = 
obj
->
v®ue
[0]; ;

605 ià(!
æag
.
	`has_®l_of
(
m¬ked
))

608 
š_obj
 = 
obj
; in_obj->š_obj !ğ
nuÎ±r
; in_obj = in_obj->in_obj)

611 ià(
š_obj
->
ÿ¼›d_by
) {

612 ià(
š_obj
->
ÿ¼›d_by
->
š_room
 =ğ
nuÎ±r


613 || !
	`ÿn_£e_room
(
ch
, 
š_obj
->
ÿ¼›d_by
->
š_room
)

614 || !
	`ÿn_£e_ch¬
(
ch
, 
š_obj
->
ÿ¼›d_by
))

617 
FÜm©
::
	`¥rštf
(
buf
, "{M[{V%3d{M]{b[{Y%9s{b]{H[{G%5d{H]{x %s{x is carried by %s.\n",

618 
couÁ
,

619 
š_obj
->
ÿ¼›d_by
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(
çl£
),

620 
obj
->
pIndexD©a
->
vnum
,

621 
obj
->
shÜt_desü
,

622 
	`PERS
(
š_obj
->
ÿ¼›d_by
, 
ch
, 
VIS_PLR
));

624 ià(
š_obj
->
š_lock”
) {

625 ià(
š_obj
->
š_lock”
->
š_room
 =ğ
nuÎ±r


626 || !
	`ÿn_£e_room
(
ch
, 
š_obj
->
š_lock”
->
š_room
)

627 || !
	`ÿn_£e_ch¬
(
ch
, 
š_obj
->
š_lock”
))

630 
FÜm©
::
	`¥rštf
(
buf
, "{M[{V%3d{M]{b[{Y%9s{b]{H[{G%5d{H]{x %s{x is in %s's†ocker.\n",

631 
couÁ
,

632 
š_obj
->
š_lock”
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(
çl£
),

633 
obj
->
pIndexD©a
->
vnum
,

634 
obj
->
shÜt_desü
,

635 
	`PERS
(
š_obj
->
š_lock”
, 
ch
, 
VIS_PLR
));

637 ià(
š_obj
->
š_¡rÚgbox
) {

638 ià(
š_obj
->
š_¡rÚgbox
->
š_room
 =ğ
nuÎ±r


639 || !
	`ÿn_£e_room
(
ch
, 
š_obj
->
š_¡rÚgbox
->
š_room
)

640 || !
	`ÿn_£e_ch¬
(
ch
, 
š_obj
->
š_¡rÚgbox
))

643 
FÜm©
::
	`¥rštf
(
buf
, "{M[{V%3d{M]{b[{Y%9s{b]{H[{G%5d{H]{x %s{x is in %s's strongbox.\n",

644 
couÁ
,

645 
š_obj
->
š_¡rÚgbox
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(
çl£
),

646 
obj
->
pIndexD©a
->
vnum
,

647 
obj
->
shÜt_desü
,

648 
	`PERS
(
š_obj
->
š_¡rÚgbox
, 
ch
, 
VIS_PLR
));

650 ià(
š_obj
->
š_room
) {

651 ià(!
	`ÿn_£e_room
(
ch
, 
š_obj
->
š_room
))

654 
FÜm©
::
	`¥rštf
(
buf
, "{M[{V%3d{M]{b[{Y%9s{b]{H[{G%5d{H]{x %s{x in %s.\n",

655 
couÁ
,

656 
š_obj
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(
çl£
),

657 
obj
->
pIndexD©a
->
vnum
,

658 
obj
->
shÜt_desü
,

659 
š_obj
->
š_room
->
	`Çme
());

664 ià(++
couÁ
 <= 500)

665 
ouut
 +ğ
buf
;

668 ià(--
couÁ
 == 0)

669 
	`¡c
("You found‚Ø™em m©chšg you¸£¬ch cr™”Ÿ.\n", 
ch
);

671 
FÜm©
::
	`¥rštf
(
buf
, "You found %d matching item%s%s.\n",

672 
couÁ
,

673 
couÁ
 > 1 ? "s" : "",

674 
couÁ
 > 500 ? ", of which 500‡re shown" : "");

675 
ouut
 +ğ
buf
;

676 
	`·ge_to_ch¬
(
ouut
, 
ch
);

679 
	}
}

681 
	$do_æag£¬ch
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

683 
f›ld±r
;

684 
FÏgs
 
m¬ked
;

685 
pos
;

686 
boŞ
 
¶ay”
 = 
Œue
, 
mobe
 =rue, 
toŞowmobe
 = 
çl£
, 
toŞow¶ay”
 = false;

688 
SŒšg
 
¬g1
, 
¬g2
, 
wÜd
;

689 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

690 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

692 ià(
¬g1
.
	`em±y
()) {

693 
	`¡c
("Syntax:\n"

704 " U£ 'æag'Ø£ˆæags.\n", 
ch
);

708 ià(
¬g2
.
	`em±y
()) {

709 
	`¡c
("You mu¡ s³cify‡ f›ld oàæag tØ£¬ch fÜ.\n", 
ch
);

713 
f›ld±r
 = 0; f›ld±¸< 
æag_f›lds
.
	`size
(); fieldptr++)

714 ià(
¬g2
.
	`is_´efix_of
(
æag_f›lds
[
f›ld±r
].
Çme
))

717 ià(
f›ld±r
 >ğ
æag_f›lds
.
	`size
()) {

718 
	`¡c
("Th© i nÙ‡ v®id fÏg f›ld.\n", 
ch
);

722 ià(
¬gum’t
.
	`em±y
()) {

723 
	`¡c
("You mu¡ s³cify‡ˆËa¡ oÃ fÏgØ£¬ch fÜ.\n", 
ch
);

727 ià(
¬g1
.
	`is_´efix_of
("mobile")

728 || 
¬g1
.
	`is_´efix_of
("player")

729 || 
¬g1
.
	`is_´efix_of
("character")) {

730 ià(
æag_f›lds
[
f›ld±r
].
ÿnd
 !ğ
CAND_CHAR


731 && 
æag_f›lds
[
f›ld±r
].
ÿnd
 !ğ
CAND_MOB


732 && 
æag_f›lds
[
f›ld±r
].
ÿnd
 !ğ
CAND_PLAYER
) {

733 
	`¡c
("Th© i nÙ‡ ch¬aù” f›ld.\n", 
ch
);

737 ià(
¬g1
.
	`is_´efix_of
("mobe")è
¶ay”
 = 
çl£
;

739 ià(
¬g1
.
	`is_´efix_of
("¶ay”")è
mobe
 = 
çl£
;

741 ià(
	`GET_RANK
(
ch
è< 
æag_f›lds
[
f›ld±r
].
£e_mob
è
toŞowmobe
 = 
Œue
;

743 ià(
	`GET_RANK
(
ch
è< 
æag_f›lds
[
f›ld±r
].
£e_¶r
è
toŞow¶ay”
 = 
Œue
;

745 ià(
toŞowmobe
 && 
toŞow¶ay”
) {

746 
	`¡c
("You‡»‚Ù highƒnough†ev–Ø£¬ch fÜh© f›ld.\n", 
ch
);

750 ià(!
¶ay”
) {

751 ià(
æag_f›lds
[
f›ld±r
].
ÿnd
 =ğ
CAND_PLAYER
) {

752 
	`¡c
("Mobe dØnÙ havth© f›ld.\n", 
ch
);

756 ià(
toŞowmobe
) {

757 
	`¡c
("You‡»‚Ù highƒnough†ev–Ø£¬ch fÜh© f›ld oÀmobes.\n", 
ch
);

761 ià(!
mobe
) {

762 ià(
æag_f›lds
[
f›ld±r
].
ÿnd
 =ğ
CAND_MOB
) {

763 
	`¡c
("PÏy” dØnÙ havth© f›ld.\n", 
ch
);

767 ià(
toŞow¶ay”
) {

768 
	`¡c
("You‡»‚Ù highƒnough†ev–Ø£¬ch fÜh© f›ld oÀ¶ay”s.\n", 
ch
);

773 ià((
æag_f›lds
[
f›ld±r
].
ÿnd
 =ğ
CAND_MOB
 && 
toŞowmobe
)

774 || (
æag_f›lds
[
f›ld±r
].
ÿnd
 =ğ
CAND_PLAYER
 && 
toŞow¶ay”
)) {

775 
	`¡c
("You‡»‚Ù highƒnough†ev–Ø£¬ch fÜh© f›ld.\n", 
ch
);

780 
f›ld±r
) {

781 
FIELD_PLAYER
:

782 
FIELD_PCDATA
:

783 
FIELD_CGROUP
:

784 
FIELD_WIZNET
: 
mobe
 = 
çl£
; ;

786 
FIELD_ACT
:

787 
FIELD_OFF
:

788 
FIELD_FORM
:

789 
FIELD_PART
: 
¶ay”
 = 
çl£
; ;

791 
FIELD_REVOKE
:

792 
FIELD_CENSOR
:

793 
FIELD_COMM
: ;

796 
	`¡c
("Th© i nÙ‡ ch¬aù” f›ld.\n", 
ch
);

800 ià(
¬g1
.
	`is_´efix_of
("obj")) {

801 ià(
æag_f›lds
[
f›ld±r
].
ÿnd
 =ğ
CAND_OBJ
) {

802 ià(
	`GET_RANK
(
ch
è< 
æag_f›lds
[
f›ld±r
].
£e_mob
) {

803 
	`¡c
("You‡»‚Ù highƒnough†ev–Ø£¬ch fÜh© f›ld.\n", 
ch
);

808 
	`¡c
("Th© i nÙ‡Àobjeù f›ld.\n", 
ch
);

812 
f›ld±r
) {

813 
FIELD_EXTRA
:

814 
FIELD_WEAR
:

815 
FIELD_WEAPON
:

819 
	`¡c
("Th©' nÙ‡Àacû±abË objeù fÏg.\n", 
ch
);

823 ià(
¬g1
.
	`is_´efix_of
("room")) {

824 ià(
æag_f›lds
[
f›ld±r
].
ÿnd
 =ğ
CAND_ROOM
) {

825 ià(
	`GET_RANK
(
ch
è< 
æag_f›lds
[
f›ld±r
].
£e_mob
) {

826 
	`¡c
("You‡»‚Ù highƒnough†ev–Ø£¬ch fÜh© f›ld.\n", 
ch
);

831 
	`¡c
("Th© i nÙ‡„oom f›ld.\n", 
ch
);

835 
f›ld±r
) {

836 
FIELD_ROOM
:

840 
	`¡c
("Th©' nÙ‡Àacû±abË„oom fÏg.\n", 
ch
);

845 
	`¡c
("PËa£ s³cify : mob, ch¬,…Ïy”, obj o¸room.\n", 
ch
);

849 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
>& 
æag_bË
 = 
æag_f›lds
[
f›ld±r
].flag_table;

853 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
wÜd
);

855 ià(
wÜd
.
	`em±y
())

858 ià(
wÜd
.
	`size
() == 1) {

859 
FÏgs
 
	`æag
(
wÜd
);

861 ià(
æag
.
	`em±y
()) {

862 
	`¡c
("Th© fÏg dÛ¢'ˆexi¡!\n", 
ch
);

866 
m¬ked
 +ğ
æag
;

869 
pos
 = 
	`æag_šdex_lookup
(
wÜd
, 
æag_bË
);

871 ià(
pos
 == -1) {

872 
	`±c
(
ch
, "Th© i nÙ‡Àacû±abË % æag.\n", 
æag_f›lds
[
f›ld±r
].
Çme
);

876 
m¬ked
 +ğ
æag_bË
[
pos
].
b™
;

880 
æag_f›lds
[
f›ld±r
].
ÿnd
) {

881 
CAND_CHAR
:

882 
CAND_MOB
:

883 
CAND_PLAYER
: 
	`f£¬ch_ch¬
(
ch
, 
f›ld±r
, 
m¬ked
, 
mobe
, 
¶ay”
); ;

885 
CAND_OBJ
: 
	`f£¬ch_obj
(
ch
, 
f›ld±r
, 
m¬ked
); ;

887 
CAND_ROOM
: 
	`f£¬ch_room
(
ch
, 
f›ld±r
, 
m¬ked
); ;

891 
	}
}

	@src/gem/gem.cc

1 
	~"gem/gem.hh
"

3 
	~"aù.hh
"

4 
	~"afãù/afãù_li¡.hh
"

5 
	~"¬gum’t.hh
"

6 
	~"Ch¬aù”.hh
"

7 
	~"fšd.hh
"

8 
	~"Loggšg.hh
"

9 
	~"Objeù.hh
"

10 
	~"ObjeùPrÙÙy³.hh
"

11 
	~"cÚ¡ªts.hh
"

13 
Çme¥aû
 
	ggem
 {

16 cÚ¡ 
	g¡d
::
veùÜ
<
ty³_¡
> 
ty³_bË
 = {

19 { "ruby", 'P', 
OBJ_VNUM_GEM_RUBY
, 
APPLY_DAMROLL
, {1, 2, 3, 5, 8, 12, 20} },

20 { "em”®d", 'G', 
OBJ_VNUM_GEM_EMERALD
, 
APPLY_HITROLL
, {1, 2, 3, 5, 8, 12, 20} }

26 cÚ¡ 
qu®™y_¡
 
	gqu®™y_bË
 [
Qu®™y
::
COUNT
] = {

28 { "rough", 
Qu®™y
::
Rough
, 1 },

29 { "üacked", 
Qu®™y
::
C¿cked
, 15 },

30 { "æawed", 
Qu®™y
::
FÏwed
, 30 },

31 { "æawËss", 
Qu®™y
::
FÏwËss
, 45 },

32 { "³rãù", 
Qu®™y
::
P”ãù
, 60 },

33 { "brlŸÁ", 
Qu®™y
::
BrlŸÁ
, 75 },

34 { "dazzlšg", 
Qu®™y
::
Dazzlšg
, 90 }

40 
š£t
(
Objeù
 *
gem
, Objeù *
obj
) {

41 
	ggem
->
	gÃxt_cÚ‹Á
 = 
obj
->
gems
;

42 
	gobj
->
	ggems
 = 
gem
;

43 
	ggem
->
	gš_obj
 = 
obj
;

44 
	ggem
->
	gš_room
 = 
nuÎ±r
;

45 
	ggem
->
	gÿ¼›d_by
 = 
nuÎ±r
;

49 cÚ¡ 
SŒšg
 
g‘_shÜt_¡ršg
(
Objeù
 *
eq
) {

50 
SŒšg
 
	gbuf
;

52 ià(
	geq
->
	gnum_£‰šgs
 == 0) {

53  
buf
;

56 
	gb¿ck‘_symbŞ_İ’
 = '[';

57 
	gb¿ck‘_symbŞ_şo£
 = ']';

58 
	gb¿ck‘_cŞÜ
 = 'g';

59 
	ggem_symbŞ
 = '*';

60 
	gem±y_cŞÜ
 = 'c';

61 
	gem±y_symbŞ
 = '.';

63 
	gcouÁ
 = 0;

65 
	gbuf
 += '{';

66 
	gbuf
 +ğ
b¿ck‘_cŞÜ
;

67 
	gbuf
 +ğ
b¿ck‘_symbŞ_İ’
;

70 
Objeù
 *
	ggem
 = 
eq
->
gems
; gem; gem = 
gem
->
Ãxt_cÚ‹Á
) {

71 
couÁ
++;

72 
	gbuf
 += '{';

73 
	gbuf
 +ğ
ty³_bË
[
gem
->
v®ue
[0]].
cŞÜ_code
;

74 
	gbuf
 +ğ
gem_symbŞ
;

78 
	gcouÁ
 < 
	geq
->
	gnum_£‰šgs
) {

79 
	gcouÁ
++;

80 
	gbuf
 += '{';

81 
	gbuf
 +ğ
em±y_cŞÜ
;

82 
	gbuf
 +ğ
em±y_symbŞ
;

85 
	gbuf
 += '{';

86 
	gbuf
 +ğ
b¿ck‘_cŞÜ
;

87 
	gbuf
 +ğ
b¿ck‘_symbŞ_şo£
;

97 
	gbuf
 += '{';

98 
	gbuf
 += 'x';

100  
	gbuf
;

103 
compe_efãùs
(
Objeù
 *
eq
) {

104 ià(
	geq
->
	gw—r_loc
 !ğ
WEAR_NONE
) {

105 
Loggšg
::
bug
("gem::compile_effects:ƒq is worn", 0);

111 
	gafãù
::
ş—r_li¡
(&
eq
->
gem_afãùed
);

113 
Objeù
 *
	ggem
 = 
eq
->
gems
; gem !ğ
nuÎ±r
; gem = 
gem
->
Ãxt_cÚ‹Á
) {

114 
afãù
::
Afãù
 
af
;

115 
	gaf
.
	gwh”e
 = 
TO_OBJECT
;

116 
	gaf
.
	gty³
 = 
afãù
::
ty³
::
nÚe
;

117 
	gaf
.
	gËv–
 = 
gem
->
Ëv–
;

118 
	gaf
.
	gdu¿tiÚ
 = -1;

119 
	gaf
.
	gloÿtiÚ
 = 
ty³_bË
[
gem
->
v®ue
[
GEM_VALUE_TYPE
]].
­¶y_loc
;

120 
	gaf
.
	gmodif›r
 = 
ty³_bË
[
gem
->
v®ue
[
GEM_VALUE_TYPE
]].
modif›r
[gem->v®ue[
GEM_VALUE_QUALITY
]];

121 
	gaf
.
b™veùÜ
(0);

122 
	gaf
.
	gevŞutiÚ
 = 1;

123 
	gafãù
::
cİy_to_li¡
(&
eq
->
gem_afãùed
, &
af
);

129 
	$do_š£t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

131 
Objeù
 *
eq
, *
gem
;

133 
SŒšg
 
¬g1
, 
¬g2
;

134 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

135 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

137 ià(
¬g2
 == "in")

138 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

140 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.empty()) {

141 
	`¡c
("S‘ wh© gem iÀwh©ƒqum’t?\n", 
ch
);

145 ià((
gem
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g1
)è=ğ
nuÎ±r
) {

146 
	`aù
("You dÚ'ˆhav¨$T.", 
ch
, 
nuÎ±r
, 
¬g1
, 
TO_CHAR
);

150 ià(
gem
->
pIndexD©a
->
™em_ty³
 !ğ
ITEM_GEM
) {

151 
	`aù
("Th©' nÙ‡ gem you cª in£t.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

155 ià(!
	`ÿn_drİ_obj
(
ch
, 
gem
)) {

156 
	`aù
("You cª'ˆËˆgØoà$p.\n", 
ch
, 
gem
, 
nuÎ±r
, 
TO_CHAR
);

160 ià((
eq
 = 
	`g‘_obj_li¡
(
ch
, 
¬g2
, ch->
ÿ¼yšg
)è=ğ
nuÎ±r
) {

161 
	`aù
("You dÚ'ˆhav¨$T.", 
ch
, 
nuÎ±r
, 
¬g2
, 
TO_CHAR
);

165 ià(
eq
->
w—r_loc
 !ğ
WEAR_NONE
) {

166 
	`aù
("You‚“dØ»mov™ fœ¡.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

170 
couÁ
 = 0;

171 
Objeù
 *
obj
;

173 
obj
 = 
eq
->
gems
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
)

174 
couÁ
++;

176 ià(
couÁ
 >ğ
eq
->
num_£‰šgs
) {

177 
	`aù
("Th© i‹m dÛ¢'ˆhavªƒm±y s‘tšg.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

181 ià(
gem
->
Ëv–
 > 
eq
->level) {

182 
	`aù
("Th© i‹m i nÙ…ow”fuÈ’oughØhŞd $p.", 
ch
, 
gem
, 
nuÎ±r
, 
TO_CHAR
);

186 
	`aù
("$À¶aû $°š‡Àem±y s‘tšg iÀ$P.", 
ch
, 
gem
, 
eq
, 
TO_ROOM
);

187 
	`aù
("You…Ïû $°š‡Àem±y s‘tšg iÀ$P.", 
ch
, 
gem
, 
eq
, 
TO_CHAR
);

189 
	`obj_äom_ch¬
(
gem
);

192 
gem
->
Ãxt_cÚ‹Á
 = 
eq
->
gems
;

193 
eq
->
gems
 = 
gem
;

194 
gem
->
š_obj
 = 
eq
;

195 
gem
->
š_room
 = 
nuÎ±r
;

196 
gem
->
ÿ¼›d_by
 = 
nuÎ±r
;

198 
gem
::
	`compe_efãùs
(
eq
);

199 
	}
}

	@src/handler.cc

28 
	~<c¡ršg
>

29 
	~<veùÜ
>

31 
	~"aù.hh
"

32 
	~"afãù/afãù_št.hh
"

33 
	~"afãù/Afãù.hh
"

34 
	~"A»a.hh
"

35 
	~"Ch¬aù”.hh
"

36 
	~"CÏn.hh
"

37 
	~"deş¬e.hh
"

38 
	~"DesütÜ.hh
"

39 
	~"ev’t/ev’t.hh
"

40 
	~"Ex™.hh
"

41 
	~"ExŒaDesü.hh
"

42 
	~"FÏgs.hh
"

43 
	~"FÜm©.hh
"

44 
	~"Game.hh
"

45 
	~"GameTime.hh
"

46 
	~"š‹½.hh
"

47 
	~"lookup.hh
"

48 
	~"Loggšg.hh
"

49 
	~"magic.hh
"

50 
	~"memÜy.hh
"

51 
	~"m”c.hh
"

52 
	~"MobePrÙÙy³.hh
"

53 
	~"Objeù.hh
"

54 
	~"ObjeùPrÙÙy³.hh
"

55 
	~"ObjeùV®ue.hh
"

56 
	~"PÏy”.hh
"

57 
	~"¿ndom.hh
"

58 
	~"Room.hh
"

59 
	~"skl/skl.hh
"

60 
	~"SŒšg.hh
"

61 
	~"WÜld.hh
"

64 
boŞ
 
	$is_ä›nd
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

66 ià(
	`is_§me_group
(
ch
, 
viùim
))

67  
Œue
;

69 ià(!
ch
->
	`is_Åc
())

70  
çl£
;

72 ià(!
viùim
->
	`is_Åc
()) {

73 ià(
ch
->
off_æags
.
	`has
(
ASSIST_PLAYERS
))

74  
Œue
;

76  
çl£
;

79 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
))

80  
çl£
;

82 ià(
ch
->
off_æags
.
	`has
(
ASSIST_ALL
))

83  
Œue
;

85 ià(
ch
->
group_æags
.
	`has_ªy_of
(
viùim
->group_flags))

86  
Œue
;

88 ià(
ch
->
off_æags
.
	`has
(
ASSIST_VNUM
)

89 && 
ch
->
pIndexD©a
 =ğ
viùim
->pIndexData)

90  
Œue
;

92 ià(
ch
->
off_æags
.
	`has
(
ASSIST_RACE
è&& ch->
¿û
 =ğ
viùim
->race)

93  
Œue
;

95 ià(
ch
->
off_æags
.
	`has
(
ASSIST_ALIGN
)

96 && !
ch
->
aù_æags
.
	`has
(
ACT_NOALIGN
è&& !
viùim
->act_flags.has(ACT_NOALIGN)

97 && ((
	`IS_GOOD
(
ch
è&& IS_GOOD(
viùim
))

98 || (
	`IS_EVIL
(
ch
è&& IS_EVIL(
viùim
))

99 || (
	`IS_NEUTRAL
(
ch
è&& IS_NEUTRAL(
viùim
))))

100  
Œue
;

102  
çl£
;

103 
	}
}

106 
	$couÁ_u£rs
(
Objeù
 *
obj
)

108 
Ch¬aù”
 *
fch
;

109 
couÁ
 = 0;

111 ià(
obj
->
š_room
 =ğ
nuÎ±r
)

114 
fch
 = 
obj
->
š_room
->
³İË
; fch !ğ
nuÎ±r
; fch = fch->
Ãxt_š_room
)

115 ià(
fch
->
Ú
 =ğ
obj
)

116 
couÁ
++;

118  
couÁ
;

119 
	}
}

121 
boŞ
 
	$is_şª
(
Ch¬aù”
 *
ch
)

123  (
ch
->
şª
 !ğ
nuÎ±r
);

124 
	}
}

126 
boŞ
 
	$is_§me_şª
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

128 ià(
ch
 =ğ
nuÎ±r
 || 
viùim
 =ğnuÎ±¸|| ch->
şª
 ==‚ullptr || victim->clan ==‚ullptr)

129  
çl£
;

131 ià(
ch
->
şª
->
šd•’d’t
 && !
	`IS_IMMORTAL
(ch))

132  
çl£
;

134  (
ch
->
şª
 =ğ
viùim
->clan);

135 
	}
}

138 
	$de™y_lookup
(cÚ¡ 
SŒšg
& 
Çme
)

140 
de™y
 = 0; de™y < 
de™y_bË
.
	`size
(); deity++)

141 ià(
Çme
.
	`is_´efix_of
(
de™y_bË
[
de™y
].name))

142  
de™y
;

145 
	}
}

148 
	gskl
::
ty³
 
	$g‘_w—pÚ_skl
(
Ch¬aù”
 *
ch
, 
boŞ
 
£cÚd¬y
)

150 
Objeù
 *
w›ld
;

151 
skl
::
ty³
 
¢
;

153 ià(
£cÚd¬y
)

154 
w›ld
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_SECONDARY
);

156 
w›ld
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
);

158 ià(
w›ld
 =ğ
nuÎ±r
 || w›ld->
™em_ty³
 !ğ
ITEM_WEAPON
)

159 
¢
 = 
skl
::
ty³
::
hªd_to_hªd
;

160 
w›ld
->
v®ue
[0]) {

161  : 
¢
 = 
skl
::
ty³
::
unknown
; ;

162 (
WEAPON_SWORD
): 
¢
 = 
skl
::
ty³
::
swÜd
; ;

163 (
WEAPON_DAGGER
): 
¢
 = 
skl
::
ty³
::
dagg”
; ;

164 (
WEAPON_SPEAR
): 
¢
 = 
skl
::
ty³
::
¥—r
; ;

165 (
WEAPON_MACE
): 
¢
 = 
skl
::
ty³
::
maû
; ;

166 (
WEAPON_AXE
): 
¢
 = 
skl
::
ty³
::
axe
; ;

167 (
WEAPON_FLAIL
): 
¢
 = 
skl
::
ty³
::
æa
; ;

168 (
WEAPON_WHIP
): 
¢
 = 
skl
::
ty³
::
wh
; ;

169 (
WEAPON_POLEARM
): 
¢
 = 
skl
::
ty³
::
pŞ—rm
; ;

172  
¢
;

173 
	}
}

175 
	$g‘_w—pÚ_Ë¬Ãd
(
Ch¬aù”
 *
ch
, 
skl
::
ty³
 
¢
)

177 
skl
;

180 ià(
ch
->
	`is_Åc
()) {

181 ià(
¢
 =ğ
skl
::
ty³
::
unknown
)

182 
skl
 = 3 * 
ch
->
Ëv–
;

183 ià(
¢
 =ğ
skl
::
ty³
::
hªd_to_hªd
)

184 
skl
 = 40 + 2 * 
ch
->
Ëv–
;

186 
skl
 = 40 + 5 * 
ch
->
Ëv–
 / 2;

189 ià(
¢
 =ğ
skl
::
ty³
::
unknown
)

190 
skl
 = 3 * 
ch
->
Ëv–
;

192 
skl
 = 
	`g‘_skl_Ëv–
(
ch
, 
¢
);

195  
	`URANGE
(0, 
skl
, 100);

196 
	}
}

199 
	$g‘_max_Œaš
(
Ch¬aù”
 *
ch
, 
¡©
)

201 
max
;

203 ià(
ch
->
	`is_Åc
(è|| 
	`IS_IMMORTAL
(ch))

206 
max
 = 
pc_¿û_bË
[
ch
->
¿û
].
max_¡©s
[
¡©
];

208 ià(
ch
->
gud
 !ğ
Gud
::
nÚe


209 && 
gud_bË
[
ch
->
gud
].
¡©_´ime
 =ğ
¡©
) {

210 ià(
ch
->
¿û
 =ğ
	`¿û_lookup
("human"))

211 
max
 += 3;

213 
max
 += 2;

216  
¡d
::
	`mš
(
max
, 25);

217 
	}
}

222 
	$ÿn_ÿ¼y_n
(
Ch¬aù”
 *
ch
)

224 ià(
	`IS_IMMORTAL
(
ch
))

227 ià(
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
ACT_PET
))

230  
MAX_WEAR
 + 2 * 
	`GET_ATTR_DEX
(
ch
è+ ch->
Ëv–
;

231 
	}
}

236 
	$ÿn_ÿ¼y_w
(
Ch¬aù”
 *
ch
)

238 ià(
	`IS_IMMORTAL
(
ch
))

241 ià(
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
ACT_PET
))

244  
¡r_­p
[
	`GET_ATTR_STR
(
ch
)].
ÿ¼y
 * 10 + ch->
Ëv–
 * 25;

245 
	}
}

251 
	$ch¬_äom_room
(
Ch¬aù”
 *
ch
)

253 ià(
ch
 =ğ
nuÎ±r
)

256 ià(
ch
->
š_room
 =ğ
nuÎ±r
) {

257 
Loggšg
::
	`bug
("Char_from_room:‚ullptr.", 0);

261 
ch
->
š_room
->
	`»move_ch¬
(ch);

262 
	}
}

267 
	$ch¬_to_room
(
Ch¬aù”
 *
ch
, 
Room
 *
room
)

269 ià(
ch
 =ğ
nuÎ±r
)

272 ià(
room
 =ğ
nuÎ±r
) {

273 
Room
 *
room
;

274 
Loggšg
::
	`bug
("Char_to_room:‚ullptr.", 0);

275 
Loggšg
::
	`bug
(
ch
->
Çme
, 0);

277 ià((
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_TEMPLE
)))è!ğ
nuÎ±r
)

278 
	`ch¬_to_room
(
ch
, 
room
);

283 
room
->
	`add_ch¬
(
ch
);

284 
	}
}

287 
	$obj_äom_lock”
(
Objeù
 *
obj
)

289 
Ch¬aù”
 *
ch
;

291 ià((
ch
 = 
obj
->
š_lock”
è=ğ
nuÎ±r
) {

292 
Loggšg
::
	`bug
("obj_from_locker: obj…ointso‚ull ch", 0);

296 ià(
ch
->
	`is_Åc
()) {

297 
Loggšg
::
	`bug
("obj_from_locker: obj…ointso mobile", 0);

301 ià(
ch
->
pcd©a
->
lock”
 =ğ
obj
)

302 
ch
->
pcd©a
->
lock”
 = 
obj
->
Ãxt_cÚ‹Á
;

304 
Objeù
 *
´ev
;

306 
´ev
 = 
ch
->
pcd©a
->
lock”
;…»v !ğ
nuÎ±r
;…»v =…»v->
Ãxt_cÚ‹Á
)

307 ià(
´ev
->
Ãxt_cÚ‹Á
 =ğ
obj
) {

308 
´ev
->
Ãxt_cÚ‹Á
 = 
obj
->next_content;

312 ià(
´ev
 =ğ
nuÎ±r
)

313 
Loggšg
::
	`bug
("obj_from_locker: obj‚ot in ch->pcdata->locker†ist.", 0);

316 
obj
->
Ãxt_cÚ‹Á
 = 
nuÎ±r
;

317 
obj
->
š_lock”
 = 
nuÎ±r
;

318 
	}
}

320 
	$obj_äom_¡rÚgbox
(
Objeù
 *
obj
)

322 
Ch¬aù”
 *
ch
;

324 ià((
ch
 = 
obj
->
š_¡rÚgbox
è=ğ
nuÎ±r
) {

325 
Loggšg
::
	`bug
("obj_from_strongbox: obj…ointso‚ull ch", 0);

329 ià(
ch
->
	`is_Åc
()) {

330 
Loggšg
::
	`bug
("obj_from_strongbox: obj…ointso‡ mobile", 0);

334 ià(
ch
->
pcd©a
->
¡rÚgbox
 =ğ
obj
)

335 
ch
->
pcd©a
->
¡rÚgbox
 = 
obj
->
Ãxt_cÚ‹Á
;

337 
Objeù
 *
´ev
;

339 
´ev
 = 
ch
->
pcd©a
->
¡rÚgbox
;…»v !ğ
nuÎ±r
;…»v =…»v->
Ãxt_cÚ‹Á
)

340 ià(
´ev
->
Ãxt_cÚ‹Á
 =ğ
obj
) {

341 
´ev
->
Ãxt_cÚ‹Á
 = 
obj
->next_content;

345 ià(
´ev
 =ğ
nuÎ±r
)

346 
Loggšg
::
	`bug
("Obj_from_strongbox: obj‚ot in†ist.", 0);

349 
obj
->
Ãxt_cÚ‹Á
 = 
nuÎ±r
;

350 
obj
->
š_¡rÚgbox
 = 
nuÎ±r
;

352 
	}
}

354 
	$obj_to_lock”
(
Objeù
 *
obj
, 
Ch¬aù”
 *
ch
)

356 ià(
ch
->
	`is_Åc
()) {

357 
Loggšg
::
	`bug
("obj_to_locker: ch is‡ mobile", 0);

361 
obj
->
Ãxt_cÚ‹Á
 = 
ch
->
pcd©a
->
lock”
;

362 
ch
->
pcd©a
->
lock”
 = 
obj
;

363 
obj
->
š_lock”
 = 
ch
;

364 
obj
->
ÿ¼›d_by
 = 
nuÎ±r
;

365 
obj
->
š_room
 = 
nuÎ±r
;

366 
obj
->
š_obj
 = 
nuÎ±r
;

367 
	}
}

369 
	$obj_to_¡rÚgbox
(
Objeù
 *
obj
, 
Ch¬aù”
 *
ch
)

371 ià(
ch
->
	`is_Åc
()) {

372 
Loggšg
::
	`bug
("obj_to_strongbox: ch is‡ mobile", 0);

376 
obj
->
Ãxt_cÚ‹Á
 = 
ch
->
pcd©a
->
¡rÚgbox
;

377 
ch
->
pcd©a
->
¡rÚgbox
 = 
obj
;

378 
obj
->
š_¡rÚgbox
 = 
ch
;

379 
obj
->
ÿ¼›d_by
 = 
nuÎ±r
;

380 
obj
->
š_room
 = 
nuÎ±r
;

381 
obj
->
š_obj
 = 
nuÎ±r
;

382 
	}
}

387 
	$obj_to_ch¬
(
Objeù
 *
obj
, 
Ch¬aù”
 *
ch
)

389 
obj
->
Ãxt_cÚ‹Á
 = 
ch
->
ÿ¼yšg
;

390 
ch
->
ÿ¼yšg
 = 
obj
;

391 
obj
->
ÿ¼›d_by
 = 
ch
;

392 
obj
->
š_lock”
 = 
nuÎ±r
;

393 
obj
->
š_¡rÚgbox
 = 
nuÎ±r
;

394 
obj
->
š_room
 = 
nuÎ±r
;

395 
obj
->
š_obj
 = 
nuÎ±r
;

396 
obj
->
ş—n_tim”
 = 0;

397 
	}
}

402 
	$obj_äom_ch¬
(
Objeù
 *
obj
)

404 
Ch¬aù”
 *
ch
;

406 ià((
ch
 = 
obj
->
ÿ¼›d_by
è=ğ
nuÎ±r
) {

407 
Loggšg
::
	`bug
("Obj_from_char:‚ull ch.", 0);

411 ià(
obj
->
w—r_loc
 !ğ
WEAR_NONE
)

412 
	`uÃqu_ch¬
(
ch
, 
obj
);

414 ià(
ch
->
ÿ¼yšg
 =ğ
obj
)

415 
ch
->
ÿ¼yšg
 = 
obj
->
Ãxt_cÚ‹Á
;

417 
Objeù
 *
´ev
;

419 
´ev
 = 
ch
->
ÿ¼yšg
;…»v !ğ
nuÎ±r
;…»v =…»v->
Ãxt_cÚ‹Á
) {

420 ià(
´ev
->
Ãxt_cÚ‹Á
 =ğ
obj
) {

421 
´ev
->
Ãxt_cÚ‹Á
 = 
obj
->next_content;

426 ià(
´ev
 =ğ
nuÎ±r
)

427 
Loggšg
::
	`bug
("Obj_from_char: obj‚ot in†ist.", 0);

430 
obj
->
ÿ¼›d_by
 = 
nuÎ±r
;

431 
obj
->
Ãxt_cÚ‹Á
 = 
nuÎ±r
;

432 
	}
}

437 
	$­¶y_ac
(
Objeù
 *
obj
, 
iW—r
, 
ty³
)

440 ià(
obj
->
™em_ty³
 !ğ
ITEM_ARMOR
)

443 
iW—r
) {

444 
WEAR_LIGHT
:  0;

446 
WEAR_FINGER_L
:  
obj
->
v®ue
[
ty³
];;

448 
WEAR_FINGER_R
:  
obj
->
v®ue
[
ty³
];;

450 
WEAR_NECK_1
:  
obj
->
v®ue
[
ty³
];;

452 
WEAR_NECK_2
:  
obj
->
v®ue
[
ty³
];;

454 
WEAR_BODY
:  3 * 
obj
->
v®ue
[
ty³
];;

456 
WEAR_HEAD
:  2 * 
obj
->
v®ue
[
ty³
];;

458 
WEAR_LEGS
:  2 * 
obj
->
v®ue
[
ty³
];;

460 
WEAR_FEET
:  
obj
->
v®ue
[
ty³
];;

462 
WEAR_HANDS
:  
obj
->
v®ue
[
ty³
];;

464 
WEAR_ARMS
:  
obj
->
v®ue
[
ty³
];;

466 
WEAR_SHIELD
:  
obj
->
v®ue
[
ty³
];;

468 
WEAR_ABOUT
:  2 * 
obj
->
v®ue
[
ty³
];;

470 
WEAR_WAIST
:  
obj
->
v®ue
[
ty³
];;

472 
WEAR_WRIST_L
:  
obj
->
v®ue
[
ty³
];;

474 
WEAR_WRIST_R
:  
obj
->
v®ue
[
ty³
];;

476 
WEAR_HOLD
:  
obj
->
v®ue
[
ty³
];;

478 
WEAR_FLOAT
:  
obj
->
v®ue
[
ty³
];;

482 
	}
}

487 
Objeù
 *
	$g‘_eq_ch¬
(
Ch¬aù”
 *
ch
, 
iW—r
)

489 
Objeù
 *
obj
;

491 ià(
ch
 =ğ
nuÎ±r
)

492  
nuÎ±r
;

494 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
) {

495 ià(
obj
->
w—r_loc
 =ğ
iW—r
)

496  
obj
;

499  
nuÎ±r
;

500 
	}
}

505 
	$equ_ch¬
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, 
iW—r
)

510 
Objeù
 *
equ³d
 = 
	`g‘_eq_ch¬
(
ch
, 
iW—r
);

511 ià(
equ³d
 !ğ
nuÎ±r
 &&ƒqu³d !ğ
obj
) {

512 
Loggšg
::
	`bug
("Equ_ch¬:‡Ì—dyƒqu³d (%d).", 
iW—r
);

516 
i
 = 0; i < 4; i++)

517 
ch
->
¬mÜ_ba£
[
i
] -ğ
	`­¶y_ac
(
obj
, 
iW—r
, i);

519 
obj
->
w—r_loc
 = 
iW—r
;

521 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
)

522 
afãù
::
	`modify_ch¬
(
ch
, 
·f
, 
Œue
);

524 ià(
obj
->
™em_ty³
 =ğ
ITEM_LIGHT
 && obj->
v®ue
[2] !ğ0 && 
ch
->
š_room
 !ğ
nuÎ±r
)

525 ++
ch
->
š_room
->
light
;

526 
	}
}

531 
	$uÃqu_ch¬
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
)

533 ià(
obj
->
w—r_loc
 =ğ
WEAR_NONE
) {

534 
Loggšg
::
	`bug
("Unequip_char:‡lready unequipped.", 0);

538 
i
 = 0; i < 4; i++)

539 
ch
->
¬mÜ_ba£
[
i
] +ğ
	`­¶y_ac
(
obj
, obj->
w—r_loc
, i);

541 
obj
->
w—r_loc
 = -1;

543 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
)

544 
afãù
::
	`modify_ch¬
(
ch
, 
·f
, 
çl£
);

546 ià(
obj
->
™em_ty³
 =ğ
ITEM_LIGHT


547 && 
obj
->
v®ue
[2] != 0

548 && 
ch
->
š_room
 !ğ
nuÎ±r


549 && 
ch
->
š_room
->
light
 > 0)

550 --
ch
->
š_room
->
light
;

553 
	}
}

558 
	$couÁ_obj_li¡
(
ObjeùPrÙÙy³
 *
pObjIndex
, 
Objeù
 *
li¡
)

560 
Objeù
 *
obj
;

561 
nM©ch
;

562 
nM©ch
 = 0;

564 
obj
 = 
li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
) {

565 ià(
obj
->
pIndexD©a
 =ğ
pObjIndex
)

566 
nM©ch
++;

569  
nM©ch
;

570 
	}
}

575 
	$obj_äom_room
(
Objeù
 *
obj
)

577 
Room
 *
š_room
;

578 
Ch¬aù”
 *
ch
;

580 ià((
š_room
 = 
obj
->š_roomè=ğ
nuÎ±r
) {

581 
Loggšg
::
	`bug
("obj_from_room:‚ullptr.", 0);

582 
Loggšg
::
	`bug
(
obj
->
shÜt_desü
, 0);

586 
ch
 = 
š_room
->
³İË
; ch !ğ
nuÎ±r
; ch = ch->
Ãxt_š_room
)

587 ià(
ch
->
Ú
 =ğ
obj
)

588 
ch
->
Ú
 = 
nuÎ±r
;

590 ià(
obj
 =ğ
š_room
->
cÚ‹Ás
)

591 
š_room
->
cÚ‹Ás
 = 
obj
->
Ãxt_cÚ‹Á
;

593 
Objeù
 *
´ev
;

595 
´ev
 = 
š_room
->
cÚ‹Ás
;…»v;…»v =…»v->
Ãxt_cÚ‹Á
) {

596 ià(
´ev
->
Ãxt_cÚ‹Á
 =ğ
obj
) {

597 
´ev
->
Ãxt_cÚ‹Á
 = 
obj
->next_content;

602 ià(
´ev
 =ğ
nuÎ±r
) {

603 
Loggšg
::
	`bug
("Obj_from_room: obj‚ot found.", 0);

608 
obj
->
š_room
 = 
nuÎ±r
;

609 
obj
->
Ãxt_cÚ‹Á
 = 
nuÎ±r
;

611 
	}
}

616 
	$obj_to_room
(
Objeù
 *
obj
, 
Room
 *
room
)

619 ià(
room
 =ğ
nuÎ±r
) {

620 
Loggšg
::
	`bug
("obj_to_room:‚ullptr„oom", 0);

625 
room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
aœ
 &&

626 
obj
->
w—r_æags
.
	`has
(
ITEM_TAKE
) &&

627 
room
->
ex™
[
DIR_DOWN
] &&

628 
room
->
ex™
[
DIR_DOWN
]->
to_room
) {

629 
Room
 *
Ãw_room
 =

630 
room
->
ex™
[
DIR_DOWN
]->
to_room
;

632 ià(
Ãw_room
 =ğ
nuÎ±r
)

635 
Ch¬aù”
 *
rch
;

637 ià((
rch
 = 
room
->
³İË
è!ğ
nuÎ±r
) {

638 
	`aù
("$°çÎ away.", 
rch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

639 
	`aù
("$°çÎ away.", 
rch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

642 ià((
rch
 = 
Ãw_room
->
³İË
è!ğ
nuÎ±r
) {

643 
	`aù
("$°æßt by.", 
rch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

644 
	`aù
("$°æßt by.", 
rch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

647 
room
 = 
Ãw_room
;

650 
obj
->
Ãxt_cÚ‹Á
 = 
room
->
cÚ‹Ás
;

651 
room
->
cÚ‹Ás
 = 
obj
;

652 
obj
->
š_room
 = 
room
;

653 
obj
->
ÿ¼›d_by
 = 
nuÎ±r
;

654 
obj
->
š_obj
 = 
nuÎ±r
;

656 
	}
}

661 
	$obj_to_obj
(
Objeù
 *
obj
, Objeù *
obj_to
)

663 ià(
obj_to
 =ğ
Game
::
	`wÜld
().
dÚ©iÚ_p™
) {

664 
obj
->
co¡
 = 0;

667 ià(
obj
->
dÚ©ed
 == 0) {

668 
obj
->
dÚ©ed
 = 
Game
::
cu¼’t_time
;

671 
Objeù
 *
Şde¡
 = 
nuÎ±r
;

672 
couÁ
 = 0;

674 
Objeù
 *
c
 = 
Game
::
	`wÜld
().
dÚ©iÚ_p™
->
cÚšs
; c; c = c->
Ãxt_cÚ‹Á
) {

675 
couÁ
++;

676 ià(
Şde¡
 =ğ
nuÎ±r
 || olde¡->
dÚ©ed
 > 
c
->donated)

677 
Şde¡
 = 
c
;

680 ià(
couÁ
 >ğ
MAX_DONATED
 && 
Şde¡
 !ğ
nuÎ±r
)

681 
	`exŒaù_obj
(
Şde¡
);

685 
obj
->
Ãxt_cÚ‹Á
 = 
obj_to
->
cÚšs
;

686 
obj_to
->
cÚšs
 = 
obj
;

687 
obj
->
š_obj
 = 
obj_to
;

688 
obj
->
š_room
 = 
nuÎ±r
;

689 
obj
->
ÿ¼›d_by
 = 
nuÎ±r
;

690 
	}
}

695 
	$obj_äom_obj
(
Objeù
 *
obj
)

697 
Objeù
 *
obj_äom
;

699 ià((
obj_äom
 = 
obj
->
š_obj
è=ğ
nuÎ±r
) {

700 
Loggšg
::
	`bug
("Obj_from_obj:‚ull obj_from.", 0);

704 
boŞ
 
found
 = 
çl£
;

707 ià(
obj
 =ğ
obj_äom
->
cÚšs
) {

708 
obj_äom
->
cÚšs
 = 
obj
->
Ãxt_cÚ‹Á
;

709 
found
 = 
Œue
;

712 
Objeù
 *
´ev
;

714 
´ev
 = 
obj_äom
->
cÚšs
;…»v;…»v =…»v->
Ãxt_cÚ‹Á
) {

715 ià(
´ev
->
Ãxt_cÚ‹Á
 =ğ
obj
) {

716 
´ev
->
Ãxt_cÚ‹Á
 = 
obj
->next_content;

721 ià(
´ev
 !ğ
nuÎ±r
)

722 
found
 = 
Œue
;

725 ià(!
found
) {

727 ià(
obj
 =ğ
obj_äom
->
gems
) {

728 
obj_äom
->
gems
 = 
obj
->
Ãxt_cÚ‹Á
;

729 
found
 = 
Œue
;

732 
Objeù
 *
´ev
;

734 
´ev
 = 
obj_äom
->
gems
;…»v;…»v =…»v->
Ãxt_cÚ‹Á
) {

735 ià(
´ev
->
Ãxt_cÚ‹Á
 =ğ
obj
) {

736 
´ev
->
Ãxt_cÚ‹Á
 = 
obj
->next_content;

741 ià(
´ev
 !ğ
NULL
)

742 
found
 = 
Œue
;

747 ià(!
found
) {

748 
Loggšg
::
	`bug
("Obj_from_obj: obj‚ot found.", 0);

752 
obj
->
Ãxt_cÚ‹Á
 = 
nuÎ±r
;

753 
obj
->
š_obj
 = 
nuÎ±r
;

754 
	}
}

756 
	$¥l_cÚ‹Ás
(
Objeù
 *
obj
, Objeù *
cÚ‹Ás
) {

757 
Objeù
 *
t_obj
, *
n_obj
;

759 
t_obj
 = 
cÚ‹Ás
;_obj !ğ
nuÎ±r
;_obj = 
n_obj
) {

760 
n_obj
 = 
t_obj
->
Ãxt_cÚ‹Á
;

761 
	`obj_äom_obj
(
t_obj
);

763 ià(
obj
->
š_obj
)

764 
	`obj_to_obj
(
t_obj
, 
obj
->
š_obj
);

765 ià(
obj
->
ÿ¼›d_by
) {

766 ià(
	`rŞl_chªû
(75)

767 || 
obj
->
ÿ¼›d_by
->
š_room
 =ğ
nuÎ±r


768 || 
obj
->
ÿ¼›d_by
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


769 || 
	`ch¬_š_d¬’a_room
(
obj
->
ÿ¼›d_by
))

770 
	`obj_to_ch¬
(
t_obj
, 
obj
->
ÿ¼›d_by
);

772 
	`obj_to_room
(
t_obj
, 
obj
->
ÿ¼›d_by
->
š_room
);

774 ià(
obj
->
š_room
)

775 
	`obj_to_room
(
t_obj
, 
obj
->
š_room
);

777 
	`exŒaù_obj
(
t_obj
);

779 
	}
}

782 
	$de¡roy_obj
(
Objeù
 *
obj
) {

783 
	`¥l_cÚ‹Ás
(
obj
, obj->
cÚšs
);

784 
	`¥l_cÚ‹Ás
(
obj
, obj->
gems
);

785 
	`exŒaù_obj
(
obj
);

786 
	}
}

791 
	$exŒaù_obj
(
Objeù
 *
obj
)

793 
Objeù
 *
obj_cÚ‹Á
;

794 
Objeù
 *
obj_Ãxt
;

796 ià(
obj
->
š_room
è
	`obj_äom_room
(obj);

797 ià(
obj
->
ÿ¼›d_by
è
	`obj_äom_ch¬
(obj);

798 ià(
obj
->
š_obj
è
	`obj_äom_obj
(obj);

799 ià(
obj
->
š_lock”
è
	`obj_äom_lock”
(obj);

800 ià(
obj
->
š_¡rÚgbox
è
	`obj_äom_¡rÚgbox
(obj);

802 
obj_cÚ‹Á
 = 
obj
->
cÚšs
; obj_cÚ‹Á; obj_cÚ‹Á = 
obj_Ãxt
) {

803 
obj_Ãxt
 = 
obj_cÚ‹Á
->
Ãxt_cÚ‹Á
;

804 
	`exŒaù_obj
(
obj_cÚ‹Á
);

808 ià(
Game
::
	`wÜld
().
objeù_li¡
 =ğ
obj
)

809 
Game
::
	`wÜld
().
objeù_li¡
 = 
obj
->
Ãxt
;

811 
Objeù
 *
´ev
;

813 
´ev
 = 
Game
::
	`wÜld
().
objeù_li¡
;…»v !ğ
nuÎ±r
;…»v =…»v->
Ãxt
) {

814 ià(
´ev
->
Ãxt
 =ğ
obj
) {

815 
´ev
->
Ãxt
 = 
obj
->next;

829 ià(
obj
 =ğ
Game
::
	`wÜld
().
dÚ©iÚ_p™
)

830 
Game
::
	`wÜld
().
dÚ©iÚ_p™
 = 
nuÎ±r
;

832 ià(
obj
->
pIndexD©a
)

833 --
obj
->
pIndexD©a
->
couÁ
;

835 
d–‘e
 
obj
;

837 
	}
}

842 
	$exŒaù_ch¬
(
Ch¬aù”
 *
ch
, 
boŞ
 
fPuÎ
)

844 
Objeù
 *
obj
;

845 
Objeù
 *
obj_Ãxt
;

847 ià(
ch
->
š_room
 =ğ
nuÎ±r
) {

852 
	`nuke_³ts
(
ch
);

853 
ch
->
³t
 = 
nuÎ±r
;

855 ià(
fPuÎ
)

856 
	`d›_fŞlow”
(
ch
);

858 
	`¡İ_fightšg
(
ch
, 
Œue
);

860 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

861 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

862 
	`exŒaù_obj
(
obj
);

865 
	`ch¬_äom_room
(
ch
);

868 ià(!
fPuÎ
) {

869 
	`ch¬_to_room
(
ch
, 
Game
::
	`wÜld
().
	`g‘_room
((ch->
şª
 !ğ
nuÎ±r
è? ch->şª->
»ÿÎ
 : 
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_ALTAR
))));

873 ià(!
ch
->
	`is_Åc
()) {

874 
obj
 = 
ch
->
pcd©a
->
lock”
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

875 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

876 
	`exŒaù_obj
(
obj
);

879 
obj
 = 
ch
->
pcd©a
->
¡rÚgbox
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

880 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

881 
	`exŒaù_obj
(
obj
);

885 ià(
ch
->
	`is_Åc
())

886 --
ch
->
pIndexD©a
->
couÁ
;

888 ià(
ch
->
desc
 !ğ
nuÎ±r
 && ch->desc->
Üigš®
 !=‚ullptr) {

889 
	`do_»tuº
(
ch
, "");

890 
ch
->
desc
 = 
nuÎ±r
;

893 autØ
wch
 : 
Game
::
	`wÜld
().
ch¬_li¡
)

894 ià(! 
	`¡rÿ£cmp
(
wch
->
»¶y
, 
ch
->
Çme
))

895 
wch
->
»¶y
.
	`ş—r
();

897 
Game
::
	`wÜld
().
	`»move_ch¬
(
ch
);

899 ià(
ch
->
desc
 !ğ
nuÎ±r
)

900 
ch
->
desc
->
ch¬aù”
 = 
nuÎ±r
;

901 
	}
}

912 
boŞ
 
	$mob_exi¡s
(cÚ¡ *
Çme
)

914 cÚ¡‡uto& 
¬—_·œ
 : 
Game
::
	`wÜld
().
¬—s
)

915 cÚ¡‡uto& 
·œ
 : 
¬—_·œ
.
£cÚd
->
mob_´ÙÙy³s
)

916 ià(
·œ
.
£cÚd
->
¶ay”_Çme
.
	`has_exaù_wÜds
(
Çme
))

917  
Œue
;

919  
çl£
;

920 
	}
}

926 
Objeù
 *
	$g‘_obj_ty³
(
ObjeùPrÙÙy³
 *
pObjIndex
)

928 
Objeù
 *
obj
;

930 
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt
) {

931 ià(
obj
->
pIndexD©a
 =ğ
pObjIndex
)

932  
obj
;

935  
nuÎ±r
;

936 
	}
}

939 
boŞ
 
	$deduù_co¡
(
Ch¬aù”
 *
ch
, 
co¡
)

941 
sv”
, 
gŞd
 = 0;

943 ià(
co¡
 < 0) {

944 
co¡
 *= -1;

945 
gŞd
 = 
co¡
 / 100;

946 
sv”
 = 
co¡
 - (
gŞd
 * 100);

947 
ch
->
gŞd
 += gold;

948 
ch
->
sv”
 += silver;

949  
Œue
;

952 ià(
ch
->
sv”
 + (100 * ch->
gŞd
è< 
co¡
)

953  
çl£
;

955 
sv”
 = 
¡d
::
	`mš
(
ch
->sv”, 
co¡
);

957 ià(
sv”
 < 
co¡
) {

958 
gŞd
 = ((
co¡
 - 
sv”
 + 99) / 100);

959 
sv”
 = 
co¡
 - (100 * 
gŞd
);

962 
ch
->
gŞd
 -= gold;

963 
ch
->
sv”
 -= silver;

964  
Œue
;

965 
	}
}

970 
Objeù
 *
	$ü—‹_mÚey
(
gŞd
, 
sv”
)

972 
Objeù
 *
obj
;

973 
Çme
[
MSL
], 
shÜt_desü
[MSL], 
desütiÚ
[MSL], 
m©”Ÿl
[MSL];

974 
amt
 = 0;

975 cÚ¡ *
amouÁ
[] = {

986 ià(
gŞd
 <ğ0 && 
sv”
 <= 0) {

987 
Loggšg
::
	`bug
("Create_money: zero or‚egative money.", 0);

988 
gŞd
 = 
¡d
::
	`max
(1, gold);

989 
sv”
 = 
¡d
::
	`max
(1, silver);

992 ià(
gŞd
 + 
sv”
 > 1) {

993 ià(
gŞd
 + 
sv”
 > 500000è
amt
 = 7;

994 ià(
gŞd
 + 
sv”
 > 100000è
amt
 = 6;

995 ià(
gŞd
 + 
sv”
 > 25000è
amt
 = 5;

996 ià(
gŞd
 + 
sv”
 > 5000è
amt
 = 4;

997 ià(
gŞd
 + 
sv”
 > 500è
amt
 = 3;

998 ià(
gŞd
 + 
sv”
 > 100è
amt
 = 2;

999 ià(
gŞd
 + 
sv”
 > 20è
amt
 = 1;

1000 
amt
 = 0;

1003 ià((
obj
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
GEN_OBJ_MONEY
), 0)è=ğ
nuÎ±r
) {

1004 
Loggšg
::
	`bug
("create_money:‚o generic money object", 0);

1005  
nuÎ±r
;

1008 ià(
gŞd
 + 
sv”
 == 1) {

1009 
FÜm©
::
	`¥rštf
(
Çme
, "coš % gÿsh", 
sv”
 == 1 ? "silver" : "gold");

1010 
FÜm©
::
	`¥rštf
(
shÜt_desü
, "¨% coš", 
sv”
 == 1 ? "silver" : "gold");

1011 
FÜm©
::
	`¥rštf
(
desütiÚ
, "OÃ % coš.", 
sv”
 == 1 ? "miserable silver" : "valuable gold");

1012 
FÜm©
::
	`¥rštf
(
m©”Ÿl
, 
sv”
 == 1 ? "silver" : "gold");

1015 
sv”_desc
[
MSL
], 
gŞd_desc
[MSL];

1017 
FÜm©
::
	`¥rštf
(
Çme
, "coins %s%sgcash",

1018 
sv”
 > 0 ? "silver " : "",

1019 
gŞd
 > 0 ? "gold " : "");

1022 ià(
sv”
 == 1)

1023 
FÜm©
::
	`¥rštf
(
sv”_desc
, "one silver coin");

1025 
FÜm©
::
	`¥rštf
(
sv”_desc
, "%d sv” cošs", 
sv”
);

1027 ià(
gŞd
 == 1)

1028 
FÜm©
::
	`¥rštf
(
gŞd_desc
, "%sÚgŞd coš", 
sv”
 == 0 ? "" : "‡nd ");

1030 
FÜm©
::
	`¥rštf
(
gŞd_desc
, "%s%d gŞd cošs", 
sv”
 =ğ0 ? "" : "‡nd ", 
gŞd
);

1032 
FÜm©
::
	`¥rštf
(
shÜt_desü
, "%s%s",

1033 
sv”
 > 0 ? 
sv”_desc
 : "",

1034 
gŞd
 > 0 ? 
gŞd_desc
 : "");

1036 
FÜm©
::
	`¥rštf
(
desütiÚ
, "%s…ile of %scoins.",

1037 
amouÁ
[
amt
],

1038 
sv”
 =ğ0 ? "gŞd " : 
gŞd
 == 0 ? "silver " : "");

1040 
FÜm©
::
	`¥rštf
(
m©”Ÿl
, "%s%s",

1041 
sv”
 > 0 ? "silver" : "",

1042 
gŞd
 > 0 ? 
sv”
 > 0 ? "‡nd gold" : "gold" : "");

1045 
obj
->
Çme
 =‚ame;

1046 
obj
->
shÜt_desü
 = short_descr;

1047 
obj
->
desütiÚ
 = description;

1048 
obj
->
m©”Ÿl
 = material;

1049 
obj
->
v®ue
[0] = 
sv”
;

1050 
obj
->
v®ue
[1] = 
gŞd
;

1051 
obj
->
co¡
 = 100 * 
gŞd
 + 
sv”
;

1052 
obj
->
weight
 = 
	`URANGE
(1, ((
gŞd
 / 5è+ (
sv”
 / 20)), 30000);

1053  
obj
;

1054 
	}
}

1058 
	$g‘_lock”_numb”
(
Ch¬aù”
 *
ch
)

1060 
Objeù
 *
obj
;

1061 
numb”
 = 0;

1063 ià(
ch
->
	`is_Åc
())

1066 
obj
 = 
ch
->
pcd©a
->
lock”
; obj; obj = obj->
Ãxt_cÚ‹Á
)

1067 
numb”
 +ğ
	`g‘_obj_numb”
(
obj
);

1069  
numb”
;

1070 
	}
}

1072 
	$g‘_¡rÚgbox_numb”
(
Ch¬aù”
 *
ch
)

1074 
Objeù
 *
obj
;

1075 
numb”
 = 0;

1077 ià(
ch
->
	`is_Åc
())

1080 
obj
 = 
ch
->
pcd©a
->
¡rÚgbox
; obj; obj = obj->
Ãxt_cÚ‹Á
)

1081 
numb”
 +ğ
	`g‘_obj_numb”
(
obj
);

1083  
numb”
;

1084 
	}
}

1086 
	$g‘_ÿ¼y_numb”
(
Ch¬aù”
 *
ch
)

1088 
Objeù
 *
obj
;

1089 
numb”
 = 0;

1091 
obj
 = 
ch
->
ÿ¼yšg
; obj; obj = obj->
Ãxt_cÚ‹Á
)

1092 
numb”
 +ğ
	`g‘_obj_numb”
(
obj
);

1094  
numb”
;

1095 
	}
}

1097 
	$g‘_obj_numb”
(
Objeù
 *
obj
)

1099 
numb”
 = 1;

1101 ià(((
obj
->
™em_ty³
 =ğ
ITEM_CONTAINER
 || 
	`IS_OBJ_STAT
(obj, 
ITEM_COMPARTMENT
)è&& obj->
cÚšs
)

1102 || 
obj
->
™em_ty³
 =ğ
ITEM_MONEY
 || obj->™em_ty³ =ğ
ITEM_TOKEN
)

1103 
numb”
 = 0;

1105 
obj
 = obj->
cÚšs
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
)

1106 
numb”
 +ğ
	`g‘_obj_numb”
(
obj
);

1108  
numb”
;

1109 
	}
}

1111 
	$g‘_lock”_weight
(
Ch¬aù”
 *
ch
)

1113 
Objeù
 *
obj
;

1114 
weight
 = 0;

1116 ià(
ch
->
	`is_Åc
())

1119 
obj
 = 
ch
->
pcd©a
->
lock”
; obj; obj = obj->
Ãxt_cÚ‹Á
)

1120 
weight
 +ğ
	`g‘_obj_weight
(
obj
);

1122  
weight
;

1123 
	}
}

1125 
	$g‘_ÿ¼y_weight
(
Ch¬aù”
 *
ch
)

1127 
Objeù
 *
obj
;

1128 
weight
 = 0;

1130 
obj
 = 
ch
->
ÿ¼yšg
; obj; obj = obj->
Ãxt_cÚ‹Á
)

1131 
weight
 +ğ
	`g‘_obj_weight
(
obj
);

1133 
weight
 +ğ
	`gŞd_weight
(
ch
->
gŞd
è+ 
	`sv”_weight
(ch->
sv”
);

1134  
	`URANGE
(0, 
weight
, 9999);

1135 
	}
}

1137 
	$g‘_obj_weight
(
Objeù
 *
obj
)

1139 
weight
;

1140 
Objeù
 *
tobj
;

1141 
weight
 = 
obj
->weight;

1143 
tobj
 = 
obj
->
cÚšs
;obj !ğ
nuÎ±r
;obj =obj->
Ãxt_cÚ‹Á
)

1144 
weight
 +ğ
	`g‘_obj_weight
(
tobj
è* 
	`WEIGHT_MULT
(
obj
) / 100;

1146  
weight
;

1147 
	}
}

1149 
	$g‘_Œue_weight
(
Objeù
 *
obj
)

1151 
weight
;

1152 
weight
 = 
obj
->weight;

1154 
obj
 = obj->
cÚšs
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
)

1155 
weight
 +ğ
	`g‘_obj_weight
(
obj
);

1157  
weight
;

1158 
	}
}

1160 
boŞ
 
	$is_room_owÃr
(
Ch¬aù”
 *
ch
, 
Room
 *
room
)

1162 ià(
room
->
	`owÃr
().
	`em±y
())

1163  
çl£
;

1165  
room
->
	`owÃr
().
	`has_wÜds
(
ch
->
Çme
);

1166 
	}
}

1169 
boŞ
 
	$ÿn_£e_room
(cÚ¡ 
Ch¬aù”
 *
ch
, cÚ¡ 
Room
 *
room
)

1171 ià(
room
->
	`æags
().
	`has
(
ROOM_IMP_ONLY
)

1172 && 
	`GET_RANK
(
ch
è< 
RANK_IMP
)

1173  
çl£
;

1175 ià(
	`IS_IMMORTAL
(
ch
))

1176  
Œue
;

1180 ià(
room
->
	`æags
().
	`has
(
ROOM_GODS_ONLY
))

1181  
çl£
;

1183 ià(
room
->
	`æags
().
	`has
(
ROOM_REMORT_ONLY
)

1184 && !
	`IS_REMORT
(
ch
))

1185  
çl£
;

1187 ià(
room
->
	`æags
().
	`has
(
ROOM_HEROES_ONLY
)

1188 && !
	`IS_HEROIC
(
ch
))

1189  
çl£
;

1191 ià(
room
->
	`æags
().
	`has
(
ROOM_NEWBIES_ONLY
)

1192 && 
ch
->
Ëv–
 > 5 && !ch->
aù_æags
.
	`has
(
PLR_MAKEBAG
))

1193  
çl£
;

1196 ià(
room
->
	`şª
()) {

1207 ià(
ch
->
	`is_Åc
(è&& ch->
ma¡”
) {

1208 ià(
ch
->
ma¡”
->
şª
 !ğ
room
->
	`şª
())

1209  
çl£
;

1212 ià(
ch
->
şª
 !ğ
room
->
	`şª
(è&& ch->
šv™”s
 !=„oom->clan())

1213  
çl£
;

1216 ià(
room
->
	`æags
().
	`has
(
ROOM_LEADER_ONLY
)

1217 && !
ch
->
	`has_cgroup
(
GROUP_LEADER
))

1218  
çl£
;

1220 ià(
room
->
	`æags
().
	`has
(
ROOM_MALE_ONLY
è&& 
	`GET_ATTR_SEX
(
ch
è!ğ
SEX_MALE
)

1221  
çl£
;

1223 ià(
room
->
	`æags
().
	`has
(
ROOM_FEMALE_ONLY
è&& 
	`GET_ATTR_SEX
(
ch
è!ğ
SEX_FEMALE
)

1224  
çl£
;

1226  
Œue
;

1227 
	}
}

1229 
boŞ
 
	$is_blšded
(cÚ¡ 
Ch¬aù”
 *
ch
) {

1230 ià(
	`IS_IMMORTAL
(
ch
))

1231  
çl£
;

1233 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
blšdÃss
)

1234 || 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
dœt_kickšg
)

1235 || 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
fœe_b»©h
)

1236 || 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
smokesü“n
)

1237 || 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
dazzË
))

1238  
Œue
;

1240  
çl£
;

1241 
	}
}

1246 
boŞ
 
	$ÿn_£e_ch¬
(cÚ¡ 
Ch¬aù”
 *
ch
, cÚ¡ Ch¬aù” *
viùim
)

1248 ià(
ch
 =ğ
viùim
)

1249  
Œue
;

1251 ià(
	`IS_IMP
(
ch
))

1252  
Œue
;

1254 ià(!
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
PLR_SUPERWIZ
))

1255  
çl£
;

1257 ià(
	`IS_IMMORTAL
(
ch
))

1258  
Œue
;

1260 ià(
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
ACT_SUPERMOB
))

1261  
çl£
;

1263 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
midnight
))

1264  
çl£
;

1266 ià(!
	`IS_IMMORTAL
(
ch
è&& 
viùim
->
lurk_Ëv–
 && ch->
š_room
 != victim->in_room)

1267  
çl£
;

1269 ià(
viùim
->
švis_Ëv–
)

1270  
çl£
;

1272 ià(
	`is_blšded
(
ch
))

1273  
çl£
;

1275 ià((
ch
->
š_room
->
	`is_d¬k
(è&& !
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
night_visiÚ
))

1276 || 
ch
->
š_room
->
	`is_v”y_d¬k
())

1277  
çl£
;

1279 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
švis
)

1280 && !
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
d‘eù_švis
))

1281  
çl£
;

1284 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
¢—k
)

1285 && !
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
d‘eù_hidd’
)

1286 && 
viùim
->
fightšg
 =ğ
nuÎ±r
) {

1287 
chªû
;

1288 
chªû
 = 
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
¢—k
);

1289 
chªû
 +ğ
	`GET_ATTR_DEX
(
ch
) * 3 / 2;

1290 
chªû
 -ğ
	`GET_ATTR_INT
(
ch
) * 2;

1291 
chªû
 +ğ
ch
->
Ëv–
 - 
viùim
->level * 3 / 2;

1293 ià(
	`numb”_³rûÁ
(è< 
chªû
)

1294  
çl£
;

1297 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
hide
)

1298 && !
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
d‘eù_hidd’
)

1299 && 
viùim
->
fightšg
 =ğ
nuÎ±r
)

1300  
çl£
;

1302  
Œue
;

1303 
	}
}

1309 
boŞ
 
	$ÿn_£e_who
(cÚ¡ 
Ch¬aù”
 *
ch
, cÚ¡ Ch¬aù” *
viùim
)

1312 ià(
viùim
->
švis_Ëv–
 && !
	`IS_IMMORTAL
(
ch
))

1313  
çl£
;

1316 ià(
viùim
->
aù_æags
.
	`has
(
PLR_SUPERWIZ
è&& !viùim->
	`is_Åc
(è&& !
	`IS_IMP
(
ch
))

1317  
çl£
;

1320 ià(!
	`IS_IMMORTAL
(
ch
è&& 
viùim
->
lurk_Ëv–
 && ch->
š_room
 != victim->in_room)

1321  
çl£
;

1324  
Œue
;

1325 
	}
}

1331 
boŞ
 
	$ÿn_£e_š_room
(cÚ¡ 
Ch¬aù”
 *
ch
, cÚ¡ 
Room
 *
room
)

1333 ià(
	`IS_IMMORTAL
(
ch
))

1334  
Œue
;

1336 ià(
room
->
	`is_v”y_d¬k
())

1337  
çl£
;

1339 ià(
	`is_blšded
(
ch
))

1340  
çl£
;

1342 ià(
room
->
	`is_d¬k
(è&& !
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
night_visiÚ
))

1343  
çl£
;

1345  
Œue
;

1346 
	}
}

1351 
boŞ
 
	$ÿn_£e_obj
(cÚ¡ 
Ch¬aù”
 *
ch
, cÚ¡ 
Objeù
 *
obj
)

1353 ià(
	`IS_IMMORTAL
(
ch
))

1354  
Œue
;

1356 ià(
ch
->
š_room
->
	`is_v”y_d¬k
())

1357  
çl£
;

1359 ià(
	`is_blšded
(
ch
))

1360  
çl£
;

1362 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_VIS_DEATH
è&& obj->
ÿ¼›d_by
 !ğ
ch
)

1363  
çl£
;

1365 ià(
obj
->
tim”
 > 0 && !
ch
->
	`is_Åc
(è&& obj->
Çme
.
	`has_wÜds
("mox")

1366 && !
obj
->
Çme
.
	`sub¡r
(4).
	`has_wÜds
(
ch
->name))

1367  
çl£
;

1369 ià(
obj
->
pIndexD©a
->
vnum
 =ğ
OBJ_VNUM_SQUESTOBJ
) {

1370 ià(
ch
->
	`is_Åc
())

1371  
çl£
;

1373 ià(!
	`IS_SQUESTOR
(
ch
è|| ch->
pcd©a
->
sque¡obj
 =ğ
nuÎ±r
 || 
obj
 != ch->pcdata->squestobj)

1374  
çl£
;

1377 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_INVIS
)

1378 && !
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
d‘eù_švis
))

1379  
çl£
;

1381 ià(
obj
->
™em_ty³
 =ğ
ITEM_LIGHT
 && obj->
v®ue
[2] != 0)

1382  
Œue
;

1384 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_GLOW
))

1385  
Œue
;

1387 ià(
ch
->
š_room
->
	`is_d¬k
(è&& !
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
night_visiÚ
))

1388  
çl£
;

1390  
Œue
;

1391 
	}
}

1396 
boŞ
 
	$ÿn_drİ_obj
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
)

1398 ià(!
	`IS_OBJ_STAT
(
obj
, 
ITEM_NODROP
))

1399  
Œue
;

1401 ià(
	`IS_IMMORTAL
(
ch
))

1402  
Œue
;

1404  
çl£
;

1405 
	}
}

1427 
	$·r£_de™y
(cÚ¡ 
SŒšg
& 
d¡ršg
)

1429 ià(
d¡ršg
.
	`em±y
())

1432 
i
 = 0; i < 
de™y_bË
.
	`size
(); i++)

1433 ià(
	`¡r¡r
(
d¡ršg
.
	`uncŞÜ
(), 
de™y_bË
[
i
].
Çme
))

1434  
i
;

1437 
	}
}

1439 
	$g‘_u§bË_Ëv–
(
Ch¬aù”
 *
ch
)

1441 
Ëv–
 = 0;

1443 ià(
	`IS_IMMORTAL
(
ch
))

1446 ià(
ch
->
	`is_Åc
())

1447  
ch
->
Ëv–
;

1449 ià(
	`IS_REMORT
(
ch
))

1451 
Ëv–
 = 
ch
->Ëv– + ((ch->
pcd©a
->
»mÜt_couÁ
 / 3) + 6);

1453 
Ëv–
 = 
ch
->level + 5;

1455  
¡d
::
	`mš
(
Ëv–
, 
LEVEL_HERO
);

1456 
	}
}

1458 
	$g‘_hŞdabË_Ëv–
(
Ch¬aù”
 *
ch
)

1460 
Ëv–
 = 0;

1462 ià(
	`IS_IMMORTAL
(
ch
))

1465 ià(
ch
->
	`is_Åc
())

1466  
ch
->
Ëv–
;

1468 ià(
	`IS_REMORT
(
ch
))

1470 
Ëv–
 = 
ch
->Ëv– + ((ch->
pcd©a
->
»mÜt_couÁ
 / 3) + 6);

1472 
Ëv–
 = 
ch
->level + 8;

1474  
Ëv–
;

1475 
	}
}

1485 
SŒšg
 
	$g‘_owÃr
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
)

1487 ià(
obj
->
exŒa_desü
 !ğ
nuÎ±r
) {

1488 
ExŒaDesü
 *
ed_Ãxt
;

1489 
ExŒaDesü
 *
ed
;

1491 
ed
 = 
obj
->
exŒa_desü
;ƒd !ğ
nuÎ±r
;ƒd = 
ed_Ãxt
) {

1492 
ed_Ãxt
 = 
ed
->
Ãxt
;

1494 ià(
ed
->
keywÜd
 =ğ
KEYWD_OWNER
) {

1495 ià(
	`ÿn_£e_obj
(
ch
, 
obj
))

1496  
ed
->
desütiÚ
;

1504 
	}
}

1506 
Ch¬aù”
 *
	$g‘_obj_ÿ¼›r
(
Objeù
 *
obj
)

1508 
Objeù
 *
š_obj
;

1510 
š_obj
 = 
obj
; in_obj->š_obj !ğ
nuÎ±r
; in_obj = in_obj->in_obj)

1513  
š_obj
->
ÿ¼›d_by
;

1514 
	}
}

1521 
	$g‘_pos™iÚ
(
Ch¬aù”
 *
ch
)

1523 ià(
ch
 =ğ
nuÎ±r
)

1526 ià(
ch
->
fightšg


1527 && 
ch
->
pos™iÚ
 >ğ
POS_STANDING
)

1528  
POS_FIGHTING
;

1530  
ch
->
pos™iÚ
;

1531 
	}
}

1534 
	$g‘_¶ay_hours
(
Ch¬aù”
 *
ch
)

1536  (
ch
->
	`is_Åc
(è? 0 : ch->
pcd©a
->
¶ayed
 / 3600);

1537 
	}
}

1540 
	$g‘_¶ay_£cÚds
(
Ch¬aù”
 *
ch
)

1542  (
ch
->
	`is_Åc
(è? 0 : ch->
pcd©a
->
¶ayed
);

1543 
	}
}

1547 
	$g‘_afãù_evŞutiÚ
(
Ch¬aù”
 *
ch
, 
afãù
::
ty³
ype)

1549 
evo
 = 1;

1551 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_ch¬
(
ch
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
)

1552 ià(
·f
->
ty³
 =ğty³ &&…af->
evŞutiÚ
 > 
evo
)

1553 
evo
 = 
·f
->
evŞutiÚ
;

1555  
	`URANGE
(1, 
evo
, 3);

1556 
	}
}

1559 
	$š‹½Ş©e
(
Ëv–
, 
v®ue_00
, 
v®ue_32
)

1561  
v®ue_00
 + 
Ëv–
 * (
v®ue_32
 - value_00) / 32;

1562 
	}
}

1565 cÚ¡ 
ExŒaDesü
 *
	$g‘_exŒa_desü
(cÚ¡ 
SŒšg
& 
Çme
, cÚ¡ 
ExŒaDesü
 *
ed
)

1567 ; 
ed
 !ğ
nuÎ±r
;ƒd =ƒd->
Ãxt
)

1568 ià(
ed
->
keywÜd
.
	`has_wÜds
(
Çme
))

1569  
ed
;

1571  
nuÎ±r
;

1572 
	}
}

	@src/help.cc

11 
	~<veùÜ
>

13 
	~"¬gum’t.hh
"

14 
	~"Ch¬aù”.hh
"

15 
	~"deş¬e.hh
"

16 
	~"fe.hh
"

17 
	~"FÏgs.hh
"

18 
	~"FÜm©.hh
"

19 
	~"Game.hh
"

20 
	~"š‹½.hh
"

21 
	~"Loggšg.hh
"

22 
	~"m”c.hh
"

23 
	~"NÙe.hh
"

24 
	~"PÏy”.hh
"

25 
	~"sql.hh
"

26 
	~"SŒšg.hh
"

28 cÚ¡ 
SŒšg
 
	g¡upidas¦še
 =

29 #ifdeà
SEASON_CHRISTMAS


35 
	#HTABLE
 "h–ps"

	)

36 
	#HCOL_ID
 "id"

	)

37 
	#HCOL_ORDER
 "Úum"

	)

38 
	#HCOL_LEVEL
 "Ëv–"

	)

39 
	#HCOL_GROUP
 "hgroup"

	)

40 
	#HCOL_KEYS
 "keywÜds"

	)

41 
	#HCOL_TEXT
 "‹xt"

	)

49 
	#HELP_INFO
 
FÏgs
::
A


	)

50 
	#HELP_CLAN
 
FÏgs
::
B


	)

51 
	#HELP_SKILL
 
FÏgs
::
C


	)

52 
	#HELP_SPELL
 
FÏgs
::
D


	)

53 
	#HELP_RACE
 
FÏgs
::
E


	)

54 
	#HELP_CLASS
 
FÏgs
::
F


	)

55 
	#HELP_REMORT
 
FÏgs
::
G


	)

56 
	#HELP_MOVE
 
FÏgs
::
H


	)

57 
	#HELP_OBJECT
 
FÏgs
::
I


	)

58 
	#HELP_COMM
 
FÏgs
::
J


	)

59 
	#HELP_COMBAT
 
FÏgs
::
K


	)

60 
	#HELP_MISC
 
FÏgs
::
L


	)

61 
	#HELP_WIZQUEST
 
FÏgs
::
M


	)

62 
	#HELP_WIZSECURE
 
FÏgs
::
N


	)

63 
	#HELP_WIZCODE
 
FÏgs
::
O


	)

64 
	#HELP_WIZGEN
 
FÏgs
::
P


	)

65 
	#HELP_WIZBUILD
 
FÏgs
::
Q


	)

66 
	#HELP_WIZHELP
 
FÏgs
::
R


	)

68 
	sh–pfe_bË_ty³


70 
SŒšg
 
	mÇme
;

71 
	mgroup
;

75 cÚ¡ 
	g¡d
::
veùÜ
<
h–pfe_bË_ty³
> 
h–pfe_bË
 = {

76 { "wizh–p", 
HELP_WIZHELP
 },

77 { "wizque¡", 
HELP_WIZQUEST
 },

78 { "wiz£cu»", 
HELP_WIZSECURE
 },

79 { "wizcode", 
HELP_WIZCODE
 },

80 { "wizg’", 
HELP_WIZGEN
 },

81 { "wizbud", 
HELP_WIZBUILD
 },

82 { "skl", 
HELP_SKILL
 },

83 { "¥–l", 
HELP_SPELL
 },

84 { "¿û", 
HELP_RACE
 },

85 { "şass", 
HELP_CLASS
 },

86 { "»mÜt", 
HELP_REMORT
 },

87 { "şª", 
HELP_CLAN
 },

88 { "move", 
HELP_MOVE
 },

89 { "objeù", 
HELP_OBJECT
 },

90 { "comm", 
HELP_COMM
 },

91 { "šfo", 
HELP_INFO
 },

92 { "comb©", 
HELP_COMBAT
 },

93 { "misc", 
HELP_MISC
 },

98 cÚ¡ *
	$Úe_keywÜd
(cÚ¡ *
keywÜds
, *
wÜd
)

100 
	`is¥aû
(*
keywÜds
))

101 
keywÜds
++;

103 *
keywÜds
 != '\0') {

104 ià(*
keywÜds
 == '\'' || *keywords == '"') {

105 
keywÜds
++;

109 ià(*
keywÜds
 == ' ')

112 *
wÜd
 = *
keywÜds
;

113 
wÜd
++;

114 
keywÜds
++;

117 *
wÜd
 = '\0';

119 
	`is¥aû
(*
keywÜds
))

120 
keywÜds
++;

122  
keywÜds
;

123 
	}
}

125 
	$h–p_ch¬_£¬ch
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬g
)

127 
SŒšg
 
buf
, 
‹xt
;

128 
qu”y
[
MSL
];

129 
SŒšg
 
ouut
;

130 
i
 = 0, 
couÁ
 = 0;

131 
SŒšg
 
esc_¬g
 = 
	`db_esc
(
¬g
);

133 
FÜm©
::
	`¥rštf
(
qu”y
, "SELECT " 
HCOL_KEYS
 " FROM " 
HTABLE
 " WHERE " 
HCOL_LEVEL
 " <= %d "

134 "AND " 
HCOL_KEYS
 " LIKE '%% %s%%' "

135 "OR " 
HCOL_KEYS
 " LIKE '%s%%' "

136 "OR " 
HCOL_KEYS
 " LIKE '%%''%s%%' "

137 "ORDER BY " 
HCOL_KEYS
,

138 
ch
->
Ëv–
, 
esc_¬g
,ƒsc_arg,ƒsc_arg

141 ià(
	`db_qu”y
("h–p_ch¬_£¬ch", 
qu”y
è!ğ
SQL_OK
) {

142 
	`¡c
("There was‡…roblem with your help query,…lease‚otifyhe imms\n"

143 "usšgh'bug' commªd. Maksu»Ø§y wh© youy³d.\n", 
ch
);

147 
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

148 
couÁ
++;

149 cÚ¡ *
keywÜds
 = 
	`db_g‘_cŞumn_¡r
(0);

151 ià(!
	`SŒšg
(
keywÜds
).
	`has_wÜds
(
¬g
))

154 
buf
 +ğ++
i
 % 2 ? " {W" : " {c";

155 
buf
 +ğ
keywÜds
;

158 ià(
couÁ
 == 0) {

159 
	`¡c
("NØh–p w”found w™h keywÜd begšnšg w™hh© ch¬aù”.\n", 
ch
);

163 
ouut
 +ğ
¡upidas¦še
;

164 
ouut
 +ğ
FÜm©
::
	`fÜm©
("\n{WH–p w™h keywÜd begšnšg w™hhË‰” '{c%s{W':{x\n\n", 
¬g
);

165 
‹xt
 = 
	`fÜm©_¡ršg
(
buf
);

166 
ouut
 +ğ
‹xt
;

167 
ouut
 +ğ
FÜm©
::
	`fÜm©
("\n{W[%d]Ù® h–°’Œ›s.{x\n\n", 
i
);

168 
ouut
 +ğ
¡upidas¦še
;

169 
	`·ge_to_ch¬
(
ouut
, 
ch
);

170 
	}
}

173 
	$h–p
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
)

175 
SŒšg
 
qu”y
;

176 cÚ¡ *
p
;

177 
SŒšg
 
ouut
;

178 
FÜm©
::
	`¥rštf
(
qu”y
, "SELECT " 
HCOL_TEXT
 " FROM " 
HTABLE
 " WHERE ");

179 
p
 = 
¬gum’t
.
	`c_¡r
();

181 *
p
 != '\0') {

182 
wÜd
[
MIL
];

183 
p
 = 
	`Úe_keywÜd
Õ, 
wÜd
);

184 
qu”y
 +ğ
HCOL_KEYS
 " LIKE '";

185 
qu”y
 +ğ
	`db_esc
(
wÜd
);

186 
qu”y
 += "%'";

188 ià(*
p
 != '\0')

189 
qu”y
 += " AND ";

192 
qu”y
 += " LIMIT 1";

194 ià(
	`db_qu”y
("h–p", 
qu”y
è!ğ
SQL_OK
)

197 ià(
	`db_Ãxt_row
(è!ğ
SQL_OK
) {

198 
Loggšg
::
	`bugf
("h–p():‚Øh–p w™h keywÜd '%s'", 
¬gum’t
);

202 cÚ¡ *
‹xt
 = 
	`db_g‘_cŞumn_¡r
(0);

204 ià(
‹xt
 =ğ
nuÎ±r
) {

205 
Loggšg
::
	`bugf
("h–p(): h–°w™h keywÜd '%s' ha nuÎext", 
¬gum’t
);

209 
ouut
 +ğ
‹xt
 + (text[0] == '.' ? 1 : 0);

210 
	`¡c
(
ouut
, 
ch
);

211 
	}
}

213 
	$add_h–p
(
group
, 
Üd”
, 
Ëv–
, cÚ¡ 
SŒšg
& 
keywÜds
, cÚ¡ SŒšg& 
‹xt
)

215 
SŒšg
 
qu”y
;

217 ià(
keywÜds
 == "GREETING") {

218 
Game
::
h–p_g»‘šg
 = 
‹xt
;

221 
FÜm©
::
	`¥rštf
(
qu”y
, "INSERT INTO " 
HTABLE
 " (" 
HCOL_GROUP
 "," 
HCOL_ORDER
 "," 
HCOL_LEVEL
 "," 
HCOL_KEYS
 "," 
HCOL_TEXT
 ") "

222 "VALUES(%d,%d,%d,'", 
group
, 
Üd”
, 
Ëv–


224 
qu”y
 +ğ
	`db_esc
(
keywÜds
);

225 
qu”y
 += "','";

226 
qu”y
 +ğ
	`db_esc
(
‹xt
);

227 
qu”y
 += "')";

228 
	`db_commªd
("add_h–p", 
qu”y
);

229 
	}
}

234 
	$do_lßdh–ps
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

236 
FILE
 *
å
;

237 
couÁ
 = 0;

238 
	sh–p_¡ruù
 {

239 
Ëv–
;

240 
SŒšg
 
keywÜds
;

241 
SŒšg
 
‹xt
;

243 
h–p_¡ruù
 
‹mp_h–p
[500];

245 ià(
¬gum’t
.
	`em±y
()) {

246 
	`¡c
("Syntax:\n"

249 "FÇme ¬e:\n", 
ch
);

251 cÚ¡‡uto& 
’Œy
 : 
h–pfe_bË
)

252 
	`±c
(
ch
, "%s\n", 
’Œy
.
Çme
);

257 ià(
Game
::
pÜt
 !ğ
DIZZYPORT
) {

258 
	`±c
(
ch
, "PËa£…”fÜm†ßdšg‡nd…rštšg commªd ÚhpÜˆ%d cİy.\n", 
DIZZYPORT
);

262 
SŒšg
 
¬g
;

263 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

265 ià(
¬g
 == "all") {

266 cÚ¡‡uto& 
’Œy
 : 
h–pfe_bË
)

267 
	`do_lßdh–ps
(
ch
, 
’Œy
.
Çme
);

269 
	`¡c
("AÎ h–°fe šh" 
HELP_DIR
 " dœeùÜy†ßded.\n", 
ch
);

270 
	`¡c
("PËa£„ememb”Øş—Àup,„emovthh–°fe w™h„m *.h–p!\n", 
ch
);

274 
bËnum
;

275 
bËnum
 = 0;abËnum < 
h–pfe_bË
.
	`size
();ablenum++)

276 ià(
h–pfe_bË
[
bËnum
].
Çme
.
	`is_´efix_of
(
¬g
))

279 ià(
bËnum
 >ğ
h–pfe_bË
.
	`size
()) {

280 
	`¡c
("Th© i nÙ‡ v®id h–°fÇme. H–°fÇme ¬e:\n\n", 
ch
);

282 cÚ¡‡uto& 
’Œy
 : 
h–pfe_bË
)

283 
	`±c
(
ch
, "%s\n", 
’Œy
.
Çme
);

288 
SŒšg
 
buf
 = 
FÜm©
::
	`fÜm©
(
HELP_DIR
 "%s.h–p", 
h–pfe_bË
[
bËnum
].
Çme
);

290 ià((
å
 = 
	`fİ’
(
buf
.
	`c_¡r
(), "r")è=ğ
nuÎ±r
) {

291 
	`¡c
("FnÙ found - maksu» iˆi u¶ßded iÁØth/¬—/h–p/ dœeùÜy.\n", 
ch
);

296 ià((
‹mp_h–p
[
couÁ
].
Ëv–
 = 
	`ä—d_numb”
(
å
)) < -1)

299 
‹mp_h–p
[
couÁ
].
keywÜds
 = 
	`ä—d_¡ršg
(
å
);

300 
‹mp_h–p
[
couÁ
].
‹xt
 = 
	`ä—d_¡ršg
(
å
);

302 ià(
‹mp_h–p
[
couÁ
].
keywÜds
.
	`em±y
()

303 || 
‹mp_h–p
[
couÁ
].
‹xt
.
	`em±y
())

304 
	`¡c
("E¼Ü: missšgext.\n", 
ch
);

305 ià(
	`¡¾’
(
‹mp_h–p
[
couÁ
].
keywÜds
) > 100)

306 
	`¡c
("E¼Ü: keywÜd lÚg”hª 100 ch¬aù”s.\n", 
ch
);

307 ià(
	`¡¾’
(
‹mp_h–p
[
couÁ
].
‹xt
) > 8000)

308 
	`¡c
("E¼Ü:exˆlÚg”hª 8000 ch¬aù”s.\n", 
ch
);

310 
couÁ
++;

314 
	`±c
(
ch
, "There was‡nƒrror†oadinghe help file '%s.help',",

315 
h–pfe_bË
[
bËnum
].
Çme
);

317 ià(
couÁ
 > 0)

318 
	`±c
(
ch
, "‡á”\Áhh–°'%s'.\n", 
‹mp_h–p
[
couÁ
 - 1].
keywÜds
);

320 
	`¡c
(" oÀthfœ¡ h–p.\n", 
ch
);

322 
	`fşo£
(
å
);

326 
	`db_commªdf
("do_lßdh–ps", "DELETE FROM " 
HTABLE
 " WHERE " 
HCOL_GROUP
 "=%d", 
h–pfe_bË
[
bËnum
].
group
);

328 
couÁ
 = 0; 
‹mp_h–p
[couÁ].
Ëv–
 >= -1; count++) {

329 
boŞ
 
found¥aû
 = 
çl£
;

331 
SŒšg
 
buf
;

332 autØ
p
 = 
‹mp_h–p
[
couÁ
].
keywÜds
.
	`cbegš
();

334 
p
 !ğ
‹mp_h–p
[
couÁ
].
keywÜds
.
	`ûnd
()) {

335 ià(*
p
 == ' ') {

336 ià(
found¥aû
) {

337 
p
++;

341 
found¥aû
 = 
Œue
;

344 
found¥aû
 = 
çl£
;

346 
buf
 +ğ*
p
++;

349 
	`add_h–p
(

350 
h–pfe_bË
[
bËnum
].
group
,

351 
couÁ
 + 1,

352 
‹mp_h–p
[
couÁ
].
Ëv–
,

353 
buf
,

354 
‹mp_h–p
[
couÁ
].
‹xt


358 
	`±c
(
ch
, "F" 
HELP_DIR
 "%s.h–p: %d h–p lßded.\n", 
h–pfe_bË
[
bËnum
].
Çme
, 
couÁ
);

359 
	}
}

362 
	$do_´šth–ps
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

364 
SŒšg
 
buf
;

365 
FILE
 *
å
;

366 
couÁ
 = 0;

368 ià(
¬gum’t
.
	`em±y
()) {

369 
	`¡c
("Syntax:\n"

372 "F’ame ¬e:\n", 
ch
);

374 cÚ¡‡uto& 
’Œy
 : 
h–pfe_bË
)

375 
	`±c
(
ch
, "%s\n", 
’Œy
.
Çme
);

380 ià(
Game
::
pÜt
 !ğ
DIZZYPORT
) {

381 
	`¡c
("PËa£…”fÜm†ßdšg‡nd…rštšg commªd ÚhpÜˆ3000 cİy.\n", 
ch
);

385 
SŒšg
 
¬g
;

386 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

388 ià(
¬g
 == "all") {

389 cÚ¡‡uto& 
’Œy
 : 
h–pfe_bË
)

390 
	`do_´šth–ps
(
ch
, 
’Œy
.
Çme
);

392 
	`¡c
("AÎ h–p havb“À´š‹dØfšh" 
HELP_DIR
 " dœeùÜy.\n", 
ch
);

396 
bËnum
;

397 
bËnum
 = 0;abËnum < 
h–pfe_bË
.
	`size
();ablenum++)

398 ià(
h–pfe_bË
[
bËnum
].
Çme
.
	`is_´efix_of
(
¬g
))

401 ià(
bËnum
 >ğ
h–pfe_bË
.
	`size
()) {

402 
	`¡c
("Th© i nÙ‡ v®id h–°fÇme. H–°fÇme ¬e:\n\n", 
ch
);

404 cÚ¡‡uto& 
’Œy
 : 
h–pfe_bË
)

405 
	`±c
(
ch
, "%s\n", 
’Œy
.
Çme
);

410 ià(
	`db_qu”yf
("do_printhelps",

411 "SELECT " 
HCOL_LEVEL
 "," 
HCOL_KEYS
 "," 
HCOL_TEXT
 " FROM " 
HTABLE
 " WHERE " 
HCOL_GROUP
 "=%d ORDER BY " 
HCOL_ORDER
,

412 
h–pfe_bË
[
bËnum
].
group
è!ğ
SQL_OK
)

415 ià((
å
 = 
	`fİ’
(
TEMP_FILE
, "w")è=ğ
nuÎ±r
) {

416 
Loggšg
::
	`bug
("do_printhelps: unableo openemp file", 0);

420 
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

421 
buf
 = 
	`db_g‘_cŞumn_¡r
(0);

422 
buf
 += " ";

423 
buf
 +ğ
	`SŒšg
(
	`db_g‘_cŞumn_¡r
(1)).
	`»¶aû
("~", "-");

424 
buf
 += "~\n";

425 
buf
 +ğ
	`SŒšg
(
	`db_g‘_cŞumn_¡r
(2)).
	`»¶aû
("~", "-");

426 
buf
 += "~\n\n";

427 
	`åuts
(
buf
.
	`c_¡r
(), 
å
);

428 
couÁ
++;

431 ià(
couÁ
 == 0) {

432 
	`±c
(
ch
, "NØh–°fe çÎ iÁØth'%s' group.\n", 
h–pfe_bË
[
bËnum
].
Çme
);

433 
	`fşo£
(
å
);

437 
FÜm©
::
	`årštf
(
å
, "-2\n");

438 
	`fşo£
(
å
);

439 
FÜm©
::
	`¥rštf
(
buf
, 
HELP_DIR
 "%s.h–p", 
h–pfe_bË
[
bËnum
].
Çme
);

440 
	`»Çme
(
TEMP_FILE
, 
buf
.
	`c_¡r
());

441 
	`±c
(
ch
, "F" 
HELP_DIR
 "%s.h–p: %d h–p ´š‹d.\n", 
h–pfe_bË
[
bËnum
].
Çme
, 
couÁ
);

442 
	}
}

444 
	$do_h–p
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

446 
SŒšg
 
qu”y
;

447 cÚ¡ *
p
;

448 
SŒšg
 
ouut
;

449 
»suÉ_couÁ
 = 0, 
·¹Ÿl_couÁ
 = 0, 
»suÉ_num
 = 0;

450 
	sh–p_¡ruù
 {

451 
ty³
;

452 
hgroup
;

453 
keywÜds
[256];

454 
‹xt
[32767];

455 
id
;

457 
h–p_¡ruù
 
‹mp_h–p
[100];

459 
SŒšg
 
¬g
;

460 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

462 ià(
¬g
.
	`em±y
()) {

463 
	`do_h–p
(
ch
, "SUMMARY");

467 ià(
¬g
 == "departed") {

468 
	`do_d•¬‹d
(
ch
, "");

473 ià((
¬g
.
	`size
() == 1)

474 && ((
¬g
[0] >= 'a' &&‡rg[0] <= 'z')

475 || (
¬g
[0] >= 'A' &&‡rg[0] <= 'Z'))) {

476 
	`h–p_ch¬_£¬ch
(
ch
, 
¬g
);

481 
FÜm©
::
	`¥rštf
(
qu”y
, "SELECT " 
HCOL_GROUP
 "," 
HCOL_KEYS
 "," 
HCOL_TEXT
 "," 
HCOL_ID


482 " FROM " 
HTABLE
 " WHERE " 
HCOL_LEVEL
 " <= %d AND ",

483 
ch
->
Ëv–


485 
p
 = 
¬gum’t
.
	`c_¡r
();

487 *
p
 != '\0') {

488 
wÜd
[
MIL
];

489 
p
 = 
	`Úe_keywÜd
Õ, 
wÜd
);

490 
qu”y
 +ğ
HCOL_KEYS
 " LIKE '%";

491 
qu”y
 +ğ
	`db_esc
(
wÜd
);

492 
qu”y
 += "%'";

494 ià(*
p
 != '\0')

495 
qu”y
 += " AND ";

499 
qu”y
 +ğ" ORDER BY " 
HCOL_ORDER
;

501 ià(
	`db_qu”y
("do_h–p", 
qu”y
è!ğ
SQL_OK
) {

502 
	`¡c
("There was‡…roblem with your help query,…lease‚otifyhe imms\n"

503 "usšgh'bug' commªd. Maksu»Ø§y wh© youy³d.\n", 
ch
);

507 
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

508 
group
 = 
	`db_g‘_cŞumn_št
(0);

509 cÚ¡ *
keywÜds
 = 
	`db_g‘_cŞumn_¡r
(1);

510 cÚ¡ *
‹xt
 = 
	`db_g‘_cŞumn_¡r
(2);

511 
id
 = 
	`db_g‘_cŞumn_št
(3);

513 ià(
keywÜds
 =ğ
nuÎ±r
 || 
‹xt
 ==‚ullptr)

517 ià(
	`SŒšg
(
keywÜds
).
	`has_exaù_wÜds
(
¬gum’t
))

518 
‹mp_h–p
[
»suÉ_couÁ
].
ty³
 = 1;

519 ià(
	`SŒšg
(
keywÜds
).
	`has_wÜds
(
¬gum’t
)) {

520 
‹mp_h–p
[
»suÉ_couÁ
].
ty³
 = 2;

521 
·¹Ÿl_couÁ
++;

526 
i
 = 0; i < 
h–pfe_bË
.
	`size
(); i++)

527 ià(
h–pfe_bË
[
i
].
group
 == group) {

528 
‹mp_h–p
[
»suÉ_couÁ
].
hgroup
 = 
i
;

532 
	`¡rıy
(
‹mp_h–p
[
»suÉ_couÁ
].
keywÜds
, keywords);

535 ià(
‹mp_h–p
[
»suÉ_couÁ
].
ty³
 !ğ2 || 
·¹Ÿl_couÁ
 <= 1)

536 
	`¡rıy
(
‹mp_h–p
[
»suÉ_couÁ
].
‹xt
,ext);

538 
‹mp_h–p
[
»suÉ_couÁ
].
id
 = id;

539 
»suÉ_couÁ
++;

542 ià(
»suÉ_couÁ
 == 0) {

543 
	`¡c
("NØh–p w”found w™hho£ keywÜds.\n", 
ch
);

549 ià(
»suÉ_couÁ
 > 
·¹Ÿl_couÁ
) {

550 
»suÉ_num
 = 0;„esuÉ_num < 
»suÉ_couÁ
;„esult_num++) {

551 ià(
‹mp_h–p
[
»suÉ_num
].
ty³
 != 1)

554 
immbuf
[
MSL
] = "";

556 ià(
	`IS_IMMORTAL
(
ch
))

557 
FÜm©
::
	`¥rštf
(
immbuf
, "(id %d, f%sè", 
‹mp_h–p
[
»suÉ_num
].
id
, 
h–pfe_bË
[‹mp_h–p[»suÉ_num].
hgroup
].
Çme
);

559 
ouut
 +ğ
FÜm©
::
	`fÜm©
("%s\n{W%s%s{x\n\n",

560 
¡upidas¦še
,

561 
immbuf
,

562 
‹mp_h–p
[
»suÉ_num
].
keywÜds
);

564 
ouut
 +ğ
‹mp_h–p
[
»suÉ_num
].
‹xt
 + (temp_help[result_num].text[0] == '.' ? 1 : 0);

565 
ouut
 +ğ
FÜm©
::
	`fÜm©
("\n%s", 
¡upidas¦še
);

568 ià(
·¹Ÿl_couÁ
)

569 
ouut
 += "\nYou could‡lsoryhe following…artial matches:\n\n";

571 ià(
·¹Ÿl_couÁ
 == 1) {

573 
immbuf
[
MSL
] = "";

575 ià(
	`IS_IMMORTAL
(
ch
))

576 
FÜm©
::
	`¥rštf
(
immbuf
, "(id %d, f%sè", 
‹mp_h–p
[
»suÉ_num
].
id
, 
h–pfe_bË
[‹mp_h–p[»suÉ_num].
hgroup
].
Çme
);

578 
ouut
 +ğ
FÜm©
::
	`fÜm©
("%s\n{W%s%s{x\n\n",

579 
¡upidas¦še
,

580 
immbuf
,

581 
‹mp_h–p
[0].
keywÜds
);

582 
ouut
 +ğ
‹mp_h–p
[0].
‹xt
 + (temp_help[0].text[0] == '.' ? 1 : 0);

583 
ouut
 +ğ
FÜm©
::
	`fÜm©
("\n%s", 
¡upidas¦še
);

587 
ouut
 += "No helps were found matching‡ll of your keywords, buthe\n";

588 
ouut
 += "following…artial matches may direct youohe…roper help:\n\n";

591 ià(
·¹Ÿl_couÁ
 && (
»suÉ_couÁ
 >…artial_count ||…artial_count > 1)) {

592 
Ãw»s
;

594 
»suÉ_num
 = 0;„esuÉ_num < 
»suÉ_couÁ
;„esult_num++) {

595 ià(
‹mp_h–p
[
»suÉ_num
].
ty³
 != 2)

599 
Ãw»s
 = 0;‚ew» < 
»suÉ_num
;‚ewres++) {

600 ià(
‹mp_h–p
[
Ãw»s
].
ty³
 != 2)

603 ià(
‹mp_h–p
[
»suÉ_num
].
keywÜds
 =ğ‹mp_h–p[
Ãw»s
].keywords)

607 ià(
Ãw»s
 !ğ
»suÉ_num
)

610 
ouut
 +ğ
FÜm©
::
	`fÜm©
("%s\n", 
‹mp_h–p
[
»suÉ_num
].
keywÜds
);

614 
	`·ge_to_ch¬
(
ouut
, 
ch
);

615 
	}
}

617 
	$do_hed™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

619 ià(
¬gum’t
.
	`em±y
()) {

620 
	`±c
(
ch
, "Syntax: hedit‚ew <keywords>\n"

624 
HCOL_GROUP
, 
HCOL_ORDER
, 
HCOL_LEVEL
, 
HCOL_KEYS
, 
HCOL_TEXT


629 
SŒšg
 
cmd
;

630 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
cmd
);

632 ià(
cmd
 == "new") {

633 ià(
¬gum’t
.
	`em±y
()) {

634 
	`¡c
("You‚“dØ¥ecify somkeywÜds.\n", 
ch
);

638 ià(!
	`db_commªdf
("do_hed™", "š£¹ iÁØ" 
HTABLE
 " ("

639 
HCOL_KEYS
 "," 
HCOL_TEXT
 "," 
HCOL_GROUP
 "," 
HCOL_ORDER
 "," 
HCOL_LEVEL


641 
	`db_esc
(
¬gum’t
))) {

642 
	`¡c
("Could‚Ù c»©¨h–°w™hho£ keywÜds.\n", 
ch
);

646 ià(
	`db_qu”y
("do_h–p", "£Ëù†a¡_š£¹_rowid()"è!ğ
SQL_OK


647 || 
	`db_Ãxt_row
(è!ğ
SQL_OK
) {

648 
	`¡c
("Couldn'ˆ»Œ›vthID oàthÃw h–p.\n", 
ch
);

652 
	`±c
(
ch
, "Sucûss,hÃw h–°ha ª ID oà%s.\n", 
	`db_g‘_cŞumn_¡r
(0));

656 
SŒšg
 
¬g
;

657 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

659 ià(
¬g
.
	`em±y
()) {

660 
	`¡c
("Wh© h–°dØyou wªˆtØİ”©Ú?\n", 
ch
);

664 ià(
	`db_couÁf
("do_hed™", "£Ëù couÁ(*èäom " 
HTABLE
 " wh”" 
HCOL_ID
 "=%s", 
¬g
) < 1) {

665 
	`¡c
("NØh–°found w™hh© ID.\n", 
ch
);

669 ià(
cmd
 == "delete") {

670 
	`db_commªdf
("do_hed™", "d–‘äom " 
HTABLE
 " wh”" 
HCOL_ID
 "=%s", 
¬g
);

671 
	`¡c
("Th© h–°i hi¡Üy‚ow.\n", 
ch
);

675 ià(
cmd
 == "show") {

676 ià(
	`db_qu”yf
("do_help",

677 "£Ëù " 
HCOL_GROUP
 "," 
HCOL_ORDER
 "," 
HCOL_LEVEL
 "," 
HCOL_KEYS
 "," 
HCOL_TEXT


678 " from " 
HTABLE
 " wh”" 
HCOL_ID
 "=%s", 
¬g
è!ğ
SQL_OK


679 || 
	`db_Ãxt_row
(è!ğ
SQL_OK
) {

680 
	`¡c
("Couldn'ˆ»Œ›v¨h–°w™hh© ID.\n", 
ch
);

684 
	`±c
(
ch
, "ID: %4s File: %s Order: %s Level: %s\nKeywords: %s\n%s\n",

685 
¬g
,

686 
	`db_g‘_cŞumn_¡r
(0),

687 
	`db_g‘_cŞumn_¡r
(1),

688 
	`db_g‘_cŞumn_¡r
(2),

689 
	`db_g‘_cŞumn_¡r
(3),

690 
	`db_g‘_cŞumn_¡r
(4)

695 ià(
¬gum’t
.
	`em±y
()) {

696 
	`¡c
("Wh© v®udØyou wªˆtØ£ˆ™o?\n", 
ch
);

700 ià(
cmd
 =ğ
HCOL_GROUP
 || cmd =ğ
HCOL_ORDER
 || cmd =ğ
HCOL_LEVEL
) {

701 ià(!
¬gum’t
.
	`is_numb”
()) {

702 
	`¡c
("New v®uha tØb¨numb”.\n", 
ch
);

706 
	`db_commªdf
("do_hed™", "upd©" 
HTABLE
 " s‘ %s=%d wh”" 
HCOL_ID
 "=%s", 
cmd
, 
	`©oi
(
¬gum’t
), 
¬g
);

707 
	`¡c
("DÚe.\n", 
ch
);

711 ià(
cmd
 =ğ
HCOL_KEYS
 || cmd =ğ
HCOL_TEXT
) {

712 
	`db_commªdf
("do_hed™", "upd©" 
HTABLE
 " s‘ %s='%s' wh”" 
HCOL_ID
 "=%s", 
cmd
, 
	`db_esc
(
¬gum’t
), 
¬g
);

713 
	`¡c
("DÚe.\n", 
ch
);

717 
	`±c
(
ch
, "UnknowÀcommªd '%s'.\n", 
cmd
);

718 
	}
}

	@src/hunt.cc

34 
	~"aù.hh
"

35 
	~"A»a.hh
"

36 
	~"Ch¬aù”.hh
"

37 
	~"deş¬e.hh
"

38 
	~"Ex™.hh
"

39 
	~"fšd.hh
"

40 
	~"FÏgs.hh
"

41 
	~"FÜm©.hh
"

42 
	~"Game.hh
"

43 
	~"š‹½.hh
"

44 
	~"memÜy.hh
"

45 
	~"m”c.hh
"

46 
	~"PÏy”.hh
"

47 
	~"¿ndom.hh
"

48 
	~"Room.hh
"

49 
	~"skl/skl.hh
"

50 
	~"SŒšg.hh
"

51 
	~"WÜld.hh
"

59 cÚ¡ 
	gex™_num
 = 6;

61 
	shuÁ_cÚd™iÚs
 {

63 
Ch¬aù”
 *
	mhuÁ”
;

64 
Room
 *
	mäom_room
;

65 
Room
 *
	mto_room
;

66 
	m§me_¬—
;

67 
	mthru_doÜs
;

68 
	m¡•s
;

70 cÚ¡ 
A»a
 *
	m¬—
;

72 
huÁ_cÚd™iÚs
 
	tHUNT_CONDITIONS
;

75 
Room
 *
	$acûss_room
(
HUNT_CONDITIONS
 *
cÚd
, 
Ex™
 *
ex
)

77 
Room
 *
Ãw_room
;

79 ià((
ex
 =ğ
nuÎ±r
) ||

80 ((
Ãw_room
 = 
ex
->
to_room
è=ğ
nuÎ±r
) ||

81 (
cÚd
->
§me_¬—
 && 
Ãw_room
->
	`¬—
(è!ğ*cÚd->
¬—
) ||

82 (!
cÚd
->
thru_doÜs
 && 
ex
->
ex™_æags
.
	`has
(
EX_CLOSED
)) ||

83 (!
	`ÿn_£e_room
(
cÚd
->
huÁ”
, 
Ãw_room
)))

84  
nuÎ±r
;

86  
Ãw_room
;

87 
	}
}

91 
	$fšd_·th
(
HUNT_CONDITIONS
 *
cÚd
)

93 
Room
 *
this_ršg
;

94 
Room
 *
Ãxt_ršg
;

95 
jdœ
;

96 
Ex™
 *
³x™
;

97 
Room
 *
Ãw_room
;

98 
Room
 *
¡•
;

99 
huÁ_id
 = 1;

100 
huÁ_id
++;

101 
cÚd
->
¬—
 = &cÚd->
äom_room
->
	`¬—
();

102 
cÚd
->
äom_room
->
huÁ_id
 = hunt_id;

103 
cÚd
->
äom_room
->
huÁ_back
 = 
nuÎ±r
;

104 
cÚd
->
äom_room
->
huÁ_Ãxt
 = 
nuÎ±r
;

105 
this_ršg
 = 
cÚd
->
äom_room
;

106 
Ãxt_ršg
 = 
nuÎ±r
;

109 
this_ršg
 !ğ
nuÎ±r
) {

111 
jdœ
 = 0; jdœ < 
ex™_num
; jdir++) {

112 
³x™
 = 
this_ršg
->
ex™
[
jdœ
];

113 
Ãw_room
 = 
	`acûss_room
(
cÚd
, 
³x™
);

115 ià((
Ãw_room
 !ğ
nuÎ±r
è&& (Ãw_room->
huÁ_id
 != hunt_id)) {

116 
Ãw_room
->
huÁ_id
 = hunt_id;

117 
Ãw_room
->
huÁ_back
 = 
this_ršg
;

118 
Ãw_room
->
huÁ_Ãxt
 = 
Ãxt_ršg
;

119 
Ãxt_ršg
 = 
Ãw_room
;

121 ià(
Ãw_room
 =ğ
cÚd
->
to_room
)

122 
found™
;

126 ià(
this_ršg
->
huÁ_Ãxt
 !ğ
nuÎ±r
) {

128 
this_ršg
 =his_ršg->
huÁ_Ãxt
;

132 
this_ršg
 = 
Ãxt_ršg
;

133 
Ãxt_ršg
 = 
nuÎ±r
;

135 ià(--
cÚd
->
¡•s
 <= 0) {

146 
found™
:

147 
cÚd
->
¡•s
 = 1;

148 
¡•
 = 
cÚd
->
to_room
;

150 
¡•
->
huÁ_back
 !ğ
cÚd
->
äom_room
) {

151 
¡•
 = s‹p->
huÁ_back
;

153 ià(
¡•
 =ğ
nuÎ±r
) {

157 
cÚd
->
¡•s
 += 1;

159 ià(
cÚd
->
¡•s
 > 1000) {

164 ià(
¡•
->
huÁ_back
 !ğ
cÚd
->
äom_room
) {

169 
jdœ
 = 0; jdœ < 
ex™_num
; jdir++) {

170 
³x™
 = 
cÚd
->
äom_room
->
ex™
[
jdœ
];

171 
Ãw_room
 = 
	`acûss_room
(
cÚd
, 
³x™
);

173 ià(
Ãw_room
 =ğ
¡•
)

174  
jdœ
;

178 
	}
}

182 
	$do_huÁ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

184 
bufãr
[
MAX_INPUT_LENGTH
];

185 
Ch¬aù”
 *
viùim
;

186 
HUNT_CONDITIONS
 
cÚd
;

187 
dœeùiÚ
;

188 
boŞ
 
§me_¬—
;

189 
¡•s
;

191 ià(!
ch
->
	`is_Åc
(è&& !
	`g‘_skl_Ëv–
(ch, 
skl
::
ty³
::
huÁ
)) {

192 
	`¡c
("You‡»‚Ù‡bËØhuÁ.\n", 
ch
);

196 ià(
¬gum’t
.
	`em±y
()) {

197 
	`¡c
("Whom o¸wh©‡» youryšgØhuÁ?\n", 
ch
);

202 ià(
	`IS_IMMORTAL
(
ch
)) {

203 
§me_¬—
 = 
çl£
;

204 
¡•s
 = 500;

207 
§me_¬—
 = 
Œue
;

208 
¡•s
 = 100;

211 ià(
§me_¬—
)

212 
viùim
 = 
	`g‘_ch¬_¬—
(
ch
, 
¬gum’t
, 
VIS_CHAR
);

213 ià(!(
viùim
 = 
	`g‘_ch¬_¬—
(
ch
, 
¬gum’t
, 
VIS_CHAR
)))

214 
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬gum’t
, 
VIS_CHAR
);

216 ià(
viùim
 =ğ
nuÎ±r
) {

217 
	`¡c
("No-Ú¬ound byh©‚ame.\n", 
ch
);

221 ià(
ch
->
š_room
 =ğ
viùim
->in_room) {

222 
	`aù
("$N i h”e!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

226 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
huÁ
))

229 
	`aù
("$n kneels down‡nd checks forracks.",

230 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

231 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
huÁ
).
b—ts
);

233 
cÚd
.
huÁ”
 = 
ch
;

234 
cÚd
.
äom_room
 = 
ch
->
š_room
;

235 
cÚd
.
to_room
 = 
viùim
->
š_room
;

236 
cÚd
.
§me_¬—
 = same_area;

237 
cÚd
.
thru_doÜs
 = 
Œue
;

238 
cÚd
.
¡•s
 = steps;

240 
dœeùiÚ
 = 
	`fšd_·th
(&
cÚd
);

242 ià(
dœeùiÚ
 == -1) {

243 
	`aù
("You couldn't find‡…atho $N from here.",

244 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

247 ià(
dœeùiÚ
 == -2) {

248 
	`aù
("$N isoo far‡way or cannot be found.",

249 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

253 ià(
dœeùiÚ
 < 0 || direction > 5) {

254 
	`¡c
("Hmm... Som‘hšg s“m tØbwrÚg.\n", 
ch
);

255 
FÜm©
::
	`¥rštf
(
bufãr
, "Please„eportƒrror code %d from HUNT.\n",

256 -
dœeùiÚ
);

257 
	`¡c
(
bufãr
, 
ch
);

262 ià(
	`numb”_³rûÁ
(è> 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
huÁ
)) {

263 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
huÁ
, 
çl£
, 4);

266 
dœeùiÚ
 = 
	`numb”_doÜ
();

268 (
ch
->
š_room
->
ex™
[
dœeùiÚ
] =ğ
nuÎ±r
)

269 || (
ch
->
š_room
->
ex™
[
dœeùiÚ
]->
to_room
 =ğ
nuÎ±r
));

272 ià(
	`IS_IMMORTAL
(
ch
)) {

273 
FÜm©
::
	`¥rštf
(
bufãr
, "[%d s‹ps] ", 
cÚd
.
¡•s
);

274 
	`¡c
(
bufãr
, 
ch
);

277 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
huÁ
, 
Œue
, 4);

281 
	`aù
("$N i $ˆäom h”e.", 
ch
,

282 
Ex™
::
	`dœ_Çme
(
dœeùiÚ
), 
viùim
, 
TO_CHAR
);

284 
	}
}

287 
	$huÁ_viùim
(
Ch¬aù”
 *
ch
)

289 
dœ
;

290 
HUNT_CONDITIONS
 
cÚd
;

292 ià(
ch
 =ğ
nuÎ±r
 || ch->
huÁšg
 =ğnuÎ±¸|| !ch->
	`is_Åc
())

296 
boŞ
 
found
 = 
çl£
;

297 autØ
tmp
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

298 ià(
ch
->
huÁšg
 =ğ
tmp
) {

299 
found
 = 
Œue
;

304 ià(!
found
 || !
	`ÿn_£e_ch¬
(
ch
, ch->
huÁšg
)) {

305 
	`do_§y
(
ch
, "Damn! My…rey is gone!!");

306 
ch
->
huÁšg
 = 
nuÎ±r
;

310 ià(
ch
->
š_room
 =ğch->
huÁšg
->in_room) {

311 
	`aù
("$n glares‡t $N‡nd says, 'Ye shall DIE!'",

312 
ch
, 
nuÎ±r
, ch->
huÁšg
, 
TO_NOTVICT
);

313 
	`aù
("$n glares‡t you‡nd says, 'Ye shall DIE!'",

314 
ch
, 
nuÎ±r
, ch->
huÁšg
, 
TO_VICT
);

315 
	`aù
("You glare‡t $N‡nd say, 'Ye shall DIE!",

316 
ch
, 
nuÎ±r
, ch->
huÁšg
, 
TO_CHAR
);

317 
	`muÉi_h™
(
ch
, ch->
huÁšg
, 
skl
::
ty³
::
unknown
);

318 
ch
->
huÁšg
 = 
nuÎ±r
;

322 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
huÁ
).
b—ts
);

324 
cÚd
.
huÁ”
 = 
ch
;

325 
cÚd
.
äom_room
 = 
ch
->
š_room
;

326 
cÚd
.
to_room
 = 
ch
->
huÁšg
->
š_room
;

327 
cÚd
.
§me_¬—
 = 
Œue
;

328 
cÚd
.
thru_doÜs
 = 
Œue
;

330 
dœ
 = 
	`fšd_·th
(&
cÚd
);

332 ià(
dœ
 < 0 || dir > 5) {

333 
	`aù
("$À§y 'Damn! Lo¡ $M!'", 
ch
, 
nuÎ±r
, ch->
huÁšg
, 
TO_ROOM
);

334 
ch
->
huÁšg
 = 
nuÎ±r
;

341 ià(
	`numb”_³rûÁ
() > 75) {

343 
dœ
 = 
	`numb”_doÜ
();

345 (
ch
->
š_room
->
ex™
[
dœ
] =ğ
nuÎ±r
) ||

346 (
ch
->
š_room
->
ex™
[
dœ
]->
to_room
 =ğ
nuÎ±r
));

349 ià(
cÚd
.
thru_doÜs
 &&

350 
ch
->
š_room
->
ex™
[
dœ
]->
ex™_æags
.
	`has
(
EX_CLOSED
)) {

351 
	`do_İ’
(
ch
, 
Ex™
::
	`dœ_Çme
(
dœ
));

355 
	`move_ch¬
(
ch
, 
dœ
, 
çl£
);

357 
	}
}

	@src/ignore.cc

28 
	~<®gÜ™hm
>

29 
	~<™”©Ü
>

30 
	~<veùÜ
>

32 
	~"¬gum’t.hh
"

33 
	~"Ch¬aù”.hh
"

34 
	~"deş¬e.hh
"

35 
	~"DesütÜ.hh
"

36 
	~"fšd.hh
"

37 
	~"FÏgs.hh
"

38 
	~"PÏy”.hh
"

39 
	~"sql.hh
"

40 
	~"SŒšg.hh
"

42 
ignÜe_ofæše
(
Ch¬aù”
 *, cÚ¡ 
SŒšg
& );

44 
boŞ
 
	$is_ignÜšg
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

46 
Ch¬aù”
 *
rch
;

48 ià(
ch
 =ğ
nuÎ±r
 || 
viùim
 ==‚ullptr)

49  
çl£
;

51 ià(
	`IS_IMMORTAL
(
viùim
))

52  
çl£
;

54 ià(
ch
->
desc
 =ğ
nuÎ±r
)

55 
rch
 = 
ch
;

57 
rch
 = 
ch
->
desc
->
Üigš®
 ? ch->desc->original : ch;

59 ià(
rch
->
	`is_Åc
())

60  
çl£
;

62 ià(
¡d
::
	`fšd
(
rch
->
pcd©a
->
ignÜe
.
	`cbegš
(),„ch->pcd©a->ignÜe.
	`ûnd
(), 
viùim
->
Çme
) !=„ch->pcdata->ignore.cend())

63  
Œue
;

65  
çl£
;

66 
	}
}

69 
	$do_ignÜe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

71 
Ch¬aù”
 *
viùim
, *
rch
;

73 
SŒšg
 
¬g
;

74 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

76 ià(
ch
->
desc
 =ğ
nuÎ±r
)

77 
rch
 = 
ch
;

79 
rch
 = 
ch
->
desc
->
Üigš®
 ? ch->desc->original : ch;

81 ià(
rch
->
	`is_Åc
())

84 ià(
	`IS_IMMORTAL
(
rch
)) {

85 
	`¡c
("You havtØli¡’Øth¶ay”s, gÛ w™hhjob ;)\n", 
ch
);

89 ià(
¬g
.
	`em±y
()) {

90 ià(
rch
->
pcd©a
->
ignÜe
.
	`em±y
()) {

91 
	`¡c
("You‡» ignÜšg‚obody.\n", 
ch
);

95 
	`¡c
("PeİË you‡» ignÜšg:\n", 
ch
);

97 auto& 
viù
: 
rch
->
pcd©a
->
ignÜe
)

98 
	`±c
(
ch
, " %s\n", 
viù
);

103 
viùim
 = 
	`g‘_¶ay”_wÜld
(
rch
, 
¬gum’t
, 
VIS_PLR
);

105 ià(
viùim
 =ğ
nuÎ±r
) {

106 
	`ignÜe_ofæše
(
ch
, 
¬gum’t
);

110 ià(
viùim
->
	`is_Åc
()) {

111 
	`¡c
("IgnÜ¨mob? I dÚ'ˆthšk so.\n", 
ch
);

115 ià(
ch
 =ğ
viùim
) {

116 
	`¡c
("I dÚ'ˆthšk you„—Îy wªˆtØignÜyour£lf.\n", 
ch
);

120 ià(!
¬gum’t
.
	`has_exaù_wÜds
(
viùim
->
Çme
)) {

121 
	`¡c
("You mu¡ s³Î ouˆtheœƒÁœÇme.\n", 
ch
);

125 ià(
	`IS_IMMORTAL
(
viùim
)) {

126 
	`¡c
("You'»‚Ù gošgØignÜu th©ƒasy!\n", 
ch
);

130 autØ
£¬ch
 = 
¡d
::
	`fšd
(
rch
->
pcd©a
->
ignÜe
.
	`begš
(),„ch->pcd©a->ignÜe.
	`’d
(), 
viùim
->
Çme
);

132 ià(
£¬ch
 =ğ
rch
->
pcd©a
->
ignÜe
.
	`’d
()) {

134 
	`±c
(
ch
, "You‚ow ignÜ%s.\n", 
viùim
->
Çme
);

135 
	`±c
(
viùim
, "% ignÜe you.\n", 
ch
->
Çme
);

136 
rch
->
pcd©a
->
ignÜe
.
	`push_back
(
viùim
->
Çme
);

140 
	`±c
(
ch
, "You stİ ignÜšg %s.\n", 
viùim
->
Çme
);

141 
	`±c
(
viùim
, "% ¡İ ignÜšg you.\n", 
ch
->
Çme
);

142 
rch
->
pcd©a
->
ignÜe
.
	`”a£
(
£¬ch
);

144 
	}
}

146 
	$ignÜe_ofæše
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬g
)

148 
Çme
[
MIL
];

150 ià(
	`db_qu”yf
("ignÜe_ofæše", "SELECT‚ame, cgrou°FROM…c_šdex WHERE‚amLIKE '%s'", 
	`db_esc
(
¬g
)è!ğ
SQL_OK
) {

151 ià(
	`db_Ãxt_row
(è!ğ
SQL_OK
) {

152 ià(
	`db_g‘_cŞumn_æags
(1).
	`has
(
GROUP_GEN
)) {

153 
	`¡c
("You'»‚Ù gošgØignÜu th©ƒasy!\n", 
ch
);

157 
	`¡rıy
(
Çme
, 
	`db_g‘_cŞumn_¡r
(0));

160 
	`¡c
("Th”i nØÚbyh©‚amtØignÜe.\n", 
ch
);

165 
	`¡c
("SÜry, wcouldn'ˆ»Œ›vth©…Ïy”' d©a.\nPËa£„•Üˆthi w™hh'bug' commªd.\n", 
ch
);

169 autØ
£¬ch
 = 
¡d
::
	`fšd
(
ch
->
pcd©a
->
ignÜe
.
	`begš
(), ch->pcd©a->ignÜe.
	`’d
(), 
Çme
);

171 ià(
£¬ch
 =ğ
ch
->
pcd©a
->
ignÜe
.
	`’d
()) {

173 
	`±c
(
ch
, "You‚ow ignÜ%s.\n", 
Çme
);

174 
ch
->
pcd©a
->
ignÜe
.
	`push_back
(
Çme
);

178 
	`±c
(
ch
, "You stİ ignÜšg %s.\n", 
Çme
);

179 
ch
->
pcd©a
->
ignÜe
.
	`”a£
(
£¬ch
);

181 
	}
}

	@src/include/Actable.hh

1 #´agm¨
Úû


3 
	~<¡ršg
>

5 şas 
	cAùabË
 {

6 
vœtu®
 cÚ¡ 
	m¡d
::
¡ršg
 
	$id’tif›r
() const = 0;

	@src/include/Area.hh

1 #´agm¨
Úû


3 
	~<veùÜ
>

4 
	~<m­
>

5 
	~"SŒšg.hh
"

6 
	~"Vnum.hh
"

7 
	~"LoÿtiÚ.hh
"

13 
	#RANGE_OK
 0

	)

14 
	#RANGE_ALL
 1

	)

15 
	#RANGE_CLAN
 2

	)

16 
	#RANGE_IMM
 3

	)

18 şas 
	cA»a


20 
	mpublic
:

21 
A»a
(
WÜld
& 
w
, cÚ¡ 
SŒšg
& 
fe_Çme
);

22 
	mvœtu®
 ~
A»a
();

24 
lßd
();

25 
ü—‹_rooms
();

27 
ObjeùPrÙÙy³
 *
g‘_obj_´ÙÙy³
(cÚ¡ 
Vnum
&);

28 
MobePrÙÙy³
 *
g‘_mob_´ÙÙy³
(cÚ¡ 
Vnum
&);

29 
RoomPrÙÙy³
 *
g‘_room_´ÙÙy³
(cÚ¡ 
Vnum
&);

31 
Room
 *
	$g‘_room
(cÚ¡ 
RoomID
& 
id
) {

32 autØ
’Œy
 = 
rooms
.
	`fšd
(
id
);

33  
’Œy
 =ğ
rooms
.
	`’d
(è? 
nuÎ±r
 :ƒÁry->
£cÚd
;

36 
	`upd©e
();

37 
	`»£t
();

39 
	$num_¶ay”s
(ècÚ¡ {  
_num_¶ay”s
; 
	}
}

40 
	$num_imms
(ècÚ¡ {  
_num_imms
; 
	}
}

43 
	gWÜld
& 
	gwÜld
;

45 
SŒšg
 
	gfe_Çme
;

46 
SŒšg
 
	gÇme
;

47 
SŒšg
 
	güed™s
;

48 
Vnum
 
	gmš_vnum
 = 0;

49 
Vnum
 
	gmax_vnum
 = 0;

51 
	g¡d
::
veùÜ
<
Re£t
 *> 
»£ts
;

52 
	g¡d
::
m­
<
Vnum
, 
	gRoomPrÙÙy³
 *> 
	groom_´ÙÙy³s
;

53 
	g¡d
::
m­
<
Vnum
, 
	gMobePrÙÙy³
 *> 
	gmob_´ÙÙy³s
;

54 
	g¡d
::
m­
<
Vnum
, 
	gObjeùPrÙÙy³
 *> 
	gobj_´ÙÙy³s
;

56 
	g¡d
::
m­
<
RoomID
, 
	gRoom
 *> 
	grooms
;

60 
SŒšg
 
	gauthÜ
;

61 
SŒšg
 
	gt™Ë
;

62 
SŒšg
 
	gkeywÜds
;

63 
	gv”siÚ
 = 1;

64 
	g¬—_ty³
 = 0;

65 
	glow_¿nge
 = 0;

66 
	ghigh_¿nge
 = 0;

69 
	gage
 = 0;

71 
	gwÜldm­
::
RegiÚ
 *
»giÚ
 = 
nuÎ±r
;

73 
add_ch¬
(
Ch¬aù”
 *
ch
);

74 
»move_ch¬
(
Ch¬aù”
 *
ch
);

76 
ä›nd
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
A»a
&, cÚ¡ 
	gA»a
&);

77 
ä›nd
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
A»a
&, cÚ¡ 
	gA»a
&);

79 
	g´iv©e
:

80 
A»a
();

81 
A»a
(const Area&);

82 
	gA»a
& 
	gİ”©Ü
=(cÚ¡ 
A»a
&);

84 
lßd_h—d”
(
FILE
 *
å
);

85 
lßd_rooms
(
FILE
 *
å
);

86 
lßd_mobes
(
FILE
 *
å
);

87 
lßd_objeùs
(
FILE
 *
å
);

88 
lßd_»£ts
(
FILE
 *
å
);

89 
lßd_shİs
(
FILE
 *
å
);

90 
lßd_¥ecŸls
(
FILE
 *
å
);

91 
lßd_»giÚ
(
FILE
 *
å
);

92 
sÿn_üed™s
();

95 
Room
 *
g‘_¿ndom_»£t_room
(cÚ¡ 
MobePrÙÙy³
 *);

100 
	g_num_¶ay”s
 = 0;

101 
	g_num_imms
 = 0;

102 
FILE
 *
	gåA»a
;

106 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
A»a
& 
lhs
, cÚ¡ 
	gA»a
& 
	grhs
) {

109  
	glhs
.
	gmš_vnum
 =ğ
rhs
.
mš_vnum
 && 
lhs
.
max_vnum
 ==„hs.max_vnum;

112 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
A»a
& 
lhs
, cÚ¡ 
	gA»a
& 
	grhs
) {

113  !(
	glhs
 =ğ
rhs
);

	@src/include/Auction.hh

1 #´agm¨
Úû


3 
şass
 
	gObjeù
;

4 
şass
 
	gCh¬aù”
;

6 şas 
	cAuùiÚ


8 
	mpublic
:

9 
	$AuùiÚ
() {}

10 
vœtu®
 ~
	$AuùiÚ
(è{
	}
}

12 
Objeù
 * 
™em
 = 
nuÎ±r
;

13 
Ch¬aù”
 * 
	g£Î”
 = 
nuÎ±r
;

14 
Ch¬aù”
 * 
	gbuy”
 = 
nuÎ±r
;

15 
	gb‘
 = 0;

16 
	ggošg
 = 0;

17 
	gpul£
 = 0;

18 
	gmš
 = 0;

20 
š™
();

21 
upd©e
();

22 
boŞ
 
	$is_·¹icªt
(
Objeù
 *
obj
) const;

23 
boŞ
 
	$is_·¹icªt
(
Ch¬aù”
 *
ch
) const;

25 
´iv©e
:

26 
	`AuùiÚ
(cÚ¡ 
AuùiÚ
&);

27 
AuùiÚ
& 
İ”©Ü
=(const Auction&);

28 
	}
};

31 
AuùiÚ
 
auùiÚ
;

	@src/include/Battle.hh

1 #´agm¨
Úû


3 şas 
	cB©e


5 
	mpublic
:

6 
	$B©e
() {}

7 
vœtu®
 ~
	$B©e
(è{
	}
}

9 
low
 = 0;

10 
	ghigh
 = 0;

11 
	gãe
 = 0;

12 
boŞ
 
	gissued
 = 
çl£
;

13 
boŞ
 
	g¡¬t
 = 
çl£
;

15 
	g´iv©e
:

16 
B©e
(const Battle&);

17 
	gB©e
& 
	gİ”©Ü
=(cÚ¡ 
B©e
&);

20 
B©e
 
b©e
;

	@src/include/Character.hh

1 #´agm¨
Úû


3 
	~"PoŞed.hh
"

4 
	~"FÏgs.hh
"

5 
	~"AùabË.hh
"

6 
	~"SŒšg.hh
"

7 
	~"FÜm©.hh
"

8 
	~"G¬bage.hh
"

9 
	~"Gud.hh
"

10 
	~"PÏy”.hh
"

12 
Çme¥aû
 
	gafãù
 { 
şass
 
	gAfãù
; }

18 
	#MAX_ATTR
 48

19 
	#MAX_ATTR_FLAG
 5

20 
	#MAX_ATTR_VALUE
 30000

21 

	)

22 
şass
 
	gCh¬aù”
 :

23 
public
 
PoŞed
<
Ch¬aù”
>,

24 
public
 
	gAùabË
,

25 
public
 
	gG¬bage


27 
	gpublic
:

28 
Ch¬aù”
();

29 
	gvœtu®
 ~
Ch¬aù”
();

31 
upd©e
();

33 
boŞ
 
has_cgroup
(cÚ¡ 
FÏgs
& 
cg
) const;

34 
add_cgroup
(cÚ¡ 
FÏgs
& 
cg
);

35 
»move_cgroup
(cÚ¡ 
FÏgs
& 
cg
);

37 
boŞ
 
is_Åc
(ècÚ¡ {  
	gpcd©a
 =ğ
nuÎ±r
; }

39 
Ch¬aù”
 * 
	gÃxt_š_room
 = 
nuÎ±r
;

40 
Ch¬aù”
 * 
	gma¡”
 = 
nuÎ±r
;

41 
Ch¬aù”
 * 
	gËad”
 = 
nuÎ±r
;

42 
Ch¬aù”
 * 
	gfightšg
 = 
nuÎ±r
;

43 cÚ¡ 
Re£t
 * 
	g»£t
 = 
nuÎ±r
;

44 
Ch¬aù”
 * 
	g³t
 = 
nuÎ±r
;

45 
SPEC_FUN
 * 
	g¥ec_fun
 = 
nuÎ±r
;

46 
MobePrÙÙy³
 * 
	gpIndexD©a
 = 
nuÎ±r
;

47 
DesütÜ
 * 
	gdesc
 = 
nuÎ±r
;

48 
	gafãù
::
Afãù
 * 
afãùed
 = 
nuÎ±r
;

49 
NÙe
 * 
	g²Ùe
 = 
nuÎ±r
;

50 
Objeù
 * 
	gÿ¼yšg
 = 
nuÎ±r
;

51 
Objeù
 * 
	gÚ
 = 
nuÎ±r
;

52 
Room
 * 
	gš_room
 = 
nuÎ±r
;

53 
Room
 * 
	gwas_š_room
 = 
nuÎ±r
;

54 
CÏn
 * 
	gşª
 = 
nuÎ±r
;

55 
CÏn
 * 
	gšv™”s
 = 
nuÎ±r
;

56 
PÏy”
 * 
	gpcd©a
 = 
nuÎ±r
;

57 
SŒšg
 
	gÇme
;

58 
SŒšg
 
	gshÜt_desü
;

59 
SŒšg
 
	glÚg_desü
;

60 
SŒšg
 
	gdesütiÚ
;

61 
SŒšg
 
	g´om±
;

62 
SŒšg
 
	g´efix
;

63 
SŒšg
 
	g»¶y
;

64 
FÏgs
 
	ggroup_æags
;

65 
boŞ
 
	g»¶ylock
 = 
çl£
;

66 
boŞ
 
	gšv™©iÚ_acû±ed
 = 
çl£
;

68 
	gskl_çs
 = 0;

74 
	g©Œ_ba£
[
MAX_ATTR
] = {0};

75 * 
	g­¶y_ÿche
 = 
nuÎ±r
;

76 * 
	gafãù_ÿche
 = 
nuÎ±r
;

77 * 
	gdeãn£_mod
 = 
nuÎ±r
;

84 
	gh™
 = 0;

85 
	gmªa
 = 0;

86 
	g¡am
 = 0;

88 
Gud
 
	ggud
 = Gud::
nÚe
;

89 
	g¿û
 = 0;

90 
	gËv–
 = 0;

91 
	glšes
 = 0;

92 
time_t
 
	glogÚ
 = 0;

93 
time_t
 
	gÏ¡_bªk
 = 0;

94 
	gtim”
 = 0;

95 
	gwa™
 = 0;

96 
	gdaze
 = 0;

97 
	gfighul£
 = 0;

98 
	ggŞd
 = 0;

99 
	gsv”
 = 0;

100 
	ggŞd_š_bªk
 = 0;

101 
	gsv”_š_bªk
 = 0;

102 
	gexp
 = 0;

103 
FÏgs
 
	gaù_æags
;

104 
FÏgs
 
	gcomm_æags
;

105 
FÏgs
 
	g»voke_æags
;

106 
FÏgs
 
	gwizÃt_æags
;

107 
FÏgs
 
	gûnsÜ_æags
;

108 
	gšvis_Ëv–
 = 0;

109 
	glurk_Ëv–
 = 0;

110 
	gpos™iÚ
 = 0;

111 
	g´aùiû
 = 0;

112 
	gŒaš
 = 0;

113 
	g®ignm’t
 = 0;

114 
	g¬mÜ_ba£
[4] = {0};

115 
	gwimpy
 = 0;

117 
FÏgs
 
	gfÜm_æags
;

118 
FÏgs
 
	g·¹s_æags
;

119 
	gsize
 = 0;

120 
SŒšg
 
	gm©”Ÿl
;

122 
FÏgs
 
	goff_æags
;

123 
	gdamage
[3] = {0};

124 
	gdam_ty³
 = 0;

125 
	g¡¬t_pos
 = 0;

126 
	gdeçuÉ_pos
 = 0;

127 
Ch¬aù”
 * 
	ghuÁšg
 = 
nuÎ±r
;

128 
	gÃùim”
 = 0;

129 
	g£cu»_Ëv–
 = 0;

130 
MobProgAùLi¡
 * 
	gm·ù
 = 
nuÎ±r
;

131 
	gm·ùnum
 = 0;

132 
Ta
 * 
	g
 = 
nuÎ±r
;

133 
Ed™
 * 
	ged™
 = 
nuÎ±r
;

135 
vœtu®
 cÚ¡ 
	g¡d
::
¡ršg
 
id’tif›r
(ècÚ¡ {  
this
->
Çme
; }

137 
	g´iv©e
:

138 
Ch¬aù”
(const Character&);

139 
	gCh¬aù”
& 
	gİ”©Ü
=(cÚ¡ 
Ch¬aù”
&);

145 
	#ATTR_BASE
(
ch
, 
wh”e
è((ch)->
©Œ_ba£
[where])

146 
	#GET_ATTR_MOD
(
ch
, 
wh”e
è((ch)->
­¶y_ÿche
 ? (ch)->apply_cache[where] : 0)

147 
	#GET_ATTR
(
ch
, 
wh”e
è(
	`ATTR_BASE
(ch, wh”eè+ 
	`GET_ATTR_MOD
(ch, where))

148 

	)

149 
	#GET_ATTR_STR
(
ch
è(
	`URANGE
(3, 
	`GET_ATTR
(ch, 
APPLY_STR
), 
	`g‘_max_¡©
(ch, 
STAT_STR
)))

	)

150 
	#GET_ATTR_INT
(
ch
è(
	`URANGE
(3, 
	`GET_ATTR
(ch, 
APPLY_INT
), 
	`g‘_max_¡©
(ch, 
STAT_INT
)))

	)

151 
	#GET_ATTR_WIS
(
ch
è(
	`URANGE
(3, 
	`GET_ATTR
(ch, 
APPLY_WIS
), 
	`g‘_max_¡©
(ch, 
STAT_WIS
)))

	)

152 
	#GET_ATTR_DEX
(
ch
è(
	`URANGE
(3, 
	`GET_ATTR
(ch, 
APPLY_DEX
), 
	`g‘_max_¡©
(ch, 
STAT_DEX
)))

	)

153 
	#GET_ATTR_CON
(
ch
è(
	`URANGE
(3, 
	`GET_ATTR
(ch, 
APPLY_CON
), 
	`g‘_max_¡©
(ch, 
STAT_CON
)))

	)

154 
	#GET_ATTR_CHR
(
ch
è(
	`URANGE
(3, 
	`GET_ATTR
(ch, 
APPLY_CHR
), 
	`g‘_max_¡©
(ch, 
STAT_CHR
)))

	)

155 
	#GET_ATTR_SEX
(
ch
è(
	`GET_ATTR
((ch), 
APPLY_SEX
) % 3)

156 
	#GET_ATTR_AGE
(
ch
è(
	`g‘_age
(ch))

	)

163 
	#GET_ATTR_HITROLL
(
ch
) \

164 (
	`GET_ATTR
((
ch
), 
APPLY_HITROLL
è+ 
¡r_­p
[
	`GET_ATTR_STR
((ch))].
toh™
)

	)

165 
	#GET_ATTR_DAMROLL
(
ch
) \

166 (
	`GET_ATTR
((
ch
), 
APPLY_DAMROLL
è+ 
¡r_­p
[
	`GET_ATTR_STR
((ch))].
todam
)

	)

167 
	#GET_ATTR_SAVES
(
ch
è(
	`GET_ATTR
((ch), 
APPLY_SAVES
))

	)

171 
	#GET_DEFENSE_MOD
(
ch
, 
dam_ty³
è(dam_ty³ =ğ
DAM_NONE
 ? 0 : \

172 (
ch
)->
deãn£_mod
 ? (ch)->deãn£_mod[
dam_ty³
] : 0)

	)

177 
	#IS_HERO
(
ch
è(!(ch)->
	`is_Åc
(è&& ch->
Ëv–
 >ğ
LEVEL_HERO
)

	)

178 
	#IS_REMORT
(
ch
è(!(ch)->
	`is_Åc
(è&& ch->
pcd©a
->
»mÜt_couÁ
 > 0)

	)

179 
	#IS_HEROIC
(
ch
è(
	`IS_HERO
(chè|| 
	`IS_REMORT
(ch))

	)

180 
	#IS_IMM_GROUP
(
æags
è(
	`FÏgs
(
GROUP_GEN
|
GROUP_QUEST
|
GROUP_BUILD
|
GROUP_CODE
|
GROUP_SECURE
).
	`has_ªy_of
(æags))

	)

181 
	#RANK
(
æags
è(
	`IS_IMM_GROUP
(flags) ? \

182 (
æags
.
	`has
(
GROUP_LEADER
è? 
RANK_IMP
 : \

183 (
æags
.
	`has
(
GROUP_DEPUTY
è? 
RANK_HEAD
 : 
RANK_IMM
)) : \

184 (
æags
.
	`has
(
GROUP_PLAYER
è? 
RANK_MORTAL
 : 
RANK_MOBILE
))

	)

185 
	#GET_RANK
(
ch
è((ch)->
	`is_Åc
(è? 
RANK_MOBILE
 : 
	`RANK
(ch->
pcd©a
->
cgroup_æags
))

	)

186 
	#IS_IMMORTAL
(
ch
è(
	`GET_RANK
(chè>ğ
RANK_IMM
)

	)

187 
	#IS_IMP
(
ch
è(
	`GET_RANK
(chè=ğ
RANK_IMP
)

	)

188 
	#IS_HEAD
(
ch
è(
	`GET_RANK
(chè>ğ
RANK_HEAD
)

	)

189 
	#OUTRANKS
(
ch
, 
viùim
è(
	`GET_RANK
(chè> GET_RANK(viùim))

	)

192 
	#IS_GOOD
(
ch
è(ch->
®ignm’t
 >ğ350)

	)

193 
	#IS_EVIL
(
ch
è(ch->
®ignm’t
 <ğ-350)

	)

194 
	#IS_NEUTRAL
(
ch
è(!
	`IS_GOOD
(chè&& !
	`IS_EVIL
(ch))

	)

196 
	#IS_AWAKE
(
ch
è(ch->
pos™iÚ
 > 
POS_SLEEPING
)

	)

197 
	#IS_OUTSIDE
(
ch
è(!(ch)->
š_room
->
	`æags
().
	`has
(
ROOM_INDOORS
))

	)

199 
	#WAIT_STATE
(
ch
, 
Åul£
è(!
	`IS_IMMORTAL
(ch) ? \

200 (
ch
->
wa™
 = 
¡d
::
	`max
(ch->wa™, 
Åul£
)è: (ch->wa™ = 0))

	)

201 
	#DAZE_STATE
(
ch
, 
Åul£
è(!
	`IS_IMMORTAL
(ch) ? \

202 (
ch
->
daze
 = 
¡d
::
	`max
(ch->daze, 
Åul£
)è: (ch->dazğ0))

	)

203 
	#gŞd_weight
(
amouÁ
è(×mouÁè* 2 / 5)

	)

204 
	#sv”_weight
(
amouÁ
è(×mouÁ)/ 10)

	)

205 
	#IS_QUESTOR
(
ch
è(!(ch)->
	`is_Åc
(è&& (ch)->
pcd©a
->
¶r_æags
.
	`has
(
PLR_QUESTOR
))

	)

206 
	#IS_SQUESTOR
(
ch
è(!(ch)->
	`is_Åc
(è&& (ch)->
pcd©a
->
¶r_æags
.
	`has
(
PLR_SQUESTOR
))

	)

207 
	#IS_KILLER
(
ch
è((ch)->
aù_æags
.
	`has
(
PLR_KILLER
))

	)

208 
	#IS_THIEF
(
ch
è((ch)->
aù_æags
.
	`has
(
PLR_THIEF
))

	)

209 
	#CAN_FLY
(
ch
è(
afãù
::
	`exi¡s_Ú_ch¬
((ch),‡fãù::
ty³
::
æy
))

	)

210 
	#IS_FLYING
(
ch
è((ch)->
pos™iÚ
 >ğ
POS_FLYING
)

	)

215 
	#PERS
(
ch
, 
look”
, 
vis
èĞ(vi =ğ
VIS_ALL
 \

216 || (
vis
 =ğ
VIS_CHAR
 && 
	`ÿn_£e_ch¬
(
look”
, 
ch
)) \

217 || (
vis
 =ğ
VIS_PLR
 && 
	`ÿn_£e_who
(
look”
, 
ch
))) ? \

218 (
ch
)->
	`is_Åc
(è? ch->
shÜt_desü
 : ch->
Çme
 : "someÚe")

	)

221 
obj_to_ch¬
 
¬gs
(Ğ
Objeù
 *
obj
, 
Ch¬aù”
 *
ch
 ) );

222 
obj_äom_ch¬
 
¬gs
(Ğ
Objeù
 *
obj
 ) );

223 
obj_to_lock”
 
¬gs
(Ğ
Objeù
 *
obj
, 
Ch¬aù”
 *
ch
 ) );

224 
obj_to_¡rÚgbox
 
¬gs
(Ğ
Objeù
 *
obj
, 
Ch¬aù”
 *
ch
 ) );

225 
obj_äom_lock”
 
¬gs
(Ğ
Objeù
 *
obj
 ) );

226 
obj_äom_¡rÚgbox
 
¬gs
(Ğ
Objeù
 *
obj
) );

227 
boŞ
 
ÿn_drİ_obj
 
¬gs
(Ğ
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
 ) );

228 
boŞ
 
deduù_co¡
 
¬gs
Ğ(
Ch¬aù”
 *
ch
, 
co¡
) );

230 
¡c
 
¬gs
ĞĞcÚ¡ 
SŒšg
& 
txt
, 
Ch¬aù”
 *
ch
 ) );

231 
·ge_to_ch¬
 
¬gs
ĞĞcÚ¡ 
SŒšg
& 
txt
, 
Ch¬aù”
 *
ch
 ) );

233 
GET_MAX_HIT
 
¬gs
 ( (
Ch¬aù”
 *
ch
 ) );

234 
GET_MAX_MANA
 
¬gs
 ( (
Ch¬aù”
 *
ch
 ) );

235 
GET_MAX_STAM
 
¬gs
 ( (
Ch¬aù”
 *
ch
 ) );

236 
GET_ATTR_AC
 
¬gs
 ( (
Ch¬aù”
 *
ch
 ) );

237 
GET_AC
 
¬gs
 ( (
Ch¬aù”
 *
ch
, 
ty³
) );

240 
	g‹m¶©e
<
	gşass
... 
	gP¬ams
>

241 
	$±c
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
fmt
, 
P¬ams
&&... 
·¿ms
)

243 
	`¡c
(
FÜm©
::
	`fÜm©
(
fmt
, 
·¿ms
...), 
ch
);

244 
	}
}

	@src/include/Clan.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

4 
	~"Vnum.hh
"

5 
	~"LoÿtiÚ.hh
"

7 şas 
	cCÏn


9 
	mpublic
:

10 
	$CÏn
() {}

11 
vœtu®
 ~
	$CÏn
(è{
	}
}

13 
LoÿtiÚ
 
»ÿÎ
{
Vnum
(3001)};

14 
SŒšg
 
	gÇme
;

15 
SŒšg
 
	gwho_Çme
;

16 
Vnum
 
	g¬—_mšvnum
 = 0;

17 
Vnum
 
	g¬—_maxvnum
 = 0;

18 
boŞ
 
	gšd•’d’t
 = 
çl£
;

19 
	gşªqp
 = 0;

20 
	ggŞd_b®ªû
 = 0;

21 
SŒšg
 
	gşªÇme
;

22 
SŒšg
 
	gü—tÜ
;

23 
	gscÜe
 = 0;

24 
	gw¬ımod
 = 0;

26 
CÏn
 * 
	g´evious
 = 
nuÎ±r
;

27 
CÏn
 * 
	gÃxt
 = 
nuÎ±r
;

29 
	g´iv©e
:

30 
CÏn
(const Clan&);

31 
	gCÏn
& 
	gİ”©Ü
=(cÚ¡ 
CÏn
&);

35 
CÏn
 *
şª_bË_h—d
;

36 
CÏn
 *
şª_bË_
;

39 
couÁ_şª_memb”s
 
¬gs
((
CÏn
 *
şª
, 
b™
));

40 
lßd_şª_bË
();

41 
§ve_şª_bË
();

42 
couÁ_şªs
();

43 
ÿlc_ı
(
CÏn
 *
şª
, 
boŞ
 
curve
);

	@src/include/DepartedPlayer.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

5 şas 
	cD•¬‹dPÏy”


7 
	mpublic
:

8 
	$D•¬‹dPÏy”
() {}

9 
vœtu®
 ~
	$D•¬‹dPÏy”
(è{
	}
}

11 
SŒšg
 
Çme
;

12 
D•¬‹dPÏy”
 *
	gÃxt
 = 
nuÎ±r
;

13 
D•¬‹dPÏy”
 *
	g´evious
 = 
nuÎ±r
;

15 
	g´iv©e
:

16 
D•¬‹dPÏy”
(const DepartedPlayer&);

17 
	gD•¬‹dPÏy”
& 
	gİ”©Ü
=(cÚ¡ 
D•¬‹dPÏy”
&);

	@src/include/Descriptor.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

4 
	~"memÜy.hh
"

5 
	~"PoŞed.hh
"

7 
şass
 
	gCh¬aù”
;

8 
Çme¥aû
 
	gcÚn
 { 
	gS‹
; }

13 
şass
 
	gDesütÜ
 :

14 
public
 
PoŞed
<
DesütÜ
>

16 
public
:

17 
DesütÜ
();

18 
	gvœtu®
 ~
DesütÜ
() {}

20 
boŞ
 
is_¶ayšg
() const;

22 
DesütÜ
 * 
	gÃxt
 = 
nuÎ±r
;

23 
DesütÜ
 * 
	g¢oİ_by
 = 
nuÎ±r
;

24 
Ch¬aù”
 * 
	gch¬aù”
 = 
nuÎ±r
;

25 
Ch¬aù”
 * 
	gÜigš®
 = 
nuÎ±r
;

26 
	gho¡addr
 = 0;

27 
SŒšg
 
	gho¡
;

28 
	gdesütÜ
 = 0;

29 
boŞ
 
	gfcommªd
 = 
çl£
;

30 
	gšbuf
 [4 * 
MAX_INPUT_LENGTH
] = {0};

31 
	gšcomm
 [
MAX_INPUT_LENGTH
] = {0};

32 
	gšÏ¡
 [
MAX_INPUT_LENGTH
] = {0};

33 
	g»³©
 = 0;

34 
SŒšg
 
	goutbuf
;

35 
	gpÜt
 = 0;

36 
	g
 = 0;

37 
SŒšg
 
	gshow¡r_h—d
;

38 
	gtim”
 = 0;

39 
	gcÚn
::
S‹
 *
¡©e
;

41 
	g´iv©e
:

42 
DesütÜ
(const Descriptor&);

43 
	gDesütÜ
& 
	gİ”©Ü
=(cÚ¡ 
DesütÜ
&);

46 
DesütÜ
 *
desütÜ_li¡
;

	@src/include/Disabled.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

5 
	gcmd_ty³
;

7 şas 
	cDi§bËd


9 
	mpublic
:

10 
	$Di§bËd
() {}

11 
vœtu®
 ~
	$Di§bËd
(è{
	}
}

13 
Di§bËd
 *
Ãxt
 = 
nuÎ±r
;

14 
cmd_ty³
 cÚ¡ *
	gcommªd
 = 
nuÎ±r
;

15 
SŒšg
 
	gdi§bËd_by
;

16 
SŒšg
 
	g»asÚ
;

18 
	g´iv©e
:

19 
Di§bËd
(const Disabled&);

20 
	gDi§bËd
& 
	gİ”©Ü
=(cÚ¡ 
Di§bËd
&);

23 
lßd_di§bËd
();

24 
boŞ
 
check_di§bËd
(cÚ¡ 
cmd_ty³
 *
commªd
);

	@src/include/Duel.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

4 
	~"Vnum.hh
"

6 
şass
 
	gCh¬aù”
;

7 
şass
 
	gRoom
;

9 şas 
	cDu–


11 
	mpublic
:

12 şas 
	cA»Ç


14 
public
:

15 
A»Ç
() {}

16 
vœtu®
 ~
A»Ç
() {}

18 
SŒšg
 
keywÜd
;

19 
SŒšg
 
	mÇme
;

20 
SŒšg
 
	mdesc
;

22 
Vnum
 
	mmšvnum
 = 0;

23 
Vnum
 
	mmaxvnum
 = 0;

24 
Room
 *
	mch®´•
 = 
nuÎ±r
;

25 
Room
 *
	mdeå»p
 = 
nuÎ±r
;

26 
Room
 *
	mv›wroom
 = 
nuÎ±r
;

28 
	mDu–
::
A»Ç
 * 
´evious
 = 
nuÎ±r
;

29 
	mDu–
::
A»Ç
 * 
Ãxt
 = 
nuÎ±r
;

30 
	m´iv©e
:

31 
A»Ç
(const Arena&);

32 
	mA»Ç
& 
	mİ”©Ü
=(cÚ¡ 
A»Ç
&);

35 
	$Du–
(è{
	}
}

36 
	gvœtu®
 ~
	$Du–
(è{
	}
}

38 
Ch¬aù”
 * 
	gch®Ëng”
 = 
nuÎ±r
;

39 
Ch¬aù”
 * 
	gdeãnd”
 = 
nuÎ±r
;

40 
	gDu–
::
A»Ç
 * 
¬’a
 = 
nuÎ±r
;

41 
	gacû±_tim”
 = 0;

42 
	g´•_tim”
 = 0;

44 
Du–
 *
	g´evious
 = 
nuÎ±r
;

45 
Du–
 *
	gÃxt
 = 
nuÎ±r
;

47 
	g´iv©e
:

48 
Du–
(const Duel&);

49 
	gDu–
& 
	gİ”©Ü
=(cÚ¡ 
Du–
&);

52 
Du–
::
A»Ç
 *
¬’a_bË_h—d
;

53 
Du–
::
A»Ç
 *
¬’a_bË_
;

54 
Du–
 *
du–_bË_h—d
;

55 
Du–
 *
du–_bË_
;

	@src/include/EQSocket.hh

1 #´agm¨
Úû


3 şas 
	cEQSock‘


5 
	mpublic
:

6 
	$EQSock‘
() {}

7 
vœtu®
 ~
	$EQSock‘
(è{
	}
}

9 
qu®™y
 = 0;

10 
	gty³
 = 0;

12 
	g´iv©e
:

13 
EQSock‘
(const EQSocket&);

14 
	gEQSock‘
& 
	gİ”©Ü
=(cÚ¡ 
EQSock‘
&);

	@src/include/Edit.hh

1 #´agm¨
Úû


3 
	~"memÜy.hh
"

5 şas 
	cEd™


7 
	mpublic
:

8 
	$Ed™
() {}

9 
vœtu®
 ~
	$Ed™
(è{
	}
}

11 
ed™_ty³
 = 0;

12 
	ged™_lše
 = 0;

13 
	ged™_Æšes
 = 0;

14 
boŞ
 
	ged™_undo_ok
 = 
çl£
;

15 
	ged™_¡ršg
[
MAX_STRING_LENGTH
] = {0};

16 
	ged™_backup
[
MAX_STRING_LENGTH
] = {0};

17 
	ged™_id
 = 0;

19 
	g´iv©e
:

20 
Ed™
(const Edit&);

21 
	gEd™
& 
	gİ”©Ü
=(cÚ¡ 
Ed™
&);

24 
	#EDIT_TYPE_NONE
 0

	)

25 
	#EDIT_TYPE_NOTE
 1

	)

26 
	#EDIT_TYPE_DESC
 2

	)

27 
	#EDIT_TYPE_ROOM
 3

	)

28 
	#EDIT_TYPE_HELP
 4

	)

	@src/include/Exit.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

4 
	~"FÏgs.hh
"

6 
şass
 
	gEx™PrÙÙy³
;

7 
şass
 
	gRoom
;

9 şas 
	cEx™


11 
	mpublic
:

12 
Ex™
(cÚ¡ 
Ex™PrÙÙy³
& 
p
, 
Room
 *
to_room
);

13 
	mvœtu®
 ~
	$Ex™
() {}

15 cÚ¡ 
Ex™PrÙÙy³
& 
´ÙÙy³
;

16 
FÏgs
 
ex™_æags
;

17 
Room
 *
to_room
;

19 cÚ¡ 
SŒšg
& 
	`dœ_Çme
(
dœ
, 
boŞ
 
»v”£
 = 
çl£
);

20 
	`»v_dœ
(
dœ
);

22 
	$key
() const;

23 cÚ¡ 
SŒšg
& 
	$keywÜd
() const;

24 cÚ¡ 
SŒšg
& 
	$desütiÚ
() const;

26 
´iv©e
:

27 
Ex™
& 
İ”©Ü
=(const Exit&);

28 
	}
};

30 
šlše
 
	gEx™
::

31 
	$»v_dœ
(
dœ
) {

32 cÚ¡ 
rdœ
[] = {

36  
rdœ
[
dœ
 % 6];

37 
	}
}

39 
šlše
 cÚ¡ 
	gSŒšg
& 
	gEx™
::

40 
	$dœ_Çme
(
dœ
, 
boŞ
 
»v”£
) {

41 cÚ¡ 
SŒšg
 
dœ_Çme
[] = {

45 
dœ
 = dir % 6;

47 ià(
»v”£
)

48 
dœ
 = 
	`»v_dœ
(dir);

50  
dœ_Çme
[
dœ
 % 6];

51 
	}
}

	@src/include/ExitPrototype.hh

1 #´agm¨
Úû


3 
	~"deş¬e.hh
"

4 
	~"SŒšg.hh
"

5 
	~"FÏgs.hh
"

6 
	~"Vnum.hh
"

8 şas 
	cEx™PrÙÙy³


10 
	mpublic
:

11 
Ex™PrÙÙy³
(
FILE
 *
å
);

12 
	mvœtu®
 ~
	$Ex™PrÙÙy³
() {}

14 
SŒšg
 
desütiÚ
;

15 
SŒšg
 
keywÜd
;

16 
Vnum
 
to_vnum
 = 0;

17 
FÏgs
 
ex™_æags
;

18 
key
 = 0;

20 
´iv©e
:

21 
	`Ex™PrÙÙy³
(cÚ¡ 
Ex™PrÙÙy³
&);

22 
Ex™
& 
İ”©Ü
=(const Exit&);

23 
	}
};

	@src/include/ExtraDescr.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

4 
	~"PoŞed.hh
"

9 
şass
 
	gExŒaDesü
 :

10 
public
 
PoŞed
<
ExŒaDesü
>

12 
public
:

13 
ExŒaDesü
() {}

14 
ExŒaDesü
(cÚ¡ 
SŒšg
& 
k
, cÚ¡ SŒšg& 
d
è: 
keywÜd
(k), 
desütiÚ
(d) {}

15 
ExŒaDesü
(cÚ¡ ExŒaDesü& 
e
è: 
keywÜd
Ó.keywÜd), 
desütiÚ
(e.description) {}

16 
	gvœtu®
 ~
ExŒaDesü
() {}

18 
ExŒaDesü
 *
	gÃxt
 = 
nuÎ±r
;

19 
SŒšg
 
	gkeywÜd
;

20 
SŒšg
 
	gdesütiÚ
;

22 
	g´iv©e
:

23 
ExŒaDesü
& 
İ”©Ü
=(const ExtraDescr&);

27 
ExŒaDesü
 *
Ãw_exŒa_desü
 ();

28 
ä“_exŒa_desü
 (
ExŒaDesü
 *
ed
);

	@src/include/Flags.hh

1 #´agm¨
Úû


3 
	~<b™£t
>

5 
şass
 
	gSŒšg
;

7 
	#FLAGS_NBITS
 32

	)

9 şas 
	cFÏgs


11 
	mpublic
:

12 
B™
 : {

13 
nÚe
 = 0,

14 
	mA
 = 1,

15 
	mB
 = 2,

16 
	mC
 = 4,

17 
	mD
 = 8,

18 
	mE
 = 16,

19 
	mF
 = 32,

20 
	mG
 = 64,

21 
	mH
 = 128,

22 
	mI
 = 256,

23 
	mJ
 = 512,

24 
	mK
 = 1024,

25 
	mL
 = 2048,

26 
	mM
 = 4096,

27 
	mN
 = 8192,

28 
	mO
 = 16384,

29 
	mP
 = 32768,

30 
	mQ
 = 65536,

31 
	mR
 = 131072,

32 
	mS
 = 262144,

33 
	mT
 = 524288,

34 
	mU
 = 1048576,

35 
	mV
 = 2097152,

36 
	mW
 = 4194304,

37 
	mX
 = 8388608,

38 
	mY
 = 16777216,

39 
	mZ
 = 33554432,

40 
	ma
 = 67108864,

41 
	mb
 = 134217728,

42 
	mc
 = 268435456,

43 
	md
 = 536870912,

44 
	me
 = 1073741824,

45 
	mf
 = 2147483648,

46 
	mg
 = 4294967296,

47 
	m®l
 = 
A
|
B
|
C
|
D
|
E
|
F
|
G
|
H
|
I
|
J
|
K
|
L
|
M
|
N
|
O
|
P
|
Q
|
R
|
S
|
T
|
U
|
V
|
W
|
X
|
Y
|
Z
|
a
|
b
|
c
|
d
|
e
|
f
|
g


50 
	$FÏgs
(è{
	}
}

51 
ex¶ic™
 
	$FÏgs
(
f
è: 
	$b™s
(
f
è{
	}
}

53 
	$FÏgs
(cÚ¡ 
B™
& 
b
è: 
	`b™s
(
¡©ic_ÿ¡
<>(b)è{
	}
}

54 
	$FÏgs
(cÚ¡ 
FÏgs
& 
f
è: 
	$b™s
(
f
.
b™s
è{
	}
}

55 
FÏgs
(cÚ¡ *
s
);

56 
FÏgs
(cÚ¡ 
SŒšg
& 
s
);

57 
	gvœtu®
 ~
	$FÏgs
(è{
	}
}

59 
	gFÏgs
& 
	gİ”©Ü
=(cÚ¡ 
FÏgs
& 
f
è{ 
b™s
 = f.b™s;  *
	gthis
; }

61 
	gFÏgs
& 
	gİ”©Ü
+ğ(cÚ¡ 
FÏgs
& 
rhs
è{ 
b™s
 |ğrhs.b™s;  *
	gthis
; }

62 
	gFÏgs
& 
	gİ”©Ü
-ğ(cÚ¡ 
FÏgs
& 
rhs
è{ 
b™s
 &ğ~rhs.b™s;  *
	gthis
; }

63 
	gFÏgs
& 
	gİ”©Ü
^ğ(cÚ¡ 
FÏgs
& 
rhs
è{ 
b™s
 ^ğrhs.b™s;  *
	gthis
; }

65 cÚ¡ 
FÏgs
 
	gİ”©Ü
+ (cÚ¡ 
	gFÏgs
& 
	grhs
ècÚ¡ {  FÏgs(*
this
è+ğ
rhs
; }

66 cÚ¡ 
FÏgs
 
	gİ”©Ü
- (cÚ¡ 
	gFÏgs
& 
	grhs
ècÚ¡ {  FÏgs(*
this
è-ğ
rhs
; }

68 cÚ¡ 
FÏgs
 
	gİ”©Ü
| (cÚ¡ 
	gB™
& 
	grhs
ècÚ¡ {  FÏgs(*
this
è+ğFÏgs(
rhs
); }

70 
boŞ
 
	$has_®l_of
 (cÚ¡ 
FÏgs
& 
f
ècÚ¡ {  (
b™s
 & f.b™sè=ğf.b™s; 
	}
}

71 
boŞ
 
	$has_ªy_of
 (cÚ¡ 
FÏgs
& 
f
ècÚ¡ {  (
b™s
 & f.b™sè!ğ0; 
	}
}

72 
boŞ
 
	$has_nÚe_of
(cÚ¡ 
FÏgs
& 
f
ècÚ¡ {  (
b™s
 & f.b™sè=ğ0; 
	}
}

73 
boŞ
 
	$has
(cÚ¡ 
FÏgs
::
B™
& 
b
ècÚ¡ {  
	`has_®l_of
(b); 
	}
}

75 
boŞ
 
	$em±y
(ècÚ¡ {  
b™s
.
	`nÚe
(); 
	}
}

76 
	$ş—r
(è{ 
b™s
.
	`»£t
(); 
	}
}

78 
	$to_ulÚg
(ècÚ¡ {  
b™s
.
	`to_ulÚg
(); 
	}
}

79 cÚ¡ 
SŒšg
 
	$to_¡ršg
() const;

81 
ä›nd
 
boŞ
 
İ”©Ü
=ğ(cÚ¡ 
FÏgs
&, const Flags&);

82 
ä›nd
 
boŞ
 
İ”©Ü
!ğ(cÚ¡ 
FÏgs
&, const Flags&);

85 
´iv©e
:

86 
¡d
::
b™£t
<
FLAGS_NBITS
> 
b™s
 = {0
	}
};

89 
šlše
 
boŞ
 
	gİ”©Ü
=ğ(cÚ¡ 
FÏgs
& 
lhs
, cÚ¡ 
	gFÏgs
& 
	grhs
) {

90  
	glhs
.
	gb™s
 =ğ
rhs
.
b™s
;

93 
šlše
 
boŞ
 
	gİ”©Ü
!ğ(cÚ¡ 
FÏgs
& 
lhs
, cÚ¡ 
	gFÏgs
& 
	grhs
) {

94  
	glhs
.
	gb™s
 !ğ
rhs
.
b™s
;

102 
šlše
 cÚ¡ 
FÏgs
 
	gİ”©Ü
+ (cÚ¡ 
	gFÏgs
::
B™
& 
lhs
, cÚ¡ FÏgs::B™& 
rhs
) {

103  
FÏgs
(
lhs
è+ 
rhs
;

106 
šlše
 cÚ¡ 
FÏgs
 
	gİ”©Ü
| (cÚ¡ 
	gFÏgs
::
B™
& 
lhs
, cÚ¡ FÏgs::B™& 
rhs
) {

107  
FÏgs
(
lhs
è+ 
rhs
;

	@src/include/Format.hh

1 #´agm¨
Úû


3 
	~<io¡»am
>

4 
	~<¡ršg
>

5 
	~<c¡dio
>

7 
	~"memÜy.hh
"

11 
	~"SŒšg.hh
"

12 
	~"FÏgs.hh
"

13 
	~"ObjeùV®ue.hh
"

14 
	~"Vnum.hh
"

15 
	~"LoÿtiÚ.hh
"

20 
Çme¥aû
 
	gFÜm©
 {

22 
	g‹m¶©e
<
şass
 
	gTMP
>

23 
šlše
‡utØ
to_c
(
TMP
&& 
·¿m
è-> 
deşty³
(
¡d
::
fÜw¬d
<TMP>(param)) {

24  
¡d
::
fÜw¬d
<
TMP
>(
·¿m
);

27 
šlše
 cÚ¡ *
to_c
(cÚ¡ 
SŒšg
& 
s
è{  
	gs
.
c_¡r
(); }

28 
šlše
 cÚ¡ *
to_c
(
SŒšg
& 
s
è{  
	gs
.
c_¡r
(); }

29 
šlše
 cÚ¡ *
to_c
(cÚ¡ 
FÏgs
& 
s
è{  
	gs
.
to_¡ršg
().
c_¡r
(); }

30 
šlše
 cÚ¡ *
to_c
(
FÏgs
& 
s
è{  
	gs
.
to_¡ršg
().
c_¡r
(); }

31 
šlše
 
to_c
(cÚ¡ 
ObjeùV®ue
& 
v
è{  
	gv
.
v®ue
(); }

32 
šlše
 
to_c
(
ObjeùV®ue
& 
v
è{  
	gv
.
v®ue
(); }

33 
šlše
 
to_c
(cÚ¡ 
Vnum
& 
v
è{  
	gv
.
v®ue
(); }

34 
šlše
 
to_c
(
Vnum
& 
v
è{  
	gv
.
v®ue
(); }

35 
šlše
 cÚ¡ *
to_c
(cÚ¡ 
LoÿtiÚ
& 
v
è{  
	gv
.
to_¡ršg
().
c_¡r
(); }

36 
šlše
 cÚ¡ *
to_c
(
LoÿtiÚ
& 
v
è{  
	gv
.
to_¡ršg
().
c_¡r
(); }

39 
	g‹m¶©e
<
	gşass
... 
	gP¬ams
>

40 
´štf
(cÚ¡ 
SŒšg
& 
fmt
, 
P¬ams
&&... 
·¿ms
) {

41  
	g¡d
::
´štf
(
fmt
.
c_¡r
(), 
to_c
(
·¿ms
)...);

44 
	g‹m¶©e
<
	gşass
... 
	gP¬ams
>

45 
¥rštf
(*
buf
, cÚ¡ 
SŒšg
& 
fmt
, 
P¬ams
&&... 
·¿ms
) {

46  
	g¡d
::
¥rštf
(
buf
, 
fmt
.
c_¡r
(), 
to_c
(
·¿ms
)...);

49 
	g‹m¶©e
<
	gşass
... 
	gP¬ams
>

50 
¢´štf
(*
buf
, 
Ën
, cÚ¡ 
SŒšg
& 
fmt
, 
P¬ams
&&... 
·¿ms
) {

51  
	g¡d
::
¢´štf
(
buf
, 
Ën
, 
fmt
.
c_¡r
(), 
to_c
(
·¿ms
)...);

54 
	g‹m¶©e
<
	gşass
... 
	gP¬ams
>

55 
årštf
(
FILE
 *
å
, cÚ¡ 
SŒšg
& 
fmt
, 
P¬ams
&&... 
·¿ms
) {

56  
	g¡d
::
årštf
(
å
, 
fmt
.
c_¡r
(), 
to_c
(
·¿ms
)...);

61 
	g‹m¶©e
<
	gşass
... 
	gP¬ams
>

62 
¢´štf
(
SŒšg
& 
¡r
, 
Ën
, cÚ¡ SŒšg& 
fmt
, 
P¬ams
&&... 
·¿ms
) {

63 
	gbuf
[
Ën
+1];

64 
	gcİ›d
 = 
¢´štf
(
buf
, 
Ën
, 
fmt
, 
·¿ms
...);

65 
	g¡r
.
assign
(
buf
);

66  
	gcİ›d
;

69 
	g‹m¶©e
<
	gşass
... 
	gP¬ams
>

70 
¥rštf
(
SŒšg
& 
¡r
, cÚ¡ SŒšg& 
fmt
, 
P¬ams
&&... 
·¿ms
) {

71  
¢´štf
(
¡r
, 
MAX_STRING_LENGTH
*4, 
fmt
, 
·¿ms
...);

76 
	g‹m¶©e
<
	gşass
... 
	gP¬ams
>

77 
SŒšg
 
fÜm©
(cÚ¡ SŒšg& 
fmt
, 
P¬ams
&&... 
·¿ms
) {

78 
SŒšg
 
	g¡r
;

79 
¥rštf
(
¡r
, 
fmt
, 
·¿ms
...);

80  
	g¡r
;

	@src/include/Game.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

5 
şass
 
	gWÜld
;

7 şas 
	cGame


9 
	mpublic
:

10 
vœtu®
 ~
	$Game
() {}

11 
WÜld
& 
	`wÜld
();

13 
	`boÙ
();

15 
pÜt
;

16 
SŒšg
 
mÙd
;

17 
SŒšg
 
h–p_g»‘šg
;

18 
boŞ
 
boÙšg
;

19 
time_t
 
cu¼’t_time
;

20 
boŞ
 
log_®l
;

21 
»cÜd_logšs
;

22 
»cÜd_¶ay”s
;

23 
»cÜd_¶ay”s_sšû_boÙ
;

24 
que¡_doubË
;

25 
boŞ
 
wizlock
;

26 
boŞ
 
Ãwlock
;

28 
´iv©e
:

29 
	$Game
(è{
	}
}

30 
Game
(const Game&);

31 
	gGame
& 
	gİ”©Ü
=(cÚ¡ 
Game
&);

	@src/include/GameTime.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

4 
	~<ùime
>

6 şas 
	cGameTime


8 
	mpublic
:

9 
GameTime
(
¡d
::
time_t
 
sy¡em_time
);

10 
	mvœtu®
 ~
	$GameTime
() {}

12 
	`upd©e
();

14 cÚ¡ 
SŒšg
& 
	$day_Çme
() const;

15 cÚ¡ 
SŒšg
 
	$day_¡ršg
() const;

16 cÚ¡ 
SŒšg
& 
	$mÚth_Çme
() const;

18 
	eSun
 {

19 
Night
,

20 
SuÄi£
,

21 
Sun£t
,

22 
Day
,

23 
	}
};

25 
	ghour
 = 0;

26 
	gday
 = 0;

27 
	gmÚth
 = 0;

28 
	gy—r
 = 0;

29 
Sun
 
	gsuÆight
 = 
Night
;

31 
	g´iv©e
:

32 
GameTime
(const GameTime&);

33 
	gGameTime
& 
	gİ”©Ü
=(cÚ¡ 
GameTime
&);

36 
	#MUD_YEAR
 17

	)

37 
	#MUD_MONTH
 35

	)

38 
	#MUD_DAY
 24

	)

39 
	#MUD_HOUR
 45

	)

	@src/include/Garbage.hh

1 #´agm¨
Úû


3 şas 
	cG¬bage
 {

4 
	mpublic
:

5 
	$nÙ_g¬bage
(è{ 
_g¬bage
 = 
çl£
; }

6 
	$make_g¬bage
(è{ 
_g¬bage
 = 
Œue
; 
	}
}

7 
boŞ
 
	$is_g¬bage
(ècÚ¡ {  
_g¬bage
; 
	}
}

9 
	g´iv©e
:

10 
boŞ
 
_g¬bage
 = 
Œue
;

	@src/include/GarbageCollectingList.hh

1 #´agm¨
Úû


3 
	~<li¡
>

4 
	~"G¬bage.hh
"

6 
	g‹m¶©e
 <
ty³Çme
 
	gT
> cÏs 
	cG¬bageCŞËùšgLi¡


8 
	mpublic
:

9 şas 
	c™”©Ü
 {

10 
public
:

11 
™”©Ü
(
ty³Çme
 
¡d
::
li¡
<
T
>::™”©Ü 
™
, 
G¬bageCŞËùšgLi¡
<T>& 
ls
) : it(it),†ist(ls) {}

13 
	m™”©Ü
& 
	mİ”©Ü
=(cÚ¡ 
™”©Ü
& 
rhs
è{ 
™
 =„hs;  *
	mthis
; }

14 
	m™”©Ü
& 
	mİ”©Ü
++() {

16 ++
	m™
;

18 
	m™
 !ğ
li¡
.
’d
().
™
 && (*™)->
is_g¬bage
());

20  *
	mthis
;

22 
ä›nd
 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
™”©Ü
& 
lhs
, cÚ¡ 
	m™”©Ü
& 
	mrhs
è{  
	mlhs
.
	m™
 =ğ
rhs
.
™
; }

23 
ä›nd
 
boŞ
 
	mİ”©Ü
!=(cÚ¡ 
™”©Ü
& 
lhs
, cÚ¡ 
	m™”©Ü
& 
	mrhs
è{  !(
	mlhs
 =ğ
rhs
); }

25 
	mT
& 
	mİ”©Ü
*(è{  *
	m™
; }

27 
	m´iv©e
:

28 
ty³Çme
 
¡d
::
li¡
<
T
>::
™”©Ü
 
™
;

29 
	mG¬bageCŞËùšgLi¡
& 
	mli¡
;

32 
™”©Ü
 
	$begš
() {

33 
™”©Ü
 
™
 = 
	`™”©Ü
(
cÚš”
.
	`begš
(), *
this
);

35 ià(
™
 =ğ
	`’d
(è|| !(*™)->
	`is_g¬bage
())

36  
™
;

38  ++
™
;

39 
	}
}

41 
™”©Ü
 
	$’d
(è{  
	`™”©Ü
(
cÚš”
.
	`’d
(), *
this
); 
	}
}

43 
	$G¬bageCŞËùšgLi¡
() {

44 ()
¡©ic_ÿ¡
<
G¬bage
 *>((
T
)0);

45 
	}
}

46 
	gvœtu®
 ~
	$G¬bageCŞËùšgLi¡
(è{
	}
}

54 
size_t
 
	$size
(ècÚ¡ {  
cÚš”
.
	`size
(); 
	}
}

56 
	$add
(
T
 
±r
è{ 
cÚš”
.
	`push_äÚt
ÕŒ);…Œ->
	`nÙ_g¬bage
(); 
	}
}

57 
	$»move
(
T
 
±r
è{…Œ->
	`make_g¬bage
(); 
	}
}

60 
	$d–‘e_g¬bage
() {

61 autØ
™
 = 
cÚš”
.
	`begš
(); iˆ!ğcÚš”.
	`’d
(); ) {

62 autØ
±r
 = *
™
;

63 ià(!
±r
->
	`is_g¬bage
())

64 ++
™
;

66 
d–‘e
 
±r
;

67 
™
 = 
cÚš”
.
	`”a£
(it);

70 
	}
}

72 
	g´iv©e
:

73 
G¬bageCŞËùšgLi¡
(const GarbageCollectingList&);

74 
	gG¬bageCŞËùšgLi¡
& 
	gİ”©Ü
=(cÚ¡ 
G¬bageCŞËùšgLi¡
&);

76 
	g¡d
::
li¡
<
T
> 
cÚš”
;

	@src/include/Guild.hh

1 #´agm¨
Úû


3 
	eGud
 {

4 
	mnÚe
 = -1,

5 
	mmage
 = 0,

6 
	mş”ic
,

7 
	mth›f
,

8 
	mw¬riÜ
,

9 
	mÃüomªûr
,

10 
	m·Ïdš
,

11 
	mb¬d
,

12 
	m¿ng”
,

14 
	msize
,

15 
	mfœ¡
 = 0

	@src/include/JSON/cJSON.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

4 
	~"FÏgs.hh
"

5 
	~"../d•s/cJSON/cJSON.h
"

7 
Çme¥aû
 
	gJSON
 {

9 
šlše
 
addSŒšgToObjeù
(
cJSON
 *
obj
, cÚ¡ 
SŒšg
& 
key
, cÚ¡ SŒšg& 
¡r
) {

10 
cJSON_AddSŒšgToObjeù
(
obj
, 
key
.
c_¡r
(), 
¡r
.c_str());

13 
šlše
 
g‘_boŞ—n
(
cJSON
 *
obj
, 
boŞ
 *
rg‘
, cÚ¡ 
SŒšg
& 
key
) {

14 
cJSON
 *
	gv®
 = 
cJSON_G‘ObjeùI‹m
(
obj
, 
key
.
c_¡r
());

16 ià(
	gv®
 !ğ
nuÎ±r
)

17 *
rg‘
 = (
v®
->
v®uešt
 != 0);

20 
šlše
 
g‘_shÜt
(
cJSON
 *
obj
, *
rg‘
, cÚ¡ 
SŒšg
& 
key
) {

21 
cJSON
 *
	gv®
 = 
cJSON_G‘ObjeùI‹m
(
obj
, 
key
.
c_¡r
());

23 ià(
	gv®
 !ğ
nuÎ±r
)

24 *(*)
rg‘
 = 
v®
->
v®uešt
;

27 
šlše
 
g‘_št
(
cJSON
 *
obj
, *
rg‘
, cÚ¡ 
SŒšg
& 
key
) {

28 
cJSON
 *
	gv®
 = 
cJSON_G‘ObjeùI‹m
(
obj
, 
key
.
c_¡r
());

30 ià(
	gv®
 !ğ
nuÎ±r
)

31 *
rg‘
 = 
v®
->
v®uešt
;

34 
šlše
 
g‘_lÚg
(
cJSON
 *
obj
, *
rg‘
, cÚ¡ 
SŒšg
& 
key
) {

35 
cJSON
 *
	gv®
 = 
cJSON_G‘ObjeùI‹m
(
obj
, 
key
.
c_¡r
());

37 ià(
	gv®
 !ğ
nuÎ±r
)

38 *
rg‘
 = 
v®
->
v®uešt
;

41 
šlše
 
g‘_æags
(
cJSON
 *
obj
, 
FÏgs
 *
rg‘
, cÚ¡ 
SŒšg
& 
key
) {

42 
cJSON
 *
	gv®
 = 
cJSON_G‘ObjeùI‹m
(
obj
, 
key
.
c_¡r
());

44 ià(
	gv®
 !ğ
nuÎ±r
)

45 *
rg‘
 = 
FÏgs
(
v®
->
v®ue¡ršg
);

48 
šlše
 
g‘_¡ršg
(
cJSON
 *
obj
, 
SŒšg
 *
rg‘
, cÚ¡ SŒšg& 
key
) {

49 
cJSON
 *
	gv®
 = 
cJSON_G‘ObjeùI‹m
(
obj
, 
key
.
c_¡r
());

51 ià(
	gv®
 !ğ
nuÎ±r
) {

52 
rg‘
->
assign
(
v®
->
v®ue¡ršg
);

56 
cJSON
 *
»ad_fe
(cÚ¡ 
SŒšg
& 
f’ame
);

	@src/include/Location.hh

1 #´agm¨
Úû


3 
	~"wÜldm­/CoÜdš©e.hh
"

4 
	~"RoomID.hh
"

5 
	~"Vnum.hh
"

37 şas 
	cLoÿtiÚ
 {

38 
	mpublic
:

40 
	$LoÿtiÚ
(è: 
	`coÜd
(), 
	$room_id
() {}

41 
vœtu®
 ~
	$LoÿtiÚ
(è{
	}
}

44 
	$LoÿtiÚ
(cÚ¡ 
LoÿtiÚ
& 
l
è: 
	`coÜd
Ö.
coÜd
), 
	$room_id
(
l
.
room_id
è{
	}
}

45 
	gLoÿtiÚ
& 
	gİ”©Ü
=(cÚ¡ 
LoÿtiÚ
& 
l
) {

46 
coÜd
 = 
l
.coord;

47 
	groom_id
 = 
l
.
room_id
;

48  *
	gthis
;

53 
ex¶ic™
 
	$LoÿtiÚ
(
v®ue
è: 
	`coÜd
(v®ue), 
	$room_id
(
v®ue
è{
	}
}

56 
ex¶ic™
 
	$LoÿtiÚ
(cÚ¡ 
RoomID
& 
id
è: 
	`coÜd
(), 
	$room_id
(
id
è{
	}
}

59 
ex¶ic™
 
	$LoÿtiÚ
(cÚ¡ 
wÜldm­
::
CoÜdš©e
& 
c
è: 
	`coÜd
(c), 
	$room_id
(è{
	}
}

62 
ex¶ic™
 
	$LoÿtiÚ
(cÚ¡ 
wÜldm­
::
CoÜdš©e
& 
c
, cÚ¡ 
RoomID
& 
id
è: 
	`coÜd
(c), 
	$room_id
(
id
è{
	}
}

65 
ex¶ic™
 
	$LoÿtiÚ
(cÚ¡ 
SŒšg
& 
s
è: 
	$LoÿtiÚ
() {

67 
coÜd
 = 
wÜldm­
::
	`CoÜdš©e
(
s
);

69 ià(!
coÜd
.
	`is_v®id
())

70 
room_id
 = 
	`RoomID
(
s
);

71 
	}
}

74 
	$to_št
() const {

75 ià(
coÜd
.
	`is_v®id
())

76  
coÜd
.
	`to_št
();

78  
room_id
.
	`to_št
();

79 
	}
}

82 cÚ¡ 
SŒšg
 
	$to_¡ršg
(
boŞ
 
shÜt_loc
 = 
Œue
) const {

83 ià(
coÜd
.
	`is_v®id
())

84  
coÜd
.
	`to_¡ršg
(
shÜt_loc
);

86  
room_id
.
	`to_¡ršg
(
shÜt_loc
);

87 
	}
}

89 
boŞ
 
	$is_v®id
(ècÚ¡ {  
coÜd
.
	`is_v®id
(è|| 
room_id
.is_v®id(); 
	}
}

91 
šlše
 
ä›nd
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
LoÿtiÚ
& 
lhs
, cÚ¡ 
	gLoÿtiÚ
& 
	grhs
) {

93 ià(!
	glhs
.
is_v®id
(è&& !
	grhs
.is_valid())

94  
	gŒue
;

97 ià(
	glhs
.
	gcoÜd
.
is_v®id
()

98 && 
	glhs
.
	gcoÜd
 =ğ
rhs
.
coÜd
)

99  
Œue
;

101 ià(
	glhs
.
	groom_id
.
is_v®id
()

102 && 
	glhs
.
	groom_id
 =ğ
rhs
.
room_id
)

103  
Œue
;

105  
	gçl£
;

108 
šlše
 
ä›nd
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
LoÿtiÚ
& 
lhs
, cÚ¡ 
	gLoÿtiÚ
& 
	grhs
) {

109  !(
	glhs
 =ğ
rhs
);

112 
	gwÜldm­
::
CoÜdš©e
 
coÜd
;

113 
RoomID
 
	groom_id
;

	@src/include/Logging.hh

1 #´agm¨
Úû


3 
	~"FÜm©.hh
"

5 
şass
 
	gSŒšg
;

6 
şass
 
	gVnum
;

8 
Çme¥aû
 
	gLoggšg
 {

10 
bug
(cÚ¡ 
SŒšg
& 
¡r
, 
·¿m
);

11 
log
(cÚ¡ 
SŒšg
& 
¡r
);

12 
fe_bug
(
FILE
 *
å
, cÚ¡ 
SŒšg
& 
¡r
, 
·¿m
);

13 
fe_bug
(
FILE
 *
å
, cÚ¡ 
SŒšg
& 
¡r
, cÚ¡ 
Vnum
& 
vnum
);

15 
	g‹m¶©e
<
	gşass
... 
	gP¬ams
>

16 
bugf
(cÚ¡ 
SŒšg
& 
fmt
, 
P¬ams
... 
·¿ms
)

18 
	gLoggšg
::
bug
(
FÜm©
::
fÜm©
(
fmt
, 
·¿ms
...), 0);

21 
	g‹m¶©e
<
	gşass
... 
	gP¬ams
>

22 
logf
(cÚ¡ 
SŒšg
& 
fmt
, 
P¬ams
... 
·¿ms
)

24 
	gLoggšg
::
log
(
FÜm©
::
fÜm©
(
fmt
, 
·¿ms
...));

	@src/include/MobProg.hh

1 #´agm¨
Úû


3 
	~"FÏgs.hh
"

4 
	~"SŒšg.hh
"

6 
şass
 
	gCh¬aù”
;

7 
şass
 
	gObjeù
;

9 şas 
	cMobProg


11 
	mpublic
:

12 
MobProg
(
FILE
 *
å
);

13 
	mvœtu®
 ~
	$MobProg
() {}

15 
FÏgs
::
B™
 
ty³
;

16 
SŒšg
 
¬gli¡
;

17 
SŒšg
 
comli¡
;

19 
FÏgs
::
B™
 
	`Çme_to_ty³
(cÚ¡ 
SŒšg
&);

20 cÚ¡ 
SŒšg
 
	`ty³_to_Çme
(
FÏgs
::
B™
);

21 
´iv©e
:

23 
	`MobProg
(cÚ¡ 
MobProg
&);

24 
MobProg
& 
İ”©Ü
=(const MobProg&);

25 
	}
};

27 
boŞ
 
MOBŒigg”
;

29 
	#ERROR_PROG
 
FÏgs
::
nÚe


	)

30 
	#IN_FILE_PROG
 
FÏgs
::
A


	)

31 
	#ACT_PROG
 
FÏgs
::
B


	)

32 
	#SPEECH_PROG
 
FÏgs
::
C


	)

33 
	#RAND_PROG
 
FÏgs
::
D


	)

34 
	#FIGHT_PROG
 
FÏgs
::
E


	)

35 
	#DEATH_PROG
 
FÏgs
::
F


	)

36 
	#HITPRCNT_PROG
 
FÏgs
::
G


	)

37 
	#ENTRY_PROG
 
FÏgs
::
H


	)

38 
	#GREET_PROG
 
FÏgs
::
I


	)

39 
	#ALL_GREET_PROG
 
FÏgs
::
J


	)

40 
	#GIVE_PROG
 
FÏgs
::
K


	)

41 
	#BRIBE_PROG
 
FÏgs
::
L


	)

42 
	#BUY_PROG
 
FÏgs
::
M


	)

43 
	#TICK_PROG
 
FÏgs
::
N


	)

44 
	#BOOT_PROG
 
FÏgs
::
O


	)

45 
	#RAND_AREA_PROG
 
FÏgs
::
P


	)

48 
m´og_wÜdli¡_check
 ( cÚ¡ 
SŒšg
& 
¬g
, 
Ch¬aù”
 *
mob
,

49 
Ch¬aù”
* 
aùÜ
, 
Objeù
* 
objeù
,

50 * 
vo
, 
FÏgs
::
B™
 
ty³
 );

51 
m´og_³rûÁ_check
 ( 
Ch¬aù”
 *
mob
, Ch¬aù”* 
aùÜ
,

52 
Objeù
* 
objeù
, * 
vo
,

53 
FÏgs
::
B™
 
ty³
 );

54 
m´og_aù_Œigg”
 ( cÚ¡ * 
buf
, 
Ch¬aù”
* 
mob
,

55 
Ch¬aù”
* 
ch
, 
Objeù
* 
obj
,

56 * 
vo
 );

57 
m´og_bribe_Œigg”
 ( 
Ch¬aù”
* 
mob
, Ch¬aù”* 
ch
,

58 
amouÁ
 );

59 
m´og_’Œy_Œigg”
 ( 
Ch¬aù”
* 
mob
 );

60 
m´og_give_Œigg”
 ( 
Ch¬aù”
* 
mob
, Ch¬aù”* 
ch
,

61 
Objeù
* 
obj
 );

62 
m´og_g»‘_Œigg”
 ( 
Ch¬aù”
* 
mob
 );

63 
m´og_fight_Œigg”
 ( 
Ch¬aù”
* 
mob
, Ch¬aù”* 
ch
 );

64 
m´og_buy_Œigg”
 ( 
Ch¬aù”
* 
mob
, Ch¬aù”* 
ch
 );

65 
m´og_h™´út_Œigg”
 ( 
Ch¬aù”
* 
mob
, Ch¬aù”* 
ch
 );

66 
m´og_d—th_Œigg”
 ( 
Ch¬aù”
* 
mob
 );

67 
m´og_¿ndom_Œigg”
 ( 
Ch¬aù”
* 
mob
 );

68 
m´og_¿ndom_¬—_Œigg”
 ( 
Ch¬aù”
* 
mob
 );

69 
m´og_tick_Œigg”
 ( 
Ch¬aù”
* 
mob
 );

70 
m´og_boÙ_Œigg”
Ğ
Ch¬aù”
* 
mob
 );

71 
m´og_¥“ch_Œigg”
 ( cÚ¡ 
SŒšg
& 
txt
, 
Ch¬aù”
* 
mob
 );

	@src/include/MobProgActList.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

5 
şass
 
	gCh¬aù”
;

6 
şass
 
	gObjeù
;

8 şas 
	cMobProgAùLi¡


10 
	mpublic
:

11 
	$MobProgAùLi¡
() {}

12 
vœtu®
 ~
	$MobProgAùLi¡
(è{
	}
}

14 
MobProgAùLi¡
 * 
Ãxt
 = 
nuÎ±r
;

15 
SŒšg
 
	gbuf
;

16 
Ch¬aù”
 * 
	gch
 = 
nuÎ±r
;

17 
Objeù
 * 
	gobj
 = 
nuÎ±r
;

18 * 
	gvo
 = 
nuÎ±r
;

20 
	g´iv©e
:

21 
MobProgAùLi¡
(const MobProgActList&);

22 
	gMobProgAùLi¡
& 
	gİ”©Ü
=(cÚ¡ 
MobProgAùLi¡
&);

	@src/include/MobilePrototype.hh

1 #´agm¨
Úû


3 
	~<veùÜ
>

5 
	~"deş¬e.hh
"

6 
	~"SŒšg.hh
"

7 
	~"FÏgs.hh
"

8 
	~"Vnum.hh
"

14 şas 
	cMobePrÙÙy³


16 
	mpublic
:

17 
MobePrÙÙy³
(
A»a
&, cÚ¡ 
Vnum
&, 
FILE
 *);

18 
	mvœtu®
 ~
MobePrÙÙy³
();

20 
	mA»a
& 
	m¬—
;

21 cÚ¡ 
Vnum
 
	mvnum
;

22 
MobePrÙÙy³
 * 
	mÃxt
 = 
nuÎ±r
;

23 
SPEC_FUN
 * 
	m¥ec_fun
 = 
nuÎ±r
;

24 
Shİ
 * 
	mpShİ
 = 
nuÎ±r
;

25 
FÏgs
 
	mgroup_æags
;

26 
	mcouÁ
 = 0;

27 
	mkËd
 = 0;

28 
SŒšg
 
	m¶ay”_Çme
;

29 
SŒšg
 
	mshÜt_desü
;

30 
SŒšg
 
	mlÚg_desü
;

31 
SŒšg
 
	mdesütiÚ
;

32 
FÏgs
 
	maù_æags
;

33 
FÏgs
 
	mafãù_æags
;

34 
	m®ignm’t
 = 0;

35 
	mËv–
 = 0;

36 
	mh™rŞl
 = 0;

37 
	mh™
[3] = {0};

38 
	gmªa
[3] = {0};

39 
	gdamage
[3] = {0};

40 
	gac
[4] = {0};

41 
	gdam_ty³
 = 0;

42 
FÏgs
 
	goff_æags
;

43 
FÏgs
 
	gabsÜb_æags
;

44 
FÏgs
 
	gimm_æags
;

45 
FÏgs
 
	g»s_æags
;

46 
FÏgs
 
	gvuÊ_æags
;

47 
	g¡¬t_pos
 = 0;

48 
	gdeçuÉ_pos
 = 0;

49 
	g£x
 = 0;

50 
	g¿û
 = 0;

51 
	gw—Éh
 = 0;

52 
FÏgs
 
	gfÜm_æags
;

53 
FÏgs
 
	g·¹s_æags
;

54 
	gsize
 = 0;

55 
SŒšg
 
	gm©”Ÿl
;

56 
	g¡d
::
veùÜ
<
MobProg
 *> 
mob´ogs
;

57 
FÏgs
 
	g´ogty³_æags
;

59 
»ad_mob´ogs
(
FILE
 *
å
);

61 
	g´iv©e
:

62 
MobePrÙÙy³
();

63 
MobePrÙÙy³
(const MobilePrototype&);

64 
	gMobePrÙÙy³
& 
	gİ”©Ü
=(cÚ¡ 
MobePrÙÙy³
&);

	@src/include/Note.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

4 
	~"PoŞed.hh
"

6 
	#NOTE_NOTE
 0

	)

7 
	#NOTE_IDEA
 1

	)

8 
	#NOTE_ROLEPLAY
 2

	)

9 
	#NOTE_IMMQUEST
 3

	)

10 
	#NOTE_CHANGES
 4

	)

11 
	#NOTE_PERSONAL
 5

	)

12 
	#NOTE_TRADE
 6

	)

14 
şass
 
	gNÙe
 :

15 
public
 
PoŞed
<
NÙe
>

17 
public
:

18 
NÙe
() {}

19 
vœtu®
 ~
NÙe
() {}

21 
NÙe
 * 
Ãxt
 = 
nuÎ±r
;

22 
	gty³
 = 0;

23 
SŒšg
 
	g£nd”
;

24 
SŒšg
 
	gd©e
;

25 
SŒšg
 
	gto_li¡
;

26 
SŒšg
 
	gsubjeù
;

27 
SŒšg
 
	g‹xt
;

28 
time_t
 
	gd©e_¡amp
 = 0;

30 
	g´iv©e
:

31 
NÙe
(const Note&);

32 
	gNÙe
& 
	gİ”©Ü
=(cÚ¡ 
NÙe
&);

35 
	sbßrd_šdex_¡ruù


37 cÚ¡ 
SŒšg
 
	mbßrd_hdr
;

38 
NÙe
 **
	mbßrd_li¡
;

39 cÚ¡ 
SŒšg
 
	mbßrd_shÜt
;

40 cÚ¡ 
SŒšg
 
	mbßrd_¶u¿l
;

41 cÚ¡ 
SŒšg
 
	mbßrd_lÚg
;

44 cÚ¡ 
¡d
::
veùÜ
<
bßrd_šdex_¡ruù
> 
bßrd_šdex
;

48 
NÙe
 *
Ãw_nÙe
();

49 
ä“_nÙe
(
NÙe
 *
nÙe
);

50 
SŒšg
 
fÜm©_¡ršg
ĞcÚ¡ SŒšg& 
Şd¡ršg
 );

51 
lßd_nÙes
();

	@src/include/Object.hh

1 #´agm¨
Úû


3 
	~"AùabË.hh
"

4 
	~"SŒšg.hh
"

5 
	~"FÏgs.hh
"

6 
	~"ObjeùV®ue.hh
"

7 
	~"PoŞed.hh
"

9 
şass
 
	gObjeùPrÙÙy³
;

10 
şass
 
	gRe£t
;

11 
şass
 
	gRoom
;

12 
şass
 
	gCh¬aù”
;

13 
şass
 
	gExŒaDesü
;

14 
Çme¥aû
 
	gafãù
 { 
şass
 
	gAfãù
; }

19 
şass
 
	gObjeù
 :

20 
public
 
PoŞed
<
Objeù
>,

21 
public
 
	gAùabË


23 
	gpublic
:

24 
Objeù
() {};

25 
Objeù
(
ObjeùPrÙÙy³
 *
p
è: 
pIndexD©a
(p) {}

26 
vœtu®
 ~
Objeù
();

28 
ObjeùPrÙÙy³
 * 
	gpIndexD©a
 = 
nuÎ±r
;

29 cÚ¡ 
Re£t
 * 
	g»£t
 = 
nuÎ±r
;

30 
Objeù
 * 
	gÃxt
 = 
nuÎ±r
;

31 
Objeù
 * 
	gÃxt_cÚ‹Á
 = 
nuÎ±r
;

32 
Objeù
 * 
	gš_obj
 = 
nuÎ±r
;

33 
Objeù
 * 
	gÚ
 = 
nuÎ±r
;

34 
Room
 * 
	gš_room
 = 
nuÎ±r
;

35 
Ch¬aù”
 * 
	gÿ¼›d_by
 = 
nuÎ±r
;

36 
Ch¬aù”
 * 
	gš_lock”
 = 
nuÎ±r
;

37 
Ch¬aù”
 * 
	gš_¡rÚgbox
 = 
nuÎ±r
;

38 
Objeù
 * 
	gcÚšs
 = 
nuÎ±r
;

39 
	gdÚ©ed
 = 0;

41 
SŒšg
 
	gÇme
;

42 
SŒšg
 
	gshÜt_desü
;

43 
SŒšg
 
	gdesütiÚ
;

44 
SŒšg
 
	gm©”Ÿl
;

45 
SŒšg
 
	gowÃr
;

46 
ExŒaDesü
 * 
	gexŒa_desü
 = 
nuÎ±r
;

47 
	g™em_ty³
 = 0;

48 
FÏgs
 
	gexŒa_æags
;

49 
FÏgs
 
	gw—r_æags
;

50 
ObjeùV®ue
 
	gv®ue
[5];

51 
	gweight
 = 0;

52 
	gco¡
 = 0;

53 
	gËv–
 = 0;

54 
	gcÚd™iÚ
 = 0;

55 
	gw—r_loc
 = 0;

56 
	gtim”
 = 0;

57 
	gş—n_tim”
 = 0;

59 
FÏgs
 
	gÿched_exŒa_æags
;

65 
	gafãù
::
Afãù
 * 
afãùed
 = 
nuÎ±r
;

66 
boŞ
 
	gafãùs_modif›d
 = 
çl£
;

68 
	gnum_£‰šgs
 = 0;

69 
Objeù
 * 
	ggems
 = 
nuÎ±r
;

70 
	gafãù
::
Afãù
 * 
gem_afãùed
 = 
nuÎ±r
;

72 
vœtu®
 cÚ¡ 
	g¡d
::
¡ršg
 
id’tif›r
(ècÚ¡ {  
this
->
Çme
; }

74 
	g´iv©e
:

75 
Objeù
(const Object&);

76 
	gObjeù
& 
	gİ”©Ü
=(cÚ¡ 
Objeù
&);

82 
	#CAN_WEAR
(
obj
, 
·¹
è((obj)->
w—r_æags
.
	`has
(Õ¬t)))

	)

83 
	#IS_OBJ_STAT
(
obj
, 
¡©
è(((obj)->
exŒa_æags
 + (obj)->
ÿched_exŒa_æags
).
	`has
((¡©)))

	)

84 
	#WEIGHT_MULT
(
obj
è((obj)->
™em_ty³
 =ğ
ITEM_CONTAINER
 ? \

85 (
obj
)->
v®ue
[4] : 100)

	)

87 
de¡roy_obj
Ğ
Objeù
 *
obj
);

88 
exŒaù_obj
Ğ
Objeù
 *
obj
 );

89 
unique_™em
(
Objeù
 *
™em
);

	@src/include/ObjectPrototype.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

4 
	~"FÏgs.hh
"

5 
	~"ObjeùV®ue.hh
"

6 
	~"Vnum.hh
"

7 
	~"Gud.hh
"

9 
şass
 
	gA»a
;

10 
şass
 
	gExŒaDesü
;

11 
Çme¥aû
 
	gafãù
 { 
şass
 
	gAfãù
; }

13 şas 
	cObjeùPrÙÙy³


15 
	mpublic
:

16 
ObjeùPrÙÙy³
(
A»a
&, cÚ¡ 
Vnum
&, 
FILE
 *);

17 
	mvœtu®
 ~
	$ObjeùPrÙÙy³
() {}

19 
A»a
& 
¬—
;

20 cÚ¡ 
Vnum
 
vnum
;

21 
ObjeùPrÙÙy³
 * 
Ãxt
 = 
nuÎ±r
;

22 
ExŒaDesü
 * 
exŒa_desü
 = 
nuÎ±r
;

23 
afãù
::
Afãù
 * 
afãùed
 = 
nuÎ±r
;

24 
afãù_checksum
 = 0;

25 
SŒšg
 
Çme
;

26 
SŒšg
 
shÜt_desü
;

27 
SŒšg
 
desütiÚ
;

28 
»£t_num
 = 0;

29 
SŒšg
 
m©”Ÿl
;

30 
™em_ty³
 = 0;

31 
FÏgs
 
exŒa_æags
;

32 
FÏgs
 
w—r_æags
;

33 
Ëv–
 = 0;

34 
cÚd™iÚ
 = 0;

35 
couÁ
 = 0;

36 
weight
 = 0;

37 
co¡
 = 0;

38 
ObjeùV®ue
 
v®ue
[5];

40 
num_£‰šgs
 = 0;

41 
Gud
 
gud
 = Gud::
nÚe
;

44 
´iv©e
:

45 
	`ObjeùPrÙÙy³
(cÚ¡ 
ObjeùPrÙÙy³
&);

46 
ObjeùPrÙÙy³
& 
İ”©Ü
=(const ObjectPrototype&);

47 
	}
};

	@src/include/ObjectValue.hh

1 #´agm¨
Úû


3 
	~"skl/Ty³.hh
"

4 
	~"Vnum.hh
"

5 
	~"FÏgs.hh
"

7 şas 
	cObjeùV®ue
 {

8 
	mpublic
:

9 
	$ObjeùV®ue
() {}

10 
ex¶ic™
 
	$ObjeùV®ue
(
v
è: 
	$_v®ue
(
v
è{
	}
}

12 
ex¶ic™
 
ObjeùV®ue
(cÚ¡ 
FÏgs
& 
v
);

13 
	$ObjeùV®ue
(cÚ¡ 
ObjeùV®ue
& 
v
è: 
	`_v®ue
(v.
_v®ue
), 
	$_as_æags
(
v
.
_as_æags
è{
	}
}

14 
	gvœtu®
 ~
	$ObjeùV®ue
(è{
	}
}

16 cÚ¡ 
	$v®ue
(ècÚ¡ {  
_v®ue
; 
	}
}

17 cÚ¡ 
FÏgs
 
	$æags
() const;

20 
İ”©Ü
 (ècÚ¡ {  
	`v®ue
(); 
	}
}

21 
İ”©Ü
 
	$FÏgs
() const;

22 
İ”©Ü
 
	$Vnum
(ècÚ¡ {  
	`Vnum
(
	`v®ue
()); 
	}
}

24 
	gObjeùV®ue
& 
	gİ”©Ü
=(
rhs
è{ 
this
->
_v®ue
 =„hs;  *
	gthis
; }

25 
	gObjeùV®ue
& 
	gİ”©Ü
=(cÚ¡ 
Vnum
& 
rhs
è{ 
this
->
_v®ue
 =„hs.
v®ue
();  *
	gthis
; }

26 
	gObjeùV®ue
& 
	gİ”©Ü
=(cÚ¡ 
FÏgs
& 
rhs
);

31 
	gObjeùV®ue
& 
	gİ”©Ü
=(cÚ¡ 
ObjeùV®ue
& 
rhs
) {

32 
_v®ue
 = 
rhs
._value;

33 
	g_as_æags
 = 
rhs
.
_as_æags
;

34  *
	gthis
;

37 
	gObjeùV®ue
& 
	gİ”©Ü
+=(
rhs
è{ *
this
 +ğ
ObjeùV®ue
Ôhs);  *
	gthis
; }

38 
	gObjeùV®ue
& 
	gİ”©Ü
+=(cÚ¡ 
FÏgs
& 
rhs
è{ *
this
 +ğ
ObjeùV®ue
Ôhs);  *
	gthis
; }

39 
	gObjeùV®ue
& 
	gİ”©Ü
+=(cÚ¡ 
ObjeùV®ue
 &
rhs
);

41 
	gObjeùV®ue
& 
	gİ”©Ü
-=(
rhs
è{ *
this
 -ğ
ObjeùV®ue
Ôhs);  *
	gthis
; }

42 
	gObjeùV®ue
& 
	gİ”©Ü
-=(cÚ¡ 
FÏgs
& 
rhs
è{ *
this
 -ğ
ObjeùV®ue
Ôhs);  *
	gthis
; }

43 
	gObjeùV®ue
& 
	gİ”©Ü
-=(cÚ¡ 
ObjeùV®ue
 &
rhs
);

45 
	gObjeùV®ue
& 
	gİ”©Ü
^=(cÚ¡ 
FÏgs
& 
rhs
);

47 
	gObjeùV®ue
& 
	gİ”©Ü
++(è{ ++
	g_v®ue
;  *
	gthis
; }

48 cÚ¡ 
ObjeùV®ue
 
	gİ”©Ü
++(è{ ObjeùV®u
cİy
(*
this
); ++
	g_v®ue
;  
	gcİy
; }

49 
	gObjeùV®ue
& 
	gİ”©Ü
--(è{ --
	g_v®ue
;  *
	gthis
; }

50 cÚ¡ 
ObjeùV®ue
 
	gİ”©Ü
--(è{ ObjeùV®u
cİy
(*
this
); --
	g_v®ue
;  
	gcİy
; }

52 cÚ¡ 
ObjeùV®ue
 
	gİ”©Ü
+(
	grhs
è{  ObjeùV®ue(*
this
è+ğ
rhs
; }

53 cÚ¡ 
ObjeùV®ue
 
	gİ”©Ü
+(cÚ¡ 
	gFÏgs
& 
	grhs
è{  ObjeùV®ue(*
this
è+ğ
rhs
; }

54 cÚ¡ 
ObjeùV®ue
 
	gİ”©Ü
+(cÚ¡ 
	gObjeùV®ue
& 
	grhs
è{  ObjeùV®ue(*
this
è+ğ
rhs
; }

56 cÚ¡ 
ObjeùV®ue
 
	gİ”©Ü
-(
	grhs
è{  ObjeùV®ue(*
this
è-ğ
rhs
; }

57 cÚ¡ 
ObjeùV®ue
 
	gİ”©Ü
-(cÚ¡ 
	gFÏgs
& 
	grhs
è{  ObjeùV®ue(*
this
è-ğ
rhs
; }

58 cÚ¡ 
ObjeùV®ue
 
	gİ”©Ü
-(cÚ¡ 
	gObjeùV®ue
& 
	grhs
è{  ObjeùV®ue(*
this
è-ğ
rhs
; }

60 
ä›nd
 
boŞ
 
	gİ”©Ü
=ğ(cÚ¡ 
ObjeùV®ue
&, cÚ¡ 
	gObjeùV®ue
&);

61 
ä›nd
 
boŞ
 
	gİ”©Ü
!ğ(cÚ¡ 
ObjeùV®ue
&, cÚ¡ 
	gObjeùV®ue
&);

65 
	g´iv©e
:

66 
_v®ue
 = 0;

67 
boŞ
 
	g_as_æags
 = 
çl£
;

70 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
ObjeùV®ue
& 
lhs
, cÚ¡ 
	gObjeùV®ue
& 
	grhs
) {

71  
	glhs
.
	g_v®ue
 =ğ
rhs
.
_v®ue
;

74 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
ObjeùV®ue
& 
lhs
, cÚ¡ 
	gObjeùV®ue
& 
	grhs
) {

75  !(
	glhs
 =ğ
rhs
);

	@src/include/Player.hh

1 #´agm¨
Úû


3 
	~<veùÜ
>

4 
	~<m­
>

5 
	~<£t
>

6 
	~"cÚ¡ªts.hh
"

7 
	~"SŒšg.hh
"

8 
	~"FÏgs.hh
"

9 
	~"skl/skl.hh
"

10 
	~"Vnum.hh
"

11 
	~"LoÿtiÚ.hh
"

16 şas 
	cPÏy”


18 
	mpublic
:

19 
PÏy”
(
Ch¬aù”
 &);

20 
	mvœtu®
 ~
	$PÏy”
() {}

22 
Ch¬aù”
 & 
ch
;

25 
id
 = 0;

26 
SŒšg
 
bufãr
;

27 
SŒšg
 
pwd
;

28 
SŒšg
 
bamfš
;

29 
SŒšg
 
bamfout
;

30 
SŒšg
 
gameš
;

31 
SŒšg
 
gameout
;

32 
SŒšg
 
afk
;

33 
SŒšg
 
t™Ë
;

34 
SŒšg
 
immÇme
;

35 
SŒšg
 
imm´efix
;

36 
time_t
 
Ï¡_nÙe
 = 0;

37 
time_t
 
Ï¡_id—
 = 0;

38 
time_t
 
Ï¡_rŞ•Ïy
 = 0;

39 
time_t
 
Ï¡_immque¡
 = 0;

40 
time_t
 
Ï¡_chªges
 = 0;

41 
time_t
 
Ï¡_³rsÚ®
 = 0;

42 
time_t
 
Ï¡_Œade
 = 0;

43 
Œašs_to_h™
 = 0;

44 
Œašs_to_mªa
 = 0;

45 
Œašs_to_¡am
 = 0;

46 
mud_exp
 = 0;

47 
pckls
 = 0;

48 
pckËd
 = 0;

49 
¬’akls
 = 0;

50 
¬’akËd
 = 0;

51 
pk¿nk
 = 0;

52 
Ï¡_Ëv–
 = 0;

53 
Ï¡_logoff
 = 0;

54 
¶ayed
 = 0;

55 
backup
 = 0;

56 
cÚd™iÚ
 [4] = {0
	}
};

57 
	g¡d
::
veùÜ
<> 
Ë¬Ãd
;

58 
	g¡d
::
veùÜ
<> 
evŞutiÚ
;

60 
Vnum
 
	gque¡_giv”
 = 0;

61 
	gque¡pošts
 = 0;

62 
	gque¡pošts_dÚ©ed
 = 0;

63 
	ggŞd_dÚ©ed
 = 0;

64 
	gÃxtque¡
 = 0;

65 
	gcouÁdown
 = 0;

66 
Vnum
 
	gque¡obj
 = 0;

67 
Vnum
 
	gque¡mob
 = 0;

68 
LoÿtiÚ
 
	gque¡loc
;

69 
	gque¡obf
 = 0;

71 
	gskÍošts
 = 0;

72 
Vnum
 
	gsque¡_giv”
 = 0;

73 
	gÃxtsque¡
 = 0;

74 
	gsqcouÁdown
 = 0;

75 
Objeù
 * 
	gsque¡obj
 = 
nuÎ±r
;

76 
Ch¬aù”
 * 
	gsque¡mob
 = 
nuÎ±r
;

77 
boŞ
 
	gsque¡objf
 = 
çl£
;

78 
boŞ
 
	gsque¡mobf
 = 
çl£
;

79 
LoÿtiÚ
 
	gsque¡loc1
;

80 
LoÿtiÚ
 
	gsque¡loc2
;

82 
	g¡d
::
veùÜ
<
boŞ
> 
group_known
;

83 
	grŞ•ošts
 = 0;

84 
	gpošts
 = 0;

85 
	gcÚfœm_d–‘e
 = 0;

86 
	g¡d
::
m­
<
SŒšg
, 
	gSŒšg
> 
	g®Ÿs
;

87 
	g¡d
::
veùÜ
<
SŒšg
> 
qu”y
;

88 
	g¡d
::
veùÜ
<
SŒšg
> 
ignÜe
;

89 
Ch¬aù”
 * 
	gsk–‘Ú
 = 
nuÎ±r
;

90 
Ch¬aù”
 * 
	gzomb›
 = 
nuÎ±r
;

91 
Ch¬aù”
 * 
	gw¿™h
 = 
nuÎ±r
;

92 
Ch¬aù”
 * 
	gg¬goyË
 = 
nuÎ±r
;

93 
	gcŞÜ
 [
MAX_COLORS
] = {0};

94 
	gbŞd
 [
MAX_COLORS
] = {0};

95 
FÏgs
 
	gcgroup_æags
;

96 
FÏgs
 
	g¶r_æags
;

97 
SŒšg
 
	g¿nk
;

98 
	gÏ¡cŞÜ
 [2] = {0};

99 
	gpktim”
 = 0;

100 
	gcomb©tim”
 = 0;

101 
SŒšg
 
	g¡©us
;

102 
SŒšg
 
	gde™y
;

103 
	g»mÜt_couÁ
 = 0;

104 
	gskl
::
ty³
 
exŒaşass
 [
MAX_EXTRACLASS_SLOTS
] = {
skl
::ty³::
unknown
};

105 
	g¿fãù
 [
MAX_RAFFECT_SLOTS
] = {0};

106 
Objeù
 * 
	glock”
 = 
nuÎ±r
;

107 
Objeù
 * 
	g¡rÚgbox
 = 
nuÎ±r
;

108 
SŒšg
 
	gema
;

109 
time_t
 
	gÏ¡_Éime
 = 0;

110 
time_t
 
	gÏ¡_§ved
 = 0;

111 
	gæag_th›f
 = 0;

112 
	gæag_kËr
 = 0;

113 
SŒšg
 
	gÏ¡_ls™e
;

114 
SŒšg
 
	gfšg”šfo
;

115 
SŒšg
 
	g¥ou£
;

116 
SŒšg
 
	g´İo£
;

117 
SŒšg
 
	gwhi¥”
;

118 
FÏgs
 
	gvideo_æags
;

119 
	gšg
 = 0;

120 
LoÿtiÚ
 
	gm¬k_room
;

121 
SŒšg
 
	gau¿
;

122 
Du–
 * 
	gdu–
 = 
nuÎ±r
;

123 
	gÏys
 = 0;

124 
	gÃxt_Ïy_couÁdown
 = 0;

125 
boŞ
 
	gçmŸr
 = 
çl£
;

126 
	g¡d
::
£t
<
SŒšg
> 
w¬p_locs
;

128 
	g´iv©e
:

129 
PÏy”
(const Player&);

130 
	gPÏy”
& 
	gİ”©Ü
=(cÚ¡ 
PÏy”
&);

133 
g‘_pc_id
();

136 
	#MEXP_TOTAL_NEWBIE
 0

	)

137 
	#MEXP_LEGACY_NEWBIE
 1

	)

138 
	#MEXP_LEGACY_OLDBIE
 2

	)

	@src/include/Pooled.hh

1 #´agm¨
Úû


3 
	~<¡ršg
>

4 
	~<veùÜ
>

5 
	~<ÿs£¹
>

17 
	g‹m¶©e
 <
şass
 
	gT
 > cÏs 
	cPoŞed


19 
	mpublic
:

20 
	$PoŞed
() {

23 
vœtu®
 ~
	$PoŞed
() {

25 
	}
}

27 
	$poŞ_ä“
() {

28  
	`ä“_li¡
().
	`size
();

29 
	}
}

31 & 
	$poŞ_®loÿ‹d
() {

32 
®loÿ‹d
;

33  
®loÿ‹d
;

34 
	}
}

36 
šlše
 *
İ”©Ü
 
	$Ãw
Ğ
size_t
 
¡AÎoÿ‹Block
) {

39 
	`as£¹
(
¡AÎoÿ‹Block
 =ğ(
T
));

41 ià(
T
::
	`ä“_li¡
().
	`size
() <= 0)

42 
T
::
	`®loc_Ãw
();

44 
T
* 
p
 = T::
	`ä“_li¡
().
	`back
();

45 
T
::
	`ä“_li¡
().
	`pİ_back
();

46  
p
;

47 
	}
}

49 
šlše
 
İ”©Ü
 
	$d–‘e
Ğ*
p
 ) {

51 
T
::
	`ä“_li¡
().
	`push_back
((T*)
p
);

52 
	}
}

56 
	$de¡roy
() {

58 autØ
fœ¡
 = 
T
::
	`ä“_li¡
().
	`begš
();

59 autØ
Ï¡
 = 
T
::
	`ä“_li¡
().
	`’d
();

61 
fœ¡
 !ğ
Ï¡
)

63 
T
* 
p
 = *
fœ¡
;

64 ++
fœ¡
;

65 ::
d–‘e
 
p
;

68 
T
::
	`ä“_li¡
().
	`”a£
();

69 
	}
}

71 
	g´iv©e
:

72 
¡d
::
veùÜ
<
T
* >& 
	$ä“_li¡
() {

73 
¡d
::
veùÜ
<
T
* > 
m_ä“
;

74  
m_ä“
;

75 
	}
}

77 
	$®loc_Ãw
() {

78 
	`poŞ_®loÿ‹d
()++;

80 
T
::
	`ä“_li¡
().
	`push_back
(::
Ãw
 T);

81 
	}
}

	@src/include/QuestArea.hh

1 #´agm¨
Úû


3 
	~"cÚ¡ªts.hh
"

5 
şass
 
	gA»a
;

6 
şass
 
	gRoom
;

8 şas 
	cQue¡A»a
 {

9 
	mpublic
:

10 
	$Que¡A»a
() {}

11 
vœtu®
 ~
	$Que¡A»a
(è{
	}
}

13 
š™
();

14 cÚ¡ 
	gA»a
& 
	$¬—
() const;

16 
boŞ
 
İ’
 = 
çl£
;

17 
boŞ
 
pk
 = 
Œue
;

18 
mš_Ëv–
 = 0;

19 
max_Ëv–
 = 
MAX_LEVEL
;

21 
Room
 *
¡¬Œoom
 = 
nuÎ±r
;

24 
´iv©e
:

25 
	`Que¡A»a
(cÚ¡ 
Que¡A»a
&);

26 
Que¡A»a
& 
İ”©Ü
=(const QuestArea&);

27 
	}
};

	@src/include/Reset.hh

1 #´agm¨
Úû


3 
	~<c¡dio
>

8 şas 
	cRe£t


10 
	mpublic
:

11 
Re£t
(
FILE
 *
å
);

12 
	mvœtu®
 ~
	$Re£t
() {}

14 
commªd
 = 0;

15 
¬g1
 = 0;

16 
¬g2
 = 0;

17 
¬g3
 = 0;

18 
¬g4
 = 0;

20 
´iv©e
:

21 
	`Re£t
();

22 
	`Re£t
(cÚ¡ 
Re£t
&);

23 
Re£t
& 
İ”©Ü
=(const Reset&);

24 
	}
};

	@src/include/Room.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

4 
	~"FÏgs.hh
"

5 
	~"LoÿtiÚ.hh
"

6 
	~"SeùÜ.hh
"

8 
şass
 
	gRoomPrÙÙy³
;

9 
şass
 
	gCh¬aù”
;

10 
şass
 
	gObjeù
;

11 
şass
 
	gEx™
;

12 
Çme¥aû
 
	gafãù
 { 
şass
 
	gAfãù
; }

14 şas 
	cRoom


16 
	mpublic
:

17 
Room
(
RoomPrÙÙy³
& 
p
);

18 
	mvœtu®
 ~
	$Room
() {}

20 
Ch¬aù”
 * 
³İË
 = 
nuÎ±r
;

21 
Objeù
 * 
cÚ‹Ás
 = 
nuÎ±r
;

22 
Ex™
 * 
ex™
 [6] = {
nuÎ±r
};

24 
	gafãù
::
Afãù
 * 
afãùed
 = 
nuÎ±r
;

25 
FÏgs
 
	gÿched_room_æags
 = 0;

27 
	glight
 = 0;

28 
	ghuÁ_id
 = 0;

29 
Room
 * 
	ghuÁ_Ãxt
 = 
nuÎ±r
;

30 
Room
 * 
	ghuÁ_back
 = 
nuÎ±r
;

33 
	gA»a
& 
	$¬—
() const;

34 cÚ¡ 
SŒšg
& 
	$Çme
() const;

35 cÚ¡ 
SŒšg
& 
	$desütiÚ
() const;

36 cÚ¡ 
ExŒaDesü
 *
	$exŒa_desü
() const;

37 cÚ¡ 
FÏgs
 
	$æags
() const;

38 
SeùÜ
 
	$£ùÜ_ty³
() const;

39 
	$gud
() const;

40 cÚ¡ 
SŒšg
& 
	$owÃr
() const;

41 cÚ¡ 
CÏn
 *
	$şª
() const;

42 
	$h—l_¿‹
() const;

43 
	$mªa_¿‹
() const;

44 cÚ¡ 
LoÿtiÚ
& 
	$‹Ë_de¡
() const;

46 
boŞ
 
	$is_Ú_m­
() const;

47 
boŞ
 
	$is_d¬k
() const;

48 
boŞ
 
	$is_v”y_d¬k
() const;

49 
boŞ
 
	$is_´iv©e
() const;

52 
	`add_ch¬
(
Ch¬aù”
 *
ch
);

53 
	`»move_ch¬
(
Ch¬aù”
 *
ch
);

55 
RoomPrÙÙy³
& 
´ÙÙy³
;

56 
FÏgs
 
room_æags
;

57 
LoÿtiÚ
 
loÿtiÚ
;

59 
´iv©e
:

60 
	`Room
(cÚ¡ 
Room
&);

61 
Room
& 
İ”©Ü
=(const Room&);

62 
	}
};

	@src/include/RoomID.hh

1 #´agm¨
Úû


3 
	~"deş¬e.hh
"

5 şas 
	cRoomID
 {

6 
	mpublic
:

7 
	$RoomID
(è: 
	`numb”_d©a
(-1), 
	$vnum_d©a
(0) {}

8 
	`RoomID
(cÚ¡ 
Vnum
& 
vnum
, 
numb”
 = 1);

9 
	`RoomID
(cÚ¡ 
SŒšg
& 
s
);

12 
boŞ
 
	$is_v®id
(ècÚ¡ {  !(
numb”_d©a
 < 0); 
	}
}

16 
	$to_št
() const {

17 ià(!
	`is_v®id
())

20 
»t
 = 
numb”_d©a
;

21 
»t
 <<ğ
	`num_b™s_vnum
();

22  
»t
 | 
vnum_d©a
;

23 
	}
}

25 cÚ¡ 
Vnum
 
	$g‘_vnum
() const;

26 cÚ¡ 
	$g‘_numb”
() const;

27 cÚ¡ 
SŒšg
 
	$to_¡ršg
(
boŞ
 
shÜt_loc
 = 
Œue
) const;

29 
	$RoomID
(cÚ¡ 
RoomID
& 
id
è: 
	`numb”_d©a
(id.
numb”_d©a
), 
	$vnum_d©a
(
id
.
vnum_d©a
è{
	}
}

30 
	gRoomID
& 
	gİ”©Ü
=(cÚ¡ 
RoomID
& 
id
) {

31 
numb”_d©a
 = 
id
.number_data;

32 
	gvnum_d©a
 = 
id
.
vnum_d©a
;

33  *
	gthis
;

36 
šlše
 
ä›nd
 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gRoomID
& 
	glhs
, cÚ¡ RoomID& 
	grhs
è{ †hs.
to_št
() <„hs.to_int(); }

37 
šlše
 
ä›nd
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
RoomID
& 
lhs
, cÚ¡ 
	gRoomID
& 
	grhs
è{  
	glhs
.
to_št
(è=ğ
rhs
.to_int(); }

38 
šlše
 
ä›nd
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
RoomID
& 
lhs
, cÚ¡ 
	gRoomID
& 
	grhs
è{  !(
	glhs
 =ğ
rhs
); }

40 
	gvœtu®
 ~
	$RoomID
(è{
	}
}

41 
	g´iv©e
:

42 
numb”_d©a
;

43 
	gvnum_d©a
;

47 
šlše
 
	$num_b™s_numb”
(ècÚ¡ {  14; 
	}
}

48 
šlše
 
	$num_b™s_vnum
(ècÚ¡ {  16; 
	}
}

	@src/include/RoomPrototype.hh

1 #´agm¨
Úû


3 
	~"afãù/Afãù.hh
"

4 
	~"deş¬e.hh
"

5 
	~"SŒšg.hh
"

6 
	~"FÏgs.hh
"

7 
	~"Vnum.hh
"

8 
	~"SeùÜ.hh
"

9 
	~"LoÿtiÚ.hh
"

11 şas 
	cRoomPrÙÙy³


13 
	mpublic
:

14 
RoomPrÙÙy³
(
A»a
&, cÚ¡ 
Vnum
&, 
FILE
 *);

15 
	mvœtu®
 ~
RoomPrÙÙy³
();

17 
	mA»a
& 
	m¬—
;

18 cÚ¡ 
Vnum
 
	mvnum
;

19 
SŒšg
 
	mÇme
;

20 
SŒšg
 
	mdesütiÚ
;

21 cÚ¡ 
LoÿtiÚ
 
	m‹Ë_de¡
;

22 
FÏgs
 
	mroom_æags
;

23 
SeùÜ
 
	m£ùÜ_ty³
;

24 
	mh—l_¿‹
 = 100;

25 
	mmªa_¿‹
 = 100;

26 
Gud
 
	mgud
 = Gud::
nÚe
;

28 
SŒšg
 
	mowÃr
 = "";

29 
CÏn
 * 
	mşª
 = 
nuÎ±r
;

30 
	mcouÁ
 = 0;

33 
ExŒaDesü
 * 
	mexŒa_desü
 = 
nuÎ±r
;

34 
Ex™PrÙÙy³
 * 
	mex™
 [6] = {
nuÎ±r
};

36 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
RoomPrÙÙy³
& 
rhs
) const {

37  
this
->
vnum
 =ğ
rhs
.vnum;

40 
	g´iv©e
:

41 
RoomPrÙÙy³
(const RoomPrototype&);

42 
	gRoomPrÙÙy³
& 
	gİ”©Ü
=(cÚ¡ 
RoomPrÙÙy³
&);

	@src/include/Sector.hh

1 #´agm¨
Úû


5 şas 
	cSeùÜ
 {

6 
	mšside
 = 0,

7 
	mc™y
 = 1,

8 
	mf›ld
 = 2,

9 
	mfÜe¡_¥¬£
 = 3,

10 
	mhls
 = 4,

11 
	mmouÁaš
 = 5,

12 
	mw©”_swim
 = 6,

13 
	mw©”_noswim
 = 7,

14 
	mrßd
 = 8,

15 
	maœ
 = 9,

16 
	mde£¹
 = 10,

17 
	mfÜe¡_medium
 = 11,

18 
	mfÜe¡_d’£
 = 12,

19 
	m¬’a
 = 20,

20 
	mşª¬’a
 = 21,

22 
	m¬—_’Œªû
 = 253,

23 
	munknown
 = 254,

24 
	mnÚe
 = 255

	@src/include/Shop.hh

1 #´agm¨
Úû


3 
	~"cÚ¡ªts.hh
"

4 
	~<c¡dio
>

6 
	#MAX_TRADE
 5

	)

8 şas 
	cShİ


10 
	mpublic
:

11 
Shİ
(
FILE
 *
å
);

12 
	mvœtu®
 ~
	$Shİ
() {}

14 
boŞ
 
	$is_que¡shİ
(ècÚ¡ {  
buy_ty³
[0] =ğ
ITEM_QUESTSHOP
; 
	}
}

16 
	gbuy_ty³
 [
MAX_TRADE
] = {0};

17 
	g´of™_buy
 = 0;

18 
	g´of™_£Î
 = 0;

19 
	gİ’_hour
 = 0;

20 
	gşo£_hour
 = 0;

22 
	g´iv©e
:

23 
Shİ
(const Shop&);

24 
	gShİ
& 
	gİ”©Ü
=(cÚ¡ 
Shİ
&);

	@src/include/Social.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

8 şas 
	cSocŸl


10 
	mpublic
:

11 
	$SocŸl
() {}

12 
vœtu®
 ~
	$SocŸl
(è{
	}
}

14 
SŒšg
 
Çme
;

15 
SŒšg
 
	gch¬_no_¬g
;

16 
SŒšg
 
	gÙh”s_no_¬g
;

17 
SŒšg
 
	gch¬_found
;

18 
SŒšg
 
	gÙh”s_found
;

19 
SŒšg
 
	gviù_found
;

23 
SŒšg
 
	gch¬_auto
;

24 
SŒšg
 
	gÙh”s_auto
;

25 
SocŸl
 * 
	g´evious
 = 
nuÎ±r
;

26 
SocŸl
 * 
	gÃxt
 = 
nuÎ±r
;

28 
	g´iv©e
:

29 
SocŸl
(const Social&);

30 
	gSocŸl
& 
	gİ”©Ü
=(cÚ¡ 
SocŸl
&);

	@src/include/StoredPlayer.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

5 şas 
	cStÜedPÏy”


7 
	mpublic
:

8 
	$StÜedPÏy”
() {}

9 
vœtu®
 ~
	$StÜedPÏy”
(è{
	}
}

11 
SŒšg
 
Çme
;

12 
SŒšg
 
	gby_who
;

13 
SŒšg
 
	gd©e
;

15 
StÜedPÏy”
 *
	gÃxt
 = 
nuÎ±r
;

16 
StÜedPÏy”
 *
	g´evious
 = 
nuÎ±r
;

18 
	g´iv©e
:

19 
StÜedPÏy”
(const StoredPlayer&);

20 
	gStÜedPÏy”
& 
	gİ”©Ü
=(cÚ¡ 
StÜedPÏy”
&);

	@src/include/String.hh

1 #´agm¨
Úû


3 
	~<¡ršg
>

4 
	~"AùabË.hh
"

6 
şass
 
	gSŒšg
: 
public
 
¡d
::
¡ršg
,…ubliø
	gAùabË
 {

7 
	gpublic
:

8 
SŒšg
(è: 
¡d
::
¡ršg
() {};

9 
SŒšg
(cÚ¡ *
c_¡r
è: 
¡d
::
¡ršg
(c_¡¸=ğ
nuÎ±r
 ? "" : c_str) {};

10 
SŒšg
(cÚ¡ 
¡d
::
¡ršg
 &
s_¡r
) : std::string(s_str) {};

11 
SŒšg
(cÚ¡ SŒšg &
Çme
è: 
¡d
::
¡ršg
(name) {};

13 
	gvœtu®
 ~
SŒšg
() {}

15 
	gSŒšg
& 
	gİ”©Ü
=(cÚ¡ 
ch
) {

16 
¡d
::
¡ršg
::
İ”©Ü
=(
ch
);

17  *
	gthis
;

20 
	gSŒšg
& 
	gİ”©Ü
=(cÚ¡ 
SŒšg
& 
Çme
) {

21 
¡d
::
¡ršg
::
İ”©Ü
=(
Çme
);

22  *
	gthis
;

26 
ä›nd
 
boŞ
 
	gİ”©Ü
=ğ(cÚ¡ 
SŒšg
 &, cÚ¡ 
	gSŒšg
 &);

27 
ä›nd
 
boŞ
 
	gİ”©Ü
=ğ(cÚ¡ 
SŒšg
 &, const *);

28 
ä›nd
 
boŞ
 
	gİ”©Ü
!ğ(cÚ¡ 
SŒšg
 &, cÚ¡ 
	gSŒšg
 &);

29 
ä›nd
 
boŞ
 
	gİ”©Ü
!ğ(cÚ¡ 
SŒšg
 &, const *);

33 
	g¡d
::
size_t
 
fšd
(cÚ¡ 
SŒšg
& 
¡r
, 
¡d
::size_ˆ
¡¬t_pos
 = 0) const;

34 
	g¡d
::
size_t
 
fšd_Áh
(
¡d
::size_ˆ
Áh
, cÚ¡ 
SŒšg
& 
¡r
, std::size_ˆ
¡¬t_pos
 = 0) const;

36 
boŞ
 
has_´efix
(cÚ¡ 
SŒšg
& 
¡r
, 
¡d
::
size_t
 
mš_ch¬s
 = 1) const;

37 
boŞ
 
is_´efix_of
(cÚ¡ 
SŒšg
& 
¡r
, 
¡d
::
size_t
 
mš_ch¬s
 = 1) const;

38 
boŞ
 
has_šfix
(cÚ¡ 
SŒšg
& 
¡r
, 
¡d
::
size_t
 
mš_ch¬s
 = 1) const;

39 
boŞ
 
is_šfix_of
(cÚ¡ 
SŒšg
& 
¡r
, 
¡d
::
size_t
 
mš_ch¬s
 = 1) const;

40 
boŞ
 
has_suffix
(cÚ¡ 
SŒšg
& 
¡r
, 
¡d
::
size_t
 
mš_ch¬s
 = 1) const;

41 
boŞ
 
is_suffix_of
(cÚ¡ 
SŒšg
& 
¡r
, 
¡d
::
size_t
 
mš_ch¬s
 = 1) const;

43 
boŞ
 
has_wÜds
(cÚ¡ 
SŒšg
& 
wÜdli¡
, boŞ 
exaù
 = 
çl£
) const;

44 
boŞ
 
has_exaù_wÜds
(cÚ¡ 
SŒšg
& 
wÜdli¡
) const;

47 
boŞ
 
is_numb”
() const;

50 cÚ¡ 
SŒšg
 
sub¡r
(
¡d
::
size_t
 
pos
 = 0, std::size_ˆ
couÁ
 = 
Åos
) const;

53 cÚ¡ 
SŒšg
 
ÿp™®ize
() const;

54 cÚ¡ 
SŒšg
 
uµ”ÿ£
() const;

55 cÚ¡ 
SŒšg
 
low”ÿ£
() const;

56 cÚ¡ 
SŒšg
 
uncŞÜ
() const;

59 cÚ¡ 
SŒšg
 
l¡r
(cÚ¡ SŒšg& 
ch¬s
 = " \t\n\r") const;

60 cÚ¡ 
SŒšg
 
r¡r
(cÚ¡ SŒšg& 
ch¬s
 = " \t\n\r") const;

61 cÚ¡ 
SŒšg
 
¡r
(cÚ¡ SŒšg& 
ch¬s
 = " \t\n\r") const;

66 cÚ¡ 
SŒšg
 
l¥l™
(cÚ¡ SŒšg& 
ch¬s
 = " ") const;

67 cÚ¡ 
SŒšg
 
r¥l™
(cÚ¡ SŒšg& 
ch¬s
 = " ") const;

68 cÚ¡ 
SŒšg
 
l¥l™
(SŒšg& 
wÜd
, cÚ¡ SŒšg& 
ch¬s
 = " ") const;

69 cÚ¡ 
SŒšg
 
r¥l™
(SŒšg& 
wÜd
, cÚ¡ SŒšg& 
ch¬s
 = " ") const;

72 
	gSŒšg
& 
”a£
 (
size_t
 
pos
 = 0, size_ˆ
Ën
 = 
Åos
);

75 cÚ¡ 
SŒšg
 
»¶aû
(cÚ¡ SŒšg& 
wh©
, cÚ¡ SŒšg& 
w™h
, 
times
 = -1) const;

78 cÚ¡ 
SŒšg
 
š£¹
(cÚ¡ SŒšg& 
wh©
, 
¡d
::
size_t
 
pos
) const;

81 cÚ¡ 
SŒšg
 
ûÁ”
(
¡d
::
size_t
 
tÙ®_Ën
) const;

84 
vœtu®
 cÚ¡ 
	g¡d
::
¡ršg
 
id’tif›r
(ècÚ¡ {  *
this
; }

86 
	g´iv©e
:

88 
SŒšg
(
¡d
::
nuÎ±r_t
);

89 
	gSŒšg
& 
	gİ”©Ü
=(
¡d
::
nuÎ±r_t
);

90 #ifdeà
__şªg__


92 
ä›nd
 
boŞ
 
	gİ”©Ü
=ğ(cÚ¡ 
SŒšg
 &, 
	g¡d
::
nuÎ±r_t
èğ
d–‘e
;

93 
ä›nd
 
boŞ
 
	gİ”©Ü
!ğ(cÚ¡ 
SŒšg
 &, 
	g¡d
::
nuÎ±r_t
èğ
d–‘e
;

98 
	~<c¡dlib
>

99 
	~<c¡ršg
>

101 
šlše
 *
	$¡rÿt
(*
de¡
, cÚ¡ 
SŒšg
& 
¤c
) {

102  
¡d
::
	`¡rÿt
(
de¡
, 
¤c
.
	`c_¡r
());

103 
	}
}

105 
šlše
 *
	$¡ºÿt
(*
de¡
, cÚ¡ 
SŒšg
& 
¤c
, 
size_t
 
n
) {

106  
¡d
::
	`¡ºÿt
(
de¡
, 
¤c
.
	`c_¡r
(), 
n
);

107 
	}
}

109 
šlše
 *
	$¡rıy
(*
de¡
, cÚ¡ 
SŒšg
& 
¤c
) {

110  
¡d
::
	`¡rıy
(
de¡
, 
¤c
.
	`c_¡r
());

111 
	}
}

113 
šlše
 *
	$¡ºıy
(*
de¡
, cÚ¡ 
SŒšg
& 
¤c
, 
size_t
 
n
) {

114  
¡d
::
	`¡ºıy
(
de¡
, 
¤c
.
	`c_¡r
(), 
n
);

115 
	}
}

117 
šlše
 
size_t
 
	$¡¾’
(cÚ¡ 
SŒšg
& 
¡r
) {

118  
¡r
.
	`size
();

119 
	}
}

121 
šlše
 cÚ¡ *
	$¡rchr
(cÚ¡ 
SŒšg
& 
¡r
, 
ch
) {

122  
¡d
::
	`¡rchr
(
¡r
.
	`c_¡r
(), 
ch
);

123 
	}
}

125 
šlše
 cÚ¡ *
	$¡r¡r
(cÚ¡ 
SŒšg
& 
a¡r
, cÚ¡ SŒšg& 
b¡r
) {

126  
¡d
::
	`¡r¡r
(
a¡r
.
	`c_¡r
(), 
b¡r
.c_str());

127 
	}
}

129 
šlše
 *
	$¡r¡r
(*
a¡r
, cÚ¡ 
SŒšg
& 
b¡r
) {

130  
¡d
::
	`¡r¡r
(
a¡r
, 
b¡r
.
	`c_¡r
());

131 
	}
}

133 
šlše
 
	$¡rcmp
(cÚ¡ 
SŒšg
& 
a¡r
, cÚ¡ SŒšg& 
b¡r
) {

134  
¡d
::
	`¡rcmp
(
a¡r
.
	`c_¡r
(), 
b¡r
.c_str());

135 
	}
}

137 
šlše
 
	$¡ºcmp
(cÚ¡ 
SŒšg
& 
a¡r
, cÚ¡ SŒšg& 
b¡r
, 
size_t
 
n
) {

138  
¡d
::
	`¡ºcmp
(
a¡r
.
	`c_¡r
(), 
b¡r
.c_¡r(), 
n
);

139 
	}
}

141 
šlše
 
	$¡rÿ£cmp
(cÚ¡ 
SŒšg
& 
a¡r
, cÚ¡ SŒšg& 
b¡r
) {

142  
	`¡rÿ£cmp
(
a¡r
.
	`c_¡r
(), 
b¡r
.c_str());

143 
	}
}

145 
šlše
 
	$©oi
(cÚ¡ 
SŒšg
& 
a¡r
) {

146  
	`©oi
(
a¡r
.
	`c_¡r
());

147 
	}
}

	@src/include/Tail.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

4 
	~"FÏgs.hh
"

6 
şass
 
	gCh¬aù”
;

8 şas 
	cTa


10 
	mpublic
:

11 
	$Ta
() {}

12 
vœtu®
 ~
	$Ta
(è{
	}
}

14 
Ch¬aù”
 * 
ed_by
 = 
nuÎ±r
;

15 
SŒšg
 
	g”_Çme
;

16 
FÏgs
 
	gæags
;

17 
Ta
 * 
	gÃxt
 = 
nuÎ±r
;

19 
	g´iv©e
:

20 
Ta
(const Tail&);

21 
	gTa
& 
	gİ”©Ü
=(cÚ¡ 
Ta
&);

27 
	#TAIL_NONE
 
FÏgs
::
nÚe


	)

28 
	#TAIL_ACT
 
FÏgs
::
A


	)

29 
	#TAIL_ALL
 
TAIL_ACT


	)

	@src/include/Vnum.hh

1 #´agm¨
Úû


9 şas 
	cVnum
 {

10 
	mpublic
:

11 
	$Vnum
(
v
è: 
	$_v®ue
(
v
) {}

13 
vœtu®
 ~
	$Vnum
(è{
	}
}

14 
	$Vnum
(cÚ¡ 
Vnum
& 
v
è: 
	$_v®ue
(
v
.
_v®ue
è{
	}
}

15 
Vnum
& 
İ”©Ü
=(cÚ¡ Vnum& 
v
è{ 
_v®ue
 = v._v®ue;  *
	gthis
; }

17 
	$v®ue
(ècÚ¡ {  
_v®ue
; 
	}
}

19 
šlše
 
ä›nd
 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gVnum
& 
	glhs
, cÚ¡ Vnum& 
	grhs
è{ †hs.
	g_v®ue
 <„hs._value; }

20 
šlše
 
ä›nd
 
boŞ
 
	gİ”©Ü
>(cÚ¡ 
	gVnum
& 
	glhs
, cÚ¡ Vnum& 
	grhs
) { „hs <†hs; }

21 
šlše
 
ä›nd
 
boŞ
 
	gİ”©Ü
<=(cÚ¡ 
Vnum
& 
lhs
, cÚ¡ 
	gVnum
& 
	grhs
è{  !(
	glhs
 >„hs); }

22 
šlše
 
ä›nd
 
boŞ
 
	gİ”©Ü
>=(cÚ¡ 
Vnum
& 
lhs
, cÚ¡ 
	gVnum
& 
	grhs
è{  !(
	glhs
 <„hs); }

23 
šlše
 
ä›nd
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Vnum
& 
lhs
, cÚ¡ 
	gVnum
& 
	grhs
è{  
	glhs
.
	g_v®ue
 =ğ
rhs
.
_v®ue
; }

24 
šlše
 
ä›nd
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
Vnum
& 
lhs
, cÚ¡ 
	gVnum
& 
	grhs
è{  !(
	glhs
 =ğ
rhs
); }

26 
	g´iv©e
:

27 
_v®ue
 = 0;

	@src/include/War.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

5 şas 
	cW¬


7 
	mpublic
:

8 şas 
	cOµÚ’t


10 
public
:

11 
OµÚ’t
() {}

12 
vœtu®
 ~
OµÚ’t
() {}

14 
SŒšg
 
Çme
;

15 
SŒšg
 
	mşªÇme
;

16 
boŞ
 
	mšw¬
 = 
çl£
;

17 
	m¡¬t_scÜe
 = 0;

18 
	mfš®_scÜe
 = 0;

20 
OµÚ’t
 * 
	mÃxt
 = 
nuÎ±r
;

22 
	m´iv©e
:

23 
OµÚ’t
(const Opponent&);

24 
	mOµÚ’t
& 
	mİ”©Ü
=(cÚ¡ 
OµÚ’t
&);

27 şas 
	cEv’t


29 
	gpublic
:

30 
Ev’t
() {}

31 
vœtu®
 ~
Ev’t
() {}

33 
ty³
 = 0;

34 
SŒšg
 
	ga¡r
;

35 
SŒšg
 
	gb¡r
;

36 
	gnumb”
 = 0;

37 
time_t
 
	gtime
 = 0;

39 
Ev’t
 * 
	gÃxt
 = 
nuÎ±r
;

41 
	g´iv©e
:

42 
Ev’t
(const Event&);

43 
	gEv’t
& 
	gİ”©Ü
=(cÚ¡ 
Ev’t
&);

46 
W¬
();

47 
	gvœtu®
 ~
W¬
();

49 
	gW¬
::
OµÚ’t
 * 
ch®
[4] = {
nuÎ±r
};

50 
	gW¬
::
OµÚ’t
 * 
def
[4] = {
nuÎ±r
};

51 
	gW¬
::
Ev’t
 * 
ev’ts
 = 
nuÎ±r
;

53 
boŞ
 
	gÚgošg
 = 
çl£
;

55 
W¬
 * 
	g´evious
 = 
nuÎ±r
;

56 
W¬
 * 
	gÃxt
 = 
nuÎ±r
;

58 
	g´iv©e
:

59 
W¬
(const War&);

60 
	gW¬
& 
	gİ”©Ü
=(cÚ¡ 
W¬
&);

	@src/include/Weather.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

5 
şass
 
	gGameTime
;

7 şas 
	cW—th”


9 
	mpublic
:

10 
W—th”
(cÚ¡ 
GameTime
& 
t
);

11 
	mvœtu®
 ~
	$W—th”
() {}

13 
	`upd©e
();

14 cÚ¡ 
SŒšg
 
	$desüibe
() const;

16 
	eSky
 {

17 
CloudËss
,

18 
Cloudy
,

19 
Raššg
,

20 
LighŠšg
,

21 
	}
};

23 
	gmmhg
 = 960;

24 
	gchªge
 = 0;

25 
Sky
 
	gsky
 = 
CloudËss
;

27 
	g´iv©e
:

28 
W—th”
(const Weather&);

29 
	gW—th”
& 
	gİ”©Ü
=(cÚ¡ 
W—th”
&);

31 cÚ¡ 
	gGameTime
& 
	gtime
;

	@src/include/World.hh

1 #´agm¨
Úû


3 
	~<veùÜ
>

4 
	~<m­
>

6 
	~"GameTime.hh
"

7 
	~"W—th”.hh
"

8 
	~"Que¡A»a.hh
"

9 
	~"wÜldm­/QuadŒ“.hh
"

10 
	~"wÜldm­/WÜldm­.hh
"

11 
	~"G¬bageCŞËùšgLi¡.hh
"

12 
	~"Vnum.hh
"

14 
şass
 
	gA»a
;

15 
şass
 
	gCh¬aù”
;

16 
şass
 
	gPÏy”
;

17 
şass
 
	gObjeù
;

18 
şass
 
	gRoom
;

19 
şass
 
	gObjeùPrÙÙy³
;

20 
şass
 
	gMobePrÙÙy³
;

21 
şass
 
	gRoomPrÙÙy³
;

22 
şass
 
	gGame
;

23 
şass
 
	gVnum
;

24 
şass
 
	gLoÿtiÚ
;

27 
	sVnumRªge
 {

28 
VnumRªge
(
Vnum
 
mn
, Vnum 
mx
è: 
mš
(mn), 
max
(mx) {}

29 
šlše
 
ä›nd
 
boŞ
 
	mİ”©Ü
<(cÚ¡ 
	mVnumRªge
& 
	mlhs
, cÚ¡ VnumRªge& 
	mrhs
è{ †hs.
	mmax
 <„hs.
	mmš
; }

30 
Vnum
 
	mmš
, 
	mmax
;

33 şas 
	cWÜld


35 
	mpublic
:

36 
vœtu®
 ~
WÜld
();

38 
upd©e
();

40 
GameTime
 
	mtime
;

41 
W—th”
 
	mw—th”
;

42 
Que¡A»a
 
	mque¡
;

43 
	mG¬bageCŞËùšgLi¡
<
	mCh¬aù”
 *> 
	mch¬_li¡
;

44 
Objeù
 *
	mobjeù_li¡
 = 
nuÎ±r
;

46 
Objeù
 *
	mdÚ©iÚ_p™
 = 
nuÎ±r
;;

48 
	m¡d
::
m­
<
VnumRªge
, 
	mA»a
 *> 
	m¬—s
;

50 
A»a
 *
	$g‘_¬—
(cÚ¡ 
Vnum
&) const;

51 
boŞ
 
	$v®id
() const {

53 
ov”wÜld
.
	`height
() > 0

54 && 
ov”wÜld
.
	`width
() > 0

58 
wÜldm­
::
WÜldm­
 
ov”wÜld
;

59 
wÜldm­
::
QuadŒ“
<
Room
> 
m­Œ“
;

61 
	`g‘_mšim­
(
Ch¬aù”
 *
ch
, 
¡d
::
veùÜ
<
SŒšg
>& 
v
) const;

63 
ObjeùPrÙÙy³
 *
	`g‘_obj_´ÙÙy³
(cÚ¡ 
Vnum
&);

64 
MobePrÙÙy³
 *
	`g‘_mob_´ÙÙy³
(cÚ¡ 
Vnum
&);

65 
RoomPrÙÙy³
 *
	`g‘_room_´ÙÙy³
(cÚ¡ 
Vnum
&);

66 
Room
 *
	`g‘_room
(cÚ¡ 
LoÿtiÚ
&);

68 
	`add_ch¬
(
Ch¬aù”
 *);

69 
	`»move_ch¬
(
Ch¬aù”
 *);

71 
	`lßd_¬—s
();

72 
	`ü—‹_rooms
();

73 
	`ü—‹_ex™s
();

75 
´iv©e
:

76 
	`WÜld
();

77 
	`WÜld
(cÚ¡ 
WÜld
&);

78 
WÜld
& 
İ”©Ü
=(const World&);

80 
ä›nd
 
şass
 
Game
;

81 
	}
};

	@src/include/act.hh

1 #´agm¨
Úû


3 
	~"cÚ¡ªts.hh
"

4 
	~<c¡ddef
>

6 
şass
 
	gSŒšg
;

7 
şass
 
	gAùabË
;

8 
şass
 
	gCh¬aù”
;

9 
şass
 
	gObjeù
;

10 
şass
 
	gRoom
;

14 
aù_·r£
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
,

15 cÚ¡ 
Ch¬aù”
 *
vch
, cÚ¡ Ch¬aù” *
vch2
,

16 cÚ¡ 
SŒšg
 *
¡r1
, cÚ¡ SŒšg *
¡r2
,

17 cÚ¡ 
Objeù
 *
obj1
, cÚ¡ Objeù *
obj2
,

18 
ty³
, 
mš_pos
, 
boŞ
 
ûnsÜ
);

21 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, cÚ¡ 
AùabË
* 
¬g1
, cÚ¡ AùabË* 
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

22 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, cÚ¡ 
AùabË
* 
¬g1
, cÚ¡ AùabË& 
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

23 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, cÚ¡ 
AùabË
& 
¬g1
, cÚ¡ AùabË* 
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

24 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, cÚ¡ 
AùabË
& 
¬g1
, cÚ¡ AùabË& 
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

26 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, cÚ¡ 
AùabË
* 
¬g1
, cÚ¡ *
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

27 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, cÚ¡ 
AùabË
* 
¬g1
, 
¡d
::
nuÎ±r_t
 
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

28 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, cÚ¡ *
¬g1
, cÚ¡ 
AùabË
* 
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

29 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, 
¡d
::
nuÎ±r_t
 
¬g1
, cÚ¡ 
AùabË
* 
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

31 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, cÚ¡ 
AùabË
& 
¬g1
, cÚ¡ *
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

32 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, cÚ¡ 
AùabË
& 
¬g1
, 
¡d
::
nuÎ±r_t
 
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

33 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, cÚ¡ *
¬g1
, cÚ¡ 
AùabË
& 
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

34 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, 
¡d
::
nuÎ±r_t
 
¬g1
, cÚ¡ 
AùabË
& 
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

36 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, cÚ¡ *
¬g1
, cÚ¡ *
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

37 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, cÚ¡ *
¬g1
, 
¡d
::
nuÎ±r_t
 
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

38 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, 
¡d
::
nuÎ±r_t
 
¬g1
, cÚ¡ *
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

39 
aù
(cÚ¡ 
SŒšg
& 
fÜm©
, 
Ch¬aù”
 *
ch
, 
¡d
::
nuÎ±r_t
 
¬g1
, std::nuÎ±r_ˆ
¬g2
, 
ty³
, 
mš_pos
 = 
POS_RESTING
, 
boŞ
 
ûnsÜ
 = 
çl£
, 
Room
 *
room
 = 
nuÎ±r
);

	@src/include/affect/Affect.hh

1 #´agm¨
Úû


3 
	~<m­
>

5 
	~"Ty³.hh
"

9 
	~"PoŞed.hh
"

10 
	~"FÏgs.hh
"

11 
	~"SŒšg.hh
"

13 
şass
 
	gCh¬aù”
;

14 
şass
 
	gObjeù
;

15 
şass
 
	gRoom
;

17 
Çme¥aû
 
	gafãù
 {

22 
şass
 
	gAfãù
 :

23 
public
 
PoŞed
<
Afãù
>

25 
public
:

28 
Afãù
 * 
Ãxt
 = 
nuÎ±r
;

29 
Afãù
 * 
	g´ev
 = 
nuÎ±r
;

30 
boŞ
 
	gm¬k
 = 
çl£
;

33 
	gwh”e
 = 0;

34 ::
afãù
::
ty³
y³ = ::afãù::ty³::
nÚe
;

35 
	gËv–
 = 0;

36 
	gdu¿tiÚ
 = 0;

37 
	gloÿtiÚ
 = 0;

38 
	gmodif›r
 = 0;

39 
	g_b™veùÜ
 = 0;

40 
	gevŞutiÚ
 = 0;

41 
boŞ
 
	g³rmª’t
 = 
çl£
;

43 cÚ¡ 
FÏgs
 
b™veùÜ
(ècÚ¡ {  FÏgs(
_b™veùÜ
); }

44 
b™veùÜ
(cÚ¡ 
FÏgs
& 
f
è{ 
	g_b™veùÜ
 = f.
to_ulÚg
(); }

46 } 
__©Œibu‹__
((
·cked
, 
®igÃd
(1)));

49 
	#TO_AFFECTS
 0

	)

50 
	#TO_OBJECT
 1

51 
	#TO_DEFENSE
 2

	)

52 
	#TO_WEAPON
 5

	)

54 
	#TO_ROOMFLAGS
 6

	)

55 
	#TO_HPREGEN
 7

	)

56 
	#TO_MPREGEN
 8

	)

59 
	#TO_ABSORB
 20

	)

60 
	#TO_IMMUNE
 21

	)

61 
	#TO_RESIST
 22

	)

62 
	#TO_VULN
 23

	)

64 
	sbË_’Œy


66 
SŒšg
 
	gÇme
;

67 
SŒšg
 
	gmsg_off
;

68 
SŒšg
 
	gmsg_room
;

69 
SŒšg
 
	gmsg_obj
;

72 cÚ¡ 
¡d
::
m­
<::
afãù
::
ty³
, cÚ¡ 
bË_’Œy
> 
afãù_bË
;

73 cÚ¡ 
	gbË_’Œy
& 
lookup
(::
afãù
::
ty³
ype);

74 cÚ¡ ::
afãù
::
ty³
 
lookup
(cÚ¡ 
SŒšg
& 
Çme
);

78 (*
	gafãù_â
)(
	tAfãù
 *
	tnode
, *
	td©a
);

79 (*
	gowÃr_modif›r_â
)(*
	towÃr
, cÚ¡ 
	tAfãù
 *
	t·f
, 
	tboŞ
 
	tfAdd
);

81 
	sâ_·¿ms
 {

82 *
	gowÃr
;

84 
owÃr_modif›r_â
 
	gmodif›r
;

85 *
	gd©a
;

86 } 
	tafãù_â_·¿ms
;

89 
	sâ_d©a_cÚš”_ty³
 {

90 ::
afãù
::
ty³
ype;

94 (*
	gcom·¿tÜ
)(cÚ¡ 
	tAfãù
 *
	tlhs
, cÚ¡ Afãù *
	trhs
);

97 
com·¿tÜ_m¬k
 ( cÚ¡ 
Afãù
 *
lhs
, cÚ¡ Afãù *
rhs
 );

98 
com·¿tÜ_du¿tiÚ
 ( cÚ¡ 
Afãù
 *
lhs
, cÚ¡ Afãù *
rhs
 );

99 
com·¿tÜ_ty³
 ( cÚ¡ 
Afãù
 *
lhs
, cÚ¡ Afãù *
rhs
 );

100 
com·¿tÜ_³rmª’t
 ( cÚ¡ 
Afãù
 *
lhs
, cÚ¡ Afãù *
rhs
 );

103 
â_çde_¥–l
 ( 
Afãù
 *
node
, *
d©a
 );

104 
â_£t_Ëv–
 ( 
Afãù
 *
node
, *
d©a
 );

107 
upd©e
 ( 
Afãù
 *
·f
, cÚ¡ Afãù *
aff_‹m¶©e
 );

108 
sw­
 ( 
Afãù
 *
a
, Afãù *
b
 );

109 
checksum
 ( cÚ¡ 
Afãù
 *
·f
 );

110 
boŞ
 
·r£_æags
 ( 
Ë‰”
, 
Afãù
 *
·f
, 
FÏgs
& 
b™veùÜ
 );

111 
SŒšg
 
´št_ÿche
 ( 
Ch¬aù”
 *
ch
 );

112 
boŞ
 
š_ÿche
 ( cÚ¡ 
Ch¬aù”
 *
ch
, ::
afãù
::
ty³
ype );

113 
upd©e_ÿche
 ( 
Ch¬aù”
 *
ch
, ::
afãù
::
ty³
y³, 
boŞ
 
fAdd
 );

114 
ä“_ÿche
 ( 
Ch¬aù”
 *
ch
 );

124 
boŞ
 
’chª‹d_obj
 ( 
Objeù
 *
obj
 );

125 cÚ¡ 
Afãù
 * 
li¡_obj
 ( 
Objeù
 *
obj
 );

126 cÚ¡ 
Afãù
 * 
li¡_ch¬
 ( 
Ch¬aù”
 *
ch
 );

127 cÚ¡ 
Afãù
 * 
li¡_room
 ( 
Room
 *
room
 );

128 
boŞ
 
exi¡s_Ú_obj
 ( 
Objeù
 *
obj
, ::
afãù
::
ty³
ype );

129 
boŞ
 
exi¡s_Ú_ch¬
 ( cÚ¡ 
Ch¬aù”
 *
ch
, ::
afãù
::
ty³
ype );

130 
boŞ
 
exi¡s_Ú_room
 ( 
Room
 *
room
, ::
afãù
::
ty³
ype );

131 cÚ¡ 
Afãù
 * 
fšd_Ú_obj
 ( 
Objeù
 *
obj
, ::
afãù
::
ty³
ype );

132 cÚ¡ 
Afãù
 * 
fšd_Ú_ch¬
 ( 
Ch¬aù”
 *
ch
, ::
afãù
::
ty³
ype );

133 cÚ¡ 
Afãù
 * 
fšd_Ú_room
 ( 
Room
 *
room
, ::
afãù
::
ty³
ype );

136 
cİy_to_obj
 ( 
Objeù
 *
obj
, cÚ¡ 
Afãù
 *
·f
 );

137 
cİy_to_ch¬
 ( 
Ch¬aù”
 *
ch
, cÚ¡ 
Afãù
 *
·f
 );

138 
cİy_to_room
 ( 
Room
 *
room
, cÚ¡ 
Afãù
 *
·f
 );

139 
još_to_obj
 ( 
Objeù
 *
obj
, 
Afãù
 *
·f
 );

140 
još_to_ch¬
 ( 
Ch¬aù”
 *
ch
, 
Afãù
 *
·f
 );

141 
još_to_room
 ( 
Room
 *
room
, 
Afãù
 *
·f
 );

142 
add_³rm_to_ch¬
 ( 
Ch¬aù”
 *
ch
, ::
afãù
::
ty³
ype );

143 
cİy_æags_to_ch¬
 ( 
Ch¬aù”
 *
ch
, 
Ë‰”
, 
FÏgs
 
æags
, 
boŞ
 
³rmª’t
 );

144 
add_ty³_to_ch¬
 ( 
Ch¬aù”
 *
ch
, ::
afãù
::
ty³
y³, 
Ëv–
, 
du¿tiÚ
, 
evŞutiÚ
, 
boŞ
 
³rmª’t
 );

145 
add_¿cŸl_to_ch¬
 ( 
Ch¬aù”
 *
ch
 );

148 
»move_äom_obj
 ( 
Objeù
 *
obj
, 
Afãù
 *
·f
 );

149 
»move_äom_ch¬
 ( 
Ch¬aù”
 *
ch
, 
Afãù
 *
·f
 );

150 
»move_äom_room
 ( 
Room
 *
room
, 
Afãù
 *
·f
 );

151 
»move_m©chšg_äom_obj
 ( 
Objeù
 *
obj
, 
com·¿tÜ
 
comp
, cÚ¡ 
Afãù
 *
·‰”n
 );

152 
»move_m©chšg_äom_ch¬
 ( 
Ch¬aù”
 *
ch
, 
com·¿tÜ
 
comp
, cÚ¡ 
Afãù
 *
·‰”n
 );

153 
»move_m©chšg_äom_room
 ( 
Room
 *
room
, 
com·¿tÜ
 
comp
, cÚ¡ 
Afãù
 *
·‰”n
 );

154 
»move_m¬ked_äom_obj
 ( 
Objeù
 *
obj
 );

155 
»move_m¬ked_äom_ch¬
 ( 
Ch¬aù”
 *
ch
 );

156 
»move_m¬ked_äom_room
 ( 
Room
 *
room
 );

157 
»move_ty³_äom_obj
 ( 
Objeù
 *
obj
, ::
afãù
::
ty³
ype );

158 
»move_ty³_äom_ch¬
 ( 
Ch¬aù”
 *
ch
, ::
afãù
::
ty³
ype );

159 
»move_ty³_äom_room
 ( 
Room
 *
room
, ::
afãù
::
ty³
ype );

160 
»move_®l_äom_obj
 ( 
Objeù
 *
obj
, 
boŞ
 
³rmª’t
 );

161 
»move_®l_äom_ch¬
 ( 
Ch¬aù”
 *
ch
, 
boŞ
 
³rmª’t
 );

162 
»move_®l_äom_room
 ( 
Room
 *
room
, 
boŞ
 
³rmª’t
 );

165 
modify_obj
 ( 
Objeù
 *
obj
, cÚ¡ 
Afãù
 *
·f
, 
boŞ
 
fAdd
 );

166 
modify_ch¬
 ( 
Ch¬aù”
 *
ch
, cÚ¡ 
Afãù
 *
·f
, 
boŞ
 
fAdd
 );

167 
modify_room
 ( 
Room
 *
obj
, cÚ¡ 
Afãù
 *
·f
, 
boŞ
 
fAdd
 );

168 
™”©e_ov”_obj
 ( 
Objeù
 *
obj
, 
afãù_â
 
â
, *
d©a
 );

169 
™”©e_ov”_ch¬
 ( 
Ch¬aù”
 *
ch
, 
afãù_â
 
â
, *
d©a
 );

170 
™”©e_ov”_room
 ( 
Room
 *
room
, 
afãù_â
 
â
, *
d©a
 );

171 
sÜt_obj
 ( 
Objeù
 *
ch
, 
com·¿tÜ
 
comp
 );

172 
sÜt_ch¬
 ( 
Ch¬aù”
 *
ch
, 
com·¿tÜ
 
comp
 );

173 
sÜt_room
 ( 
Room
 *
ch
, 
com·¿tÜ
 
comp
 );

175 
»mÜt_afãù_modify_ch¬
 ( 
Ch¬aù”
 *
ch
, 
wh”e
, 
FÏgs
 
b™veùÜ
, 
boŞ
 
fAdd
 );

180 
show_afãù_to_ch¬
(cÚ¡ 
afãù
::
Afãù
 *
·f
, 
Ch¬aù”
 *
ch
);

181 
¥»ad_¶ague
(
Room
 *
room
, cÚ¡ 
afãù
::
Afãù
 *
¶ague
, 
chªû
 );

	@src/include/affect/Type.hh

1 #´agm¨
Úû


3 
Çme¥aû
 
	gafãù
 {

5 şas 
	cty³
 {

6 
	gunknown
 = -1,

7 
	gnÚe
 = 0,

9 
	gacid_b»©h
,

10 
	gage
,

11 
	g¬mÜ
,

12 
	gbËss
,

13 
	gblšdÃss
,

14 
	gblood_moÚ
,

15 
	gÿlm
,

16 
	gchªge_£x
,

17 
	gchªÃl
,

18 
	gch¬m_³rsÚ
,

19 
	gchl_touch
,

20 
	gcur£
,

21 
	gd¬kÃss
,

22 
	gdazzlšg_light
,

23 
	gd‘eù_ev
,

24 
	gd‘eù_good
,

25 
	gd‘eù_hidd’
,

26 
	gd‘eù_švis
,

27 
	gd‘eù_magic
,

28 
	gdivše_»g’”©iÚ
,

29 
	g’chªt_¬mÜ
,

30 
	g’chªt_w—pÚ
,

31 
	gç”›_fœe
,

32 
	gã¬
,

33 
	gfœe_b»©h
,

34 
	gfœ•roof
,

35 
	gæamesh›ld
,

36 
	gæy
,

37 
	gä’zy
,

38 
	ggŸÁ_¡»ngth
,

39 
	gha¡e
,

40 
	gšvis
,

41 
	gmass_švis
,

42 
	gnight_visiÚ
,

43 
	g·ss_doÜ
,

44 
	g¶ague
,

45 
	gpoisÚ
,

46 
	g´ÙeùiÚ_ev
,

47 
	g´ÙeùiÚ_good
,

48 
	g¿ybª
,

49 
	g»g’”©iÚ
,

50 
	g§nùu¬y
,

51 
	gsh›ld
,

52 
	g¦“p
,

53 
	g¦ow
,

54 
	gsmokesü“n
,

55 
	g¡“l_mi¡
,

56 
	g¡Úe_skš
,

57 
	glÚ
,

58 
	gw—k’
,

59 
	gb”£rk
,

60 
	gdœt_kickšg
,

61 
	ghide
,

62 
	gmed™©iÚ
,

63 
	g¢—k
,

64 
	gsh“n
,

65 
	gfocus
,

66 
	g·¿lyze
,

67 
	gœÚskš
,

68 
	gb¬r›r
,

69 
	gdazzË
,

70 
	gmidnight
,

71 
	gshadow_fÜm
,

72 
	ghex
,

73 
	gbÚe_w®l
,

74 
	ghamm”¡rike
,

75 
	gfÜû_sh›ld
,

78 
	gw—pÚ_acidic
,

79 
	gw—pÚ_æamšg
,

80 
	gw—pÚ_äo¡
,

81 
	gw—pÚ_vampœic
,

82 
	gw—pÚ_sh¬p
,

83 
	gw—pÚ_vÜ·l
,

84 
	gw—pÚ_two_hªds
,

85 
	gw—pÚ_shockšg
,

88 
	gobj_´efix_sŞ¬
,

89 
	gobj_´efix_a¡¿l
,

90 
	gobj_´efix_luÇr
,

91 
	gobj_´efix_wšdy
,

92 
	gobj_´efix_h—Éhy
,

93 
	gobj_´efix_h—¹y
,

94 
	gobj_´efix_¡®w¬t
,

95 
	gobj_´efix_my¡iÿl
,

96 
	gobj_´efix_magiÿl
,

97 
	gobj_´efix_lucky
,

98 
	gobj_´efix_fÜtu™ous
,

99 
	gobj_´efix_¡urdy
,

100 
	gobj_´efix_»šfÜûd
,

101 
	gobj_´efix_´eci£
,

102 
	gobj_´efix_skËd
,

103 
	gobj_´efix_jagged
,

104 
	gobj_´efix_brul
,

106 
	gobj_suffix_š™Ÿ‹_que¡Ü
,

107 
	gobj_suffix_advªûd_que¡Ü
,

108 
	gobj_suffix_ma¡”_que¡Ü
,

109 
	gobj_suffix_skËd
,

110 
	gobj_suffix_sklful
,

111 
	gobj_suffix_ex³r›nûd
,

112 
	gobj_suffix_š™Ÿ‹_mage
,

113 
	gobj_suffix_advªûd_mage
,

114 
	gobj_suffix_ma¡”_mage
,

115 
	gobj_suffix_sw®low
,

116 
	gobj_suffix_hawk
,

117 
	gobj_suffix_çlcÚ
,

118 
	gobj_suffix_deva¡©iÚ
,

119 
	gobj_suffix_ªnih©iÚ
,

120 
	gobj_suffix_¬ÿÃ_pow”
,

121 
	gobj_suffix_my¡iÿl_pow”
,

122 
	gobj_suffix_hexxšg
,

123 
	gobj_suffix_»¡Ü©ive
,

124 
	gobj_suffix_my¡ic
,

126 
	gobj_fÜge_unique
,

127 
	gobj_´›¡ess_unique
,

128 
	gobj_b»w_unique
,

129 
	gobj_süibe_unique
,

130 
	gobj_nk_unique
,

131 
	gobj_Ãüo_p›rû_unique
,

132 
	gobj_lidda_au¿_unique
,

134 
	gobj_£t_mage_švok”
,

135 
	gobj_£t_w¬riÜ_b”£rk”
,

136 
	gobj_£t_ş”ic_divše
,

137 
	gobj_£t_th›f_cuur£
,

138 
	gobj_£t_·Ïdš_g¿û
,

140 
	gsize
,

141 
	gfœ¡
 = 0

	@src/include/affect/affect_int.hh

1 #´agm¨
Úû


3 
	~"Ty³.hh
"

5 
Çme¥aû
 
	gafãù
 {

7 
şass
 
	gAfãù
;

13 
afãù_add_to_li¡
 ( 
Afãù
 **
li¡_h—d
, Afãù *
·f
 );

14 
afãù_»move_äom_li¡
 ( 
Afãù
 **
li¡_h—d
, Afãù *
·f
 );

15 
afãù_cİy_to_li¡
 ( 
Afãù
 **
li¡_h—d
, cÚ¡ Afãù *
·f
 );

16 
afãù_dedup_š_li¡
 ( 
Afãù
 **
li¡_h—d
, Afãù *
·f
 );

17 
afãù_ş—r_li¡
 ( 
Afãù
 **
li¡_h—d
 );

18 
afãù_sw­
 ( 
Afãù
 *
a
, Afãù *
b
 );

19 
afãù_upd©e
 ( 
Afãù
 *
·f
, cÚ¡ Afãù *
aff_‹m¶©e
 );

20 
Afãù
 * 
afãù_fšd_š_li¡
 ( Afãù *
li¡_h—d
, ::
afãù
::
ty³
ype );

	@src/include/affect/affect_list.hh

1 #´agm¨
Úû


3 
	~"Ty³.hh
"

4 
	~"Afãù.hh
"

6 
Çme¥aû
 
	gafãù
 {

10 
add_to_li¡
 ( 
Afãù
 **
li¡_h—d
, Afãù *
·f
 );

11 
»move_äom_li¡
 ( 
Afãù
 **
li¡_h—d
, Afãù *
·f
 );

12 
cİy_to_li¡
 ( 
Afãù
 **
li¡_h—d
, cÚ¡ Afãù *
·f
 );

13 
dedup_š_li¡
 ( 
Afãù
 **
li¡_h—d
, Afãù *
·f
, 
â_·¿ms
 *
·¿ms
 );

14 
ş—r_li¡
 ( 
Afãù
 **
li¡_h—d
 );

15 cÚ¡ 
Afãù
 * 
fšd_š_li¡
 ( Afãù **
li¡_h—d
, ::
afãù
::
ty³
ype );

16 
»move_m©chšg_äom_li¡
 ( 
Afãù
 **
li¡_h—d
, 
com·¿tÜ
 
comp
, cÚ¡ Afãù *
·‰”n
, 
afãù_â_·¿ms
 *
·¿ms
 );

17 
™”©e_ov”_li¡
 ( 
Afãù
 **
li¡_h—d
, 
afãù_â
 
â
, 
â_·¿ms
 *
·¿ms
 );

18 
checksum_li¡
 ( 
Afãù
 **
li¡_h—d
 );

19 
sÜt_li¡
 ( 
Afãù
 **
li¡_h—d
, 
com·¿tÜ
 
comp
 );

	@src/include/argument.hh

1 #´agm¨
Úû


3 
	~"FÏgs.hh
"

5 
şass
 
	gSŒšg
;

7 
numb”_¬gum’t
(cÚ¡ * 
¬gum’t
, * 
¬g
);

8 
	gFÏgs
::
B™
 
’t™y_¬gum’t
(cÚ¡ * 
¬gum’t
, * 
¬g
);

9 
muÉ_¬gum’t
(cÚ¡ * 
¬gum’t
, * 
¬g
);

10 cÚ¡ *
Úe_¬gum’t
(cÚ¡ * 
¬gum’t
, * 
¬g
);

12 
numb”_¬gum’t
(cÚ¡ 
SŒšg
& 
¬gum’t
, SŒšg& 
¬g
);

13 
	gFÏgs
::
B™
 
’t™y_¬gum’t
(cÚ¡ 
SŒšg
& 
¬gum’t
, SŒšg& 
¬g
);

14 
muÉ_¬gum’t
(cÚ¡ 
SŒšg
& 
¬gum’t
, SŒšg& 
¬g
);

15 cÚ¡ *
Úe_¬gum’t
(cÚ¡ 
SŒšg
& 
¬gum’t
, SŒšg& 
¬g
);

23 
	#ENTITY_P
 (
FÏgs
::
A
)

	)

24 
	#ENTITY_M
 (
FÏgs
::
B
)

	)

25 
	#ENTITY_C
 (
ENTITY_P
|
ENTITY_M
)

	)

26 
	#ENTITY_O
 (
FÏgs
::
C
)

	)

27 
	#ENTITY_R
 (
FÏgs
::
D
)

	)

30 
	#ENTITY_VM
 (
FÏgs
::
E
è

	)

31 
	#ENTITY_VO
 (
FÏgs
::
F
è

	)

32 
	#ENTITY_VR
 (
FÏgs
::
G
è

	)

	@src/include/channels.hh

1 #´agm¨
Úû


3 
şass
 
	gCh¬aù”
;

4 
şass
 
	gObjeù
;

5 
şass
 
	gSŒšg
;

6 
şass
 
	gFÏgs
;

9 
glob®_aù
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
mes§ge
, 
de¥™e_švis
, 
cŞÜ
, cÚ¡ 
FÏgs
& 
nocomm_b™s
);

10 
lk_auùiÚ
(cÚ¡ 
SŒšg
& 
¬gum’t
);

11 
chªÃl
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, channel);

12 
chªÃl_who
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
chªÃÊame
, cÚ¡ 
FÏgs
::
B™
& 
chªÃl
, 
cu¡om
);

13 
wizÃt
(cÚ¡ 
SŒšg
& 
¡ršg
, 
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, cÚ¡ 
FÏgs
& 
æag
, cÚ¡ FÏgs& 
æag_sk
, 
mš_¿nk
);

	@src/include/comm.hh

1 #´agm¨
Úû


3 
şass
 
	gDesütÜ
;

4 
şass
 
	gCh¬aù”
;

5 
şass
 
	gSŒšg
;

7 
şo£_sock‘
 
¬gs
ĞĞ
DesütÜ
 *
dşo£
 ) );

8 
cwtb
 
¬gs
((
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
txt
));

9 
wr™e_to_bufãr
 
¬gs
ĞĞ
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
txt
 ) );

10 
echo_off
 
¬gs
((
DesütÜ
 *));

11 
echo_Ú
 
¬gs
((
DesütÜ
 *));

13 
gÙo_lše
(
Ch¬aù”
 *
ch
, 
row
, 
cŞumn
);

14 
ş—r_wšdow
(
Ch¬aù”
 *
ch
);

15 
£t_wšdow
(
Ch¬aù”
 *
ch
, 
tİ
, 
bÙtom
);

16 
»£t_‹rmš®
(
Ch¬aù”
 *
ch
);

	@src/include/conn/State.hh

1 #´agm¨
Úû


3 
şass
 
	gDesütÜ
;

4 
şass
 
	gSŒšg
;

6 
Çme¥aû
 
	gcÚn
 {

8 
	gClo£dS‹
;

9 
	gG‘NameS‹
;

10 
	gCÚfœmNewNameS‹
;

11 
	gCÚfœmNewPassS‹
;

12 
	gG‘OldPassS‹
;

13 
	gG‘NewPassS‹
;

14 
	gB»akCÚÃùS‹
;

15 
	gR—dMOTDS‹
;

16 
	gR—dNewMOTDS‹
;

17 
	gR—dIMOTDS‹
;

18 
	gG‘MudExpS‹
;

19 
	gG‘RaûS‹
;

20 
	gG‘SexS‹
;

21 
	gG‘GudS‹
;

22 
	gG‘Alignm’tS‹
;

23 
	gG‘De™yS‹
;

24 
	gG‘W—pÚS‹
;

25 
	gRŞlStsS‹
;

27 
	gCİyov”Recov”S‹
;

28 
	gPÏyšgS‹
;

30 
	sS‹


32 
Clo£dS‹
 
	gşo£d
;

33 
G‘NameS‹
 
	gg‘Name
;

34 
CÚfœmNewNameS‹
 
	gcÚfœmNewName
;

35 
CÚfœmNewPassS‹
 
	gcÚfœmNewPass
;

36 
G‘OldPassS‹
 
	gg‘OldPass
;

37 
G‘NewPassS‹
 
	gg‘NewPass
;

38 
B»akCÚÃùS‹
 
	gb»akCÚÃù
;

39 
R—dMOTDS‹
 
	g»adMOTD
;

40 
R—dNewMOTDS‹
 
	g»adNewMOTD
;

41 
R—dIMOTDS‹
 
	g»adIMOTD
;

42 
G‘MudExpS‹
 
	gg‘MudExp
;

43 
G‘RaûS‹
 
	gg‘Raû
;

44 
G‘SexS‹
 
	gg‘Sex
;

45 
G‘GudS‹
 
	gg‘Gud
;

46 
G‘Alignm’tS‹
 
	gg‘Alignm’t
;

47 
G‘De™yS‹
 
	gg‘De™y
;

48 
G‘W—pÚS‹
 
	gg‘W—pÚ
;

49 
RŞlStsS‹
 
	grŞlSts
;

51 
Cİyov”Recov”S‹
 
	gcİyov”Recov”
;

52 
PÏyšgS‹
 
	g¶ayšg
;

54 
vœtu®
 
S‹
 *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&) = 0;

57 
	gClo£dS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

58 
	gG‘NameS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

59 
	gCÚfœmNewNameS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

60 
	gCÚfœmNewPassS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

61 
	gG‘OldPassS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

62 
	gG‘NewPassS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

63 
	gB»akCÚÃùS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

64 
	gR—dMOTDS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

65 
	gR—dNewMOTDS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

66 
	gR—dIMOTDS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

67 
	gG‘MudExpS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

68 
	gG‘RaûS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

69 
	gG‘SexS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

70 
	gG‘GudS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

71 
	gG‘Alignm’tS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

72 
	gG‘De™yS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

73 
	gG‘W—pÚS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

74 
	gRŞlStsS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

76 
	gCİyov”Recov”S‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

77 
	gPÏyšgS‹
 : 
public
 
S‹
 { 
vœtu®
 S‹ *
hªdËIÅut
(
DesütÜ
 *, cÚ¡ 
SŒšg
&); };

	@src/include/constants.hh

1 #´agm¨
Úû


3 
	#DIZZYPORT
 3000

	)

10 
	#MAX_STATS
 6

	)

11 
	#MAX_RAFFECTS
 54

	)

12 
	#MAX_RAFFECT_SLOTS
 10

	)

13 
	#MAX_EXTRACLASS_SLOTS
 5

	)

14 
	#EXTRACLASS_SLOT_LEVELS
 10

15 
	#MAX_THIEF
 250

	)

16 
	#MAX_KILLER
 250

	)

17 
	#MAX_QUERY
 20

	)

18 
	#MAX_LEVEL
 100

	)

20 
	#MAX_DONATED
 8000

21 
	#LEVEL_AVATAR
 (
MAX_LEVEL
 - 30è

	)

22 
	#LEVEL_HERO
 (
MAX_LEVEL
 - 9è

	)

23 
	#LEVEL_IMMORTAL
 (
MAX_LEVEL
 - 8è

	)

24 
	#QPS_PER_PRAC
 20

	)

25 
	#QPS_PER_TRAIN
 200

	)

26 
	#MAX_BOW_DISTANCE
 3

	)

28 
	#NEW_LAY_COUNTER
 12

	)

31 
	#MAX_COLORS
 100

	)

34 
	#CSLOT_CHAN_GOSSIP
 0

	)

35 
	#CSLOT_CHAN_FLAME
 1

	)

36 
	#CSLOT_CHAN_QWEST
 2

	)

37 
	#CSLOT_CHAN_PRAY
 3

	)

38 
	#CSLOT_CHAN_AUCTION
 4

	)

39 
	#CSLOT_CHAN_ANNOUNCE
 5

	)

40 
	#CSLOT_CHAN_MUSIC
 6

	)

41 
	#CSLOT_CHAN_QA
 7

	)

42 
	#CSLOT_CHAN_SOCIAL
 8

	)

43 
	#CSLOT_CHAN_GRATS
 9

	)

44 
	#CSLOT_CHAN_IMM
 10

	)

45 
	#CSLOT_CHAN_PAGE
 11

	)

46 
	#CSLOT_CHAN_TELL
 12

	)

47 
	#CSLOT_CHAN_CLAN
 13

	)

48 
	#CSLOT_CHAN_IC
 14

	)

49 
	#CSLOT_CHAN_SAY
 15

	)

50 
	#CSLOT_CHAN_GTELL
 16

	)

51 
	#CSLOT_CHAN_QTELL
 17

	)

52 
	#CSLOT_CHAN_SPOUSE
 18

	)

55 
	#CSLOT_OLDSCORE_NAME
 30

	)

56 
	#CSLOT_OLDSCORE_PKILL
 31

	)

57 
	#CSLOT_OLDSCORE_AKILL
 32

	)

58 
	#CSLOT_OLDSCORE_CLASS
 33

	)

59 
	#CSLOT_OLDSCORE_STAT
 34

	)

60 
	#CSLOT_OLDSCORE_ARMOR
 35

	)

61 
	#CSLOT_OLDSCORE_POINTS
 36

	)

62 
	#CSLOT_OLDSCORE_WEIGHT
 37

	)

63 
	#CSLOT_OLDSCORE_GAIN
 38

	)

64 
	#CSLOT_OLDSCORE_ALIGN
 39

	)

65 
	#CSLOT_OLDSCORE_MONEY
 40

	)

66 
	#CSLOT_OLDSCORE_DICEROLL
 41

	)

67 
	#CSLOT_OLDSCORE_QP
 42

	)

68 
	#CSLOT_OLDSCORE_SP
 43

	)

69 
	#CSLOT_OLDSCORE_RPP
 44

	)

72 
	#CSLOT_SCORE_TORCH
 50

	)

73 
	#CSLOT_SCORE_FLAME
 51

	)

74 
	#CSLOT_SCORE_BORDER
 52

	)

75 
	#CSLOT_SCORE_NAME
 53

	)

76 
	#CSLOT_SCORE_TITLE
 54

	)

77 
	#CSLOT_SCORE_CLASS
 55

	)

78 
	#CSLOT_SCORE_LEVEL
 56

	)

79 
	#CSLOT_SCORE_STAT
 57

	)

80 
	#CSLOT_SCORE_MAXSTAT
 58

	)

81 
	#CSLOT_SCORE_HEALTHNAME
 59

	)

82 
	#CSLOT_SCORE_HEALTHNUM
 60

	)

83 
	#CSLOT_SCORE_WEALTH
 61

	)

84 
	#CSLOT_SCORE_ENCUMB
 62

	)

85 
	#CSLOT_SCORE_ARMOR
 63

	)

86 
	#CSLOT_SCORE_DICENAME
 64

	)

87 
	#CSLOT_SCORE_DICENUM
 65

	)

88 
	#CSLOT_SCORE_POINTNAME
 66

	)

89 
	#CSLOT_SCORE_POINTNUM
 67

	)

90 
	#CSLOT_SCORE_ALIGN
 68

	)

91 
	#CSLOT_SCORE_XPNAME
 69

	)

92 
	#CSLOT_SCORE_XPNUM
 70

	)

93 
	#CSLOT_SCORE_POSITION
 71

	)

94 
	#CSLOT_SCORE_PKRECORD
 72

	)

95 
	#CSLOT_SCORE_PKRANK
 73

	)

98 
	#CSLOT_MISC_ROOM
 80

	)

99 
	#CSLOT_MISC_MOBILES
 81

	)

100 
	#CSLOT_MISC_OBJECTS
 82

	)

101 
	#CSLOT_MISC_PLAYERS
 83

	)

102 
	#CSLOT_MISC_INV
 84

	)

105 
	#PULSE_PER_SECOND
 4

	)

106 
	#PULSE_VIOLENCE
 (3 * 
PULSE_PER_SECOND
)

	)

107 
	#PULSE_MOBILE
 (4 * 
PULSE_PER_SECOND
)

	)

108 
	#PULSE_MUSIC
 (6 * 
PULSE_PER_SECOND
)

	)

109 
	#PULSE_TICK
 (45 * 
PULSE_PER_SECOND
)

	)

110 
	#PULSE_AREA
 (120 * 
PULSE_PER_SECOND
)

	)

111 
	#PULSE_QUEST
 (60 * 
PULSE_PER_SECOND
)

	)

112 
	#PULSE_AUCTION
 (10 * 
PULSE_PER_SECOND
)

	)

113 
	#PULSE_TELEPORT
 (20 * 
PULSE_PER_SECOND
)

	)

114 
	#PULSE_UNDERWATER
 (15 * 
PULSE_PER_SECOND
)

	)

115 
	#PULSE_JANITOR
 (300 * 
PULSE_PER_SECOND
)

	)

116 
	#PULSE_MYSQL_UPD
 (10 * 
PULSE_PER_SECOND
)

	)

128 
	#VIS_ALL
 0

	)

129 
	#VIS_CHAR
 1

	)

130 
	#VIS_PLR
 2

	)

137 
	#TO_ROOM
 0

	)

138 
	#TO_NOTVICT
 1

	)

139 
	#TO_VICT
 2

	)

140 
	#TO_CHAR
 3

	)

141 
	#TO_ALL
 4

	)

142 
	#TO_WORLD
 5

	)

143 
	#TO_VIEW
 6

	)

144 
	#TO_NOTVIEW
 7

	)

145 
	#TO_VICT_CHANNEL
 8

	)

151 
	#STAT_STR
 0

	)

152 
	#STAT_INT
 1

	)

153 
	#STAT_WIS
 2

	)

154 
	#STAT_DEX
 3

	)

155 
	#STAT_CON
 4

	)

156 
	#STAT_CHR
 5

	)

170 
	#MOB_VNUM_FIDO
 3090

	)

171 
	#MOB_VNUM_HELGA
 3011

	)

172 
	#MOB_VNUM_CITYGUARD
 3060

	)

173 
	#MOB_VNUM_VAMPIRE
 3404

	)

175 
	#MOB_VNUM_PATROLMAN
 2106

	)

176 
	#GROUP_VNUM_TROLLS
 (
FÏgs
::
A
)

177 
	#GROUP_VNUM_OGRES
 (
FÏgs
::
B
)

178 

	)

179 
	#MOB_VNUM_SKELETON
 2

	)

180 
	#MOB_VNUM_ZOMBIE
 3

	)

181 
	#MOB_VNUM_WRAITH
 4

	)

182 
	#MOB_VNUM_GARGOYLE
 5

	)

183 
	#MOB_VNUM_RESZOMBIE
 6

	)

185 
	#MOB_VNUM_SQUESTMOB
 85

	)

195 
	#NOBOLD
 0

	)

196 
	#BOLD
 1

	)

197 
	#BLINK
 5

	)

198 
	#REVERSE
 7

	)

199 
	#UNDERLINE
 4

	)

201 
	#GREY
 30

	)

202 
	#RED
 31

	)

203 
	#GREEN
 32

	)

204 
	#YELLOW
 33

	)

205 
	#BLUE
 34

	)

206 
	#PURPLE
 35

	)

207 
	#CYAN
 36

	)

208 
	#WHITE
 37

	)

213 
	#C_UNDERLINE
 "\033[4m"

	)

214 
	#C_FLASH
 "\033[5m"

	)

215 
	#C_REVERSE
 "\033[7m"

	)

216 
	#CLEAR
 "\033[0m"

	)

217 
	#C_BLACK
 "\033[0;30m"

	)

218 
	#C_RED
 "\033[0;31m"

	)

219 
	#C_GREEN
 "\033[0;32m"

	)

220 
	#C_YELLOW
 "\033[0;33m"

	)

221 
	#C_BLUE
 "\033[0;34m"

	)

222 
	#C_MAGENTA
 "\033[0;35m"

	)

223 
	#C_CYAN
 "\033[0;36m"

	)

224 
	#C_WHITE
 "\033[0;37m"

	)

225 
	#C_B_GREY
 "\033[1;30m"

	)

226 
	#C_B_RED
 "\033[1;31m"

	)

227 
	#C_B_GREEN
 "\033[1;32m"

	)

228 
	#C_B_YELLOW
 "\033[1;33m"

	)

229 
	#C_B_BLUE
 "\033[1;34m"

	)

230 
	#C_B_MAGENTA
 "\033[1;35m"

	)

231 
	#C_B_CYAN
 "\033[1;36m"

	)

232 
	#C_B_WHITE
 "\033[1;37m"

	)

233 
	#B_BLACK
 "\033[40m"

	)

234 
	#B_RED
 "\033[41m"

	)

235 
	#B_GREEN
 "\033[42m"

	)

236 
	#B_YELLOW
 "\033[43m"

	)

237 
	#B_BLUE
 "\033[44m"

	)

238 
	#B_MAGENTA
 "\033[45m"

	)

239 
	#B_CYAN
 "\033[46m"

	)

240 
	#B_GREY
 "\033[47m"

	)

244 
	#BAN_SUFFIX
 
FÏgs
::
A


	)

245 
	#BAN_PREFIX
 
FÏgs
::
B


	)

246 
	#BAN_NEWBIES
 
FÏgs
::
C


	)

247 
	#BAN_ALL
 
FÏgs
::
D


	)

248 
	#BAN_PERMIT
 
FÏgs
::
E


	)

255 
	#ACT_NOSUMMON
 (
FÏgs
::
A
)

256 
	#ACT_SENTINEL
 (
FÏgs
::
B
è

	)

257 
	#ACT_SCAVENGER
 (
FÏgs
::
C
è

	)

258 
	#ACT_WHOKNOWS1
 (
FÏgs
::
D
è

	)

259 
	#ACT_MORPH
 (
FÏgs
::
E
è

	)

260 
	#ACT_AGGRESSIVE
 (
FÏgs
::
F
è

	)

261 
	#ACT_STAY_AREA
 (
FÏgs
::
G
è

	)

262 
	#ACT_WIMPY
 (
FÏgs
::
H
)

	)

263 
	#ACT_PET
 (
FÏgs
::
I
è

	)

264 
	#ACT_TRAIN
 (
FÏgs
::
J
è

	)

265 
	#ACT_PRACTICE
 (
FÏgs
::
K
è

	)

266 
	#ACT_STAY
 (
FÏgs
::
L
)

	)

267 
	#ACT_AGGR_ALIGN
 (
FÏgs
::
M
è

	)

268 
	#ACT_SUPERMOB
 (
FÏgs
::
N
è

	)

269 
	#ACT_UNDEAD
 (
FÏgs
::
O
)

	)

271 
	#ACT_CLERIC
 (
FÏgs
::
Q
)

	)

272 
	#ACT_MAGE
 (
FÏgs
::
R
)

	)

273 
	#ACT_THIEF
 (
FÏgs
::
S
)

	)

274 
	#ACT_WARRIOR
 (
FÏgs
::
T
)

	)

275 
	#ACT_NOALIGN
 (
FÏgs
::
U
)

	)

276 
	#ACT_NOPURGE
 (
FÏgs
::
V
)

	)

277 
	#ACT_OUTDOORS
 (
FÏgs
::
W
)

	)

278 
	#ACT_INDOORS
 (
FÏgs
::
Y
)

	)

279 
	#ACT_NOPUSH
 (
FÏgs
::
Z
)

	)

280 
	#ACT_IS_HEALER
 (
FÏgs
::
a
)

	)

281 
	#ACT_GAIN
 (
FÏgs
::
b
)

	)

282 
	#ACT_NOMORPH
 (
FÏgs
::
c
)

	)

283 
	#ACT_IS_CHANGER
 (
FÏgs
::
d
)

	)

287 
	#DAM_NONE
 0

	)

288 
	#DAM_BASH
 1

	)

289 
	#DAM_PIERCE
 2

	)

290 
	#DAM_SLASH
 3

	)

291 
	#DAM_FIRE
 4

	)

292 
	#DAM_COLD
 5

	)

293 
	#DAM_ELECTRICITY
 6

	)

294 
	#DAM_ACID
 7

	)

295 
	#DAM_POISON
 8

	)

296 
	#DAM_NEGATIVE
 9

	)

297 
	#DAM_HOLY
 10

	)

298 
	#DAM_ENERGY
 11

	)

299 
	#DAM_MENTAL
 12

	)

300 
	#DAM_DISEASE
 13

	)

301 
	#DAM_DROWNING
 14

	)

302 
	#DAM_LIGHT
 15

	)

303 
	#DAM_OTHER
 16

	)

304 
	#DAM_HARM
 17

	)

305 
	#DAM_CHARM
 18

	)

306 
	#DAM_SOUND
 19

	)

307 
	#DAM_WATER
 20

	)

308 
	#DAM_WOOD
 21

	)

309 
	#DAM_SILVER
 22

	)

310 
	#DAM_IRON
 23

	)

313 
	#OFF_AREA_ATTACK
 (
FÏgs
::
A
)

	)

314 
	#OFF_BACKSTAB
 (
FÏgs
::
B
)

	)

315 
	#OFF_BASH
 (
FÏgs
::
C
)

	)

316 
	#OFF_BERSERK
 (
FÏgs
::
D
)

	)

317 
	#OFF_DISARM
 (
FÏgs
::
E
)

	)

318 
	#OFF_DODGE
 (
FÏgs
::
F
)

	)

319 
	#OFF_FADE
 (
FÏgs
::
G
)

	)

320 
	#OFF_FAST
 (
FÏgs
::
H
)

	)

321 
	#OFF_KICK
 (
FÏgs
::
I
)

	)

322 
	#OFF_KICK_DIRT
 (
FÏgs
::
J
)

	)

323 
	#OFF_PARRY
 (
FÏgs
::
K
)

	)

324 
	#OFF_RESCUE
 (
FÏgs
::
L
)

	)

325 
	#OFF_TAIL
 (
FÏgs
::
M
)

	)

326 
	#OFF_TRIP
 (
FÏgs
::
N
)

	)

327 
	#OFF_CRUSH
 (
FÏgs
::
O
)

	)

328 
	#ASSIST_ALL
 (
FÏgs
::
P
)

	)

329 
	#ASSIST_ALIGN
 (
FÏgs
::
Q
)

	)

330 
	#ASSIST_RACE
 (
FÏgs
::
R
)

	)

331 
	#ASSIST_PLAYERS
 (
FÏgs
::
S
)

	)

332 
	#ASSIST_GUARD
 (
FÏgs
::
T
)

	)

333 
	#ASSIST_VNUM
 (
FÏgs
::
U
)

	)

336 
	#IS_VULNERABLE
 0

	)

337 
	#IS_NORMAL
 1

	)

338 
	#IS_RESISTANT
 2

	)

339 
	#IS_IMMUNE
 3

	)

340 
	#IS_ABSORBING
 4

	)

344 
	#IMM_CHARM
 (
FÏgs
::
B
)

	)

345 
	#IMM_MAGIC
 (
FÏgs
::
C
)

	)

346 
	#IMM_WEAPON
 (
FÏgs
::
D
)

	)

347 
	#IMM_BASH
 (
FÏgs
::
E
)

	)

348 
	#IMM_PIERCE
 (
FÏgs
::
F
)

	)

349 
	#IMM_SLASH
 (
FÏgs
::
G
)

	)

350 
	#IMM_FIRE
 (
FÏgs
::
H
)

	)

351 
	#IMM_COLD
 (
FÏgs
::
I
)

	)

352 
	#IMM_ELECTRICITY
 (
FÏgs
::
J
)

	)

353 
	#IMM_ACID
 (
FÏgs
::
K
)

	)

354 
	#IMM_POISON
 (
FÏgs
::
L
)

	)

355 
	#IMM_NEGATIVE
 (
FÏgs
::
M
)

	)

356 
	#IMM_HOLY
 (
FÏgs
::
N
)

	)

357 
	#IMM_ENERGY
 (
FÏgs
::
O
)

	)

358 
	#IMM_MENTAL
 (
FÏgs
::
P
)

	)

359 
	#IMM_DISEASE
 (
FÏgs
::
Q
)

	)

360 
	#IMM_DROWNING
 (
FÏgs
::
R
)

	)

361 
	#IMM_LIGHT
 (
FÏgs
::
S
)

	)

362 
	#IMM_SOUND
 (
FÏgs
::
T
)

	)

363 
	#IMM_WOOD
 (
FÏgs
::
X
)

	)

364 
	#IMM_SILVER
 (
FÏgs
::
Y
)

	)

365 
	#IMM_IRON
 (
FÏgs
::
Z
)

	)

368 
	#RES_CHARM
 (
FÏgs
::
B
)

	)

369 
	#RES_MAGIC
 (
FÏgs
::
C
)

	)

370 
	#RES_WEAPON
 (
FÏgs
::
D
)

	)

371 
	#RES_BASH
 (
FÏgs
::
E
)

	)

372 
	#RES_PIERCE
 (
FÏgs
::
F
)

	)

373 
	#RES_SLASH
 (
FÏgs
::
G
)

	)

374 
	#RES_FIRE
 (
FÏgs
::
H
)

	)

375 
	#RES_COLD
 (
FÏgs
::
I
)

	)

376 
	#RES_ELECTRICITY
 (
FÏgs
::
J
)

	)

377 
	#RES_ACID
 (
FÏgs
::
K
)

	)

378 
	#RES_POISON
 (
FÏgs
::
L
)

	)

379 
	#RES_NEGATIVE
 (
FÏgs
::
M
)

	)

380 
	#RES_HOLY
 (
FÏgs
::
N
)

	)

381 
	#RES_ENERGY
 (
FÏgs
::
O
)

	)

382 
	#RES_MENTAL
 (
FÏgs
::
P
)

	)

383 
	#RES_DISEASE
 (
FÏgs
::
Q
)

	)

384 
	#RES_DROWNING
 (
FÏgs
::
R
)

	)

385 
	#RES_LIGHT
 (
FÏgs
::
S
)

	)

386 
	#RES_SOUND
 (
FÏgs
::
T
)

	)

387 
	#RES_WOOD
 (
FÏgs
::
X
)

	)

388 
	#RES_SILVER
 (
FÏgs
::
Y
)

	)

389 
	#RES_IRON
 (
FÏgs
::
Z
)

	)

392 
	#VULN_CHARM
 (
FÏgs
::
B
)

	)

393 
	#VULN_MAGIC
 (
FÏgs
::
C
)

	)

394 
	#VULN_WEAPON
 (
FÏgs
::
D
)

	)

395 
	#VULN_BASH
 (
FÏgs
::
E
)

	)

396 
	#VULN_PIERCE
 (
FÏgs
::
F
)

	)

397 
	#VULN_SLASH
 (
FÏgs
::
G
)

	)

398 
	#VULN_FIRE
 (
FÏgs
::
H
)

	)

399 
	#VULN_COLD
 (
FÏgs
::
I
)

	)

400 
	#VULN_ELECTRICITY
 (
FÏgs
::
J
)

	)

401 
	#VULN_ACID
 (
FÏgs
::
K
)

	)

402 
	#VULN_POISON
 (
FÏgs
::
L
)

	)

403 
	#VULN_NEGATIVE
 (
FÏgs
::
M
)

	)

404 
	#VULN_HOLY
 (
FÏgs
::
N
)

	)

405 
	#VULN_ENERGY
 (
FÏgs
::
O
)

	)

406 
	#VULN_MENTAL
 (
FÏgs
::
P
)

	)

407 
	#VULN_DISEASE
 (
FÏgs
::
Q
)

	)

408 
	#VULN_DROWNING
 (
FÏgs
::
R
)

	)

409 
	#VULN_LIGHT
 (
FÏgs
::
S
)

	)

410 
	#VULN_SOUND
 (
FÏgs
::
T
)

	)

411 
	#VULN_WOOD
 (
FÏgs
::
X
)

	)

412 
	#VULN_SILVER
 (
FÏgs
::
Y
)

	)

413 
	#VULN_IRON
 (
FÏgs
::
Z
)

	)

416 
	#FORM_EDIBLE
 (
FÏgs
::
A
)

	)

417 
	#FORM_POISON
 (
FÏgs
::
B
)

	)

418 
	#FORM_MAGICAL
 (
FÏgs
::
C
)

	)

419 
	#FORM_INSTANT_DECAY
 (
FÏgs
::
D
)

	)

420 
	#FORM_OTHER
 (
FÏgs
::
E
è

	)

423 
	#FORM_ANIMAL
 (
FÏgs
::
G
)

	)

424 
	#FORM_SENTIENT
 (
FÏgs
::
H
)

	)

425 
	#FORM_UNDEAD
 (
FÏgs
::
I
)

	)

426 
	#FORM_CONSTRUCT
 (
FÏgs
::
J
)

	)

427 
	#FORM_MIST
 (
FÏgs
::
K
)

	)

428 
	#FORM_INTANGIBLE
 (
FÏgs
::
L
)

	)

430 
	#FORM_BIPED
 (
FÏgs
::
M
)

	)

431 
	#FORM_CENTAUR
 (
FÏgs
::
N
)

	)

432 
	#FORM_INSECT
 (
FÏgs
::
O
)

	)

433 
	#FORM_SPIDER
 (
FÏgs
::
P
)

	)

434 
	#FORM_CRUSTACEAN
 (
FÏgs
::
Q
)

	)

435 
	#FORM_WORM
 (
FÏgs
::
R
)

	)

436 
	#FORM_BLOB
 (
FÏgs
::
S
)

	)

438 
	#FORM_MAMMAL
 (
FÏgs
::
V
)

	)

439 
	#FORM_BIRD
 (
FÏgs
::
W
)

	)

440 
	#FORM_REPTILE
 (
FÏgs
::
X
)

	)

441 
	#FORM_SNAKE
 (
FÏgs
::
Y
)

	)

442 
	#FORM_DRAGON
 (
FÏgs
::
Z
)

	)

443 
	#FORM_AMPHIBIAN
 (
FÏgs
::
a
)

	)

444 
	#FORM_FISH
 (
FÏgs
::
b
)

	)

445 
	#FORM_COLD_BLOOD
 (
FÏgs
::
c
)

	)

448 
	#PART_HEAD
 (
FÏgs
::
A
)

	)

449 
	#PART_ARMS
 (
FÏgs
::
B
)

	)

450 
	#PART_LEGS
 (
FÏgs
::
C
)

	)

451 
	#PART_HEART
 (
FÏgs
::
D
)

	)

452 
	#PART_BRAINS
 (
FÏgs
::
E
)

	)

453 
	#PART_GUTS
 (
FÏgs
::
F
)

	)

454 
	#PART_HANDS
 (
FÏgs
::
G
)

	)

455 
	#PART_FEET
 (
FÏgs
::
H
)

	)

456 
	#PART_FINGERS
 (
FÏgs
::
I
)

	)

457 
	#PART_EAR
 (
FÏgs
::
J
)

	)

458 
	#PART_EYE
 (
FÏgs
::
K
)

	)

459 
	#PART_LONG_TONGUE
 (
FÏgs
::
L
)

	)

460 
	#PART_EYESTALKS
 (
FÏgs
::
M
)

	)

461 
	#PART_TENTACLES
 (
FÏgs
::
N
)

	)

462 
	#PART_FINS
 (
FÏgs
::
O
)

	)

463 
	#PART_WINGS
 (
FÏgs
::
P
)

	)

464 
	#PART_TAIL
 (
FÏgs
::
Q
)

	)

466 
	#PART_CLAWS
 (
FÏgs
::
U
)

	)

467 
	#PART_FANGS
 (
FÏgs
::
V
)

	)

468 
	#PART_HORNS
 (
FÏgs
::
W
)

	)

469 
	#PART_SCALES
 (
FÏgs
::
X
)

	)

470 
	#PART_TUSKS
 (
FÏgs
::
Y
)

	)

477 
	#AFF_BLIND
 (
FÏgs
::
A
)

	)

478 
	#AFF_INVISIBLE
 (
FÏgs
::
B
)

	)

479 
	#AFF_DETECT_EVIL
 (
FÏgs
::
C
)

	)

480 
	#AFF_DETECT_INVIS
 (
FÏgs
::
D
)

	)

481 
	#AFF_DETECT_MAGIC
 (
FÏgs
::
E
)

	)

482 
	#AFF_DETECT_HIDDEN
 (
FÏgs
::
F
)

	)

483 
	#AFF_DETECT_GOOD
 (
FÏgs
::
G
)

	)

484 
	#AFF_SANCTUARY
 (
FÏgs
::
H
)

	)

485 
	#AFF_FAERIE_FIRE
 (
FÏgs
::
I
)

	)

486 
	#AFF_INFRARED
 (
FÏgs
::
J
)

	)

487 
	#AFF_CURSE
 (
FÏgs
::
K
)

	)

488 
	#AFF_FEAR
 (
FÏgs
::
L
)

	)

489 
	#AFF_POISON
 (
FÏgs
::
M
)

	)

490 
	#AFF_PROTECT_EVIL
 (
FÏgs
::
N
)

	)

491 
	#AFF_PROTECT_GOOD
 (
FÏgs
::
O
)

	)

492 
	#AFF_SNEAK
 (
FÏgs
::
P
)

	)

493 
	#AFF_HIDE
 (
FÏgs
::
Q
)

	)

494 
	#AFF_NIGHT_VISION
 (
FÏgs
::
R
)

	)

495 
	#AFF_CHARM
 (
FÏgs
::
S
)

	)

496 
	#AFF_FLYING
 (
FÏgs
::
T
)

	)

497 
	#AFF_PASS_DOOR
 (
FÏgs
::
U
)

	)

498 
	#AFF_HASTE
 (
FÏgs
::
V
)

	)

499 
	#AFF_CALM
 (
FÏgs
::
W
)

	)

500 
	#AFF_PLAGUE
 (
FÏgs
::
X
)

	)

501 
	#AFF_STEEL
 (
FÏgs
::
Y
)

	)

502 
	#AFF_DIVINEREGEN
 (
FÏgs
::
Z
)

	)

503 
	#AFF_BERSERK
 (
FÏgs
::
a
)

	)

504 
	#AFF_FLAMESHIELD
 (
FÏgs
::
b
)

	)

505 
	#AFF_REGENERATION
 (
FÏgs
::
c
)

	)

506 
	#AFF_SLOW
 (
FÏgs
::
d
)

	)

507 
	#AFF_TALON
 (
FÏgs
::
e
)

	)

514 
	#SEX_NEUTRAL
 0

	)

515 
	#SEX_MALE
 1

	)

516 
	#SEX_FEMALE
 2

	)

519 
	#AC_PIERCE
 0

	)

520 
	#AC_BASH
 1

	)

521 
	#AC_SLASH
 2

	)

522 
	#AC_EXOTIC
 3

	)

525 
	#DICE_NUMBER
 0

	)

526 
	#DICE_TYPE
 1

	)

527 
	#DICE_BONUS
 2

	)

530 
	#SIZE_TINY
 0

	)

531 
	#SIZE_SMALL
 1

	)

532 
	#SIZE_MEDIUM
 2

	)

533 
	#SIZE_LARGE
 3

	)

534 
	#SIZE_HUGE
 4

	)

535 
	#SIZE_GIANT
 5

	)

538 
	#GEN_OBJ_TREASURE
 108

	)

539 
	#GEN_OBJ_FOOD
 119

	)

540 
	#GEN_OBJ_MONEY
 120

	)

541 
	#GEN_OBJ_TOKEN
 141

	)

547 
	#OBJ_VNUM_CORPSE_NPC
 10

	)

548 
	#OBJ_VNUM_CORPSE_PC
 11

	)

549 
	#OBJ_VNUM_SEVERED_HEAD
 12

	)

550 
	#OBJ_VNUM_TORN_HEART
 13

	)

551 
	#OBJ_VNUM_SLICED_ARM
 14

	)

552 
	#OBJ_VNUM_SLICED_LEG
 15

	)

553 
	#OBJ_VNUM_GUTS
 16

	)

554 
	#OBJ_VNUM_BRAINS
 17

	)

555 
	#OBJ_VNUM_DOO
 71

	)

557 
	#OBJ_VNUM_LIGHT_BALL
 21

	)

558 
	#OBJ_VNUM_SPRING
 22

	)

559 
	#OBJ_VNUM_DISC
 23

	)

560 
	#OBJ_VNUM_PORTAL
 25

	)

561 
	#OBJ_VNUM_TORCH
 3030

	)

562 
	#OBJ_VNUM_NEWBIEBAG
 72

	)

563 
	#OBJ_VNUM_WEAPON
 1004

	)

564 
	#OBJ_VNUM_HOLYSWORD
 18

	)

566 
	#OBJ_VNUM_SIGN
 1003

	)

567 
	#OBJ_VNUM_CAMP
 1002

	)

568 
	#OBJ_VNUM_VIAL
 3381

	)

569 
	#OBJ_VNUM_PARCH
 3380

	)

571 
	#OBJ_VNUM_PIT
 3010

	)

573 
	#OBJ_VNUM_SCHOOL_MACE
 3700

	)

574 
	#OBJ_VNUM_SCHOOL_DAGGER
 3701

	)

575 
	#OBJ_VNUM_SCHOOL_SWORD
 3702

	)

576 
	#OBJ_VNUM_SCHOOL_SPEAR
 3717

	)

577 
	#OBJ_VNUM_SCHOOL_STAFF
 3718

	)

578 
	#OBJ_VNUM_SCHOOL_AXE
 3719

	)

579 
	#OBJ_VNUM_SCHOOL_FLAIL
 3720

	)

580 
	#OBJ_VNUM_SCHOOL_WHIP
 3721

	)

581 
	#OBJ_VNUM_SCHOOL_POLEARM
 3722

	)

582 
	#OBJ_VNUM_SCHOOL_BOW
 3727

	)

584 
	#OBJ_VNUM_SCHOOL_VEST
 3703

	)

585 
	#OBJ_VNUM_SCHOOL_SHIELD
 3704

	)

586 
	#OBJ_VNUM_SCHOOL_BANNER
 3716

	)

587 
	#OBJ_VNUM_MAP
 3162

	)

588 
	#OBJ_VNUM_TOKEN
 3379

	)

590 
	#OBJ_VNUM_WHISTLE
 2116

	)

592 
	#OBJ_VNUM_SQUESTOBJ
 85

	)

598 
	#ITEM_LIGHT
 1

	)

599 
	#ITEM_SCROLL
 2

	)

600 
	#ITEM_WAND
 3

	)

601 
	#ITEM_STAFF
 4

	)

602 
	#ITEM_WEAPON
 5

	)

603 
	#ITEM_TREASURE
 8

	)

604 
	#ITEM_ARMOR
 9

	)

605 
	#ITEM_POTION
 10

	)

606 
	#ITEM_CLOTHING
 11

	)

607 
	#ITEM_FURNITURE
 12

	)

608 
	#ITEM_TRASH
 13

	)

609 
	#ITEM_CONTAINER
 15

	)

610 
	#ITEM_DRINK_CON
 17

	)

611 
	#ITEM_KEY
 18

	)

612 
	#ITEM_FOOD
 19

	)

613 
	#ITEM_MONEY
 20

	)

614 
	#ITEM_BOAT
 22

	)

615 
	#ITEM_CORPSE_NPC
 23

	)

616 
	#ITEM_CORPSE_PC
 24

	)

617 
	#ITEM_FOUNTAIN
 25

	)

618 
	#ITEM_PILL
 26

	)

619 
	#ITEM_MAP
 28

	)

620 
	#ITEM_PORTAL
 29

	)

621 
	#ITEM_WARP_STONE
 30

	)

623 
	#ITEM_GEM
 32

	)

624 
	#ITEM_JEWELRY
 33

	)

625 
	#ITEM_JUKEBOX
 34

	)

626 
	#ITEM_PBTUBE
 35

	)

627 
	#ITEM_PBGUN
 36

	)

628 
	#ITEM_MATERIAL
 37

	)

629 
	#ITEM_ANVIL
 38

	)

631 
	#ITEM_WEDDINGRING
 40

	)

632 
	#ITEM_TOKEN
 41

	)

633 
	#ITEM_WARP_CRYSTAL
 42

	)

634 
	#ITEM_QUESTSHOP
 999

	)

647 
	#ITEM_GLOW
 (
FÏgs
::
A
)

	)

648 
	#ITEM_HUM
 (
FÏgs
::
B
)

	)

649 
	#ITEM_COMPARTMENT
 (
FÏgs
::
C
è

	)

650 
	#ITEM_TRANSPARENT
 (
FÏgs
::
D
è

	)

651 
	#ITEM_EVIL
 (
FÏgs
::
E
)

	)

652 
	#ITEM_INVIS
 (
FÏgs
::
F
)

	)

653 
	#ITEM_MAGIC
 (
FÏgs
::
G
)

	)

654 
	#ITEM_NODROP
 (
FÏgs
::
H
)

	)

655 
	#ITEM_BLESS
 (
FÏgs
::
I
)

	)

656 
	#ITEM_ANTI_GOOD
 (
FÏgs
::
J
)

	)

657 
	#ITEM_ANTI_EVIL
 (
FÏgs
::
K
)

	)

658 
	#ITEM_ANTI_NEUTRAL
 (
FÏgs
::
L
)

	)

659 
	#ITEM_NOREMOVE
 (
FÏgs
::
M
)

	)

660 
	#ITEM_INVENTORY
 (
FÏgs
::
N
)

	)

661 
	#ITEM_NOPURGE
 (
FÏgs
::
O
)

	)

662 
	#ITEM_ROT_DEATH
 (
FÏgs
::
P
)

	)

663 
	#ITEM_VIS_DEATH
 (
FÏgs
::
Q
)

	)

664 
	#ITEM_NOSAC
 (
FÏgs
::
R
)

	)

665 
	#ITEM_NONMETAL
 (
FÏgs
::
S
)

	)

666 
	#ITEM_NOLOCATE
 (
FÏgs
::
T
)

	)

667 
	#ITEM_MELT_DROP
 (
FÏgs
::
U
)

	)

669 
	#ITEM_SELL_EXTRACT
 (
FÏgs
::
W
)

	)

670 
	#ITEM_BURN_PROOF
 (
FÏgs
::
Y
)

	)

671 
	#ITEM_NOUNCURSE
 (
FÏgs
::
Z
)

	)

672 
	#ITEM_QUESTSELL
 (
FÏgs
::
a
)

	)

679 
	#ITEM_TAKE
 (
FÏgs
::
A
)

	)

680 
	#ITEM_WEAR_FINGER
 (
FÏgs
::
B
)

	)

681 
	#ITEM_WEAR_NECK
 (
FÏgs
::
C
)

	)

682 
	#ITEM_WEAR_BODY
 (
FÏgs
::
D
)

	)

683 
	#ITEM_WEAR_HEAD
 (
FÏgs
::
E
)

	)

684 
	#ITEM_WEAR_LEGS
 (
FÏgs
::
F
)

	)

685 
	#ITEM_WEAR_FEET
 (
FÏgs
::
G
)

	)

686 
	#ITEM_WEAR_HANDS
 (
FÏgs
::
H
)

	)

687 
	#ITEM_WEAR_ARMS
 (
FÏgs
::
I
)

	)

688 
	#ITEM_WEAR_SHIELD
 (
FÏgs
::
J
)

	)

689 
	#ITEM_WEAR_ABOUT
 (
FÏgs
::
K
)

	)

690 
	#ITEM_WEAR_WAIST
 (
FÏgs
::
L
)

	)

691 
	#ITEM_WEAR_WRIST
 (
FÏgs
::
M
)

	)

692 
	#ITEM_WIELD
 (
FÏgs
::
N
)

	)

693 
	#ITEM_HOLD
 (
FÏgs
::
O
)

	)

694 
	#ITEM_NO_SAC
 (
FÏgs
::
P
)

	)

695 
	#ITEM_WEAR_FLOAT
 (
FÏgs
::
Q
)

	)

696 
	#ITEM_WEAR_WEDDINGRING
 (
FÏgs
::
R
)

	)

699 
	#WEAPON_EXOTIC
 0

	)

700 
	#WEAPON_SWORD
 1

	)

701 
	#WEAPON_DAGGER
 2

	)

702 
	#WEAPON_SPEAR
 3

	)

703 
	#WEAPON_MACE
 4

	)

704 
	#WEAPON_AXE
 5

	)

705 
	#WEAPON_FLAIL
 6

	)

706 
	#WEAPON_WHIP
 7

	)

707 
	#WEAPON_POLEARM
 8

	)

708 
	#WEAPON_BOW
 9

	)

712 
	#WEAPON_FLAMING
 (
FÏgs
::
A
)

	)

713 
	#WEAPON_FROST
 (
FÏgs
::
B
)

	)

714 
	#WEAPON_VAMPIRIC
 (
FÏgs
::
C
)

	)

715 
	#WEAPON_SHARP
 (
FÏgs
::
D
)

	)

716 
	#WEAPON_VORPAL
 (
FÏgs
::
E
)

	)

717 
	#WEAPON_TWO_HANDS
 (
FÏgs
::
F
)

	)

718 
	#WEAPON_SHOCKING
 (
FÏgs
::
G
)

	)

719 
	#WEAPON_POISON
 (
FÏgs
::
H
)

	)

720 
	#WEAPON_ACIDIC
 (
FÏgs
::
I
)

	)

723 
	#GATE_NORMAL_EXIT
 (
FÏgs
::
A
)

	)

724 
	#GATE_NOCURSE
 (
FÏgs
::
B
)

	)

725 
	#GATE_GOWITH
 (
FÏgs
::
C
)

	)

726 
	#GATE_BUGGY
 (
FÏgs
::
D
)

	)

727 
	#GATE_RANDOM
 (
FÏgs
::
E
)

	)

730 
	#STAND_AT
 (
FÏgs
::
A
)

	)

731 
	#STAND_ON
 (
FÏgs
::
B
)

	)

732 
	#STAND_IN
 (
FÏgs
::
C
)

	)

733 
	#SIT_AT
 (
FÏgs
::
D
)

	)

734 
	#SIT_ON
 (
FÏgs
::
E
)

	)

735 
	#SIT_IN
 (
FÏgs
::
F
)

	)

736 
	#REST_AT
 (
FÏgs
::
G
)

	)

737 
	#REST_ON
 (
FÏgs
::
H
)

	)

738 
	#REST_IN
 (
FÏgs
::
I
)

	)

739 
	#SLEEP_AT
 (
FÏgs
::
J
)

	)

740 
	#SLEEP_ON
 (
FÏgs
::
K
)

	)

741 
	#SLEEP_IN
 (
FÏgs
::
L
)

	)

742 
	#PUT_AT
 (
FÏgs
::
M
)

	)

743 
	#PUT_ON
 (
FÏgs
::
N
)

	)

744 
	#PUT_IN
 (
FÏgs
::
O
)

	)

745 
	#PUT_INSIDE
 (
FÏgs
::
P
)

	)

755 
	#APPLY_NONE
 0

756 
	#APPLY_STR
 1

	)

757 
	#APPLY_DEX
 2

	)

758 
	#APPLY_INT
 3

	)

759 
	#APPLY_WIS
 4

	)

760 
	#APPLY_CON
 5

	)

761 
	#APPLY_SEX
 6

	)

764 
	#APPLY_AGE
 9

	)

767 
	#APPLY_MANA
 12

	)

768 
	#APPLY_HIT
 13

	)

769 
	#APPLY_STAM
 14

	)

770 
	#APPLY_GOLD
 15

	)

771 
	#APPLY_EXP_PCT
 16

	)

772 
	#APPLY_AC
 17

	)

773 
	#APPLY_HITROLL
 18

	)

774 
	#APPLY_DAMROLL
 19

	)

775 
	#APPLY_SAVES
 20

	)

776 
	#APPLY_SAVING_PARA
 20

	)

777 
	#APPLY_SAVING_ROD
 21

	)

778 
	#APPLY_SAVING_PETRI
 22

	)

779 
	#APPLY_SAVING_BREATH
 23

	)

780 
	#APPLY_SAVING_SPELL
 24

	)

782 
	#APPLY_CHR
 26

	)

783 
	#APPLY_QUESTPOINTS
 27

	)

784 
	#APPLY_SKILLPOINTS
 28

	)

785 
	#APPLY_MANA_COST_PCT
 29

	)

786 
	#APPLY_STAM_COST_PCT
 30

	)

787 
	#APPLY_WPN_DAMAGE_PCT
 31

	)

788 
	#APPLY_SPELL_DAMAGE_PCT
 32

	)

789 
	#APPLY_VAMP_BONUS_PCT
 33

	)

790 
	#APPLY_HP_BLOCK_PCT
 34

	)

791 
	#APPLY_MANA_BLOCK_PCT
 35

	)

792 
	#APPLY_FORGE_UNIQUE
 36

	)

793 
	#APPLY_PRIESTESS_UNIQUE
 37

	)

794 
	#APPLY_BREW_UNIQUE
 38

	)

795 
	#APPLY_SCRIBE_UNIQUE
 39

	)

796 
	#APPLY_TANK_UNIQUE
 40

	)

797 
	#APPLY_NECRO_PIERCE_UNIQUE
 41

	)

798 
	#APPLY_LIDDA_AURA_UNIQUE
 42

	)

799 
	#SET_MAGE_INVOKER
 43

	)

800 
	#SET_WARRIOR_BESERKER
 44

	)

801 
	#SET_CLERIC_DIVINE
 45

	)

802 
	#SET_THIEF_CUTPURSE
 46

	)

803 
	#SET_PALADIN_GRACE
 47

	)

811 
	#CONT_CLOSEABLE
 (
FÏgs
::
A
)

	)

812 
	#CONT_PICKPROOF
 (
FÏgs
::
B
)

	)

813 
	#CONT_CLOSED
 (
FÏgs
::
C
)

	)

814 
	#CONT_LOCKED
 (
FÏgs
::
D
)

	)

815 
	#CONT_PUT_ON
 (
FÏgs
::
E
)

	)

823 
	#ROOM_VNUM_LIMBO
 2

	)

824 
	#ROOM_VNUM_CHAT
 1200

	)

825 
	#ROOM_VNUM_TEMPLE
 3001

	)

826 
	#ROOM_VNUM_PARK
 3105

	)

827 
	#ROOM_VNUM_ALTAR
 3054

	)

828 
	#ROOM_VNUM_MORGUE
 1251

	)

829 
	#ROOM_VNUM_SCHOOL
 3700

	)

830 
	#ROOM_VNUM_BALANCE
 4500

	)

831 
	#ROOM_VNUM_CIRCLE
 4400

	)

832 
	#ROOM_VNUM_DEMISE
 4201

	)

833 
	#ROOM_VNUM_HONOR
 4300

	)

834 
	#ROOM_VNUM_ARENACENTER
 700

	)

835 
	#ROOM_VNUM_STRONGBOX
 1269

	)

836 
	#ROOM_VNUM_ARENATICKET
 3368

	)

837 
	#ROOM_VNUM_TICKETBACKROOM
 3369

	)

844 
	#ROOM_DARK
 (
FÏgs
::
A
)

	)

845 
	#ROOM_NOLIGHT
 (
FÏgs
::
B
)

	)

846 
	#ROOM_NO_MOB
 (
FÏgs
::
C
)

	)

847 
	#ROOM_INDOORS
 (
FÏgs
::
D
)

	)

848 
	#ROOM_LOCKER
 (
FÏgs
::
E
)

	)

849 
	#ROOM_FEMALE_ONLY
 (
FÏgs
::
F
)

	)

850 
	#ROOM_MALE_ONLY
 (
FÏgs
::
G
)

	)

851 
	#ROOM_NOSLEEP
 (
FÏgs
::
H
)

	)

852 
	#ROOM_NOVISION
 (
FÏgs
::
I
)

	)

853 
	#ROOM_PRIVATE
 (
FÏgs
::
J
)

	)

854 
	#ROOM_SAFE
 (
FÏgs
::
K
)

	)

855 
	#ROOM_SOLITARY
 (
FÏgs
::
L
)

	)

856 
	#ROOM_PET_SHOP
 (
FÏgs
::
M
)

	)

857 
	#ROOM_NO_RECALL
 (
FÏgs
::
N
)

	)

858 
	#ROOM_IMP_ONLY
 (
FÏgs
::
O
)

	)

859 
	#ROOM_GODS_ONLY
 (
FÏgs
::
P
)

	)

860 
	#ROOM_HEROES_ONLY
 (
FÏgs
::
Q
)

	)

861 
	#ROOM_NEWBIES_ONLY
 (
FÏgs
::
R
)

	)

862 
	#ROOM_LAW
 (
FÏgs
::
S
)

	)

863 
	#ROOM_NOWHERE
 (
FÏgs
::
T
)

	)

864 
	#ROOM_BANK
 (
FÏgs
::
U
)

	)

865 
	#ROOM_LEADER_ONLY
 (
FÏgs
::
V
)

	)

866 
	#ROOM_TELEPORT
 (
FÏgs
::
W
)

	)

867 
	#ROOM_UNDER_WATER
 (
FÏgs
::
X
)

	)

868 
	#ROOM_NOPORTAL
 (
FÏgs
::
Y
)

	)

869 
	#ROOM_REMORT_ONLY
 (
FÏgs
::
Z
)

	)

870 
	#ROOM_NOQUEST
 (
FÏgs
::
a
)

	)

871 
	#ROOM_SILENT
 (
FÏgs
::
b
)

	)

872 
	#ROOM_NORANDOMRESET
 (
FÏgs
::
c
)

	)

878 
	#DIR_NORTH
 0

	)

879 
	#DIR_EAST
 1

	)

880 
	#DIR_SOUTH
 2

	)

881 
	#DIR_WEST
 3

	)

882 
	#DIR_UP
 4

	)

883 
	#DIR_DOWN
 5

	)

891 
	#EX_ISDOOR
 (
FÏgs
::
A
)

	)

892 
	#EX_CLOSED
 (
FÏgs
::
B
)

	)

893 
	#EX_LOCKED
 (
FÏgs
::
C
)

	)

894 
	#EX_PICKPROOF
 (
FÏgs
::
F
)

	)

895 
	#EX_NOPASS
 (
FÏgs
::
G
)

	)

896 
	#EX_EASY
 (
FÏgs
::
H
)

	)

897 
	#EX_HARD
 (
FÏgs
::
I
)

	)

898 
	#EX_INFURIATING
 (
FÏgs
::
J
)

	)

899 
	#EX_NOCLOSE
 (
FÏgs
::
K
)

	)

900 
	#EX_NOLOCK
 (
FÏgs
::
L
)

	)

908 
	#WEAR_NONE
 -1

	)

909 
	#WEAR_LIGHT
 0

	)

910 
	#WEAR_FINGER_L
 1

	)

911 
	#WEAR_FINGER_R
 2

	)

912 
	#WEAR_NECK_1
 3

	)

913 
	#WEAR_NECK_2
 4

	)

914 
	#WEAR_BODY
 5

	)

915 
	#WEAR_HEAD
 6

	)

916 
	#WEAR_LEGS
 7

	)

917 
	#WEAR_FEET
 8

	)

918 
	#WEAR_HANDS
 9

	)

919 
	#WEAR_ARMS
 10

	)

920 
	#WEAR_SHIELD
 11

	)

921 
	#WEAR_ABOUT
 12

	)

922 
	#WEAR_WAIST
 13

	)

923 
	#WEAR_WRIST_L
 14

	)

924 
	#WEAR_WRIST_R
 15

	)

925 
	#WEAR_WIELD
 16

	)

926 
	#WEAR_HOLD
 17

	)

927 
	#WEAR_FLOAT
 18

	)

928 
	#WEAR_SECONDARY
 19

	)

929 
	#WEAR_WEDDINGRING
 20

	)

930 
	#MAX_WEAR
 21

	)

944 
	#COND_DRUNK
 0

	)

945 
	#COND_FULL
 1

	)

946 
	#COND_THIRST
 2

	)

947 
	#COND_HUNGER
 3

	)

954 
	#POS_DEAD
 0

	)

955 
	#POS_MORTAL
 1

	)

956 
	#POS_INCAP
 2

	)

957 
	#POS_STUNNED
 3

	)

958 
	#POS_SLEEPING
 4

	)

959 
	#POS_RESTING
 5

	)

960 
	#POS_SITTING
 6

	)

961 
	#POS_FIGHTING
 7

	)

962 
	#POS_STANDING
 8

	)

963 
	#POS_FLYING
 9

	)

965 
	#POS_SNEAK
 19

	)

975 
	#PLR_NOSUMMON
 (
FÏgs
::
A
)

	)

976 
	#PLR_LOOKINPIT
 (
FÏgs
::
B
)

	)

977 
	#PLR_AUTOASSIST
 (
FÏgs
::
C
)

	)

978 
	#PLR_AUTOEXIT
 (
FÏgs
::
D
)

	)

979 
	#PLR_AUTOLOOT
 (
FÏgs
::
E
)

	)

980 
	#PLR_AUTOSAC
 (
FÏgs
::
F
)

	)

981 
	#PLR_AUTOGOLD
 (
FÏgs
::
G
)

	)

982 
	#PLR_AUTOSPLIT
 (
FÏgs
::
H
)

	)

983 
	#PLR_DEFENSIVE
 (
FÏgs
::
I
)

	)

984 
	#PLR_WIMPY
 (
FÏgs
::
J
)

	)

987 
	#PLR_COLOR2
 (
FÏgs
::
L
)

	)

988 
	#PLR_VT100
 (
FÏgs
::
M
)

	)

989 
	#PLR_MAKEBAG
 (
FÏgs
::
O
)

	)

990 
	#PLR_CANLOOT
 (
FÏgs
::
P
)

	)

992 
	#PLR_NOFOLLOW
 (
FÏgs
::
R
)

	)

993 
	#PLR_COLOR
 (
FÏgs
::
S
)

	)

996 
	#PLR_PERMIT
 (
FÏgs
::
U
)

	)

997 
	#PLR_CLOSED
 (
FÏgs
::
V
)

	)

998 
	#PLR_LOG
 (
FÏgs
::
W
)

	)

999 
	#PLR_FREEZE
 (
FÏgs
::
Y
)

	)

1000 
	#PLR_THIEF
 (
FÏgs
::
Z
)

	)

1001 
	#PLR_KILLER
 (
FÏgs
::
a
)

	)

1002 
	#PLR_SUPERWIZ
 (
FÏgs
::
b
)

	)

1003 
	#PLR_TICKS
 (
FÏgs
::
c
)

	)

1004 
	#PLR_NOPK
 (
FÏgs
::
d
)

	)

1007 
	#PLR_OOC
 (
FÏgs
::
A
)

	)

1008 
	#PLR_CHATMODE
 (
FÏgs
::
B
)

	)

1009 
	#PLR_PRIVATE
 (
FÏgs
::
C
)

	)

1010 
	#PLR_STOPCRASH
 (
FÏgs
::
D
)

	)

1011 
	#PLR_PK
 (
FÏgs
::
E
)

	)

1012 
	#PLR_QUESTOR
 (
FÏgs
::
F
)

	)

1013 
	#PLR_SHOWEMAIL
 (
FÏgs
::
G
)

	)

1014 
	#PLR_LINK_DEAD
 (
FÏgs
::
H
)

	)

1015 
	#PLR_PAINT
 (
FÏgs
::
I
)

	)

1016 
	#PLR_SNOOP_PROOF
 (
FÏgs
::
J
)

	)

1017 
	#PLR_NOSHOWLAST
 (
FÏgs
::
K
)

	)

1018 
	#PLR_NONOTIFY
 (
FÏgs
::
L
è

	)

1019 
	#PLR_AUTOPEEK
 (
FÏgs
::
M
)

	)

1020 
	#PLR_HEEDNAME
 (
FÏgs
::
N
)

	)

1021 
	#PLR_SHOWLOST
 (
FÏgs
::
O
)

	)

1022 
	#PLR_SHOWRAFF
 (
FÏgs
::
Q
)

	)

1023 
	#PLR_MARRIED
 (
FÏgs
::
R
)

	)

1024 
	#PLR_SQUESTOR
 (
FÏgs
::
S
è

	)

1025 
	#PLR_DUEL_IGNORE
 (
FÏgs
::
T
è

	)

1029 
	#CHAN_GOSSIP
 0

	)

1030 
	#CHAN_FLAME
 1

	)

1031 
	#CHAN_QWEST
 2

	)

1032 
	#CHAN_PRAY
 3

	)

1033 
	#CHAN_CLAN
 4

	)

1034 
	#CHAN_MUSIC
 5

	)

1035 
	#CHAN_IC
 6

	)

1036 
	#CHAN_GRATS
 7

	)

1037 
	#CHAN_IMMTALK
 8

	)

1038 
	#CHAN_QA
 9

	)

1039 
	#CHAN_AUCTION
 10

	)

1042 
	#COMM_QUIET
 (
FÏgs
::
A
)

	)

1043 
	#COMM_DEAF
 (
FÏgs
::
B
)

	)

1044 
	#COMM_NOWIZ
 (
FÏgs
::
C
)

	)

1045 
	#COMM_NOAUCTION
 (
FÏgs
::
D
)

	)

1046 
	#COMM_NOGOSSIP
 (
FÏgs
::
E
)

	)

1047 
	#COMM_NOQUESTION
 (
FÏgs
::
F
)

	)

1048 
	#COMM_NOMUSIC
 (
FÏgs
::
G
)

	)

1049 
	#COMM_NOCLAN
 (
FÏgs
::
H
)

	)

1050 
	#COMM_NOIC
 (
FÏgs
::
I
)

	)

1051 
	#COMM_NOANNOUNCE
 (
FÏgs
::
K
)

	)

1052 
	#COMM_COMPACT
 (
FÏgs
::
L
)

	)

1053 
	#COMM_BRIEF
 (
FÏgs
::
M
)

	)

1054 
	#COMM_PROMPT
 (
FÏgs
::
N
)

	)

1055 
	#COMM_COMBINE
 (
FÏgs
::
O
)

	)

1056 
	#COMM_NOFLAME
 (
FÏgs
::
P
)

	)

1057 
	#COMM_SHOW_AFFECTS
 (
FÏgs
::
Q
)

	)

1058 
	#COMM_NOGRATS
 (
FÏgs
::
R
)

	)

1059 
	#COMM_NOEMOTE
 (
FÏgs
::
T
)

	)

1060 
	#COMM_NOCHANNELS
 (
FÏgs
::
W
)

1061 
	#COMM_NOSOCIAL
 (
FÏgs
::
X
)

	)

1062 
	#COMM_NOQUERY
 (
FÏgs
::
Y
)

	)

1063 
	#COMM_AFK
 (
FÏgs
::
Z
)

	)

1064 
	#COMM_NOQWEST
 (
FÏgs
::
a
)

	)

1065 
	#COMM_NOPAGE
 (
FÏgs
::
b
)

	)

1066 
	#COMM_NOPRAY
 (
FÏgs
::
c
)

	)

1067 
	#COMM_RPRAY
 (
FÏgs
::
d
è

	)

1068 
	#COMM_ATBPROMPT
 (
FÏgs
::
e
)

	)

1071 
	#REVOKE_NOCHANNELS
 (
FÏgs
::
A
)

	)

1072 
	#REVOKE_FLAMEONLY
 (
FÏgs
::
B
)

	)

1073 
	#REVOKE_GOSSIP
 (
FÏgs
::
C
)

	)

1074 
	#REVOKE_FLAME
 (
FÏgs
::
D
)

	)

1075 
	#REVOKE_QWEST
 (
FÏgs
::
F
)

	)

1076 
	#REVOKE_PRAY
 (
FÏgs
::
G
)

	)

1077 
	#REVOKE_AUCTION
 (
FÏgs
::
H
)

	)

1078 
	#REVOKE_CLAN
 (
FÏgs
::
I
)

	)

1079 
	#REVOKE_MUSIC
 (
FÏgs
::
J
)

	)

1080 
	#REVOKE_QA
 (
FÏgs
::
K
)

	)

1081 
	#REVOKE_SOCIAL
 (
FÏgs
::
L
)

	)

1082 
	#REVOKE_IC
 (
FÏgs
::
M
)

	)

1083 
	#REVOKE_GRATS
 (
FÏgs
::
N
)

	)

1084 
	#REVOKE_PAGE
 (
FÏgs
::
Q
)

	)

1085 
	#REVOKE_QTELL
 (
FÏgs
::
R
)

	)

1086 
	#REVOKE_TELL
 (
FÏgs
::
S
)

	)

1087 
	#REVOKE_EMOTE
 (
FÏgs
::
T
)

	)

1088 
	#REVOKE_SAY
 (
FÏgs
::
U
)

	)

1089 
	#REVOKE_EXP
 (
FÏgs
::
V
)

	)

1090 
	#REVOKE_NOTE
 (
FÏgs
::
W
)

	)

1091 
	#REVOKE_NULL
 (
FÏgs
::
e
è

	)

1096 
	#GROUP_GEN
 (
FÏgs
::
B
)

	)

1097 
	#GROUP_QUEST
 (
FÏgs
::
C
)

	)

1099 
	#GROUP_BUILD
 (
FÏgs
::
E
)

	)

1100 
	#GROUP_CODE
 (
FÏgs
::
F
)

	)

1101 
	#GROUP_SECURE
 (
FÏgs
::
G
)

	)

1103 
	#GROUP_PLAYER
 (
FÏgs
::
I
è

	)

1104 
	#GROUP_MOBILE
 (
FÏgs
::
J
è

	)

1105 
	#GROUP_CLAN
 (
FÏgs
::
K
è

	)

1106 
	#GROUP_AVATAR
 (
FÏgs
::
L
è

	)

1107 
	#GROUP_HERO
 (
FÏgs
::
M
è

	)

1108 
	#GROUP_DEPUTY
 (
FÏgs
::
N
è

	)

1109 
	#GROUP_LEADER
 (
FÏgs
::
O
è

	)

1112 
	#WIZ_ON
 (
FÏgs
::
A
)

	)

1113 
	#WIZ_PURGE
 (
FÏgs
::
B
)

	)

1114 
	#WIZ_LOGINS
 (
FÏgs
::
C
)

	)

1115 
	#WIZ_SITES
 (
FÏgs
::
D
)

	)

1116 
	#WIZ_LINKS
 (
FÏgs
::
E
)

	)

1117 
	#WIZ_DEATHS
 (
FÏgs
::
F
)

	)

1118 
	#WIZ_RESETS
 (
FÏgs
::
G
)

	)

1119 
	#WIZ_MOBDEATHS
 (
FÏgs
::
H
)

	)

1120 
	#WIZ_FLAGS
 (
FÏgs
::
I
)

	)

1121 
	#WIZ_PENALTIES
 (
FÏgs
::
J
)

	)

1122 
	#WIZ_SACCING
 (
FÏgs
::
K
)

	)

1123 
	#WIZ_LEVELS
 (
FÏgs
::
L
)

	)

1124 
	#WIZ_SECURE
 (
FÏgs
::
M
)

	)

1125 
	#WIZ_SWITCHES
 (
FÏgs
::
N
)

	)

1126 
	#WIZ_SNOOPS
 (
FÏgs
::
O
)

	)

1127 
	#WIZ_RESTORE
 (
FÏgs
::
P
)

	)

1128 
	#WIZ_LOAD
 (
FÏgs
::
Q
)

	)

1129 
	#WIZ_NEWBIE
 (
FÏgs
::
R
)

	)

1130 
	#WIZ_PREFIX
 (
FÏgs
::
S
)

	)

1131 
	#WIZ_SPAM
 (
FÏgs
::
T
)

	)

1132 
	#WIZ_MISC
 (
FÏgs
::
U
)

	)

1133 
	#WIZ_BUGS
 (
FÏgs
::
V
è

	)

1134 
	#WIZ_CHEAT
 (
FÏgs
::
Z
)

	)

1135 
	#WIZ_MAIL
 (
FÏgs
::
a
)

	)

1136 
	#WIZ_AUCTION
 (
FÏgs
::
b
)

	)

1137 
	#WIZ_QUEST
 (
FÏgs
::
c
)

	)

1138 
	#WIZ_MALLOC
 (
FÏgs
::
d
)

	)

1142 
	#CENSOR_CHAN
 (
FÏgs
::
A
)

	)

1143 
	#CENSOR_SPAM
 (
FÏgs
::
C
)

	)

1153 
	#VIDEO_FLASH_OFF
 (
FÏgs
::
A
)

	)

1154 
	#VIDEO_FLASH_LINE
 (
FÏgs
::
B
)

	)

1156 
	#VIDEO_DARK_MOD
 (
FÏgs
::
D
)

	)

1158 
	#VIDEO_VT100
 (
FÏgs
::
F
)

	)

1160 
	#VIDEO_CODES_SHOW
 (
FÏgs
::
H
)

	)

1163 
	#LIQ_WATER
 0

	)

1165 
	#MAX_EQSOCKETS
 6

	)

1168 
	#AREA_TYPE_ALL
 'A'

	)

1169 
	#AREA_TYPE_CLAN
 'C'

	)

1170 
	#AREA_TYPE_IMMS
 'I'

	)

1171 
	#AREA_TYPE_HERO
 'H'

	)

1172 
	#AREA_TYPE_ARENA
 'R'

	)

1173 
	#AREA_TYPE_XXX
 'X'

	)

1174 
	#AREA_TYPE_NORM
 ' '

	)

1179 
	#TAR_IGNORE
 0

	)

1180 
	#TAR_CHAR_OFFENSIVE
 1

	)

1181 
	#TAR_CHAR_DEFENSIVE
 2

	)

1182 
	#TAR_CHAR_SELF
 3

	)

1183 
	#TAR_OBJ_INV
 4

	)

1184 
	#TAR_OBJ_CHAR_DEF
 5

	)

1185 
	#TAR_OBJ_CHAR_OFF
 6

	)

1186 
	#TAR_OBJ_HERE
 7

1187 

	)

1188 
	#TARGET_CHAR
 0

	)

1189 
	#TARGET_OBJ
 1

	)

1190 
	#TARGET_ROOM
 2

	)

1191 
	#TARGET_NONE
 3

	)

1195 
	#RANK_MOBILE
 0

	)

1196 
	#RANK_MORTAL
 1

	)

1197 
	#RANK_IMM
 2

	)

1198 
	#RANK_HEAD
 3

	)

1199 
	#RANK_IMP
 4

	)

1202 
	#IMP
 
RANK_IMP


	)

1203 
	#HED
 
RANK_HEAD


	)

1204 
	#IMM
 
RANK_IMM


	)

1205 
	#MTL
 
RANK_MORTAL


	)

1208 
	#GP
 
GROUP_PLAYER


	)

1209 
	#GM
 
GROUP_MOBILE


	)

1210 
	#GC
 
GROUP_CLAN


	)

1211 
	#GAV
 
GROUP_AVATAR


	)

1212 
	#GH
 
GROUP_HERO


	)

1213 
	#GD
 
GROUP_DEPUTY


	)

1214 
	#GL
 
GROUP_LEADER


	)

1215 
	#GWG
 
GROUP_GEN


	)

1216 
	#GWQ
 
GROUP_QUEST


	)

1217 
	#GWB
 
GROUP_BUILD


	)

1218 
	#GWC
 
GROUP_CODE


	)

1219 
	#GWS
 
GROUP_SECURE


	)

1222 
	#EVENT_NULL
 0

	)

1223 
	#EVENT_WAR_START
 1

	)

1224 
	#EVENT_WAR_STOP_WIN
 2

	)

1225 
	#EVENT_WAR_STOP_IMM
 3

	)

1226 
	#EVENT_WAR_DECLARE
 4

	)

1227 
	#EVENT_WAR_JOIN
 5

	)

1228 
	#EVENT_KILL
 6

	)

1229 
	#EVENT_CLAN_DEFEAT
 7

	)

1230 
	#EVENT_CLAN_WIPEOUT
 8

	)

1231 
	#EVENT_CLAN_INVADE
 9

	)

1232 
	#EVENT_ADJUST_SCORE
 10

	)

1233 
	#EVENT_ADJUST_POWER
 11

	)

1234 
	#EVENT_ADJUST_CLANQP
 12

	)

1235 
	#EVENT_CLAN_SURRENDER
 13

	)

1248 
	#PLAYER_DIR
 "../¶ay”/"

	)

1249 
	#TEMP_FILE
 
PLAYER_DIR
 "romtmp"

	)

1250 
	#BACKUP_DIR
 
PLAYER_DIR
 "backup/"

	)

1251 
	#STORAGE_DIR
 
PLAYER_DIR
 "¡Üage/"

	)

1252 
	#STORAGE_FILE
 
STORAGE_DIR
 "¶ay”_li¡.txt"

	)

1253 
	#OLDCHAR_DIR
 
PLAYER_DIR
 "Şdch¬/"

	)

1255 
	#HELP_DIR
 "../h–p/"

	)

1257 
	#AREA_DIR
 "../¬—/"

	)

1258 
	#AREA_LIST
 "¬—.l¡"

	)

1259 
	#CHVNUM_FILE
 
AREA_DIR
 "chvnum.txt"

	)

1260 
	#MOB_DIR
 
AREA_DIR
 "MOBProgs/"

	)

1261 
	#WORLDMAP_DIR
 
AREA_DIR
 "wÜldm­/"

	)

1262 
	#WORLDMAP_IMAGE_FILE
 
WORLDMAP_DIR
 "wÜldm­.²g"

	)

1264 
	#BIN_DIR
 "../bš/"

	)

1265 
	#EXE_FILE
 
BIN_DIR
 "Ëgacy"

	)

1267 
	#MISC_DIR
 "../misc/"

	)

1268 
	#DB_FILE
 
MISC_DIR
 "d©aba£.¦3"

	)

1269 
	#CONFIG_FILE
 
MISC_DIR
 "config.json"

1270 
	#NULL_FILE
 
MISC_DIR
 "NULL_FILE"

	)

1271 
	#PID_FILE
 
MISC_DIR
 "Ëgacy.pid"

	)

1272 
	#COPYOVER_FILE
 
MISC_DIR
 "cİyov”.d©a"

	)

1273 
	#COPYOVER_LOG
 
MISC_DIR
 "cİyov”.log"

	)

1274 
	#COPYOVER_ITEMS
 
MISC_DIR
 "cİyov”.™em"

	)

1275 
	#BUG_FILE
 
MISC_DIR
 "bugs.txt"

	)

1276 
	#PUNISHMENT_FILE
 
MISC_DIR
 "punishm’t.txt"

	)

1277 
	#TYPO_FILE
 
MISC_DIR
 "typos.txt"

	)

1278 
	#RIDEA_FILE
 
MISC_DIR
 "rid—.txt"

	)

1279 
	#WBI_FILE
 
MISC_DIR
 "wbi.txt"

	)

1280 
	#HBI_FILE
 
MISC_DIR
 "hbi.txt"

	)

1281 
	#WBB_FILE
 
MISC_DIR
 "wbb.txt"

	)

1282 
	#HBB_FILE
 
MISC_DIR
 "hbb.txt"

	)

1283 
	#WORK_FILE
 
MISC_DIR
 "wÜk.txt"

	)

1284 
	#IMMAPP_FILE
 
MISC_DIR
 "imm­p.txt"

	)

1285 
	#DEPARTED_FILE
 
MISC_DIR
 "d•¬‹d.txt"

	)

1286 
	#SHUTDOWN_FILE
 
MISC_DIR
 "shutdown.txt"

	)

1287 
	#BAN_FILE
 
MISC_DIR
 "bª.txt"

	)

1288 
	#MUSIC_FILE
 
MISC_DIR
 "music.txt"

	)

1289 
	#EMAIL_FILE
 
MISC_DIR
 "ema.txt"

	)

1290 
	#DISABLED_FILE
 
MISC_DIR
 "di§bËd.txt"

	)

1291 
	#BOOT_FILE
 
MISC_DIR
 "boÙfe"

	)

1293 
	#NOTE_DIR
 "../nÙes/"

	)

1294 
	#NOTE_FILE
 
NOTE_DIR
 "nÙes.nÙ"

	)

1295 
	#IDEA_FILE
 
NOTE_DIR
 "id—s.nÙ"

	)

1296 
	#ROLEPLAY_FILE
 
NOTE_DIR
 "rŞ•Ïy.nÙ"

	)

1297 
	#IMMQUEST_FILE
 
NOTE_DIR
 "immque¡.nÙ"

	)

1298 
	#CHANGES_FILE
 
NOTE_DIR
 "chªge.nÙ"

	)

1299 
	#PERSONAL_FILE
 
NOTE_DIR
 "³rsÚ®.nÙ"

	)

1300 
	#TRADE_FILE
 
NOTE_DIR
 "Œade.nÙ"

	)

1302 
	#LOG_DIR
 "../log/"

	)

1303 
	#SLOG_FILE
 
LOG_DIR
 "¦og.txt"

	)

1308 
	#HALLOWEEN


	)

1311 
	#KEYWD_OWNER
 "owÃd by"

	)

1318 
	#MSL
 
MAX_STRING_LENGTH


	)

1319 
	#MIL
 
MAX_INPUT_LENGTH


	)

1322 
	#RAFF_TEST
 1

	)

1325 
	#RAFF_LIGHTFEET
 2

	)

1326 
	#RAFF_FASTCAST
 3

	)

1327 
	#RAFF_MAGEREGEN
 4

	)

1328 
	#RAFF_VAMPREGEN
 5

	)

1329 
	#RAFF_MOREEXP
 6

	)

1330 
	#RAFF_MOREDAMAGE
 7

	)

1331 
	#RAFF_CHEAPSPELLS
 8

	)

1332 
	#RAFF_NOHUNGER
 9

	)

1333 
	#RAFF_NOTHIRST
 10

	)

1334 
	#RAFF_FAVORGOD
 11

	)

1340 
	#RAFF_BUGGYREC
 100

	)

1342 
	#RAFF_SLOWWALK
 102

	)

1343 
	#RAFF_CLUMSY
 103

	)

1344 
	#RAFF_WEAKGRIP
 104

	)

1345 
	#RAFF_SLOWCAST
 105

	)

1346 
	#RAFF_LESSEXP
 106

	)

1347 
	#RAFF_LESSDAMAGE
 107

	)

1348 
	#RAFF_COSTLYSPELLS
 108

	)

1349 
	#RAFF_EXTRAHUNGRY
 109

	)

1350 
	#RAFF_EXTRATHIRSTY
 110

	)

1351 
	#RAFF_LAUGHTERGOD
 111

	)

1355 
	#RAFF_VULN_SLASH
 900

	)

1356 
	#RAFF_VULN_PIERCE
 901

	)

1357 
	#RAFF_VULN_BLUNT
 902

	)

1358 
	#RAFF_VULN_FIRE
 903

	)

1359 
	#RAFF_VULN_COLD
 904

	)

1360 
	#RAFF_VULN_ELECTRICITY
 905

	)

1361 
	#RAFF_VULN_ACID
 906

	)

1362 
	#RAFF_VULN_POISON
 907

	)

1363 
	#RAFF_VULN_DISEASE
 908

	)

1364 
	#RAFF_VULN_NEGATIVE
 919

	)

1365 
	#RAFF_VULN_HOLY
 910

	)

1366 
	#RAFF_VULN_ENERGY
 911

	)

1367 
	#RAFF_VULN_MENTAL
 912

	)

1368 
	#RAFF_VULN_DROWNING
 913

	)

1369 
	#RAFF_VULN_LIGHT
 914

	)

1370 
	#RAFF_VULN_SOUND
 915

	)

1372 
	#RAFF_RES_SLASH
 950

	)

1373 
	#RAFF_RES_PIERCE
 951

	)

1374 
	#RAFF_RES_BLUNT
 952

	)

1375 
	#RAFF_RES_FIRE
 953

	)

1376 
	#RAFF_RES_COLD
 954

	)

1377 
	#RAFF_RES_ELECTRICITY
 955

	)

1378 
	#RAFF_RES_ACID
 956

	)

1379 
	#RAFF_RES_POISON
 957

	)

1380 
	#RAFF_RES_DISEASE
 958

	)

1381 
	#RAFF_RES_NEGATIVE
 959

	)

1382 
	#RAFF_RES_HOLY
 960

	)

1383 
	#RAFF_RES_ENERGY
 961

	)

1384 
	#RAFF_RES_MENTAL
 962

	)

1385 
	#RAFF_RES_DROWNING
 963

	)

1386 
	#RAFF_RES_LIGHT
 964

	)

1387 
	#RAFF_RES_SOUND
 965

	)

	@src/include/declare.hh

1 #´agm¨
Úû


5 
şass
 
	gAùabË
;

6 
şass
 
	gA»a
;

7 
şass
 
	gB©e
;

8 
şass
 
	gCh¬aù”
;

9 
şass
 
	gCÏn
;

10 
şass
 
	gCu¡omize
;

11 
şass
 
	gD•¬‹dPÏy”
;

12 
şass
 
	gDesütÜ
;

13 
şass
 
	gDi§bËd
;

14 
şass
 
	gDu–
;

15 
şass
 
	gEd™
;

16 
şass
 
	gEQSock‘
;

17 
şass
 
	gEx™
;

18 
şass
 
	gEx™PrÙÙy³
;

19 
şass
 
	gExŒaDesü
;

20 
şass
 
	gFÏgs
;

21 
şass
 
	gGame
;

22 
şass
 
	gGameTime
;

23 
şass
 
	gMobePrÙÙy³
;

24 
şass
 
	gMobProg
;

25 
şass
 
	gMobProgAùLi¡
;

26 
şass
 
	gNÙe
;

27 
şass
 
	gObjeù
;

28 
şass
 
	gObjeùPrÙÙy³
;

29 
şass
 
	gObjeùV®ue
;

30 
şass
 
	gObjeùV®ues
;

31 
şass
 
	gPÏy”
;

32 
şass
 
	gQue¡A»a
;

33 
şass
 
	gRe£t
;

34 
şass
 
	gRoom
;

35 
şass
 
	gRoomID
;

36 
şass
 
	gRoomPrÙÙy³
;

37 
şass
 
	gShİ
;

38 
şass
 
	gSocŸl
;

39 
şass
 
	gStÜedPÏy”
;

40 
şass
 
	gSŒšg
;

41 
şass
 
	gTa
;

42 
şass
 
	gW¬
;

43 
şass
 
	gW—th”
;

44 
şass
 
	gGame
;

45 
şass
 
	gWÜld
;

46 
şass
 
	gVnum
;

47 
şass
 
	gLoÿtiÚ
;

49 
Çme¥aû
 
	gcÚn
 {

50 
	gS‹
;

53 
Çme¥aû
 
	gwÜldm­
 {

54 
şass
 
	gRegiÚ
;

55 
şass
 
	gM­CŞÜ
;

56 
şass
 
	gWÜldm­
;

57 
şass
 
	gCoÜdš©e
;

60 
Çme¥aû
 
	gut
 {

61 
şass
 
	gImage
;

66 
	~"FÏgs.hh
"

67 
	~"skl/Ty³.hh
"

68 
	~"afãù/Ty³.hh
"

69 
	~"Gud.hh
"

72 
	#¬gs
Ğ
li¡
 ) 
	)
list

79 
	tDO_FUN
 
	t¬gs
ĞĞ
	tCh¬aù”
 *
	tch
, 
	tSŒšg
 
	t¬gum’t
 ) );

80 
boŞ
 
	tSPEC_FUN
 
	t¬gs
ĞĞ
	tCh¬aù”
 *
	tch
 ) );

82 
	#DECLARE_DO_FUN
Ğ
fun
 ) 
DO_FUN
 
	)
fun

83 
	#DECLARE_SPEC_FUN
Ğ
fun
 ) 
SPEC_FUN
 
	)
fun

86 
add_fŞlow”
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, Ch¬aù” *
ma¡”
 ) );

87 
¡İ_fŞlow”
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

88 
nuke_³ts
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

89 
d›_fŞlow”
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

90 
boŞ
 
is_§me_group
 
¬gs
ĞĞ
Ch¬aù”
 *
ach
, Ch¬aù” *
bch
 ) );

91 
£nd_to_şª
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
CÏn
 *
rg‘
, cÚ¡ 
SŒšg
& 
‹xt
 ) );

94 
lßd_socŸl_bË
();

95 
§ve_socŸl_bË
();

96 
couÁ_socŸls
();

99 
lßd_w¬_bË
();

100 
lßd_w¬_ev’ts
();

101 
§ve_w¬_bË
();

102 
§ve_w¬_ev’ts
();

103 
w¬_kl
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
));

104 
boŞ
 
ch¬_©_w¬
 
¬gs
((
Ch¬aù”
 *
ch
));

105 
boŞ
 
şª_©_w¬
 
¬gs
((
CÏn
 *
şª
));

106 
boŞ
 
ch¬_İpÚ’ts
 
¬gs
((
Ch¬aù”
 *
ch¬A
, Ch¬aù” *
ch¬B
));

107 
boŞ
 
şª_İpÚ’ts
 
¬gs
((
CÏn
 *
şªA
, CÏÀ*
şªB
));

110 
du–_upd©e
();

111 
lßd_¬’a_bË
();

113 
du–_kl
 
¬gs
((
Ch¬aù”
 *
viùim
));

114 
boŞ
 
ch¬_š_d¬’a_room
 
¬gs
((
Ch¬aù”
 *
ch
));

115 
boŞ
 
ch¬_š_du–_room
 
¬gs
((
Ch¬aù”
 *
ch
));

116 
boŞ
 
ch¬_š_d¬’a
 
¬gs
((
Ch¬aù”
 *
ch
));

117 
boŞ
 
ch¬_š_du–
 
¬gs
((
Ch¬aù”
 *
ch
));

118 
Du–
 *
g‘_du–
 
¬gs
((
Ch¬aù”
 *
ch
));

121 
lßd_¡Üage_li¡
();

122 
§ve_¡Üage_li¡
();

123 
couÁ_¡Üed_ch¬aù”s
();

124 
š£¹_¡Üaged©a
(
StÜedPÏy”
 *);

125 
»move_¡Üaged©a
(
StÜedPÏy”
 *);

126 
StÜedPÏy”
 *
lookup_¡Üage_d©a
(cÚ¡ 
SŒšg
&);

129 
lßd_d•¬‹d_li¡
();

130 
§ve_d•¬‹d_li¡
();

132 
»move_d•¬‹d
(cÚ¡ 
SŒšg
&);

133 
š£¹_d•¬‹d
(cÚ¡ 
SŒšg
&);

134 
boŞ
 
has_d•¬‹d
(cÚ¡ 
SŒšg
&);

137 
£t_t™Ë
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
t™Ë
 ) );

138 
£t_cŞÜ
 
¬gs
((
Ch¬aù”
 *
ch
, 
cŞÜ
, 
bŞd
));

139 
Ãw_cŞÜ
 
¬gs
((
Ch¬aù”
 *
ch
, 
cu¡om
));

142 
move_ch¬
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
doÜ
, 
boŞ
 
fŞlow
 ) );

143 
»ÿÎ
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
boŞ
 
şª
 ) );

144 
Room
 *
g‘_¿ndom_room
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

147 
make_³t
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
³t
));

148 
boŞ
 
ÿn_loÙ
 
¬gs
Ğ(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
) );

149 
g‘_obj
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
,

150 
Objeù
 *
cÚš”
 ) );

153 
Room
 *
fšd_loÿtiÚ
 
¬gs
Ğ(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
) );

154 
£t_
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
FÏgs
 
_æags
));

157 
fšd_mÚey
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

160 
Ch¬aù”
 * 
ü—‹_mobe
 
¬gs
ĞĞ
MobePrÙÙy³
 *
pMobIndex
 ) );

161 
şÚe_mobe
 
¬gs
ĞĞ
Ch¬aù”
 *
·»Á
, Ch¬aù” *
şÚe
) );

162 
Objeù
 * 
ü—‹_objeù
 
¬gs
ĞĞ
ObjeùPrÙÙy³
 *
pObjIndex
, 
Ëv–
 ) );

163 
şÚe_objeù
 
¬gs
ĞĞ
Objeù
 *
·»Á
, Objeù *
şÚe
 ) );

166 
lßd_cÚfig
 
¬gs
((cÚ¡ *
f’ame
));

169 
h–p
 
¬gs
((
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
));

172 
acid_efãù
 
¬gs
Ğ(*
vo
, 
Ëv–
, 
dam
, 
rg‘
, 
evŞutiÚ
) );

173 
cŞd_efãù
 
¬gs
Ğ(*
vo
, 
Ëv–
, 
dam
, 
rg‘
, 
evŞutiÚ
) );

174 
fœe_efãù
 
¬gs
Ğ(*
vo
, 
Ëv–
, 
dam
, 
rg‘
, 
evŞutiÚ
) );

175 
poisÚ_efãù
 
¬gs
Ğ(*
vo
, 
Ëv–
, 
dam
, 
rg‘
, 
evŞutiÚ
) );

176 
shock_efãù
 
¬gs
Ğ(*
vo
, 
Ëv–
, 
dam
, 
rg‘
, 
evŞutiÚ
) );

180 
check_kËr
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
) );

181 
boŞ
 
damage
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
dam
,

182 
skl
::
ty³
 
©ck_skl
, 
©ck_ty³
, 
damage_ty³
, 
boŞ
 
show
, boŞ 
¥–l
 ) );

183 
d—th_üy
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

184 
boŞ
 
is_§ã
 
¬gs
Ğ(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, boŞ 
showmsg
 ) );

185 
boŞ
 
is_§ã_¥–l
 
¬gs
Ğ(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, boŞ 
¬—
 ) );

186 
boŞ
 
is_§ã_ch¬
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, boŞ 
showmsg
));

187 
muÉi_h™
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
skl
::
ty³
 ) );

188 
¡İ_fightšg
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
boŞ
 
fBÙh
 ) );

189 
upd©e_pos
 
¬gs
ĞĞ
Ch¬aù”
 *
viùim
 ) );

190 
viŞ’û_upd©e
 
¬gs
( ( ) );

193 
¡©_to_©Œ
 
¬gs
((
¡©
));

194 
g‘_max_¡©
 
¬gs
(ĞcÚ¡ 
Ch¬aù”
 *
ch
, 
¡©
 ) );

195 
g‘_age
 
¬gs
((
Ch¬aù”
 *
ch
));

196 
g‘_max_h™
 
¬gs
((
Ch¬aù”
 *
ch
));

197 
g‘_max_mªa
 
¬gs
((
Ch¬aù”
 *
ch
));

198 
g‘_max_¡am
 
¬gs
((
Ch¬aù”
 *
ch
));

199 
SŒšg
 
´št_deãn£_modif›rs
 
¬gs
((
Ch¬aù”
 *
ch
, 
wh”e
));

200 
g‘_un¥–Ëd_h™rŞl
 
¬gs
((
Ch¬aù”
 *
ch
));

201 
g‘_un¥–Ëd_damrŞl
 
¬gs
((
Ch¬aù”
 *
ch
));

202 
g‘_un¥–Ëd_ac
 
¬gs
((
Ch¬aù”
 *
ch
, 
ty³
));

205 
couÁ_u£rs
 
¬gs
Ğ(
Objeù
 *
obj
) );

206 
g‘_w—pÚ_ty³
 
¬gs
ĞĞcÚ¡ 
SŒšg
& 
Çme
) );

207 
boŞ
 
is_şª
 
¬gs
((
Ch¬aù”
 *
ch
) );

208 
boŞ
 
is_§me_şª
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
));

209 
	gskl
::
ty³
 
g‘_w—pÚ_skl
 
¬gs
(Ğ
Ch¬aù”
 *
ch
, 
boŞ
 
£cÚd¬y
 ) );

210 
g‘_w—pÚ_Ë¬Ãd
 
¬gs
(Ğ
Ch¬aù”
 *
ch
, 
skl
::
ty³
ype ) );

211 
»£t_ch¬
 
¬gs
(Ğ
Ch¬aù”
 *
ch
 ) );

212 
g‘_max_Œaš
 
¬gs
(Ğ
Ch¬aù”
 *
ch
, 
¡©
 ) );

213 
ÿn_ÿ¼y_n
 
¬gs
(Ğ
Ch¬aù”
 *
ch
 ) );

214 
ÿn_ÿ¼y_w
 
¬gs
(Ğ
Ch¬aù”
 *
ch
 ) );

215 
ch¬_äom_room
 
¬gs
(Ğ
Ch¬aù”
 *
ch
 ) );

216 
ch¬_to_room
 
¬gs
(Ğ
Ch¬aù”
 *
ch
, 
Room
 *
room
 ) );

217 
­¶y_ac
 
¬gs
(Ğ
Objeù
 *
obj
, 
iW—r
, 
ty³
 ) );

218 
Objeù
 * 
g‘_eq_ch¬
 
¬gs
(Ğ
Ch¬aù”
 *
ch
, 
iW—r
 ) );

219 
equ_ch¬
 
¬gs
(Ğ
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, 
iW—r
 ) );

220 
uÃqu_ch¬
 
¬gs
(Ğ
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
 ) );

221 
couÁ_obj_li¡
 
¬gs
(Ğ
ObjeùPrÙÙy³
 *
obj
, 
Objeù
 *
li¡
 ) );

222 
obj_äom_room
 
¬gs
(Ğ
Objeù
 *
obj
 ) );

223 
obj_to_room
 
¬gs
(Ğ
Objeù
 *
obj
, 
Room
 *
room
 ) );

224 
obj_to_obj
 
¬gs
(Ğ
Objeù
 *
obj
, Objeù *
obj_to
 ) );

225 
obj_äom_obj
 
¬gs
(Ğ
Objeù
 *
obj
 ) );

226 
exŒaù_ch¬
 
¬gs
(Ğ
Ch¬aù”
 *
ch
, 
boŞ
 
fPuÎ
 ) );

227 
Objeù
 * 
g‘_obj_ty³
 
¬gs
(Ğ
ObjeùPrÙÙy³
 *
pObjIndexD©a
 ) );

228 
Objeù
 * 
ü—‹_mÚey
 
¬gs
(Ğ
gŞd
, 
sv”
 ) );

229 
g‘_obj_numb”
 
¬gs
(Ğ
Objeù
 *
obj
 ) );

230 
g‘_obj_weight
 
¬gs
(Ğ
Objeù
 *
obj
 ) );

231 
g‘_Œue_weight
 
¬gs
(Ğ
Objeù
 *
obj
 ) );

232 
boŞ
 
is_room_owÃr
 
¬gs
(Ğ
Ch¬aù”
 *
ch
, 
Room
 *
room
) );

233 
boŞ
 
is_blšded
 
¬gs
(ĞcÚ¡ 
Ch¬aù”
 *
ch
 ));

234 
boŞ
 
ÿn_£e_ch¬
 
¬gs
(ĞcÚ¡ 
Ch¬aù”
 *
ch
, cÚ¡ Ch¬aù” *
viùim
 ) );

235 
boŞ
 
ÿn_£e_who
 
¬gs
(ĞcÚ¡ 
Ch¬aù”
 *
ch
, cÚ¡ Ch¬aù” *
viùim
 ) );

236 
boŞ
 
ÿn_£e_obj
 
¬gs
(ĞcÚ¡ 
Ch¬aù”
 *
ch
, cÚ¡ 
Objeù
 *
obj
 ) );

237 
boŞ
 
ÿn_£e_room
 
¬gs
(ĞcÚ¡ 
Ch¬aù”
 *
ch
, cÚ¡ 
Room
 *
room
) );

238 
boŞ
 
ÿn_£e_š_room
 
¬gs
(ĞcÚ¡ 
Ch¬aù”
 *
ch
, cÚ¡ 
Room
 *
room
));

240 cÚ¡ * 
g‘_who_lše
 
¬gs
(Ğ
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
 ) );

241 
boŞ
 
mob_exi¡s
 
¬gs
(ĞcÚ¡ *
Çme
 ) );

243 
·r£_de™y
 
¬gs
((cÚ¡ 
SŒšg
& 
d¡ršg
));

244 
g‘_u§bË_Ëv–
 
¬gs
((
Ch¬aù”
 *
ch
));

245 
g‘_hŞdabË_Ëv–
 
¬gs
((
Ch¬aù”
 *
ch
));

246 
SŒšg
 
g‘_owÃr
 
¬gs
((
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
));

247 
Ch¬aù”
 * 
g‘_obj_ÿ¼›r
 
¬gs
((
Objeù
 *
obj
));

248 
g‘_lock”_numb”
 
¬gs
((
Ch¬aù”
 *
ch
));

249 
g‘_lock”_weight
 
¬gs
((
Ch¬aù”
 *
ch
));

250 
g‘_¡rÚgbox_numb”
 
¬gs
((
Ch¬aù”
 *
ch
));

251 
g‘_ÿ¼y_numb”
 
¬gs
((
Ch¬aù”
 *
ch
));

252 
g‘_ÿ¼y_weight
 
¬gs
((
Ch¬aù”
 *
ch
));

253 
g‘_pos™iÚ
 
¬gs
((
Ch¬aù”
 *
ch
));

254 
g‘_¶ay_hours
 
¬gs
((
Ch¬aù”
 *
ch
));

255 
g‘_¶ay_£cÚds
 
¬gs
((
Ch¬aù”
 *
ch
));

256 
g‘_afãù_evŞutiÚ
 
¬gs
((
Ch¬aù”
 *
ch
, 
afãù
::
ty³
ype));

257 
š‹½Ş©e
 
¬gs
((
Ëv–
, 
v®ue_00
, 
v®ue_32
));

258 cÚ¡ 
ExŒaDesü
 *
g‘_exŒa_desü
 
¬gs
((cÚ¡ 
SŒšg
& 
Çme
, cÚ¡ ExŒaDesü *
ed
));

261 
obj¡©e_lßd_™ems
 
¬gs
(());

262 
obj¡©e_§ve_™ems
 
¬gs
(());

265 
huÁ_viùim
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
) );

268 
š‹½»t
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
 ) );

269 
boŞ
 
is_numb”
 
¬gs
ĞĞcÚ¡ 
SŒšg
& 
¬g
 ) );

270 
boŞ
 
check_socŸl
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
commªd
,

271 cÚ¡ 
SŒšg
& 
¬gum’t
 ) );

272 
do_huh
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

276 
	gskl
::
ty³
 
fšd_¥–l
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
Çme
) );

277 
obj_ÿ¡_¥–l
 
¬gs
ĞĞ
skl
::
ty³
, 
Ëv–
, 
Ch¬aù”
 *
ch
,

278 
Ch¬aù”
 *
viùim
, 
Objeù
 *
obj
 ) );

279 
¥–l_im´št
 
¬gs
ĞĞ
skl
::
ty³
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
 ));

282 
g’”©e_eq
 
¬gs
(Ğ
Ch¬aù”
 *
ch
));

285 
que¡_ş—nup
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

286 
sq_ş—nup
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

289 
§ve_ch¬_obj
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

290 
backup_ch¬_obj
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

291 
boŞ
 
lßd_ch¬_obj
 
¬gs
ĞĞ
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
Çme
 ) );

292 
upd©e_pc_šdex
 
¬gs
((cÚ¡ 
Ch¬aù”
 *
ch
, 
boŞ
 
»move
));

295 
£t_Ë¬Ãd
 
¬gs
(Ğ
Ch¬aù”
 *
ch
, 
skl
::
ty³
y³, 
v®ue
 ) );

296 
£t_evŞutiÚ
 
¬gs
(Ğ
Ch¬aù”
 *
ch
, 
skl
::
ty³
y³, 
v®ue
 ) );

297 
g‘_Ë¬Ãd
 
¬gs
(ĞcÚ¡ 
Ch¬aù”
 *
ch
, 
skl
::
ty³
ype ) );

298 
g‘_evŞutiÚ
 
¬gs
(ĞcÚ¡ 
Ch¬aù”
 *
ch
, 
skl
::
ty³
 ) );

299 
exp_³r_Ëv–
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
pošts
 ) );

300 
check_im´ove
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
skl
::
ty³
, 
boŞ
 
sucûss
,

301 
muÉl›r
 ) );

302 
group_lookup
 
¬gs
Ğ(cÚ¡ 
SŒšg
& 
Çme
) );

303 
gn_add
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
gn
) );

304 
gn_»move
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
gn
) );

305 
group_add
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
Çme
, 
boŞ
 
deduù
) );

306 
group_»move
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
Çme
) );

307 
g‘_skl_co¡
 
¬gs
(Ğ
Ch¬aù”
 *
ch
, 
skl
::
ty³
 ) );

308 
g‘_u§bË_Ëv–
 
¬gs
(Ğ
skl
::
ty³
 
¢
, 
Gud
 
gud
 ));

309 
g‘_skl_Ëv–
 
¬gs
(ĞcÚ¡ 
Ch¬aù”
 *
ch
, 
skl
::
ty³
ype ) );

310 
boŞ
 
deduù_¡amša
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
skl
::
ty³
 ) );

313 
SPEC_FUN
 * 
¥ec_lookup
 
¬gs
ĞĞcÚ¡ 
SŒšg
& 
Çme
 ) );

314 
SŒšg
 
¥ec_Çme
 
¬gs
ĞĞ
SPEC_FUN
 *
funùiÚ
 ) );

315 
boŞ
 
IS_SPECIAL
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
) );

318 
Room
 * 
room_by_Çme
 
¬gs
ĞĞcÚ¡ *
rg‘
, 
Ëv–
, 
boŞ
 
”rÜ
) );

328 
advªû_Ëv–
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

329 
Åc_advªû_Ëv–
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

330 
demÙe_Ëv–
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

331 
gaš_exp
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
gaš
 ) );

332 
gaš_cÚd™iÚ
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
iCÚd
, 
v®ue
 ) );

333 
upd©e_hªdËr
 
¬gs
( ( ) );

336 
¿ff_lookup
 
¬gs
ĞĞ
šdex
 ) );

337 
boŞ
 
HAS_RAFF
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
æag
 ) );

338 
boŞ
 
HAS_RAFF_GROUP
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
æag
 ) );

339 
boŞ
 
HAS_EXTRACLASS
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
skl
::
ty³
 ) );

340 
boŞ
 
CAN_USE_RSKILL
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
, 
skl
::
ty³
 ) );

341 
li¡_exŒaskl
 
¬gs
ĞĞ
Ch¬aù”
 *
ch
 ) );

	@src/include/dispel.hh

1 #´agm¨
Úû


3 
şass
 
	gCh¬aù”
;

4 
şass
 
	gObjeù
;

7 
boŞ
 
§ves_¥–l
 
¬gs
(Ğ
Ëv–
, 
Ch¬aù”
 *
viùim
, 
dam_ty³
 ) );

8 
boŞ
 
check_di¥–_ch¬
 
¬gs
(Ğ
dis_Ëv–
, 
Ch¬aù”
 *
viùim
, 
afãù
::
ty³
y³, boŞ 
§ve
 ));

9 
boŞ
 
check_di¥–_obj
 
¬gs
(Ğ
dis_Ëv–
, 
Objeù
 *
obj
, 
afãù
::
ty³
y³, boŞ 
§ve
 ));

10 
boŞ
 
undo_¥–l
 
¬gs
(Ğ
dis_Ëv–
, 
Ch¬aù”
 *
viùim
, 
afãù
::
ty³
y³, boŞ 
§ve
 ));

11 
boŞ
 
di¥–_ch¬
 
¬gs
(Ğ
Ch¬aù”
 *
viùim
, 
Ëv–
, boŞ 
ÿnûÎ©iÚ
 ));

12 
boŞ
 
Ëv–_§ve
 
¬gs
(Ğ
dis_Ëv–
, 
§ve_Ëv–
));

	@src/include/event/Dispatcher.hh

1 #´agm¨
Úû


3 
	~"ev’t.hh
"

5 
Çme¥aû
 
	gev’t
 {

7 
şass
 
	gHªdËr
;

9 şas 
	cDi¥©ch”
 {

10 
	gpublic
:

11 
Di¥©ch”
();

12 
	gvœtu®
 ~
Di¥©ch”
() {}

14 
fœe
(
Ty³
 
ty³
, 
Args
 
¬gs
);

15 
subsüibe
(
Ty³
 
ty³
, 
HªdËr
 *
s
);

16 
unsubsüibe
(
Ty³
 
ty³
, 
HªdËr
 *
s
);

18 
	g´iv©e
:

19 
Di¥©ch”
(const Dispatcher&);

20 
	gDi¥©ch”
& 
	gİ”©Ü
=(cÚ¡ 
Di¥©ch”
&);

22 
	g¡d
::
muÉim­
<
Ty³
, 
	gHªdËr
 *> 
	gsubsüib”s
;

	@src/include/event/Handler.hh

1 #´agm¨
Úû


3 
	~"ev’t.hh
"

5 
Çme¥aû
 
	gev’t
 {

7 şas 
	cHªdËr
 {

8 
	gpublic
:

9 
vœtu®
 ~
HªdËr
() {}

10 
vœtu®
 
nÙify
(
Ty³
, 
Args
&) = 0;

12 
	g´Ùeùed
:

13 
HªdËr
() {}

15 
´iv©e
:

16 
HªdËr
(const Handler&);

17 
	gHªdËr
& 
	gİ”©Ü
=(cÚ¡ 
HªdËr
&);

	@src/include/event/event.hh

1 #´agm¨
Úû


3 
	~<m­
>

5 
Çme¥aû
 
	gev’t
 {

7 
	eTy³
 {

8 
	g‹¡
,

9 
	gch¬aù”_to_room
,

10 
	gch¬aù”_give_obj
,

11 
	gch¬aù”_kl_Ùh”
,

14 
	g¡d
::
	tm­
<cÚ¡ *, *> 
	tArgs
;

	@src/include/file.hh

1 #´agm¨
Úû


3 
	~"FÏgs.hh
"

4 
	~"SŒšg.hh
"

5 
	~<c¡dio
>

8 
ä—d_Ë‰”
(
FILE
 *
å
);

9 
ä—d_numb”
(
FILE
 *
å
);

10 cÚ¡ 
FÏgs
 
ä—d_æag
(
FILE
 *
å
);

11 
SŒšg
 
ä—d_¡ršg
(
FILE
 *
å
, 
to_ch¬
 = '~');

12 
SŒšg
 
ä—d_¡ršg_eŞ
(
FILE
 *
å
);

13 
ä—d_to_eŞ
(
FILE
 *
å
);

14 
SŒšg
 
ä—d_wÜd
(
FILE
 *
å
);

15 
çµ’d
(cÚ¡ 
SŒšg
& 
fe
, cÚ¡ SŒšg& 
¡r
);

17 cÚ¡ *
dizzy_ùime
(
time_t
 *
tim•
);

18 
time_t
 
dizzy_sÿÁime
(cÚ¡ 
SŒšg
& 
ùime
);

	@src/include/find.hh

1 #´agm¨
Úû


3 
şass
 
	gCh¬aù”
;

4 
şass
 
	gObjeù
;

5 
şass
 
	gRoom
;

6 
şass
 
	gSŒšg
;

10 
Ch¬aù”
 * 
g‘_mob_h”e
 
¬gs
((Ch¬aù” *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
));

11 
Ch¬aù”
 * 
g‘_mob_¬—
 
¬gs
((Ch¬aù” *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
));

12 
Ch¬aù”
 * 
g‘_mob_wÜld
 
¬gs
((Ch¬aù” *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
));

13 
Ch¬aù”
 * 
g‘_ch¬_h”e
 
¬gs
((Ch¬aù” *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
));

14 
Ch¬aù”
 * 
g‘_ch¬_room
 
¬gs
((Ch¬aù” *
ch
, 
Room
 *
room
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
));

15 
Ch¬aù”
 * 
g‘_ch¬_¬—
 
¬gs
((Ch¬aù” *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
));

16 
Ch¬aù”
 * 
g‘_ch¬_wÜld
 
¬gs
((Ch¬aù” *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
));

17 
Ch¬aù”
 * 
g‘_¶ay”_h”e
 
¬gs
((Ch¬aù” *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
));

18 
Ch¬aù”
 * 
g‘_¶ay”_¬—
 
¬gs
((Ch¬aù” *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
));

19 
Ch¬aù”
 * 
g‘_¶ay”_wÜld
 
¬gs
((Ch¬aù” *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, 
vis
));

20 
Objeù
 * 
g‘_obj_li¡
 
¬gs
((
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
, Objeù *
li¡
));

21 
Objeù
 * 
g‘_obj_ÿ¼y
 
¬gs
((
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
));

22 
Objeù
 * 
g‘_obj_w—r
 
¬gs
((
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
));

23 
Objeù
 * 
g‘_obj_h”e
 
¬gs
((
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
));

24 
Objeù
 * 
g‘_obj_wÜld
 
¬gs
((
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬gum’t
));

	@src/include/gem/gem.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

5 
şass
 
	gObjeù
;

7 
Çme¥aû
 
	ggem
 {

10 
	#MAX_GEM_SETTINGS
 4

	)

13 
	#GEM_VALUE_TYPE
 0

	)

14 
	#GEM_VALUE_QUALITY
 1

	)

17 
	gQu®™y
 : {

18 
Rough
 = 0,

19 
	gC¿cked
,

20 
	gFÏwed
,

21 
	gFÏwËss
,

22 
	gP”ãù
,

23 
	gBrlŸÁ
,

24 
	gDazzlšg
,

25 
	gCOUNT


29 
	#OBJ_VNUM_GEM_RUBY
 121

	)

30 
	#OBJ_VNUM_GEM_EMERALD
 122

	)

32 
	sty³_¡


34 * 
	gkeywÜd
;

35 
	gcŞÜ_code
;

36 
	gvnum
;

37 
	g­¶y_loc
;

38 
	gmodif›r
[
Qu®™y
::
COUNT
];

41 
	squ®™y_¡


43 * 
	gkeywÜd
;

44 
	gqu®™y
;

45 
	gËv–
;

48 
š£t
(
Objeù
 *
gem
, Objeù *
obj
);

49 cÚ¡ 
SŒšg
 
g‘_shÜt_¡ršg
(
Objeù
 *
obj
);

	@src/include/interp.hh

1 #´agm¨
Úû


3 
	~"deş¬e.hh
"

4 
	~"SŒšg.hh
"

5 
	~"FÏgs.hh
"

6 
	~<veùÜ
>

10 
	#COM_INGORE
 1

	)

16 
	scmd_ty³


18 
SŒšg
 
	mÇme
;

19 
DO_FUN
 * 
	mdo_fun
;

20 
	mpos™iÚ
;

21 
	mlog
;

22 
	mshow
;

23 
FÏgs
 
	mgroup
;

27 cÚ¡ 
¡d
::
veùÜ
<
cmd_ty³
> 
cmd_bË
;

34 
DECLARE_DO_FUN
Ğ
do_acû±
 );

35 
DECLARE_DO_FUN
Ğ
do_add­¶y
 );

36 
DECLARE_DO_FUN
Ğ
do_addex™
 );

37 
DECLARE_DO_FUN
Ğ
do_adju¡
 );

38 
DECLARE_DO_FUN
Ğ
do_advªû
 );

39 
DECLARE_DO_FUN
Ğ
do_afãùs
 );

40 
DECLARE_DO_FUN
Ğ
do_afk
 );

41 
DECLARE_DO_FUN
Ğ
do_®Ÿ
 );

42 
DECLARE_DO_FUN
Ğ
do_®Ÿs
 );

43 
DECLARE_DO_FUN
Ğ
do_®ign
 );

44 
DECLARE_DO_FUN
Ğ
do_®low
 );

45 
DECLARE_DO_FUN
Ğ
do_®l§ve
 );

46 
DECLARE_DO_FUN
Ğ
do_®‹º©e
 );

47 
DECLARE_DO_FUN
Ğ
do_ªnounû
 );

48 
DECLARE_DO_FUN
Ğ
do_ªsw”
 );

49 
DECLARE_DO_FUN
Ğ
do_¬—s
 );

50 
DECLARE_DO_FUN
Ğ
do_©
 );

51 
DECLARE_DO_FUN
Ğ
do_auùiÚ
 );

52 
DECLARE_DO_FUN
Ğ
do_au¿
 );

53 
DECLARE_DO_FUN
Ğ
do_autßssi¡
 );

54 
DECLARE_DO_FUN
Ğ
do_autoboÙ
 );

55 
DECLARE_DO_FUN
Ğ
do_autÛx™
 );

56 
DECLARE_DO_FUN
Ğ
do_autogŞd
 );

57 
DECLARE_DO_FUN
Ğ
do_autŞi¡
 );

58 
DECLARE_DO_FUN
Ğ
do_autŞoÙ
 );

59 
DECLARE_DO_FUN
Ğ
do_autİ“k
 );

60 
DECLARE_DO_FUN
Ğ
do_autÜeÿÎ
 );

61 
DECLARE_DO_FUN
Ğ
do_auto§c
 );

62 
DECLARE_DO_FUN
Ğ
do_auto¥l™
 );

63 
DECLARE_DO_FUN
Ğ
do_autÙick
 );

64 
DECLARE_DO_FUN
Ğ
do_autog¿ph
 );

65 
DECLARE_DO_FUN
Ğ
do_back¡ab
 );

66 
DECLARE_DO_FUN
Ğ
do_backup
 );

67 
DECLARE_DO_FUN
Ğ
do_b®ªû
 );

68 
DECLARE_DO_FUN
Ğ
do_bamfš
 );

69 
DECLARE_DO_FUN
Ğ
do_bamfout
 );

70 
DECLARE_DO_FUN
Ğ
do_bª
 );

71 
DECLARE_DO_FUN
Ğ
do_bash
 );

72 
DECLARE_DO_FUN
Ğ
do_b©e
 );

73 
DECLARE_DO_FUN
Ğ
do_b”£rk
 );

74 
DECLARE_DO_FUN
Ğ
do_bÚus
 );

75 
DECLARE_DO_FUN
Ğ
do_shoÙ
 );

76 
DECLARE_DO_FUN
Ğ
do_b¿ndish
 );

77 
DECLARE_DO_FUN
Ğ
do_b»akup
 );

78 
DECLARE_DO_FUN
Ğ
do_b»w
 );

79 
DECLARE_DO_FUN
Ğ
do_br›f
 );

80 
DECLARE_DO_FUN
Ğ
do_bug
 );

81 
DECLARE_DO_FUN
Ğ
do_buy
 );

82 
DECLARE_DO_FUN
Ğ
do_ÿnmakebag
 );

83 
DECLARE_DO_FUN
Ğ
do_ÿ¡
 );

84 
DECLARE_DO_FUN
Ğ
do_ûd™
 );

85 
DECLARE_DO_FUN
Ğ
do_ûnsÜ
 );

86 
DECLARE_DO_FUN
Ğ
do_chªges
 );

87 
DECLARE_DO_FUN
Ğ
do_chªÃls
 );

88 
DECLARE_DO_FUN
Ğ
do_ch©mode
 );

89 
DECLARE_DO_FUN
Ğ
do_check
 );

90 
DECLARE_DO_FUN
Ğ
do_chown
 );

91 
DECLARE_DO_FUN
Ğ
do_cœşe
 );

92 
DECLARE_DO_FUN
Ğ
do_şª_»ÿÎ
 );

93 
DECLARE_DO_FUN
Ğ
do_şªd•os™
 );

94 
DECLARE_DO_FUN
Ğ
do_şªw™hd¿w
 );

95 
DECLARE_DO_FUN
Ğ
do_şªšfo
 );

96 
DECLARE_DO_FUN
Ğ
do_şªli¡
 );

97 
DECLARE_DO_FUN
Ğ
do_şªpow”
 );

98 
DECLARE_DO_FUN
Ğ
do_şªqp
 );

99 
DECLARE_DO_FUN
Ğ
do_şªlk
 );

100 
DECLARE_DO_FUN
Ğ
do_ş—r
 );

101 
DECLARE_DO_FUN
Ğ
do_şÚe
 );

102 
DECLARE_DO_FUN
Ğ
do_şo£
 );

107 
DECLARE_DO_FUN
Ğ
do_cŞÜ
 );

108 
DECLARE_DO_FUN
Ğ
do_combše
 );

109 
DECLARE_DO_FUN
Ğ
do_commªds
 );

110 
DECLARE_DO_FUN
Ğ
do_com·ù
 );

111 
DECLARE_DO_FUN
Ğ
do_com·»
 );

112 
DECLARE_DO_FUN
Ğ
do_cÚsid”
 );

113 
DECLARE_DO_FUN
Ğ
do_cÚfig
 );

114 
DECLARE_DO_FUN
Ğ
do_cÚv”t
 );

115 
DECLARE_DO_FUN
Ğ
do_couÁ
 );

116 
DECLARE_DO_FUN
Ğ
do_cİyove
 );

117 
DECLARE_DO_FUN
Ğ
do_cİyov”
 );

118 
DECLARE_DO_FUN
Ğ
do_üed™s
 );

119 
DECLARE_DO_FUN
Ğ
do_ü™iÿl_blow
);

120 
DECLARE_DO_FUN
Ğ
do_ü—‹
 );

121 
DECLARE_DO_FUN
Ğ
do_üush
 );

122 
DECLARE_DO_FUN
Ğ
do_ùe¡
 );

123 
DECLARE_DO_FUN
Ğ
do_d—f
 );

124 
DECLARE_DO_FUN
Ğ
do_debug
 );

125 
DECLARE_DO_FUN
Ğ
do_deãnsive
 );

126 
DECLARE_DO_FUN
Ğ
do_d–‘
 );

127 
DECLARE_DO_FUN
Ğ
do_d–‘e
 );

128 
DECLARE_DO_FUN
Ğ
do_d’y
 );

129 
DECLARE_DO_FUN
Ğ
do_d•¬‹d
 );

130 
DECLARE_DO_FUN
Ğ
do_d•¬‹dli¡
 );

131 
DECLARE_DO_FUN
Ğ
do_d•os™
 );

132 
DECLARE_DO_FUN
Ğ
do_d•utize
 );

133 
DECLARE_DO_FUN
Ğ
do_desütiÚ
 );

134 
DECLARE_DO_FUN
Ğ
do_de¥–l
 );

135 
DECLARE_DO_FUN
Ğ
do_dœt
 );

136 
DECLARE_DO_FUN
Ğ
do_di§bË
 );

137 
DECLARE_DO_FUN
Ğ
do_di§rm
 );

138 
DECLARE_DO_FUN
Ğ
do_discÚÃù
 );

139 
DECLARE_DO_FUN
Ğ
do_divÜû
 );

140 
DECLARE_DO_FUN
Ğ
do_dÚ©e
 );

141 
DECLARE_DO_FUN
Ğ
do_dßs
 );

142 
DECLARE_DO_FUN
Ğ
do_down
 );

143 
DECLARE_DO_FUN
Ğ
do_d¿g
 );

144 
DECLARE_DO_FUN
Ğ
do_dršk
 );

145 
DECLARE_DO_FUN
Ğ
do_drİ
 );

146 
DECLARE_DO_FUN
Ğ
do_du–
 );

147 
DECLARE_DO_FUN
Ğ
do_dump
 );

148 
DECLARE_DO_FUN
Ğ
do_—¡
 );

149 
DECLARE_DO_FUN
Ğ
do_—t
 );

150 
DECLARE_DO_FUN
Ğ
do_echo
 );

151 
DECLARE_DO_FUN
Ğ
do_ed™
 );

152 
DECLARE_DO_FUN
Ğ
do_ema
 );

153 
DECLARE_DO_FUN
Ğ
do_emÙe
 );

154 
DECLARE_DO_FUN
Ğ
do_’g¿ve
 );

155 
DECLARE_DO_FUN
Ğ
do_’‹r
 );

156 
DECLARE_DO_FUN
Ğ
do_’v’om
 );

157 
DECLARE_DO_FUN
Ğ
do_equm’t
 );

158 
DECLARE_DO_FUN
Ğ
do_evŞve
 );

159 
DECLARE_DO_FUN
Ğ
do_evo£t
 );

160 
DECLARE_DO_FUN
Ğ
do_examše
 );

161 
DECLARE_DO_FUN
Ğ
do_ex™s
 );

162 
DECLARE_DO_FUN
Ğ
do_exli¡
 );

163 
DECLARE_DO_FUN
Ğ
do_exŒa£t
 );

164 
DECLARE_DO_FUN
Ğ
do_çmŸr
 );

165 
DECLARE_DO_FUN
Ğ
do_fe
 );

166 
DECLARE_DO_FUN
Ğ
do_fl
 );

167 
DECLARE_DO_FUN
Ğ
do_fšg”
 );

168 
DECLARE_DO_FUN
Ğ
do_fšg”šfo
 );

169 
DECLARE_DO_FUN
Ğ
do_fœebudšg
 );

170 
DECLARE_DO_FUN
Ğ
do_æag
 );

171 
DECLARE_DO_FUN
Ğ
do_æagli¡
 );

172 
DECLARE_DO_FUN
Ğ
do_æag£¬ch
 );

173 
DECLARE_DO_FUN
Ğ
do_æame
 );

174 
DECLARE_DO_FUN
Ğ
do_æ“
 );

175 
DECLARE_DO_FUN
Ğ
do_æy
 );

176 
DECLARE_DO_FUN
Ğ
do_fod
 );

177 
DECLARE_DO_FUN
Ğ
do_fŞlow
 );

178 
DECLARE_DO_FUN
Ğ
do_fŞlow”li¡
 );

179 
DECLARE_DO_FUN
Ğ
do_fÜ
 );

180 
DECLARE_DO_FUN
Ğ
do_fÜû
 );

181 
DECLARE_DO_FUN
Ğ
do_fÜge
 );

182 
DECLARE_DO_FUN
Ğ
do_ä“ze
 );

183 
DECLARE_DO_FUN
Ğ
do_äy
 );

184 
DECLARE_DO_FUN
Ğ
do_fuckoff
 );

185 
DECLARE_DO_FUN
Ğ
do_fyi
 );

186 
DECLARE_DO_FUN
Ğ
do_gaš
 );

187 
DECLARE_DO_FUN
Ğ
do_gameš
 );

188 
DECLARE_DO_FUN
Ğ
do_gameout
 );

189 
DECLARE_DO_FUN
Ğ
do_g‘
 );

190 
DECLARE_DO_FUN
Ğ
do_give
 );

191 
DECLARE_DO_FUN
Ğ
do_glob®socŸl
 );

192 
DECLARE_DO_FUN
Ğ
do_goss
 );

193 
DECLARE_DO_FUN
Ğ
do_gÙo
 );

194 
DECLARE_DO_FUN
Ğ
do_g¿ts
 );

195 
DECLARE_DO_FUN
Ğ
do_group
 );

196 
DECLARE_DO_FUN
Ğ
do_grou¶i¡
 );

197 
DECLARE_DO_FUN
Ğ
do_groups
 );

198 
DECLARE_DO_FUN
Ğ
do_g‹Î
 );

199 
DECLARE_DO_FUN
Ğ
do_gud
 );

200 
DECLARE_DO_FUN
Ğ
do_hamm”¡rike
 );

201 
DECLARE_DO_FUN
Ğ
do_hbb
 );

202 
DECLARE_DO_FUN
Ğ
do_hbi
 );

203 
DECLARE_DO_FUN
Ğ
do_h—l
 );

204 
DECLARE_DO_FUN
Ğ
do_h“d
 );

205 
DECLARE_DO_FUN
Ğ
do_hed™
 );

206 
DECLARE_DO_FUN
Ğ
do_h–p
 );

207 
DECLARE_DO_FUN
Ğ
do_hide
 );

208 
DECLARE_DO_FUN
Ğ
do_hÚe
 );

209 
DECLARE_DO_FUN
Ğ
do_huÁ
 );

210 
DECLARE_DO_FUN
Ğ
do_ic
 );

211 
DECLARE_DO_FUN
Ğ
do_işªlk
 );

212 
DECLARE_DO_FUN
Ğ
do_id—
 );

213 
DECLARE_DO_FUN
Ğ
do_id’tify
 );

214 
DECLARE_DO_FUN
Ğ
do_ignÜe
 );

215 
DECLARE_DO_FUN
Ğ
do_immÇme
 );

216 
DECLARE_DO_FUN
Ğ
do_immlk
 );

217 
DECLARE_DO_FUN
Ğ
do_imm­p
 );

218 
DECLARE_DO_FUN
Ğ
do_imÙd
 );

219 
DECLARE_DO_FUN
Ğ
do_š£t
 );

220 
DECLARE_DO_FUN
Ğ
do_šv’tÜy
 );

221 
DECLARE_DO_FUN
Ğ
do_švis
 );

222 
DECLARE_DO_FUN
Ğ
do_šv™e
 );

223 
DECLARE_DO_FUN
Ğ
do_još
 );

224 
DECLARE_DO_FUN
Ğ
do_junk
 );

225 
DECLARE_DO_FUN
Ğ
do_kewlscÜe
 );

226 
DECLARE_DO_FUN
Ğ
do_kick
 );

227 
DECLARE_DO_FUN
Ğ
do_kl
 );

228 
DECLARE_DO_FUN
Ğ
do_Ïg
 );

229 
DECLARE_DO_FUN
Ğ
do_Ïnd
 );

230 
DECLARE_DO_FUN
Ğ
do_Ïy_Ú_hªds
 );

231 
DECLARE_DO_FUN
Ğ
do_Ëad”
 );

232 
DECLARE_DO_FUN
Ğ
do_Ëv–s
 );

233 
DECLARE_DO_FUN
Ğ
do_lšklßd
 );

234 
DECLARE_DO_FUN
Ğ
do_li¡
 );

235 
DECLARE_DO_FUN
Ğ
do_lßd
 );

236 
DECLARE_DO_FUN
Ğ
do_lßdh–ps
 );

237 
DECLARE_DO_FUN
Ğ
do_upd©e
 );

238 
DECLARE_DO_FUN
Ğ
do_lock
 );

239 
DECLARE_DO_FUN
Ğ
do_lock”
 );

240 
DECLARE_DO_FUN
Ğ
do_log
 );

241 
DECLARE_DO_FUN
Ğ
do_look
 );

242 
DECLARE_DO_FUN
Ğ
do_lÜe
 );

243 
DECLARE_DO_FUN
Ğ
do_low”
 );

244 
DECLARE_DO_FUN
Ğ
do_lurk
 );

245 
DECLARE_DO_FUN
Ğ
do_m¬k
 );

246 
DECLARE_DO_FUN
Ğ
do_m¬ry
 );

247 
DECLARE_DO_FUN
Ğ
do_ma¡”
 );

248 
DECLARE_DO_FUN
Ğ
do_memÜy
 );

249 
DECLARE_DO_FUN
Ğ
do_mfšd
 );

250 
DECLARE_DO_FUN
Ğ
do_mËv–
 );

251 
DECLARE_DO_FUN
Ğ
do_mlßd
 );

252 
DECLARE_DO_FUN
Ğ
do_mÜph
 );

253 
DECLARE_DO_FUN
Ğ
do_mÙd
 );

254 
DECLARE_DO_FUN
Ğ
do_m·sound
 );

255 
DECLARE_DO_FUN
Ğ
do_m·t
 );

256 
DECLARE_DO_FUN
Ğ
do_mpÿ¡
 );

257 
DECLARE_DO_FUN
Ğ
do_mpş—rmÚey
 );

258 
DECLARE_DO_FUN
Ğ
do_m³cho
 );

259 
DECLARE_DO_FUN
Ğ
do_m³chßround
 );

260 
DECLARE_DO_FUN
Ğ
do_m³chßt
 );

261 
DECLARE_DO_FUN
Ğ
do_mpfÜû
 );

262 
DECLARE_DO_FUN
Ğ
do_mpgÙo
 );

263 
DECLARE_DO_FUN
Ğ
do_mpjunk
 );

264 
DECLARE_DO_FUN
Ğ
do_mpkl
 );

265 
DECLARE_DO_FUN
Ğ
do_mpmlßd
 );

266 
DECLARE_DO_FUN
Ğ
do_mpŞßd
 );

267 
DECLARE_DO_FUN
Ğ
do_mµurge
 );

268 
DECLARE_DO_FUN
Ğ
do_mp¡©
 );

269 
DECLARE_DO_FUN
Ğ
do_m±¿nsãr
 );

270 
DECLARE_DO_FUN
Ğ
do_m£t
 );

271 
DECLARE_DO_FUN
Ğ
do_m¡©
 );

272 
DECLARE_DO_FUN
Ğ
do_music
 );

273 
DECLARE_DO_FUN
Ğ
do_mwh”e
 );

275 
DECLARE_DO_FUN
Ğ
do_Ãwb›k™
 );

276 
DECLARE_DO_FUN
Ğ
do_Ãwlock
 );

277 
DECLARE_DO_FUN
Ğ
do_Ãw·sswd
 );

278 
DECLARE_DO_FUN
Ğ
do_immque¡
 );

279 
DECLARE_DO_FUN
Ğ
do_Ãxt
 );

280 
DECLARE_DO_FUN
Ğ
do_nofŞlow
 );

281 
DECLARE_DO_FUN
Ğ
do_nŞoÙ
 );

282 
DECLARE_DO_FUN
Ğ
do_nÜ•ly
 );

283 
DECLARE_DO_FUN
Ğ
do_nÜth
 );

284 
DECLARE_DO_FUN
Ğ
do_nosummÚ
 );

285 
DECLARE_DO_FUN
Ğ
do_nÙe
 );

286 
DECLARE_DO_FUN
Ğ
do_nÙify
 );

287 
DECLARE_DO_FUN
Ğ
do_oşÚe
 );

288 
DECLARE_DO_FUN
Ğ
do_ofšd
 );

289 
DECLARE_DO_FUN
Ğ
do_Şdsÿn
 );

290 
DECLARE_DO_FUN
Ğ
do_Şev–
 );

291 
DECLARE_DO_FUN
Ğ
do_Şßd
 );

292 
DECLARE_DO_FUN
Ğ
do_ooc
 );

293 
DECLARE_DO_FUN
Ğ
do_İ’
 );

294 
DECLARE_DO_FUN
Ğ
do_Üd”
 );

295 
DECLARE_DO_FUN
Ğ
do_o£t
 );

296 
DECLARE_DO_FUN
Ğ
do_o¡©
 );

297 
DECLARE_DO_FUN
Ğ
do_outf™
 );

298 
DECLARE_DO_FUN
Ğ
do_owh”e
 );

299 
DECLARE_DO_FUN
Ğ
do_owÃr
 );

300 
DECLARE_DO_FUN
Ğ
do_·ge
 );

301 
DECLARE_DO_FUN
Ğ
do_·štbow
 );

302 
DECLARE_DO_FUN
Ğ
do_·rdÚ
 );

303 
DECLARE_DO_FUN
Ğ
do_·sswÜd
 );

304 
DECLARE_DO_FUN
Ğ
do_³aû
 );

305 
DECLARE_DO_FUN
Ğ
do_³cho
 );

306 
DECLARE_DO_FUN
Ğ
do_³ek
 );

307 
DECLARE_DO_FUN
Ğ
do_³rsÚ®
 );

308 
DECLARE_DO_FUN
Ğ
do_³rm™
 );

309 
DECLARE_DO_FUN
Ğ
do_³t
 );

310 
DECLARE_DO_FUN
Ğ
do_pick
 );

311 
DECLARE_DO_FUN
Ğ
do_pšg
 );

312 
DECLARE_DO_FUN
Ğ
do_pe
 );

313 
DECLARE_DO_FUN
Ğ
do_p™
 );

314 
DECLARE_DO_FUN
Ğ
do_pk
 );

315 
DECLARE_DO_FUN
Ğ
do_¶ay
 );

316 
DECLARE_DO_FUN
Ğ
do_pmÙe
 );

317 
DECLARE_DO_FUN
Ğ
do_pock‘
 );

318 
DECLARE_DO_FUN
Ğ
do_po£
 );

319 
DECLARE_DO_FUN
Ğ
do_pour
 );

320 
DECLARE_DO_FUN
Ğ
do_´aùiû
 );

321 
DECLARE_DO_FUN
Ğ
do_´ay
 );

322 
DECLARE_DO_FUN
Ğ
do_´efi
 );

323 
DECLARE_DO_FUN
Ğ
do_´efix
 );

324 
DECLARE_DO_FUN
Ğ
do_´šth–ps
 );

325 
DECLARE_DO_FUN
Ğ
do_´iv©e
 );

326 
DECLARE_DO_FUN
Ğ
do_´om±
 );

327 
DECLARE_DO_FUN
Ğ
do_´İo£
 );

328 
DECLARE_DO_FUN
Ğ
do_´Ùeù
 );

329 
DECLARE_DO_FUN
Ğ
do_p¡©
 );

330 
DECLARE_DO_FUN
Ğ
do_punish
 );

331 
DECLARE_DO_FUN
Ğ
do_purge
 );

332 
DECLARE_DO_FUN
Ğ
do_push
 );

333 
DECLARE_DO_FUN
Ğ
do_put
 );

334 
DECLARE_DO_FUN
Ğ
do_qpcÚv
 );

335 
DECLARE_DO_FUN
Ğ
do_q‹Î
 );

336 
DECLARE_DO_FUN
Ğ
do_quaff
 );

337 
DECLARE_DO_FUN
Ğ
do_qu”y
 );

338 
DECLARE_DO_FUN
Ğ
do_que¡
 );

339 
DECLARE_DO_FUN
Ğ
do_que¡iÚ
 );

340 
DECLARE_DO_FUN
Ğ
do_qui
 );

341 
DECLARE_DO_FUN
Ğ
do_qu›t
 );

342 
DECLARE_DO_FUN
Ğ
do_qu™
 );

343 
DECLARE_DO_FUN
Ğ
do_qwe¡
 );

344 
DECLARE_DO_FUN
Ğ
do_¿ff£t
 );

345 
DECLARE_DO_FUN
Ğ
do_¿ge
 );

346 
DECLARE_DO_FUN
Ğ
do_¿nk
 );

347 
DECLARE_DO_FUN
Ğ
do_rch©
 );

348 
DECLARE_DO_FUN
Ğ
do_rcÚÃù
 );

349 
DECLARE_DO_FUN
Ğ
do_rdebug
 );

350 
DECLARE_DO_FUN
Ğ
do_rdiscÚÃù
 );

351 
DECLARE_DO_FUN
Ğ
do_»ad
 );

352 
DECLARE_DO_FUN
Ğ
do_»ad_fšg”
 );

353 
DECLARE_DO_FUN
Ğ
do_»boo
 );

354 
DECLARE_DO_FUN
Ğ
do_»boÙ
 );

355 
DECLARE_DO_FUN
Ğ
do_»ÿÎ
 );

356 
DECLARE_DO_FUN
Ğ
do_»cho
 );

357 
DECLARE_DO_FUN
Ğ
do_»c™e
 );

358 
DECLARE_DO_FUN
Ğ
do_»jeù
 );

360 
DECLARE_DO_FUN
Ğ
do_»Ëv–
 );

361 
DECLARE_DO_FUN
Ğ
do_»loÿ‹
 );

362 
DECLARE_DO_FUN
Ğ
do_»mÜt
 );

363 
DECLARE_DO_FUN
Ğ
do_»mex™
 );

364 
DECLARE_DO_FUN
Ğ
do_”emÜt
 );

365 
DECLARE_DO_FUN
Ğ
do_»move
 );

366 
DECLARE_DO_FUN
Ğ
do_»Çme
 );

367 
DECLARE_DO_FUN
Ğ
do_»·œ
 );

368 
DECLARE_DO_FUN
Ğ
do_»¶ay
 );

369 
DECLARE_DO_FUN
Ğ
do_»¶y
 );

370 
DECLARE_DO_FUN
Ğ
do_»pÜt
 );

371 
DECLARE_DO_FUN
Ğ
do_»scue
 );

372 
DECLARE_DO_FUN
Ğ
do_»¡
 );

373 
DECLARE_DO_FUN
Ğ
do_»¡Üe
 );

374 
DECLARE_DO_FUN
Ğ
do_»tuº
 );

375 
DECLARE_DO_FUN
Ğ
do_»voke
 );

376 
DECLARE_DO_FUN
Ğ
do_rid—
 );

377 
DECLARE_DO_FUN
Ğ
do_rignÜe
 );

378 
DECLARE_DO_FUN
Ğ
do_¾i¡
 );

379 
DECLARE_DO_FUN
Ğ
do_rŞ•Ïy
 );

380 
DECLARE_DO_FUN
Ğ
do_roomex™s
 );

381 
DECLARE_DO_FUN
Ğ
do_roomli¡
 );

382 
DECLARE_DO_FUN
Ğ
do_rÙ©e
 );

383 
DECLARE_DO_FUN
Ğ
do_½·w¬d
 );

384 
DECLARE_DO_FUN
Ğ
do_¼•ly
 );

385 
DECLARE_DO_FUN
Ğ
do_r£t
 );

386 
DECLARE_DO_FUN
Ğ
do_rsock‘s
 );

387 
DECLARE_DO_FUN
Ğ
do_r¡©
 );

388 
DECLARE_DO_FUN
Ğ
do_¹–l
 );

389 
DECLARE_DO_FUN
Ğ
do_ruËs
 );

390 
DECLARE_DO_FUN
Ğ
do_rwh”e
 );

391 
DECLARE_DO_FUN
Ğ
do_rwho
 );

392 
DECLARE_DO_FUN
Ğ
do_§üifiû
 );

393 
DECLARE_DO_FUN
Ğ
do_§ve
 );

394 
DECLARE_DO_FUN
Ğ
do_§y
 );

395 
DECLARE_DO_FUN
Ğ
do_sÿn
 );

396 
DECLARE_DO_FUN
Ğ
do_sÿ‰”
 );

397 
DECLARE_DO_FUN
Ğ
do_scÚ
 );

398 
DECLARE_DO_FUN
Ğ
do_scÜe
 );

399 
DECLARE_DO_FUN
Ğ
do_süibe
 );

400 
DECLARE_DO_FUN
Ğ
do_süŞl
 );

401 
DECLARE_DO_FUN
Ğ
do_£cÚd
 );

402 
DECLARE_DO_FUN
Ğ
do_£cu»
 );

403 
DECLARE_DO_FUN
Ğ
do_£d™
 );

404 
DECLARE_DO_FUN
Ğ
do_£Î
 );

405 
DECLARE_DO_FUN
Ğ
do_£nd_ªnounû
);

406 
DECLARE_DO_FUN
Ğ
do_£t
 );

407 
DECLARE_DO_FUN
Ğ
do_£tgameš
 );

408 
DECLARE_DO_FUN
Ğ
do_£tgameout
 );

409 
DECLARE_DO_FUN
Ğ
do_shadow
 );

411 
DECLARE_DO_FUN
Ğ
do_show
 );

412 
DECLARE_DO_FUN
Ğ
do_showæags
 );

413 
DECLARE_DO_FUN
Ğ
do_showÏ¡
 );

414 
DECLARE_DO_FUN
Ğ
do_showlo¡
 );

415 
DECLARE_DO_FUN
Ğ
do_show¿ff
 );

416 
DECLARE_DO_FUN
Ğ
do_shutdow
 );

417 
DECLARE_DO_FUN
Ğ
do_shutdown
 );

418 
DECLARE_DO_FUN
Ğ
do_sšg
 );

419 
DECLARE_DO_FUN
Ğ
do_s™
 );

420 
DECLARE_DO_FUN
Ğ
do_skls
 );

421 
DECLARE_DO_FUN
Ğ
do_skÍošt
 );

422 
DECLARE_DO_FUN
Ğ
do_¦a
 );

423 
DECLARE_DO_FUN
Ğ
do_¦ay
 );

424 
DECLARE_DO_FUN
Ğ
do_¦“p
 );

425 
DECLARE_DO_FUN
Ğ
do_¦ookup
 );

426 
DECLARE_DO_FUN
Ğ
do_sm™e
 );

427 
DECLARE_DO_FUN
Ğ
do_smÙe
 );

428 
DECLARE_DO_FUN
Ğ
do_¢—k
 );

429 
DECLARE_DO_FUN
Ğ
do_¢oİ
 );

430 
DECLARE_DO_FUN
Ğ
do_socŸls
 );

431 
DECLARE_DO_FUN
Ğ
do_sock‘s
 );

432 
DECLARE_DO_FUN
Ğ
do_south
 );

433 
DECLARE_DO_FUN
Ğ
do_¥–ls
 );

434 
DECLARE_DO_FUN
Ğ
do_¥l™
 );

435 
DECLARE_DO_FUN
Ğ
do_¥ou£g©e
 );

436 
DECLARE_DO_FUN
Ğ
do_¥ou£lk
 );

437 
DECLARE_DO_FUN
Ğ
do_s£t
 );

438 
DECLARE_DO_FUN
Ğ
do_¡ªd
 );

439 
DECLARE_DO_FUN
Ğ
do_¡©
 );

440 
DECLARE_DO_FUN
Ğ
do_¡—l
 );

441 
DECLARE_DO_FUN
Ğ
do_¡Üage
 );

442 
DECLARE_DO_FUN
Ğ
do_¡Üy
 );

443 
DECLARE_DO_FUN
Ğ
do_¡ršg
 );

444 
DECLARE_DO_FUN
Ğ
do_¡rÚgbox
 );

445 
DECLARE_DO_FUN
Ğ
do_su³rwiz
 );

446 
DECLARE_DO_FUN
Ğ
do_swho
 );

447 
DECLARE_DO_FUN
Ğ
do_sw™ch
 );

448 
DECLARE_DO_FUN
Ğ
do_
 );

449 
DECLARE_DO_FUN
Ğ
do_‹Î
 );

450 
DECLARE_DO_FUN
Ğ
do_‹¡po£
 );

451 
DECLARE_DO_FUN
Ğ
do_time
 );

452 
DECLARE_DO_FUN
Ğ
do_t™Ë
 );

453 
DECLARE_DO_FUN
Ğ
do_touch
 );

454 
DECLARE_DO_FUN
Ğ
do_Œaš
 );

455 
DECLARE_DO_FUN
Ğ
do_Œade
 );

456 
DECLARE_DO_FUN
Ğ
do_Œªsãr
 );

457 
DECLARE_DO_FUN
Ğ
do_Œ
 );

458 
DECLARE_DO_FUN
Ğ
do_ty³li¡
 );

459 
DECLARE_DO_FUN
Ğ
do_typo
 );

460 
DECLARE_DO_FUN
Ğ
do_uÇlŸs
 );

461 
DECLARE_DO_FUN
Ğ
do_und’y
 );

462 
DECLARE_DO_FUN
Ğ
do_unjoš
 );

463 
DECLARE_DO_FUN
Ğ
do_uÆock
 );

464 
DECLARE_DO_FUN
Ğ
do_uÄ—d
 );

465 
DECLARE_DO_FUN
Ğ
do_up
 );

466 
DECLARE_DO_FUN
Ğ
do_v®ue
 );

467 
DECLARE_DO_FUN
Ğ
do_video
 );

468 
DECLARE_DO_FUN
Ğ
do_viŞ©e
 );

469 
DECLARE_DO_FUN
Ğ
do_visibË
 );

470 
DECLARE_DO_FUN
Ğ
do_vli¡
 );

471 
DECLARE_DO_FUN
Ğ
do_vnum
 );

472 
DECLARE_DO_FUN
Ğ
do_vt100
 );

473 
DECLARE_DO_FUN
Ğ
do_wake
 );

474 
DECLARE_DO_FUN
Ğ
do_w¬p
 );

475 
DECLARE_DO_FUN
Ğ
do_w¬
 );

476 
DECLARE_DO_FUN
Ğ
do_wbb
 );

477 
DECLARE_DO_FUN
Ğ
do_wbi
 );

478 
DECLARE_DO_FUN
Ğ
do_w—r
 );

479 
DECLARE_DO_FUN
Ğ
do_w—th”
 );

480 
DECLARE_DO_FUN
Ğ
do_weddšgršg
 );

481 
DECLARE_DO_FUN
Ğ
do_we¡
 );

482 
DECLARE_DO_FUN
Ğ
do_wh”e
 );

483 
DECLARE_DO_FUN
Ğ
do_whi¥”
 );

484 
DECLARE_DO_FUN
Ğ
do_who
 );

485 
DECLARE_DO_FUN
Ğ
do_whois
 );

486 
DECLARE_DO_FUN
Ğ
do_wimpy
 );

487 
DECLARE_DO_FUN
Ğ
do_w™hd¿w
 );

488 
DECLARE_DO_FUN
Ğ
do_wizgroup
 );

489 
DECLARE_DO_FUN
Ğ
do_wizh–p
 );

490 
DECLARE_DO_FUN
Ğ
do_wizify
 );

491 
DECLARE_DO_FUN
Ğ
do_wizli¡
 );

492 
DECLARE_DO_FUN
Ğ
do_wizlock
 );

493 
DECLARE_DO_FUN
Ğ
do_wizÃt
 );

494 
DECLARE_DO_FUN
Ğ
do_wÜth
 );

495 
DECLARE_DO_FUN
Ğ
do_wÜk
 );

496 
DECLARE_DO_FUN
Ğ
do_y–l
 );

497 
DECLARE_DO_FUN
Ğ
do_z­
 );

498 
DECLARE_DO_FUN
Ğ
do_zecho
 );

	@src/include/lookup.hh

1 #´agm¨
Úû


4 
	~"SŒšg.hh
"

5 
	~"SeùÜ.hh
"

6 
	~"Gud.hh
"

8 
şass
 
	gCÏn
;

9 
şass
 
	gVnum
;

11 
CÏn
 *
şª_vnum_lookup
 
¬gs
((cÚ¡ 
Vnum
& 
vnum
));

12 
CÏn
 * 
şª_lookup
 
¬gs
((cÚ¡ 
SŒšg
& 
Çme
));

13 
pos™iÚ_lookup
 
¬gs
((cÚ¡ 
SŒšg
& 
Çme
));

14 
£x_lookup
 
¬gs
((cÚ¡ 
SŒšg
& 
Çme
));

15 
size_lookup
 
¬gs
((cÚ¡ 
SŒšg
& 
Çme
));

16 
SŒšg
 
cÚd™iÚ_lookup
 
¬gs
((
cÚd™iÚ
));

17 
liq_lookup
 
¬gs
((cÚ¡ 
SŒšg
& 
Çme
));

18 
SŒšg
 
£ùÜ_lookup
 
¬gs
((
SeùÜ
 
ty³
));

19 
liq_lookup
 
¬gs
ĞĞcÚ¡ 
SŒšg
& 
Çme
) );

20 
w—pÚ_lookup
 
¬gs
ĞĞcÚ¡ 
SŒšg
& 
Çme
) );

21 
™em_lookup
 
¬gs
ĞĞcÚ¡ 
SŒšg
& 
Çme
) );

22 
©ck_lookup
 
¬gs
(ĞcÚ¡ 
SŒšg
& 
Çme
) );

23 
¿û_lookup
 
¬gs
(ĞcÚ¡ 
SŒšg
& 
Çme
) );

24 
Gud
 
gud_lookup
 
¬gs
(ĞcÚ¡ 
SŒšg
& 
Çme
) );

25 
de™y_lookup
 
¬gs
(ĞcÚ¡ 
SŒšg
& 
Çme
) );

	@src/include/lootv2.hh

1 #´agm¨
Úû


7 
	~"afãù/Ty³.hh
"

8 
	~"SŒšg.hh
"

10 
Objeù
 *
g’”©e_eq
(
Ëv–
);

13 
	#OBJ_VNUM_LIGHT
 24356

	)

14 
	#OBJ_VNUM_FINGER
 24357

	)

15 
	#OBJ_VNUM_NECK
 24358

	)

16 
	#OBJ_VNUM_TORSO
 24359

	)

17 
	#OBJ_VNUM_HEAD
 24360

	)

18 
	#OBJ_VNUM_LEGS
 24361

	)

19 
	#OBJ_VNUM_FEET
 24362

	)

20 
	#OBJ_VNUM_HANDS
 24363

	)

21 
	#OBJ_VNUM_ARMS
 24364

	)

22 
	#OBJ_VNUM_SHIELD
 24365

	)

23 
	#OBJ_VNUM_BODY
 24366

	)

24 
	#OBJ_VNUM_WAIST
 24367

	)

25 
	#OBJ_VNUM_WRIST
 24368

	)

26 
	#OBJ_VNUM_FLOATING
 24355

	)

27 
	#OBJ_VNUM_HOLD
 24369

	)

30 
	#OBJ_VNUM_WIELD_AXE
 24370

	)

31 
	#OBJ_VNUM_WIELD_DAGGER
 24371

	)

32 
	#OBJ_VNUM_WIELD_EXOTIC
 24372

	)

33 
	#OBJ_VNUM_WIELD_FLAIL
 24373

	)

34 
	#OBJ_VNUM_WIELD_MACE
 24374

	)

35 
	#OBJ_VNUM_WIELD_POLEARM
 24375

	)

36 
	#OBJ_VNUM_WIELD_SPEAR
 24376

	)

37 
	#OBJ_VNUM_WIELD_SWORD
 24377

	)

38 
	#OBJ_VNUM_WIELD_WHIP
 24378

	)

39 
	#OBJ_VNUM_WIELD_BOW
 24379

	)

44 
	#ARMOR_LIGHT
 100

	)

45 
	#ARMOR_FINGER
 101

	)

46 
	#ARMOR_NECK
 102

	)

47 
	#ARMOR_TORSO
 103

	)

48 
	#ARMOR_HEAD
 104

	)

49 
	#ARMOR_LEGS
 105

	)

50 
	#ARMOR_FEET
 106

	)

51 
	#ARMOR_HANDS
 107

	)

52 
	#ARMOR_ARMS
 108

	)

53 
	#ARMOR_SHIELD
 109

	)

54 
	#ARMOR_BODY
 110

	)

55 
	#ARMOR_WAIST
 111

	)

56 
	#ARMOR_WRIST
 112

	)

57 
	#ARMOR_FLOATING
 113

	)

58 
	#ARMOR_HOLD
 114

	)

59 
	#WIELD_AXE
 200

	)

60 
	#WIELD_DAGGER
 201

	)

61 
	#WIELD_EXOTIC
 202

	)

62 
	#WIELD_FLAIL
 203

	)

63 
	#WIELD_MACE
 204

	)

64 
	#WIELD_POLEARM
 205

	)

65 
	#WIELD_SPEAR
 206

	)

66 
	#WIELD_SWORD
 207

	)

67 
	#WIELD_WHIP
 208

	)

68 
	#WIELD_BOW
 209

	)

76 cÚ¡ 
¡d
::
muÉim­
<, 
SŒšg
> 
ba£_Çme_bË
;

79 cÚ¡ 
¡d
::
veùÜ
<
SŒšg
> 
Ëg’d¬y_ba£_poŞ_bË
;

80 cÚ¡ 
¡d
::
m­
<, std::
veùÜ
<
SŒšg
> > 
Ëg’d¬y_Çme_bË
;

82 
	smod_t
 {

83 
SŒšg
 
	m‹xt
;

84 
	mgroup
;

85 
	m¿r™y
;

86 
	maf_wh”e
;

87 
	maf_loc
;

88 
	maf_mod_mš
;

89 
	maf_mod_max
;

90 
boŞ
 
	msÿlšg
;

94 cÚ¡ 
¡d
::
muÉim­
<, 
afãù
::
ty³
> 
´efixes_®lowed
;

95 cÚ¡ 
¡d
::
muÉim­
<, 
afãù
::
ty³
> 
suffixes_®lowed
;

96 cÚ¡ 
¡d
::
m­
<
afãù
::
ty³
, 
mod_t
> 
mod_bË
;

100 
	s£t_g—r
 {

101 
	m£t_Çme
;

102 
SŒšg
 
	mdi¥Ïy
;

103 
SŒšg
 
	m£t1
;

104 
SŒšg
 
	m£t2
;

105 
SŒšg
 
	m£t3
;

106 
SŒšg
 
	m£t4
;

107 
SŒšg
 
	m£t5
;

110 cÚ¡ 
¡d
::
veùÜ
<
£t_g—r
> 
£t_bË
;

	@src/include/macros.hh

1 #´agm¨
Úû


3 
	~"deş¬e.hh
"

4 
	~<®gÜ™hm
>

9 
	#UMIN
(
a
, 
b
è(
¡d
::
	`mš
(×), (b)))

	)

10 
	#UMAX
(
a
, 
b
è(
¡d
::
	`max
(×), (b)))

	)

13 
	#URANGE
(
a
, 
b
, 
c
è((bè< (aè? (aè: ((bè> (cè? (cè: (b)))

	)

14 
	#LOWER
(
c
è((cè>ğ'A' && (cè<ğ'Z' ? (c)+'a'-'A' : (c))

	)

15 
	#UPPER
(
c
è((cè>ğ'a' && (cè<ğ'z' ? (c)+'A'-'a' : (c))

	)

17 
	#chªû
(
´c
è(((
	`numb”_¿nge
(1,100)è<ğÕrc)))

	)

18 
	#rounddown
(
x
, 
šc
è((šø> xè? 0 : (x - (x % inc)))

	)

19 
	#roundup
(
x
, 
šc
è((šø> xè? inø: (x - ((x % incè=ğ0 ? inø: (x % inc)è+ inc))

	)

21 
	#CHARTYPE_TEST
(
chx
è(
	`IS_NPC
(chxè? 
ENTITY_M
 : 
ENTITY_P
)

	)

22 
	#CHARTYPE_MATCH
(
chx
,
ù
è((
	`CHARTYPE_TEST
(chxè& ctè!ğ0)

	)

25 
	#IS_QUESTSHOPKEEPER
(
mob
è((mob->
pIndexD©a
->
pShİ
 !ğ
nuÎ±r
è&& (mob->pIndexD©a->pShİ->
buy_ty³
[0] =ğ
ITEM_QUESTSHOP
))

	)

30 
	#IS_NPC
(
ch
è((ch)->
pcd©a
 =ğ
nuÎ±r
 ? 
TRUE
 : 
FALSE
)

	)

31 
	#IS_PLAYING
(
d
è(d && d->
cÚÃùed
 =ğ
CON_PLAYING
 && d->
ch¬aù”
)

	)

35 
	#ATTR_BASE
(
ch
, 
wh”e
è((ch)->
©Œ_ba£
[where])

36 
	#GET_ATTR_MOD
(
ch
, 
wh”e
è((ch)->
­¶y_ÿche
 ? (ch)->apply_cache[where] : 0)

37 
	#GET_ATTR
(
ch
, 
wh”e
è(
	`ATTR_BASE
(ch, wh”eè+ 
	`GET_ATTR_MOD
(ch, where))

38 

	)

39 
	#GET_ATTR_STR
(
ch
è(
	`URANGE
(3, 
	`GET_ATTR
(ch, 
APPLY_STR
), 
	`g‘_max_¡©
(ch, 
STAT_STR
)))

	)

40 
	#GET_ATTR_INT
(
ch
è(
	`URANGE
(3, 
	`GET_ATTR
(ch, 
APPLY_INT
), 
	`g‘_max_¡©
(ch, 
STAT_INT
)))

	)

41 
	#GET_ATTR_WIS
(
ch
è(
	`URANGE
(3, 
	`GET_ATTR
(ch, 
APPLY_WIS
), 
	`g‘_max_¡©
(ch, 
STAT_WIS
)))

	)

42 
	#GET_ATTR_DEX
(
ch
è(
	`URANGE
(3, 
	`GET_ATTR
(ch, 
APPLY_DEX
), 
	`g‘_max_¡©
(ch, 
STAT_DEX
)))

	)

43 
	#GET_ATTR_CON
(
ch
è(
	`URANGE
(3, 
	`GET_ATTR
(ch, 
APPLY_CON
), 
	`g‘_max_¡©
(ch, 
STAT_CON
)))

	)

44 
	#GET_ATTR_CHR
(
ch
è(
	`URANGE
(3, 
	`GET_ATTR
(ch, 
APPLY_CHR
), 
	`g‘_max_¡©
(ch, 
STAT_CHR
)))

	)

45 
	#GET_ATTR_SEX
(
ch
è(
	`GET_ATTR
((ch), 
APPLY_SEX
) % 3)

46 
	#GET_ATTR_AGE
(
ch
è(
	`g‘_age
(ch))

	)

48 + ( 
IS_AWAKE
(
ch
) \

49 ? 
	gdex_­p
[
GET_ATTR_DEX
(
ch
)].
	gdeãnsive
 : 0 ) \

50 - (Ğ!
IS_NPC
(
ch
è&& ch->
pcd©a
->
»mÜt_couÁ
 > 0 ) \

51 ? (((
ch
->
pcd©a
->
»mÜt_couÁ
 * ch->
Ëv–
) / 50)) : 0 ))

53 
	#GET_ATTR_HITROLL
(
ch
) \

54 (
	`GET_ATTR
((
ch
), 
APPLY_HITROLL
è+ 
¡r_­p
[
	`GET_ATTR_STR
((ch))].
toh™
)

	)

55 
	#GET_ATTR_DAMROLL
(
ch
) \

56 (
	`GET_ATTR
((
ch
), 
APPLY_DAMROLL
è+ 
¡r_­p
[
	`GET_ATTR_STR
((ch))].
todam
)

	)

57 
	#GET_ATTR_SAVES
(
ch
è(
	`GET_ATTR
((ch), 
APPLY_SAVES
))

	)

60 (
GET_ATTR
((
ch
), 
APPLY_HIT
) + ((GET_ATTR((ch), APPLY_HIT) * .2))) : \

61 
GET_ATTR
((
ch
), 
APPLY_HIT
)), 30000))

64 
	#GET_DEFENSE_MOD
(
ch
, 
dam_ty³
è(dam_ty³ =ğ
DAM_NONE
 ? 0 : \

65 (
ch
)->
deãn£_mod
 ? (ch)->deãn£_mod[
dam_ty³
] : 0)

	)

70 
	#IS_HERO
(
ch
è(!
	`IS_NPC
(chè&& ch->
Ëv–
 >ğ
LEVEL_HERO
)

	)

71 
	#IS_REMORT
(
ch
è(!
	`IS_NPC
(chè&& ch->
pcd©a
->
»mÜt_couÁ
 > 0)

	)

72 
	#IS_HEROIC
(
ch
è(
	`IS_HERO
(chè|| 
	`IS_REMORT
(ch))

	)

73 
	#IS_IMM_GROUP
(
æags
è(
	`FÏgs
(
GROUP_GEN
|
GROUP_QUEST
|
GROUP_BUILD
|
GROUP_CODE
|
GROUP_SECURE
).
	`has_ªy_of
(æags))

	)

74 
	#RANK
(
æags
è(
	`IS_IMM_GROUP
(flags) ? \

75 (
æags
.
	`has
(
GROUP_LEADER
è? 
RANK_IMP
 : \

76 (
æags
.
	`has
(
GROUP_DEPUTY
è? 
RANK_HEAD
 : 
RANK_IMM
)) : \

77 (
æags
.
	`has
(
GROUP_PLAYER
è? 
RANK_MORTAL
 : 
RANK_MOBILE
))

	)

78 
	#GET_RANK
(
ch
è(
	`IS_NPC
(chè? 
RANK_MOBILE
 : 
	`RANK
(ch->
pcd©a
->
cgroup_æags
))

	)

79 
	#IS_IMMORTAL
(
ch
è(
	`GET_RANK
(chè>ğ
RANK_IMM
)

	)

80 
	#IS_IMP
(
ch
è(
	`GET_RANK
(chè=ğ
RANK_IMP
)

	)

81 
	#IS_HEAD
(
ch
è(
	`GET_RANK
(chè>ğ
RANK_HEAD
)

	)

82 
	#OUTRANKS
(
ch
, 
viùim
è(
	`GET_RANK
(chè> GET_RANK(viùim))

	)

85 
	#IS_GOOD
(
ch
è(ch->
®ignm’t
 >ğ350)

	)

86 
	#IS_EVIL
(
ch
è(ch->
®ignm’t
 <ğ-350)

	)

87 
	#IS_NEUTRAL
(
ch
è(!
	`IS_GOOD
(chè&& !
	`IS_EVIL
(ch))

	)

89 
	#IS_AWAKE
(
ch
è(ch->
pos™iÚ
 > 
POS_SLEEPING
)

	)

90 
	#IS_OUTSIDE
(
ch
è(!(ch)->
š_room
->
	`æags
().
	`has
(
ROOM_INDOORS
))

	)

92 
	#WAIT_STATE
(
ch
, 
Åul£
è(!
	`IS_IMMORTAL
(ch) ? \

93 (
ch
->
wa™
 = 
	`UMAX
(ch->wa™, 
Åul£
)è: (ch->wa™ = 0))

	)

94 
	#DAZE_STATE
(
ch
, 
Åul£
è(!
	`IS_IMMORTAL
(ch) ? \

95 (
ch
->
daze
 = 
	`UMAX
(ch->daze, 
Åul£
)è: (ch->dazğ0))

	)

96 
	#gŞd_weight
(
amouÁ
è(×mouÁè* 2 / 5)

	)

97 
	#sv”_weight
(
amouÁ
è(×mouÁ)/ 10)

	)

98 
	#IS_QUESTOR
(
ch
è((ch)->
aù_æags
.
	`has
(
PLR_QUESTOR
))

	)

99 
	#IS_SQUESTOR
(
ch
è(!
	`IS_NPC
(chè&& (ch)->
pcd©a
->
¶r_æags
.
	`has
(
PLR_SQUESTOR
))

	)

100 
	#IS_KILLER
(
ch
è((ch)->
aù_æags
.
	`has
(
PLR_KILLER
))

	)

101 
	#IS_THIEF
(
ch
è((ch)->
aù_æags
.
	`has
(
PLR_THIEF
))

	)

102 
	#CAN_FLY
(
ch
è(
afãù
::
	`exi¡s_Ú_ch¬
((ch),‡fãù::
ty³
::
æy
))

	)

103 
	#IS_FLYING
(
ch
è((ch)->
pos™iÚ
 >ğ
POS_FLYING
)

	)

108 
	#CAN_WEAR
(
obj
, 
·¹
è((obj)->
w—r_æags
.
	`has
(Õ¬t)))

	)

109 
	#IS_OBJ_STAT
(
obj
, 
¡©
è(((obj)->
exŒa_æags
 + (obj)->
ÿched_exŒa_æags
).
	`has
((¡©)))

	)

110 
	#WEIGHT_MULT
(
obj
è((obj)->
™em_ty³
 =ğ
ITEM_CONTAINER
 ? \

111 (
obj
)->
v®ue
[4] : 100)

	)

120 
	#CH
(
d
è((d)->
Üigš®
 ? (d)->Üigš® : (d)->
ch¬aù”
 )

	)

126 
	#PERS
(
ch
, 
look”
, 
vis
èĞ(vi =ğ
VIS_ALL
 \

127 || (
vis
 =ğ
VIS_CHAR
 && 
	`ÿn_£e_ch¬
(
look”
, 
ch
)) \

128 || (
vis
 =ğ
VIS_PLR
 && 
	`ÿn_£e_who
(
look”
, 
ch
))) ? \

129 
	`IS_NPC
(
ch
è? ch->
shÜt_desü
 : ch->
Çme
 : "someÚe")

	)

	@src/include/magic.hh

1 #´agm¨
Úû


3 
	~"deş¬e.hh
"

4 
	~"skl/Ty³.hh
"

6 
	tSPELL_FUN
 
	t¬gs
(Ğ
	tskl
::
	tty³
 
	t¢
, 
	tËv–
, 
	tCh¬aù”
 *
	tch
, *
	tvo
, 
	trg‘
, 
	tevŞutiÚ
));

8 
	#DECLARE_SPELL_FUN
Ğ
fun
 ) 
SPELL_FUN
 
	)
fun

14 
DECLARE_SPELL_FUN
Ğ
¥–l_nuÎ
 );

15 
DECLARE_SPELL_FUN
Ğ
¥–l_acid_bÏ¡
 );

16 
DECLARE_SPELL_FUN
Ğ
¥–l_acid_b»©h
 );

17 
DECLARE_SPELL_FUN
Ğ
¥–l_acid_¿š
 );

18 
DECLARE_SPELL_FUN
Ğ
¥–l_age
 );

19 
DECLARE_SPELL_FUN
Ğ
¥–l_¬mÜ
 );

20 
DECLARE_SPELL_FUN
Ğ
¥–l_bËss
 );

21 
DECLARE_SPELL_FUN
Ğ
¥–l_blšdÃss
 );

22 
DECLARE_SPELL_FUN
Ğ
¥–l_blizz¬d
 );

23 
DECLARE_SPELL_FUN
Ğ
¥–l_blood_moÚ
 );

24 
DECLARE_SPELL_FUN
Ğ
¥–l_blood_bÏde
 );

25 
DECLARE_SPELL_FUN
Ğ
¥–l_bÚe_w®l
 );

26 
DECLARE_SPELL_FUN
Ğ
¥–l_buºšg_hªds
 );

27 
DECLARE_SPELL_FUN
Ğ
¥–l_ÿÎ_lighŠšg
 );

28 
DECLARE_SPELL_FUN
Ğ
¥–l_ÿlm
 );

29 
DECLARE_SPELL_FUN
Ğ
¥–l_ÿnûÎ©iÚ
 );

30 
DECLARE_SPELL_FUN
Ğ
¥–l_ÿu£_ü™iÿl
 );

31 
DECLARE_SPELL_FUN
Ğ
¥–l_ÿu£_light
 );

32 
DECLARE_SPELL_FUN
Ğ
¥–l_ÿu£_£rious
 );

33 
DECLARE_SPELL_FUN
Ğ
¥–l_chaš_lighŠšg
 );

34 
DECLARE_SPELL_FUN
Ğ
¥–l_chªge_£x
 );

35 
DECLARE_SPELL_FUN
Ğ
¥–l_chªÃl
 );

36 
DECLARE_SPELL_FUN
Ğ
¥–l_ch¬m_³rsÚ
 );

37 
DECLARE_SPELL_FUN
Ğ
¥–l_chl_touch
 );

38 
DECLARE_SPELL_FUN
Ğ
¥–l_cŞour_¥¿y
 );

39 
DECLARE_SPELL_FUN
Ğ
¥–l_cÚtšu®_light
 );

40 
DECLARE_SPELL_FUN
Ğ
¥–l_cÚŒŞ_w—th”
 );

41 
DECLARE_SPELL_FUN
Ğ
¥–l_’ÿmpm’t
 );

42 
DECLARE_SPELL_FUN
Ğ
¥–l_ü—‹_food
 );

43 
DECLARE_SPELL_FUN
Ğ
¥–l_ü—‹_·rchm’t
 );

44 
DECLARE_SPELL_FUN
Ğ
¥–l_ü—‹_ro£
 );

45 
DECLARE_SPELL_FUN
Ğ
¥–l_ü—‹_sign
 );

46 
DECLARE_SPELL_FUN
Ğ
¥–l_ü—‹_¥ršg
 );

47 
DECLARE_SPELL_FUN
Ğ
¥–l_ü—‹_w©”
 );

48 
DECLARE_SPELL_FUN
Ğ
¥–l_ü—‹_vŸl
 );

49 
DECLARE_SPELL_FUN
Ğ
¥–l_cu»_blšdÃss
 );

50 
DECLARE_SPELL_FUN
Ğ
¥–l_cu»_ü™iÿl
 );

51 
DECLARE_SPELL_FUN
Ğ
¥–l_cu»_di£a£
 );

52 
DECLARE_SPELL_FUN
Ğ
¥–l_cu»_light
 );

53 
DECLARE_SPELL_FUN
Ğ
¥–l_cu»_poisÚ
 );

54 
DECLARE_SPELL_FUN
Ğ
¥–l_cu»_£rious
 );

55 
DECLARE_SPELL_FUN
Ğ
¥–l_cur£
 );

56 
DECLARE_SPELL_FUN
Ğ
¥–l_d¬kÃss
 );

57 
DECLARE_SPELL_FUN
Ğ
¥–l_dazzlšg_light
 );

58 
DECLARE_SPELL_FUN
Ğ
¥–l_demÚfœe
 );

59 
DECLARE_SPELL_FUN
Ğ
¥–l_d‘eù_ev
 );

60 
DECLARE_SPELL_FUN
Ğ
¥–l_d‘eù_good
 );

61 
DECLARE_SPELL_FUN
Ğ
¥–l_d‘eù_hidd’
 );

62 
DECLARE_SPELL_FUN
Ğ
¥–l_d‘eù_švis
 );

63 
DECLARE_SPELL_FUN
Ğ
¥–l_d‘eù_magic
 );

64 
DECLARE_SPELL_FUN
Ğ
¥–l_d‘eù_poisÚ
 );

65 
DECLARE_SPELL_FUN
Ğ
¥–l_di¥–_ev
 );

66 
DECLARE_SPELL_FUN
Ğ
¥–l_di¥–_good
 );

67 
DECLARE_SPELL_FUN
Ğ
¥–l_di¥–_magic
 );

68 
DECLARE_SPELL_FUN
Ğ
¥–l_divše_h—lšg
 );

69 
DECLARE_SPELL_FUN
Ğ
¥–l_divše_»g’”©iÚ
);

70 
DECLARE_SPELL_FUN
Ğ
¥–l_—¹hquake
 );

71 
DECLARE_SPELL_FUN
Ğ
¥–l_’chªt_¬mÜ
 );

72 
DECLARE_SPELL_FUN
Ğ
¥–l_’chªt_w—pÚ
 );

73 
DECLARE_SPELL_FUN
Ğ
¥–l_’”gy_d¿š
 );

74 
DECLARE_SPELL_FUN
Ğ
¥–l_ç”›_fœe
 );

75 
DECLARE_SPELL_FUN
Ğ
¥–l_ç”›_fog
 );

76 
DECLARE_SPELL_FUN
Ğ
¥–l_çrsight
 );

77 
DECLARE_SPELL_FUN
Ğ
¥–l_ã¬
 );

78 
DECLARE_SPELL_FUN
Ğ
¥–l_fœe_b»©h
 );

79 
DECLARE_SPELL_FUN
Ğ
¥–l_fœeb®l
 );

80 
DECLARE_SPELL_FUN
Ğ
¥–l_fœ•roof
 );

81 
DECLARE_SPELL_FUN
Ğ
¥–l_fœe¡Üm
 );

82 
DECLARE_SPELL_FUN
Ğ
¥–l_æamesh›ld
 );

83 
DECLARE_SPELL_FUN
Ğ
¥–l_æame¡rike
 );

84 
DECLARE_SPELL_FUN
Ğ
¥–l_æame_bÏde
 );

85 
DECLARE_SPELL_FUN
Ğ
¥–l_æßtšg_disc
 );

86 
DECLARE_SPELL_FUN
Ğ
¥–l_æy
 );

87 
DECLARE_SPELL_FUN
Ğ
¥–l_ä’zy
 );

88 
DECLARE_SPELL_FUN
Ğ
¥–l_äo¡_b»©h
 );

89 
DECLARE_SPELL_FUN
Ğ
¥–l_ªim©e_g¬goyË
 );

90 
DECLARE_SPELL_FUN
Ğ
¥–l_gas_b»©h
 );

91 
DECLARE_SPELL_FUN
Ğ
¥–l_g©e
 );

92 
DECLARE_SPELL_FUN
Ğ
¥–l_g’”®_pu½o£
 );

93 
DECLARE_SPELL_FUN
Ğ
¥–l_gŸÁ_¡»ngth
 );

94 
DECLARE_SPELL_FUN
Ğ
¥–l_h¬m
 );

95 
DECLARE_SPELL_FUN
Ğ
¥–l_ha¡e
 );

96 
DECLARE_SPELL_FUN
Ğ
¥–l_h—l
 );

97 
DECLARE_SPELL_FUN
Ğ
¥–l_h—t_m‘®
 );

98 
DECLARE_SPELL_FUN
Ğ
¥–l_high_ex¶osive
 );

99 
DECLARE_SPELL_FUN
Ğ
¥–l_hŞy_wÜd
 );

100 
DECLARE_SPELL_FUN
Ğ
¥–l_äo¡_bÏde
 );

101 
DECLARE_SPELL_FUN
Ğ
¥–l_id’tify
 );

102 
DECLARE_SPELL_FUN
Ğ
¥–l_šäavisiÚ
 );

103 
DECLARE_SPELL_FUN
Ğ
¥–l_švis
 );

104 
DECLARE_SPELL_FUN
Ğ
¥–l_know_®ignm’t
 );

105 
DECLARE_SPELL_FUN
Ğ
¥–l_light_of_Œuth
 );

106 
DECLARE_SPELL_FUN
Ğ
¥–l_lighŠšg_bŞt
 );

107 
DECLARE_SPELL_FUN
Ğ
¥–l_lighŠšg_b»©h
 );

108 
DECLARE_SPELL_FUN
Ğ
¥–l_loÿ‹_objeù
 );

109 
DECLARE_SPELL_FUN
Ğ
¥–l_loÿ‹_liã
 );

110 
DECLARE_SPELL_FUN
Ğ
¥–l_magic_misse
 );

111 
DECLARE_SPELL_FUN
Ğ
¥–l_mass_h—lšg
 );

112 
DECLARE_SPELL_FUN
Ğ
¥–l_mass_švis
 );

113 
DECLARE_SPELL_FUN
Ğ
¥–l_Ãxus
 );

114 
DECLARE_SPELL_FUN
Ğ
¥–l_·ss_doÜ
 );

115 
DECLARE_SPELL_FUN
Ğ
¥–l_¶ague
 );

116 
DECLARE_SPELL_FUN
Ğ
¥–l_poisÚ
 );

117 
DECLARE_SPELL_FUN
Ğ
¥–l_pŞymÜph
 );

118 
DECLARE_SPELL_FUN
Ğ
¥–l_pÜl
 );

119 
DECLARE_SPELL_FUN
Ğ
¥–l_pow”_wÜd
 );

120 
DECLARE_SPELL_FUN
Ğ
¥–l_´Ùeù_cÚš”
 );

121 
DECLARE_SPELL_FUN
Ğ
¥–l_´ÙeùiÚ_ev
 );

122 
DECLARE_SPELL_FUN
Ğ
¥–l_´ÙeùiÚ_good
 );

123 
DECLARE_SPELL_FUN
Ğ
¥–l_¿ybª
 );

124 
DECLARE_SPELL_FUN
Ğ
¥–l_¿y_of_Œuth
 );

125 
DECLARE_SPELL_FUN
Ğ
¥–l_»ch¬ge
 );

126 
DECLARE_SPELL_FUN
Ğ
¥–l_»äesh
 );

127 
DECLARE_SPELL_FUN
Ğ
¥–l_»g’”©iÚ
 );

128 
DECLARE_SPELL_FUN
Ğ
¥–l_»move_®ignm’t
 );

129 
DECLARE_SPELL_FUN
Ğ
¥–l_»move_cur£
 );

130 
DECLARE_SPELL_FUN
Ğ
¥–l_»move_švis
 );

131 
DECLARE_SPELL_FUN
Ğ
¥–l_»su¼eù
 );

132 
DECLARE_SPELL_FUN
Ğ
¥–l_§nùu¬y
 );

133 
DECLARE_SPELL_FUN
Ğ
¥–l_süy
 );

134 
DECLARE_SPELL_FUN
Ğ
¥–l_sh›ld
 );

135 
DECLARE_SPELL_FUN
Ğ
¥–l_shockšg_g¿¥
 );

136 
DECLARE_SPELL_FUN
Ğ
¥–l_shock_bÏde
 );

137 
DECLARE_SPELL_FUN
Ğ
¥–l_shršk
 );

138 
DECLARE_SPELL_FUN
Ğ
¥–l_ªim©e_sk–‘Ú
 );

139 
DECLARE_SPELL_FUN
Ğ
¥–l_¦“p
 );

140 
DECLARE_SPELL_FUN
Ğ
¥–l_¦ow
 );

141 
DECLARE_SPELL_FUN
Ğ
¥–l_smokesü“n
 );

142 
DECLARE_SPELL_FUN
Ğ
¥–l_¡¬ve
 );

143 
DECLARE_SPELL_FUN
Ğ
¥–l_¡“l_mi¡
 );

144 
DECLARE_SPELL_FUN
Ğ
¥–l_¡Úe_skš
 );

145 
DECLARE_SPELL_FUN
Ğ
¥–l_summÚ
 );

146 
DECLARE_SPELL_FUN
Ğ
¥–l_summÚ_objeù
 );

147 
DECLARE_SPELL_FUN
Ğ
¥–l_suÄay
 );

148 
DECLARE_SPELL_FUN
Ğ
¥–l_lÚ
 );

149 
DECLARE_SPELL_FUN
Ğ
¥–l_‹ËpÜt
 );

150 
DECLARE_SPELL_FUN
Ğ
¥–l_‹ËpÜt_objeù
 );

151 
DECLARE_SPELL_FUN
Ğ
¥–l_undo_¥–l
 );

152 
DECLARE_SPELL_FUN
Ğ
¥–l_v’Œoqu©e
 );

153 
DECLARE_SPELL_FUN
Ğ
¥–l_visiÚ
 );

154 
DECLARE_SPELL_FUN
Ğ
¥–l_w—k’
 );

155 
DECLARE_SPELL_FUN
Ğ
¥–l_wÜd_of_»ÿÎ
 );

156 
DECLARE_SPELL_FUN
Ğ
¥–l_ªim©e_w¿™h
 );

157 
DECLARE_SPELL_FUN
Ğ
¥–l_w¿th
 );

158 
DECLARE_SPELL_FUN
Ğ
¥–l_ªim©e_zomb›
 );

162 
DECLARE_SPELL_FUN
Ğ
¥–l_sh“n
 );

163 
DECLARE_SPELL_FUN
Ğ
¥–l_focus
 );

164 
DECLARE_SPELL_FUN
Ğ
¥–l_·¿lyze
 );

168 
DECLARE_SPELL_FUN
Ğ
¥–l_b¬r›r
 );

169 
DECLARE_SPELL_FUN
Ğ
¥–l_dazzË
 );

170 
DECLARE_SPELL_FUN
Ğ
¥–l_fuÎ_h—l
 );

173 
DECLARE_SPELL_FUN
Ğ
¥–l_midnight
 );

178 
DECLARE_SPELL_FUN
Ğ
¥–l_§p
 );

179 
DECLARE_SPELL_FUN
Ğ
¥–l_hex
 );

180 
DECLARE_SPELL_FUN
Ğ
¥–l_·š
 );

183 
DECLARE_SPELL_FUN
Ğ
¥–l_fÜû
 );

184 
DECLARE_SPELL_FUN
Ğ
¥–l_hŞy_swÜd
 );

187 
DECLARE_SPELL_FUN
Ğ
¥–l_quick
 );

	@src/include/memory.hh

1 #´agm¨
Úû


3 
	~"cÚ¡ªts.hh
"

17 
	#MAX_KEY_HASH
 1024

	)

18 
	#MAX_STRING_LENGTH
 4608

	)

19 
	#MAX_INPUT_LENGTH
 256

	)

20 
	#PAGELEN
 22

	)

23 
	#DEFENSE_MOD_MEM_SIZE
 ((è* 32)

	)

24 
	#APPLY_CACHE_MEM_SIZE
 ((è* 
MAX_ATTR
)

	)

26 
tİ_ex™
;

27 
tİ_mob_šdex
;

28 
tİ_obj_šdex
;

29 
tİ_»£t
;

30 
tİ_room
;

31 
tİ_shİ
;

	@src/include/merc.hh

1 #´agm¨
Úû


30 
	~<veùÜ
>

32 
	~"cÚ¡ªts.hh
"

33 
	~"deş¬e.hh
"

34 
	~"SŒšg.hh
"

41 
	#URANGE
(
a
, 
b
, 
c
è((bè< (aè? (aè: ((bè> (cè? (cè: (b)))

	)

47 
	s¡r_­p_ty³


49 
	mtoh™
;

50 
	mtodam
;

51 
	mÿ¼y
;

52 
	mw›ld
;

53 
	m¡p
;

56 
	sšt_­p_ty³


58 
	mË¬n
;

59 
	mmª­
;

62 
	swis_­p_ty³


64 
	m´aùiû
;

67 
	sdex_­p_ty³


69 
	mdeãnsive
;

72 
	scÚ_­p_ty³


74 
	mh™p
;

75 
	mshock
;

78 
	schr_­p_ty³


80 
	mchªû
;

85 
	sde™y_ty³


87 
SŒšg
 
	mÇme
;

88 
SŒšg
 
	m®ign
;

89 
	mv®ue
;

92 
	sgud_ty³


94 
SŒšg
 
	mÇme
;

95 
SŒšg
 
	mwho_Çme
;

96 
	m¡©_´ime
;

97 
	mw—pÚ
;

98 
	mskl_ad•t
;

99 
	mthac0_00
;

100 
	mthac0_32
;

101 
SŒšg
 
	mba£_group
;

102 
SŒšg
 
	mdeçuÉ_group
;

103 
	mhp_mš
;

104 
	mhp_max
;

105 
	mmªa_mš
;

106 
	mmªa_max
;

107 
	m¡am_mš
;

108 
	m¡am_max
;

111 
	s™em_ty³


113 
	mty³
;

114 
SŒšg
 
	mÇme
;

117 
	sw—pÚ_bË_t


119 
SŒšg
 
	mÇme
;

120 
	mvnum
;

121 
	mty³
;

122 
	mskl
::
ty³
 
skl
;

125 
	swizÃt_ty³


127 
SŒšg
 
	mÇme
;

128 
	mFÏgs
::
B™
 
æag
;

129 
	mËv–
;

130 
SŒšg
 
	mdesc
;

133 
	s©ck_ty³


135 
SŒšg
 
	mÇme
;

136 
SŒšg
 
	mnoun
;

137 
	mdamage
;

140 
	s¿û_ty³


142 
SŒšg
 
	mÇme
;

143 
boŞ
 
	mpc_¿û
;

144 
FÏgs
 
	maù
;

145 
FÏgs
 
	maff
;

146 
FÏgs
 
	moff
;

147 
FÏgs
 
	mimm
;

148 
FÏgs
 
	m»s
;

149 
FÏgs
 
	mvuÊ
;

150 
FÏgs
 
	mfÜm
;

151 
FÏgs
 
	m·¹s
;

155 
	spc_¿û_ty³


157 
SŒšg
 
	mÇme
;

158 
SŒšg
 
	mwho_Çme
;

159 
	mba£_age
;

160 
	mpošts
;

161 
	mgud_muÉ
[
Gud
::
size
];

162 
	m¡©s
[
MAX_STATS
];

163 
	mmax_¡©s
[
MAX_STATS
];

164 
	msize
;

165 
	m»mÜt_Ëv–
;

166 
SŒšg
 
	mskls
[5];

170 
	s¥ec_ty³


172 
SŒšg
 
	mÇme
;

173 
SPEC_FUN
 * 
	mfunùiÚ
;

181 
	sliq_ty³


183 
SŒšg
 
	mÇme
;

184 
SŒšg
 
	mcŞÜ
;

185 
	mafãù
[5];

190 
	sgroup_ty³


192 
SŒšg
 
	mÇme
;

193 
	m¿tšg
[
Gud
::
size
];

194 
	m¡d
::
veùÜ
<
SŒšg
> 
¥–ls
;

203 cÚ¡ 
¡r_­p_ty³
 
¡r_­p
 [26];

204 cÚ¡ 
št_­p_ty³
 
št_­p
 [26];

205 cÚ¡ 
wis_­p_ty³
 
wis_­p
 [26];

206 cÚ¡ 
dex_­p_ty³
 
dex_­p
 [26];

207 cÚ¡ 
cÚ_­p_ty³
 
cÚ_­p
 [26];

208 cÚ¡ 
chr_­p_ty³
 
chr_­p
 [26];

210 cÚ¡ 
¡d
::
veùÜ
<
gud_ty³
> 
gud_bË
;

211 cÚ¡ 
¡d
::
veùÜ
<
de™y_ty³
> 
de™y_bË
;

212 cÚ¡ 
¡d
::
veùÜ
<
w—pÚ_bË_t
> 
w—pÚ_bË
;

213 cÚ¡ 
¡d
::
veùÜ
<
™em_ty³
> 
™em_bË
;

214 cÚ¡ 
¡d
::
veùÜ
<
wizÃt_ty³
> 
wizÃt_bË
;

215 cÚ¡ 
¡d
::
veùÜ
<
©ck_ty³
> 
©ck_bË
;

216 cÚ¡ 
¡d
::
veùÜ
<
¿û_ty³
> 
¿û_bË
;

217 cÚ¡ 
¡d
::
veùÜ
<
pc_¿û_ty³
> 
pc_¿û_bË
;

218 cÚ¡ 
¡d
::
veùÜ
<
¥ec_ty³
> 
¥ec_bË
;

219 cÚ¡ 
¡d
::
veùÜ
<
liq_ty³
> 
liq_bË
;

220 cÚ¡ 
¡d
::
veùÜ
<
group_ty³
> 
group_bË
;

223 
SocŸl
 *
socŸl_bË_h—d
;

224 
SocŸl
 *
socŸl_bË_
;

227 
StÜedPÏy”
 *
¡Üage_li¡_h—d
;

228 
StÜedPÏy”
 *
¡Üage_li¡_
;

231 
D•¬‹dPÏy”
 *
d•¬‹d_li¡_h—d
;

232 
D•¬‹dPÏy”
 *
d•¬‹d_li¡_
;

233 *
d•¬‹d_li¡_lše
;

236 
W¬
 *
w¬_bË_h—d
;

237 
W¬
 *
w¬_bË_
;

	@src/include/music.hh

1 #´agm¨
Úû


3 
	~<veùÜ
>

4 
	~"cÚ¡ªts.hh
"

5 
	~"SŒšg.hh
"

7 
	#MAX_LINES
 100

	)

8 
	#MAX_GLOBAL
 10

	)

10 
	ssÚg_d©a


12 
SŒšg
 
	mgroup
;

13 
SŒšg
 
	mÇme
;

14 
SŒšg
 
	mlyrics
[
MAX_LINES
];

15 
	mlšes
;

18 
¡d
::
veùÜ
<
sÚg_d©a
> 
sÚg_bË
;

20 
sÚg_upd©e
();

21 
lßd_sÚgs
();

	@src/include/random.hh

1 #´agm¨
Úû


4 
numb”_fuzzy
 (
numb”
);

5 
numb”_¿nge
 (
äom
, 
to
);

6 
numb”_³rûÁ
 ();

7 
numb”_doÜ
 ();

8 
numb”_b™s
 (
width
);

9 
numb”_mm
 ();

10 
diû
 (
numb”
, 
size
);

11 
boŞ
 
rŞl_chªû
 (
³rûÁ
);

12 
boŞ
 
´d_chªû
 ( *
´ev_çs
, 
³rûÁ
 );

	@src/include/skill/Type.hh

1 #´agm¨
Úû


3 
Çme¥aû
 
	gskl
 {

5 şas 
	cty³
 {

6 
	gunknown
 = -1,

9 
	gacid_bÏ¡
,

10 
	gacid_b»©h
,

11 
	gacid_¿š
,

12 
	gage
,

13 
	gªim©e_sk–‘Ú
,

14 
	gªim©e_w¿™h
,

15 
	gªim©e_g¬goyË
,

16 
	gªim©e_zomb›
,

17 
	g¬mÜ
,

18 
	gbËss
,

19 
	gblšd_fight
,

20 
	gblšdÃss
,

21 
	gblizz¬d
,

22 
	gblood_bÏde
,

23 
	gblood_moÚ
,

24 
	gbuºšg_hªds
,

25 
	gÿÎ_lighŠšg
,

26 
	gÿlm
,

27 
	gÿnûÎ©iÚ
,

28 
	gÿu£_light
,

29 
	gÿu£_£rious
,

30 
	gÿu£_ü™iÿl
,

31 
	gchaš_lighŠšg
,

32 
	gchªge_£x
,

33 
	gchªÃl
,

34 
	gch¬m_³rsÚ
,

35 
	gchl_touch
,

36 
	gcŞour_¥¿y
,

37 
	gcÚtšu®_light
,

38 
	gcÚŒŞ_w—th”
,

39 
	gü—‹_food
,

40 
	gü—‹_·rchm’t
,

41 
	gü—‹_ro£
,

42 
	gü—‹_sign
,

43 
	gü—‹_¥ršg
,

44 
	gü—‹_vŸl
,

45 
	gü—‹_w©”
,

46 
	gcu»_blšdÃss
,

47 
	gcu»_ü™iÿl
,

48 
	gcu»_di£a£
,

49 
	gcu»_light
,

50 
	gcu»_poisÚ
,

51 
	gcu»_£rious
,

52 
	gcur£
,

53 
	gd¬kÃss
,

54 
	gdazzlšg_light
,

55 
	gdemÚfœe
,

56 
	gd‘eù_ev
,

57 
	gd‘eù_good
,

58 
	gd‘eù_hidd’
,

59 
	gd‘eù_švis
,

60 
	gd‘eù_magic
,

61 
	gd‘eù_poisÚ
,

62 
	gdi¥–_ev
,

63 
	gdi¥–_good
,

64 
	gdi¥–_magic
,

65 
	gdivše_h—lšg
,

66 
	gdivše_»g’”©iÚ
,

67 
	g—¹hquake
,

68 
	g’ÿmpm’t
,

69 
	g’chªt_¬mÜ
,

70 
	g’chªt_w—pÚ
,

71 
	g’”gy_d¿š
,

72 
	gç”›_fœe
,

73 
	gç”›_fog
,

74 
	gçrsight
,

75 
	gã¬
,

76 
	gfœe_b»©h
,

77 
	gfœeb®l
,

78 
	gfœ•roof
,

79 
	gfœe¡Üm
,

80 
	gæame_bÏde
,

81 
	gæamesh›ld
,

82 
	gæame¡rike
,

83 
	gæy
,

84 
	gæßtšg_disc
,

85 
	gä’zy
,

86 
	gäo¡_bÏde
,

87 
	gäo¡_b»©h
,

88 
	ggas_b»©h
,

89 
	gg©e
,

90 
	gg’”®_pu½o£
,

91 
	ggŸÁ_¡»ngth
,

92 
	gh¬m
,

93 
	gha¡e
,

94 
	gh—l
,

95 
	gh—t_m‘®
,

96 
	ghigh_ex¶osive
,

97 
	ghŞy_wÜd
,

98 
	gid’tify
,

99 
	gšvis
,

100 
	gknow_®ignm’t
,

101 
	glight_of_Œuth
,

102 
	glighŠšg_bŞt
,

103 
	glighŠšg_b»©h
,

104 
	gloÿ‹_liã
,

105 
	gloÿ‹_objeù
,

106 
	gmagic_misse
,

107 
	gmass_h—lšg
,

108 
	gmass_švis
,

109 
	gÃxus
,

110 
	gnight_visiÚ
,

111 
	g·ss_doÜ
,

112 
	g¶ague
,

113 
	gpoisÚ
,

114 
	gpow”_wÜd
,

115 
	gpŞymÜph
,

116 
	gpÜl
,

117 
	g´Ùeù_cÚš”
,

118 
	g´ÙeùiÚ_ev
,

119 
	g´ÙeùiÚ_good
,

120 
	g¿ybª
,

121 
	g¿y_of_Œuth
,

122 
	g»ch¬ge
,

123 
	g»äesh
,

124 
	g»su¼eù
,

125 
	g»g’”©iÚ
,

126 
	g»move_®ignm’t
,

127 
	g»move_švis
,

128 
	g»move_cur£
,

129 
	g§nùu¬y
,

130 
	gsüy
,

131 
	gsh›ld
,

132 
	gshock_bÏde
,

133 
	gshockšg_g¿¥
,

134 
	gshršk
,

135 
	g¦“p
,

136 
	g¦ow
,

137 
	gsmokesü“n
,

138 
	g¡¬ve
,

139 
	g¡“l_mi¡
,

140 
	g¡Úe_skš
,

141 
	gsummÚ
,

142 
	gsummÚ_objeù
,

143 
	gsuÄay
,

144 
	glÚ
,

145 
	g‹ËpÜt
,

146 
	g‹ËpÜt_objeù
,

147 
	gundo_¥–l
,

148 
	gv’Œoqu©e
,

149 
	gvisiÚ
,

150 
	gw—k’
,

151 
	gwÜd_of_»ÿÎ
,

152 
	gw¿th
,

153 
	gaxe
,

154 
	gdagg”
,

155 
	gæa
,

156 
	gmaû
,

157 
	gpŞ—rm
,

158 
	g¥—r
,

159 
	gswÜd
,

160 
	gwh
,

161 
	g¬ch”y
,

162 
	gsh›ld_block
,

163 
	gb»w
,

164 
	gsüibe
,

165 
	gback¡ab
,

166 
	gbash
,

167 
	gb”£rk
,

168 
	gcœşe
,

169 
	güush
,

170 
	gdœt_kickšg
,

171 
	gdi§rm
,

172 
	gdodge
,

173 
	g’hªûd_damage
,

174 
	g’v’om
,

175 
	ghªd_to_hªd
,

176 
	gkick
,

177 
	groundhou£
,

178 
	gfoÙsw“p
,

179 
	g·¼y
,

180 
	g»scue
,

181 
	gŒ
,

182 
	g£cÚd_©ck
,

183 
	gthœd_©ck
,

184 
	gdu®_w›ld
,

185 
	ghuÁ
,

186 
	guÇrmed
,

187 
	gswimmšg
,

188 
	gç¡_h—lšg
,

189 
	gfœebudšg
,

190 
	gfÜge
,

191 
	g»·œ
,

192 
	grÙ©e
,

193 
	gÏnguages
,

194 
	ghaggË
,

195 
	ghide
,

196 
	glÜe
,

197 
	gmed™©iÚ
,

198 
	g³ek
,

199 
	gpick_lock
,

200 
	gsÿn
,

201 
	g¢—k
,

202 
	g¡—l
,

203 
	gsšg
,

204 
	gsüŞls
,

205 
	g¥ou£g©e
,

206 
	g¡aves
,

207 
	gwªds
,

208 
	g»ÿÎ
,

209 
	gÏy_Ú_hªds
,

210 
	gçmŸr
,

211 
	gd›_h¬d
,

212 
	gsh“n
,

213 
	gfocus
,

214 
	g·¿lyze
,

216 
	gb¬r›r
,

217 
	gdazzË
,

218 
	gfuÎ_h—l
,

219 
	gmidnight
,

220 
	gshadow_fÜm
,

221 
	ghÚe
,

222 
	gro¡e
,

223 
	gfou¹h_©ck
,

224 
	g¿ge
,

225 
	g§p
,

226 
	g·š
,

227 
	ghex
,

228 
	gbÚe_w®l
,

229 
	ghamm”¡rike
,

230 
	gfÜû_sh›ld
,

231 
	ghŞy_swÜd
,

232 
	g®ign
,

233 
	gblur
,

234 
	gdu®_£cÚd
,

235 
	gquick
,

236 
	g¡ªdç¡
,

237 
	gm¬k
,

238 
	gü™iÿl_blow
,

240 
	gsize
,

241 
	gfœ¡
 = 0

	@src/include/skill/skill.hh

1 #´agm¨
Úû


3 
	~<m­
>

5 
	~"skl/Ty³.hh
"

6 
	~"SŒšg.hh
"

7 
	~"magic.hh
"

8 
	~"Gud.hh
"

11 
Çme¥aû
 
	gskl
 {

16 
	sskl_bË_t


18 
SŒšg
 
	gÇme
;

19 
	gskl_Ëv–
[
Gud
::
size
];

20 
	g¿tšg
[
Gud
::
size
];

21 
SPELL_FUN
 * 
	g¥–l_fun
;

22 
	grg‘
;

23 
	gmšimum_pos™iÚ
;

24 
	gmš_mªa
;

25 
	gb—ts
;

26 
SŒšg
 
	gnoun_damage
;

27 
Gud
 
	g»mÜt_gud
;

28 
	gevoco¡_£c
[
Gud
::
size
];

29 
	gevoco¡_´i
[
Gud
::
size
];

32 
ty³
 
lookup
(cÚ¡ 
SŒšg
& 
Çme
);

33 cÚ¡ 
	gskl_bË_t
& 
lookup
(
ty³
 
t
);

34 
num_skls
();

35 
ty³
 
äom_št
();

39 cÚ¡ 
¡d
::
m­
<
skl
::
ty³
, skl::
skl_bË_t
> 
skl_bË
;

	@src/include/sql.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

4 
	~"FÏgs.hh
"

5 
	~"FÜm©.hh
"

7 
	#SQL_OK
 0

	)

8 
	#SQL_ERROR
 1

	)

11 
db_İ’
 ();

12 
db_şo£
 ();

13 
db_”rÜ
 (cÚ¡ 
SŒšg
& 
func
, cÚ¡ SŒšg& 
qu”y
 = "");

14 
db_Ãxt_row
 ();

15 
db_g‘_cŞumn_št
 (
šdex
);

16 cÚ¡ 
FÏgs
 
db_g‘_cŞumn_æags
 (
šdex
);

18 
db_g‘_cŞumn_¡r
 (
šdex
);

19 
db_qu”y
 (cÚ¡ 
SŒšg
& 
func
, cÚ¡ SŒšg& 
qu”y
);

20 
db_commªd
 (cÚ¡ 
SŒšg
& 
func
, cÚ¡ SŒšg& 
qu”y
);

21 
db_couÁ
 (cÚ¡ 
SŒšg
& 
func
, cÚ¡ SŒšg& 
qu”y
);

22 
db_rows_afãùed
 ();

23 
SŒšg
 
db_esc
 (cÚ¡ SŒšg& 
¡ršg
);

26 
	g‹m¶©e
<
	gşass
... 
	gP¬ams
>

27 
	$db_qu”yf
 (cÚ¡ 
SŒšg
& 
func
, cÚ¡ SŒšg& 
qu”y
, 
P¬ams
... 
·¿ms
) {

28  
	`db_qu”y
(
func
, 
FÜm©
::
	`fÜm©
(
qu”y
, 
·¿ms
...));

29 
	}
}

31 
	g‹m¶©e
<
	gşass
... 
	gP¬ams
>

32 
	$db_commªdf
 (cÚ¡ 
SŒšg
& 
func
, cÚ¡ SŒšg& 
qu”y
, 
P¬ams
... 
·¿ms
) {

33  
	`db_commªd
(
func
, 
FÜm©
::
	`fÜm©
(
qu”y
, 
·¿ms
...));

34 
	}
}

36 
	g‹m¶©e
<
	gşass
... 
	gP¬ams
>

37 
	$db_couÁf
 (cÚ¡ 
SŒšg
& 
func
, cÚ¡ SŒšg& 
qu”y
, 
P¬ams
... 
·¿ms
) {

38  
	`db_couÁ
(
func
, 
FÜm©
::
	`fÜm©
(
qu”y
, 
·¿ms
...));

39 
	}
}

	@src/include/tables.hh

1 #´agm¨
Úû


3 
	~<veùÜ
>

5 
	~"cÚ¡ªts.hh
"

6 
	~"afãù/Ty³.hh
"

7 
	~"FÏgs.hh
"

8 
	~"SŒšg.hh
"

9 
	~"SeùÜ.hh
"

11 
	sMagT_ty³


13 
SŒšg
 
	mm®e
;

14 
SŒšg
 
	mãm®e
;

17 
	sCËT_ty³


19 
SŒšg
 
	mm®e
;

20 
SŒšg
 
	mãm®e
;

23 
	sThiT_ty³


25 
SŒšg
 
	mm®e
;

26 
SŒšg
 
	mãm®e
;

29 
	sW¬T_ty³


31 
SŒšg
 
	mm®e
;

32 
SŒšg
 
	mãm®e
;

35 
	schª_ty³


37 
SŒšg
 
	mÇme
;

38 
SŒšg
 
	m´efix_£lf
;

39 
SŒšg
 
	mÙh”_¡r
;

40 
	mc¦Ù
;

41 
	mFÏgs
::
B™
 
b™
;

42 
	mFÏgs
::
B™
 
»voke_b™
;

45 
	s»voke_ty³


47 
SŒšg
 
	mÇme
;

48 
	mFÏgs
::
B™
 
b™
;

49 
SŒšg
 
	mmes§ge
;

52 
	#CAND_CHAR
 0

	)

53 
	#CAND_MOB
 1

	)

54 
	#CAND_PLAYER
 2

	)

55 
	#CAND_OBJ
 3

	)

56 
	#CAND_ROOM
 4

	)

58 
	#FIELD_PLAYER
 0

	)

59 
	#FIELD_PCDATA
 1

	)

60 
	#FIELD_CGROUP
 2

	)

61 
	#FIELD_WIZNET
 3

	)

62 
	#FIELD_REVOKE
 4

	)

63 
	#FIELD_CENSOR
 5

	)

64 
	#FIELD_COMM
 6

	)

65 
	#FIELD_ACT
 7

	)

66 
	#FIELD_OFF
 8

	)

67 
	#FIELD_FORM
 9

	)

68 
	#FIELD_PART
 10

	)

69 
	#FIELD_GROUP
 11

	)

70 
	#FIELD_EXTRA
 12

	)

71 
	#FIELD_WEAR
 13

	)

72 
	#FIELD_WEAPON
 14

	)

73 
	#FIELD_ROOM
 15

	)

75 
	sæag_ty³


77 
SŒšg
 
	mÇme
;

78 
	mFÏgs
::
B™
 
b™
;

79 
boŞ
 
	m£‰abË
;

82 
	sf›ld_ty³


84 
SŒšg
 
	mÇme
;

85 cÚ¡ 
	m¡d
::
veùÜ
<
æag_ty³
> &
æag_bË
;

86 
	mÿnd
;

87 
	m£e_mob
;

88 
	m£e_¶r
;

89 
	mmod_mob
;

90 
	mmod_¶r
;

93 
	safãù_bË_ty³
 {

94 
SŒšg
 
	mÇme
;

95 
	mafãù
::
ty³
ype;

96 
boŞ
 
	m£‰abË
;

99 
	spos™iÚ_ty³


101 
SŒšg
 
	mÇme
;

102 
SŒšg
 
	mshÜt_Çme
;

105 
	s£x_ty³


107 
SŒšg
 
	mÇme
;

110 
	ssize_ty³


112 
SŒšg
 
	mÇme
;

115 
	sc£‰šg_ty³


117 
	mcŞÜ
;

118 
	mbŞd
;

119 
SŒšg
 
	mÇme
;

122 
	scŞÜ_ty³


124 
SŒšg
 
	mÇme
;

125 
SŒšg
 
	mcode
;

126 
	mcŞÜ
;

127 
	mbŞd
;

131 
	s£ùÜ_ty³
 {

132 
SŒšg
 
	mÇme
;

133 
SeùÜ
 
	mty³
;

136 
	s¿fãùs


138 
SŒšg
 
	mdesütiÚ
;

139 
SŒšg
 
	mshÜŠame
;

140 
	mgroup
;

141 
	mid
;

142 
	mchªû
;

143 
FÏgs
 
	madd
;

148 cÚ¡ 
¡d
::
veùÜ
<
pos™iÚ_ty³
> 
pos™iÚ_bË
;

149 cÚ¡ 
¡d
::
veùÜ
<
£x_ty³
> 
£x_bË
;

150 cÚ¡ 
¡d
::
veùÜ
<
size_ty³
> 
size_bË
;

151 cÚ¡ 
¿fãùs
„afãùs[
MAX_RAFFECTS
];

152 cÚ¡ 
SŒšg
 
Msyl1
[];

153 cÚ¡ 
SŒšg
 
Msyl2
[];

154 cÚ¡ 
SŒšg
 
Msyl3
[];

155 cÚ¡ 
SŒšg
 
Fsyl1
[];

156 cÚ¡ 
SŒšg
 
Fsyl2
[];

157 cÚ¡ 
SŒšg
 
Fsyl3
[];

158 cÚ¡ 
¡d
::
veùÜ
<
MagT_ty³
> 
MagT_bË
;

159 cÚ¡ 
¡d
::
veùÜ
<
CËT_ty³
> 
CËT_bË
;

160 cÚ¡ 
¡d
::
veùÜ
<
ThiT_ty³
> 
ThiT_bË
;

161 cÚ¡ 
¡d
::
veùÜ
<
W¬T_ty³
> 
W¬T_bË
;

162 cÚ¡ 
¡d
::
veùÜ
<
chª_ty³
> 
chª_bË
;

163 cÚ¡ 
¡d
::
veùÜ
<
»voke_ty³
> 
»voke_bË
;

164 cÚ¡ 
¡d
::
veùÜ
<
c£‰šg_ty³
> 
c£‰šg_bË
;

165 cÚ¡ 
¡d
::
veùÜ
<
cŞÜ_ty³
> 
cŞÜ_bË
;

166 cÚ¡ 
¡d
::
veùÜ
<
£ùÜ_ty³
> 
£ùÜ_bË
;

169 cÚ¡ 
SŒšg
 
f›ld_ÿnd
[];

170 cÚ¡ 
¡d
::
veùÜ
<
f›ld_ty³
> 
æag_f›lds
;

171 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
¶r_æags
;

172 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
aù_æags
;

173 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
pcd©a_æags
;

174 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
wiz_æags
;

175 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
afãù_æags
;

176 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
off_æags
;

177 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
imm_æags
;

178 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
fÜm_æags
;

179 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
·¹_æags
;

180 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
group_æags
;

181 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
comm_æags
;

182 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
ûnsÜ_æags
;

183 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
»voke_æags
;

184 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
exŒa_æags
;

185 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
eq_æags
;

186 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
w—r_æags
;

187 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
cÚš”_æags
;

188 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
pÜl_æags
;

189 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
room_æags
;

190 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
ex™_æags
;

191 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
cgroup_æags
;

192 cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> 
cÚt_æags
;

194 cÚ¡ 
¡d
::
veùÜ
<
afãù_bË_ty³
> 
w—pÚ_afãùs
;

196 
æag_šdex_lookup
(cÚ¡ 
SŒšg
& 
Çme
, cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
>& 
æag_bË
);

197 
afãù_šdex_lookup
(cÚ¡ 
SŒšg
& 
Çme
, cÚ¡ 
¡d
::
veùÜ
<
afãù_bË_ty³
>& 
afãù_bË
);

	@src/include/telnet.hh

1 #´agm¨
Úû


13 
	#IAC
 255

	)

14 
	#DONT
 254

	)

15 
	#DO
 253

	)

16 
	#WONT
 252

	)

17 
	#WILL
 251

	)

18 
	#SB
 250

	)

19 
	#GA
 249

	)

20 
	#EL
 248

	)

21 
	#EC
 247

	)

22 
	#AYT
 246

	)

23 
	#AO
 245

	)

24 
	#IP
 244

	)

25 
	#BREAK
 243

	)

26 
	#DM
 242

	)

27 
	#NOP
 241

	)

28 
	#SE
 240

	)

29 
	#EOR
 239

	)

31 
	#SYNCH
 242

	)

33 #ifdeà
TELCMDS


34 *
	g‹lcmds
[] = {

41 
	#TELOPT_BINARY
 0

	)

42 
	#TELOPT_ECHO
 1

	)

43 
	#TELOPT_RCP
 2

	)

44 
	#TELOPT_SGA
 3

	)

45 
	#TELOPT_NAMS
 4

	)

46 
	#TELOPT_STATUS
 5

	)

47 
	#TELOPT_TM
 6

	)

48 
	#TELOPT_RCTE
 7

	)

49 
	#TELOPT_NAOL
 8

	)

50 
	#TELOPT_NAOP
 9

	)

51 
	#TELOPT_NAOCRD
 10

	)

52 
	#TELOPT_NAOHTS
 11

	)

53 
	#TELOPT_NAOHTD
 12

	)

54 
	#TELOPT_NAOFFD
 13

	)

55 
	#TELOPT_NAOVTS
 14

	)

56 
	#TELOPT_NAOVTD
 15

	)

57 
	#TELOPT_NAOLFD
 16

	)

58 
	#TELOPT_XASCII
 17

	)

59 
	#TELOPT_LOGOUT
 18

	)

60 
	#TELOPT_BM
 19

	)

61 
	#TELOPT_DET
 20

	)

62 
	#TELOPT_SUPDUP
 21

	)

63 
	#TELOPT_SUPDUPOUTPUT
 22

	)

64 
	#TELOPT_SNDLOC
 23

	)

65 
	#TELOPT_TTYPE
 24

	)

66 
	#TELOPT_EOR
 25

	)

67 
	#TELOPT_EXOPL
 255

	)

69 #ifdeà
TELOPTS


70 
	#NTELOPTS
 (1+
TELOPT_EOR
)

	)

71 *
	g‹lİts
[
NTELOPTS
] = {

82 
	#TELQUAL_IS
 0

	)

83 
	#TELQUAL_SEND
 1

	)

	@src/include/typename.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

5 
şass
 
	gCh¬aù”
;

6 
şass
 
	gObjeù
;

7 
şass
 
	gFÏgs
;

10 
SŒšg
 
w—pÚ_Çme
 
¬gs
(Ğ
w—pÚ_Ty³
) );

11 
SŒšg
 
™em_Çme
 
¬gs
(Ğ
™em_ty³
) );

12 
SŒšg
 
™em_ty³_Çme
 
¬gs
(Ğ
Objeù
 *
obj
 ) );

13 
SŒšg
 
afãù_loc_Çme
 
¬gs
(Ğ
loÿtiÚ
 ) );

14 
SŒšg
 
dam_ty³_Çme
 
¬gs
(Ğ
ty³
 ) );

15 
SŒšg
 
exŒa_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
exŒa_æags
 ) );

16 
SŒšg
 
wiz_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
wiz_æags
 ) );

17 
SŒšg
 
w—r_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
w—r_æags
 ) );

18 
SŒšg
 
aù_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
aù_æags
, 
boŞ
 
Åc
 ) );

19 
SŒšg
 
room_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
room_æags
 ));

20 
SŒšg
 
¶r_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
¶r_æags
 ) );

21 
SŒšg
 
off_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
off_æags
 ) );

22 
SŒšg
 
imm_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
æags
 ) );

23 
SŒšg
 
fÜm_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
fÜm_æags
 ) );

24 
SŒšg
 
·¹_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
·¹_æags
 ) );

25 
SŒšg
 
w—pÚ_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
w—pÚ_æags
 ) );

26 
SŒšg
 
comm_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
comm_æags
 ) );

27 
SŒšg
 
»voke_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
»voke_æags
 ) );

28 
SŒšg
 
cgroup_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
æags
 ));

29 
SŒšg
 
ûnsÜ_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
ûnsÜ_æags
 ) );

30 
SŒšg
 
cÚt_b™_Çme
 
¬gs
(ĞcÚ¡ 
FÏgs
& 
cÚt_æags
) );

31 
SŒšg
 
g‘_cŞÜ_Çme
 
¬gs
((
cŞÜ
, 
bŞd
));

32 
SŒšg
 
g‘_cŞÜ_code
 
¬gs
((
cŞÜ
, 
bŞd
));

33 
SŒšg
 
g‘_cu¡om_cŞÜ_Çme
 
¬gs
((
Ch¬aù”
 *
ch
, 
¦Ù
));

34 
SŒšg
 
g‘_cu¡om_cŞÜ_code
 
¬gs
((
Ch¬aù”
 *
ch
, 
¦Ù
));

	@src/include/util/Image.hh

1 #´agm¨
Úû


3 
şass
 
	gSŒšg
;

5 
Çme¥aû
 
	gut
 {

7 şas 
	cImage
 {

8 
	gpublic
:

9 
	eChªÃl
 { 
»d
 = 0, 
	gg»’
, 
	gblue
, 
	g®pha
 };

11 
Image
() {}

12 
	gvœtu®
 ~
Image
();

14 
v®ue
(
ChªÃl
 
rgb
, 
x
, 
y
) const;

16 
height
(ècÚ¡ {  
	g_height
; }

17 
width
(ècÚ¡ {  
	g_width
; }

18 
boŞ
 
lßd
(cÚ¡ 
SŒšg
& 
f’ame
);

20 
	g´iv©e
:

21 
Image
(const Image&);

22 
	gImage
& 
	gİ”©Ü
=(cÚ¡ 
Image
&);

24 
height
(
v
è{ 
	g_height
 = v; }

25 
width
(
v
è{ 
	g_width
 = v; }

27 
	g_width
 = 0;

28 
	g_height
 = 0;

29 **
	grows
 = 
nuÎ±r
;

	@src/include/vt100.hh

1 #´agm¨
Úû


9 
	#VT_SAVECURSOR
 "\033[s"

	)

10 
	#VT_RESTORECURSOR
 "\033[u"

	)

11 
	#VT_SETWIN_CLEAR
 "\033[r"

	)

12 
	#VT_CLEAR_SCREEN
 "\033[2J"

	)

13 
	#VT_CLEAR_LINE
 "\033[K"

	)

14 
	#VT_RESET_TERMINAL
 "\033"

	)

15 
	#VT_BAR
 "-----------------------------------------------------------------------------"

	)

	@src/include/worldmap/Coordinate.hh

1 #´agm¨
Úû


3 
	~"SŒšg.hh
"

5 
Çme¥aû
 
	gwÜldm­
 {

7 şas 
	cCoÜdš©e
 {

8 
	gpublic
:

9 
CoÜdš©e
(è: 
x
(-1), 
y
(0) {}

11 
CoÜdš©e
(
nx
, 
ny
) : Coordinate() {

12 ià(
nx
 < 0 || (nx >> 
num_b™s_coÜd
()) > 0)

15 ià(
	gny
 < 0 || (ny >> 
num_b™s_coÜd
()) > 0)

18 
	gx
 = 
nx
; 
	gy
 = 
ny
;

22 
CoÜdš©e
(
v®ue
) : Coordinate() {

23 ià(
v®ue
 < 0)

28 ià((
	gv®ue
 >> 30) == 0)

32 
	gmask
 = (1 << 15)-1;

33 
	gx
 = (
v®ue
 >> 15è& 
mask
;

34 
	gy
 = 
v®ue
 & 
mask
;

37 
CoÜdš©e
(cÚ¡ 
SŒšg
& 
¡r
) : Coordinate() {

38 ià(!
¡r
.
has_šfix
(","))

41 
SŒšg
 
	gx_¡r
;

42 
SŒšg
 
	gy_¡r
 = 
¡r
.
l¥l™
(
x_¡r
, ",");

44 ià(!
	gx_¡r
.
is_numb”
()

45 || !
	gy_¡r
.
is_numb”
())

48 *
	gthis
 = 
CoÜdš©e
(
©oi
(
x_¡r
),‡toi(
y_¡r
));

53 
to_št
() const {

54 ià(!
is_v®id
())

57 
	g»t
 = 1 << 30;

58 
	g»t
 |ğ(
x
 << 15);

59 
	g»t
 |ğ
y
;

60  
	g»t
;

63 cÚ¡ 
SŒšg
 
to_¡ršg
(
boŞ
 
shÜt_loc
 = 
Œue
) const;

65 
CoÜdš©e
(cÚ¡ CoÜdš©e& 
c
è: 
x
(c.x), 
y
(c.y) {}

66 
	gCoÜdš©e
& 
	gİ”©Ü
=(cÚ¡ 
CoÜdš©e
& 
c
è{ 
x
 = c.x; 
	gy
 = c.
y
;  *
	gthis
; }

67 
	gvœtu®
 ~
CoÜdš©e
() {}

69 
šlše
 
boŞ
 
is_v®id
(ècÚ¡ {  !(
	gx
 < 0); }

71 
šlše
 
ä›nd
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
CoÜdš©e
& 
lhs
, cÚ¡ 
	gCoÜdš©e
& 
	grhs
) {

72  
	glhs
.
	gx
 =ğ
rhs
.
x
 && 
lhs
.
y
 ==„hs.y;

74 
šlše
 
ä›nd
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
CoÜdš©e
& 
lhs
, cÚ¡ 
	gCoÜdš©e
& 
	grhs
) {

75  !(
	glhs
 =ğ
rhs
);

78 
	gx
;

79 
	gy
;

81 
	g´iv©e
:

82 
šlše
 
num_b™s_coÜd
() const {  15; }

	@src/include/worldmap/MapColor.hh

1 #´agm¨
Úû


3 
Çme¥aû
 
	gwÜldm­
 {

5 şas 
	cM­CŞÜ
 {

6 
	gpublic
:

7 
M­CŞÜ
(
r
, 
g
, 
b
) :

8 
»d
(
r
), 
g»’
(
g
), 
blue
(
b
è{ 
´ecompu‹
(); }

10 
	gvœtu®
 ~
M­CŞÜ
() {}

12 
M­CŞÜ
(cÚ¡ M­CŞÜ& 
m
) :

13 
»d
(
m
.»d), 
g»’
(m.g»’), 
blue
(m.blueè{ 
´ecompu‹
(); }

15 
	gM­CŞÜ
& 
	gİ”©Ü
=(cÚ¡ 
M­CŞÜ
& 
m
) {

16 
»d
 = 
m
.red;

17 
	gblue
 = 
m
.
blue
;

18 
	gg»’
 = 
m
.
g»’
;

19 
´ecompu‹
();

20  *
	gthis
;

23 
	g»d
, 
	gg»’
, 
	gblue
;

24 cÚ¡ 
M­CŞÜ
 
	guncŞÜed
;

26 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
M­CŞÜ
& 
rhs
) const {

27  
this
->
»d
 =ğ
rhs
.red

28 && 
this
->
g»’
 =ğ
rhs
.green

29 && 
this
->
blue
 =ğ
rhs
.blue;

32 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
M­CŞÜ
& 
rhs
) const {

33  !(*
this
 =ğ
rhs
);

36 
šlše
 
boŞ
 
	gİ”©Ü
<(cÚ¡ 
	gM­CŞÜ
& 
	grhs
) const {

37  
	gthis
->
	g_compu‹d
 < 
	grhs
._computed;

40 
	g´iv©e
:

41 
´ecompu‹
() {

42 
_compu‹d
 = (
»d
 << 16è+ (
g»’
 << 8è+ 
blue
;

45 
	g_compu‹d
 = 0;

	@src/include/worldmap/Quadtree.hh

1 #´agm¨
Úû


3 
	~"CoÜdš©e.hh
"

5 
Çme¥aû
 
	gwÜldm­
 {

7 
	g‹m¶©e
<
şass
 
	gT
>

8 şas 
	cQuadŒ“
 {

9 
	gpublic
:

10 
QuadŒ“
(
ÿ·c™y
) : capacity(capacity) { }

12 
vœtu®
 ~
QuadŒ“
() {

13 
i
 = 0; 
	gi
 < 4; i++)

14 ià(
	gchd»n
[
i
] !ğ
nuÎ±r
)

15 
d–‘e
 
chd»n
[
i
];

20 
put
(
T
 *
d©a
, cÚ¡ 
CoÜdš©e
& 
coÜd
) {

21 ià(
	gÿ·c™y
 == 1) {

22 
this
->
d©a
 = data;

26 
	gšdex
 = 
g‘_chd_šdex
(
coÜd
);

28 ià(
	gchd»n
[
šdex
] =ğ
nuÎ±r
)

29 
chd»n
[
šdex
] = 
Ãw
 
QuadŒ“
<
T
>(
ÿ·c™y
/2);

31 
	gchd»n
[
šdex
]->
put
(
d©a
, 
CoÜdš©e
(

32 
coÜd
.
x
 % (
ÿ·c™y
/2),

33 
coÜd
.
y
 % (
ÿ·c™y
/2)

37 
T
 *
g‘
(cÚ¡ 
CoÜdš©e
& 
coÜd
) const {

38 ià(
	gÿ·c™y
 == 1)

39  
d©a
;

41 
	gšdex
 = 
g‘_chd_šdex
(
coÜd
);

43 ià(
	gchd»n
[
šdex
] =ğ
nuÎ±r
)

44  
nuÎ±r
;

46  
	gchd»n
[
šdex
]->
g‘
(
CoÜdš©e
(

47 
coÜd
.
x
 % (
ÿ·c™y
/2),

48 
coÜd
.
y
 % (
ÿ·c™y
/2)

52 
»move
(cÚ¡ 
CoÜdš©e
& 
coÜd
) {

53 ià(
	gÿ·c™y
 == 1) {

54 
d©a
 = 
nuÎ±r
;

58 
	gšdex
 = 
g‘_chd_šdex
(
coÜd
);

60 ià(
	gchd»n
[
šdex
] =ğ
nuÎ±r
)

63 
	gchd»n
[
šdex
]->
»move
(
CoÜdš©e
(

64 
coÜd
.
x
 % (
ÿ·c™y
/2),

65 
coÜd
.
y
 % (
ÿ·c™y
/2)

68 ià(!
	gchd»n
[
šdex
]->
is_u£d
()) {

69 
d–‘e
 
	gchd»n
[
šdex
];

70 
	gchd»n
[
šdex
] = 
nuÎ±r
;

74 
	g´iv©e
:

75 
QuadŒ“
();

76 
QuadŒ“
(const Quadtree&);

77 
	gQuadŒ“
& 
	gİ”©Ü
=(cÚ¡ 
QuadŒ“
&);

79 
g‘_chd_šdex
(cÚ¡ 
CoÜdš©e
& 
coÜd
) const {

80 
	gxchd
 = 2 * 
coÜd
.
x
 / 
ÿ·c™y
;

81 
	gychd
 = 2 * 
coÜd
.
y
 / 
ÿ·c™y
;

82  
	gxchd
 + 
	gychd
 * 2;

85 
boŞ
 
is_u£d
() const {

86  ( 
	gd©a
 !ğ
nuÎ±r


87 || 
chd»n
[0] !ğ
nuÎ±r


88 || 
chd»n
[1] !ğ
nuÎ±r


89 || 
chd»n
[2] !ğ
nuÎ±r


90 || 
chd»n
[3] !ğ
nuÎ±r


94 
T
 *
	gd©a
 = 
nuÎ±r
;

95 
QuadŒ“
 *
	gchd»n
[4] = {
nuÎ±r
};

96 
	gËv–
 = 0;

97 
	gÿ·c™y
 = 0;

	@src/include/worldmap/Region.hh

1 #´agm¨
Úû


3 
	~<m­
>

4 
	~<£t
>

6 
	~"wÜldm­/M­CŞÜ.hh
"

7 
	~"Vnum.hh
"

8 
	~"ut/Image.hh
"

10 
şass
 
	gA»a
;

12 
Çme¥aû
 
	gwÜldm­
 {

14 şas 
	cRegiÚ
 {

15 
	gpublic
:

16 
RegiÚ
(
A»a
& 
¬—
, 
FILE
 *
å
);

17 
	gvœtu®
 ~
RegiÚ
() {}

19 
	gA»a
& 
	g¬—
;

21 
®ign_x
(ècÚ¡ {  
	g_®ign_x
; }

22 
®ign_y
(ècÚ¡ {  
	g_®ign_y
; }

24 cÚ¡ 
	gM­CŞÜ
& 
vnum_to_cŞÜ
(cÚ¡ 
Vnum
& 
vnum
) const;

25 cÚ¡ 
Vnum
 
cŞÜ_to_vnum
(cÚ¡ 
M­CŞÜ
& 
cŞÜ
) const;

26 cÚ¡ 
M­CŞÜ
 
g‘_cŞÜ
(
x
, 
y
) const;

27 cÚ¡ 
Vnum
 
g‘_vnum
(
x
, 
y
) const;

29 
ü—‹_rooms
() const;

30 
	g¡d
::
£t
<
Vnum
> 
®lowed_mob_»£ts
;

31 
	g¡d
::
£t
<
Vnum
> 
®lowed_room_»£ts
;

33 
	g´iv©e
:

34 
RegiÚ
(const Region&);

35 
	gRegiÚ
& 
	gİ”©Ü
=(cÚ¡ 
RegiÚ
&);

37 
	gut
::
Image
 
image
;

38 
	g_®ign_x
;

39 
	g_®ign_y
;

40 
	g¡d
::
m­
<
Vnum
, 
	gM­CŞÜ
> 
	g_´ÙÙy³_cŞÜ_m­
;

	@src/include/worldmap/Worldmap.hh

1 #´agm¨
Úû


3 
	~"SeùÜ.hh
"

5 
şass
 
	gM­CŞÜ
;

7 
Çme¥aû
 
	gwÜldm­
 {

9 
şass
 
	gCoÜdš©e
;

11 şas 
	cWÜldm­
 {

12 
	gpublic
:

13 
WÜldm­
();

14 
	gvœtu®
 ~
WÜldm­
();

16 cÚ¡ 
SeùÜ
 
g‘_£ùÜ
(cÚ¡ 
CoÜdš©e
& 
coÜd
) const;

18 
height
(ècÚ¡ {  
	g_height
; }

19 
width
(ècÚ¡ {  
	g_width
; }

21 
	g´iv©e
:

22 
WÜldm­
(const Worldmap&);

23 
	gWÜldm­
& 
	gİ”©Ü
=(cÚ¡ 
WÜldm­
&);

25 cÚ¡ 
SeùÜ
 
cŞÜ_to_£ùÜ
(cÚ¡ 
M­CŞÜ
& 
cŞÜ
) const;

26 
	g_height
, 
	g_width
;

27 ** 
	grows
 = 
nuÎ±r
;

	@src/interp.cc

28 
	~"š‹½.hh
"

30 
	~<veùÜ
>

32 
	~"aù.hh
"

33 
	~"¬gum’t.hh
"

34 
	~"afãù/Afãù.hh
"

35 
	~"chªÃls.hh
"

36 
	~"Ch¬aù”.hh
"

37 
	~"DesütÜ.hh
"

38 
	~"Di§bËd.hh
"

39 
	~"fe.hh
"

40 
	~"fšd.hh
"

41 
	~"FÜm©.hh
"

42 
	~"Game.hh
"

43 
	~"Loggšg.hh
"

44 
	~"memÜy.hh
"

45 
	~"m”c.hh
"

46 
	~"MobePrÙÙy³.hh
"

47 
	~"MobProg.hh
"

48 
	~"PÏy”.hh
"

49 
	~"¿ndom.hh
"

50 
	~"SocŸl.hh
"

51 
	~"SŒšg.hh
"

52 
	~"bËs.hh
"

53 
	~"vt100.hh
"

54 
	~"comm.hh
"

57 
	gloglše
[
MAX_STRING_LENGTH
] = " ";

64 
	#LOG_NORMAL
 0

	)

65 
	#LOG_ALWAYS
 1

	)

66 
	#LOG_NEVER
 2

	)

71 cÚ¡ 
	g¡d
::
veùÜ
<
cmd_ty³
> 
cmd_bË
 = {

75 { "'", 
do_§y
, 
POS_RESTING
, 
LOG_NORMAL
, 0, 0 },

76 { "-", 
do_emÙe
, 
POS_RESTING
, 
LOG_NORMAL
, 0, 0 },

77 { ".", 
do_goss
, 
POS_SLEEPING
, 
LOG_NORMAL
, 0, 0 },

78 { "/", 
do_»ÿÎ
, 
POS_FIGHTING
, 
LOG_NORMAL
, 0, 0 },

79 { ":", 
do_immlk
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GWG
 },

80 { ";", 
do_g‹Î
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 0 },

81 { "@", 
do_qwe¡
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 0 },

91 { "—¡", 
do_—¡
, 
POS_STANDING
, 
LOG_NEVER
, 8, 0 },

92 { "we¡", 
do_we¡
, 
POS_STANDING
, 
LOG_NEVER
, 8, 0 },

93 { "down", 
do_down
, 
POS_STANDING
, 
LOG_NEVER
, 8, 0 },

94 { "up", 
do_up
, 
POS_STANDING
, 
LOG_NEVER
, 8, 0 },

95 { "nÜth", 
do_nÜth
, 
POS_STANDING
, 
LOG_NEVER
, 8, 0 },

96 { "south", 
do_south
, 
POS_STANDING
, 
LOG_NEVER
, 8, 0 },

100 { "acû±", 
do_acû±
, 
POS_RESTING
, 
LOG_NORMAL
, 8, 0 },

101 { "add­¶y", 
do_add­¶y
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GD
 | 
GWQ
 },

102 { "addex™", 
do_addex™
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWC
 },

103 { "adju¡", 
do_adju¡
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GD
 | 
GWC
 },

104 { "advªû", 
do_advªû
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GL
 | 
GWC
 },

105 { "afãùs", 
do_afãùs
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

106 { "afk", 
do_afk
, 
POS_SLEEPING
, 
LOG_NORMAL
, 1, 0 },

107 { "®Ÿ", 
do_®Ÿ
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 0 },

108 { "®Ÿs", 
do_®Ÿs
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

110 { "®ign", 
do_®ign
, 
POS_SLEEPING
, 
LOG_NORMAL
, 8, 0 },

111 { "®low", 
do_®low
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

112 { "®l§ve", 
do_®l§ve
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

113 { "®‹º©e", 
do_®‹º©e
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

114 { "ªnounû", 
do_ªnounû
, 
POS_SLEEPING
, 
LOG_NORMAL
, 1, 0 },

115 { "ªsw”", 
do_que¡iÚ
, 
POS_SLEEPING
, 
LOG_NORMAL
, 1, 0 },

116 { "¬—s", 
do_¬—s
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

117 { "¬gue", 
do_æame
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 0 },

118 { "©", 
do_©
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

119 { "auùiÚ", 
do_auùiÚ
, 
POS_SLEEPING
, 
LOG_NORMAL
, 1, 0 },

120 { "au¿", 
do_au¿
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

121 { "autŞi¡", 
do_autŞi¡
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

122 { "autßssi¡", 
do_autßssi¡
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

123 { "autÛx™", 
do_autÛx™
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

124 { "autogŞd", 
do_autogŞd
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

125 { "autŞoÙ", 
do_autŞoÙ
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

126 { "autİ“k", 
do_autİ“k
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

127 { "autÜeboÙ", 
do_autoboÙ
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GL
 | 
GWC
 },

128 { "autÜeÿÎ", 
do_autÜeÿÎ
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

129 { "auto§c", 
do_auto§c
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

130 { "auto¥l™", 
do_auto¥l™
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

131 { "autÙick", 
do_autÙick
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

132 { "autog¿ph", 
do_autog¿ph
, 
POS_DEAD
, 
LOG_NEVER
, 0, 0 },

133 { "buy", 
do_buy
, 
POS_RESTING
, 
LOG_NORMAL
, 9, 0 },

134 { "back¡ab", 
do_back¡ab
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

135 { "backup", 
do_backup
, 
POS_DEAD
, 
LOG_NORMAL
, 8, 0 },

136 { "b®ªû", 
do_b®ªû
, 
POS_STANDING
, 
LOG_NORMAL
, 3, 0 },

137 { "bª", 
do_bª
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

138 { "bash", 
do_bash
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

139 { "b©e", 
do_b©e
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

140 { "b”£rk", 
do_b”£rk
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

141 { "bÚus", 
do_bÚus
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

142 { "b¿ndish", 
do_b¿ndish
, 
POS_RESTING
, 
LOG_NORMAL
, 7, 0 },

143 { "b»akup", 
do_b»akup
, 
POS_STANDING
, 
LOG_NORMAL
, 8, 0 },

144 { "b»w", 
do_b»w
, 
POS_STANDING
, 
LOG_NORMAL
, 7, 0 },

146 { "br›f", 
do_br›f
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

147 { "bug", 
do_bug
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

148 { "ÿ¡", 
do_ÿ¡
, 
POS_FIGHTING
, 
LOG_NORMAL
, 7, 0 },

149 { "ûd™", 
do_ûd™
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GD
 | 
GWC
 },

150 { "ûnsÜ", 
do_ûnsÜ
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

151 { "chªÃls", 
do_chªÃls
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

152 { "chªges", 
do_chªges
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

153 { "ch©mode", 
do_ch©mode
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

154 { "check", 
do_check
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

155 { "chown", 
do_chown
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

156 { "cœşe", 
do_cœşe
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

157 { "şªlk", 
do_şªlk
, 
POS_SLEEPING
, 
LOG_NORMAL
, 1, 
GC
 },

158 { "şªd•os™", 
do_şªd•os™
, 
POS_RESTING
, 
LOG_NORMAL
, 8, 
GC
 },

159 { "şªw™hd¿w", 
do_şªw™hd¿w
, 
POS_RESTING
, 
LOG_NORMAL
, 8, 
GC
 },

160 { "şªli¡", 
do_şªli¡
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

161 { "şªpow”", 
do_şªpow”
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

162 { "şªqp", 
do_şªqp
, 
POS_SLEEPING
, 
LOG_NORMAL
, 8, 
GC
 },

163 { "şªšfo", 
do_şªšfo
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 
GC
 },

164 { "şª»ÿÎ", 
do_şª_»ÿÎ
, 
POS_FIGHTING
, 
LOG_NORMAL
, 8, 
GC
 },

165 { "ş—r", 
do_ş—r
, 
POS_DEAD
, 
LOG_NORMAL
, 1, 0 },

166 { "şÚe", 
do_şÚe
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

167 { "şo£", 
do_şo£
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

168 { "cŞÜ", 
do_cŞÜ
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

169 { "combše", 
do_combše
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

170 { "commªds", 
do_commªds
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

171 { "com·»", 
do_com·»
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

172 { "com·ù", 
do_com·ù
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

174 { "cİyov”", 
do_cİyov”
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GL
 | 
GWC
 },

175 { "cÚsid”", 
do_cÚsid”
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

176 { "cÚfig", 
do_cÚfig
, 
POS_SLEEPING
, 
LOG_NORMAL
, 6, 0 },

177 { "cÚv”t", 
do_cÚv”t
, 
POS_SLEEPING
, 
LOG_NORMAL
, 8, 0 },

178 { "couÁ", 
do_couÁ
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

179 { "üed™s", 
do_üed™s
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

180 { "ü™iÿl", 
do_ü™iÿl_blow
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

181 { "ü—‹", 
do_ü—‹
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GD
 | 
GWQ
 },

182 { "üush", 
do_üush
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

183 { "ùe¡", 
do_ùe¡
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

184 { "dršk", 
do_dršk
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

185 { "debug", 
do_debug
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWC
 },

186 { "d—f", 
do_d—f
, 
POS_DEAD
, 
LOG_NORMAL
, 1, 0 },

187 { "deãnsive", 
do_deãnsive
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

188 { "d–‘", 
do_d–‘
, 
POS_DEAD
, 
LOG_ALWAYS
, 0, 0 },

189 { "d–‘e", 
do_d–‘e
, 
POS_STANDING
, 
LOG_ALWAYS
, 8, 0 },

190 { "d’y", 
do_d’y
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

191 { "d•os™", 
do_d•os™
, 
POS_STANDING
, 
LOG_NORMAL
, 9, 0 },

192 { "d•¬‹d", 
do_d•¬‹d
, 
POS_STANDING
, 
LOG_NORMAL
, 3, 0 },

193 { "d•¬‹dli¡", 
do_d•¬‹dli¡
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GD
 | 
GWG
 },

194 { "d•utize", 
do_d•utize
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

195 { "desütiÚ", 
do_desütiÚ
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

196 { "de¥–l", 
do_de¥–l
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

197 { "dœt", 
do_dœt
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

198 { "di§bË", 
do_di§bË
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GL
 | 
GWG
 },

199 { "di§rm", 
do_di§rm
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

200 { "discÚÃù", 
do_discÚÃù
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

201 { "divÜû", 
do_divÜû
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

202 { "dÚ©e", 
do_dÚ©e
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

203 { "dßs", 
do_dßs
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GL
 | 
GWG
 },

204 { "d¿g", 
do_d¿g
, 
POS_STANDING
, 
LOG_NORMAL
, 8, 0 },

205 { "drİ", 
do_drİ
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

206 { "du–", 
do_du–
, 
POS_SLEEPING
, 
LOG_NORMAL
, 6, 0 },

207 { "dump", 
do_dump
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWC
 },

208 { "—t", 
do_—t
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

209 { "echo", 
do_»cho
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWQ
 },

210 { "ed™", 
do_ed™
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

211 { "emÙe", 
do_emÙe
, 
POS_RESTING
, 
LOG_NORMAL
, 1, 0 },

212 { "ema", 
do_ema
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

213 { "’‹r", 
do_’‹r
, 
POS_FIGHTING
, 
LOG_NORMAL
, 8, 0 },

214 { "’g¿ve", 
do_’g¿ve
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

215 { "’v’om", 
do_’v’om
, 
POS_RESTING
, 
LOG_NORMAL
, 2, 0 },

216 { "equm’t", 
do_equm’t
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

217 { "evŞve", 
do_evŞve
, 
POS_SLEEPING
, 
LOG_ALWAYS
, 8, 0 },

218 { "ex™s", 
do_ex™s
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

219 { "examše", 
do_examše
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

220 { "ex™li¡", 
do_exli¡
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWB
 },

221 { "exŒaşass", 
do_”emÜt
, 
POS_RESTING
, 
LOG_NORMAL
, 0, 0 },

222 { "çmŸr", 
do_çmŸr
, 
POS_RESTING
, 
LOG_NORMAL
, 7, 0 },

223 { "fe", 
do_fe
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

224 { "fl", 
do_fl
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

225 { "fšg”", 
do_fšg”
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

226 { "fšg”šfo", 
do_fšg”šfo
 , 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

227 { "fœebudšg", 
do_fœebudšg
, 
POS_STANDING
, 
LOG_NORMAL
, 4, 0 },

228 { "æag", 
do_æag
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

229 { "æagli¡", 
do_æagli¡
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

230 { "æag£¬ch", 
do_æag£¬ch
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

231 { "æame", 
do_æame
, 
POS_DEAD
, 
LOG_NORMAL
, 1, 0 },

232 { "æ“", 
do_æ“
, 
POS_FIGHTING
, 
LOG_NORMAL
, 8, 0 },

233 { "æy", 
do_æy
, 
POS_SLEEPING
, 
LOG_NORMAL
, 8, 0 },

234 { "fod", 
do_fod
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

235 { "fŞlow", 
do_fŞlow
, 
POS_RESTING
, 
LOG_NORMAL
, 8, 0 },

236 { "fŞlow”li¡", 
do_fŞlow”li¡
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

237 { "fÜ", 
do_fÜ
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

238 { "fÜû", 
do_fÜû
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

239 { "fÜge", 
do_fÜge
, 
POS_STANDING
, 
LOG_NORMAL
, 4, 0 },

240 { "ä“ze", 
do_ä“ze
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

241 { "äy", 
do_äy
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GD
 | 
GWS
 },

242 { "fyi", 
do_fyi
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GD
 | 
GWG
 },

243 { "g‘", 
do_g‘
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

244 { "gaš", 
do_gaš
, 
POS_STANDING
, 
LOG_NORMAL
, 8, 0 },

245 { "gameš", 
do_gameš
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

246 { "gameout", 
do_gameout
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

247 { "gecho", 
do_echo
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWQ
 },

248 { "give", 
do_give
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

249 { "gÙo", 
do_gÙo
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

250 { "goss", 
do_goss
, 
POS_SLEEPING
, 
LOG_NORMAL
, 1, 0 },

251 { "group", 
do_group
, 
POS_SLEEPING
, 
LOG_NORMAL
, 8, 0 },

252 { "g¿ts", 
do_g¿ts
, 
POS_SLEEPING
, 
LOG_NORMAL
, 1, 0 },

253 { "grou¶i¡", 
do_grou¶i¡
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

254 { "groups", 
do_groups
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

255 { "g‹Î", 
do_g‹Î
, 
POS_DEAD
, 
LOG_NORMAL
, 1, 0 },

256 { "gud", 
do_gud
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

257 { "h—l", 
do_h—l
, 
POS_RESTING
, 
LOG_NORMAL
, 9, 0 },

258 { "hamm”¡rike", 
do_hamm”¡rike
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

259 { "h“d", 
do_h“d
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

260 { "hed™", 
do_hed™
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWB
 },

261 { "h–p", 
do_h–p
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

262 { "hide", 
do_hide
, 
POS_RESTING
, 
LOG_NORMAL
, 8, 0 },

263 { "h™", 
do_kl
, 
POS_FIGHTING
, 
LOG_NORMAL
, 0, 0 },

264 { "hŞd", 
do_w—r
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

265 { "hÚe", 
do_hÚe
, 
POS_STANDING
, 
LOG_NORMAL
, 4, 0 },

266 { "huÁ", 
do_huÁ
, 
POS_STANDING
, 
LOG_NORMAL
, 2, 0 },

267 { "hbi", 
do_hbi
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWC
 },

268 { "hbb", 
do_hbb
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWB
 },

269 { "šv’tÜy", 
do_šv’tÜy
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

270 { "ic", 
do_ic
, 
POS_DEAD
, 
LOG_NORMAL
, 1, 0 },

271 { "işª", 
do_işªlk
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

272 { "id’tify", 
do_id’tify
, 
POS_STANDING
, 
LOG_NORMAL
, 9, 0 },

273 { "id—", 
do_id—
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

274 { "ignÜe", 
do_ignÜe
, 
POS_DEAD
, 
LOG_NORMAL
, 1, 0 },

275 { "immlk", 
do_immlk
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

276 { "immque¡", 
do_immque¡
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

277 { "immÇme", 
do_immÇme
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

278 { "imm­p", 
do_imm­p
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GD
 | 
GWG
 },

279 { "imÙd", 
do_imÙd
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

280 { "šfo", 
do_groups
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

281 { "š£t", 
do_š£t
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

282 { "šv™e", 
do_šv™e
, 
POS_DEAD
, 
LOG_ALWAYS
, 8, 0 },

283 { "još", 
do_još
, 
POS_RESTING
, 
LOG_ALWAYS
, 8, 
GC
 },

284 { "junk", 
do_junk
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

285 { "kl", 
do_kl
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

286 { "kick", 
do_kick
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

287 { "look", 
do_look
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

288 { "Ïnd", 
do_Ïnd
, 
POS_FIGHTING
, 
LOG_NORMAL
, 8, 0 },

289 { "Ïy", 
do_Ïy_Ú_hªds
, 
POS_RESTING
, 
LOG_NORMAL
, 7, 0 },

290 { "Ëad”", 
do_Ëad”
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

291 { "Ëv–s", 
do_Ëv–s
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

292 { "lšklßd", 
do_lšklßd
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

293 { "li¡", 
do_li¡
, 
POS_RESTING
, 
LOG_NORMAL
, 9, 0 },

294 { "lßd", 
do_lßd
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

295 { "lßdh–ps", 
do_lßdh–ps
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GD
 | 
GWG
 },

296 { "lock", 
do_lock
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

297 { "lock”", 
do_lock”
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

298 { "log", 
do_log
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GD
 | 
GWS
 },

299 { "lÜe", 
do_lÜe
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

300 { "low”", 
do_low”
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

301 { "lurk", 
do_lurk
, 
POS_DEAD
, 
LOG_NORMAL
, 8, 
GWG
 },

302 { "m¬k", 
do_m¬k
, 
POS_STANDING
, 
LOG_NORMAL
, 8, 0 },

303 { "m¬ry", 
do_m¬ry
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

304 { "ma¡”", 
do_ma¡”
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWQ
 },

305 { "memÜy", 
do_memÜy
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWC
 },

306 { "mËv–", 
do_mËv–
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

307 { "mÜph", 
do_mÜph
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWQ
 },

308 { "mÙd", 
do_mÙd
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GD
 | 
GWG
 },

309 { "m·sound", 
do_m·sound
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

310 { "m·t", 
do_m·t
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

311 { "mpÿ¡", 
do_mpÿ¡
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

312 { "mpş—rmÚey", 
do_mpş—rmÚey
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

313 { "m³cho", 
do_m³cho
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

314 { "m³chßround", 
do_m³chßround
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

315 { "m³chßt", 
do_m³chßt
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

316 { "mpfÜû", 
do_mpfÜû
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

317 { "mpgÙo", 
do_mpgÙo
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

318 { "mpjunk", 
do_mpjunk
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

319 { "mpkl", 
do_mpkl
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

320 { "mpmlßd", 
do_mpmlßd
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

321 { "mpŞßd", 
do_mpŞßd
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

322 { "mµurge", 
do_mµurge
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

323 { "mp¡©", 
do_mp¡©
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWB
 },

324 { "m±¿nsãr", 
do_m±¿nsãr
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GM
 },

325 { "music", 
do_music
, 
POS_SLEEPING
, 
LOG_NORMAL
, 1, 0 },

326 { "mwh”e", 
do_mwh”e
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

328 { "Ãw·sswÜd", 
do_Ãw·sswd
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

329 { "Ãwb›k™", 
do_Ãwb›k™
, 
POS_RESTING
, 
LOG_ALWAYS
, 5, 0 },

330 { "Ãwb›mak”", 
do_ÿnmakebag
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

331 { "Ãwlock", 
do_Ãwlock
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

332 { "Ãxt", 
do_Ãxt
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

333 { "nofŞlow", 
do_nofŞlow
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

334 { "nŞoÙ", 
do_nŞoÙ
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

335 { "nÜ•ly", 
do_nÜ•ly
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

336 { "nosummÚ", 
do_nosummÚ
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

337 { "nÙe", 
do_nÙe
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

338 { "nÙify", 
do_nÙify
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

339 { "Üd”", 
do_Üd”
, 
POS_RESTING
, 
LOG_NORMAL
, 8, 0 },

340 { "oşÚe", 
do_oşÚe
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

341 { "Şdsÿn", 
do_Şdsÿn
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

342 { "Şev–", 
do_Şev–
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

343 { "ooc", 
do_ooc
, 
POS_SLEEPING
, 
LOG_NORMAL
, 6, 0 },

344 { "İ’", 
do_İ’
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

345 { "outf™", 
do_outf™
, 
POS_RESTING
, 
LOG_NORMAL
, 8, 0 },

346 { "owh”e", 
do_owh”e
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

347 { "owÃr", 
do_owÃr
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

348 { "·ge", 
do_·ge
, 
POS_DEAD
, 
LOG_NORMAL
, 1, 0 },

349 { "·štbow", 
do_·štbow
, 
POS_SLEEPING
, 
LOG_NORMAL
, 6, 0 },

350 { "·rdÚ", 
do_·rdÚ
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

351 { "·sswÜd", 
do_·sswÜd
, 
POS_DEAD
, 
LOG_NEVER
, 6, 0 },

352 { "³aû", 
do_³aû
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

353 { "³cho", 
do_³cho
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWQ
 },

354 { "³ek", 
do_³ek
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

355 { "³rsÚ®", 
do_³rsÚ®
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

356 { "³rm™", 
do_³rm™
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

357 { "³t", 
do_³t
, 
POS_RESTING
, 
LOG_NORMAL
, 8, 0 },

358 { "pick", 
do_pick
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

359 { "p™", 
do_p™
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

361 { "pk", 
do_pk
, 
POS_SLEEPING
, 
LOG_NORMAL
, 6, 0 },

362 { "¶ay", 
do_¶ay
, 
POS_RESTING
, 
LOG_NORMAL
, 1, 0 },

363 { "pmÙe", 
do_pmÙe
, 
POS_RESTING
, 
LOG_NORMAL
, 1, 0 },

364 { "pock‘", 
do_pock‘
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWB
 },

365 { "poofš", 
do_bamfš
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 0 },

366 { "poofout", 
do_bamfout
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 0 },

367 { "po£", 
do_po£
, 
POS_RESTING
, 
LOG_NORMAL
, 1, 0 },

368 { "pour", 
do_pour
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

369 { "´aùiû", 
do_´aùiû
, 
POS_SLEEPING
, 
LOG_NORMAL
, 8, 0 },

370 { "´ay", 
do_´ay
, 
POS_DEAD
, 
LOG_NORMAL
, 1, 0 },

371 { "´efi", 
do_´efi
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 0 },

372 { "´efix", 
do_´efix
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

373 { "´šth–ps", 
do_´šth–ps
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GD
 | 
GWG
 },

374 { "´iv©e", 
do_´iv©e
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

375 { "´om±", 
do_´om±
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

376 { "´İo£", 
do_´İo£
, 
POS_STANDING
, 
LOG_NORMAL
, 8, 0 },

377 { "´Ùeù", 
do_´Ùeù
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

378 { "p¡©", 
do_p¡©
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

379 { "put", 
do_put
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

380 { "punish", 
do_punish
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

381 { "purge", 
do_purge
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

382 { "push", 
do_push
, 
POS_STANDING
, 
LOG_NORMAL
, 8, 0 },

383 { "qpcÚv", 
do_qpcÚv
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

384 { "q‹Î", 
do_q‹Î
, 
POS_DEAD
, 
LOG_NORMAL
, 1, 0 },

385 { "quaff", 
do_quaff
, 
POS_RESTING
, 
LOG_NORMAL
, 7, 0 },

386 { "qu”y", 
do_qu”y
, 
POS_DEAD
, 
LOG_NORMAL
, 1, 0 },

387 { "que¡", 
do_que¡
, 
POS_SLEEPING
, 
LOG_NORMAL
, 9, 0 },

388 { "que¡iÚ", 
do_que¡iÚ
, 
POS_SLEEPING
, 
LOG_NORMAL
, 1, 0 },

389 { "qui", 
do_qui
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 0 },

390 { "qu›t", 
do_qu›t
, 
POS_SLEEPING
, 
LOG_NORMAL
, 1, 0 },

391 { "qu™", 
do_qu™
, 
POS_DEAD
, 
LOG_NORMAL
, 8, 0 },

392 { "qwe¡", 
do_qwe¡
, 
POS_DEAD
, 
LOG_NORMAL
, 1, 0 },

393 { "»¡", 
do_»¡
, 
POS_SLEEPING
, 
LOG_NORMAL
, 8, 0 },

394 { "¿ge", 
do_¿ge
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

395 { "¿nk", 
do_¿nk
, 
POS_DEAD
, 
LOG_NORMAL
, 8, 
GC
 },

396 { "»ad", 
do_look
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

397 { "»boo", 
do_»boo
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 0 },

398 { "»boÙ", 
do_»boÙ
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GL
 | 
GWC
 },

399 { "»ÿÎ", 
do_»ÿÎ
, 
POS_FIGHTING
, 
LOG_NORMAL
, 8, 0 },

400 { "»c™e", 
do_»c™e
, 
POS_RESTING
, 
LOG_NORMAL
, 7, 0 },

401 { "»jeù", 
do_»jeù
, 
POS_RESTING
, 
LOG_NORMAL
, 8, 0 },

403 { "»loÿ‹", 
do_»loÿ‹
, 
POS_FIGHTING
, 
LOG_NORMAL
, 8, 0 },

404 { "»Ëv–", 
do_»Ëv–
, 
POS_DEAD
, 
LOG_ALWAYS
, 1, 0 },

405 { "»move", 
do_»move
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

406 { "»mÜt", 
do_»mÜt
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GH
 },

407 { "»mex™", 
do_»mex™
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWC
 },

408 { "»Çme", 
do_»Çme
, 
POS_RESTING
, 
LOG_NORMAL
, 8, 0 },

409 { "»pÜt", 
do_»pÜt
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

410 { "»·œ", 
do_»·œ
, 
POS_STANDING
, 
LOG_NORMAL
, 9, 0 },

411 { "»¶y", 
do_»¶y
, 
POS_DEAD
, 
LOG_NORMAL
, 1, 0 },

412 { "»¶ay", 
do_»¶ay
, 
POS_SLEEPING
, 
LOG_NORMAL
, 1, 0 },

413 { "»scue", 
do_»scue
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

414 { "»¡Üe", 
do_»¡Üe
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GL
 | 
GWG
 },

415 { "»tuº", 
do_»tuº
, 
POS_DEAD
, 
LOG_NORMAL
, 8, 0 },

416 { "»voke", 
do_»voke
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

417 { "rid—", 
do_rid—
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

418 { "¾i¡", 
do_roomli¡
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWB
 },

419 { "rŞ•Ïy", 
do_rŞ•Ïy
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

420 { "roomex™s", 
do_roomex™s
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWB
 },

421 { "rÙ©e", 
do_rÙ©e
, 
POS_DEAD
, 
LOG_NORMAL
, 2, 0 },

422 { "½·w¬d", 
do_½·w¬d
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

423 { "ruËs", 
do_ruËs
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

424 { "rwh”e", 
do_rwh”e
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

425 { "§y", 
do_§y
, 
POS_RESTING
, 
LOG_NORMAL
, 1, 0 },

426 { "§üifiû", 
do_§üifiû
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

427 { "§ve", 
do_§ve
, 
POS_DEAD
, 
LOG_NORMAL
, 8, 0 },

428 { "scÜe", 
do_scÜe
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

429 { "sÿn", 
do_sÿn
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

430 { "sÿ‰”", 
do_sÿ‰”
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

431 { "scÚ", 
do_scÚ
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 
GAV
 },

432 { "süibe", 
do_süibe
, 
POS_STANDING
, 
LOG_NORMAL
, 7, 0 },

433 { "süŞl", 
do_süŞl
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

434 { "£cÚd", 
do_£cÚd
, 
POS_RESTING
, 
LOG_NORMAL
, 2, 0 },

435 { "£cu»", 
do_£cu»
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GD
 | 
GWG
 },

436 { "£d™", 
do_£d™
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWB
 },

437 { "£Î", 
do_£Î
, 
POS_RESTING
, 
LOG_NORMAL
, 9, 0 },

438 { "£mÙe", 
do_smÙe
, 
POS_DEAD
, 
LOG_NORMAL
, 1, 0 },

439 { "£t", 
do_£t
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWQ
 },

440 { "£tgameš", 
do_£tgameš
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

441 { "£tgameout", 
do_£tgameout
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

442 { "shoÙ", 
do_shoÙ
, 
POS_STANDING
, 
LOG_NORMAL
, 2, 0 },

443 { "shadowfÜm", 
do_shadow
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

445 { "shÜtwho", 
do_swho
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 
GWG
 },

446 { "show", 
do_show
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

447 { "showæags", 
do_showæags
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

448 { "showÏ¡", 
do_showÏ¡
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

449 { "showlo¡", 
do_showlo¡
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

450 { "show¿ff", 
do_show¿ff
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

451 { "shutdow", 
do_shutdow
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GWC
 },

452 { "shutdown", 
do_shutdown
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GL
 | 
GWC
 },

453 { "sšg", 
do_sšg
, 
POS_STANDING
, 
LOG_NORMAL
, 4, 0 },

454 { "s™", 
do_s™
, 
POS_SLEEPING
, 
LOG_NORMAL
, 8, 0 },

455 { "skls", 
do_skls
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

456 { "skÍošt", 
do_skÍošt
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

457 { "¦a", 
do_¦a
, 
POS_DEAD
, 
LOG_NORMAL
, 0, 
GWS
 },

458 { "¦ay", 
do_¦ay
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GL
 | 
GWS
 },

459 { "¦“p", 
do_¦“p
, 
POS_SLEEPING
, 
LOG_NORMAL
, 8, 0 },

460 { "¦ookup", 
do_¦ookup
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWC
 },

461 { "sm™e", 
do_sm™e
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

462 { "¢—k", 
do_¢—k
, 
POS_STANDING
, 
LOG_NORMAL
, 8, 0 },

463 { "¢oİ", 
do_¢oİ
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

464 { "socŸl", 
do_glob®socŸl
, 
POS_SLEEPING
, 
LOG_NORMAL
, 1, 0 },

465 { "socŸls", 
do_socŸls
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

466 { "sock‘s", 
do_sock‘s
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

467 { "¥–ls", 
do_¥–ls
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

468 { "¥ou£lk", 
do_¥ou£lk
, 
POS_SLEEPING
, 
LOG_NORMAL
, 1, 0 },

469 { "¥ou£g©e", 
do_¥ou£g©e
, 
POS_STANDING
, 
LOG_NORMAL
, 8, 0 },

470 { "¥l™", 
do_¥l™
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

471 { "¡ªd", 
do_¡ªd
, 
POS_SLEEPING
, 
LOG_NORMAL
, 8, 0 },

472 { "¡©", 
do_¡©
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

473 { "¡—l", 
do_¡—l
, 
POS_STANDING
, 
LOG_NORMAL
, 4, 0 },

474 { "¡Üage", 
do_¡Üage
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GD
 | 
GWG
 },

475 { "¡Üy", 
do_¡Üy
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

476 { "¡ršg", 
do_¡ršg
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

477 { "¡rÚgbox", 
do_¡rÚgbox
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

478 { "su³rwiz", 
do_su³rwiz
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GD
 | 
GWG
 },

479 { "swho", 
do_swho
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 
GWG
 },

480 { "sw™ch", 
do_sw™ch
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWQ
 },

481 { "‹Î", 
do_‹Î
, 
POS_DEAD
, 
LOG_NORMAL
, 1, 0 },

482 { "", 
do_
, 
POS_SLEEPING
, 
LOG_ALWAYS
, 5, 
GWS
 },

483 { "ke", 
do_g‘
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

484 { "p", 
do_§üifiû
, 
POS_RESTING
, 
LOG_NORMAL
, 0, 0 },

485 { "‹¡po£", 
do_‹¡po£
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

486 { "time", 
do_time
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

487 { "t™Ë", 
do_t™Ë
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

488 { "touch", 
do_touch
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

489 { "Œaš", 
do_Œaš
, 
POS_RESTING
, 
LOG_NORMAL
, 8, 0 },

490 { "Œade", 
do_Œade
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

491 { "Œªsãr", 
do_Œªsãr
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

492 { "Œ", 
do_Œ
, 
POS_FIGHTING
, 
LOG_NORMAL
, 2, 0 },

493 { "ty³li¡", 
do_ty³li¡
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWG
 },

494 { "typo", 
do_typo
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

495 { "uÇlŸs", 
do_uÇlŸs
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

496 { "und’y", 
do_und’y
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWS
 },

497 { "unjoš", 
do_unjoš
, 
POS_RESTING
, 
LOG_ALWAYS
, 8, 
GC
 },

498 { "uÆock", 
do_uÆock
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

499 { "uÄ—d", 
do_uÄ—d
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

500 { "v®ue", 
do_v®ue
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

501 { "video", 
do_video
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

502 { "viŞ©e", 
do_viŞ©e
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GD
 | 
GWG
 },

503 { "visibË", 
do_visibË
, 
POS_SLEEPING
, 
LOG_NORMAL
, 8, 0 },

504 { "vli¡", 
do_vli¡
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWB
 },

505 { "vnum", 
do_vnum
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

506 { "wake", 
do_wake
, 
POS_SLEEPING
, 
LOG_NORMAL
, 8, 0 },

507 { "w¬", 
do_w¬
, 
POS_SLEEPING
, 
LOG_NORMAL
, 6, 0 },

508 { "w¬p", 
do_w¬p
, 
POS_FIGHTING
, 
LOG_NORMAL
, 8, 0 },

509 { "wbb", 
do_wbb
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

510 { "wbi", 
do_wbi
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

511 { "w—r", 
do_w—r
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

512 { "w—th”", 
do_w—th”
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

513 { "weddšgršg", 
do_weddšgršg
, 
POS_RESTING
, 
LOG_NORMAL
, 9, 0 },

514 { "wh”e", 
do_wh”e
, 
POS_RESTING
, 
LOG_NORMAL
, 3, 0 },

515 { "whi¥”", 
do_whi¥”
, 
POS_SLEEPING
, 
LOG_NEVER
, 1, 0 },

516 { "who", 
do_who
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

517 { "whois", 
do_whois
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

518 { "w›ld", 
do_w—r
, 
POS_RESTING
, 
LOG_NORMAL
, 4, 0 },

519 { "wimpy", 
do_wimpy
, 
POS_DEAD
, 
LOG_NORMAL
, 6, 0 },

520 { "w™hd¿w", 
do_w™hd¿w
, 
POS_STANDING
, 
LOG_NORMAL
, 9, 0 },

521 { "wizh–p", 
do_wizh–p
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

522 { "wizgroup", 
do_wizgroup
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GL
 | 
GWG
 },

523 { "wizšvis", 
do_švis
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

524 { "wizify", 
do_wizify
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GL
 | 
GWG
 },

525 { "wizli¡", 
do_wizli¡
, 
POS_DEAD
, 
LOG_NORMAL
, 3, 0 },

526 { "wizlock", 
do_wizlock
, 
POS_DEAD
, 
LOG_ALWAYS
, 5, 
GWC
 },

527 { "wizÃt", 
do_wizÃt
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWG
 },

528 { "wÜth", 
do_wÜth
, 
POS_SLEEPING
, 
LOG_NORMAL
, 3, 0 },

529 { "wÜk", 
do_wÜk
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWC
 },

530 { "y–l", 
do_y–l
, 
POS_RESTING
, 
LOG_NORMAL
, 1, 0 },

531 { "z­", 
do_z­
, 
POS_RESTING
, 
LOG_NORMAL
, 7, 0 },

532 { "zecho", 
do_zecho
, 
POS_DEAD
, 
LOG_NORMAL
, 5, 
GWQ
 },

539 
	$š‹½»t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

541 
cmd
;

542 
boŞ
 
found
;

547 
¬gum’t
 =‡rgum’t.
	`l¡r
();

549 ià(
¬gum’t
.
	`em±y
()) {

551 ià(
ch
->
pcd©a


552 && 
ch
->
pcd©a
->
video_æags
.
	`has
(
VIDEO_VT100
)) {

553 
	`gÙo_lše
(
ch
, ch->
lšes
, 1);

554 
	`¡c
(
VT_CLEAR_LINE
, 
ch
);

563 ià(!
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
PLR_FREEZE
)) {

564 
	`±c
(
ch
, "YouryØ{G%-100.100s{x\n", 
¬gum’t
);

565 
	`¡c
("A…ow”fuÈfÜû sÏm you u°agaš¡hÃ¬e¡ objeù. YOU'RE FROZEN!\n", 
ch
);

574 
	`¡rıy
(
loglše
, 
¬gum’t
);

576 
SŒšg
 
commªd
;

578 ià(!
	`i§Íha
(
¬gum’t
[0]è&& !
	`isdig™
(argument[0])) {

579 
commªd
 = 
¬gum’t
[0];

580 
¬gum’t
 =‡rgum’t.
	`sub¡r
(1).
	`l¡r
();

583 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
commªd
);

588 
found
 = 
çl£
;

591 ià(
ch
->
	`has_cgroup
(
GROUP_LEADER
))

592 
ch
->
	`add_cgroup
(
GROUP_DEPUTY
);

594 
cmd
 = 0; cmd < 
cmd_bË
.
	`size
(); cmd++) {

596 ià(
ch
->
	`is_Åc
()) {

597 ià(!
cmd_bË
[
cmd
].
group
.
	`em±y
()

598 && !
cmd_bË
[
cmd
].
group
.
	`has
(
GROUP_MOBILE
))

603 ià(
cmd_bË
[
cmd
].
group
.
	`has
(
GROUP_MOBILE
))

607 ià(!
cmd_bË
[
cmd
].
group
.
	`em±y
()

608 && !
ch
->
pcd©a
->
cgroup_æags
.
	`has_®l_of
(
cmd_bË
[
cmd
].
group
))

612 ià(
commªd
.
	`is_´efix_of
(
cmd_bË
[
cmd
].
Çme
)) {

613 
found
 = 
Œue
;

619 ià(
ch
->
	`has_cgroup
(
GROUP_LEADER
))

620 
ch
->
	`»move_cgroup
(
GROUP_DEPUTY
);

625 ià(
cmd_bË
[
cmd
].
log
 =ğ
LOG_NEVER
)

626 
	`¡rıy
(
loglše
, "");

628 ià((!
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
PLR_LOG
))

629 || 
Game
::
log_®l


630 || 
cmd_bË
[
cmd
].
log
 =ğ
LOG_ALWAYS
) {

631 
SŒšg
 
log_buf
 = 
FÜm©
::
	`fÜm©
("Log %s: %s", 
ch
->
Çme
, 
loglše
);

633 ià(
cmd_bË
[
cmd
].
log
 =ğ
LOG_ALWAYS
)

634 
	`wizÃt
(
log_buf
, 
ch
, 
nuÎ±r
, 
WIZ_SECURE
, 0, 
	`GET_RANK
(ch));

636 ià(
ch
->
aù_æags
.
	`has
(
PLR_LOG
)) {

637 *
¡¹ime
;

638 
tmp
[
MAX_STRING_LENGTH
];

639 
¡¹ime
 = 
	`ùime
(&
Game
::
cu¼’t_time
);

640 
¡¹ime
[
	`¡¾’
(strtime) - 1] = '\0';

641 
FÜm©
::
	`¥rštf
(
tmp
, "% :: %s\n", 
¡¹ime
, 
log_buf
);

642 
	`çµ’d
(
SLOG_FILE
, 
tmp
);

645 
Loggšg
::
	`log
(
log_buf
);

648 ià(
ch
->
desc
 !ğ
nuÎ±r
 && ch->desc->
¢oİ_by
 !=‚ullptr) {

649 
	`wr™e_to_bufãr
(
ch
->
desc
->
¢oİ_by
, "% ");

650 
	`wr™e_to_bufãr
(
ch
->
desc
->
¢oİ_by
, 
loglše
);

651 
	`wr™e_to_bufãr
(
ch
->
desc
->
¢oİ_by
, "\n");

654 ià(!
found
) {

658 ià(!
	`check_socŸl
(
ch
, 
commªd
, 
¬gum’t
))

659 
	`do_huh
(
ch
);

664 ià(
	`check_di§bËd
(&
cmd_bË
[
cmd
])) {

665 
	`¡c
("Thi commªd ha b“À‹mpÜ¬y di§bËd.\n", 
ch
);

670 ià(!
	`IS_IMMORTAL
(
ch
è&& 
	`g‘_pos™iÚ
(chè< 
cmd_bË
[
cmd
].
pos™iÚ
) {

671 
	`g‘_pos™iÚ
(
ch
)) {

672 
POS_DEAD
:

673 
	`¡c
("Thi i NOThnighˆoàthlivšg DEAD!\n", 
ch
);

676 
POS_MORTAL
:

677 
POS_INCAP
:

678 
	`¡c
("You‡» hu¹ f¬oØbad fÜh©.\n", 
ch
);

681 
POS_STUNNED
:

682 
	`¡c
("You‡»oØ¡uÂedØdØth©.\n", 
ch
);

685 
POS_SLEEPING
:

686 
	`¡c
("IÀyou¸d»ams, o¸wh©?\n", 
ch
);

689 
POS_RESTING
:

690 
	`¡c
("Nah... You f“ÈtoØ»Ïxed...\n", 
ch
);

693 
POS_SITTING
:

694 
	`¡c
("B‘‹¸¡ªd u°fœ¡.\n", 
ch
);

697 
POS_FIGHTING
:

698 
	`¡c
("NØway! You‡» stÈfightšg!\n", 
ch
);

701 
POS_STANDING
:

702 
	`¡c
("You cª'ˆdØth© fromhground.\n", 
ch
);

712 (*
cmd_bË
[
cmd
].
do_fun
)(
ch
, 
¬gum’t
);

715 ià(
ch
 && !ch->
	`is_g¬bage
(è&& ch->
pcd©a
 && ch->pcd©a->
video_æags
.
	`has
(
VIDEO_VT100
)) {

716 
	`gÙo_lše
(
ch
, ch->
lšes
, 1);

717 
	`¡c
(
VT_CLEAR_LINE
, 
ch
);

721 
	}
}

723 
boŞ
 
	$check_socŸl
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
commªd
, cÚ¡ SŒšg& 
¬gum’t
)

725 
Ch¬aù”
 *
viùim
;

726 
SocŸl
 *
™”©Ü
;

727 
boŞ
 
found
;

728 
found
 = 
çl£
;

730 
™”©Ü
 = 
socŸl_bË_h—d
->
Ãxt
; i‹¿tÜ !ğ
socŸl_bË_
; iterator = iterator->next) {

731 ià(
commªd
.
	`is_´efix_of
(
™”©Ü
->
Çme
)) {

732 
found
 = 
Œue
;

737 ià(!
found
)

738  
çl£
;

740 ià(!
ch
->
	`is_Åc
(è&& ch->
»voke_æags
.
	`has
(
REVOKE_EMOTE
)) {

741 
	`¡c
("You‡»‡Ái-socŸl!\n", 
ch
);

742  
Œue
;

745 
	`g‘_pos™iÚ
(
ch
)) {

746 
POS_DEAD
:

747 
	`¡c
("Thi i NOThnighˆoàthlivšg DEAD.\n", 
ch
);

748  
Œue
;

750 
POS_INCAP
:

751 
POS_MORTAL
:

752 
	`¡c
("You‡» hu¹ f¬oØbad fÜh©.\n", 
ch
);

753  
Œue
;

755 
POS_STUNNED
:

756 
	`¡c
("You‡»oØ¡uÂedØdØth©.\n", 
ch
);

757  
Œue
;

759 
POS_SLEEPING
:

763 ià(
™”©Ü
->
Çme
 == "snore")

766 
	`¡c
("Stİ fidg‘šg‡nd g‘ som¦“p!\n", 
ch
);

767  
Œue
;

770 
SŒšg
 
¬g
;

771 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

772 
viùim
 = 
nuÎ±r
;

774 ià(
¬g
.
	`em±y
()) {

775 
	`aù
(
™”©Ü
->
Ùh”s_no_¬g
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_ROOM
);

776 
	`aù
(
™”©Ü
->
ch¬_no_¬g
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

778 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
)

779 
	`¡c
("They‡»‚Ù h”e.\n", 
ch
);

780 ià(
viùim
 =ğ
ch
) {

781 
	`aù
(
™”©Ü
->
Ùh”s_auto
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_ROOM
);

782 
	`aù
(
™”©Ü
->
ch¬_auto
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

785 
	`aù
(
™”©Ü
->
Ùh”s_found
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

786 
	`aù
(
™”©Ü
->
ch¬_found
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

787 
	`aù
(
™”©Ü
->
viù_found
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

789 ià(!
ch
->
	`is_Åc
(è&& 
viùim
->is_npc()

790 && !
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ch¬m_³rsÚ
)

791 && 
	`IS_AWAKE
(
viùim
)

792 && 
viùim
->
desc
 =ğ
nuÎ±r


793 && (!
viùim
->
pIndexD©a
->
´ogty³_æags
.
	`has
(
ACT_PROG
))) {

794 
	`numb”_b™s
(4)) {

798 
	`aù
(
™”©Ü
->
Ùh”s_found
,

799 
viùim
, 
nuÎ±r
, 
ch
, 
TO_NOTVICT
);

800 
	`aù
(
™”©Ü
->
ch¬_found
,

801 
viùim
, 
nuÎ±r
, 
ch
, 
TO_CHAR
);

802 
	`aù
(
™”©Ü
->
viù_found
,

803 
viùim
, 
nuÎ±r
, 
ch
, 
TO_VICT
);

807 
	`aù
("$À¿i£ ªƒyebrow‡ˆ$N.", 
viùim
, 
nuÎ±r
, 
ch
, 
TO_NOTVICT
);

808 
	`aù
("You„ai£‡Àeyebrow‡ˆ$N.", 
viùim
, 
nuÎ±r
, 
ch
, 
TO_CHAR
);

809 
	`aù
("$À¿i£ ªƒyebrow‡ˆyou.", 
viùim
, 
nuÎ±r
, 
ch
, 
TO_VICT
);

816 ià(
ch
->
pcd©a
 && ch->pcd©a->
video_æags
.
	`has
(
VIDEO_VT100
)) {

817 
	`gÙo_lše
(
ch
, ch->
lšes
, 1);

818 
	`¡c
(
VT_CLEAR_LINE
, 
ch
);

821  
Œue
;

822 
	}
}

827 
	$do_commªds
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

829 
buf
[
MAX_STRING_LENGTH
];

830 
cŞ
;

831 
x
;

832 
¬g
;

833 
couÁ”
;

834 
	sf›ld_¡ruù
 {

835 *
Çme
;

836 
numb”
;

837 } 
f›lds
[] = {

851 ià(
¬gum’t
.
	`em±y
()) {

852 
	`¡c
("Commªd SŒuùu»:\n\n", 
ch
);

854 
x
 = 1, 
couÁ”
 = 1; 
f›lds
[x].
numb”
; x++) {

855 
FÜm©
::
	`¥rštf
(
buf
, "[%d] %s\n", 
couÁ”
, 
f›lds
[
x
].
Çme
);

856 
	`¡c
(
buf
, 
ch
);

857 
couÁ”
++;

863 ià(
¬gum’t
.
	`is_numb”
()) {

864 
¬g
 = 
	`©oi
(
¬gum’t
);

866 
x
 = 1; 
f›lds
[x].
numb”
 != 0; x++)

867 ià(
f›lds
[
x
].
numb”
 =ğ
¬g
)

871 
x
 = 1; 
f›lds
[x].
numb”
 != 0; x++)

872 ià(
¬gum’t
.
	`is_´efix_of
(
f›lds
[
x
].
Çme
))

876 ià(*(
f›lds
[
x
].
Çme
) == '\n') {

877 
	`¡c
("Inv®id O±iÚ.\n", 
ch
);

881 
cŞ
 = 0;

883 cÚ¡‡uto& 
’Œy
 : 
cmd_bË
) {

884 ià(
	`IS_IMM_GROUP
(
’Œy
.
group
))

888 ià(
ch
->
	`is_Åc
()) {

889 ià(!
’Œy
.
group
.
	`em±y
()

890 && !
’Œy
.
group
.
	`has
(
GROUP_MOBILE
))

895 ià(
’Œy
.
group
.
	`has
(
GROUP_MOBILE
))

899 ià(!
’Œy
.
group
.
	`em±y
()

900 && !
ch
->
pcd©a
->
cgroup_æags
.
	`has_®l_of
(
’Œy
.
group
))

904 ià(
’Œy
.
show
 =ğ
f›lds
[
x
].
numb”
) {

905 
FÜm©
::
	`¥rštf
(
buf
, "[%2d] %-14s", 
couÁ”
, 
’Œy
.
Çme
);

906 
	`¡c
(
buf
, 
ch
);

908 ià(++
cŞ
 % 4 == 0)

909 
	`¡c
("\n", 
ch
);

911 
couÁ”
++;

915 ià(
cŞ
 % 4 != 0)

916 
	`¡c
("\n", 
ch
);

919 
	}
}

921 
	$do_huh
(
Ch¬aù”
 *
ch
)

923 *cÚ¡ 
mes§ge
 [] = {

937 
	`¡c
(
mes§ge
[
	`numb”_¿nge
(0, 11)], 
ch
);

939 
	}
}

941 
	$do_wizh–p
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

943 
SŒšg
 
buf
;

946 ià(
ch
->
	`has_cgroup
(
GROUP_LEADER
))

947 
ch
->
	`add_cgroup
(
GROUP_DEPUTY
);

949 cÚ¡‡uto& 
group
 : 
cgroup_æags
) {

950 ià(!
	`IS_IMM_GROUP
(
group
.
b™
))

953 ià(!
ch
->
	`has_cgroup
(
group
.
b™
))

956 ià(!
buf
.
	`em±y
())

957 
buf
 += "\n";

959 
buf
 +ğ
FÜm©
::
	`fÜm©
("{G%s{x\n", 
group
.
Çme
);

960 
cŞ
 = 0;

962 cÚ¡‡uto& 
commªd
 : 
cmd_bË
) {

963 ià(
commªd
.
group
.
	`has
(group.
b™
)

964 && 
ch
->
pcd©a
->
cgroup_æags
.
	`has_®l_of
(
commªd
.
group
)

965 && 
commªd
.
show
) {

966 ià(
cŞ
 % 5 == 0)

967 
buf
 += " ";

969 
buf
 +ğ
FÜm©
::
	`fÜm©
("%s%-14s{x",

970 
commªd
.
group
.
	`has
(
GROUP_LEADER
) ? "{Y" :

971 
commªd
.
group
.
	`has
(
GROUP_DEPUTY
) ? "{C" : "",

972 
commªd
.
Çme
);

974 ià(++
cŞ
 % 5 == 0)

975 
buf
 += "\n";

979 ià(
cŞ
 % 5 != 0)

980 
buf
 += "\n";

984 ià(
ch
->
	`has_cgroup
(
GROUP_LEADER
))

985 
ch
->
	`»move_cgroup
(
GROUP_DEPUTY
);

987 
	`¡c
(
buf
, 
ch
);

988 
	}
}

	@src/load_config.cc

1 
	~"../d•s/cJSON/cJSON.h
"

2 
	~"JSON/cJSON.hh
"

3 
	~"FÜm©.hh
"

4 
	~"Loggšg.hh
"

6 
	$lßd_cÚfig
(cÚ¡ *
f’ame
) {

7 
™ems
 = 0;

8 
cJSON
 *
jsÚ
 = 
JSON
::
	`»ad_fe
(
f’ame
);

10 ià(
jsÚ
 =ğ
nuÎ±r
) {

11 
Loggšg
::
	`bug
("Error„eading config file.", 0);

34 
	`cJSON_D–‘e
(
jsÚ
);

35 
FÜm©
::
	`´štf
("lßded %d i‹m äom cÚfig fe\n", 
™ems
);

37 
	}
}

	@src/lookup.cc

28 
	~<veùÜ
>

30 
	~"CÏn.hh
"

31 
	~"deş¬e.hh
"

32 
	~"m”c.hh
"

33 
	~"SŒšg.hh
"

34 
	~"bËs.hh
"

35 
	~"lookup.hh
"

37 
CÏn
 *
	$şª_vnum_lookup
(cÚ¡ 
Vnum
& 
vnum
)

39 
CÏn
 *
c
;

41 
c
 = 
şª_bË_h—d
->
Ãxt
; c !ğ
şª_bË_
; c = c->next)

42 ià(
vnum
 >ğ
c
->
¬—_mšvnum
 && vnum <ğc->
¬—_maxvnum
)

43  
c
;

45  
nuÎ±r
;

46 
	}
}

48 
CÏn
 *
	$şª_lookup
(cÚ¡ 
SŒšg
& 
Çme
)

50 
CÏn
 *
™”©Ü
;

52 ià(
Çme
.
	`em±y
())

53  
nuÎ±r
;

55 
™”©Ü
 = 
şª_bË_h—d
->
Ãxt
;

57 
™”©Ü
 !ğ
şª_bË_
) {

58 ià(
Çme
.
	`is_´efix_of
(
™”©Ü
->name))

59  
™”©Ü
;

61 
™”©Ü
 = i‹¿tÜ->
Ãxt
;

64  
nuÎ±r
;

65 
	}
}

67 
	$pos™iÚ_lookup
(cÚ¡ 
SŒšg
& 
Çme
)

69 
pos
;

71 
pos
 = 0;…o < 
pos™iÚ_bË
.
	`size
();…os++) {

72 ià(
	`tŞow”
(
Çme
[0]è=ğtŞow”(
pos™iÚ_bË
[
pos
].name[0])

73 && 
Çme
.
	`is_´efix_of
(
pos™iÚ_bË
[
pos
].name))

74  
pos
;

78 
	}
}

80 
	$£x_lookup
(cÚ¡ 
SŒšg
& 
Çme
)

82 
£x
;

84 
£x
 = 0; sex < 
£x_bË
.
	`size
(); sex++) {

85 ià(
	`tŞow”
(
Çme
[0]è=ğtŞow”(
£x_bË
[
£x
].name[0])

86 && 
Çme
.
	`is_´efix_of
(
£x_bË
[
£x
].name))

87  
£x
;

91 
	}
}

93 
	$size_lookup
(cÚ¡ 
SŒšg
& 
Çme
)

95 
size
;

97 
size
 = 0; siz< 
size_bË
.
	`size
(); size++) {

98 ià(
	`tŞow”
(
Çme
[0]è=ğtŞow”(
size_bË
[
size
].name[0])

99 && 
Çme
.
	`is_´efix_of
(
size_bË
[
size
].name))

100  
size
;

104 
	}
}

106 
SŒšg
 
	$cÚd™iÚ_lookup
(
cÚd™iÚ
)

108 ià(
cÚd™iÚ
 >= 100)

110 ià(
cÚd™iÚ
 >= 90)

112 ià(
cÚd™iÚ
 >= 75)

114 ià(
cÚd™iÚ
 >= 50)

116 ià(
cÚd™iÚ
 >= 25)

118 ià(
cÚd™iÚ
 >= 10)

120 ià(
cÚd™iÚ
 >= 0)

122 ià(
cÚd™iÚ
 >= -1)

126 
	}
}

128 
SŒšg
 
	$£ùÜ_lookup
(
SeùÜ
 
ty³
)

130 
i
;

132 
i
 = 0; i < 
£ùÜ_bË
.
	`size
(); i++)

133 ià(
£ùÜ_bË
[
i
].
ty³
 ==ype)

134  
£ùÜ_bË
[
i
].
Çme
;

137 
	}
}

140 
	$¿û_lookup
(cÚ¡ 
SŒšg
& 
Çme
)

142 
¿û
;

144 
¿û
 = 0;„aû < 
¿û_bË
.
	`size
();„ace++) {

145 ià(
	`tŞow”
(
Çme
[0]è=ğtŞow”(
¿û_bË
[
¿û
].name[0])

146 && 
Çme
.
	`is_´efix_of
(
¿û_bË
[
¿û
].name))

147  
¿û
;

151 
	}
}

153 
	$w—pÚ_lookup
(cÚ¡ 
SŒšg
& 
Çme
)

155 
ty³
;

157 
ty³
 = 0;y³ < 
w—pÚ_bË
.
	`size
();ype++) {

158 ià(
	`tŞow”
(
Çme
[0]è=ğtŞow”(
w—pÚ_bË
[
ty³
].name[0])

159 && 
Çme
.
	`is_´efix_of
(
w—pÚ_bË
[
ty³
].name))

160  
ty³
;

164 
	}
}

166 
	$g‘_w—pÚ_ty³
(cÚ¡ 
SŒšg
& 
Çme
)

168 
ty³
;

170 
ty³
 = 0;y³ < 
w—pÚ_bË
.
	`size
();ype++) {

171 ià(
	`tŞow”
(
Çme
[0]è=ğtŞow”(
w—pÚ_bË
[
ty³
].name[0])

172 && 
Çme
.
	`is_´efix_of
(
w—pÚ_bË
[
ty³
].name))

173  
w—pÚ_bË
[
ty³
].type;

176  
WEAPON_EXOTIC
;

177 
	}
}

179 
	$™em_lookup
(cÚ¡ 
SŒšg
& 
Çme
)

181 
ty³
;

183 
ty³
 = 0;y³ < 
™em_bË
.
	`size
();ype++) {

184 ià(
	`tŞow”
(
Çme
[0]è=ğtŞow”(
™em_bË
[
ty³
].name[0])

185 && 
Çme
.
	`is_´efix_of
(
™em_bË
[
ty³
].name))

186  
™em_bË
[
ty³
].type;

190 
	}
}

192 
	$©ck_lookup
(cÚ¡ 
SŒšg
& 
Çme
)

194 
©t
;

196 
©t
 = 0;‡‰ < 
©ck_bË
.
	`size
();‡tt++) {

197 ià(
	`tŞow”
(
Çme
[0]è=ğtŞow”(
©ck_bË
[
©t
].name[0])

198 && 
Çme
.
	`is_´efix_of
(
©ck_bË
[
©t
].name))

199  
©t
;

203 
	}
}

206 
Gud
 
	$gud_lookup
(cÚ¡ 
SŒšg
& 
Çme
)

208 
gud
 = 
Gud
::
fœ¡
; gud < Gud::
size
; guild++) {

209 ià(
Çme
.
	`is_´efix_of
(
gud_bË
[
gud
].name))

210  (
Gud
)
gud
;

213  
Gud
::
nÚe
;

214 
	}
}

216 
	$liq_lookup
(cÚ¡ 
SŒšg
& 
Çme
)

218 
liq
;

220 
liq
 = 0;†iq < 
liq_bË
.
	`size
();†iq++)

221 ià(
	`tŞow”
(
Çme
[0]è=ğtŞow”(
liq_bË
[
liq
].name[0])

222 && 
Çme
.
	`is_´efix_of
(
liq_bË
[
liq
].name))

223  
liq
;

226 
	}
}

	@src/loot_tables.cc

1 
	~<m­
>

2 
	~<veùÜ
>

4 
	~"afãù/Afãù.hh
"

5 
	~"deş¬e.hh
"

6 
	~"FÏgs.hh
"

7 
	~"loÙv2.hh
"

8 
	~"SŒšg.hh
"

9 
	~"cÚ¡ªts.hh
"

16 cÚ¡ 
	g¡d
::
muÉim­
<, 
	gSŒšg
> 
	gba£_Çme_bË
 = {

17 { 
ARMOR_LIGHT
, "Dim Light" },

18 { 
ARMOR_LIGHT
, "Bright Light" },

19 { 
ARMOR_LIGHT
, "Brilliant Light" },

20 { 
ARMOR_LIGHT
, "Shard of Rose Quartz" },

21 { 
ARMOR_LIGHT
, "Blessed Orb" },

22 { 
ARMOR_LIGHT
, "Divine Orb" },

23 { 
ARMOR_LIGHT
, "Alchemic Orb" },

24 { 
ARMOR_LIGHT
, "Chromatic Orb" },

25 { 
ARMOR_LIGHT
, "Prismatic Orb" },

27 { 
ARMOR_FINGER
, "Iron Ring" },

28 { 
ARMOR_FINGER
, "Steel Ring" },

29 { 
ARMOR_FINGER
, "Sapphire Ring" },

30 { 
ARMOR_FINGER
, "Ruby Ring" },

31 { 
ARMOR_FINGER
, "Gold Ring" },

32 { 
ARMOR_FINGER
, "Two-Stone Ring" },

33 { 
ARMOR_FINGER
, "Moonstone Ring" },

34 { 
ARMOR_FINGER
, "Diamond Ring" },

35 { 
ARMOR_FINGER
, "Prismatic Ring" },

37 { 
ARMOR_NECK
, "Gold Amulet" },

38 { 
ARMOR_NECK
, "Amber Amulet" },

39 { 
ARMOR_NECK
, "Turquoise Amulet" },

40 { 
ARMOR_NECK
, "Agate Amulet" },

41 { 
ARMOR_NECK
, "Citrine Amulet" },

42 { 
ARMOR_NECK
, "Onyx Amulet" },

43 { 
ARMOR_NECK
, "Ruby Amulet" },

44 { 
ARMOR_NECK
, "Chrysalis Talisman" },

45 { 
ARMOR_NECK
, "Prismatic Talisman" },

47 { 
ARMOR_TORSO
, "Padded Vest" },

48 { 
ARMOR_TORSO
, "Silken Vest" },

49 { 
ARMOR_TORSO
, "Steel Plate" },

50 { 
ARMOR_TORSO
, "War Plate" },

51 { 
ARMOR_TORSO
, "Scholar's Robe" },

52 { 
ARMOR_TORSO
, "Holy Chainmail" },

53 { 
ARMOR_TORSO
, "Full Chainmail" },

54 { 
ARMOR_TORSO
, "Carnal Armor" },

55 { 
ARMOR_TORSO
, "Prismatic Vest" },

57 { 
ARMOR_HEAD
, "Close Helmet" },

58 { 
ARMOR_HEAD
, "Raven Mask" },

59 { 
ARMOR_HEAD
, "Noble Tricorne" },

60 { 
ARMOR_HEAD
, "Deicide Mask" },

61 { 
ARMOR_HEAD
, "Fluted Bascinet" },

62 { 
ARMOR_HEAD
, "Hubris Circlet" },

63 { 
ARMOR_HEAD
, "Praetor Crown" },

64 { 
ARMOR_HEAD
, "Bone Circlet" },

65 { 
ARMOR_HEAD
, "Prismatic Mask" },

67 { 
ARMOR_LEGS
, "Leather Leggings" },

68 { 
ARMOR_LEGS
, "Padded Leggings" },

69 { 
ARMOR_LEGS
, "War Leggings" },

70 { 
ARMOR_LEGS
, "Holy Leggings" },

71 { 
ARMOR_LEGS
, "Bone Leggings" },

72 { 
ARMOR_LEGS
, "Steel Leggings" },

73 { 
ARMOR_LEGS
, "Carnal Leggings" },

74 { 
ARMOR_LEGS
, "Ornate Leggings" },

75 { 
ARMOR_LEGS
, "Prismatic Leggings" },

77 { 
ARMOR_FEET
, "Rawhide Boots" },

78 { 
ARMOR_FEET
, "Goathide Boots" },

79 { 
ARMOR_FEET
, "Clasped Boots" },

80 { 
ARMOR_FEET
, "Scholar Boots" },

81 { 
ARMOR_FEET
, "Reinforced Greaves" },

82 { 
ARMOR_FEET
, "Goliath Boots" },

83 { 
ARMOR_FEET
, "Wyrmscale Boots" },

84 { 
ARMOR_FEET
, "Arcanist Slippers" },

85 { 
ARMOR_FEET
, "Prismatic Boots" },

87 { 
ARMOR_HANDS
, "Wool Gloves" },

88 { 
ARMOR_HANDS
, "Deerskin Gloves" },

89 { 
ARMOR_HANDS
, "Embroidered Gloves" },

90 { 
ARMOR_HANDS
, "Trapper Mitts" },

91 { 
ARMOR_HANDS
, "Steel Gauntlets" },

92 { 
ARMOR_HANDS
, "Plated Gauntlets" },

93 { 
ARMOR_HANDS
, "Ironscale Gauntlets" },

94 { 
ARMOR_HANDS
, "Hydrascale Gauntlets" },

95 { 
ARMOR_HANDS
, "Prismatic Silk Gloves" },

97 { 
ARMOR_ARMS
, "Silk Sleeves" },

98 { 
ARMOR_ARMS
, "Rawhide Sleeves" },

99 { 
ARMOR_ARMS
, "Scholar's Sleeves" },

100 { 
ARMOR_ARMS
, "Occultist's Vestment" },

101 { 
ARMOR_ARMS
, "Ornate Armguards" },

102 { 
ARMOR_ARMS
, "Necromancer Silks" },

103 { 
ARMOR_ARMS
, "Goathide Armguards" },

104 { 
ARMOR_ARMS
, "Embroidered Sleeves" },

105 { 
ARMOR_ARMS
, "Prismatic Sleeves" },

107 { 
ARMOR_SHIELD
, "Goathide Buckler" },

108 { 
ARMOR_SHIELD
, "Tower Shield" },

109 { 
ARMOR_SHIELD
, "Rawhide Tower Shield" },

110 { 
ARMOR_SHIELD
, "Painted Buckler" },

111 { 
ARMOR_SHIELD
, "Linden Kite Shield" },

112 { 
ARMOR_SHIELD
, "Hammered Buckler" },

113 { 
ARMOR_SHIELD
, "Ornate Spiked Shield" },

114 { 
ARMOR_SHIELD
, "Harmonic Spirit Shield" },

115 { 
ARMOR_SHIELD
, "Prismatic Round Shield" },

117 { 
ARMOR_BODY
, "Tattered Robe" },

118 { 
ARMOR_BODY
, "Cloth Robe" },

119 { 
ARMOR_BODY
, "Cotton Robe" },

120 { 
ARMOR_BODY
, "Embroidered Robe" },

121 { 
ARMOR_BODY
, "Blue Robe" },

122 { 
ARMOR_BODY
, "Necromancer's Robe" },

123 { 
ARMOR_BODY
, "Silver Robe" },

124 { 
ARMOR_BODY
, "Ornate Robe" },

125 { 
ARMOR_BODY
, "Prismatic Robe" },

127 { 
ARMOR_WAIST
, "Sash" },

128 { 
ARMOR_WAIST
, "Chain Belt" },

129 { 
ARMOR_WAIST
, "Leather Belt" },

130 { 
ARMOR_WAIST
, "Heavy Belt" },

131 { 
ARMOR_WAIST
, "Studded Belt" },

132 { 
ARMOR_WAIST
, "Cloth Belt" },

133 { 
ARMOR_WAIST
, "Vanguard Belt" },

134 { 
ARMOR_WAIST
, "Crystal Belt" },

135 { 
ARMOR_WAIST
, "Prismatic Belt" },

137 { 
ARMOR_WRIST
, "Gold Bracelet" },

138 { 
ARMOR_WRIST
, "Amber Bracelet" },

139 { 
ARMOR_WRIST
, "Turquoise Bracer" },

140 { 
ARMOR_WRIST
, "Agate Bracelet" },

141 { 
ARMOR_WRIST
, "Citrine Bracelet" },

142 { 
ARMOR_WRIST
, "Onyx Bracer" },

143 { 
ARMOR_WRIST
, "Ruby Bracelet" },

144 { 
ARMOR_WRIST
, "Chrysalis Bracer" },

145 { 
ARMOR_WRIST
, "Prismatic Bracer" },

147 { 
ARMOR_FLOATING
, "Dim Light" },

148 { 
ARMOR_FLOATING
, "Wisp" },

149 { 
ARMOR_FLOATING
, "Pixie" },

150 { 
ARMOR_FLOATING
, "Blessed Orb" },

151 { 
ARMOR_FLOATING
, "Heavy Sigh" },

152 { 
ARMOR_FLOATING
, "Muttered Words" },

153 { 
ARMOR_FLOATING
, "Crystal Orb" },

154 { 
ARMOR_FLOATING
, "Chrysalis Orb" },

155 { 
ARMOR_FLOATING
, "Prismatic Orb" },

157 { 
ARMOR_HOLD
, "Horned Talisman" },

158 { 
ARMOR_HOLD
, "Jet Talisman" },

159 { 
ARMOR_HOLD
, "Clutching Talisman" },

160 { 
ARMOR_HOLD
, "Marble Talisman" },

161 { 
ARMOR_HOLD
, "Gold Talisman" },

162 { 
ARMOR_HOLD
, "Shadow Talisman" },

163 { 
ARMOR_HOLD
, "Chromatic Talisman" },

164 { 
ARMOR_HOLD
, "Chrysalis Talisman" },

165 { 
ARMOR_HOLD
, "Prismatic Talisman" },

167 { 
WIELD_AXE
, "Rusted Hatchet" },

168 { 
WIELD_AXE
, "Spectral Axe" },

169 { 
WIELD_AXE
, "Wraith Axe" },

170 { 
WIELD_AXE
, "Siege Axe" },

171 { 
WIELD_AXE
, "Infernal Axe" },

172 { 
WIELD_AXE
, "Wrist Chopper" },

173 { 
WIELD_AXE
, "Chest Splitter" },

174 { 
WIELD_AXE
, "Shadow Axe" },

175 { 
WIELD_AXE
, "Timber Axe" },

177 { 
WIELD_DAGGER
, "Glass Shank" },

178 { 
WIELD_DAGGER
, "Boot Knife" },

179 { 
WIELD_DAGGER
, "Prong Dagger" },

180 { 
WIELD_DAGGER
, "Golden Kris" },

181 { 
WIELD_DAGGER
, "Sai" },

182 { 
WIELD_DAGGER
, "Demon Dagger" },

183 { 
WIELD_DAGGER
, "Flaying Knife" },

184 { 
WIELD_DAGGER
, "Ambusher" },

185 { 
WIELD_DAGGER
, "Stiletto" },

187 { 
WIELD_EXOTIC
, "Sharktooth Claw" },

188 { 
WIELD_EXOTIC
, "Gemini Claw" },

189 { 
WIELD_EXOTIC
, "Sage Wand" },

190 { 
WIELD_EXOTIC
, "Reflex Bow" },

191 { 
WIELD_EXOTIC
, "Sniper Bow" },

192 { 
WIELD_EXOTIC
, "Twin Claw" },

193 { 
WIELD_EXOTIC
, "Crystal Source" },

195 { 
WIELD_BOW
, "Spine Bow" },

196 { 
WIELD_BOW
, "Imperial Bow" },

197 { 
WIELD_BOW
, "Reflex Bow" },

198 { 
WIELD_BOW
, "Sniper Bow" },

201 { 
WIELD_FLAIL
, "Light Flail" },

202 { 
WIELD_FLAIL
, "Heavy Flail" },

203 { 
WIELD_FLAIL
, "Steel Flail" },

204 { 
WIELD_FLAIL
, "Imperial Flail" },

205 { 
WIELD_FLAIL
, "Shadow Flail" },

206 { 
WIELD_FLAIL
, "Gemini Flail" },

207 { 
WIELD_FLAIL
, "War Flail" },

208 { 
WIELD_FLAIL
, "Auric Flail" },

209 { 
WIELD_FLAIL
, "Shadowsteel Flail" },

211 { 
WIELD_MACE
, "War Hammer" },

212 { 
WIELD_MACE
, "Dream Mace" },

213 { 
WIELD_MACE
, "Pernarch" },

214 { 
WIELD_MACE
, "Ancestral Club" },

215 { 
WIELD_MACE
, "Auric Mace" },

216 { 
WIELD_MACE
, "Legion Hammer" },

217 { 
WIELD_MACE
, "Nightmare Mace" },

218 { 
WIELD_MACE
, "Phantom Hammer" },

219 { 
WIELD_MACE
, "Ornate Mace" },

221 { 
WIELD_POLEARM
, "Coiled Staff" },

222 { 
WIELD_POLEARM
, "Long Staff" },

223 { 
WIELD_POLEARM
, "Highborn Staff" },

224 { 
WIELD_POLEARM
, "Lathi" },

225 { 
WIELD_POLEARM
, "Eclipse Staff" },

226 { 
WIELD_POLEARM
, "Maelstrom Staff" },

227 { 
WIELD_POLEARM
, "Imperial Staff" },

228 { 
WIELD_POLEARM
, "Ezomyte Staff" },

229 { 
WIELD_POLEARM
, "Serpentine Staff" },

231 { 
WIELD_SPEAR
, "Wooden Spear" },

232 { 
WIELD_SPEAR
, "Steel Spear" },

233 { 
WIELD_SPEAR
, "Short Spear" },

234 { 
WIELD_SPEAR
, "Long Spear" },

235 { 
WIELD_SPEAR
, "Legion Spear" },

236 { 
WIELD_SPEAR
, "Ezomyte Spear" },

237 { 
WIELD_SPEAR
, "Phantom Spear" },

238 { 
WIELD_SPEAR
, "Imperial Spear" },

239 { 
WIELD_SPEAR
, "Serpentine Spear" },

241 { 
WIELD_SWORD
, "Rusted Sword" },

242 { 
WIELD_SWORD
, "Sabre" },

243 { 
WIELD_SWORD
, "Dusk Blade" },

244 { 
WIELD_SWORD
, "Cutlass" },

245 { 
WIELD_SWORD
, "Baselard" },

246 { 
WIELD_SWORD
, "Hook Sword" },

247 { 
WIELD_SWORD
, "Elder Sword" },

248 { 
WIELD_SWORD
, "Twilight Blade" },

249 { 
WIELD_SWORD
, "Midnight Blade" },

251 { 
WIELD_WHIP
, "Rope Whip" },

252 { 
WIELD_WHIP
, "Steel Whip" },

253 { 
WIELD_WHIP
, "2-Headed Whip" },

254 { 
WIELD_WHIP
, "Whisper Whip" },

255 { 
WIELD_WHIP
, "Imperial Whip" },

256 { 
WIELD_WHIP
, "Shadow Whip" },

257 { 
WIELD_WHIP
, "Greysteel Whip" },

258 { 
WIELD_WHIP
, "Cat o Nine Tail" },

259 { 
WIELD_WHIP
, "Twilight Whip" },

263 cÚ¡ 
	g¡d
::
veùÜ
<
SŒšg
> 
Ëg’d¬y_ba£_poŞ_bË
 = {

277 cÚ¡ 
	g¡d
::
m­
<, std::
veùÜ
<
SŒšg
> > 
Ëg’d¬y_Çme_bË
 = {

278 { 
ARMOR_LIGHT
, {

282 { 
ARMOR_FINGER
, {

286 { 
ARMOR_NECK
, {

290 { 
ARMOR_TORSO
, {

294 { 
ARMOR_HEAD
, {

298 { 
ARMOR_LEGS
, {

302 { 
ARMOR_FEET
, {

306 { 
ARMOR_HANDS
, {

310 { 
ARMOR_ARMS
, {

314 { 
ARMOR_SHIELD
, {

318 { 
ARMOR_BODY
, {

322 { 
ARMOR_WAIST
, {

326 { 
ARMOR_WRIST
, {

330 { 
ARMOR_FLOATING
, {

334 { 
ARMOR_HOLD
, {

338 { 
WIELD_AXE
, {

342 { 
WIELD_DAGGER
, {

346 { 
WIELD_EXOTIC
, {

350 { 
WIELD_FLAIL
, {

354 { 
WIELD_MACE
, {

358 { 
WIELD_POLEARM
, {

362 { 
WIELD_SPEAR
, {

366 { 
WIELD_SWORD
, {

370 { 
WIELD_WHIP
, {

374 { 
WIELD_BOW
, {

380 cÚ¡ 
	g¡d
::
muÉim­
<, 
	gafãù
::
ty³
> 
´efixes_®lowed
 = {

381 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

382 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

383 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

384 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

385 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

386 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

387 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

388 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

389 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

390 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

391 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

392 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

393 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

394 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

395 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

396 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

397 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_´efix_brul
 },

399 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

400 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

401 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

402 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

403 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

404 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

405 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

406 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

407 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

408 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

409 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

410 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

411 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

412 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

413 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

414 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

415 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_´efix_brul
 },

417 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

418 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

419 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

420 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

421 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

422 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

423 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

424 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

425 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

426 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

427 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

428 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

429 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

430 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

431 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

432 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

433 { 
ARMOR_NECK
, 
afãù
::
ty³
::
obj_´efix_brul
 },

435 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

436 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

437 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

438 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

439 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

440 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

441 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

442 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

443 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

444 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

445 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

446 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

447 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

448 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

449 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

450 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

451 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_´efix_brul
 },

453 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

454 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

455 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

456 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

457 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

458 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

459 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

460 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

461 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

462 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

463 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

464 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

465 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

466 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

467 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

468 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

469 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_´efix_brul
 },

471 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

472 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

473 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

474 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

475 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

476 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

477 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

478 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

479 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

480 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

481 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

482 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

483 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

484 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

485 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

486 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

487 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_´efix_brul
 },

489 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

490 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

491 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

492 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

493 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

494 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

495 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

496 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

497 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

498 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

499 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

500 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

501 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

502 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

503 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

504 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

505 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_´efix_brul
 },

507 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

508 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

509 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

510 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

511 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

512 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

513 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

514 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

515 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

516 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

517 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

518 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

519 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

520 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

521 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

522 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

523 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_´efix_brul
 },

525 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

526 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

527 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

528 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

529 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

530 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

531 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

532 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

533 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

534 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

535 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

536 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

537 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

538 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

539 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

540 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

541 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_´efix_brul
 },

543 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

544 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

545 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

546 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

547 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

548 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

549 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

550 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

551 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

552 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

553 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

554 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

555 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

556 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

557 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

558 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

559 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_´efix_brul
 },

561 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

562 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

563 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

564 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

565 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

566 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

567 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

568 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

569 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

570 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

571 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

572 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

573 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

574 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

575 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

576 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

577 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_´efix_brul
 },

579 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

580 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

581 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

582 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

583 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

584 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

585 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

586 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

587 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

588 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

589 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

590 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

591 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

592 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

593 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

594 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

595 { 
ARMOR_WAIST
, 
afãù
::
ty³
::
obj_´efix_brul
 },

597 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

598 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

599 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

600 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

601 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

602 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

603 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

604 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

605 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

606 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

607 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

608 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

609 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

610 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

611 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

612 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

613 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_´efix_brul
 },

615 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

616 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

617 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

618 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

619 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

620 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

621 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

622 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

623 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

624 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

625 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

626 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

627 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

628 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

629 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

630 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

631 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_´efix_brul
 },

633 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

634 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

635 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

636 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

637 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

638 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

639 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

640 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

641 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

642 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

643 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

644 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

645 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

646 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

647 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

648 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

649 { 
ARMOR_HOLD
, 
afãù
::
ty³
::
obj_´efix_brul
 },

651 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

652 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

653 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

654 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

655 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

656 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

657 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

658 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

659 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

660 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

661 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

662 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

663 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

664 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

665 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

666 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

667 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_´efix_brul
 },

668 { 
WIELD_AXE
, 
afãù
::
ty³
::
w—pÚ_acidic
 },

669 { 
WIELD_AXE
, 
afãù
::
ty³
::
w—pÚ_æamšg
 },

670 { 
WIELD_AXE
, 
afãù
::
ty³
::
w—pÚ_äo¡
 },

671 { 
WIELD_AXE
, 
afãù
::
ty³
::
w—pÚ_vampœic
 },

672 { 
WIELD_AXE
, 
afãù
::
ty³
::
w—pÚ_shockšg
 },

673 { 
WIELD_AXE
, 
afãù
::
ty³
::
w—pÚ_vÜ·l
 },

674 { 
WIELD_AXE
, 
afãù
::
ty³
::
w—pÚ_sh¬p
 },

675 { 
WIELD_AXE
, 
afãù
::
ty³
::
poisÚ
 },

677 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

678 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

679 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

680 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

681 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

682 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

683 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

684 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

685 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

686 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

687 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

688 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

689 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

690 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

691 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

692 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

693 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_´efix_brul
 },

694 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
w—pÚ_acidic
 },

695 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
w—pÚ_æamšg
 },

696 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
w—pÚ_äo¡
 },

697 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
w—pÚ_vampœic
 },

698 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
w—pÚ_shockšg
 },

699 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
w—pÚ_vÜ·l
 },

700 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
w—pÚ_sh¬p
 },

701 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
poisÚ
 },

703 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

704 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

705 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

706 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

707 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

708 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

709 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

710 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

711 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

712 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

713 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

714 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

715 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

716 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

717 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

718 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

719 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_´efix_brul
 },

720 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
w—pÚ_acidic
 },

721 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
w—pÚ_æamšg
 },

722 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
w—pÚ_äo¡
 },

723 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
w—pÚ_vampœic
 },

724 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
w—pÚ_shockšg
 },

725 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
w—pÚ_vÜ·l
 },

726 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
w—pÚ_sh¬p
 },

727 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
poisÚ
 },

729 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

730 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

731 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

732 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

733 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

734 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

735 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

736 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

737 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

738 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

739 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

740 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

741 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

742 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

743 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

744 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

745 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_´efix_brul
 },

746 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
w—pÚ_acidic
 },

747 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
w—pÚ_æamšg
 },

748 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
w—pÚ_äo¡
 },

749 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
w—pÚ_vampœic
 },

750 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
w—pÚ_shockšg
 },

751 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
w—pÚ_vÜ·l
 },

752 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
w—pÚ_sh¬p
 },

753 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
poisÚ
 },

755 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

756 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

757 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

758 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

759 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

760 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

761 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

762 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

763 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

764 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

765 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

766 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

767 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

768 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

769 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

770 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

771 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_´efix_brul
 },

772 { 
WIELD_MACE
, 
afãù
::
ty³
::
w—pÚ_acidic
 },

773 { 
WIELD_MACE
, 
afãù
::
ty³
::
w—pÚ_æamšg
 },

774 { 
WIELD_MACE
, 
afãù
::
ty³
::
w—pÚ_äo¡
 },

775 { 
WIELD_MACE
, 
afãù
::
ty³
::
w—pÚ_vampœic
 },

776 { 
WIELD_MACE
, 
afãù
::
ty³
::
w—pÚ_shockšg
 },

777 { 
WIELD_MACE
, 
afãù
::
ty³
::
w—pÚ_vÜ·l
 },

778 { 
WIELD_MACE
, 
afãù
::
ty³
::
w—pÚ_sh¬p
 },

779 { 
WIELD_MACE
, 
afãù
::
ty³
::
poisÚ
 },

781 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

782 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

783 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

784 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

785 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

786 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

787 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

788 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

789 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

790 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

791 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

792 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

793 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

794 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

795 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

796 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

797 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_´efix_brul
 },

798 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
w—pÚ_acidic
 },

799 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
w—pÚ_æamšg
 },

800 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
w—pÚ_äo¡
 },

801 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
w—pÚ_vampœic
 },

802 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
w—pÚ_shockšg
 },

803 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
w—pÚ_vÜ·l
 },

804 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
w—pÚ_sh¬p
 },

805 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
poisÚ
 },

807 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

808 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

809 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

810 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

811 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

812 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

813 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

814 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

815 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

816 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

817 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

818 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

819 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

820 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

821 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

822 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

823 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_´efix_brul
 },

824 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
w—pÚ_acidic
 },

825 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
w—pÚ_æamšg
 },

826 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
w—pÚ_äo¡
 },

827 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
w—pÚ_vampœic
 },

828 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
w—pÚ_shockšg
 },

829 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
w—pÚ_vÜ·l
 },

830 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
w—pÚ_sh¬p
 },

831 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
poisÚ
 },

833 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

834 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

835 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

836 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

837 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

838 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

839 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

840 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

841 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

842 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

843 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

844 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

845 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

846 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

847 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

848 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

849 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_´efix_brul
 },

850 { 
WIELD_SWORD
, 
afãù
::
ty³
::
w—pÚ_acidic
 },

851 { 
WIELD_SWORD
, 
afãù
::
ty³
::
w—pÚ_æamšg
 },

852 { 
WIELD_SWORD
, 
afãù
::
ty³
::
w—pÚ_äo¡
 },

853 { 
WIELD_SWORD
, 
afãù
::
ty³
::
w—pÚ_vampœic
 },

854 { 
WIELD_SWORD
, 
afãù
::
ty³
::
w—pÚ_shockšg
 },

855 { 
WIELD_SWORD
, 
afãù
::
ty³
::
w—pÚ_vÜ·l
 },

856 { 
WIELD_SWORD
, 
afãù
::
ty³
::
w—pÚ_sh¬p
 },

857 { 
WIELD_SWORD
, 
afãù
::
ty³
::
poisÚ
 },

859 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_sŞ¬
 },

860 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_a¡¿l
 },

861 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_luÇr
 },

862 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_wšdy
 },

863 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_h—Éhy
 },

864 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_h—¹y
 },

865 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_¡®w¬t
 },

866 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_my¡iÿl
 },

867 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_magiÿl
 },

868 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_lucky
 },

869 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
 },

870 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_¡urdy
 },

871 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_»šfÜûd
 },

872 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_´eci£
 },

873 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_skËd
 },

874 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_jagged
 },

875 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_´efix_brul
 },

876 { 
WIELD_WHIP
, 
afãù
::
ty³
::
w—pÚ_acidic
 },

877 { 
WIELD_WHIP
, 
afãù
::
ty³
::
w—pÚ_æamšg
 },

878 { 
WIELD_WHIP
, 
afãù
::
ty³
::
w—pÚ_äo¡
 },

879 { 
WIELD_WHIP
, 
afãù
::
ty³
::
w—pÚ_vampœic
 },

880 { 
WIELD_WHIP
, 
afãù
::
ty³
::
w—pÚ_shockšg
 },

881 { 
WIELD_WHIP
, 
afãù
::
ty³
::
w—pÚ_vÜ·l
 },

882 { 
WIELD_WHIP
, 
afãù
::
ty³
::
w—pÚ_sh¬p
 },

883 { 
WIELD_WHIP
, 
afãù
::
ty³
::
poisÚ
 },

890 cÚ¡ 
	g¡d
::
muÉim­
<, 
	gafãù
::
ty³
> 
suffixes_®lowed
 = {

891 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_suffix_skËd
 },

892 { 
ARMOR_LIGHT
, 
afãù
::
ty³
::
obj_suffix_sklful
 },

895 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_suffix_deva¡©iÚ
 },

896 { 
ARMOR_FINGER
, 
afãù
::
ty³
::
obj_suffix_ªnih©iÚ
 },

899 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_suffix_š™Ÿ‹_que¡Ü
 },

900 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_suffix_advªûd_que¡Ü
 },

901 { 
ARMOR_TORSO
, 
afãù
::
ty³
::
obj_suffix_ma¡”_que¡Ü
 },

903 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_suffix_š™Ÿ‹_mage
 },

904 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_suffix_advªûd_mage
 },

905 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_suffix_ma¡”_mage
 },

906 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_suffix_ex³r›nûd
 },

907 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_suffix_¬ÿÃ_pow”
 },

908 { 
ARMOR_HEAD
, 
afãù
::
ty³
::
obj_suffix_my¡iÿl_pow”
 },

911 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_suffix_š™Ÿ‹_mage
 },

912 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_suffix_advªûd_mage
 },

913 { 
ARMOR_LEGS
, 
afãù
::
ty³
::
obj_suffix_ma¡”_mage
 },

915 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_suffix_š™Ÿ‹_que¡Ü
 },

916 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_suffix_advªûd_que¡Ü
 },

917 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_suffix_ma¡”_que¡Ü
 },

918 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_suffix_sw®low
 },

919 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_suffix_hawk
 },

920 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_suffix_çlcÚ
 },

921 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_suffix_skËd
 },

922 { 
ARMOR_FEET
, 
afãù
::
ty³
::
obj_suffix_sklful
 },

924 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_suffix_š™Ÿ‹_que¡Ü
 },

925 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_suffix_advªûd_que¡Ü
 },

926 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_suffix_ma¡”_que¡Ü
 },

927 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_suffix_š™Ÿ‹_mage
 },

928 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_suffix_advªûd_mage
 },

929 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_suffix_ma¡”_mage
 },

930 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_suffix_sw®low
 },

931 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_suffix_hawk
 },

932 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_suffix_çlcÚ
 },

933 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_suffix_ex³r›nûd
 },

934 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_suffix_deva¡©iÚ
 },

935 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_suffix_ªnih©iÚ
 },

936 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_suffix_¬ÿÃ_pow”
 },

937 { 
ARMOR_HANDS
, 
afãù
::
ty³
::
obj_suffix_my¡iÿl_pow”
 },

939 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_suffix_š™Ÿ‹_que¡Ü
 },

940 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_suffix_advªûd_que¡Ü
 },

941 { 
ARMOR_ARMS
, 
afãù
::
ty³
::
obj_suffix_ma¡”_que¡Ü
 },

944 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_suffix_»¡Ü©ive
 },

945 { 
ARMOR_SHIELD
, 
afãù
::
ty³
::
obj_suffix_my¡ic
 },

947 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_suffix_š™Ÿ‹_que¡Ü
 },

948 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_suffix_advªûd_que¡Ü
 },

949 { 
ARMOR_BODY
, 
afãù
::
ty³
::
obj_suffix_ma¡”_que¡Ü
 },

954 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_suffix_¬ÿÃ_pow”
 },

955 { 
ARMOR_WRIST
, 
afãù
::
ty³
::
obj_suffix_my¡iÿl_pow”
 },

957 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_suffix_skËd
 },

958 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_suffix_sklful
 },

959 { 
ARMOR_FLOATING
, 
afãù
::
ty³
::
obj_suffix_ex³r›nûd
 },

963 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_suffix_deva¡©iÚ
 },

964 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_suffix_ªnih©iÚ
 },

965 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_suffix_¬ÿÃ_pow”
 },

966 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_suffix_my¡iÿl_pow”
 },

967 { 
WIELD_AXE
, 
afãù
::
ty³
::
obj_suffix_hexxšg
 },

969 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_suffix_deva¡©iÚ
 },

970 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_suffix_ªnih©iÚ
 },

971 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_suffix_¬ÿÃ_pow”
 },

972 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_suffix_my¡iÿl_pow”
 },

973 { 
WIELD_DAGGER
, 
afãù
::
ty³
::
obj_suffix_hexxšg
 },

975 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_suffix_deva¡©iÚ
 },

976 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_suffix_ªnih©iÚ
 },

977 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_suffix_¬ÿÃ_pow”
 },

978 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_suffix_my¡iÿl_pow”
 },

979 { 
WIELD_EXOTIC
, 
afãù
::
ty³
::
obj_suffix_hexxšg
 },

981 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_suffix_deva¡©iÚ
 },

982 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_suffix_ªnih©iÚ
 },

983 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_suffix_¬ÿÃ_pow”
 },

984 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_suffix_my¡iÿl_pow”
 },

985 { 
WIELD_FLAIL
, 
afãù
::
ty³
::
obj_suffix_hexxšg
 },

987 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_suffix_deva¡©iÚ
 },

988 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_suffix_ªnih©iÚ
 },

989 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_suffix_¬ÿÃ_pow”
 },

990 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_suffix_my¡iÿl_pow”
 },

991 { 
WIELD_MACE
, 
afãù
::
ty³
::
obj_suffix_hexxšg
 },

993 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_suffix_deva¡©iÚ
 },

994 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_suffix_ªnih©iÚ
 },

995 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_suffix_¬ÿÃ_pow”
 },

996 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_suffix_my¡iÿl_pow”
 },

997 { 
WIELD_POLEARM
, 
afãù
::
ty³
::
obj_suffix_hexxšg
 },

999 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_suffix_deva¡©iÚ
 },

1000 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_suffix_ªnih©iÚ
 },

1001 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_suffix_¬ÿÃ_pow”
 },

1002 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_suffix_my¡iÿl_pow”
 },

1003 { 
WIELD_SPEAR
, 
afãù
::
ty³
::
obj_suffix_hexxšg
 },

1005 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_suffix_deva¡©iÚ
 },

1006 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_suffix_ªnih©iÚ
 },

1007 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_suffix_¬ÿÃ_pow”
 },

1008 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_suffix_my¡iÿl_pow”
 },

1009 { 
WIELD_SWORD
, 
afãù
::
ty³
::
obj_suffix_hexxšg
 },

1011 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_suffix_deva¡©iÚ
 },

1012 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_suffix_ªnih©iÚ
 },

1013 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_suffix_¬ÿÃ_pow”
 },

1014 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_suffix_my¡iÿl_pow”
 },

1015 { 
WIELD_WHIP
, 
afãù
::
ty³
::
obj_suffix_hexxšg
 },

1021 cÚ¡ 
	g¡d
::
m­
<
afãù
::
ty³
, 
	gmod_t
> 
	gmod_bË
 = {

1028 { 
afãù
::
ty³
::
obj_´efix_sŞ¬
, {

1030 
TO_OBJECT
, 
APPLY_STR
, 1, 5, 
Œue


1032 { 
afãù
::
ty³
::
obj_´efix_a¡¿l
, {

1034 
TO_OBJECT
, 
APPLY_INT
, 1, 5, 
Œue


1036 { 
afãù
::
ty³
::
obj_´efix_luÇr
, {

1038 
TO_OBJECT
, 
APPLY_WIS
, 1, 5, 
Œue


1040 { 
afãù
::
ty³
::
obj_´efix_wšdy
, {

1042 
TO_OBJECT
, 
APPLY_DEX
, 1, 5, 
Œue


1044 { 
afãù
::
ty³
::
obj_´efix_h—Éhy
, {

1046 
TO_OBJECT
, 
APPLY_CON
, 1, 5, 
Œue


1051 { 
afãù
::
ty³
::
obj_´efix_h—¹y
, {

1053 
TO_OBJECT
, 
APPLY_HIT
, 10, 40, 
Œue


1055 { 
afãù
::
ty³
::
obj_´efix_¡®w¬t
, {

1057 
TO_OBJECT
, 
APPLY_HIT
, 41, 75, 
Œue


1059 { 
afãù
::
ty³
::
obj_´efix_my¡iÿl
, {

1061 
TO_OBJECT
, 
APPLY_MANA
, 10, 40, 
Œue


1063 { 
afãù
::
ty³
::
obj_´efix_magiÿl
, {

1065 
TO_OBJECT
, 
APPLY_MANA
, 41, 75, 
Œue


1067 { 
afãù
::
ty³
::
obj_´efix_lucky
, {

1069 
TO_OBJECT
, 
APPLY_SAVES
, -1, -2, 
çl£


1071 { 
afãù
::
ty³
::
obj_´efix_fÜtu™ous
, {

1073 
TO_OBJECT
, 
APPLY_SAVES
, -3, -4, 
çl£


1075 { 
afãù
::
ty³
::
obj_´efix_¡urdy
, {

1077 
TO_OBJECT
, 
APPLY_AC
, -1, -5, 
Œue


1079 { 
afãù
::
ty³
::
obj_´efix_»šfÜûd
, {

1081 
TO_OBJECT
, 
APPLY_AC
, -6, -10, 
Œue


1086 { 
afãù
::
ty³
::
obj_´efix_´eci£
, {

1088 
TO_OBJECT
, 
APPLY_HITROLL
, 1, 3, 
Œue


1090 { 
afãù
::
ty³
::
obj_´efix_skËd
, {

1092 
TO_OBJECT
, 
APPLY_HITROLL
, 4, 6, 
Œue


1094 { 
afãù
::
ty³
::
obj_´efix_jagged
, {

1096 
TO_OBJECT
, 
APPLY_DAMROLL
, 1, 3, 
Œue


1098 { 
afãù
::
ty³
::
obj_´efix_brul
, {

1100 
TO_OBJECT
, 
APPLY_DAMROLL
, 4, 6, 
Œue


1105 { 
afãù
::
ty³
::
§nùu¬y
, {

1107 
TO_AFFECTS
, 0, 0, 0, 
çl£


1109 { 
afãù
::
ty³
::
¢—k
, {

1111 
TO_AFFECTS
, 0, 0, 0, 
çl£


1113 { 
afãù
::
ty³
::
´ÙeùiÚ_ev
, {

1115 
TO_AFFECTS
, 0, 0, 0, 
çl£


1117 { 
afãù
::
ty³
::
´ÙeùiÚ_good
, {

1119 
TO_AFFECTS
, 0, 0, 0, 
çl£


1121 { 
afãù
::
ty³
::
æamesh›ld
, {

1123 
TO_AFFECTS
, 0, 0, 0, 
çl£


1125 { 
afãù
::
ty³
::
·ss_doÜ
, {

1127 
TO_AFFECTS
, 0, 0, 0, 
çl£


1129 { 
afãù
::
ty³
::
»g’”©iÚ
, {

1131 
TO_AFFECTS
, 0, 0, 0, 
çl£


1133 { 
afãù
::
ty³
::
ha¡e
, {

1135 
TO_AFFECTS
, 0, 0, 0, 
çl£


1139 { 
afãù
::
ty³
::
w—pÚ_acidic
, {

1141 
TO_WEAPON
, 0, 0, 0, 
çl£


1143 { 
afãù
::
ty³
::
w—pÚ_æamšg
, {

1145 
TO_WEAPON
, 0, 0, 0, 
çl£


1147 { 
afãù
::
ty³
::
w—pÚ_äo¡
, {

1149 
TO_WEAPON
, 0, 0, 0, 
çl£


1151 { 
afãù
::
ty³
::
w—pÚ_vampœic
, {

1153 
TO_WEAPON
, 0, 0, 0, 
çl£


1155 { 
afãù
::
ty³
::
w—pÚ_shockšg
, {

1157 
TO_WEAPON
, 0, 0, 0, 
çl£


1159 { 
afãù
::
ty³
::
w—pÚ_vÜ·l
, {

1161 
TO_WEAPON
, 0, 0, 0, 
çl£


1163 { 
afãù
::
ty³
::
w—pÚ_sh¬p
, {

1165 
TO_WEAPON
, 0, 0, 0, 
çl£


1167 { 
afãù
::
ty³
::
poisÚ
, {

1169 
TO_WEAPON
, 0, 0, 0, 
çl£


1174 { 
afãù
::
ty³
::
obj_suffix_š™Ÿ‹_que¡Ü
, {

1176 
TO_OBJECT
, 
APPLY_QUESTPOINTS
, 1, 1, 
çl£


1178 { 
afãù
::
ty³
::
obj_suffix_advªûd_que¡Ü
, {

1180 
TO_OBJECT
, 
APPLY_QUESTPOINTS
, 2, 2, 
çl£


1182 { 
afãù
::
ty³
::
obj_suffix_ma¡”_que¡Ü
, {

1184 
TO_OBJECT
, 
APPLY_QUESTPOINTS
, 3, 3, 
çl£


1186 { 
afãù
::
ty³
::
obj_suffix_skËd
, {

1188 
TO_OBJECT
, 
APPLY_SKILLPOINTS
, 1, 1, 
çl£


1190 { 
afãù
::
ty³
::
obj_suffix_sklful
, {

1192 
TO_OBJECT
, 
APPLY_SKILLPOINTS
, 2, 2, 
çl£


1194 { 
afãù
::
ty³
::
obj_suffix_ex³r›nûd
, {

1196 
TO_OBJECT
, 
APPLY_EXP_PCT
, 1, 3, 
çl£


1198 { 
afãù
::
ty³
::
obj_suffix_š™Ÿ‹_mage
, {

1200 
TO_OBJECT
, 
APPLY_MANA_COST_PCT
, 1, 3, 
çl£


1202 { 
afãù
::
ty³
::
obj_suffix_advªûd_mage
, {

1204 
TO_OBJECT
, 
APPLY_MANA_COST_PCT
, 3, 6, 
çl£


1206 { 
afãù
::
ty³
::
obj_suffix_ma¡”_mage
, {

1208 
TO_OBJECT
, 
APPLY_MANA_COST_PCT
, 6, 10, 
çl£


1210 { 
afãù
::
ty³
::
obj_suffix_sw®low
, {

1212 
TO_OBJECT
, 
APPLY_STAM_COST_PCT
, 1, 3, 
çl£


1214 { 
afãù
::
ty³
::
obj_suffix_hawk
, {

1216 
TO_OBJECT
, 
APPLY_STAM_COST_PCT
, 3, 6, 
çl£


1218 { 
afãù
::
ty³
::
obj_suffix_çlcÚ
, {

1220 
TO_OBJECT
, 
APPLY_STAM_COST_PCT
, 6, 10, 
çl£


1222 { 
afãù
::
ty³
::
obj_suffix_deva¡©iÚ
, {

1224 
TO_OBJECT
, 
APPLY_WPN_DAMAGE_PCT
, 1, 5, 
çl£


1226 { 
afãù
::
ty³
::
obj_suffix_ªnih©iÚ
, {

1228 
TO_OBJECT
, 
APPLY_WPN_DAMAGE_PCT
, 6,10, 
çl£


1230 { 
afãù
::
ty³
::
obj_suffix_¬ÿÃ_pow”
, {

1232 
TO_OBJECT
, 
APPLY_SPELL_DAMAGE_PCT
, 1, 5, 
çl£


1234 { 
afãù
::
ty³
::
obj_suffix_my¡iÿl_pow”
, {

1236 
TO_OBJECT
, 
APPLY_SPELL_DAMAGE_PCT
, 6,10, 
çl£


1238 { 
afãù
::
ty³
::
obj_suffix_hexxšg
, {

1240 
TO_OBJECT
, 
APPLY_VAMP_BONUS_PCT
, 1,10, 
çl£


1242 { 
afãù
::
ty³
::
obj_suffix_»¡Ü©ive
, {

1244 
TO_OBJECT
, 
APPLY_HP_BLOCK_PCT
, 1,5, 
çl£


1246 { 
afãù
::
ty³
::
obj_suffix_my¡ic
, {

1248 
TO_OBJECT
, 
APPLY_MANA_BLOCK_PCT
, 1,5, 
çl£


1259 cÚ¡ 
	g¡d
::
veùÜ
<
£t_g—r
> 
£t_bË
 = {

1272 
SET_MAGE_INVOKER
,

1281 
SET_WARRIOR_BESERKER
,

1290 
SET_CLERIC_DIVINE
,

1299 
SET_THIEF_CUTPURSE
,

1308 
SET_PALADIN_GRACE
,

	@src/lootv2.cc

28 
	~<veùÜ
>

29 
	~<m­
>

31 
	~"afãù/Afãù.hh
"

32 
	~"Game.hh
"

33 
	~"A»a.hh
"

34 
	~"WÜld.hh
"

35 
	~"Loggšg.hh
"

36 
	~"loÙv2.hh
"

37 
	~"Objeù.hh
"

38 
	~"¿ndom.hh
"

39 
	~"WÜld.hh
"

40 
	~"m”c.hh
"

41 
	~"ObjeùPrÙÙy³.hh
"

43 
Objeù
 *
g’”©e_¬mÜ
(
ev–
, 
objËv–
, 
™em_qu®
, & 
eq_ty³
);

44 
Objeù
 *
g’”©e_w—pÚ
(
ev–
, 
objËv–
, 
™em_qu®
, & 
eq_ty³
);

45 
¿ndom_´ÙÙy³
(
SŒšg
 
key
);

46 
add_ba£_¡©s
(
Objeù
 *
obj
, 
ev–
, 
™em_qu®
);

47 cÚ¡ 
SŒšg
 
rŞl_mod
(
Objeù
 *
obj
, 
eq_ty³
, cÚ¡ 
¡d
::
muÉim­
<, 
afãù
::
ty³
>& 
mods_®lowed
);

48 cÚ¡ 
SŒšg
 
g‘_ba£_Çme
(
eq_ty³
, 
ev–
);

49 cÚ¡ 
SŒšg
 
g‘_Ëg’d¬y_Çme
(
eq_ty³
);

51 
	#EQ_QUALITY_SET
 0

	)

52 
	#EQ_QUALITY_UNIQUE
 1

	)

53 
	#EQ_QUALITY_LEGENDARY
 2

	)

54 
	#EQ_QUALITY_RARE
 3

	)

55 
	#EQ_QUALITY_UNCOMMON
 4

	)

56 
	#EQ_QUALITY_NORMAL
 5

	)

58 
	seq_qu®™y_t
 {

59 
	mchªû
;

60 
SŒšg
 
	m¡r
;

61 
	mmax_´efixes
;

62 
	mmax_suffixes
;

67 cÚ¡ 
	g¡d
::
veùÜ
<
eq_qu®™y_t
> 
eq_qu®™y_bË
 {

76 
	seq_rŞl_t
 {

77 
	mty³
;

78 
	mvnum
;

81 cÚ¡ 
	g¡d
::
veùÜ
<
eq_rŞl_t
> 
¬mÜ_eq_rŞls
 {

82 { 
ARMOR_NECK
, 
	gOBJ_VNUM_NECK
 },

83 { 
	gARMOR_TORSO
, 
	gOBJ_VNUM_TORSO
 },

84 { 
	gARMOR_HEAD
, 
	gOBJ_VNUM_HEAD
 },

85 { 
	gARMOR_LEGS
, 
	gOBJ_VNUM_LEGS
 },

86 { 
	gARMOR_FEET
, 
	gOBJ_VNUM_FEET
 },

87 { 
	gARMOR_HANDS
, 
	gOBJ_VNUM_HANDS
 },

88 { 
	gARMOR_ARMS
, 
	gOBJ_VNUM_ARMS
 },

89 { 
	gARMOR_SHIELD
, 
	gOBJ_VNUM_SHIELD
 },

90 { 
	gARMOR_BODY
, 
	gOBJ_VNUM_BODY
 },

91 { 
	gARMOR_WAIST
, 
	gOBJ_VNUM_WAIST
 },

92 { 
	gARMOR_WRIST
, 
	gOBJ_VNUM_WRIST
 },

95 cÚ¡ 
	g¡d
::
veùÜ
<
eq_rŞl_t
> 
acûssÜy_eq_rŞls
 {

96 { 
ARMOR_LIGHT
, 
	gOBJ_VNUM_LIGHT
 },

97 { 
	gARMOR_FINGER
, 
	gOBJ_VNUM_FINGER
 },

98 { 
	gARMOR_FLOATING
, 
	gOBJ_VNUM_FLOATING
 },

99 { 
	gARMOR_HOLD
, 
	gOBJ_VNUM_HOLD
 },

102 cÚ¡ 
	g¡d
::
veùÜ
<
eq_rŞl_t
> 
w—pÚ_eq_rŞls
 {

103 { 
WIELD_AXE
, 
	gOBJ_VNUM_WIELD_AXE
 },

104 { 
	gWIELD_BOW
, 
	gOBJ_VNUM_WIELD_BOW
 },

105 { 
	gWIELD_DAGGER
, 
	gOBJ_VNUM_WIELD_DAGGER
 },

106 { 
	gWIELD_EXOTIC
, 
	gOBJ_VNUM_WIELD_EXOTIC
 },

107 { 
	gWIELD_FLAIL
, 
	gOBJ_VNUM_WIELD_FLAIL
 },

108 { 
	gWIELD_MACE
, 
	gOBJ_VNUM_WIELD_MACE
 },

109 { 
	gWIELD_POLEARM
, 
	gOBJ_VNUM_WIELD_POLEARM
 },

110 { 
	gWIELD_SPEAR
, 
	gOBJ_VNUM_WIELD_SPEAR
 },

111 { 
	gWIELD_SWORD
, 
	gOBJ_VNUM_WIELD_SWORD
 },

112 { 
	gWIELD_WHIP
, 
	gOBJ_VNUM_WIELD_WHIP
 },

115 
	seq_m‘a_t
 {

116 
	mchªû
;

117 cÚ¡ 
	m¡d
::
veùÜ
<
eq_rŞl_t
>& 
eq_rŞls
;

122 cÚ¡ 
	g¡d
::
veùÜ
<
eq_m‘a_t
> 
eq_m‘a_bË
 {

123 { 15, 
	gacûssÜy_eq_rŞls
 },

124 { 35, 
	gw—pÚ_eq_rŞls
 },

125 { 100, 
	g¬mÜ_eq_rŞls
 },

128 
Objeù
 *
	$g’”©e_eq
(
objËv–
){

141 
ev–
 = (
objËv–
-10) / 10;

142 
ev–
 = 
	`URANGE
(0, ilevel, 8);

144 
m‘a_šdex
, 
™em_qu®
;

149 
m‘a_šdex
 = 0;

150 
m‘a_šdex
 < 
eq_m‘a_bË
.
	`size
()-1;

151 
m‘a_šdex
++)

152 ià(
	`rŞl_chªû
(
eq_m‘a_bË
[
m‘a_šdex
].
chªû
))

156 
rŞl
 = 
	`numb”_¿nge
(0, 
eq_m‘a_bË
[
m‘a_šdex
].
eq_rŞls
.
	`size
()-1);

157 
eq_ty³
 = 
eq_m‘a_bË
[
m‘a_šdex
].
eq_rŞls
[
rŞl
].
ty³
;

158 
vnum
 = 
eq_m‘a_bË
[
m‘a_šdex
].
eq_rŞls
[
rŞl
].vnum;

167 
™em_qu®
 = 0;

168 
™em_qu®
 < 
eq_qu®™y_bË
.
	`size
()-1;

169 
™em_qu®
++)

170 ià(
	`rŞl_chªû
(
eq_qu®™y_bË
[
™em_qu®
].
chªû
))

175 ià(
™em_qu®
 =ğ
EQ_QUALITY_UNIQUE
){

176 
vnum
 = 
	`¿ndom_´ÙÙy³
("uniquegen");

177 ià(
vnum
 == 0){

178 
Loggšg
::
	`bug
("g’”©e_eq:„ªdom_´ÙÙy³ faedØ·s vnum %d", 
vnum
);

179  
nuÎ±r
;

183 ià(
™em_qu®
 =ğ
EQ_QUALITY_SET
){

184 
vnum
 = 
	`¿ndom_´ÙÙy³
("setgen");

185 ià(
vnum
 == 0){

186 
Loggšg
::
	`bug
("g’”©e_eq:„ªdom_´ÙÙy³ faedØ·s vnum %d", 
vnum
);

187  
nuÎ±r
;

191 
Objeù
 *
obj
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
vnum
), 
objËv–
);

193 ià(
obj
 =ğ
nuÎ±r
) {

194 
Loggšg
::
	`bug
("E¼Ü makšg obj w™h vnum %d iÀg’”©e_eq.", 
vnum
);

195  
nuÎ±r
;

199 ià(
obj
->
Ëv–
 <= 91)

200 
obj
->
Ëv–
 = 
objËv–
;

204 ià((
™em_qu®
 !ğ
EQ_QUALITY_UNIQUE
è&& (™em_qu® !ğ
EQ_QUALITY_SET
)){

205 ià(
™em_qu®
 =ğ
EQ_QUALITY_LEGENDARY
)

206 
obj
->
Çme
 = 
	`g‘_Ëg’d¬y_Çme
(
eq_ty³
);

208 
obj
->
Çme
 = 
	`g‘_ba£_Çme
(
eq_ty³
, 
ev–
);

214 ià(
obj
->
Ëv–
 <= 91)

215 
	`add_ba£_¡©s
(
obj
, 
ev–
, 
™em_qu®
);

219 
i
 = 0; i < 
eq_qu®™y_bË
[
™em_qu®
].
max_´efixes
; i++) {

220 
SŒšg
 
¡r
 = 
	`rŞl_mod
(
obj
, 
eq_ty³
, 
´efixes_®lowed
);

222 ià(
™em_qu®
 !ğ
EQ_QUALITY_LEGENDARY
 && !
¡r
.
	`em±y
())

223 
obj
->
Çme
 = 
¡r
 + "{x " + obj->name;

228 
i
 = 0; i < 
eq_qu®™y_bË
[
™em_qu®
].
max_suffixes
; i++) {

229 
SŒšg
 
¡r
 = 
	`rŞl_mod
(
obj
, 
eq_ty³
, 
suffixes_®lowed
);

231 ià(
™em_qu®
 !ğ
EQ_QUALITY_LEGENDARY
 && !
¡r
.
	`em±y
())

232 
obj
->
Çme
 +ğ" " + 
¡r
 + "{x";

237 ià((
™em_qu®
 !ğ
EQ_QUALITY_UNIQUE
è&& (™em_qu® !ğ
EQ_QUALITY_SET
))

238 
obj
->
Çme
 = 
eq_qu®™y_bË
[
™em_qu®
].
¡r
 + obj->name;

241 ià((
™em_qu®
 !ğ
EQ_QUALITY_UNIQUE
è&& (™em_qu® !ğ
EQ_QUALITY_SET
)){

242 
obj
->
desütiÚ
 = obj->
Çme
;

243 
obj
->
shÜt_desü
 = obj->
Çme
;

246 ià(
™em_qu®
 =ğ
EQ_QUALITY_UNIQUE
)

247 
obj
->
Çme
 = obj->Çme.
	`»¶aû
("uniqueg’", "").
	`¡r
();

248 ià(
™em_qu®
 =ğ
EQ_QUALITY_SET
)

249 
obj
->
Çme
 = obj->Çme.
	`»¶aû
("£tg’", "").
	`¡r
();

251 
obj
->
Çme
 = obj->Çme.
	`uncŞÜ
().
	`»¶aû
("(", "").replace(")", "");

252  
obj
;

253 
	}
}

255 cÚ¡ 
SŒšg
 
	$g‘_ba£_Çme
(
eq_ty³
, 
ev–
) {

258 
couÁ
 = 
ba£_Çme_bË
.
	`couÁ
(
eq_ty³
);

260 ià(
couÁ
 == 0) {

261 
Loggšg
::
	`bug
("nØba£‚ame fÜy³ %d", 
eq_ty³
);

266 
couÁ
 = 
	`URANGE
(0, 
ev–
, count - 1);

269 autØ
ba£_Çmes
 = 
ba£_Çme_bË
.
	`equ®_¿nge
(
eq_ty³
);

272 autØ
™
 = 
ba£_Çmes
.
fœ¡
;

273 
i
 = 0; i < 
couÁ
; i++)

274 ++
™
;

277  
™
->
£cÚd
;

278 
	}
}

280 cÚ¡ 
SŒšg
 
	$g‘_Ëg’d¬y_Çme
(
eq_ty³
) {

281 autØ
Ëg’d¬y_Çmes
 = 
Ëg’d¬y_Çme_bË
.
	`fšd
(
eq_ty³
)->
£cÚd
;

283 
SŒšg
 
»t
 = 
Ëg’d¬y_ba£_poŞ_bË
[
	`numb”_¿nge
(0,†eg’d¬y_ba£_poŞ_bË.
	`size
()-1)];

284 
»t
 += " ";

285 
»t
 +ğ
Ëg’d¬y_Çmes
[
	`numb”_¿nge
(0,†eg’d¬y_Çmes.
	`size
()-1)];

286 
»t
 += "{x";

287  
»t
;

288 
	}
}

290 cÚ¡ 
SŒšg
 
rŞl_mod
(
Objeù
 *
obj
, 
eq_ty³
, cÚ¡ 
¡d
::
muÉim­
<, 
afãù
::
ty³
>& 
mods_®lowed
) {

293 
couÁ
 = 
mods_®lowed
.couÁ(
eq_ty³
);

295 ià(
	gcouÁ
 == 0) {

300 autØ
	gmods
 = 
mods_®lowed
.
equ®_¿nge
(
eq_ty³
);

301 
	gafãù
::
ty³
 
mod_ty³
;

303 
	gŒue
) {

304 autØ
	g™
 = 
mods
.
fœ¡
;

305 
	gšdex
 = 
numb”_¿nge
(0, 
couÁ
 - 1);

308 
	gi
 = 0; i < 
	gšdex
; i++)

309 ++
	g™
;

312 
	gmod_ty³
 = 
™
->
£cÚd
;

314 autØ
	gmod
 = 
mod_bË
.
fšd
(
mod_ty³
);

317 ià(
	gmod
 =ğ
mod_bË
.
ûnd
())

320 ià(
rŞl_chªû
(
mod
->
£cÚd
.
¿r™y
))

324 autØ
	gmod
 = 
mod_bË
.
fšd
(
mod_ty³
)->
£cÚd
;

326 
	gafãù
::
Afãù
 
af
;

327 
	gaf
.
	gwh”e
 = 
mod
.
af_wh”e
;

328 
	gaf
.
	gty³
 = 
mod_ty³
;

329 
	gaf
.
	gloÿtiÚ
 = 
mod
.
af_loc
;

330 
	gaf
.
	gmodif›r
 = 
numb”_¿nge
(
mod
.
af_mod_mš
, mod.
af_mod_max
);

332 ià(
	gmod
.
	gsÿlšg
) {

333 
	gsÿÏr
 = 
obj
->
Ëv–
 / 75.0;

334 ià(
	gaf
.
	gmodif›r
 > 0)

335 
	gaf
.
	gmodif›r
 = 
URANGE
(1, 
af
.
modif›r
 * 
sÿÏr
, 
mod
.
af_mod_max
);

336 ià(
	gaf
.
	gmodif›r
 < 0)

337 
	gaf
.
	gmodif›r
 = 
URANGE
(
mod
.
af_mod_max
, 
af
.
modif›r
 * 
sÿÏr
, -1);

340 
	gaf
.
	gdu¿tiÚ
 = -1;

341 
	gaf
.
	gevŞutiÚ
 = 1;

342 
	gaf
.
	gËv–
 = 
obj
->
Ëv–
;

343 
	gaf
.
b™veùÜ
(0);

346 ià(
	gafãù
::
exi¡s_Ú_obj
(
obj
, 
af
.
ty³
)) {

347 
	gafãù
::
još_to_obj
(
obj
, &
af
);

351 
	gafãù
::
cİy_to_obj
(
obj
, &
af
);

352  
	gmod
.
	g‹xt
;

355 
	$¿ndom_´ÙÙy³
(
SŒšg
 
key
)

357 
pick
 = 0;

361 
·ss
 = 1;…ass <= 2;…ass++) {

363 
couÁ
 = 0;

366 cÚ¡‡uto& 
¬—_·œ
 : 
Game
::
	`wÜld
().
¬—s
){

369 cÚ¡‡uto& 
´Ùo_·œ
 : 
¬—_·œ
.
£cÚd
->
obj_´ÙÙy³s
){

371 
ObjeùPrÙÙy³
 *
´Ùo
 = 
´Ùo_·œ
.
£cÚd
;

373 ià(!
´Ùo
->
Çme
.
	`has_wÜds
(
key
))

376 ià(
·ss
 =ğ2 && 
couÁ
 =ğ
pick
)

377  
´Ùo
->
vnum
.
	`v®ue
();

379 
couÁ
++;

383 ià(
couÁ
 == 0)

387 
pick
 = 
	`numb”_¿nge
(0, 
couÁ
-1);

391 
	}
}

393 
	$add_ba£_¡©s
(
Objeù
 *
obj
, 
ev–
, 
™em_qu®
) {

395 ià(
obj
->
™em_ty³
 =ğ
ITEM_ARMOR
){

396 
ac_mš
, 
ac_max
;

397 
ev–
) {

398 0: 
ac_mš
 = 1; 
ac_max
 = 5; ;

399 1: 
ac_mš
 = 5; 
ac_max
 = 9; ;

400 2: 
ac_mš
 = 8; 
ac_max
 = 13; ;

401 3: 
ac_mš
 = 11; 
ac_max
 = 17; ;

402 4: 
ac_mš
 = 13; 
ac_max
 = 22; ;

403 5: 
ac_mš
 = 16; 
ac_max
 = 26; ;

404 6: 
ac_mš
 = 19; 
ac_max
 = 30; ;

405 7: 
ac_mš
 = 24; 
ac_max
 = 35; ;

406 : 
ac_mš
 = 28; 
ac_max
 = 40; ;

412 
™em_qu®
) {

413 
EQ_QUALITY_SET
 :

414 
ac_mš
 += (ac_min * 15 / 100);

415 
ac_max
 += (ac_max * 15 / 100);

418 
EQ_QUALITY_UNIQUE
 :

419 
ac_mš
 += (ac_min * 10 / 100);

420 
ac_max
 += (ac_max * 10 / 100);

428 
obj
->
v®ue
[0] = 
	`numb”_¿nge
(
ac_mš
, 
ac_max
);

429 
obj
->
v®ue
[1] = 
	`numb”_¿nge
(
ac_mš
, 
ac_max
);

430 
obj
->
v®ue
[2] = 
	`numb”_¿nge
(
ac_mš
, 
ac_max
);

431 
obj
->
v®ue
[3] = 
	`numb”_¿nge
(
ac_mš
, 
ac_max
);

433 ià(
obj
->
™em_ty³
 =ğ
ITEM_WEAPON
) {

434 
™em_qu®
) {

435 
EQ_QUALITY_SET
 :

438 
obj
->
v®ue
[1] = obj->
Ëv–
 / 10 + 
	`numb”_¿nge
(5,6);

439 
obj
->
v®ue
[2] = obj->
Ëv–
 / 10 + 
	`numb”_¿nge
(5,6);

442 
EQ_QUALITY_UNIQUE
 :

445 
obj
->
v®ue
[1] = obj->
Ëv–
 / 10 + 
	`numb”_¿nge
(4,6);

446 
obj
->
v®ue
[2] = obj->
Ëv–
 / 10 + 
	`numb”_¿nge
(4,6);

449 
EQ_QUALITY_LEGENDARY
 :

452 
obj
->
v®ue
[1] = obj->
Ëv–
 / 10 + 
	`numb”_¿nge
(3,5);

453 
obj
->
v®ue
[2] = obj->
Ëv–
 / 10 + 
	`numb”_¿nge
(3,5);

456 
EQ_QUALITY_RARE
 :

459 
obj
->
v®ue
[1] = obj->
Ëv–
 / 10 + 
	`numb”_¿nge
(2,4);

460 
obj
->
v®ue
[2] = obj->
Ëv–
 / 10 + 
	`numb”_¿nge
(2,4);

463 
EQ_QUALITY_UNCOMMON
 :

466 
obj
->
v®ue
[1] = obj->
Ëv–
 / 10 + 
	`numb”_¿nge
(1,3);

467 
obj
->
v®ue
[2] = obj->
Ëv–
 / 10 + 
	`numb”_¿nge
(1,3);

472 
obj
->
v®ue
[1] = obj->
Ëv–
 / 10 + 
	`numb”_¿nge
(0,2);

473 
obj
->
v®ue
[2] = obj->
Ëv–
 / 10 + 
	`numb”_¿nge
(0,2);

479 
afãù
::
Afãù
 
af
;

480 
af
.
wh”e
 = 
TO_OBJECT
;

481 
af
.
ty³
 = 
afãù
::ty³::
nÚe
;

482 
af
.
Ëv–
 = 
obj
->level;

483 
af
.
du¿tiÚ
 = -1;

484 
af
.
	`b™veùÜ
(0);

485 
af
.
evŞutiÚ
 = 1;

487 
	s¡©_t
 {

488 
hp_mš
, 
hp_max
;

489 
mªa_mš
, 
mªa_max
;

490 
¡am_mš
, 
¡am_max
;

491 
h™rŞl_mš
, 
h™rŞl_max
;

492 
damrŞl_mš
, 
damrŞl_max
;

495 cÚ¡ 
¡d
::
veùÜ
<
¡©_t
> 
ba£_¡©s_bË
 = {

522 ià(
	`rŞl_chªû
(30)){

523 
af
.
loÿtiÚ
 = 
APPLY_HIT
;

524 
af
.
modif›r
 = 
	`numb”_¿nge
(
ba£_¡©s_bË
[
ev–
].
hp_mš
, ba£_¡©s_bË[ev–].
hp_max
);

525 
afãù
::
	`još_to_obj
(
obj
, &
af
);

529 ià(
	`rŞl_chªû
(20)){

530 
af
.
loÿtiÚ
 = 
APPLY_MANA
;

531 
af
.
modif›r
 = 
	`numb”_¿nge
(
ba£_¡©s_bË
[
ev–
].
mªa_mš
, ba£_¡©s_bË[ev–].
mªa_max
);

532 
afãù
::
	`još_to_obj
(
obj
, &
af
);

536 ià(
	`rŞl_chªû
(20)){

537 
af
.
loÿtiÚ
 = 
APPLY_STAM
;

538 
af
.
modif›r
 = 
	`numb”_¿nge
(
ba£_¡©s_bË
[
ev–
].
¡am_mš
, ba£_¡©s_bË[ev–].
¡am_max
);

539 
afãù
::
	`još_to_obj
(
obj
, &
af
);

543 ià(
	`rŞl_chªû
(30)){

544 
af
.
loÿtiÚ
 = 
APPLY_HITROLL
;

545 
af
.
modif›r
 = 
	`numb”_¿nge
(
ba£_¡©s_bË
[
ev–
].
h™rŞl_mš
, ba£_¡©s_bË[ev–].
h™rŞl_max
);

546 
afãù
::
	`još_to_obj
(
obj
, &
af
);

550 ià(
	`rŞl_chªû
(30)){

551 
af
.
loÿtiÚ
 = 
APPLY_DAMROLL
;

552 
af
.
modif›r
 = 
	`numb”_¿nge
(
ba£_¡©s_bË
[
ev–
].
damrŞl_mš
, ba£_¡©s_bË[ev–].
damrŞl_max
);

553 
afãù
::
	`još_to_obj
(
obj
, &
af
);

556 
	}
}

	@src/magic.cc

28 
	~"magic.hh
"

30 
	~<veùÜ
>

32 
	~"aù.hh
"

33 
	~"¬gum’t.hh
"

34 
	~"afãù/Afãù.hh
"

35 
	~"A»a.hh
"

36 
	~"chªÃls.hh
"

37 
	~"Ch¬aù”.hh
"

38 
	~"CÏn.hh
"

39 
	~"DesütÜ.hh
"

40 
	~"di¥–.hh
"

41 
	~"Ex™.hh
"

42 
	~"ExŒaDesü.hh
"

43 
	~"fšd.hh
"

44 
	~"FÏgs.hh
"

45 
	~"FÜm©.hh
"

46 
	~"Game.hh
"

47 
	~"š‹½.hh
"

48 
	~"lookup.hh
"

49 
	~"Loggšg.hh
"

50 
	~"loÙv2.hh
"

51 
	~"memÜy.hh
"

52 
	~"m”c.hh
"

53 
	~"MobePrÙÙy³.hh
"

54 
	~"Objeù.hh
"

55 
	~"ObjeùPrÙÙy³.hh
"

56 
	~"ObjeùV®ue.hh
"

57 
	~"PÏy”.hh
"

58 
	~"Que¡A»a.hh
"

59 
	~"¿ndom.hh
"

60 
	~"Room.hh
"

61 
	~"skl/skl.hh
"

62 
	~"SŒšg.hh
"

63 
	~"ty³Çme.hh
"

64 
	~"bËs.hh
"

65 
	~"W—th”.hh
"

66 
	~"WÜld.hh
"

69 
boŞ
 
focus
;

72 
SŒšg
 
	grg‘_Çme
;

74 
kl_off
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
));

77 
§y_¥–l
 
¬gs
((
Ch¬aù”
 *
ch
, 
skl
::
ty³
 
¢
));

80 
boŞ
 
»move_obj
 
¬gs
((
Ch¬aù”
 *
ch
, 
iW—r
, boŞ 
fR•Ïû
));

81 
w—r_obj
 
¬gs
((
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, 
boŞ
 
fR•Ïû
));

82 
fšd_ex™
 
¬gs
((
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬g
));

85 
	gskl
::
ty³
 
	$fšd_¥–l
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
Çme
)

88 
skl
::
ty³
 
found
 = skl::ty³::
unknown
;

91 ià(
ch
->
	`is_Åc
())

92  
skl
::
	`lookup
(
Çme
);

94 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

95 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

96 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

98 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

101 ià(
Çme
.
	`is_´efix_of
(
’Œy
.name)) {

102 ià(
found
 =ğ
skl
::
ty³
::
unknown
)

103 
found
 = 
ty³
;

105 ià(
	`g‘_skl_Ëv–
(
ch
, 
ty³
) > 0)

106  
ty³
;

110  
found
;

111 
	}
}

114 
	$§y_¥–l
(
Ch¬aù”
 *
ch
, 
skl
::
ty³
 
¢
)

116 
SŒšg
 
buf
;

117 
buf2
[
MAX_STRING_LENGTH
];

118 
Ch¬aù”
 *
rch
;

119 
iSyl
, 
Ëngth
;

120 
	ssyl_ty³
 {

121 cÚ¡ 
SŒšg
 
Şd
;

122 cÚ¡ 
SŒšg
 
nw
;

124 cÚ¡ 
syl_ty³
 
syl_bË
[] = {

158 cÚ¡ *
pName
 = 
skl
::
	`lookup
(
¢
).
Çme
.
	`c_¡r
(); *pNam!ğ'\0';…Nam+ğ
Ëngth
) {

159 
iSyl
 = 0; (
Ëngth
 = 
	`¡¾’
(
syl_bË
[iSyl].
Şd
)) != 0; iSyl++) {

160 ià(
syl_bË
[
iSyl
].
Şd
.
	`is_´efix_of
(
pName
)) {

161 
buf
 +ğ
syl_bË
[
iSyl
].
nw
;

166 ià(
Ëngth
 == 0)

167 
Ëngth
 = 1;

170 
FÜm©
::
	`¥rštf
(
buf2
, "$Àu‰” thwÜds, '%s'.", 
buf
);

171 
FÜm©
::
	`¥rštf
(
buf
, "$Àu‰” thwÜds, '%s'.", 
skl
::
	`lookup
(
¢
).
Çme
);

173 ià(
	`ch¬_š_d¬’a_room
(
ch
))

174 
	`aù
(
buf
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_VIEW
);

176 
rch
 = 
ch
->
š_room
->
³İË
;„ch;„ch =„ch->
Ãxt_š_room
) {

177 ià(
rch
 !ğ
ch
) {

178 ià(
ch
->
gud
 =ğ
rch
->guild) {

179 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
rch
, 
TO_VICT
);

183 ià(
	`numb”_³rûÁ
(è< 
	`g‘_skl_Ëv–
(
rch
, 
skl
::
ty³
::
Ïnguages
)) {

184 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
rch
, 
TO_VICT
);

185 
	`check_im´ove
(
rch
, 
skl
::
ty³
::
Ïnguages
, 
Œue
, 8);

188 
	`aù
(
buf2
, 
ch
, 
nuÎ±r
, 
rch
, 
TO_VICT
);

190 ià(
	`g‘_skl_Ëv–
(
rch
, 
skl
::
ty³
::
Ïnguages
))

191 
	`check_im´ove
(
rch
, 
skl
::
ty³
::
Ïnguages
, 
çl£
, 8);

195 
	}
}

199 
boŞ
 
	$h–p_mob
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

201 ià(!
	`is_§me_group
(
ch
, 
viùim
->
fightšg
è&& !viùim->
aù_æags
.
	`has
(
ACT_PET
)) {

202 
	`¡c
("You cªnÙ‡‰ack/h–°th© mobe!\n", 
ch
);

203 
	`wizÃt
("$N i ©‹m±šgØh–p/hšd”‡ mobËg®ly.", 
ch
, 
nuÎ±r
, 
WIZ_CHEAT
, 0, 
	`GET_RANK
(ch));

204  
Œue
;

207  
çl£
;

208 
	}
}

210 
	$do_ÿ¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

212 
Ch¬aù”
 *
viùim
;

213 
Objeù
 *
obj
;

214 *
vo
;

215 
mªa
, 
rg‘
, 
wa™
;

216 
skl
::
ty³
 
¢
;

219 ià(
ch
->
	`is_Åc
(è&& ch->
desc
 =ğ
nuÎ±r
)

222 ià(
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

223 
	`¡c
("MÜphed…Ïy” ÿÂÙ ca¡ s³Îs.\n", 
ch
);

227 ià(
¬gum’t
.
	`em±y
()) {

228 
	`¡c
("Ca¡ which wh© wh”e?\n", 
ch
);

232 
SŒšg
 
¬g1
, 
¬g2
;

233 
rg‘_Çme
 = 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g1
);

234 
	`Úe_¬gum’t
(
rg‘_Çme
, 
¬g2
);

236 ià((
¢
 = 
	`fšd_¥–l
(
ch
, 
¬g1
)è=ğ
skl
::
ty³
::
unknown


237 || (!
ch
->
	`is_Åc
()

238 && (
	`g‘_skl_Ëv–
(
ch
, 
¢
) == 0))) {

239 
	`¡c
("You dÚ'ˆknow‡ny s³Î oàth©‚ame.\n", 
ch
);

243 ià(
skl
::
	`lookup
(
¢
).
¥–l_fun
 =ğ
¥–l_nuÎ
) {

244 
	`¡c
("Th©' nÙ‡ s³Î.\n", 
ch
);

245 
	`wizÃt
("$N i ©‹m±šgØu£hÿ¡ skÈa ¥–Èch—t.", 
ch
, 
nuÎ±r
, 
WIZ_CHEAT
, 0, 
	`GET_RANK
(ch));

249 ià(
skl
::
	`lookup
(
¢
).
»mÜt_gud
 !ğ
Gud
::
nÚe
)

250 ià(!
	`CAN_USE_RSKILL
(
ch
, 
¢
)) {

251 
	`¡c
("You dÚ'ˆknow‡ny s³Î oàth©‚ame.\n", 
ch
);

255 ià(!
	`IS_IMMORTAL
(
ch
)

256 && (
	`g‘_pos™iÚ
(
ch
è< 
skl
::
	`lookup
(
¢
).
mšimum_pos™iÚ
)) {

257 
	`¡c
("You cª'ˆcÚûÁ¿‹ƒnough.\n", 
ch
);

261 
mªa
 = 
	`g‘_skl_co¡
(
ch
, 
¢
);

263 
viùim
 = 
nuÎ±r
;

264 
obj
 = 
nuÎ±r
;

265 
vo
 = 
nuÎ±r
;

266 
rg‘
 = 
TARGET_NONE
;

268 
skl
::
	`lookup
(
¢
).
rg‘
) {

270 
Loggšg
::
	`bugf
("Do_ÿ¡: bad¬g‘ fÜ s³Î '%s'.", 
skl
::
	`lookup
(
¢
).
Çme
);

273 
TAR_IGNORE
:

276 
TAR_CHAR_OFFENSIVE
:

277 ià(
¬g2
.
	`em±y
()) {

278 ià((
viùim
 = 
ch
->
fightšg
è=ğ
nuÎ±r
) {

279 
	`¡c
("Ca¡h¥–ÈÚ whom?\n", 
ch
);

284 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

285 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

289 ià(
viùim
->
fightšg
 !ğ
nuÎ±r
 && !
	`is_§me_group
(
ch
, victim->fighting)) {

290 
	`¡c
("You¸š‹nded oµÚ’ˆi ®»ady fightšg someÚ–£.\n", 
ch
);

294 ià(
viùim
->
	`is_Åc
(è&& viùim->
fightšg
 !ğ
nuÎ±r
 && !
	`is_§me_group
(
ch
, victim))

295 ià(
	`h–p_mob
(
ch
, 
viùim
))

299 ià(!
ch
->
	`is_Åc
()) {

301 ià(
skl
::
	`lookup
(
¢
).
¥–l_fun
 =ğ
¥–l_¦ow


302 && (
viùim
->
ma¡”
 =ğ
ch
 || victim == ch))

305 ià(
	`is_§ã
(
ch
, 
viùim
, 
çl£
)) {

306 
	`¡c
("NÙ oÀth©¬g‘.\n", 
ch
);

310 
	`check_kËr
(
ch
, 
viùim
);

314 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 =ğ
viùim
) {

315 
	`¡c
("You cª'ˆdØth© oÀyou¸owÀfŞlow”.\n", 
ch
);

319 
vo
 = (*è
viùim
;

320 
rg‘
 = 
TARGET_CHAR
;

323 
TAR_CHAR_DEFENSIVE
:

324 ià(
¬g2
.
	`em±y
())

325 
viùim
 = 
ch
;

326 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

327 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

331 ià(
viùim
->
	`is_Åc
(è&& viùim->
fightšg
 !ğ
nuÎ±r
 && !
	`is_§me_group
(
ch
, victim))

332 ià(
	`h–p_mob
(
ch
, 
viùim
))

335 
vo
 = (*è
viùim
;

336 
rg‘
 = 
TARGET_CHAR
;

339 
TAR_CHAR_SELF
:

340 ià(!
¬g2
.
	`em±y
(è&& !
ch
->
Çme
.
	`has_wÜds
(
rg‘_Çme
)) {

341 
	`¡c
("You cªnÙ ca¡hi ¥–ÈÚ‡nÙh”.\n", 
ch
);

345 
vo
 = (*è
ch
;

346 
rg‘
 = 
TARGET_CHAR
;

349 
TAR_OBJ_INV
:

350 ià(
¬g2
.
	`em±y
()) {

351 
	`¡c
("Wh© shouldh¥–Èbÿ¡ upÚ?\n", 
ch
);

355 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
rg‘_Çme
)è=ğ
nuÎ±r
) {

356 
	`¡c
("You‡»‚Ù c¬ryšgh©.\n", 
ch
);

360 
vo
 = (*è
obj
;

361 
rg‘
 = 
TARGET_OBJ
;

364 
TAR_OBJ_HERE
:

365 ià(
¬g2
.
	`em±y
()) {

366 
	`¡c
("Wh© shouldh¥–Èbÿ¡ upÚ?\n", 
ch
);

370 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
rg‘_Çme
)è=ğ
nuÎ±r


371 && (
obj
 = 
	`g‘_obj_h”e
(
ch
, 
rg‘_Çme
)è=ğ
nuÎ±r
) {

372 
	`¡c
("You dÚ'ˆ£th© h”e.\n", 
ch
);

376 
vo
 = (*è
obj
;

377 
rg‘
 = 
TARGET_OBJ
;

380 
TAR_OBJ_CHAR_OFF
:

381 ià(
¬g2
.
	`em±y
()) {

382 ià((
viùim
 = 
ch
->
fightšg
è=ğ
nuÎ±r
) {

383 
	`¡c
("Ca¡h¥–ÈÚ whom o¸wh©?\n", 
ch
);

387 
rg‘
 = 
TARGET_CHAR
;

389 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è!ğ
nuÎ±r
)

390 
rg‘
 = 
TARGET_CHAR
;

392 ià(
rg‘
 =ğ
TARGET_CHAR
) {

393 ià(
	`is_§ã_¥–l
(
ch
, 
viùim
, 
çl£
)) {

394 
	`¡c
("NÙ oÀth©¬g‘.\n", 
ch
);

398 ià(
viùim
->
	`is_Åc
(è&& viùim->
fightšg
 !ğ
nuÎ±r
)

399 ià(
	`h–p_mob
(
ch
, 
viùim
))

402 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 =ğ
viùim
) {

403 
	`¡c
("You cª'ˆdØth© oÀyou¸owÀfŞlow”.\n", 
ch
);

407 ià(!
ch
->
	`is_Åc
())

408 
	`check_kËr
(
ch
, 
viùim
);

410 
vo
 = (*è
viùim
;

412 ià((
obj
 = 
	`g‘_obj_h”e
(
ch
, 
rg‘_Çme
)è!ğ
nuÎ±r
) {

413 
vo
 = (*è
obj
;

414 
rg‘
 = 
TARGET_OBJ
;

417 
	`¡c
("You dÚ'ˆ£th© h”e.\n", 
ch
);

423 
TAR_OBJ_CHAR_DEF
:

424 ià(
¬g2
.
	`em±y
()) {

425 
vo
 = (*è
ch
;

426 
rg‘
 = 
TARGET_CHAR
;

428 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è!ğ
nuÎ±r
) {

429 
vo
 = (*è
viùim
;

430 
rg‘
 = 
TARGET_CHAR
;

432 ià(
viùim
->
	`is_Åc
(è&& viùim->
fightšg
 !ğ
nuÎ±r
)

433 ià(
	`h–p_mob
(
ch
, 
viùim
))

436 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
rg‘_Çme
)è!ğ
nuÎ±r
) {

437 
vo
 = (*è
obj
;

438 
rg‘
 = 
TARGET_OBJ
;

441 
	`¡c
("You dÚ'ˆ£th© h”e.\n", 
ch
);

448 ià(
ch
->
mªa
 < mana) {

449 
	`¡c
("You dÚ'ˆhav’ough mªa.\n", 
ch
);

453 ià(
¢
 !ğ
skl
::
ty³
::
v’Œoqu©e
)

454 
	`§y_¥–l
(
ch
, 
¢
);

456 
wa™
 = 
skl
::
	`lookup
(
¢
).
b—ts
;

458 ià((
ch
->
gud
 =ğ
Gud
::
mage
è|| (ch->gud =ğGud::
ş”ic
è|| (ch->gud =ğGud::
Ãüomªûr
))

459 
wa™
 -= wait / 4;

462 ià(
	`HAS_RAFF
(
ch
, 
RAFF_FASTCAST
))

463 
wa™
 -= wait / 4;

466 ià(
	`HAS_RAFF
(
ch
, 
RAFF_SLOWCAST
))

467 
wa™
 += wait / 4;

470 ià(
	`GET_ATTR
(
ch
, 
SET_MAGE_INVOKER
) >= 3)

471 
wa™
 -= wait / 4;

474 ià(
	`GET_ATTR
(
ch
, 
SET_CLERIC_DIVINE
) >= 4)

475 
wa™
 -= wait / 4;

477 
	`WAIT_STATE
(
ch
, 
wa™
);

480 ià(!
	`´d_chªû
(&
ch
->
skl_çs
, 
	`g‘_skl_Ëv–
(ch, 
¢
))) {

481 
	`¡c
("You†o¡ you¸cÚûÁ¿tiÚ.\n", 
ch
);

482 
	`check_im´ove
(
ch
, 
¢
, 
çl£
, 1);

483 
ch
->
mªa
 -= mana / 2;

495 ià(
	`GET_ATTR
(
ch
, 
SET_MAGE_INVOKER
) >= 4)

496 
mªa
 -= mana * 45 / 100;

499 ià(
	`GET_ATTR
(
ch
, 
SET_CLERIC_DIVINE
) >= 3)

500 
mªa
 -= mana * 45 / 100;

502 
ch
->
mªa
 -ğmª¨- mª¨* 
	`GET_ATTR
(ch, 
APPLY_MANA_COST_PCT
) / 100;

504 (*
skl
::
	`lookup
(
¢
).
¥–l_fun
)(¢, 
ch
->
Ëv–
, ch, 
vo
, 
rg‘
, 
	`g‘_evŞutiÚ
(ch, sn));

505 
	`check_im´ove
(
ch
, 
¢
, 
Œue
, 1);

508 ià(
	`GET_ATTR
(
ch
, 
SET_MAGE_INVOKER
) >= 5){

509 ià((
	`numb”_³rûÁ
() < 11)

510 && (
skl
::
	`lookup
(
¢
).
rg‘
 =ğ
TAR_CHAR_OFFENSIVE
)){

511 
	`¡c
("You¸wÜd echo, c»©šg‡nÙh” ca¡šg oàth¥–l!!!\n", 
ch
);

512 
	`¡c
("You¸İpÚ’t wÜd echo!\n", 
viùim
);

513 (*
skl
::
	`lookup
(
¢
).
¥–l_fun
)(¢, 
ch
->
Ëv–
, ch, 
vo
, 
rg‘
, 
	`g‘_evŞutiÚ
(ch, sn));

520 ià((
skl
::
	`lookup
(
¢
).
rg‘
 =ğ
TAR_CHAR_OFFENSIVE


521 || (
skl
::
	`lookup
(
¢
).
rg‘
 =ğ
TAR_OBJ_CHAR_OFF
 &&¬g‘ =ğ
TARGET_CHAR
))

522 && 
viùim
 !ğ
ch


523 && 
viùim
->
ma¡”
 !ğ
ch
) {

524 
Ch¬aù”
 *
vch
;

525 
Ch¬aù”
 *
vch_Ãxt
;

527 
vch
 = 
ch
->
š_room
->
³İË
; vch; vch = 
vch_Ãxt
) {

528 
vch_Ãxt
 = 
vch
->
Ãxt_š_room
;

530 ià(
viùim
 =ğ
vch
 && viùim->
fightšg
 =ğ
nuÎ±r
) {

531 
	`check_kËr
(
viùim
, 
ch
);

532 
	`muÉi_h™
(
viùim
, 
ch
, 
skl
::
ty³
::
unknown
);

537 
	}
}

545 
	$do_mpÿ¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

547 
Ch¬aù”
 *
viùim
;

548 
Objeù
 *
obj
;

549 *
vo
;

550 
mªa
, 
rg‘
;

551 
skl
::
ty³
 
¢
;

553 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

554 
	`¡c
("Huh?\n", 
ch
);

558 
SŒšg
 
¬g1
, 
¬g2
;

559 
rg‘_Çme
 = 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g1
);

560 
	`Úe_¬gum’t
(
rg‘_Çme
, 
¬g2
);

562 ià(
¬g1
.
	`em±y
()) {

563 
	`¡c
("Ca¡ which wh© wh”e?\n", 
ch
);

567 ià((
¢
 = 
	`fšd_¥–l
(
ch
, 
¬g1
)è< 
skl
::
ty³
::
unknown
) {

568 
	`¡c
("You dÚ'ˆknow‡ny s³Î oàth©‚ame.\n", 
ch
);

572 ià(
	`g‘_pos™iÚ
(
ch
è< 
skl
::
	`lookup
(
¢
).
mšimum_pos™iÚ
) {

573 
	`¡c
("You cª'ˆcÚûÁ¿‹ƒnough.\n", 
ch
);

577 
mªa
 = 
	`g‘_skl_co¡
(
ch
, 
¢
);

579 
viùim
 = 
nuÎ±r
;

580 
obj
 = 
nuÎ±r
;

581 
vo
 = 
nuÎ±r
;

582 
rg‘
 = 
TARGET_NONE
;

584 
skl
::
	`lookup
(
¢
).
rg‘
) {

586 
Loggšg
::
	`bugf
("mpÿ¡: bad¬g‘ fÜ s³Î '%s'.", 
skl
::
	`lookup
(
¢
).
Çme
);

589 
TAR_IGNORE
:

592 
TAR_CHAR_OFFENSIVE
:

593 ià((
¬g2
.
	`em±y
(è&& 
ch
->
fightšg
 =ğ
nuÎ±r
)

594 || (
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r


595 || (
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 =ğ
viùim
))

598 
vo
 = (*è
viùim
;

599 
rg‘
 = 
TARGET_CHAR
;

602 
TAR_CHAR_DEFENSIVE
:

603 ià(
¬g2
.
	`em±y
())

604 
viùim
 = 
ch
;

605 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r
)

608 
vo
 = (*è
viùim
;

609 
rg‘
 = 
TARGET_CHAR
;

612 
TAR_CHAR_SELF
:

613 ià(!
¬g2
.
	`em±y
(è&& !
ch
->
Çme
.
	`has_wÜds
(
rg‘_Çme
))

616 
vo
 = (*è
ch
;

617 
rg‘
 = 
TARGET_CHAR
;

620 
TAR_OBJ_INV
:

621 ià(
¬g2
.
	`em±y
(è|| (
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
rg‘_Çme
)è=ğ
nuÎ±r
)

624 
vo
 = (*è
obj
;

625 
rg‘
 = 
TARGET_OBJ
;

628 
TAR_OBJ_CHAR_OFF
:

629 ià(
¬g2
.
	`em±y
()) {

630 ià((
viùim
 = 
ch
->
fightšg
è=ğ
nuÎ±r
)

633 
rg‘
 = 
TARGET_CHAR
;

635 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è!ğ
nuÎ±r
)

636 
rg‘
 = 
TARGET_CHAR
;

638 ià(
rg‘
 =ğ
TARGET_CHAR
) {

639 ià((
	`is_§ã_¥–l
(
ch
, 
viùim
, 
çl£
) && victim != ch)

640 || (
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 =ğ
viùim
))

643 
vo
 = (*è
viùim
;

645 ià((
obj
 = 
	`g‘_obj_h”e
(
ch
, 
rg‘_Çme
)è!ğ
nuÎ±r
) {

646 
vo
 = (*è
obj
;

647 
rg‘
 = 
TARGET_OBJ
;

654 
TAR_OBJ_CHAR_DEF
:

655 ià(
¬g2
.
	`em±y
()) {

656 
vo
 = (*è
ch
;

657 
rg‘
 = 
TARGET_CHAR
;

659 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è!ğ
nuÎ±r
) {

660 
vo
 = (*è
viùim
;

661 
rg‘
 = 
TARGET_CHAR
;

663 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
rg‘_Çme
)è!ğ
nuÎ±r
) {

664 
vo
 = (*è
obj
;

665 
rg‘
 = 
TARGET_OBJ
;

673 ià(
ch
->
mªa
 < mana)

676 ià(
¢
 !ğ
skl
::
ty³
::
v’Œoqu©e
)

677 
	`§y_¥–l
(
ch
, 
¢
);

679 
ch
->
mªa
 -= mana;

681 (*
skl
::
	`lookup
(
¢
).
¥–l_fun
)(¢, 
ch
->
Ëv–
, ch, 
vo
, 
rg‘
, 
	`g‘_evŞutiÚ
(ch, sn));

682 
	}
}

685 
	$obj_ÿ¡_¥–l
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
Objeù
 *
obj
)

687 *
vo
;

688 
rg‘
 = 
TARGET_NONE
;

690 ià(
¢
 <ğ
skl
::
ty³
::
unknown
 || sÀ>ğskl::ty³::
size
)

693 cÚ¡‡uto& 
’Œy
 = 
skl
::
	`lookup
(
¢
);

695 ià(
’Œy
.
¥–l_fun
 == 0) {

696 
Loggšg
::
	`bugf
("Obj_ÿ¡_¥–l: bad s³Î '%s'.", 
’Œy
.
Çme
);

700 
’Œy
.
rg‘
) {

702 
Loggšg
::
	`bugf
("Obj_ÿ¡_¥–l: bad¬g‘ fÜ s³Î '%s'.", 
’Œy
.
Çme
);

705 
TAR_IGNORE
:

706 
vo
 = 
nuÎ±r
;

709 
TAR_CHAR_OFFENSIVE
:

710 ià(
viùim
 =ğ
nuÎ±r
)

711 
viùim
 = 
ch
->
fightšg
;

713 ià(
viùim
 =ğ
nuÎ±r
) {

714 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

718 ià(!
ch
->
	`is_Åc
()) {

720 ià(
skl
::
	`lookup
(
¢
).
¥–l_fun
 =ğ
¥–l_¦ow


721 && (
viùim
->
ma¡”
 =ğ
ch
 || victim == ch))

724 ià(
	`is_§ã_¥–l
(
ch
, 
viùim
, 
çl£
)) {

725 
	`¡c
("NÙ oÀth©¬g‘.\n", 
ch
);

729 
	`check_kËr
(
ch
, 
viùim
);

732 ià(
viùim
->
	`is_Åc
(è&& viùim->
fightšg
 !ğ
nuÎ±r
)

733 ià(
	`h–p_mob
(
ch
, 
viùim
))

737 
vo
 = (*è
viùim
;

738 
rg‘
 = 
TARGET_CHAR
;

741 
TAR_CHAR_SELF
:

742 ià(
viùim
 =ğ
nuÎ±r
)

743 
viùim
 = 
ch
;

745 ià(
viùim
 !ğ
ch
) {

746 
	`¡c
("You cªnÙ ca¡hi ¥–ÈÚ‡nÙh”.\n", 
ch
);

751 
TAR_CHAR_DEFENSIVE
:

752 ià(
viùim
 =ğ
nuÎ±r
 && 
obj
 !=‚ullptr) {

753 
	`¡c
("Thi ¥–ÈÿÀnÙ bu£d oÀobjeùs.\n", 
ch
);

757 
vo
 = (*è
viùim
;

759 ià(
viùim
->
	`is_Åc
(è&& viùim->
fightšg
 !ğ
nuÎ±r
)

760 ià(
	`h–p_mob
(
ch
, 
viùim
))

763 
rg‘
 = 
TARGET_CHAR
;

766 
TAR_OBJ_HERE
:

767 
TAR_OBJ_INV
:

768 ià(
obj
 =ğ
nuÎ±r
) {

769 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

773 
vo
 = (*è
obj
;

774 
rg‘
 = 
TARGET_OBJ
;

777 
TAR_OBJ_CHAR_OFF
:

778 ià(
viùim
 =ğ
nuÎ±r
 && 
obj
 ==‚ullptr) {

779 ià(
ch
->
fightšg
 !ğ
nuÎ±r
)

780 
viùim
 = 
ch
->
fightšg
;

782 
	`¡c
("You cª'ˆdØth©.\n", 
ch
);

786 ià(
viùim
 !ğ
nuÎ±r
) {

787 ià(
	`is_§ã_¥–l
(
ch
, 
viùim
, 
çl£
)) {

788 
	`¡c
("Som‘hšg i¢'ˆright...\n", 
ch
);

792 ià(
viùim
->
	`is_Åc
(è&& viùim->
fightšg
 !ğ
nuÎ±r
)

793 ià(
	`h–p_mob
(
ch
, 
viùim
))

796 
vo
 = (*è
viùim
;

797 
rg‘
 = 
TARGET_CHAR
;

800 
vo
 = (*è
obj
;

801 
rg‘
 = 
TARGET_OBJ
;

805 ià(
viùim
 !ğ
nuÎ±r
) {

806 
vo
 = (*è
viùim
;

807 
rg‘
 = 
TARGET_CHAR
;

810 
vo
 = (*è
obj
;

811 
rg‘
 = 
TARGET_OBJ
;

817 
TAR_OBJ_CHAR_DEF
:

818 ià(
viùim
 =ğ
nuÎ±r
 && 
obj
 ==‚ullptr) {

819 
vo
 = (*è
ch
;

820 
rg‘
 = 
TARGET_CHAR
;

822 ià(
viùim
 !ğ
nuÎ±r
) {

823 ià(
viùim
->
	`is_Åc
(è&& viùim->
fightšg
 !ğ
nuÎ±r
)

824 ià(
	`h–p_mob
(
ch
, 
viùim
))

827 
vo
 = (*è
viùim
;

828 
rg‘
 = 
TARGET_CHAR
;

831 ià(
obj
->
™em_ty³
 =ğ
ITEM_CORPSE_PC
) {

832 
	`¡c
("You cªnÙ ca¡h© s³Î oÀ¨cÜp£.\n", 
ch
);

836 
vo
 = (*è
obj
;

837 
rg‘
 = 
TARGET_OBJ
;

850 
focus
 = 
çl£
;

851 (*
skl
::
	`lookup
(
¢
).
¥–l_fun
)(¢, 
Ëv–
, 
ch
, 
vo
, 
rg‘
, 1);

852 
focus
 = 
Œue
;

854 ià((
skl
::
	`lookup
(
¢
).
rg‘
 =ğ
TAR_CHAR_OFFENSIVE


855 || (
skl
::
	`lookup
(
¢
).
rg‘
 =ğ
TAR_OBJ_CHAR_OFF
 &&¬g‘ =ğ
TARGET_CHAR
))

856 && 
viùim
 !ğ
ch


857 && 
viùim
->
ma¡”
 !ğ
ch
) {

858 
Ch¬aù”
 *
vch
;

859 
Ch¬aù”
 *
vch_Ãxt
;

861 
vch
 = 
ch
->
š_room
->
³İË
; vch; vch = 
vch_Ãxt
) {

862 
vch_Ãxt
 = 
vch
->
Ãxt_š_room
;

864 ià(
viùim
 =ğ
vch
 && viùim->
fightšg
 =ğ
nuÎ±r
) {

865 
	`check_kËr
(
viùim
, 
ch
);

866 
	`muÉi_h™
(
viùim
, 
ch
, 
skl
::
ty³
::
unknown
);

871 
	}
}

875 
	$¥–l_acid_bÏ¡
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

877 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

878 
dam
;

879 
dam
 = 
	`diû
(
Ëv–
, 15);

881 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_ACID
))

882 
dam
 /= 2;

884 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_ACID
, 
Œue
,rue);

885 
	}
}

888 
	$ªim©e_mob
(
Ch¬aù”
 *
ch
, 
Ëv–
, cÚ¡ *
Çme
, 
vnum
)

890 
Ch¬aù”
 *
mob
;

891 
buf
[
MAX_STRING_LENGTH
];

893 ià(
ch
->
	`is_Åc
()) {

894 
	`¡c
("Mobe ¬nÙ skËd Neüomªûrs.\n", 
ch
);

898 ià((
vnum
 =ğ
MOB_VNUM_ZOMBIE
 && 
ch
->
pcd©a
->
zomb›
 !ğ
nuÎ±r
)

899 || (
vnum
 =ğ
MOB_VNUM_SKELETON
 && 
ch
->
pcd©a
->
sk–‘Ú
 !ğ
nuÎ±r
)

900 || (
vnum
 =ğ
MOB_VNUM_WRAITH
 && 
ch
->
pcd©a
->
w¿™h
 !ğ
nuÎ±r
)

901 || (
vnum
 =ğ
MOB_VNUM_GARGOYLE
 && 
ch
->
pcd©a
->
g¬goyË
 !ğ
nuÎ±r
)) {

902 
	`±c
(
ch
, "You hav®»ady summÚed‡ %s!\n", 
Çme
);

906 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_LAW
)) {

907 
	`¡c
("You cªnÙ summÚ c»©u» w™hšhc™y.\n", 
ch
);

911 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
)) {

912 
	`¡c
("Mobe ÿÂÙ bsummÚed iÀhŞy o¸unhŞy„ooms.\n", 
ch
);

916 
mob
 = 
	`ü—‹_mobe
(
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
vnum
));

919 ià(! 
mob
) {

920 
Loggšg
::
	`bug
("Memoryƒrror creating mob in‡nimate_mob().", 0);

921 
	`¡c
("Could‚Ù c»©you¸£rv’t.\n", 
ch
);

925 
	`ch¬_to_room
(
mob
, 
ch
->
š_room
);

926 
	`aù
("$ÀmagiÿÎy c»©e ¨$N!\n", 
ch
, 
nuÎ±r
, 
mob
, 
TO_ROOM
);

927 
	`±c
(
ch
, "You havü—‹d‡ % tØdØyou¸biddšg.\n", 
Çme
);

928 
mob
->
Ãùim”
 = 
Ëv–
 / 10;

930 
	`make_³t
(
ch
, 
mob
);

931 
afãù
::
	`add_³rm_to_ch¬
(
mob
,‡fãù::
ty³
::
ch¬m_³rsÚ
);

932 
mob
->
comm_æags
 = 
COMM_NOCHANNELS
;

934 
FÜm©
::
	`¥rštf
(
buf
, "%sSummoned fromhe darkside,his %s serves '%s'.\n",

935 
mob
->
desütiÚ
, 
Çme
, 
ch
->name);

936 
mob
->
desütiÚ
 = 
buf
;

938 
vnum
) {

939 
MOB_VNUM_ZOMBIE
: 
ch
->
pcd©a
->
zomb›
 = 
mob
; ;

941 
MOB_VNUM_SKELETON
: 
ch
->
pcd©a
->
sk–‘Ú
 = 
mob
; ;

943 
MOB_VNUM_WRAITH
: 
ch
->
pcd©a
->
w¿™h
 = 
mob
; ;

945 
MOB_VNUM_GARGOYLE
: 
ch
->
pcd©a
->
g¬goyË
 = 
mob
; ;

947 
	}
}

949 
	$¥–l_ªim©e_zomb›
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

951 
	`ªim©e_mob
(
ch
, 
Ëv–
, "zomb›", 
MOB_VNUM_ZOMBIE
);

952 
	}
}

954 
	$¥–l_ªim©e_sk–‘Ú
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

956 
	`ªim©e_mob
(
ch
, 
Ëv–
, "sk–‘Ú", 
MOB_VNUM_SKELETON
);

957 
	}
}

959 
	$¥–l_ªim©e_w¿™h
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

961 
	`ªim©e_mob
(
ch
, 
Ëv–
, "w¿™h", 
MOB_VNUM_WRAITH
);

962 
	}
}

964 
	$¥–l_ªim©e_g¬goyË
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

966 
	`ªim©e_mob
(
ch
, 
Ëv–
, "g¬goyË", 
MOB_VNUM_GARGOYLE
);

967 
	}
}

969 
	$¥–l_¬mÜ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

971 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

973 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
¬mÜ
)) {

974 ià(
viùim
 =ğ
ch
)

975 
	`¡c
("You‡»‡Ì—dy‡rmÜed.\n", 
ch
);

977 
	`aù
("$N i ®»ady‡rmÜed.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

982 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

983 
afãù
::
ty³
::
¬mÜ
,

984 
Ëv–
,

986 
evŞutiÚ
,

987 
çl£


990 
	`¡c
("You f“ÈsomeÚ´Ùeùšg you.\n", 
viùim
);

992 ià(
ch
 !ğ
viùim
)

993 
	`aù
("$N i ´Ùeùed by you¸magic.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

994 
	}
}

996 
	$¥–l_¡“l_mi¡
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

998 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

1000 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
¡“l_mi¡
)) {

1001 ià(
viùim
 =ğ
ch
)

1002 
	`¡c
("You¸¬mÜ i ®»ady cß‹d w™h magiÿÈ¡“l.\n", 
ch
);

1004 
	`aù
("$N' ¬mÜ i ®»ady cß‹d w™h magiÿÈ¡“l.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1009 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

1010 
afãù
::
ty³
::
¡“l_mi¡
,

1011 
Ëv–
,

1013 
evŞutiÚ
,

1014 
çl£


1017 
	`¡c
("A ve oàmi¡ cov” you¸¬mÜ.\n", 
viùim
);

1019 ià(
ch
 !ğ
viùim
)

1020 
	`aù
("A ve oà¡“Ècov” $N' ¬mÜ.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1021 
	}
}

1024 
	$¥–l_blood_moÚ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1026 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

1028 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
blood_moÚ
)) {

1029 ià(
viùim
 =ğ
ch
)

1030 
	`¡c
("You‡»‡Ì—dy bloodthœ¡y.\n", 
ch
);

1032 
	`aù
("$N i ®»ady bloodthœ¡y.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1037 ià(
viùim
->
®ignm’t
 > -500 && !
	`IS_IMMORTAL
(
ch
)) {

1038 ià(
viùim
 !ğ
ch
)

1039 
	`¡c
("Thi ¥–Èi muchoØev fÜhem.\n", 
ch
);

1041 
	`¡c
("Thi ¥–Èi muchoØev fÜ you.\n", 
ch
);

1046 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

1047 
afãù
::
ty³
::
blood_moÚ
,

1048 
Ëv–
,

1049 
Ëv–
,

1050 
evŞutiÚ
,

1051 
çl£


1054 
	`¡c
("You havb“ÀbËs£d w™hhpow” oàthvampœe.\n", 
viùim
);

1055 
	`¡c
("You‡»hœ¡y fÜ blood.\n", 
viùim
);

1057 ià(!
viùim
->
	`is_Åc
(è&& !
	`HAS_RAFF
(viùim, 
RAFF_NOTHIRST
))

1058 
viùim
->
pcd©a
->
cÚd™iÚ
[
COND_THIRST
] = 0;

1060 ià(
ch
 !ğ
viùim
)

1061 
	`aù
("$N i nowhœ¡šg fÜ blood.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1062 
	}
}

1064 
	$¥–l_bËss
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1066 
Ch¬aù”
 *
viùim
;

1067 
Objeù
 *
obj
;

1068 
afãù
::
Afãù
 
af
;

1070 ià(
rg‘
 =ğ
TARGET_OBJ
) {

1071 
obj
 = (
Objeù
 *è
vo
;

1073 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
)) {

1074 
	`aù
("$°i ®»ady bËs£d.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1078 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_EVIL
)) {

1080 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
cur£
))

1081 
	`check_di¥–_obj
(
Ëv–
, 
obj
, 
afãù
::
ty³
::
cur£
, 
Œue
);

1082 ià(!
	`Ëv–_§ve
(
Ëv–
, 
obj
->level))

1083 
obj
->
exŒa_æags
 -ğ
ITEM_EVIL
;

1085 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_EVIL
))

1086 
	`aù
("Thev oà$°i toØpow”fuÈfÜ youØov”come.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1088 
	`aù
("$°glow ¨·Ë blue.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

1093 
af
.
wh”e
 = 
TO_OBJECT
;

1094 
af
.
ty³
 = 
afãù
::ty³::
bËss
;

1095 
af
.
Ëv–
 =†evel;

1096 
af
.
du¿tiÚ
 = 6 + 
Ëv–
;

1097 
af
.
loÿtiÚ
 = 
APPLY_SAVES
;

1098 
af
.
modif›r
 = -1;

1099 
af
.
	`b™veùÜ
(
ITEM_BLESS
);

1100 
af
.
evŞutiÚ
 =ƒvolution;

1101 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

1102 
	`aù
("$°glow w™h‡ hŞy‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

1107 
viùim
 = (
Ch¬aù”
 *è
vo
;

1109 ià(
viùim
->
fightšg
) {

1110 ià(
viùim
 =ğ
ch
)

1111 
	`¡c
("Th©‹m±ØbËs you duršg b©wa boundØç.\n", 
ch
);

1113 
	`aù
("$N cªnÙ„eûiv¨bËssšg duršg b©e.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1118 ià(
viùim
->
®ignm’t
 < 500 && !
	`IS_IMMORTAL
(
ch
)) {

1119 ià(
viùim
 !ğ
ch
)

1120 
	`¡c
("Thi ¥–Èi muchoØgood fÜhem.\n", 
ch
);

1122 
	`¡c
("Thi ¥–Èi muchoØgood fÜ you.\n", 
ch
);

1127 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
bËss
)) {

1128 ià(
viùim
 =ğ
ch
)

1129 
	`¡c
("You‡»‡Ì—dy bËs£d.\n", 
ch
);

1131 
	`aù
("$N‡Ì—dy ha divšçvÜ.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1136 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

1137 
afãù
::
ty³
::
bËss
,

1138 
Ëv–
,

1139 
Ëv–
 + 6,

1140 
evŞutiÚ
,

1141 
çl£


1144 
	`¡c
("You f“Èrigh‹ous.\n", 
viùim
);

1146 ià(
ch
 !ğ
viùim
)

1147 
	`aù
("You g¿Á $NhçvÜ oàyou¸god.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1148 
	}
}

1150 
	$¥–l_blšdÃss
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1152 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

1156 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
blšdÃss
)) {

1157 
	`¡c
("You¸viùim dÛ¢'ˆhavªy sighˆtØlo£.\n", 
ch
);

1161 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_OTHER
)) {

1162 
	`¡c
("You¸viùim blšk buˆcÚtšue tØ£e.\n", 
ch
);

1166 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

1167 
afãù
::
ty³
::
blšdÃss
,

1168 
Ëv–
,

1169 
Ëv–
 + 1,

1170 
evŞutiÚ
,

1171 
çl£


1174 
	`¡c
("You‡» blšded!\n", 
viùim
);

1175 
	`aù
("$À­³¬ tØbblšded.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1176 
	}
}

1179 
	$chaš_¥–l
(
Ch¬aù”
 *
ch
, *
vo
, 
skl
::
ty³
 
¢
, ty³, 
Ëv–
)

1181 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

1182 
Ch¬aù”
 *
tmp_viù
, *
Ï¡_viù
, *
Ãxt_viù
;

1183 
boŞ
 
found
;

1184 
dam
;

1185 
	schaš_ty³
 {

1186 
¡¬t_damage
;

1187 
»bound_damage
;

1188 
–em_ty³
;

1189 *
¡¬t_msg_nÙviù
;

1190 *
¡¬t_msg_ch¬
;

1191 *
¡¬t_msg_viù
;

1192 *
»bound_msg_room
;

1193 *
»bound_msg_viù
;

1194 *
fizzË_msg_room
;

1195 *
fizzË_msg_ch¬
;

1196 *
doh_msg_room
;

1197 *
doh_msg_ch¬
;

1199 cÚ¡ 
chaš_ty³
 
chaš_bË
[] = {

1201 6, 6, 
DAM_ELECTRICITY
,

1214 8, 12, 
DAM_COLD
,

1227 8, 12, 
DAM_ACID
,

1240 12, 12, 
DAM_FIRE
,

1252 
	`aù
(
chaš_bË
[
ty³
].
¡¬t_msg_nÙviù
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

1253 
	`aù
(
chaš_bË
[
ty³
].
¡¬t_msg_ch¬
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1254 
	`aù
(
chaš_bË
[
ty³
].
¡¬t_msg_viù
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

1255 
dam
 = 
	`diû
(
Ëv–
, 
chaš_bË
[
ty³
].
¡¬t_damage
);

1257 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
chaš_bË
[
ty³
].
–em_ty³
))

1258 
dam
 /= 3;

1260 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
chaš_bË
[
ty³
].
–em_ty³
, 
Œue
,rue);

1261 
Ï¡_viù
 = 
viùim
;

1262 
Ëv–
 -= 4;

1265 
Ëv–
 > 0) {

1266 
found
 = 
çl£
;

1268 
tmp_viù
 = 
ch
->
š_room
->
³İË
;mp_viù !ğ
nuÎ±r
;mp_viù = 
Ãxt_viù
) {

1269 
Ãxt_viù
 = 
tmp_viù
->
Ãxt_š_room
;

1271 ià(!
	`is_§me_group
(
tmp_viù
, 
ch
)

1272 && !
	`is_§ã
(
ch
, 
tmp_viù
, 
çl£
)

1273 && !
	`is_§ã_¥–l
(
ch
, 
tmp_viù
, 
Œue
)

1274 && 
tmp_viù
 !ğ
Ï¡_viù
) {

1275 
found
 = 
Œue
;

1276 
Ï¡_viù
 = 
tmp_viù
;

1277 
	`aù
(
chaš_bË
[
ty³
].
»bound_msg_room
, 
tmp_viù
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1278 
	`aù
(
chaš_bË
[
ty³
].
»bound_msg_viù
, 
tmp_viù
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

1279 
dam
 = 
	`diû
(
Ëv–
, 
chaš_bË
[
ty³
].
»bound_damage
);

1281 ià(
	`§ves_¥–l
(
Ëv–
, 
tmp_viù
, 
chaš_bË
[
ty³
].
–em_ty³
))

1282 
dam
 /= 3;

1284 
	`damage
(
ch
, 
tmp_viù
, 
dam
, 
¢
, -1, 
chaš_bË
[
ty³
].
–em_ty³
, 
Œue
,rue);

1285 
Ëv–
 -= 4;

1289 ià(!
found
) {

1290 ià(
ch
 =ğ
nuÎ±r
)

1293 ià(
Ï¡_viù
 =ğ
ch
) {

1294 
	`aù
(
chaš_bË
[
ty³
].
fizzË_msg_room
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1295 
	`aù
(
chaš_bË
[
ty³
].
fizzË_msg_ch¬
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

1299 
Ï¡_viù
 = 
ch
;

1300 
	`aù
(
chaš_bË
[
ty³
].
doh_msg_room
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1301 
	`aù
(
chaš_bË
[
ty³
].
doh_msg_ch¬
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

1302 
dam
 = 
	`diû
(
Ëv–
, 
chaš_bË
[
ty³
].
»bound_damage
);

1304 ià(
	`§ves_¥–l
(
Ëv–
, 
ch
, 
chaš_bË
[
ty³
].
–em_ty³
))

1305 
dam
 /= 3;

1307 
	`damage
(
ch
, ch, 
dam
, 
¢
, -1, 
chaš_bË
[
ty³
].
–em_ty³
, 
Œue
,rue);

1308 
Ëv–
 -= 4;

1310 ià(
ch
 =ğ
nuÎ±r
)

1314 
	}
}

1316 
	$¥–l_chaš_lighŠšg
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1318 
	`chaš_¥–l
(
ch
, 
vo
, 
¢
, 0, 
Ëv–
);

1319 
	}
}

1321 
	$¥–l_blizz¬d
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1323 
	`chaš_¥–l
(
ch
, 
vo
, 
¢
, 1, 
Ëv–
);

1324 
	}
}

1326 
	$¥–l_acid_¿š
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1328 
	`chaš_¥–l
(
ch
, 
vo
, 
¢
, 2, 
Ëv–
);

1329 
	}
}

1331 
	$¥–l_fœe¡Üm
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1333 
	`chaš_¥–l
(
ch
, 
vo
, 
¢
, 3, 
Ëv–
);

1334 
	}
}

1336 
	$¥–l_buºšg_hªds
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1338 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

1339 
dam
;

1340 cÚ¡ 
dam_—ch
[] = {

1348 
Ëv–
 = 
¡d
::
	`mš
Öev–, ()((
dam_—ch
) / (dam_each[0])) - 1);

1349 
Ëv–
 = 
¡d
::
	`max
(0,†evel);

1350 
dam
 = 
	`numb”_¿nge
(
dam_—ch
[
Ëv–
] / 2, dam_each[level] * 2);

1352 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_FIRE
))

1353 
dam
 /= 2;

1355 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_FIRE
, 
Œue
,rue);

1357 
	}
}

1359 
	$¥–l_dazzlšg_light
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1361 
Objeù
 *
obj
 = (Objeù *è
vo
;

1362 
add
, 
dur
, 
i
;

1366 ià(
ch
 =ğ
vo
)

1369 ià(
obj
->
™em_ty³
 !ğ
ITEM_LIGHT
) {

1370 
	`¡c
("Thi ¥–ÈÿÀÚlyƒnhªû†ighˆsourûs.\n", 
ch
);

1374 ià(
obj
->
w—r_loc
 !ğ-1 || obj->
ÿ¼›d_by
 =ğ
nuÎ±r
) {

1375 
	`¡c
("Thlighˆmu¡ bš you¸šv’tÜy.\n", 
ch
);

1379 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
dazzlšg_light
)) {

1380 
	`¡c
("Th©†ighˆi ®»ady qu™dazzlšg.\n", 
ch
);

1384 
	`aù
("$°shše brighˆ’oughØŒªsfix you¸’em›s!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1385 
	`aù
("$°shše fÜth w™h‡Àštimid©šg dazzË.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1386 
dur
 = 
	`numb”_³rûÁ
(è+ (
Ëv–
 / 2);

1387 
add
 = 0;

1389 
i
 = 0; i < 5; i++) {

1390 ià(
	`numb”_³rûÁ
(è<ğ
Ëv–
)

1391 
add
++;

1394 
afãù
::
Afãù
 
af
;

1395 
af
.
wh”e
 = 
TO_OBJECT
;

1396 
af
.
ty³
 = 
afãù
::ty³::
dazzlšg_light
;

1397 
af
.
Ëv–
 =†evel;

1398 
af
.
du¿tiÚ
 = 
dur
;

1399 
af
.
loÿtiÚ
 = 
APPLY_HITROLL
;

1400 
af
.
modif›r
 = 
add
;

1401 
af
.
	`b™veùÜ
(0);

1402 
af
.
evŞutiÚ
 =ƒvolution;

1403 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

1405 
af
.
loÿtiÚ
 = 
APPLY_DAMROLL
;

1406 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

1407 
	}
}

1409 
	$¥–l_light_of_Œuth
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1411 
Objeù
 *
obj
 = (Objeù *è
vo
;

1415 ià(
ch
 =ğ
vo
)

1418 ià(
obj
->
™em_ty³
 !ğ
ITEM_LIGHT
) {

1419 
	`¡c
("Thi ¥–ÈÚlyƒnhªû lighˆsourûs.\n", 
ch
);

1423 ià(
obj
->
w—r_loc
 !ğ-1 || obj->
ÿ¼›d_by
 =ğ
nuÎ±r
) {

1424 
	`¡c
("Thlighˆmu¡ bš you¸šv’tÜy.\n", 
ch
);

1430 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…af;…aàğ·f->
Ãxt
) {

1431 ià(
·f
->
³rmª’t
 ||…af->
du¿tiÚ
 == -1)

1434 ià(
·f
->
ty³
 =ğ
afãù
::ty³::
d‘eù_magic


1435 || 
·f
->
ty³
 =ğ
afãù
::ty³::
d‘eù_ev


1436 || 
·f
->
ty³
 =ğ
afãù
::ty³::
d‘eù_good


1437 || 
·f
->
ty³
 =ğ
afãù
::ty³::
d‘eù_švis


1438 || 
·f
->
ty³
 =ğ
afãù
::ty³::
d‘eù_hidd’
) {

1439 
	`¡c
("Th©†ighˆi ®»ady somewh©ƒnhªûd.\n", 
ch
);

1444 
afãù
::
Afãù
 
af
;

1445 
af
.
wh”e
 = 
TO_AFFECTS
;

1446 
af
.
Ëv–
 =†evel;

1447 
af
.
du¿tiÚ
 = 
Ëv–
;

1448 
af
.
loÿtiÚ
 = 0;

1449 
af
.
modif›r
 = 0;

1450 
af
.
	`b™veùÜ
(0);

1451 
af
.
evŞutiÚ
 =ƒvolution;

1453 
Ë¬Ãd
 = 
	`g‘_skl_Ëv–
(
ch
, 
¢
);

1455 ià((
	`numb”_³rûÁ
(è+ 5è< 
Ë¬Ãd
) {

1456 
af
.
ty³
 = 
afãù
::ty³::
d‘eù_ev
;

1457 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

1458 
	`aù
("$°throw ¨»d‡u¿‡round you¸ev su¼oundšgs.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1461 ià((
	`numb”_³rûÁ
(è+ 5è< 
Ë¬Ãd
) {

1462 
af
.
ty³
 = 
afãù
::ty³::
d‘eù_good
;

1463 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

1464 
	`aù
("$°show you goodhšg w™h‡ gŞd’‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1467 ià((
	`numb”_³rûÁ
(è+ 15è< 
Ë¬Ãd
) {

1468 
af
.
ty³
 = 
afãù
::ty³::
d‘eù_švis
;

1469 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

1470 
	`aù
("$°sudd’ly„ev—l švisibË objeùs!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1473 ià((
	`numb”_³rûÁ
(è+ 15è< 
Ë¬Ãd
) {

1474 
af
.
ty³
 = 
afãù
::ty³::
d‘eù_hidd’
;

1475 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

1476 
	`aù
("$°shše štØev”y‚ook‡nd c¿Ây‡bouˆyou.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1479 ià((
	`numb”_³rûÁ
(è+ 25è< 
Ë¬Ãd
) {

1480 
af
.
ty³
 = 
afãù
::ty³::
d‘eù_magic
;

1481 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

1482 
	`aù
("$°»æeù ¡¿ng–y ofàsomoàyou¸b‘‹¸equm’t.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1484 
	}
}

1486 
	$¥–l_ÿÎ_lighŠšg
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1488 
dam
;

1490 ià(!
	`IS_OUTSIDE
(
ch
)) {

1491 
	`¡c
("You mu¡ bouˆoàdoÜs.\n", 
ch
);

1495 ià(
Game
::
	`wÜld
().
w—th”
.
sky
 < 
W—th”
::
Raššg
) {

1496 
	`¡c
("You‚“d bad w—th”.\n", 
ch
);

1500 
dam
 = 
	`diû
(
Ëv–
 / 2, 8);

1501 
	`¡c
("H—v’' lighŠšg sŒike you¸fÛs!\n", 
ch
);

1502 
	`aù
("$ÀÿÎ h—v’' lighŠšgØ¡rik$ fÛs!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1504 autØ
vch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

1505 ià(
vch
->
š_room
 =ğ
nuÎ±r
)

1508 ià(
vch
->
š_room
 =ğ
ch
->in_room) {

1509 ià(
vch
 !ğ
ch
)

1510 
	`damage
(
ch
, 
vch
, 
	`§ves_¥–l
(
Ëv–
, vch, 
DAM_ELECTRICITY
è? 
dam
 / 2 : dam,

1511 
¢
, -1, 
DAM_ELECTRICITY
, 
Œue
,rue);

1516 ià(
vch
->
š_room
->
	`¬—
(è=ğ
ch
->š_room->¬—(è&& 
	`IS_OUTSIDE
(vchè&& 
	`IS_AWAKE
(vch))

1517 
	`¡c
("LighŠšg fÏshe šhsky.\n", 
vch
);

1519 
	}
}

1521 
	$¥–l_ÿlm
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1523 
Ch¬aù”
 *
vch
;

1524 
mËv–
 = 0;

1525 
couÁ
 = 0;

1526 
high_Ëv–
 = 0;

1527 
chªû
;

1528 
boŞ
 
çu»
 = 
çl£
;

1531 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = vch->
Ãxt_š_room
) {

1532 ià(
vch
->
fightšg
) {

1533 
couÁ
++;

1535 ià(
vch
->
	`is_Åc
())

1536 
mËv–
 +ğ
vch
->
Ëv–
;

1538 
mËv–
 +ğ
vch
->
Ëv–
 / 2;

1540 
high_Ëv–
 = 
¡d
::
	`max
(high_Ëv–, 
vch
->
Ëv–
);

1545 
chªû
 = 4 * 
Ëv–
 - 
high_Ëv–
 + 2 * 
couÁ
;

1547 ià(!
	`IS_IMMORTAL
(
ch
)) {

1548 ià(
	`numb”_¿nge
(0, 
chªû
è< 
mËv–
)

1549 
çu»
 = 
Œue
;

1551 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = vch->
Ãxt_š_room
) {

1552 ià(
vch
->
	`is_Åc
()

1553 && (
	`GET_DEFENSE_MOD
(
vch
, 
DAM_CHARM
) >= 100

1554 || 
vch
->
aù_æags
.
	`has
(
ACT_UNDEAD
)))

1555 
çu»
 = 
Œue
;

1556 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
vch
,‡fãù::
ty³
::
ÿlm
)

1557 || 
afãù
::
	`exi¡s_Ú_ch¬
(
vch
,‡fãù::
ty³
::
b”£rk
)

1558 || 
afãù
::
	`exi¡s_Ú_ch¬
(
vch
,‡fãù::
ty³
::
ä’zy
))

1559 
çu»
 = 
Œue
;

1564 ià(
çu»
) {

1565 ià(
couÁ
 == 0)

1566 
	`¡c
("You¸¥–Èaccom¶ishe nÙhšg.\n", 
ch
);

1568 
	`¡c
("YouryØÿlmho£…»£Á buˆnobody…ay ©‹ÁiÚØyou.\n", 
ch
);

1573 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = vch->
Ãxt_š_room
) {

1574 
	`¡c
("A wavoàÿlm…as£ ov” you.\n", 
vch
);

1576 ià(
vch
->
fightšg
)

1577 
	`¡İ_fightšg
(
vch
, 
çl£
);

1579 
afãù
::
	`add_ty³_to_ch¬
(
vch
,

1580 
afãù
::
ty³
::
ÿlm
,

1581 
Ëv–
,

1582 
Ëv–
/4,

1583 
evŞutiÚ
,

1584 
çl£


1587 
	}
}

1589 
	$¥–l_ÿnûÎ©iÚ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1591 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

1592 
Ëv–
 += 2;

1594 ià((!
ch
->
	`is_Åc
(è&& 
viùim
->is_Åc(è&& !(
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 == victim))

1595 || (!
viùim
->
	`is_Åc
(è&& 
ch
 != victim)) {

1596 
	`¡c
("You faed,ry di¥– magic.\n", 
ch
);

1600 ià(
	`di¥–_ch¬
(
viùim
, 
Ëv–
, 
Œue
))

1601 
	`¡c
("Ok.\n", 
ch
);

1603 
	`¡c
("S³Î faed.\n", 
ch
);

1604 
	}
}

1606 
	$¥–l_ÿu£_light
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1608 
	`damage
(
ch
, (
Ch¬aù”
 *è
vo
, (
	`diû
(
Ëv–
 / 3, 4è+ (Ëv– / 2)), 
¢
, -1, 
DAM_HARM
, 
Œue
,rue);

1609 
	}
}

1611 
	$¥–l_ÿu£_ü™iÿl
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1613 
	`damage
(
ch
, (
Ch¬aù”
 *è
vo
, (
	`diû
(
Ëv–
 / 3, 10è+ (Ëv– * 3 / 2)), 
¢
, -1, 
DAM_HARM
, 
Œue
,rue);

1614 
	}
}

1616 
	$¥–l_ÿu£_£rious
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1618 
	`damage
(
ch
, (
Ch¬aù”
 *è
vo
, (
	`diû
(
Ëv–
 / 3, 6è+†ev–), 
¢
, -1, 
DAM_HARM
, 
Œue
,rue);

1619 
	}
}

1621 
	$¥–l_chªge_£x
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1623 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

1625 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
chªge_£x
)) {

1626 ià(
viùim
 =ğ
ch
)

1627 
	`¡c
("You'v®»ady b“Àchªged.\n", 
ch
);

1629 
	`aù
("$N ha ®»ady had $S sex chªged.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1634 ià(
	`§ves_¥–l
(
Ëv–
 , 
viùim
, 
DAM_OTHER
)) {

1635 ià(
viùim
 =ğ
ch
)

1636 
	`¡c
("P”h­ agaš¡ you¸wishes, you savyour£làäom you¸¥–l.\n", 
ch
);

1638 
	`aù
("Th¡»ngth oà$N' ³rsÚ®™y save $M from you¸¥–l.\n", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1643 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

1644 
afãù
::
ty³
::
chªge_£x
,

1645 
Ëv–
,

1646 
Ëv–
 * 3,

1647 
evŞutiÚ
,

1648 
çl£


1651 
	`¡c
("You f“Èdifã»Á.\n", 
viùim
);

1652 
	`aù
("$ÀdÛ¢'ˆlook†ik$m£làªymÜe...", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1654 
	}
}

1657 
	$¥–l_chªÃl
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1659 
Ch¬aù”
 *
viùim
;

1660 
amouÁ
, 
max
;

1662 
SŒšg
 
ÿmouÁ
;

1663 
rg‘_Çme
 = 
	`Úe_¬gum’t
Ñ¬g‘_Çme, 
ÿmouÁ
);

1665 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

1666 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

1670 
amouÁ
 = 
	`©oi
(
ÿmouÁ
);

1671 
max
 = ((
	`GET_ATTR_STR
(
ch
è+ 
	`GET_ATTR_CON
(ch)) * 5);

1673 ià((
amouÁ
 <ğ0è|| (
ch
 =ğ
viùim
)) {

1674 
	`¡c
("Buˆthãedback would kÈyou!!\n", 
ch
);

1678 ià((
amouÁ
 > 
max
è|| (2 *‡mouÁ > 
ch
->
mªa
)) {

1679 
	`¡c
("You‡»oØd¿šedØchªÃÈth© much…ow”.\n", 
ch
);

1683 ià(
viùim
->
mªa
 < 31000)

1684 
viùim
->
mªa
 +ğ
amouÁ
;

1686 
ch
->
mªa
 -ğ(2 * 
amouÁ
);

1688 
afãù
::
	`add_ty³_to_ch¬
(
ch
,

1689 
afãù
::
ty³
::
chªÃl
,

1690 
Ëv–
,

1691 
Ëv–
 / 10,

1692 
evŞutiÚ
,

1693 
çl£


1696 
	`¡c
("RawƒÃrgyšgË © you¸fšg”ts!\n", 
viùim
);

1697 
	`¡c
("You f“Èd¿šed‡ you chªÃÈyou¸liãƒÃrgy.\n", 
ch
);

1698 
	}
}

1701 
	$¥–l_ch¬m_³rsÚ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1703 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

1705 ià(
viùim
 =ğ
ch
) {

1706 
	`¡c
("You†ikyour£làev’ b‘‹r!\n", 
ch
);

1710 ià(
	`g‘_pos™iÚ
(
viùim
è< 
POS_RESTING
) {

1711 
	`¡c
("Buˆthey†ook sØ³aûful...\n", 
ch
);

1715 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
)) {

1716 
	`¡c
("You‡» ch¬med your£lf,‡ndhu uÇbËØch¬m oth”s.\n", 
ch
);

1720 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ch¬m_³rsÚ
)) {

1721 
	`aù
("$E i ®»ady ch¬med,h”i nÙhšg mÜyou cª do!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1725 
def
 = 
	`GET_DEFENSE_MOD
(
viùim
, 
DAM_CHARM
);

1727 ià(!
	`IS_IMMORTAL
(
ch
)) {

1728 ià(!
viùim
->
	`is_Åc
()) {

1729 
	`¡c
("You cªnÙ ca¡hi ¥–ÈÚ…Ïy”s.\n", 
ch
);

1733 ià(
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_LAW
)) {

1734 
	`¡c
("ThmayÜ dÛ nÙ‡Îow ch¬mšg iÀthc™y†im™s.\n", 
ch
);

1738 ià(
	`is_§ã
(
ch
, 
viùim
, 
Œue
è|| 
def
 >= 100) {

1739 
	`aù
("$N scoff © you¸©‹m±Øch¬m $M.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1744 ià(
	`numb”_³rûÁ
(è< (
	`GET_ATTR_CHR
(
ch
) * 3))

1745 
Ëv–
 += 3;

1747 ià(
Ëv–
 < 
viùim
->Ëv– || 
	`§ves_¥–l
Öev–, viùim, 
DAM_CHARM
)) {

1748 
	`aù
("$E dÛ nÙ succumbØyou¸ch¬m.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1752 ià(
viùim
->
ma¡”
)

1753 
	`¡İ_fŞlow”
(
viùim
);

1755 
	`add_fŞlow”
(
viùim
, 
ch
);

1756 
viùim
->
Ëad”
 = 
ch
;

1758 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

1759 
afãù
::
ty³
::
ch¬m_³rsÚ
,

1760 
Ëv–
,

1761 
	`numb”_fuzzy
(
Ëv–
 / 4),

1762 
evŞutiÚ
,

1763 
çl£


1766 
	`aù
("I¢'ˆ$Àju¡ sØniû?", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

1767 
	`aù
("$N†ook © you w™h‡dÜšgƒyes.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1768 
	}
}

1770 
	$¥–l_chl_touch
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1772 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

1774 cÚ¡ 
dam_—ch
[] = {

1783 
Ëv–
 = 
¡d
::
	`mš
Öev–, ()((
dam_—ch
) / (dam_each[0])) - 1);

1784 
Ëv–
 = 
¡d
::
	`max
(0,†evel);

1785 
dam
 = 
	`numb”_¿nge
(
dam_—ch
[
Ëv–
] / 2, dam_each[level] * 2);

1787 ià(!
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_COLD
)) {

1788 
	`aù
("$Àtuº bluªd shiv”s.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1790 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

1791 
afãù
::
ty³
::
chl_touch
,

1792 
Ëv–
,

1794 
evŞutiÚ
,

1795 
çl£


1799 
dam
 /= 2;

1801 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_COLD
, 
Œue
,rue);

1802 
	}
}

1804 
	$¥–l_cŞour_¥¿y
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1806 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

1807 
dam
;

1808 cÚ¡ 
dam_—ch
[] = {

1816 
Ëv–
 = 
¡d
::
	`mš
Öev–, ()((
dam_—ch
) / (dam_each[0])) - 1);

1817 
Ëv–
 = 
¡d
::
	`max
(0,†evel);

1818 
dam
 = 
	`numb”_¿nge
(
dam_—ch
[
Ëv–
] / 2, dam_each[level] * 2);

1820 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_LIGHT
))

1821 
dam
 /= 2;

1823 
	`¥–l_blšdÃss
(
skl
::
ty³
::
blšdÃss
, 
Ëv–
 / 3, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

1825 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_LIGHT
, 
Œue
,rue);

1826 
	}
}

1828 
	$¥–l_cÚtšu®_light
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1830 
Objeù
 *
light
;

1832 ià(!
rg‘_Çme
.
	`em±y
()) {

1833 ià((
light
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
rg‘_Çme
)è=ğ
nuÎ±r
) {

1834 
	`¡c
("You dÚ'ˆ£th© h”e.\n", 
ch
);

1838 ià(
	`IS_OBJ_STAT
(
light
, 
ITEM_GLOW
)) {

1839 
	`aù
("$°i ®»ady glowšg.", 
ch
, 
light
, 
nuÎ±r
, 
TO_CHAR
);

1843 
light
->
exŒa_æags
 +ğ
ITEM_GLOW
;

1844 
	`aù
("$°glow w™h‡ wh™light.", 
ch
, 
light
, 
nuÎ±r
, 
TO_ALL
);

1848 
light
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_LIGHT_BALL
), 0);

1850 ià(! 
light
) {

1851 
Loggšg
::
	`bug
("Memoryƒrror in spell_continual_light.", 0);

1852 
	`¡c
("E¼Ü c»©šg†ighˆsourû.\n", 
ch
);

1856 
	`obj_to_room
(
light
, 
ch
->
š_room
);

1857 
	`aù
("$ÀtwiddË $ thumb ªd $°­³¬s.", 
ch
, 
light
, 
nuÎ±r
, 
TO_ROOM
);

1858 
	`aù
("YouwiddË you¸thumb ªd $°­³¬s.", 
ch
, 
light
, 
nuÎ±r
, 
TO_CHAR
);

1859 
	}
}

1861 
	$¥–l_cÚŒŞ_w—th”
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1863 ià(
rg‘_Çme
 == "better")

1864 
Game
::
	`wÜld
().
w—th”
.
chªge
 +ğ
	`diû
(
Ëv–
 / 3, 4);

1865 ià(
rg‘_Çme
 == "worse")

1866 
Game
::
	`wÜld
().
w—th”
.
chªge
 -ğ
	`diû
(
Ëv–
 / 3, 4);

1868 
	`¡c
("DØyou wªˆ™Øg‘ b‘‹¸Ü wÜ£?\n", 
ch
);

1870 
	`¡c
("Ok.\n", 
ch
);

1871 
	}
}

1873 
	$¥–l_ü—‹_food
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1875 
Objeù
 *
food
 = 
nuÎ±r
;

1876 
buf
[
MAX_STRING_LENGTH
];

1877 
ExŒaDesü
 *
ed
;

1878 
SŒšg
 
ty³
 = 
rg‘_Çme
;

1880 ià(
rg‘_Çme
.
	`em±y
()) {

1881 
	`numb”_¿nge
(0, 4)) {

1882 0: 
ty³
 = "a Magic Mushroom"; ;

1884 1: 
ty³
 = "a Slice of Pizza"; ;

1886 2: 
ty³
 = "a slice of burntoast"; ;

1888 3: 
ty³
 = "a delicious {Ycheesestick{x"; ;

1890 4: 
ty³
 = "a can of SPAM!!!"; ;

1894 
food
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
GEN_OBJ_FOOD
), 0);

1896 ià(! 
food
) {

1897 
Loggšg
::
	`bug
("Memoryƒrror creating food.", 0);

1898 
	`¡c
("You w”uÇbËØü—‹ food.\n", 
ch
);

1902 
food
->
shÜt_desü
 = 
ty³
;

1903 
FÜm©
::
	`¥rštf
(
buf
, "food %s", 
food
->
shÜt_desü
.
	`uncŞÜ
());

1904 
food
->
Çme
 = 
buf
;

1905 
FÜm©
::
	`¥rštf
(
buf
, "%s{x i lyšg oÀthground.", 
ty³
);

1906 
buf
[0] = 
	`touµ”
(buf[0]);

1907 
food
->
desütiÚ
 = 
buf
;

1908 
food
->
m©”Ÿl
 = "food";

1909 
FÜm©
::
	`¥rštf
(
buf
, "Thi food wa ü—‹d by %s.\n", 
ch
->
Çme
);

1910 
ed
 = 
Ãw
 
	`ExŒaDesü
("chef", 
buf
);

1911 
ed
->
Ãxt
 = 
food
->
exŒa_desü
;

1912 
food
->
exŒa_desü
 = 
ed
;

1913 
ed
 = 
Ãw
 
	`ExŒaDesü
("food", "It†ooks delicious.\n");

1914 
ed
->
Ãxt
 = 
food
->
exŒa_desü
;

1915 
food
->
exŒa_desü
 = 
ed
;

1916 
food
->
v®ue
[0] = 
Ëv–
 / 2;

1917 
food
->
v®ue
[1] = 
Ëv–
;

1918 
	`obj_to_room
(
food
, 
ch
->
š_room
);

1919 
	`aù
("$°sudd’ly‡µ—rs.", 
ch
, 
food
, 
nuÎ±r
, 
TO_ROOM
);

1920 
	`aù
("$°sudd’ly‡µ—rs.", 
ch
, 
food
, 
nuÎ±r
, 
TO_CHAR
);

1921 
	}
}

1923 
	$¥–l_ü—‹_ro£
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1925 
Objeù
 *
ro£
;

1926 
cŞÜ
[
MIL
];

1927 
buf
[
MAX_STRING_LENGTH
];

1928 
ExŒaDesü
 *
ed
;

1930 ià(
	`g‘_ÿ¼y_numb”
(
ch
è>ğ
	`ÿn_ÿ¼y_n
(ch)) {

1931 
	`aù
("You cª'ˆÿ¼y‡ny mÜ™ems.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

1935 ià(
	`g‘_ÿ¼y_weight
(
ch
è>ğ
	`ÿn_ÿ¼y_w
(ch)) {

1936 
	`aù
("You cª'ˆÿ¼y‡ny mÜweight.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

1940 ià(
rg‘_Çme
.
	`em±y
())

1941 
	`¡rıy
(
cŞÜ
, "red");

1943 
	`¡rıy
(
cŞÜ
, 
rg‘_Çme
);

1945 
ro£
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
GEN_OBJ_TREASURE
), 0);

1947 ià(! 
ro£
) {

1948 
Loggšg
::
	`bug
("Memoryƒrror creating‡„ose.", 0);

1949 
	`¡c
("You w”uÇbËØü—‹‡„o£.\n", 
ch
);

1953 
	`±c
(
ch
, "You havü—‹d‡ b—utifuÈ%s{x„o£.\n", 
cŞÜ
);

1954 
FÜm©
::
	`¥rštf
(
buf
, "% ha ü—‹d‡ b—utifuÈ%s{x„o£.", 
ch
->
Çme
, 
cŞÜ
);

1955 
	`aù
(
buf
, 
ch
, 
ro£
, 
nuÎ±r
, 
TO_ROOM
);

1956 
FÜm©
::
	`¥rštf
(
buf
, "¨%s{x„o£", 
cŞÜ
);

1957 
ro£
->
shÜt_desü
 = 
buf
;

1958 
FÜm©
::
	`¥rštf
(
buf
, "A %s{x„o£ i lyšg oÀthground.", 
cŞÜ
);

1959 
ro£
->
desütiÚ
 = 
buf
;

1960 
ro£
->
m©”Ÿl
 = "silk";

1961 
ro£
->
Çme
 = "rose";

1962 
FÜm©
::
	`¥rštf
(
buf
, "Thi ro£ wa ü—‹d by %s.\n", 
ch
->
Çme
);

1963 
ed
 = 
Ãw
 
	`ExŒaDesü
("æÜi¡", 
buf
);

1964 
ed
->
Ãxt
 = 
ro£
->
exŒa_desü
;

1965 
ro£
->
exŒa_desü
 = 
ed
;

1966 
ed
 = 
Ãw
 
	`ExŒaDesü
("rose", "It's‡ beautiful„ose, with‡ soft‡nd„omantic fragrance.\n");

1967 
ed
->
Ãxt
 = 
ro£
->
exŒa_desü
;

1968 
ro£
->
exŒa_desü
 = 
ed
;

1969 
ro£
->
v®ue
[1] = 1;

1970 
	`obj_to_ch¬
(
ro£
, 
ch
);

1971 
	}
}

1974 
	$¥–l_’ÿmpm’t
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1976 
Objeù
 *
ÿmp
;

1977 
ÿmp
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_CAMP
), 0);

1979 ià(! 
ÿmp
) {

1980 
Loggšg
::
	`bug
("Memoryƒrror creating‡nƒncampment.", 0);

1981 
	`¡c
("You w”nÙ‡bËØü—‹‡À’ÿmpm’t.\n", 
ch
);

1985 
ÿmp
->
tim”
 = 
Ëv–
;

1986 
	`obj_to_room
(
ÿmp
, 
ch
->
š_room
);

1987 
	`aù
("$Àha ü—‹d‡’ˆäom…u»ƒÃrgy.", 
ch
, 
ÿmp
, 
nuÎ±r
, 
TO_ROOM
);

1988 
	`¡c
("You c»©¨sm®È‹Á fromƒÃrgy.\n", 
ch
);

1989 
	}
}

1992 
	$¥–l_ü—‹_sign
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

1994 
Objeù
 *
sign
;

1995 
buf
[
MAX_STRING_LENGTH
];

1996 
ExŒaDesü
 *
ed
, *
owÃr
;

1997 
sign
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_SIGN
), 0);

1999 ià(! 
sign
) {

2000 
Loggšg
::
	`bug
("Memoryƒrrorryingo create sign.", 0);

2001 
	`¡c
("You w”uÇbËØü—‹‡ sign.\n", 
ch
);

2005 
	`aù
("$Àha ü—‹d‡„ßd sign.", 
ch
, 
sign
, 
nuÎ±r
, 
TO_ROOM
);

2006 
	`¡c
("You c»©¨rßd sign.\n", 
ch
);

2007 
	`obj_to_room
(
sign
, 
ch
->
š_room
);

2008 
sign
->
tim”
 = 
Ëv–
 * 2;

2010 ià(
rg‘_Çme
.
	`em±y
()) {

2011 
	`¡c
("You faedØšşudwÜd tØwr™Úhsign.\n", 
ch
);

2015 
FÜm©
::
	`¥rštf
(
buf
, "%s\n", 
rg‘_Çme
);

2016 
ed
 = 
Ãw
 
	`ExŒaDesü
("sign", 
buf
);

2017 
ed
->
Ãxt
 = 
sign
->
exŒa_desü
;

2018 
sign
->
exŒa_desü
 = 
ed
;

2019 
FÜm©
::
	`¥rštf
(
buf
, "Thi rßd sigÀwa ü—‹d by %s.\n", 
ch
->
Çme
);

2020 
owÃr
 = 
Ãw
 
	`ExŒaDesü
("ÿ½’‹r", 
buf
);

2021 
owÃr
->
Ãxt
 = 
sign
->
exŒa_desü
;

2022 
sign
->
exŒa_desü
 = 
owÃr
;

2023 
	}
}

2026 
	$¥–l_ü—‹_vŸl
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2028 
Objeù
 *
vŸl
;

2030 ià(
	`g‘_ÿ¼y_numb”
(
ch
è>ğ
	`ÿn_ÿ¼y_n
(ch)) {

2031 
	`aù
("You cª'ˆÿ¼y‡ny mÜ™ems.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

2035 ià(
	`g‘_ÿ¼y_weight
(
ch
è>ğ
	`ÿn_ÿ¼y_w
(ch)) {

2036 
	`aù
("You cª'ˆÿ¼y‡ny mÜweight.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

2040 
vŸl
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_VIAL
), 0);

2042 ià(! 
vŸl
) {

2043 
Loggšg
::
	`bug
("Memoryƒrror creating vial.", 0);

2044 
	`¡c
("You w”uÇbËØü—‹‡ vŸl.\n", 
ch
);

2048 
	`aù
("$Àha ü—‹d‡ magiÿÈvŸl.", 
ch
, 
vŸl
, 
nuÎ±r
, 
TO_ROOM
);

2049 
	`¡c
("You c»©¨vŸÈfÜ b»wšg…ÙiÚs.\n", 
ch
);

2050 
	`obj_to_ch¬
(
vŸl
, 
ch
);

2052 
	}
}

2055 
	$¥–l_ü—‹_·rchm’t
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2057 
Objeù
 *
·rch
;

2059 ià(
	`g‘_ÿ¼y_numb”
(
ch
è>ğ
	`ÿn_ÿ¼y_n
(ch)) {

2060 
	`aù
("You cª'ˆÿ¼y‡ny mÜ™ems.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

2064 ià(
	`g‘_ÿ¼y_weight
(
ch
è>ğ
	`ÿn_ÿ¼y_w
(ch)) {

2065 
	`aù
("You cª'ˆÿ¼y‡ny mÜweight.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

2069 
·rch
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_PARCH
), 0);

2071 ià(! 
·rch
) {

2072 
Loggšg
::
	`bug
("Memoryƒrrorryingo create…archment.", 0);

2073 
	`¡c
("You w”uÇbËØü—‹…¬chm’t.\n", 
ch
);

2077 
	`aù
("$Àha ü—‹d‡ magiÿÈ·rchm’t.", 
ch
, 
·rch
, 
nuÎ±r
, 
TO_ROOM
);

2078 
	`¡c
("You c»©¨·rchm’ˆfÜ süibšg süŞls.\n", 
ch
);

2079 
	`obj_to_ch¬
(
·rch
, 
ch
);

2081 
	}
}

2083 
	$¥–l_ü—‹_¥ršg
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2085 
Objeù
 *
¥ršg
;

2086 
¥ršg
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_SPRING
), 0);

2089 ià(! 
¥ršg
) {

2090 
Loggšg
::
	`bug
("Memoryƒrrorryingo create spring in spell_create_spring() in magic.", 0);

2091 
	`¡c
("You‡» uÇbËØü—‹‡ s´šg.\n", 
ch
);

2095 
¥ršg
->
tim”
 = 
Ëv–
;

2096 
	`obj_to_room
(
¥ršg
, 
ch
->
š_room
);

2097 
	`aù
("$°æow äomhground.", 
ch
, 
¥ršg
, 
nuÎ±r
, 
TO_ROOM
);

2098 
	`aù
("$°æow äomhground.", 
ch
, 
¥ršg
, 
nuÎ±r
, 
TO_CHAR
);

2100 
	}
}

2102 
	$¥–l_ü—‹_w©”
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2104 
Objeù
 *
obj
 = (Objeù *è
vo
;

2107 ià(
ch
 =ğ
vo
)

2110 ià(
obj
->
™em_ty³
 !ğ
ITEM_DRINK_CON
) {

2111 
	`¡c
("Iˆi uÇbËØhŞd w©”.\n", 
ch
);

2115 ià(
obj
->
v®ue
[2] !ğ
LIQ_WATER
 && obj->value[1] != 0) {

2116 
	`¡c
("IˆcÚš somÙh”†iquid.\n", 
ch
);

2120 
muÉl›r
 = 
Game
::
	`wÜld
().
w—th”
.
sky
 >ğ
W—th”
::
Raššg
 ? 4 : 2;

2121 
w©”
 = 
¡d
::
	`mš
(
Ëv–
 * 
muÉl›r
, 
obj
->
v®ue
[0].
	`v®ue
() - obj->value[1].value());

2123 ià(
w©”
 > 0) {

2124 
obj
->
v®ue
[2] = 
LIQ_WATER
;

2125 
obj
->
v®ue
[1] +ğ
w©”
;

2127 ià(!
obj
->
Çme
.
	`has_wÜds
("water")) {

2128 
buf
[
MAX_STRING_LENGTH
];

2129 
FÜm©
::
	`¥rštf
(
buf
, "% w©”", 
obj
->
Çme
);

2130 
obj
->
Çme
 = 
buf
;

2133 
	`aù
("$°i fËd.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2135 
	}
}

2137 
	$¥–l_cu»_blšdÃss
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2139 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2141 ià(!
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
blšdÃss
)) {

2142 ià(
viùim
 =ğ
ch
)

2143 
	`¡c
("You‡»n'ˆblšd.\n", 
ch
);

2145 
	`aù
("$N dÛ¢'ˆ­³¬Øbblšded.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2150 ià(!
	`check_di¥–_ch¬
(
Ëv–
, 
viùim
, 
afãù
::
ty³
::
blšdÃss
, 
çl£
))

2151 
	`¡c
("S³Î faed.\n", 
ch
);

2152 
	}
}

2154 
	$¥–l_cu»_light
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2156 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2157 
h™
 = 
¡d
::
	`mš
(
viùim
->h™ + (
	`diû
(1, 8è+ 
Ëv–
 / 3), 
	`GET_MAX_HIT
(victim));

2159 ià(
	`GET_ATTR
(
viùim
, 
SET_CLERIC_DIVINE
) >= 2)

2160 
h™
 = hit + hit * 10/ 100;

2161 
viùim
->
h™
 = h™ + h™ * 
	`GET_ATTR
(viùim, 
APPLY_PRIESTESS_UNIQUE
) / 100;

2162 
	`upd©e_pos
(
viùim
);

2163 
	`¡c
("You f“Èb‘‹r!\n", 
viùim
);

2165 ià(
ch
 !ğ
viùim
)

2166 
	`¡c
("Ok.\n", 
ch
);

2167 
	}
}

2169 
	$¥–l_cu»_£rious
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2171 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2172 
h™
 = 
¡d
::
	`mš
(
viùim
->h™ + (
	`diû
(2, 8è+ 
Ëv–
 / 2), 
	`GET_MAX_HIT
(victim));

2174 ià(
	`GET_ATTR
(
viùim
, 
SET_CLERIC_DIVINE
) >= 2)

2175 
h™
 = hit + hit * 10/ 100;

2176 
viùim
->
h™
 = h™ + h™ * 
	`GET_ATTR
(viùim, 
APPLY_PRIESTESS_UNIQUE
) / 100;

2177 
	`upd©e_pos
(
viùim
);

2178 
	`¡c
("You f“Èb‘‹r!\n", 
viùim
);

2180 ià(
ch
 !ğ
viùim
)

2181 
	`¡c
("Ok.\n", 
ch
);

2182 
	}
}

2184 
	$¥–l_cu»_ü™iÿl
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2186 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2187 
h™
 = 
¡d
::
	`mš
(
viùim
->h™ + (
	`diû
(3, 8è+ 
Ëv–
 - 6), 
	`GET_MAX_HIT
(victim));

2189 ià(
	`GET_ATTR
(
viùim
, 
SET_CLERIC_DIVINE
) >= 2)

2190 
h™
 = hit + hit * 10/ 100;

2191 
viùim
->
h™
 = h™ + h™ * 
	`GET_ATTR
(viùim, 
APPLY_PRIESTESS_UNIQUE
) / 100;

2192 
	`upd©e_pos
(
viùim
);

2193 
	`¡c
("You f“Èb‘‹r!\n", 
viùim
);

2195 ià(
ch
 !ğ
viùim
)

2196 
	`¡c
("Ok.\n", 
ch
);

2197 
	}
}

2200 
	$¥–l_d¬kÃss
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2202 
Room
 *
room
;

2203 
afãù
::
Afãù
 
af
;

2205 ià((
room
 = 
ch
->
š_room
è=ğ
nuÎ±r
) {

2206 
	`¡c
("You fa.\n", 
ch
);

2210 ià(
ch
->
š_room
->
	`is_v”y_d¬k
()) {

2211 
	`¡c
("Throom could‚Ù…ossibly g‘‡ny d¬k”.\n", 
ch
);

2215 ià(
room
->
	`æags
().
	`has
(
ROOM_LAW
)) {

2216 
	`¡c
("ThmayÜ fÜbid usšghi ¥–Èšhc™y.\n", 
ch
);

2220 ià(
room
->
	`æags
().
	`has
(
ROOM_SAFE
)) {

2221 
	`¡c
("You cªnÙ u£hi ¥–Èš hŞy„ooms.\n", 
ch
);

2225 ià(
room
->
	`is_d¬k
())

2226 
	`¡c
("Thd¬kÃs d“³ns.\n", 
ch
);

2228 
	`¡c
("Inky bÏck d¬kÃs su¼ound you.\n", 
ch
);

2230 
af
.
wh”e
 = 
TO_ROOMFLAGS
;

2231 
af
.
ty³
 = 
afãù
::ty³::
d¬kÃss
;

2232 
af
.
Ëv–
 =†evel;

2233 
af
.
du¿tiÚ
 = 
Ëv–
 / 20;

2234 
af
.
loÿtiÚ
 = 0;

2235 
af
.
modif›r
 = 0;

2236 
af
.
	`b™veùÜ
(
ROOM_NOLIGHT
);

2237 
af
.
evŞutiÚ
 =ƒvolution;

2238 
afãù
::
	`cİy_to_room
(
room
, &
af
);

2239 
	}
}

2242 
	$¥–l_divše_h—lšg
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2244 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2245 
h™
 = 
¡d
::
	`mš
(
viùim
->h™ + (
	`diû
(15, 15è+ (
Ëv–
 * 2)), 
	`GET_MAX_HIT
(victim));

2247 ià(
	`GET_ATTR
(
viùim
, 
SET_CLERIC_DIVINE
) >= 2)

2248 
h™
 = hit + hit * 10/ 100;

2249 
viùim
->
h™
 = h™ + h™ * 
	`GET_ATTR
(viùim, 
APPLY_PRIESTESS_UNIQUE
) / 100;

2250 
	`upd©e_pos
(
viùim
);

2251 
	`¡c
("You f“Èmuch b‘‹r!\n", 
viùim
);

2253 ià(
ch
 !ğ
viùim
)

2254 
	`¡c
("Ok.\n", 
ch
);

2255 
	}
}

2257 
	$¥–l_cu»_di£a£
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2259 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2261 ià(!
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
¶ague
)) {

2262 ià(
viùim
 =ğ
ch
)

2263 
	`¡c
("You‡»n'ˆl.\n", 
ch
);

2265 
	`aù
("$N dÛ¢'ˆ­³¬Øbdi£a£d.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2270 ià(!
	`check_di¥–_ch¬
(
Ëv–
, 
viùim
, 
afãù
::
ty³
::
¶ague
, 
çl£
))

2271 
	`¡c
("S³Î faed.\n", 
ch
);

2272 
	}
}

2274 
	$¥–l_cu»_poisÚ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2276 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2278 ià(!
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
poisÚ
)) {

2279 ià(
viùim
 =ğ
ch
)

2280 
	`¡c
("You‡»n'ˆpoisÚed.\n", 
ch
);

2282 
	`aù
("$N dÛ¢'ˆ­³¬ØbpoisÚed.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2287 ià(
	`check_di¥–_ch¬
(
Ëv–
, 
viùim
, 
afãù
::
ty³
::
poisÚ
, 
çl£
)) {

2288 
	`¡c
("A w¬m f“lšg„un through you¸body.\n", 
viùim
);

2291 
	`¡c
("S³Î faed.\n", 
ch
);

2292 
	}
}

2294 
	$¥–l_cur£
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2296 
Ch¬aù”
 *
viùim
;

2297 
Objeù
 *
obj
;

2298 
afãù
::
Afãù
 
af
;

2301 ià(
rg‘
 =ğ
TARGET_OBJ
) {

2302 
obj
 = (
Objeù
 *è
vo
;

2304 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_EVIL
)) {

2305 
	`aù
("$°i ®»ady fËd w™hƒv.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2309 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
)) {

2311 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
bËss
))

2312 
	`check_di¥–_obj
(
Ëv–
, 
obj
, 
afãù
::
ty³
::
bËss
, 
Œue
);

2313 ià(!
	`Ëv–_§ve
(
Ëv–
, 
obj
->level))

2314 
obj
->
exŒa_æags
 -ğ
ITEM_BLESS
;

2316 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
))

2317 
	`aù
("ThhŞy‡u¿ oà$°i toØpow”fuÈfÜ youØov”come.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2319 
	`aù
("$°glow w™h‡„ed‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

2324 
af
.
wh”e
 = 
TO_OBJECT
;

2325 
af
.
ty³
 = 
afãù
::ty³::
cur£
;

2326 
af
.
Ëv–
 =†evel;

2327 
af
.
du¿tiÚ
 = 2 * 
Ëv–
;

2328 
af
.
loÿtiÚ
 = 
APPLY_SAVES
;

2329 
af
.
modif›r
 = +1;

2330 
af
.
	`b™veùÜ
(
ITEM_EVIL
);

2331 
af
.
evŞutiÚ
 =ƒvolution;

2332 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

2333 
	`aù
("$°glow w™h‡ m®evŞ’ˆau¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

2338 
viùim
 = (
Ch¬aù”
 *è
vo
;

2340 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
cur£
)) {

2341 ià(
ch
 =ğ
viùim
)

2342 
	`¡c
("You‡»‡Ì—dy cur£d. You dÚ'ˆÃed‡ doubË whammy.\n", 
ch
);

2344 
	`aù
("$N i ®»ady cur£d. You dÚ'ˆwªˆtØKILL $M, dØyou?", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2349 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_NEGATIVE
)) {

2350 ià(
ch
 =ğ
viùim
)

2351 
	`¡c
("S–f-p™y…rÙeù you from you¸owÀcur£.\n", 
ch
);

2353 
	`aù
("You¸¥–Èç tØ³ÃŒ©$N' magiÿÈdeãn£s.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2358 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

2359 
afãù
::
ty³
::
cur£
,

2360 
Ëv–
,

2361 
Ëv–
 * 2,

2362 
evŞutiÚ
,

2363 
çl£


2366 
	`¡c
("You f“Èunş—n.\n", 
viùim
);

2368 ià(
ch
 !ğ
viùim
)

2369 
	`aù
("$N†ook v”y uncomfÜbË.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2370 
	}
}

2372 
	$¥–l_demÚfœe
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2374 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2375 
dam
;

2376 
®ign
;

2378 ià(!
ch
->
	`is_Åc
(è&& !
	`IS_EVIL
(ch)) {

2379 
viùim
 = 
ch
;

2380 
	`¡c
("ThdemÚ tuº upÚ you!\n", 
ch
);

2383 ià(
ch
->
gud
 !ğ
Gud
::
·Ïdš
)

2384 
ch
->
®ignm’t
 = 
¡d
::
	`max
(-1000, ch->alignment - 50);

2386 ià(
viùim
 !ğ
ch
) {

2387 
	`aù
("$ÀÿÎ fÜthhdemÚ oàH–ÈupÚ $N!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_ROOM
);

2388 
	`aù
("$Àha as§ed you w™hhdemÚ oàH–l!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

2389 
	`¡c
("You cÚju» fÜthhdemÚ oàh–l!\n", 
ch
);

2392 
dam
 = 
	`diû
(
Ëv–
, 6);

2394 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_NEGATIVE
))

2395 
dam
 /= 2;

2397 
®ign
 = 
viùim
->
®ignm’t
;

2398 
®ign
 += 1200;

2399 
dam
 = (dam * 
®ign
) / 600;

2400 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_NEGATIVE
 , 
Œue
,rue);

2402 ià(
ch
->
fightšg
 !ğ
nuÎ±r
)

2403 
	`¥–l_cur£
(
skl
::
ty³
::
cur£
, 3 * 
Ëv–
 / 4, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

2404 
	}
}

2406 
	$¥–l_d‘eù_ev
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2408 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2410 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
d‘eù_ev
)) {

2411 ià(
viùim
 =ğ
ch
)

2412 
	`¡c
("You cª‡Ì—dy s’£ƒv.\n", 
ch
);

2414 
	`aù
("$N cª‡Ì—dy d‘eùƒv.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2419 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

2420 
afãù
::
ty³
::
d‘eù_ev
,

2421 
Ëv–
,

2422 
Ëv–
,

2423 
evŞutiÚ
,

2424 
çl£


2427 
	`¡c
("You¸eye tšgË.\n", 
viùim
);

2429 ià(
ch
 !ğ
viùim
)

2430 
	`¡c
("Ok.\n", 
ch
);

2431 
	}
}

2433 
	$¥–l_d‘eù_good
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2435 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2437 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
d‘eù_good
)) {

2438 ià(
viùim
 =ğ
ch
)

2439 
	`¡c
("You cª‡Ì—dy s’£ good.\n", 
ch
);

2441 
	`aù
("$N cª‡Ì—dy d‘eù good.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2446 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

2447 
afãù
::
ty³
::
d‘eù_good
,

2448 
Ëv–
,

2449 
Ëv–
,

2450 
evŞutiÚ
,

2451 
çl£


2454 
	`¡c
("You¸eye tšgË.\n", 
viùim
);

2456 ià(
ch
 !ğ
viùim
)

2457 
	`¡c
("Ok.\n", 
ch
);

2458 
	}
}

2460 
	$¥–l_d‘eù_hidd’
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2462 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2464 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
d‘eù_hidd’
)) {

2465 ià(
viùim
 =ğ
ch
)

2466 
	`¡c
("You‡»‡Ì—dy‡ ®”ˆa you cª be. \n", 
ch
);

2468 
	`aù
("$N cª‡Ì—dy s’£ hidd’†iãfÜms.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2473 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

2474 
afãù
::
ty³
::
d‘eù_hidd’
,

2475 
Ëv–
,

2476 
Ëv–
,

2477 
evŞutiÚ
,

2478 
çl£


2481 
	`¡c
("You¸aw¬’es im´oves.\n", 
viùim
);

2483 ià(
ch
 !ğ
viùim
)

2484 
	`¡c
("Ok.\n", 
ch
);

2485 
	}
}

2487 
	$¥–l_d‘eù_švis
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2489 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2491 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
d‘eù_švis
)) {

2492 ià(
viùim
 =ğ
ch
)

2493 
	`¡c
("You cª‡Ì—dy s“ invisibË.\n", 
ch
);

2495 
	`aù
("$N cª‡Ì—dy s“ invisibËhšgs.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2500 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

2501 
afãù
::
ty³
::
d‘eù_švis
,

2502 
Ëv–
,

2503 
Ëv–
,

2504 
evŞutiÚ
,

2505 
çl£


2508 
	`¡c
("You¸eye tšgË.\n", 
viùim
);

2510 ià(
ch
 !ğ
viùim
)

2511 
	`¡c
("Ok.\n", 
ch
);

2512 
	}
}

2514 
	$¥–l_d‘eù_magic
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2516 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2518 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
d‘eù_magic
)) {

2519 ià(
viùim
 =ğ
ch
)

2520 
	`¡c
("You cª‡Ì—dy s’£ magiÿÈau¿s.\n", 
ch
);

2522 
	`aù
("$N cª‡Ì—dy d‘eù magic.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2527 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

2528 
afãù
::
ty³
::
d‘eù_magic
,

2529 
Ëv–
,

2530 
Ëv–
,

2531 
evŞutiÚ
,

2532 
çl£


2535 
	`¡c
("You¸eye tšgË.\n", 
viùim
);

2537 ià(
ch
 !ğ
viùim
)

2538 
	`¡c
("Ok.\n", 
ch
);

2539 
	}
}

2541 
	$¥–l_d‘eù_poisÚ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2543 
Objeù
 *
obj
 = (Objeù *è
vo
;

2548 ià(
ch
 =ğ
vo
)

2551 ià(
obj
->
™em_ty³
 =ğ
ITEM_DRINK_CON
 || obj->™em_ty³ =ğ
ITEM_FOOD
) {

2552 ià(
obj
->
v®ue
[3] != 0)

2553 
	`¡c
("You sm–ÈpoisÚou fumes.\n", 
ch
);

2555 
	`¡c
("Iˆlook d–icious.\n", 
ch
);

2558 
	`¡c
("IˆdÛ¢'ˆlook…oisÚed.\n", 
ch
);

2559 
	}
}

2561 
	$¥–l_di¥–_ev
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2563 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2564 
buf
[
MAX_STRING_LENGTH
];

2565 
dam
;

2567 ià(!
ch
->
	`is_Åc
(è&& 
	`IS_EVIL
(ch))

2568 
viùim
 = 
ch
;

2570 ià(
	`IS_GOOD
(
viùim
)) {

2571 ià(!
viùim
->
	`is_Åc
()) {

2572 
	`±c
(
viùim
, "% ´Ùeù you.\n", viùim->
pcd©a
->
de™y
);

2573 
FÜm©
::
	`¥rštf
(
buf
, "% ´Ùeù $n.", 
viùim
->
pcd©a
->
de™y
);

2574 
	`aù
(
buf
, 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2577 
	`¡c
("Cyªo ´Ùeù you.\n", 
viùim
);

2578 
	`aù
("Cyªo ´Ùeù $n.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2584 ià(
	`IS_NEUTRAL
(
viùim
)) {

2585 
	`aù
("$N dÛ nÙ s“mØbafãùed.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2589 ià(
viùim
->
h™
 > (
ch
->
Ëv–
 * 4))

2590 
dam
 = 
	`diû
(
Ëv–
, 4);

2592 
dam
 = 
¡d
::
	`max
(
viùim
->
h™
, 
	`diû
(
Ëv–
, 4));

2594 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_HOLY
))

2595 
dam
 /= 2;

2597 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_HOLY
, 
Œue
,rue);

2598 
	}
}

2600 
	$¥–l_di¥–_good
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2602 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2603 
dam
;

2605 ià(!
ch
->
	`is_Åc
(è&& 
	`IS_GOOD
(ch))

2606 
viùim
 = 
ch
;

2608 ià(
	`IS_EVIL
(
viùim
)) {

2609 
	`aù
("$N i ´Ùeùed by $Sƒv.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_ROOM
);

2613 ià(
	`IS_NEUTRAL
(
viùim
)) {

2614 
	`aù
("$N dÛ nÙ s“mØbafãùed.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

2618 ià(
viùim
->
h™
 > (
ch
->
Ëv–
 * 4))

2619 
dam
 = 
	`diû
(
Ëv–
, 4);

2621 
dam
 = 
¡d
::
	`max
(
viùim
->
h™
, 
	`diû
(
Ëv–
, 4));

2623 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_NEGATIVE
))

2624 
dam
 /= 2;

2626 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_NEGATIVE
, 
Œue
,rue);

2627 
	}
}

2629 
	$¥–l_di¥–_magic
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2631 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

2633 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_OTHER
)) {

2634 
	`¡c
("You f“È¨br›àtšglšg s’§tiÚ.\n", 
viùim
);

2635 
	`¡c
("You faed.\n", 
ch
);

2639 ià(
	`di¥–_ch¬
(
viùim
, 
Ëv–
, 
çl£
)) {

2640 
	`¡c
("Ok.\n", 
ch
);

2643 
	`¡c
("S³Î faed.\n", 
ch
);

2644 
	}
}

2646 
	$¥–l_—¹hquake
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2648 
	`¡c
("Th—¹h»mbË b’—th you¸ã‘!\n", 
ch
);

2649 
	`aù
("$Àmake th—¹h»mbË‡nd shiv”.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2651 autØ
vch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

2652 ià(
vch
->
š_room
 =ğ
nuÎ±r
)

2655 ià(
vch
->
š_room
 =ğ
ch
->in_room) {

2656 ià(
vch
 !ğ
ch
 && !
	`is_§ã_¥–l
(ch, vch, 
Œue
)) {

2657 ià(
	`IS_FLYING
(
vch
))

2658 
	`damage
(
ch
, 
vch
, 0, 
¢
, -1, 
DAM_BASH
, 
Œue
,rue);

2660 
	`damage
(
ch
, 
vch
, 
Ëv–
 + 
	`diû
(2, 8), 
¢
, -1, 
DAM_BASH
, 
Œue
,rue);

2666 ià(
vch
->
š_room
->
	`¬—
(è=ğ
ch
->in_room->area())

2667 
	`¡c
("Th—¹h»mbË ªd shiv”s.\n", 
vch
);

2669 
	}
}

2672 
	$¥–l_shršk
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2674 
Objeù
 *
obj
 = (Objeù *è
vo
;

2675 
»suÉ
, 
ç
;

2678 ià(
ch
 =ğ
vo
)

2681 ià(
obj
->
w—r_loc
 !ğ-1 || obj->
ÿ¼›d_by
 =ğ
nuÎ±r
) {

2682 
	`¡c
("Th™em mu¡ bÿ¼›dØb’chª‹d.\n", 
ch
);

2686 ià(
obj
->
weight
 <= 0) {

2687 
	`¡c
("But,h™em i ®»ady weighess.\n", 
ch
);

2691 
ç
 = 25;

2694 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
)

2695 
ç
 += 20;

2698 
ç
 -ğ
Ëv–
;

2700 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
))

2701 
ç
 -= 15;

2703 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_GLOW
))

2704 
ç
 -= 5;

2706 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_MAGIC
))

2707 
ç
 += 20;

2709 
ç
 = 
	`URANGE
(5, fail, 85);

2710 
»suÉ
 = 
	`numb”_³rûÁ
();

2713 ià(
»suÉ
 < (
ç
 / 5è&& !
	`IS_IMMORTAL
(
ch
)) {

2714 
	`aù
("$°im¶ode štØnÙhšgÃss!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2715 
	`aù
("$°im¶ode štØnÙhšgÃss!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2716 
	`de¡roy_obj
(
obj
);

2720 ià(
»suÉ
 < (
ç
 / 3è&& !
	`IS_IMMORTAL
(
ch
)) {

2721 
	`aù
("$°glow ¦ighy,h’ dims.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2722 
	`aù
("$°glow ¦ighy,h’ dims.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2725 
afãù
::
	`»move_®l_äom_obj
(
obj
, 
Œue
);

2726 
obj
->
exŒa_æags
.
	`ş—r
();

2730 ià(
»suÉ
 <ğ
ç
) {

2731 
	`¡c
("NÙhšg s“medØh­³n.\n", 
ch
);

2735 
	`obj_äom_ch¬
(
obj
);

2737 ià(
	`IS_IMMORTAL
(
ch
)) {

2738 ià(
	`IS_HEAD
(
ch
è|| 
	`numb”_³rûÁ
() > 50) {

2739 
	`aù
("$°shše brlŸÁly w™h‡ sv”‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2740 
	`aù
("$°shše brlŸÁly w™h‡ sv”‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2741 
obj
->
exŒa_æags
 +ğ
ITEM_MAGIC
;

2742 
obj
->
weight
 = 0;

2745 
	`aù
("$°shimm” w™h‡ sv”‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2746 
	`aù
("$°shimm” w™h‡ sv”‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2747 
obj
->
exŒa_æags
 +ğ
ITEM_MAGIC
;

2748 
obj
->
weight
 = 
	`URANGE
(0, obj->weight - 50, obj->weight);

2751 ià(
»suÉ
 <ğ(90 - 
Ëv–
 / 5)) {

2752 
	`aù
("$°shimm” w™h‡ sv”‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2753 
	`aù
("$°shimm” w™h‡ sv”‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2754 
obj
->
exŒa_æags
 +ğ
ITEM_MAGIC
;

2755 
obj
->
weight
 = 
	`URANGE
(0, obj->weight - 50, obj->weight);

2758 
	`aù
("$°shše brlŸÁly w™h‡ sv”‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2759 
	`aù
("$°shše brlŸÁly w™h‡ sv”‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2760 
obj
->
exŒa_æags
 +ğ
ITEM_MAGIC
;

2761 
obj
->
weight
 = 0;

2764 ià(
obj
->
Ëv–
 < 
LEVEL_HERO
)

2765 
obj
->
Ëv–
 = 
¡d
::
	`mš
(
LEVEL_HERO
 - 1, obj->level + 1);

2767 
	`obj_to_ch¬
(
obj
, 
ch
);

2768 
	}
}

2770 
	$¥–l_’chªt_¬mÜ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2772 
Objeù
 *
obj
 = (Objeù *è
vo
;

2773 
»suÉ
, 
ç
;

2774 
ac_bÚus
, 
added
;

2777 ià(
ch
 =ğ
vo
)

2780 ià((
obj
->
™em_ty³
 !ğ
ITEM_ARMOR
)

2781 && (
obj
->
™em_ty³
 !ğ
ITEM_LIGHT
è&& (obj->™em_ty³ !ğ
ITEM_TREASURE
)

2782 && (
obj
->
™em_ty³
 !ğ
ITEM_CLOTHING
è&& (obj->™em_ty³ !ğ
ITEM_CONTAINER
)

2783 && (
obj
->
™em_ty³
 !ğ
ITEM_TRASH
è&& (obj->™em_ty³ !ğ
ITEM_GEM
)

2784 && (
obj
->
™em_ty³
 !ğ
ITEM_JEWELRY
)) {

2785 
	`¡c
("Th© i¢'ˆª‡rmÜ.\n", 
ch
);

2789 ià(
obj
->
w—r_loc
 !ğ-1 || obj->
ÿ¼›d_by
 =ğ
nuÎ±r
) {

2790 
	`¡c
("Th™em mu¡ bÿ¼›dØb’chª‹d.\n", 
ch
);

2795 
ac_bÚus
 = 0;

2796 
ç
 = 25;

2800 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
) {

2801 ià(
·f
->
loÿtiÚ
 =ğ
APPLY_AC
) {

2802 
ac_bÚus
 = 
·f
->
modif›r
;

2803 
ç
 +ğ5 * (
ac_bÚus
 *‡c_bonus);

2806 
ç
 += 20;

2810 
ç
 -ğ
Ëv–
;

2812 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
))

2813 
ç
 -= 15;

2815 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_GLOW
))

2816 
ç
 -= 5;

2818 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_MAGIC
))

2819 
ç
 += 20;

2821 
ç
 = 
	`URANGE
(5, fail, 85);

2822 
»suÉ
 = 
	`numb”_³rûÁ
();

2824 ià(
	`IS_IMMORTAL
(
ch
))

2825 
»suÉ
 = 100;

2828 ià(
»suÉ
 < (
ç
 / 5)) {

2829 
	`aù
("$°æ¬e blšdšgly...‡ndƒv­Ü©es!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2830 
	`aù
("$°æ¬e blšdšgly...‡ndƒv­Ü©es!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2831 
	`de¡roy_obj
(
obj
);

2835 ià(
»suÉ
 < (
ç
 / 3)) {

2836 
	`aù
("$°glow brighy,h’ fades...oİs.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2837 
	`aù
("$°glow brighy,h’ fades.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2840 
afãù
::
	`»move_®l_äom_obj
(
obj
, 
Œue
);

2841 
obj
->
exŒa_æags
.
	`ş—r
();

2845 ià(
»suÉ
 <ğ
ç
) {

2846 
	`¡c
("NÙhšg s“medØh­³n.\n", 
ch
);

2850 ià(
	`IS_IMMORTAL
(
ch
)) {

2851 ià(
	`IS_HEAD
(
ch
è|| 
	`numb”_³rûÁ
() > 50) {

2853 
	`aù
("$°glow ¨brlŸÁ gŞd!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2854 
	`aù
("$°glow ¨brlŸÁ gŞd!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2855 
obj
->
exŒa_æags
 +ğ
ITEM_MAGIC
;

2856 
obj
->
exŒa_æags
 +ğ
ITEM_GLOW
;

2857 
added
 = -2;

2861 
	`aù
("$°shimm” w™h‡ gŞd‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2862 
	`aù
("$°shimm” w™h‡ gŞd‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2863 
obj
->
exŒa_æags
 +ğ
ITEM_MAGIC
;

2864 
added
 = -1;

2867 ià(
»suÉ
 <ğ(90 - 
Ëv–
 / 5)) {

2869 
	`aù
("$°shimm” w™h‡ gŞd‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2870 
	`aù
("$°shimm” w™h‡ gŞd‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2871 
obj
->
exŒa_æags
 +ğ
ITEM_MAGIC
;

2872 
added
 = -1;

2875 
	`aù
("$°glow ¨brlŸÁ gŞd!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2876 
	`aù
("$°glow ¨brlŸÁ gŞd!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2877 
obj
->
exŒa_æags
 +ğ
ITEM_MAGIC
;

2878 
obj
->
exŒa_æags
 +ğ
ITEM_GLOW
;

2879 
added
 = -2;

2883 ià(
obj
->
Ëv–
 < 
LEVEL_HERO
)

2884 
obj
->
Ëv–
 = 
¡d
::
	`mš
(
LEVEL_HERO
 - 1, obj->level + 1);

2886 
afãù
::
Afãù
 
af
;

2887 
af
.
wh”e
 = 
TO_OBJECT
;

2888 
af
.
ty³
 = 
afãù
::ty³::
’chªt_¬mÜ
;

2889 
af
.
Ëv–
 =†evel;

2890 
af
.
du¿tiÚ
 = -1;

2891 
af
.
loÿtiÚ
 = 
APPLY_AC
;

2892 
af
.
modif›r
 = 
added
;

2893 
af
.
	`b™veùÜ
(0);

2894 
af
.
evŞutiÚ
 =ƒvolution;

2895 
afãù
::
	`još_to_obj
(
obj
, &
af
);

2896 
	}
}

2898 
	$¥–l_’chªt_w—pÚ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

2900 
Objeù
 *
obj
 = (Objeù *è
vo
;

2901 
»suÉ
, 
ç
;

2902 
h™_bÚus
, 
dam_bÚus
, 
added
;

2905 ià(
ch
 =ğ
vo
)

2908 ià((
obj
->
™em_ty³
 !ğ
ITEM_WEAPON
è&& (obj->™em_ty³ !ğ
ITEM_ARMOR
)

2909 && (
obj
->
™em_ty³
 !ğ
ITEM_LIGHT
è&& (obj->™em_ty³ !ğ
ITEM_TREASURE
)

2910 && (
obj
->
™em_ty³
 !ğ
ITEM_CLOTHING
è&& (obj->™em_ty³ !ğ
ITEM_CONTAINER
)

2911 && (
obj
->
™em_ty³
 !ğ
ITEM_TRASH
è&& (obj->™em_ty³ !ğ
ITEM_GEM
)

2912 && (
obj
->
™em_ty³
 !ğ
ITEM_JEWELRY
)) {

2913 
	`¡c
("Th© i¢'ˆ’chªbË.\n", 
ch
);

2917 ià(
obj
->
w—r_loc
 !ğ-1 || obj->
ÿ¼›d_by
 =ğ
nuÎ±r
) {

2918 
	`¡c
("Th™em mu¡ bÿ¼›dØb’chª‹d.\n", 
ch
);

2923 
h™_bÚus
 = 0;

2924 
dam_bÚus
 = 0;

2925 
ç
 = 25;

2928 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
) {

2929 ià(
·f
->
loÿtiÚ
 =ğ
APPLY_HITROLL
) {

2930 
h™_bÚus
 = 
·f
->
modif›r
;

2931 
ç
 +ğ2 * (
h™_bÚus
 * hit_bonus);

2933 ià(
obj
->
™em_ty³
 !ğ
ITEM_WEAPON
)

2934 
ç
 +ğ10 * (
h™_bÚus
 * hit_bonus);

2936 ià(
·f
->
loÿtiÚ
 =ğ
APPLY_DAMROLL
) {

2937 
dam_bÚus
 = 
·f
->
modif›r
;

2938 
ç
 +ğ2 * (
dam_bÚus
 * dam_bonus);

2940 ià(
obj
->
™em_ty³
 !ğ
ITEM_WEAPON
)

2941 
ç
 +ğ10 * (
dam_bÚus
 * dam_bonus);

2944 
ç
 += 25;

2948 
ç
 -ğ3 * 
Ëv–
 / 2;

2950 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
))

2951 
ç
 -= 15;

2953 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_GLOW
))

2954 
ç
 -= 5;

2956 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_MAGIC
))

2957 
ç
 += 20;

2959 
ç
 = 
	`URANGE
(5, fail, 95);

2960 
»suÉ
 = 
	`numb”_³rûÁ
();

2962 ià(
	`IS_IMMORTAL
(
ch
))

2963 
»suÉ
 = 100;

2966 ià(
»suÉ
 < (
ç
 / 5)) {

2967 
	`aù
("$°shiv” viŞ’y‡ndƒx¶odes!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2968 
	`aù
("$°shiv” viŞ’y‡ndƒx¶odes!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2969 
	`de¡roy_obj
(
obj
);

2973 ià(
»suÉ
 < (
ç
 / 2)) {

2974 
	`aù
("$°glow brighy,h’ fades...oİs.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

2975 
	`aù
("$°glow brighy,h’ fades.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2977 cÚ¡ 
afãù
::
Afãù
 *
two_hªded_aff
 =‡fãù::
	`fšd_Ú_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_two_hªds
);

2978 
afãù
::
Afãù
 
two_hªded_cİy
;

2979 
boŞ
 
two_hªded
 = 
two_hªded_aff
 !ğ
nuÎ±r
;

2981 ià(
two_hªded
 && 
obj
->
™em_ty³
 =ğ
ITEM_WEAPON
) {

2982 
two_hªded_cİy
.
wh”e
 = 
two_hªded_aff
->where;

2983 
two_hªded_cİy
.
ty³
 = 
two_hªded_aff
->type;

2984 
two_hªded_cİy
.
Ëv–
 = 
two_hªded_aff
->level;

2985 
two_hªded_cİy
.
du¿tiÚ
 = 
two_hªded_aff
->duration;

2986 
two_hªded_cİy
.
loÿtiÚ
 = 
two_hªded_aff
->location;

2987 
two_hªded_cİy
.
modif›r
 = 
two_hªded_aff
->modifier;

2988 
two_hªded_cİy
.
evŞutiÚ
 = 
two_hªded_aff
->evolution;

2989 
two_hªded_cİy
.
	`b™veùÜ
(
two_hªded_aff
->bitvector());

2993 
afãù
::
	`»move_®l_äom_obj
(
obj
, 
Œue
);

2995 ià(
two_hªded
)

2996 
afãù
::
	`cİy_to_obj
(
obj
, &
two_hªded_cİy
);

2998 
obj
->
exŒa_æags
.
	`ş—r
();

3002 ià(
»suÉ
 <ğ
ç
) {

3003 
	`¡c
("NÙhšg s“medØh­³n.\n", 
ch
);

3007 ià(
	`IS_IMMORTAL
(
ch
)) {

3008 ià(
	`IS_HEAD
(
ch
è|| 
	`numb”_³rûÁ
() > 50) {

3010 
	`aù
("$°glow ¨brlŸÁ blue!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3011 
	`aù
("$°glow ¨brlŸÁ blue!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3012 
obj
->
exŒa_æags
 +ğ
ITEM_MAGIC
;

3013 
obj
->
exŒa_æags
 +ğ
ITEM_GLOW
;

3014 
added
 = 2;

3018 
	`aù
("$°glow blue.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3019 
	`aù
("$°glow blue.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3020 
obj
->
exŒa_æags
 +ğ
ITEM_MAGIC
;

3021 
added
 = 1;

3024 ià(
»suÉ
 <ğ(100 - 
Ëv–
 / 5)) {

3025 
	`aù
("$°glow blue.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3026 
	`aù
("$°glow blue.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3027 
obj
->
exŒa_æags
 +ğ
ITEM_MAGIC
;

3028 
added
 = 1;

3031 
	`aù
("$°glow ¨brlŸÁ blue!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3032 
	`aù
("$°glow ¨brlŸÁ blue!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3033 
obj
->
exŒa_æags
 +ğ
ITEM_MAGIC
;

3034 
obj
->
exŒa_æags
 +ğ
ITEM_GLOW
;

3035 
added
 = 2;

3039 ià((
obj
->
™em_ty³
 !ğ
ITEM_WEAPON
è&& (obj->
Ëv–
 < 50)) {

3040 ià(
obj
->
Ëv–
 < 30)

3041 
obj
->
Ëv–
 = obj->level + 20;

3043 
obj
->
Ëv–
 = 50;

3046 ià(
obj
->
Ëv–
 < 
LEVEL_HERO
 - 1)

3047 
obj
->
Ëv–
 = 
¡d
::
	`mš
(
LEVEL_HERO
 - 1, obj->level + 1);

3049 
afãù
::
Afãù
 
af
;

3050 
af
.
wh”e
 = 
TO_OBJECT
;

3051 
af
.
ty³
 = 
afãù
::ty³::
’chªt_w—pÚ
;

3052 
af
.
Ëv–
 =†evel;

3053 
af
.
du¿tiÚ
 = -1;

3054 
af
.
modif›r
 = 
added
;

3055 
af
.
	`b™veùÜ
(0);

3056 
af
.
evŞutiÚ
 =ƒvolution;

3058 
af
.
loÿtiÚ
 = 
APPLY_DAMROLL
;

3059 
afãù
::
	`još_to_obj
(
obj
, &
af
);

3061 
af
.
loÿtiÚ
 = 
APPLY_HITROLL
;

3062 
afãù
::
	`još_to_obj
(
obj
, &
af
);

3063 
	}
}

3066 
	$¥–l_’”gy_d¿š
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3068 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

3069 
dam
, 
mªad¿š
, 
¡amd¿š
;

3071 ià(
viùim
 !ğ
ch
 && ch->
gud
 !ğ
Gud
::
·Ïdš
)

3072 
ch
->
®ignm’t
 = 
¡d
::
	`max
(-1000, ch->alignment - 50);

3074 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_NEGATIVE
)) {

3075 
	`¡c
("NØ’”gy s“m tØæow.\n", 
ch
);

3076 
	`¡c
("You f“È¨mom’ry chl.\n", 
viùim
);

3080 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a


3081 && 
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
şª¬’a
)

3082 
	`gaš_exp
(
viùim
, 0 - 
	`numb”_¿nge
(10 + 
Ëv–
 / 2, 10 + (3 *†evel / 2)));

3084 ià(
viùim
->
mªa
 > 0) {

3085 
mªad¿š
 = 
viùim
->
mªa
 / 
¡d
::
	`max
(4, (
	`GET_ATTR_SAVES
(victim) / -5));

3086 
mªad¿š
 +ğ
ch
->
Ëv–
;

3087 
mªad¿š
 = 
¡d
::
	`mš
(
viùim
->
mªa
, manadrain);

3088 
viùim
->
mªa
 -ğ
mªad¿š
;

3090 ià(
ch
->
mªa
 < 20000)

3091 
ch
->
mªa
 +ğ
mªad¿š
 / 4;

3094 ià(
viùim
->
¡am
 > 0) {

3095 
¡amd¿š
 = 
viùim
->
¡am
 / 
¡d
::
	`max
(4, (
	`GET_ATTR_SAVES
(victim) / -5));

3096 
¡amd¿š
 +ğ
ch
->
Ëv–
;

3097 
¡amd¿š
 = 
¡d
::
	`mš
(
viùim
->
¡am
, stamdrain);

3098 
viùim
->
¡am
 -ğ
¡amd¿š
;

3100 ià(
ch
->
¡am
 < 20000)

3101 
ch
->
¡am
 +ğ
¡amd¿š
 / 4;

3104 
dam
 = 
	`diû
(4, 
Ëv–
 / 2);

3106 ià(
ch
->
h™
 < 20000)

3107 
ch
->
h™
 +ğ
dam
;

3109 
	`¡c
("You f“Èyou¸liã slpšg‡way!\n", 
viùim
);

3110 
	`¡c
("Wow....wh©‡„ush!\n", 
ch
);

3111 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_NEGATIVE
, 
Œue
,rue);

3112 
	}
}

3115 
	$¥–l_ã¬
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3117 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

3119 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ã¬
)) {

3120 
	`aù
("You¸©ck i £n£Ëss, $N i ®»ady shakšg iÀ$S boÙs!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3124 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_NEGATIVE
)) {

3125 
	`aù
("$E i¢'ˆaäaid oàyou!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3129 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

3130 
afãù
::
ty³
::
ç”›_fœe
,

3131 
Ëv–
,

3132 
Ëv–
 / 3,

3133 
evŞutiÚ
,

3134 
çl£


3137 
	`¡c
("Oh C¿p, you'» gÚÇ d›! RuÀfÜ you¸liã!\n", 
viùim
);

3139 ià(
ch
 !ğ
viùim
)

3140 
	`aù
("$N†ook exŒem–y frigh‹Ãd.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3141 
	}
}

3144 
	$fœeb®l_bash
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
Ëv–
, 
evŞutiÚ
, 
boŞ
 
¥»ad
)

3146 
chªû
 = 100;

3147 
boŞ
 
¡ªdç¡
 = 
çl£
;

3148 
chªû
 +ğ(
SIZE_MEDIUM
 - 
viùim
->
size
) * 15;

3149 
chªû
 -ğ2 * (
	`GET_ATTR_STR
(
viùim
) - 10);

3150 
chªû
 +ğ(
Ëv–
 - 
viùim
->level) / 2;

3151 
chªû
 +ğ(
evŞutiÚ
 - 1) * 10;

3153 ià(
viùim
->
off_æags
.
	`has
(
OFF_FAST
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(viùim,‡fãù::
ty³
::
ha¡e
))

3154 
chªû
 -= 15;

3156 
chªû
 -ğ((
viùim
->
¡am
 * 20è/ 
	`GET_MAX_STAM
(victim));

3157 
chªû
 -ğ
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
dodge
) / 7;

3159 ià(!
	`ÿn_£e_ch¬
(
viùim
, 
ch
))

3160 
chªû
 += 20;

3162 ià(!
	`ÿn_£e_ch¬
(
ch
, 
viùim
))

3163 
chªû
 -= 20;

3165 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
·ss_doÜ
))

3166 
chªû
 -= chance / 4;

3168 ià(
¥»ad
)

3169 
chªû
 -= chance / 3;

3173 
chªû
 /= 4;

3175 ià(
	`CAN_USE_RSKILL
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
)) {

3176 
chªû
 = chªû * (100 - 
	`g‘_skl_Ëv–
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
));

3177 
chªû
 /= 100;

3178 
¡ªdç¡
 = 
Œue
;

3181 
chªû
 = 
	`URANGE
(5, chance, 95);

3183 ià(
	`rŞl_chªû
(
chªû
)) {

3184 
buf
[
MSL
], 
fb_buf
[MSL];

3185 
wa™
 = 
	`numb”_¿nge
(1, 3è* 
PULSE_VIOLENCE
;

3187 ià(
evŞutiÚ
 == 2)

3188 
FÜm©
::
	`¥rštf
(
fb_buf
, "{Hf{Gir{Web{Gal{Hl{x");

3190 
FÜm©
::
	`¥rštf
(
fb_buf
, "{Bf{Cir{Web{Cal{Bl{x");

3192 
FÜm©
::
	`¥rštf
(
buf
, "ThcÚcussivfÜû oà$n' % knock youØthground!", 
fb_buf
);

3193 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

3194 
FÜm©
::
	`¥rštf
(
buf
, "ThcÚcussivfÜû oàyou¸% knock $NØthground!", 
fb_buf
);

3195 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3196 
FÜm©
::
	`¥rštf
(
buf
, "ThcÚcussivfÜû oà$n' % knock $NØthground!", 
fb_buf
);

3197 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

3198 
	`DAZE_STATE
(
viùim
, 
wa™
);

3199 
	`WAIT_STATE
(
viùim
, 
wa™
);

3200 
viùim
->
pos™iÚ
 = 
POS_RESTING
;

3202 ià(
¡ªdç¡
)

3203 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
, 
çl£
, 1);

3205 ià(
¡ªdç¡
)

3206 
	`check_im´ove
(
viùim
, 
skl
::
ty³
::
¡ªdç¡
, 
Œue
, 1);

3207 
	}
}

3211 
	$¥–l_fœeb®l
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3213 
Ch¬aù”
 *
viùim
;

3214 
dam
;

3216 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
è&& !
	`IS_IMMORTAL
(ch)) {

3217 
	`¡c
("Oddlyƒnough, iÀthi room you f“È³aûful.\n", 
ch
);

3221 
dam
 = 
	`diû
((
Ëv–
 / 3è+ (
ch
->
	`is_Åc
() ? 10 : 30), 9);

3224 
evŞutiÚ
) {

3225 3: 
dam
 *= 2; ;

3227 2: 
dam
 += dam / 2; ;

3232 
SŒšg
 
¬g
;

3233 
	`Úe_¬gum’t
(
rg‘_Çme
, 
¬g
);

3236 ià(
¬g
 =ğ"room" && 
evŞutiÚ
 >= 2) {

3237 
buf
[
MSL
], 
fb_buf
[MSL];

3238 
Ch¬aù”
 *
viùim_Ãxt
;

3239 
Ãwdam
;

3240 
couÁ
 = 0;

3243 
viùim
 = 
ch
->
š_room
->
³İË
; viùim; viùim = viùim->
Ãxt_š_room
)

3244 ià(
ch
 !ğ
viùim


3245 && !
	`is_§me_group
(
viùim
, 
ch
)

3246 && !
	`is_§ã_¥–l
(
ch
, 
viùim
, 
Œue
))

3247 
couÁ
++;

3249 ià(
couÁ
 == 0) {

3250 
	`¡c
("Th”¬nØ’em› h”e, wh©…u½o£ would iˆ£rve?\n", 
ch
);

3254 ià(
evŞutiÚ
 == 2)

3255 
FÜm©
::
	`¥rštf
(
fb_buf
, "{Hf{Gir{Web{Gal{Hl{x");

3257 
FÜm©
::
	`¥rštf
(
fb_buf
, "{Bf{Cir{Web{Cal{Bl{x");

3259 
dam
 -= dam / 4;

3260 
	`±c
(
ch
, "You bÏ¡hroom w™h‡…ow”fuÈ%s!\n", 
fb_buf
);

3261 
FÜm©
::
	`¥rštf
(
buf
, "$ÀbÏ¡ throom w™h‡…ow”fuÈ%s!", 
fb_buf
);

3262 
	`aù
(
buf
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3264 
viùim
 = 
ch
->
š_room
->
³İË
; viùim; viùim = 
viùim_Ãxt
) {

3265 
viùim_Ãxt
 = 
viùim
->
Ãxt_š_room
;

3267 ià(
ch
 =ğ
viùim
)

3270 ià(
	`is_§me_group
(
viùim
, 
ch
)

3271 || 
	`is_§ã_¥–l
(
ch
, 
viùim
, 
Œue
))

3274 
Ãwdam
 = 
	`numb”_¿nge
(
dam
 / 2, dam + dam / 2);

3275 
	`damage
(
ch
, 
viùim
, 
	`§ves_¥–l
(
Ëv–
, viùim, 
DAM_FIRE
è? 
Ãwdam
 / 2 :‚ewdam,

3276 
¢
, -1, 
DAM_FIRE
, 
Œue
,rue);

3278 ià(
evŞutiÚ
 == 3

3279 && 
viùim
 !ğ
nuÎ±r


3280 && 
viùim
->
h™
 > 0

3281 && 
	`g‘_pos™iÚ
(
viùim
è=ğ
POS_FIGHTING
)

3282 
	`fœeb®l_bash
(
ch
, 
viùim
, 
Ëv–
, 
evŞutiÚ
, 
Œue
);

3288 ià(
rg‘_Çme
.
	`em±y
()) {

3289 ià((
viùim
 = 
ch
->
fightšg
è=ğ
nuÎ±r
) {

3290 
	`¡c
("Ca¡h¥–ÈÚ whom?\n", 
ch
);

3296 
ch
->
mªa
 +ğ
	`g‘_skl_co¡
(ch, 
skl
::
ty³
::
fœeb®l
);

3298 ià(
ch
->
mªa
 > 
	`GET_MAX_MANA
(ch))

3299 
ch
->
mªa
 = 
	`GET_MAX_MANA
(ch);

3305 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

3306 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

3310 ià(
viùim
->
fightšg
 !ğ
nuÎ±r
 && !
	`is_§me_group
(
ch
, victim->fighting)) {

3311 
	`¡c
("You¸š‹nded oµÚ’ˆi ®»ady fightšg someÚ–£.\n", 
ch
);

3315 ià(
viùim
->
	`is_Åc
(è&& viùim->
fightšg
 !ğ
nuÎ±r
 && !
	`is_§me_group
(
ch
, victim))

3316 ià(
	`h–p_mob
(
ch
, 
viùim
))

3320 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 =ğ
viùim
) {

3321 
	`¡c
("You cª'ˆdØth© oÀyou¸owÀfŞlow”.\n", 
ch
);

3325 
	`damage
(
ch
, 
viùim
, 
	`§ves_¥–l
(
Ëv–
, viùim, 
DAM_FIRE
è? 
dam
 / 2 : dam, 
¢
, -1, DAM_FIRE, 
Œue
,rue);

3327 ià(
evŞutiÚ
 == 3

3328 && 
viùim
 !ğ
nuÎ±r


3329 && 
viùim
->
h™
 > 0

3330 && 
	`g‘_pos™iÚ
(
viùim
è=ğ
POS_FIGHTING
)

3331 
	`fœeb®l_bash
(
ch
, 
viùim
, 
Ëv–
, 
evŞutiÚ
, 
çl£
);

3332 
	}
}

3334 
	$¥–l_fœ•roof
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3336 
Objeù
 *
obj
 = (Objeù *è
vo
;

3337 
afãù
::
Afãù
 
af
;

3349 ià(
ch
 =ğ
vo
)

3352 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BURN_PROOF
)) {

3353 
	`aù
("$°i ®»ady…rÙeùed from buºšg.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3357 
af
.
wh”e
 = 
TO_OBJECT
;

3358 
af
.
ty³
 = 
afãù
::ty³::
fœ•roof
;

3359 
af
.
Ëv–
 =†evel;

3360 
af
.
du¿tiÚ
 = 
	`numb”_fuzzy
(
Ëv–
 / 4);

3361 
af
.
loÿtiÚ
 = 
APPLY_NONE
;

3362 
af
.
modif›r
 = 0;

3363 
af
.
	`b™veùÜ
(
ITEM_BURN_PROOF
);

3364 
af
.
evŞutiÚ
 =ƒvolution;

3365 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

3366 
	`aù
("You…rÙeù $°äom fœe.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3367 
	`aù
("$°i su¼ounded by‡…rÙeùivau¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3368 
	}
}

3371 
boŞ
 
	$’hªû_bÏde
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, 
afãù
::
ty³
y³, 
Ëv–
, 
evŞutiÚ
)

3373 ià(
obj
->
™em_ty³
 !ğ
ITEM_WEAPON
) {

3374 
	`¡c
("Thi ¥–ÈÿÀÚlyƒnhªû w—pÚs.\n", 
ch
);

3375  
çl£
;

3378 ià(
obj
->
w—r_loc
 !ğ-1 || obj->
ÿ¼›d_by
 =ğ
nuÎ±r
) {

3379 
	`¡c
("Thw—pÚ mu¡ bš you¸šv’tÜy.\n", 
ch
);

3380  
çl£
;

3383 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_æamšg
)

3384 || 
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_äo¡
)

3385 || 
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_vampœic
)

3386 || 
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_shockšg
)) {

3387 
	`aù
("$°i ®»ady‡À’hªûd w—pÚ.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3388  
çl£
;

3391 
afãù
::
Afãù
 
af
;

3392 
af
.
wh”e
 = 
TO_WEAPON
;

3393 
af
.
ty³
 =ype;

3394 
af
.
Ëv–
 =†evel;

3395 
af
.
du¿tiÚ
 = (
	`numb”_³rûÁ
(è+ (
Ëv–
 / 2));

3396 
af
.
loÿtiÚ
 = 0;

3397 
af
.
modif›r
 = 0;

3398 
af
.
	`b™veùÜ
(0);

3399 
af
.
evŞutiÚ
 =ƒvolution;

3400 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

3401  
Œue
;

3402 
	}
}

3404 
	$¥–l_æame_bÏde
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3406 
Objeù
 *
obj
 = (Objeù *è
vo
;

3409 ià(
ch
 =ğ
vo
)

3412 ià(
	`’hªû_bÏde
(
ch
, 
obj
, 
afãù
::
ty³
::
w—pÚ_æamšg
, 
Ëv–
, 
evŞutiÚ
)) {

3413 
	`aù
("$°bur¡ štØ¨glÜiou æame!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3414 
	`aù
("$°bur¡ štØ¨glÜiou æame!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3416 
	}
}

3418 
	$¥–l_äo¡_bÏde
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3420 
Objeù
 *
obj
 = (Objeù *è
vo
;

3423 ià(
ch
 =ğ
vo
)

3426 ià(
	`’hªû_bÏde
(
ch
, 
obj
, 
afãù
::
ty³
::
w—pÚ_äo¡
, 
Ëv–
, 
evŞutiÚ
)) {

3427 
	`aù
("$°i now cŞdØthtouch.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3428 
	`aù
("$°fl throom w™h‡ b™‹¸cŞd!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3430 
	}
}

3432 
	$¥–l_blood_bÏde
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3434 
Objeù
 *
obj
 = (Objeù *è
vo
;

3437 ià(
ch
 =ğ
vo
)

3440 ià(
	`’hªû_bÏde
(
ch
, 
obj
, 
afãù
::
ty³
::
w—pÚ_vampœic
, 
Ëv–
, 
evŞutiÚ
)) {

3441 
	`aù
("$°glow w™h‡Àev‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3442 
	`aù
("$°glow w™h‡Àev‡u¿.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3444 
	}
}

3446 
	$¥–l_shock_bÏde
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3448 
Objeù
 *
obj
 = (Objeù *è
vo
;

3451 ià(
ch
 =ğ
vo
) ;

3453 ià(
	`’hªû_bÏde
(
ch
, 
obj
, 
afãù
::
ty³
::
w—pÚ_shockšg
, 
Ëv–
, 
evŞutiÚ
)) {

3454 
	`aù
("$°üackË w™h…u»ƒÃrgy.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3455 
	`aù
("$°fl throom w™h s·rk oà–eùric™y!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

3457 
	}
}

3459 
	$¥–l_æame¡rike
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3461 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

3462 
dam
;

3463 
dam
 = 
	`diû
(6 + 
Ëv–
 / 2, 8);

3465 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_FIRE
))

3466 
dam
 /= 2;

3468 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_FIRE
, 
Œue
,rue);

3469 
	}
}

3471 
	$¥–l_ç”›_fœe
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3473 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

3475 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ç”›_fœe
)) {

3476 
	`aù
("$N i ®»ady glowšg…šk!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3480 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

3481 
afãù
::
ty³
::
ç”›_fœe
,

3482 
Ëv–
,

3483 
Ëv–
,

3484 
evŞutiÚ
,

3485 
çl£


3488 
	`¡c
("You‡» su¼ounded by‡…šk ouše.\n", 
viùim
);

3489 
	`aù
("$Ài su¼ounded by‡…šk ouše.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3490 
	}
}

3492 
	$¥–l_ç”›_fog
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3494 
Ch¬aù”
 *
ich
;

3495 
	`aù
("$ÀcÚju» ¨şoud oàpu½Ë smoke.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3496 
	`¡c
("You cÚju»‡ cloud oàpu½Ë smoke.\n", 
ch
);

3498 
ich
 = 
ch
->
š_room
->
³İË
; ich !ğ
nuÎ±r
; ich = ich->
Ãxt_š_room
) {

3499 ià(
ich
->
švis_Ëv–
 > 0)

3502 ià(
ich
 =ğ
ch
 || 
	`§ves_¥–l
(
Ëv–
, ich, 
DAM_OTHER
))

3505 ià(!
afãù
::
	`exi¡s_Ú_ch¬
(
ich
,‡fãù::
ty³
::
hide
)

3506 && !
afãù
::
	`exi¡s_Ú_ch¬
(
ich
,‡fãù::
ty³
::
¢—k
)

3507 && !
afãù
::
	`exi¡s_Ú_ch¬
(
ich
,‡fãù::
ty³
::
švis
)

3508 && !
afãù
::
	`exi¡s_Ú_ch¬
(
ich
,‡fãù::
ty³
::
midnight
))

3511 
afãù
::
	`»move_ty³_äom_ch¬
(
ich
,‡fãù::
ty³
::
švis
);

3512 
afãù
::
	`»move_ty³_äom_ch¬
(
ich
,‡fãù::
ty³
::
¢—k
);

3513 
afãù
::
	`»move_ty³_äom_ch¬
(
ich
,‡fãù::
ty³
::
hide
);

3514 
afãù
::
	`»move_ty³_äom_ch¬
(
ich
,‡fãù::
ty³
::
midnight
);

3515 
	`aù
("$Ài »v—Ëd!", 
ich
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3516 
	`¡c
("You‡»„ev—Ëd!\n", 
ich
);

3518 
	}
}

3520 
	$¥–l_çrsight
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3522 ià(
	`is_blšded
(
ch
)) {

3523 
	`¡c
("Mayb™ would h–°iàyou could s“?\n", 
ch
);

3527 
	`do_sÿn
(
ch
, 
rg‘_Çme
);

3528 
	}
}

3530 
	$¥–l_æßtšg_disc
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3532 
Objeù
 *
disc
, *
æßtšg
;

3533 
æßtšg
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_FLOAT
);

3535 ià(
æßtšg
 !ğ
nuÎ±r
 && 
	`IS_OBJ_STAT
(æßtšg, 
ITEM_NOREMOVE
)) {

3536 
	`aù
("You cª'ˆ»mov$p.", 
ch
, 
æßtšg
, 
nuÎ±r
, 
TO_CHAR
);

3540 
disc
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_DISC
), 0);

3542 ià(! 
disc
) {

3543 
Loggšg
::
	`bug
("Memoryƒrror in spell_floating_disc", 0);

3544 
	`¡c
("You w”uÇbËØü—‹‡ flßtšg disc.\n", 
ch
);

3548 
disc
->
v®ue
[0] = 
ch
->
Ëv–
 * 100;

3549 
disc
->
v®ue
[3] = 
ch
->
Ëv–
 * 50;

3550 
disc
->
tim”
 = 
ch
->
Ëv–
 * 2 - 
	`numb”_¿nge
(0,†evel / 2);

3551 
	`aù
("$Àha ü—‹d‡ flßtšg bÏck disc.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3552 
	`¡c
("You c»©¨æßtšg disc.\n", 
ch
);

3553 
	`obj_to_ch¬
(
disc
, 
ch
);

3554 
	`w—r_obj
(
ch
, 
disc
, 
Œue
);

3555 
	}
}

3557 
	$¥–l_æy
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3559 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

3561 ià(
	`CAN_FLY
(
viùim
)) {

3562 ià(
viùim
 =ğ
ch
)

3563 
	`¡c
("You‡Ì—dy havthab™yØæy.\n", 
ch
);

3565 
	`aù
("$N dÛ¢'ˆÃed you¸h–°tØæy.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3570 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

3571 
afãù
::
ty³
::
æy
,

3572 
Ëv–
,

3573 
Ëv–
 + 3,

3574 
evŞutiÚ
,

3575 
çl£


3578 
	`do_æy
(
viùim
, "");

3579 
	}
}

3581 
	$¥–l_ä’zy
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3583 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

3585 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ä’zy
)

3586 || 
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
b”£rk
)) {

3587 ià(
viùim
 =ğ
ch
)

3588 
	`¡c
("You‡»‡Ì—dy iÀ¨ä’zy.\n", 
ch
);

3590 
	`aù
("$N i ®»ady iÀ¨ä’zy.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3595 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ÿlm
)) {

3596 ià(
viùim
 =ğ
ch
)

3597 
	`¡c
("Why dÚ'ˆyou ju¡„–ax fÜ‡ whe?\n", 
ch
);

3599 
	`aù
("$N dÛ¢'ˆlook†ik$wªt tØfighˆªymÜe.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3604 ià((
	`IS_GOOD
(
ch
è&& !IS_GOOD(
viùim
))

3605 || (
	`IS_NEUTRAL
(
ch
è&& !IS_NEUTRAL(
viùim
))

3606 || (
	`IS_EVIL
(
ch
è&& !IS_EVIL(
viùim
))) {

3607 
	`aù
("You¸god dÛ¢'ˆ£emØlik$N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3611 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

3612 
afãù
::
ty³
::
ä’zy
,

3613 
Ëv–
,

3614 
Ëv–
 / 3,

3615 
evŞutiÚ
,

3616 
çl£


3619 
	`¡c
("You‡» fËd w™h hŞy w¿th!\n", 
viùim
);

3620 
	`aù
("$Àg‘ ¨wd†ook iÀ$ eyes!", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3621 
	}
}

3623 
	$¥–l_g©e
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3625 
Ch¬aù”
 *
viùim
;

3626 
boŞ
 
g©e_³t
;

3628 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

3631 ià(
ch
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()) {

3632 
	`¡c
("You cªnÙ g©whšhque¡‡»a.\n", 
ch
);

3636 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
 || 
	`ch¬_š_du–_room
(ch)) {

3637 
	`¡c
("You cªnÙ g©whšh¬’a.\n", 
ch
);

3641 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_NO_RECALL
)

3642 || (
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r


3643 || 
viùim
 =ğ
ch


3644 || (
	`IS_IMMORTAL
(
viùim
è&& !IS_IMMORTAL(
ch
))

3645 || 
viùim
->
š_room
 =ğ
nuÎ±r


3646 || !
	`ÿn_£e_room
(
ch
, 
viùim
->
š_room
)

3647 || 
viùim
->
š_room
->
	`æags
().
	`has_ªy_of
(
ROOM_SAFE
 | 
ROOM_PRIVATE
 | 
ROOM_SOLITARY
 | 
ROOM_NO_RECALL
)

3648 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


3649 || 
viùim
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()

3650 || 
	`ch¬_š_du–_room
(
viùim
)

3651 || 
viùim
->
š_room
->
	`şª
()

3652 || (
viùim
->
š_room
->
	`gud
(è!ğ
Gud
::
nÚe
 && viùim->š_room->gud(è!ğ
ch
->
gud
)

3653 || 
viùim
->
Ëv–
 >†ev– + (viùim->
	`is_Åc
() ? 3 : 8)

3654 || (
viùim
->
	`is_Åc
()

3655 && (
viùim
->
aù_æags
.
	`has
(
ACT_NOSUMMON
)

3656 || 
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_OTHER
)))) {

3657 
	`¡c
("You faed.\n", 
ch
);

3661 ià(
ch
->
³t
 !ğ
nuÎ±r
 && ch->
š_room
 =ğch->³t->š_room && !ch->³t->
aù_æags
.
	`has
(
ACT_STAY
))

3662 
g©e_³t
 = 
Œue
;

3664 
g©e_³t
 = 
çl£
;

3666 
	`aù
("$À¡• through‡ g©ªd vªishes.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3667 
	`¡c
("You s‹°through‡ g©ªd vªish.\n", 
ch
);

3668 
	`ch¬_äom_room
(
ch
);

3669 
	`ch¬_to_room
(
ch
, 
viùim
->
š_room
);

3670 
	`aù
("$Àha ¬rivedhrough‡ g©e.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3671 
	`do_look
(
ch
, "auto");

3673 ià(
g©e_³t
) {

3674 
	`aù
("$À¡• through‡ g©ªd vªishes.", 
ch
->
³t
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3675 
	`¡c
("You s‹°through‡ g©ªd vªish.\n", 
ch
->
³t
);

3676 
	`ch¬_äom_room
(
ch
->
³t
);

3677 
	`ch¬_to_room
(
ch
->
³t
, 
viùim
->
š_room
);

3678 
	`aù
("$Àha ¬rivedhrough‡ g©e.", 
ch
->
³t
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3679 
	`do_look
(
ch
->
³t
, "auto");

3681 
	}
}

3683 
	$¥–l_gŸÁ_¡»ngth
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3685 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

3687 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
gŸÁ_¡»ngth
)) {

3688 ià(
viùim
 =ğ
ch
)

3689 
	`¡c
("You‡»‡Ì—dy‡ ¡rÚg‡ you cª g‘!\n", 
ch
);

3691 
	`aù
("$N cª'ˆg‘‡ny sŒÚg”.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3696 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

3697 
afãù
::
ty³
::
gŸÁ_¡»ngth
,

3698 
Ëv–
,

3699 
Ëv–
,

3700 
evŞutiÚ
,

3701 
çl£


3704 
	`¡c
("You¸musşe surgw™h heigh‹Ãd…ow”!\n", 
viùim
);

3705 
	`aù
("$n' musşe surgw™h heigh‹Ãd…ow”.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3706 
	}
}

3708 
	$¥–l_h¬m
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3710 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

3711 
dam
;

3712 
ÿlign
, 
v®ign
, 
®igndiff
;

3713 
v®ign
 = 
viùim
->
®ignm’t
;

3714 
ÿlign
 = 
ch
->
®ignm’t
;

3717 ià(
v®ign
 > 
ÿlign
)

3718 
®igndiff
 = 
v®ign
 - 
ÿlign
;

3720 
®igndiff
 = 
ÿlign
 - 
v®ign
;

3722 
®igndiff
 /= 200;

3723 
dam
 = 
	`diû
(
Ëv–
 / 2, 
®igndiff
);

3724 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_HARM
, 
Œue
,rue);

3725 
	}
}

3727 
	$¥–l_ha¡e
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3729 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

3731 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ha¡e
)

3732 || 
viùim
->
off_æags
.
	`has
(
OFF_FAST
)) {

3733 ià(
viùim
 =ğ
ch
)

3734 
	`¡c
("You cª'ˆmovªy fa¡”!\n", 
ch
);

3736 
	`aù
("$N i ®»ady movšg‡ ç¡‡ $E cª.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3741 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
¦ow
)) {

3742 ià(!
	`check_di¥–_ch¬
(
Ëv–
, 
viùim
, 
afãù
::
ty³
::
¦ow
, 
çl£
)) {

3743 ià(
viùim
 !ğ
ch
)

3744 
	`¡c
("S³Î faed.\n", 
ch
);

3746 
	`¡c
("You f“Èmom’ry fa¡”.\n", 
viùim
);

3753 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

3754 
afãù
::
ty³
::
ha¡e
,

3755 
Ëv–
,

3756 
viùim
 =ğ
ch
 ? 
Ëv–
/2 :†evel/4,

3757 
evŞutiÚ
,

3758 
çl£


3761 
	`¡c
("You f“Èyour£làmovšg mÜquickly.\n", 
viùim
);

3762 
	`aù
("$Ài movšg mÜquickly.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3764 ià(
ch
 !ğ
viùim
)

3765 
	`¡c
("Ok.\n", 
ch
);

3766 
	}
}

3768 
	$¥–l_h—l
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3770 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

3771 
h™
 = 
¡d
::
	`mš
(
viùim
->h™ + 100, 
	`GET_MAX_HIT
(victim));

3773 ià(
	`GET_ATTR
(
viùim
, 
SET_CLERIC_DIVINE
) >= 2)

3774 
h™
 = hit + hit * 10/ 100;

3775 
viùim
->
h™
 = h™ + h™ * 
	`GET_ATTR
(viùim, 
APPLY_PRIESTESS_UNIQUE
) / 100;

3776 
	`upd©e_pos
(
viùim
);

3777 
	`¡c
("A w¬m f“lšg fl you¸body.\n", 
viùim
);

3779 ià(
ch
 !ğ
viùim
)

3780 
	`¡c
("Ok.\n", 
ch
);

3781 
	}
}

3783 
	$¥–l_h—t_m‘®
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3785 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

3786 
Objeù
 *
obj_lo£
, *
obj_Ãxt
;

3787 
dam
 = 0;

3789 ià(
	`§ves_¥–l
(
Ëv–
 + 2, 
viùim
, 
DAM_FIRE
)) {

3790 
	`¡c
("You¸¥–Èhad‚Øefãù.\n", 
ch
);

3791 
	`¡c
("You f“Èmom’ry w¬m”.\n", 
viùim
);

3795 
obj_lo£
 = 
viùim
->
ÿ¼yšg
; obj_lo£ !ğ
nuÎ±r
; obj_lo£ = 
obj_Ãxt
) {

3796 
obj_Ãxt
 = 
obj_lo£
->
Ãxt_cÚ‹Á
;

3798 ià(
	`numb”_¿nge
(1, 2 * 
Ëv–
è< 
obj_lo£
->level

3799 || 
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_FIRE
)

3800 || 
	`IS_OBJ_STAT
(
obj_lo£
, 
ITEM_NONMETAL
)

3801 || 
	`IS_OBJ_STAT
(
obj_lo£
, 
ITEM_BURN_PROOF
))

3804 
obj_lo£
->
™em_ty³
) {

3805 
ITEM_ARMOR
:

3806 ià(
obj_lo£
->
w—r_loc
 != -1) {

3807 ià(
	`ÿn_drİ_obj
(
viùim
, 
obj_lo£
)

3808 && (
obj_lo£
->
weight
 / 10è< 
	`numb”_¿nge
(1, 2 * 
	`GET_ATTR_DEX
(
viùim
))

3809 && 
	`»move_obj
(
viùim
, 
obj_lo£
->
w—r_loc
, 
Œue
)) {

3810 
	`aù
("$Ày–p ªdhrow $°tØthground!", 
viùim
, 
obj_lo£
, 
nuÎ±r
, 
TO_ROOM
);

3811 
	`aù
("You„emovªd drİ $°befÜ™ buº you.", 
viùim
, 
obj_lo£
, 
nuÎ±r
, 
TO_CHAR
);

3812 
dam
 +ğ(
	`numb”_¿nge
(1, 
obj_lo£
->
Ëv–
) / 3);

3813 
	`obj_äom_ch¬
(
obj_lo£
);

3815 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


3816 || 
	`ch¬_š_d¬’a_room
(
viùim
))

3817 
	`obj_to_ch¬
(
obj_lo£
, 
viùim
);

3819 
	`obj_to_room
(
obj_lo£
, 
viùim
->
š_room
);

3822 
	`aù
("You¸skš i £¬ed by $p!", 
viùim
, 
obj_lo£
, 
nuÎ±r
, 
TO_CHAR
);

3823 
dam
 +ğ(
	`numb”_¿nge
(1, 
obj_lo£
->
Ëv–
));

3827 ià(
	`ÿn_drİ_obj
(
viùim
, 
obj_lo£
)) {

3828 
	`aù
("$Ày–p ªdhrow $°tØthground!", 
viùim
, 
obj_lo£
, 
nuÎ±r
, 
TO_ROOM
);

3829 
	`aù
("You y–°ªd drİ $°befÜ™ buº you.", 
viùim
, 
obj_lo£
, 
nuÎ±r
, 
TO_CHAR
);

3830 
dam
 +ğ(
	`numb”_¿nge
(1, 
obj_lo£
->
Ëv–
) / 6);

3831 
	`obj_äom_ch¬
(
obj_lo£
);

3833 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


3834 || 
	`ch¬_š_d¬’a_room
(
viùim
))

3835 
	`obj_to_ch¬
(
obj_lo£
, 
viùim
);

3837 
	`obj_to_room
(
obj_lo£
, 
viùim
->
š_room
);

3840 
	`aù
("You¸skš i £¬ed by $p!", 
viùim
, 
obj_lo£
, 
nuÎ±r
, 
TO_CHAR
);

3841 
dam
 +ğ(
	`numb”_¿nge
(1, 
obj_lo£
->
Ëv–
) / 2);

3847 
ITEM_WEAPON
:

3848 ià(
obj_lo£
->
w—r_loc
 != -1) {

3849 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj_lo£
,‡fãù::
ty³
::
w—pÚ_æamšg
))

3852 ià(
	`ÿn_drİ_obj
(
viùim
, 
obj_lo£
)

3853 && 
	`»move_obj
(
viùim
, 
obj_lo£
->
w—r_loc
, 
Œue
)) {

3854 
	`aù
("$Ài buºed by $p,‡ndhrow ™Øthground.", 
viùim
, 
obj_lo£
, 
nuÎ±r
, 
TO_ROOM
);

3855 
	`¡c
("Youhrow you¸»d-hÙ w—pÚØthground!\n", 
viùim
);

3856 
dam
 += 1;

3857 
	`obj_äom_ch¬
(
obj_lo£
);

3859 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


3860 || 
	`ch¬_š_d¬’a_room
(
viùim
))

3861 
	`obj_to_ch¬
(
obj_lo£
, 
viùim
);

3863 
	`obj_to_room
(
obj_lo£
, 
viùim
->
š_room
);

3866 
	`¡c
("You¸w—pÚ s—r you¸æesh!\n", 
viùim
);

3867 
dam
 +ğ
	`numb”_¿nge
(1, 
obj_lo£
->
Ëv–
);

3871 ià(
	`ÿn_drİ_obj
(
viùim
, 
obj_lo£
)) {

3872 
	`aù
("$Àthrow ¨buºšg hÙ $°tØthground!", 
viùim
, 
obj_lo£
, 
nuÎ±r
, 
TO_ROOM
);

3873 
	`aù
("You drİ $°befÜ™ buº you.", 
viùim
, 
obj_lo£
, 
nuÎ±r
, 
TO_CHAR
);

3874 
dam
 +ğ(
	`numb”_¿nge
(1, 
obj_lo£
->
Ëv–
) / 6);

3875 
	`obj_äom_ch¬
(
obj_lo£
);

3877 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


3878 || 
	`ch¬_š_d¬’a_room
(
viùim
))

3879 
	`obj_to_ch¬
(
obj_lo£
, 
viùim
);

3881 
	`obj_to_room
(
obj_lo£
, 
viùim
->
š_room
);

3884 
	`aù
("You¸skš i £¬ed by $p!", 
viùim
, 
obj_lo£
, 
nuÎ±r
, 
TO_CHAR
);

3885 
dam
 +ğ(
	`numb”_¿nge
(1, 
obj_lo£
->
Ëv–
) / 2);

3893 ià(
dam
 <= 0) {

3894 
	`¡c
("You¸¥–Èhad‚Øefãù.\n", 
ch
);

3895 
	`¡c
("You f“Èmom’ry w¬m”.\n", 
viùim
);

3898 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_FIRE
))

3899 
dam
 = 2 * dam / 3;

3901 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_FIRE
, 
Œue
,rue);

3903 
	}
}

3905 
	$¥–l_hŞy_wÜd
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

3907 
Ch¬aù”
 *
vch
;

3908 
Ch¬aù”
 *
vch_Ãxt
;

3910 ià(
ch
->
¡am
 > 0)

3911 
ch
->
¡am
 = 0;

3915 
	`aù
("$Àu‰” ¨wÜd oàdivšpow”!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3916 
	`¡c
("You u‰”‡ wÜd oàdivšpow”.\n", 
ch
);

3918 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = 
vch_Ãxt
) {

3919 
vch_Ãxt
 = 
vch
->
Ãxt_š_room
;

3921 ià((
	`IS_GOOD
(
ch
è&& IS_GOOD(
vch
))

3922 || (
	`IS_EVIL
(
ch
è&& IS_EVIL(
vch
))

3923 || (
	`IS_NEUTRAL
(
ch
è&& IS_NEUTRAL(
vch
))) {

3924 
	`¡c
("You f“ÈmÜpow”ful.\n", 
vch
);

3925 
	`¥–l_ä’zy
(
skl
::
ty³
::
ä’zy
, 
Ëv–
, 
ch
, (*è
vch
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

3926 
	`¥–l_bËss
(
skl
::
ty³
::
bËss
, 
Ëv–
, 
ch
, (*è
vch
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

3928 ià((
	`IS_GOOD
(
ch
è&& 
	`IS_EVIL
(
vch
))

3929 || (
	`IS_EVIL
(
ch
è&& 
	`IS_GOOD
(
vch
))) {

3930 ià(!
	`is_§ã_¥–l
(
ch
, 
vch
, 
Œue
)) {

3931 
	`¥–l_cur£
(
skl
::
ty³
::
cur£
, 
Ëv–
, 
ch
, (*è
vch
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

3932 
	`¡c
("You‡» sŒuck down!\n", 
vch
);

3933 
	`damage
(
ch
, 
vch
, 
	`diû
(
Ëv–
, 20), 
¢
, -1, 
DAM_ENERGY
, 
Œue
,rue);

3936 ià((
	`IS_NEUTRAL
(
ch
è&& !IS_NEUTRAL(
vch
))

3937 || (
	`IS_EVIL
(
ch
è&& 
	`IS_NEUTRAL
(
vch
))

3938 || (
	`IS_GOOD
(
ch
è&& 
	`IS_NEUTRAL
(
vch
))) {

3939 ià(!
	`is_§ã_¥–l
(
ch
, 
vch
, 
Œue
)) {

3940 
	`¥–l_cur£
(
skl
::
ty³
::
cur£
, 
Ëv–
 / 2, 
ch
, (*è
vch
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

3941 
	`¡c
("You‡» sŒuck down!\n", 
vch
);

3942 
	`damage
(
ch
, 
vch
, 
	`diû
(
Ëv–
, 6), 
¢
, -1, 
DAM_ENERGY
, 
Œue
,rue);

3947 
	`¡c
("You f“Èd¿šed.\n", 
ch
);

3948 
ch
->
h™
 -= (ch->hit / 3);

3949 
	}
}

3951 
	$¥–l_im´št
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
)

3953 
Objeù
 *
obj
 = (Objeù *è
vo
;

3954 
SŒšg
 
buf
;

3955 
¥_¦Ù
, 
i
, 
mªa
;

3958 ià(
ch
 =ğ
vo
)

3961 cÚ¡‡uto& 
’Œy
 = 
skl
::
	`lookup
(
¢
);

3963 ià(
’Œy
.
¥–l_fun
 =ğ
¥–l_nuÎ
) {

3964 
	`¡c
("Th© i nÙ‡ s³Î.\n", 
ch
);

3969 
¥_¦Ù
 = 
i
 = 1; i < 4; i++)

3970 ià(
obj
->
v®ue
[
i
] != -1)

3971 
¥_¦Ù
++;

3973 ià(
¥_¦Ù
 > 3) {

3974 
	`aù
("$°ÿÂÙ cÚš‡ny mÜ¥–ls.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

3979 
mªa
 = (2 * 
	`g‘_skl_co¡
(
ch
, 
¢
));

3981 ià(!
ch
->
	`is_Åc
(è&& ch->
mªa
 < mana) {

3982 
	`¡c
("You dÚ'ˆhav’ough mªa.\n", 
ch
);

3986 ià(
	`numb”_³rûÁ
(è> 
	`g‘_skl_Ëv–
(
ch
, 
¢
)) {

3987 
	`¡c
("You†o¡ you¸cÚûÁ¿tiÚ.\n", 
ch
);

3988 
	`check_im´ove
(
ch
, 
¢
, 
çl£
, 1);

3989 
ch
->
mªa
 -= mana / 2;

3994 
ch
->
mªa
 -= mana;

4000 
¥_¦Ù
) {

4002 
Loggšg
::
	`bug
("¥_¦Ù ha mÜthª %d s³Îs.", 
¥_¦Ù
);

4009 ià(
	`numb”_³rûÁ
(è> (25 + ((
	`GET_ATTR
(
ch
, 
APPLY_BREW_UNIQUE
) / 2) +

4010 
	`GET_ATTR
(
ch
, 
APPLY_SCRIBE_UNIQUE
) / 2))) {

4011 
	`±c
(
ch
, "Thmagiø’chªtm’ˆha çed ---h% vªishes.\n", 
	`™em_ty³_Çme
(
obj
));

4012 
	`de¡roy_obj
(
obj
);

4019 ià(
	`numb”_³rûÁ
(è> (5 + ((
	`GET_ATTR
(
ch
, 
APPLY_BREW_UNIQUE
) / 4) +

4020 
	`GET_ATTR
(
ch
, 
APPLY_SCRIBE_UNIQUE
) / 4))) {

4021 
	`±c
(
ch
, "Thmagiø’chªtm’ˆha çed ---h% vªishes.\n", 
	`™em_ty³_Çme
(
obj
));

4022 
	`de¡roy_obj
(
obj
);

4030 
obj
->
v®ue
[
¥_¦Ù
] = ()
¢
;

4033 
FÜm©
::
	`¥rštf
(
buf
, "¨% oà", 
	`™em_ty³_Çme
(
obj
));

4035 
i
 = 1; i <ğ
¥_¦Ù
 ; i++)

4036 ià(
obj
->
v®ue
[
i
] != -1) {

4037 
buf
 +ğ
’Œy
.
Çme
;

4038 
buf
 +ğ(
i
 !ğ
¥_¦Ù
) ? ", " : "";

4041 
obj
->
shÜt_desü
 = 
buf
;

4042 
FÜm©
::
	`¥rštf
(
buf
, "A % oà", 
	`™em_ty³_Çme
(
obj
));

4044 
i
 = 1; i <ğ
¥_¦Ù
 ; i++)

4045 ià(
obj
->
v®ue
[
i
] != -1) {

4046 
buf
 +ğ
’Œy
.
Çme
;

4047 
buf
 +ğ(
i
 !ğ
¥_¦Ù
) ? ", " : "†ies here.\n";

4050 
obj
->
desütiÚ
 = 
buf
;

4051 
FÜm©
::
	`¥rštf
(
buf
, "%s", 
	`™em_ty³_Çme
(
obj
));

4053 
i
 = 1; i <ğ
¥_¦Ù
 ; i++)

4054 ià(
obj
->
v®ue
[
i
] != -1) {

4055 
buf
 += " ";

4056 
buf
 +ğ
’Œy
.
Çme
;

4059 
obj
->
Çme
 = 
buf
;

4060 
	`±c
(
ch
, "You havimbued‡‚ew s³ÎØth%s.\n", 
	`™em_ty³_Çme
(
obj
));

4061 
	}
}

4063 
	$¥–l_id’tify
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4065 
Objeù
 *
obj
 = (Objeù *è
vo
;

4066 
buf
[
MAX_STRING_LENGTH
];

4067 
	sw—r_ty³
 {

4068 
SŒšg
 
loc
;

4069 
FÏgs
::
B™
 
b™
;

4071 cÚ¡ 
¡d
::
veùÜ
<
w—r_ty³
> 
w—¾oc_bË
 = {

4072 { "bwÜÀÚ you¸fšg”", 
FÏgs
::
B
 },

4073 { "bwÜÀ¬ound you¸Ãck", 
FÏgs
::
C
 },

4074 { "bwÜÀÚ you¸tÜso", 
FÏgs
::
D
 },

4075 { "bwÜÀÚ you¸h—d", 
FÏgs
::
E
 },

4076 { "bwÜÀÚ you¸Ëgs", 
FÏgs
::
F
 },

4077 { "bwÜÀÚ you¸ã‘", 
FÏgs
::
G
 },

4078 { "bwÜÀÚ you¸hªds", 
FÏgs
::
H
 },

4079 { "bwÜÀÚ you¸¬ms", 
FÏgs
::
I
 },

4080 { "bwÜÀa ¨sh›ld", 
FÏgs
::
J
 },

4081 { "bwÜÀabouˆyou¸body", 
FÏgs
::
K
 },

4082 { "bwÜÀ¬ound you¸wai¡", 
FÏgs
::
L
 },

4083 { "bwÜÀÚ you¸wri¡", 
FÏgs
::
M
 },

4084 { "bu£d‡ ¨w—pÚ", 
FÏgs
::
N
 },

4085 { "bh–d", 
FÏgs
::
O
 },

4086 { "æßˆÃxˆtØyou", 
FÏgs
::
Q
 },

4087 { "bwÜÀÚ you¸ršgfšg”", 
FÏgs
::
R
 },

4091 ià(
ch
 =ğ
vo
)

4094 
	`±c
(
ch
, "Object '%s' isype %s,ƒxtra flags %s.\n",

4095 
obj
->
Çme
, 
	`™em_ty³_Çme
(obj), 
	`exŒa_b™_Çme
(obj->
exŒa_æags
+obj->
ÿched_exŒa_æags
));

4096 
	`±c
(
ch
, "Weight is %d, value is %d,†evel is %d,‡nd material is %s.\n",

4097 
obj
->
weight
 / 10, obj->
co¡
, obj->
Ëv–
, obj->
m©”Ÿl
);

4098 
FÜm©
::
	`¥rštf
(
buf
, ".");

4100 cÚ¡‡uto& 
’Œy
 : 
w—¾oc_bË
)

4101 ià(
	`CAN_WEAR
(
obj
, 
’Œy
.
b™
)) {

4102 
FÜm©
::
	`¥rštf
(
buf
, ",‡nd cª %s.", 
’Œy
.
loc
);

4106 
	`±c
(
ch
, "The object's condition is %s [%d]%s\n",

4107 
	`cÚd™iÚ_lookup
(
obj
->
cÚd™iÚ
), obj->cÚd™iÚ, 
buf
);

4109 
CÏn
 *
şª
;

4110 ià((
şª
 = 
	`şª_vnum_lookup
(
obj
->
pIndexD©a
->
vnum
)è!ğ
nuÎ±r
)

4111 
	`±c
(
ch
, "{YThi ™em b–Úg tØ%s{Y.{x\n", 
şª
->
şªÇme
);

4113 ià(
obj
->
pIndexD©a
->
gud
 !ğ
Gud
::
nÚe
){

4114 
gudÇme
 = 
obj
->
pIndexD©a
->
gud
;

4115 
	`±c
(
ch
, "{YThi ™em cª oÆy bu£d by‡ %s{Y.{x\n", 
gud_bË
[
gudÇme
].
Çme
 );

4118 ià(
obj
->
exŒa_desü
 !ğ
nuÎ±r
) {

4119 
ExŒaDesü
 *
ed_Ãxt
;

4120 
ExŒaDesü
 *
ed
;

4122 
ed
 = 
obj
->
exŒa_desü
;ƒd !ğ
nuÎ±r
;ƒd = 
ed_Ãxt
) {

4123 
ed_Ãxt
 = 
ed
->
Ãxt
;

4125 ià(
ed
->
keywÜd
 =ğ
KEYWD_OWNER
) {

4126 
	`±c
(
ch
, "{CThi ™em i owÃd by %s.{x\n", 
ed
->
desütiÚ
);

4132 
obj
->
™em_ty³
) {

4133 
ITEM_SCROLL
:

4134 
ITEM_POTION
:

4135 
ITEM_PILL
:

4136 
	`±c
(
ch
, "Lev– %d s³Î of:", 
obj
->
v®ue
[0]);

4138 
i
 = 1; i <= 4; i++) {

4139 
skl
::
ty³
y³ = skl::
	`äom_št
(
obj
->
v®ue
[
i
]);

4141 ià(
ty³
 !ğ
skl
::ty³::
unknown
)

4142 
	`±c
(
ch
, " '%s'", 
skl
::
	`lookup
(
ty³
).
Çme
);

4145 
	`¡c
(".\n", 
ch
);

4148 
ITEM_WAND
:

4149 
ITEM_STAFF
:

4150 
	`±c
(
ch
, "Ha %d ch¬ge oàËv– %d", 
obj
->
v®ue
[2], obj->value[0]);

4151 
	`±c
(
ch
, " '%s'", 
skl
::
	`lookup
(skl::
	`äom_št
(
obj
->
v®ue
[3])).
Çme
);

4153 
	`¡c
(".\n", 
ch
);

4156 
ITEM_DRINK_CON
:

4157 
	`±c
(
ch
, "It holds %s-colored %s.\n",

4158 
liq_bË
[
obj
->
v®ue
[2]].
cŞÜ
,†iq_bË[obj->v®ue[2]].
Çme
);

4161 
ITEM_CONTAINER
:

4162 
	`±c
(
ch
, "Capacity: %d# Maximum weight: %d# flags: %s\n",

4163 
obj
->
v®ue
[0], obj->v®ue[3], 
	`cÚt_b™_Çme
(obj->value[1]));

4165 ià(
obj
->
v®ue
[4] != 100)

4166 
	`±c
(
ch
, "WeighˆmuÉl›r: %d%%\n", 
obj
->
v®ue
[4]);

4170 
ITEM_WEAPON
:

4171 
	`¡c
("W—pÚy³ i ", 
ch
);

4173 
obj
->
v®ue
[0]) {

4174 (
WEAPON_EXOTIC
è: 
	`¡c
("exÙic.\n", 
ch
); ;

4176 (
WEAPON_SWORD
è: 
	`¡c
("swÜd.\n", 
ch
); ;

4178 (
WEAPON_DAGGER
è: 
	`¡c
("dagg”.\n", 
ch
); ;

4180 (
WEAPON_SPEAR
è: 
	`¡c
("¥—r/¡aff.\n", 
ch
); ;

4182 (
WEAPON_MACE
è: 
	`¡c
("maû/şub.\n", 
ch
); ;

4184 (
WEAPON_AXE
è: 
	`¡c
("axe.\n", 
ch
); ;

4186 (
WEAPON_FLAIL
è: 
	`¡c
("æa.\n", 
ch
); ;

4188 (
WEAPON_WHIP
è: 
	`¡c
("wh.\n", 
ch
); ;

4190 (
WEAPON_POLEARM
): 
	`¡c
("pŞ—rm.\n", 
ch
); ;

4192 (
WEAPON_BOW
è: 
	`¡c
("bow.\n", 
ch
); ;

4194  : 
	`¡c
("unknown.\n", 
ch
); ;

4197 
	`±c
(
ch
, "Damage is %dd%d (average %d).\n",

4198 
obj
->
v®ue
[1], obj->value[2], (1 + obj->value[2]) * obj->value[1] / 2);

4202 
ITEM_ARMOR
:

4203 
	`±c
(
ch
, "Armor class is %d…ierce, %d bash, %d slash,‡nd %d vs. magic.\n",

4204 
obj
->
v®ue
[0], obj->value[1], obj->value[2], obj->value[3]);

4207 
ITEM_MATERIAL
:

4208 
	`±c
(
ch
, "Skill modifier: %d, Dice Bonus %d, Sides Bonus %d\n",

4209 
obj
->
v®ue
[0], obj->value[1], obj->value[2]);

4213 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
)

4214 
	`show_afãù_to_ch¬
(
·f
, 
ch
);

4216 ià(
obj
->
gems
) {

4217 
Objeù
 *
gem
 = 
obj
->
gems
; gem; gem = gem->
Ãxt_cÚ‹Á
)

4218 
	`±c
(
ch
, "Has‡ gem %s ofype %d with quality %d.\n",

4219 
gem
->
shÜt_desü
, gem->
v®ue
[0], gem->value[1]);

4221 
	`¡c
("Gem ¬addšg:", 
ch
);

4223 cÚ¡ 
afãù
::
Afãù
 *
·f
 = 
obj
->
gem_afãùed
;…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
)

4224 
	`show_afãù_to_ch¬
(
·f
, 
ch
);

4226 
	}
}

4228 
	$¥–l_šäavisiÚ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4230 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

4232 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
night_visiÚ
)) {

4233 ià(
viùim
 =ğ
ch
)

4234 
	`¡c
("You cª‡Ì—dy s“ iÀthd¬k.\n", 
ch
);

4236 
	`aù
("$N‡Ì—dy ha ’hªûd visiÚ.\n", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4241 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

4242 
afãù
::
ty³
::
night_visiÚ
,

4243 
Ëv–
,

4244 
Ëv–
 * 2,

4245 
evŞutiÚ
,

4246 
çl£


4249 
	`¡c
("You¸eye glow„ed.\n", 
viùim
);

4250 
	`aù
("$n' eye glow„ed.\n", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4251 
	}
}

4253 
	$¥–l_švis
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4255 
Ch¬aù”
 *
viùim
;

4256 
Objeù
 *
obj
;

4257 
afãù
::
Afãù
 
af
;

4260 ià(
rg‘
 =ğ
TARGET_OBJ
) {

4261 
obj
 = (
Objeù
 *è
vo
;

4263 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_INVIS
)) {

4264 
	`aù
("$°i ®»ady invisibË.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

4268 
af
.
wh”e
 = 
TO_OBJECT
;

4269 
af
.
ty³
 = 
afãù
::ty³::
švis
;

4270 
af
.
Ëv–
 =†evel;

4271 
af
.
du¿tiÚ
 = 
Ëv–
 + 12;

4272 
af
.
loÿtiÚ
 = 
APPLY_NONE
;

4273 
af
.
modif›r
 = 0;

4274 
af
.
	`b™veùÜ
(
ITEM_INVIS
);

4275 
af
.
evŞutiÚ
 =ƒvolution;

4276 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

4277 
	`aù
("$°çde ouˆoàsight.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

4282 
viùim
 = (
Ch¬aù”
 *è
vo
;

4284 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
švis
)) {

4285 ià(
viùim
 =ğ
ch
)

4286 
	`¡c
("You‡»‡Ì—dy invisibË!\n", 
ch
);

4288 
	`aù
("$N i ®»ady invisibË!\n", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4293 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

4294 
afãù
::
ty³
::
švis
,

4295 
Ëv–
,

4296 
Ëv–
 + 12,

4297 
evŞutiÚ
,

4298 
çl£


4301 
	`¡c
("You fadouˆoàexi¡’û.\n", 
viùim
);

4302 
	`aù
("$Àçde ouˆoàexi¡’û.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4303 
	}
}

4305 
	$¥–l_know_®ignm’t
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4307 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

4308 *
msg
;

4309 
­
 = 
viùim
->
®ignm’t
;

4311 ià(
­
 > 700è
msg
 = "$N has‡…ure‡nd good‡ura.";

4312 ià(
­
 > 350è
msg
 = "$N is ofƒxcellent moral character.";

4313 ià(
­
 > 100è
msg
 = "$N is often kind‡ndhoughtful.";

4314 ià(
­
 > -100è
msg
 = "$N doesn't have‡ firm moral commitment.";

4315 ià(
­
 > -350è
msg
 = "$N†ieso $S friends.";

4316 ià(
­
 > -700è
msg
 = "$N is‡ black-hearted murderer.";

4317 
msg
 = "$N isheƒmbodiment of…ureƒvil!";

4319 
	`aù
(
msg
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4320 
	}
}

4322 
	$¥–l_lighŠšg_bŞt
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4324 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

4325 
dam
;

4326 cÚ¡ 
dam_—ch
[] = {

4334 
Ëv–
 = 
¡d
::
	`mš
Öev–, ()((
dam_—ch
) / (dam_each[0])) - 1);

4335 
Ëv–
 = 
¡d
::
	`max
(0,†evel);

4336 
dam
 = 
	`numb”_¿nge
(
dam_—ch
[
Ëv–
] / 2, dam_each[level] * 2);

4338 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_ELECTRICITY
))

4339 
dam
 /= 2;

4341 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_ELECTRICITY
 , 
Œue
,rue);

4342 
	}
}

4345 
	$¥–l_loÿ‹_liã
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4347 
buf
[
MAX_STRING_LENGTH
];

4348 
SŒšg
 
bufãr
;

4349 
boŞ
 
found
 = 
çl£
;

4350 
numb”
 = 0, 
max_found
 = 2 * 
Ëv–
;

4352 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

4353 ià(!
	`ÿn_£e_ch¬
(
ch
 , 
viùim
)

4354 || !
viùim
->
Çme
.
	`has_wÜds
(
rg‘_Çme
)

4355 || 
viùim
->
š_room
 =ğ
nuÎ±r


4356 || 
	`numb”_³rûÁ
(è> 2 * 
Ëv–


4357 || 
ch
->
Ëv–
 < 
viùim
->level

4358 || !
	`ÿn_£e_room
(
ch
, 
viùim
->
š_room
)

4359 || 
viùim
->
š_room
->
	`æags
().
	`has_ªy_of
(

4360 
ROOM_PRIVATE
 | 
ROOM_IMP_ONLY
 | 
ROOM_GODS_ONLY
 | 
ROOM_NOWHERE
))

4363 
found
 = 
Œue
;

4364 
numb”
++;

4365 
FÜm©
::
	`¥rštf
(
buf
, "[%d] %s is†ocated‡t %s\n",

4366 
numb”
, 
viùim
->
	`is_Åc
(è? viùim->
shÜt_desü
 : viùim->
Çme
, viùim->
š_room
->
	`Çme
());

4367 
buf
[0] = 
	`touµ”
(buf[0]);

4368 
bufãr
 +ğ
buf
;

4370 ià(
numb”
 >ğ
max_found
)

4374 ià(!
found
)

4375 
	`¡c
("NØÚ¬ound‡µ—r tØgØbyh©‚ame.\n", 
ch
);

4377 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

4379 
	}
}

4381 
	$¥–l_loÿ‹_objeù
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4383 
buf
[
MAX_STRING_LENGTH
];

4385 
Objeù
 *
obj
, *
š_obj
;

4386 
boŞ
 
found
 = 
çl£
;

4387 
numb”
 = 0, 
max_found
 = 2 * 
Ëv–
;

4390 
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt
) {

4391 ià(!
	`ÿn_£e_obj
(
ch
, 
obj
)

4392 || !
obj
->
Çme
.
	`has_wÜds
(
rg‘_Çme
)

4393 || 
	`IS_OBJ_STAT
(
obj
, 
ITEM_NOLOCATE
)

4394 || 
	`numb”_³rûÁ
(è> 2 * 
Ëv–


4395 || 
ch
->
Ëv–
 < 
obj
->level)

4398 
found
 = 
Œue
;

4399 
numb”
++;

4401 
š_obj
 = 
obj
; in_obj->š_obj !ğ
nuÎ±r
; in_obj = in_obj->in_obj)

4404 ià(
š_obj
->
ÿ¼›d_by
 !ğ
nuÎ±r
 && 
	`ÿn_£e_ch¬
(
ch
, in_obj->carried_by))

4405 
FÜm©
::
	`¥rštf
(
buf
, "% i ÿ¼›d by %s\n", 
obj
->
shÜt_desü
, 
	`PERS
(
š_obj
->
ÿ¼›d_by
, 
ch
, 
VIS_CHAR
));

4407 ià(
	`IS_IMMORTAL
(
ch
è&& 
š_obj
->
š_room
 !ğ
nuÎ±r
)

4408 
FÜm©
::
	`¥rštf
(
buf
, "%s is in %s [Room %s]\n",

4409 
obj
->
shÜt_desü
, 
š_obj
->
š_room
->
	`Çme
(), in_obj->š_room->
loÿtiÚ
.
	`to_¡ršg
());

4411 
FÜm©
::
	`¥rštf
(
buf
, "%s is in %s\n",

4412 
obj
->
shÜt_desü
, 
š_obj
->
š_room
 =ğ
nuÎ±r
 ? "somewh”e" : in_obj->š_room->
	`Çme
());

4415 
buf
[0] = 
	`touµ”
(buf[0]);

4417 
	`¡c
(
buf
, 
ch
);

4419 ià(
numb”
 >ğ
max_found
)

4423 ià(!
found
)

4424 
	`¡c
("NÙhšg†ikth© iÀh—v’ o¸—¹h.\n", 
ch
);

4425 
	}
}

4429 
	$¥–l_magic_misse
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4431 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

4448 
couÁ
 = 1;

4450 
evŞutiÚ
){

4452 
couÁ
 +ğ
Ëv–
 / 15;

4456 
couÁ
 +ğ
Ëv–
 / 22;

4460 
couÁ
 +ğ
Ëv–
 / 45;

4467 
couÁ
) {

4469 
	`¡c
("Youƒx‹nd you¸·lm‡nd†‘ fly‡ magiømisse!\n", 
ch
);

4470 
	`aù
("$Àex‹nd $ ·lm‡nd†‘ æy‡ magiømisse!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4474 
	`¡c
("Youƒx‹nd you¸·lm‡nd†‘ fly‡ bur¡ oàmagiømisses!\n", 
ch
);

4475 
	`aù
("$Àex‹nd $ ·lm‡nd†‘ æy‡ bur¡ oàmagiømisses!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4479 
	`¡c
("Youƒx‹nd you¸·lm‡nd†‘ fly‡ flu¼y oàmagiømisses!\n", 
ch
);

4480 
	`aù
("$Àex‹nd $ ·lm‡nd†‘ æy‡ flu¼y oàmagiømisses!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4484 
	`¡c
("Youƒx‹nd you¸·lm‡nd uÆ—sh‡ deva¡©šg ha oàmagiømisses!\n", 
ch
);

4485 
	`aù
("$Àex‹nd $ ·lm‡nd uÆ—she ¨deva¡©šg ha oàmagiømisses!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4489 
i
 = 0; i < 
couÁ
; i++) {

4491 
dam
 = 4 + 
Ëv–
 / 5;

4492 
dam
 = 
	`numb”_¿nge
(dam / 2, dam * 2);

4494 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_ENERGY
))

4495 
dam
 /= 2;

4497 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_ENERGY
, 
Œue
,rue);

4499 ià(
ch
->
fightšg
 !ğ
nuÎ±r
) {

4500 ià(
evŞutiÚ
 >ğ3 && 
	`numb”_³rûÁ
() > 85) {

4501 
	`¡c
("You¸magiømisssw¬m ™ rg‘!!!!\n", 
ch
);

4502 
	`aù
("$Àmagiømisssw¬m thrg‘!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4503 
	`damage
(
ch
, 
viùim
, 
dam
 / 2, 
¢
, -1, 
DAM_ENERGY
, 
Œue
,rue);

4507 ià(
ch
->
fightšg
 =ğ
nuÎ±r
)

4510 
	}
}

4512 
	$¥–l_mass_h—lšg
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4514 
Ch¬aù”
 *
gch
;

4516 
gch
 = 
ch
->
š_room
->
³İË
; gch !ğ
nuÎ±r
; gch = gch->
Ãxt_š_room
) {

4517 ià((
ch
->
	`is_Åc
(è&& 
gch
->is_npc())

4518 || (!
ch
->
	`is_Åc
(è&& !
gch
->is_npc())) {

4519 
	`¥–l_h—l
(
skl
::
ty³
::
h—l
, 
Ëv–
, 
ch
, (*è
gch
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

4520 
	`¥–l_»äesh
(
skl
::
ty³
::
»äesh
, 
Ëv–
, 
ch
, (*è
gch
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

4523 
	}
}

4525 
	$¥–l_mass_švis
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4527 
Ch¬aù”
 *
gch
;

4529 
gch
 = 
ch
->
š_room
->
³İË
; gch !ğ
nuÎ±r
; gch = gch->
Ãxt_š_room
) {

4530 ià(!
	`is_§me_group
(
gch
, 
ch
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(gch,‡fãù::
ty³
::
švis
))

4533 
	`aù
("$À¦owly fade ouˆoàexi¡’û.", 
gch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4534 
	`¡c
("You slowly fadouˆoàexi¡’û.\n", 
gch
);

4536 
afãù
::
	`add_ty³_to_ch¬
(
gch
,

4537 
afãù
::
ty³
::
švis
,

4538 
Ëv–
/2,

4540 
evŞutiÚ
,

4541 
çl£


4545 
	`¡c
("Ok.\n", 
ch
);

4546 
	}
}

4548 
	$¥–l_Ãxus
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4550 
Ch¬aù”
 *
viùim
;

4551 
Objeù
 *
pÜl
, *
¡Úe
;

4552 
Room
 *
to_room
, *
äom_room
;

4553 
äom_room
 = 
ch
->
š_room
;

4555 ià(
äom_room
 =ğ
nuÎ±r
)

4558 ià(
	`IS_IMMORTAL
(
ch
)) {

4559 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

4560 
	`¡c
("You cªnÙ fšdhem.\n", 
ch
);

4564 ià(
viùim
 =ğ
ch


4565 || (
to_room
 = 
viùim
->
š_room
è=ğ
nuÎ±r


4566 || 
to_room
 =ğ
äom_room


4567 || !
	`ÿn_£e_room
(
ch
, 
to_room
)

4568 || !
	`ÿn_£e_room
(
ch
, 
äom_room
)) {

4569 
	`¡c
("You faed.\n", 
ch
);

4574 ià(
äom_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()) {

4575 
	`¡c
("You cªnÙ‚exu whšhque¡‡»a.\n", 
ch
);

4579 ià(
äom_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
 || 
	`ch¬_š_du–_room
(
ch
)) {

4580 
	`¡c
("You cªnÙ‚exu whšh¬’a.\n", 
ch
);

4584 ià(
ch
->
fightšg


4585 || (
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r


4586 || 
viùim
 =ğ
ch


4587 || (
	`IS_IMMORTAL
(
viùim
è&& !IS_IMMORTAL(
ch
))

4588 || (
to_room
 = 
viùim
->
š_room
è=ğ
nuÎ±r


4589 || 
to_room
 =ğ
äom_room


4590 || 
to_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()

4591 || !
	`ÿn_£e_room
(
ch
, 
to_room
)

4592 || !
	`ÿn_£e_room
(
ch
, 
äom_room
)

4593 || 
to_room
->
	`æags
().
	`has_ªy_of
(
ROOM_SAFE
 | 
ROOM_PRIVATE
 | 
ROOM_SOLITARY
)

4594 || 
to_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


4595 || 
	`ch¬_š_du–_room
(
viùim
)

4596 || 
to_room
->
	`şª
(è|| 
äom_room
->clan()

4597 || 
to_room
->
	`gud
(è!ğ
Gud
::
nÚe


4598 || 
äom_room
->
	`gud
(è!ğ
Gud
::
nÚe


4599 || 
viùim
->
Ëv–
 >ğËv– + (viùim->
	`is_Åc
() ? 3 : 8)

4600 || (
viùim
->
	`is_Åc
()

4601 && (
viùim
->
aù_æags
.
	`has
(
ACT_NOSUMMON
)

4602 || 
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_OTHER
)))) {

4603 
	`¡c
("You faed.\n", 
ch
);

4608 
¡Úe
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_HOLD
);

4610 ià(!
	`IS_IMMORTAL
(
ch
è&& (
¡Úe
 =ğ
nuÎ±r
 || stÚe->
™em_ty³
 !ğ
ITEM_WARP_STONE
)) {

4611 
	`¡c
("You†ackh´İ” compÚ’ˆfÜhi ¥–l.\n", 
ch
);

4615 ià(
¡Úe
 !ğ
nuÎ±r
 && stÚe->
™em_ty³
 =ğ
ITEM_WARP_STONE
) {

4616 
	`aù
("You d¿w upÚhpow” oà$p.\nIˆæ¬e brighy‡nd vªishes!", 
ch
, 
¡Úe
, 
nuÎ±r
, 
TO_CHAR
);

4617 
	`de¡roy_obj
(
¡Úe
);

4621 
pÜl
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_PORTAL
), 0);

4623 ià(! 
pÜl
) {

4624 
Loggšg
::
	`bug
("Memoryƒrror in spell_nexus --…ortal one.", 0);

4625 
	`¡c
("You w”uÇbËØü—‹‡…Ül.\n", 
ch
);

4629 
pÜl
->
tim”
 = 1 + 
Ëv–
 / 10;

4630 
pÜl
->
v®ue
[3] = 
to_room
->
loÿtiÚ
.
	`to_št
();

4631 
	`obj_to_room
(
pÜl
, 
äom_room
);

4632 
	`aù
("$°ri£ u°äomhground.", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_ROOM
);

4633 
	`aù
("$°ri£ u°befÜyou.", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_CHAR
);

4635 
pÜl
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_PORTAL
), 0);

4637 ià(! 
pÜl
) {

4638 
Loggšg
::
	`bug
("Memoryƒrror in spell_nexus --…ortalwo.", 0);

4639 
	`¡c
("You w”uÇbËØü—‹‡…Ül.\n", 
ch
);

4643 
pÜl
->
tim”
 = 1 + 
Ëv–
 / 10;

4644 
pÜl
->
v®ue
[3] = 
äom_room
->
loÿtiÚ
.
	`to_št
();

4645 
	`obj_to_room
(
pÜl
, 
to_room
);

4647 ià(
to_room
->
³İË
 !ğ
nuÎ±r
) {

4648 
	`aù
("$°ri£ u°äomhground.", 
to_room
->
³İË
, 
pÜl
, 
nuÎ±r
, 
TO_ROOM
);

4649 
	`aù
("$°ri£ u°äomhground.", 
to_room
->
³İË
, 
pÜl
, 
nuÎ±r
, 
TO_CHAR
);

4651 
	}
}

4653 
	$¥–l_nuÎ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4655 
	`¡c
("Th©' nÙ‡ s³Î!\n", 
ch
);

4656 
	}
}

4659 
	$¥–l_pŞymÜph
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4661 
Ch¬aù”
 *
viùim
;

4662 
Ch¬aù”
 *
mobe
;

4664 ià(
ch
->
	`is_Åc
()) {

4665 
	`¡c
("Mobe ÿÂÙ mÜph.\n", 
ch
);

4669 ià(
	`ch¬_š_du–
(
ch
)) {

4670 
	`¡c
("You cªnÙ…ŞymÜph whdu–lšg.\n", 
ch
);

4674 ià(
rg‘_Çme
.
	`em±y
()) {

4675 
	`¡c
("MÜph iÁØwh©?\n", 
ch
);

4679 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

4680 
	`¡c
("You faed.\n", 
ch
);

4684 ià(
ch
->
Ëv–
 < (
viùim
->level - 15)) {

4685 
	`¡c
("Th© c»©u» i toØpow”fuÈtØim™©e.\n", 
ch
);

4689 ià(
ch
->
desc
 =ğ
nuÎ±r
)

4692 ià(
ch
->
desc
->
Üigš®
 !ğ
nuÎ±r
) {

4693 
	`¡c
("You‡»‡Ì—dy mÜphed.\n", 
ch
);

4697 ià(
ch
 =ğ
viùim
) {

4698 
	`¡c
("Wh©? MÜph iÁØyour£lf?\n", 
ch
);

4702 ià(!
viùim
->
	`is_Åc
()) {

4703 
	`¡c
("You cª oÆy sw™ch iÁØmobes.\n", 
ch
);

4708 ià(
viùim
->
aù_æags
.
	`has
(
ACT_NOMORPH
)

4709 || 
	`GET_DEFENSE_MOD
(
viùim
, 
DAM_BASH
) >= 100

4710 || 
	`GET_DEFENSE_MOD
(
viùim
, 
DAM_PIERCE
) >= 100

4711 || 
	`GET_DEFENSE_MOD
(
viùim
, 
DAM_SLASH
) >= 100

4712 || 
	`GET_DEFENSE_MOD
(
viùim
, 
DAM_FIRE
) >= 100

4713 || 
	`GET_DEFENSE_MOD
(
viùim
, 
DAM_COLD
) >= 100

4714 || 
	`GET_DEFENSE_MOD
(
viùim
, 
DAM_ELECTRICITY
) >= 100

4715 || 
	`GET_DEFENSE_MOD
(
viùim
, 
DAM_ACID
) >= 100

4716 || 
	`GET_DEFENSE_MOD
(
viùim
, 
DAM_NEGATIVE
) >= 100

4717 || 
	`GET_DEFENSE_MOD
(
viùim
, 
DAM_HOLY
) >= 100) {

4718 
	`¡c
("Thgod hav»¡riùedhu£ oàthi ü—tu» fÜ mÜphšg.\n", 
ch
);

4722 
mobe
 = 
	`ü—‹_mobe
(
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
viùim
->
pIndexD©a
->
vnum
));

4724 ià(! 
mobe
) {

4725 
Loggšg
::
	`bug
("Memoryƒrror creating mob in spell_polymorph().", 0);

4726 
	`¡c
("You w”uÇbËØpŞymÜph.\n", 
ch
);

4730 
	`aù
("$ÀmÜph štØ$N!\n", 
ch
, 
nuÎ±r
, 
mobe
, 
TO_ROOM
);

4731 
mobe
->
aù_æags
 -ğ
ACT_AGGRESSIVE
;

4732 
mobe
->
aù_æags
 -ğ
ACT_IS_HEALER
;

4733 
mobe
->
aù_æags
 -ğ
ACT_IS_CHANGER
;

4734 
mobe
->
aù_æags
 +ğ
PLR_COLOR
;

4735 
mobe
->
aù_æags
 +ğ
ACT_MORPH
;

4737 
mobe
->
h™
 = 
	`ATTR_BASE
(mobe, 
APPLY_HIT
) = 100;

4738 
mobe
->
mªa
 = 
	`ATTR_BASE
(mobe, 
APPLY_MANA
) = 100;

4739 
mobe
->
¡am
 = 
	`ATTR_BASE
(mobe, 
APPLY_STAM
) = 100;

4740 
	`ATTR_BASE
(
mobe
, 
APPLY_HITROLL
) = 1;

4741 
	`ATTR_BASE
(
mobe
, 
APPLY_DAMROLL
) = 1;

4743 
mobe
->
damage
[
DICE_NUMBER
] = 1;

4744 
mobe
->
damage
[
DICE_TYPE
] = 1;

4745 
mobe
->
Ëv–
 = 1;

4746 
mobe
->
gŞd
 = 0;

4747 
mobe
->
sv”
 = 0;

4748 
	`ch¬_to_room
(
mobe
, 
ch
->
š_room
);

4749 
	`do_sw™ch
(
ch
, 
mobe
->
Çme
);

4750 
	`ch¬_äom_room
(
ch
);

4751 
	`ch¬_to_room
(
ch
, 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_LIMBO
))));

4752 
	}
}

4754 
	$¥–l_·ss_doÜ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4756 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

4758 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
·ss_doÜ
)) {

4759 ià(
viùim
 =ğ
ch
)

4760 
	`¡c
("You‡»‡Ì—dy ouˆoàpha£.\n", 
ch
);

4762 
	`aù
("$N i ®»ady shiáed ouˆoàpha£.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4767 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

4768 
afãù
::
ty³
::
·ss_doÜ
,

4769 
Ëv–
,

4770 
	`numb”_fuzzy
(
Ëv–
/4),

4771 
evŞutiÚ
,

4772 
çl£


4775 
	`aù
("$Àtuº Œª¦uûÁ.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4776 
	`¡c
("Youuº¿n¦uûÁ.\n", 
viùim
);

4777 
	}
}

4779 
	$¥»ad_¶ague
(
Room
 *
room
, cÚ¡ 
afãù
::
Afãù
 *
¶ague
, 
chªû
) {

4780 ià(
room
 =ğ
nuÎ±r
 || 
¶ague
 ==‚ullptr)

4783 ià(
¶ague
->
Ëv–
 <= 1)

4786 
Ch¬aù”
 *
vch
 = 
room
->
³İË
; vch; vch = vch->
Ãxt_š_room
) {

4787 ià(!
	`§ves_¥–l
(
¶ague
->
Ëv–
 - 2, 
vch
, 
DAM_DISEASE
)

4788 && !
	`IS_IMMORTAL
(
vch
)

4789 && !
afãù
::
	`exi¡s_Ú_ch¬
(
vch
,‡fãù::
ty³
::
¶ague
)

4790 && 
	`numb”_b™s
(
chªû
) == 0) {

4791 
	`¡c
("You f“ÈhÙ‡nd fev”ish.\n", 
vch
);

4792 
	`aù
("$Àshiv” ªd†ook v”y iÎ.", 
vch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4794 
afãù
::
	`add_ty³_to_ch¬
(
vch
,

4795 
afãù
::
ty³
::
¶ague
,

4796 
¶ague
->
Ëv–
 - 1,

4797 
	`numb”_¿nge
(1, 2 * (
¶ague
->
Ëv–
 - 1)),

4798 
¶ague
->
evŞutiÚ
,

4799 
çl£


4803 
	}
}

4805 
	$¥–l_¶ague
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4807 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

4809 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
¶ague
)) {

4810 
	`aù
("$N i ®»ady di£a£d.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4814 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_DISEASE
)

4815 || (
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
ACT_UNDEAD
))) {

4816 ià(
ch
 =ğ
viùim
)

4817 
	`¡c
("You f“Èmom’ry iÎ, buˆ™…as£s.\n", 
ch
);

4819 
	`aù
("$N s“m tØbuÇfãùed.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4824 
	`¡c
("You sü—m iÀagÚy‡ ¶agusÜe ”u± from you¸skš.\n", 
viùim
);

4825 
	`aù
("$Àsü—m š‡gÚy‡ ¶agusÜe ”u± from $ skš.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4827 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

4828 
afãù
::
ty³
::
¶ague
,

4829 
Ëv–
 * 3 / 4,

4830 
Ëv–
,

4831 
evŞutiÚ
,

4832 
çl£


4834 
	}
}

4836 
	$¥–l_poisÚ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4838 
Ch¬aù”
 *
viùim
;

4839 
Objeù
 *
obj
;

4840 
afãù
::
Afãù
 
af
;

4842 ià(
rg‘
 =ğ
TARGET_OBJ
) {

4843 
obj
 = (
Objeù
 *è
vo
;

4845 ià(
obj
->
™em_ty³
 =ğ
ITEM_FOOD
 || obj->™em_ty³ =ğ
ITEM_DRINK_CON
) {

4846 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
)) {

4847 
	`aù
("You¸¥–Èç tØcÜru± $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

4851 
obj
->
v®ue
[3] = 1;

4852 
	`aù
("$°i šfu£d w™h…oisÚou v­Üs.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

4856 ià(
obj
->
™em_ty³
 =ğ
ITEM_WEAPON
) {

4857 ià(
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
poisÚ
)) {

4858 
	`aù
("$°i ®»adyƒnv’omed.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

4862 
af
.
wh”e
 = 
TO_WEAPON
;

4863 
af
.
ty³
 = 
afãù
::ty³::
poisÚ
;

4864 
af
.
Ëv–
 =†evel / 2;

4865 
af
.
du¿tiÚ
 = 
Ëv–
 / 4;

4866 
af
.
loÿtiÚ
 = 0;

4867 
af
.
modif›r
 = 0;

4868 
af
.
	`b™veùÜ
(0);

4869 
af
.
evŞutiÚ
 =ƒvolution;

4870 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

4871 
	`aù
("$°i cß‹d w™h d—dly v’om.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

4875 
	`aù
("You cª'ˆpoisÚ $p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

4879 
viùim
 = (
Ch¬aù”
 *è
vo
;

4881 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_POISON
)) {

4882 
	`aù
("$Àtuº ¦ighy g»’, buˆ™…as£s.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4883 
	`¡c
("You f“Èmom’ry iÎ, buˆ™…as£s.\n", 
viùim
);

4887 
	`¡c
("You f“Èv”y sick.\n", 
viùim
);

4888 
	`aù
("$Àlook v”y iÎ.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

4890 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

4891 
afãù
::
ty³
::
poisÚ
,

4892 
Ëv–
,

4893 
Ëv–
,

4894 
evŞutiÚ
,

4895 
çl£


4897 
	}
}

4899 
	$¥–l_pÜl
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4901 
Ch¬aù”
 *
viùim
;

4902 
Objeù
 *
pÜl
, *
¡Úe
;

4904 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

4907 ià(
	`IS_IMMORTAL
(
ch
)) {

4908 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

4909 
	`¡c
("You cªnÙ fšdhem.\n", 
ch
);

4913 ià(
viùim
 =ğ
ch


4914 || 
viùim
->
š_room
 =ğ
nuÎ±r


4915 || !
	`ÿn_£e_room
(
ch
, 
viùim
->
š_room
)) {

4916 
	`¡c
("You faed.\n", 
ch
);

4921 ià(
ch
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()) {

4922 
	`¡c
("You cªnÙ…ÜÈwhšhque¡‡»a.\n", 
ch
);

4926 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
 || 
	`ch¬_š_du–_room
(ch)) {

4927 
	`¡c
("You cªnÙ…ÜÈwhšh¬’a.\n", 
ch
);

4931 ià(
ch
->
fightšg


4932 || (
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r


4933 || 
viùim
 =ğ
ch


4934 || (
	`IS_IMMORTAL
(
viùim
è&& !IS_IMMORTAL(
ch
))

4935 || 
viùim
->
š_room
 =ğ
nuÎ±r


4936 || !
	`ÿn_£e_room
(
ch
, 
viùim
->
š_room
)

4937 || 
viùim
->
š_room
->
	`æags
().
	`has_ªy_of
(
ROOM_SAFE
 | 
ROOM_PRIVATE
 | 
ROOM_SOLITARY
)

4938 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


4939 || 
viùim
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()

4940 || 
	`ch¬_š_du–_room
(
viùim
)

4941 || 
viùim
->
š_room
->
	`şª
()

4942 || 
viùim
->
š_room
->
	`gud
(è!ğ
Gud
::
nÚe


4943 || 
viùim
->
Ëv–
 >ğËv– + (viùim->
	`is_Åc
() ? 3 : 8)

4944 || (
viùim
->
	`is_Åc
()

4945 && (
viùim
->
aù_æags
.
	`has
(
ACT_NOSUMMON
)

4946 || 
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_OTHER
)))) {

4947 
	`¡c
("You faed.\n", 
ch
);

4952 
¡Úe
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_HOLD
);

4954 ià(!
	`IS_IMMORTAL
(
ch
è&& (
¡Úe
 =ğ
nuÎ±r
 || stÚe->
™em_ty³
 !ğ
ITEM_WARP_STONE
)) {

4955 
	`¡c
("You†ackh´İ” compÚ’ˆfÜhi ¥–l.\n", 
ch
);

4959 ià(
¡Úe
 !ğ
nuÎ±r
 && stÚe->
™em_ty³
 =ğ
ITEM_WARP_STONE
) {

4960 
	`aù
("You d¿w upÚhpow” oà$p.\nIˆæ¬e brighy‡nd vªishes!", 
ch
, 
¡Úe
, 
nuÎ±r
, 
TO_CHAR
);

4961 
	`de¡roy_obj
(
¡Úe
);

4964 
pÜl
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_PORTAL
), 0);

4966 ià(! 
pÜl
) {

4967 
Loggšg
::
	`bug
("Memoryƒrror creating‡…ortal.", 0);

4968 
	`¡c
("You w”uÇbËØü—‹‡…Ül.\n", 
ch
);

4972 
pÜl
->
tim”
 = 2 + 
Ëv–
 / 25;

4973 
pÜl
->
v®ue
[3] = 
viùim
->
š_room
->
loÿtiÚ
.
	`to_št
();

4974 
	`obj_to_room
(
pÜl
, 
ch
->
š_room
);

4975 
	`aù
("$°ri£ u°äomhground.", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_ROOM
);

4976 
	`aù
("$°ri£ u°befÜyou.", 
ch
, 
pÜl
, 
nuÎ±r
, 
TO_CHAR
);

4977 
	}
}

4979 
	$¥–l_pow”_wÜd
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

4981 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

4983 ià(
	`numb”_³rûÁ
(è< (
	`GET_ATTR_CHR
(
ch
) * 3))

4984 
Ëv–
 += 5;

4986 ià((
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
ACT_UNDEAD
))

4987 || (!
viùim
->
	`is_Åc
())

4988 || (
Ëv–
 / 2è< 
viùim
->level

4989 || 
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_CHARM
)) {

4990 
	`¡c
("You faed.\n", 
ch
);

4994 
	`aù
("$Àpošt $ fšg”‡ˆ$N‡nd says, 'DIE!'", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_ROOM
);

4995 
	`aù
("You…ošˆyou¸fšg”‡ˆ$N‡nd say, 'DIE!'", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

4996 
	`aù
("$Àpošt $ fšg”‡ˆyou‡nd says, 'DIE!!'", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

4997 
	`kl_off
(
ch
, 
viùim
);

4998 
	}
}

5000 
	$¥–l_´Ùeù_cÚš”
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5002 
Objeù
 *
obj
 = (Objeù *è
vo
;

5003 
co¡
, 
ç
, 
»suÉ
;

5006 ià(
ch
 =ğ
vo
)

5009 ià(
obj
->
™em_ty³
 !ğ
ITEM_CONTAINER
) {

5010 
	`¡c
("You cª oÆy…rÙeù cÚš”s.\n", 
ch
);

5014 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BURN_PROOF
)) {

5015 
	`aù
("$°i ®»ady…rÙeùed.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5019 
co¡
 = 
obj
->
v®ue
[0] * 100;

5021 ià((
ch
->
sv”
 + 100 * ch->
gŞd
è< 
co¡
) {

5022 
	`¡c
("You cªnÙ‡ffÜdØ´Ùeùh©.\n", 
ch
);

5027 
ç
 = 10 + 
obj
->
Ëv–
 -†ev– + obj->
v®ue
[0] / 100;

5028 
»suÉ
 = 
	`numb”_³rûÁ
();

5030 ià(
»suÉ
 < (
ç
 / 5)) {

5031 
	`aù
("$°begš tØvib¿‹...h’ƒx¶odes!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5032 
	`aù
("$°begš tØvib¿‹...h’ƒx¶odes!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

5033 
	`de¡roy_obj
(
obj
);

5037 ià(
»suÉ
 <ğ
ç
) {

5038 
	`¡c
("NÙhšg s“medØh­³n.\n", 
ch
);

5043 
	`deduù_co¡
(
ch
, 
co¡
);

5044 
obj
->
exŒa_æags
 +ğ
ITEM_BURN_PROOF
;

5045 
	`aù
("$°i cov”ed w™h‡hš sh“Àoàadamªtše.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5046 
	`aù
("$°i cov”ed w™h‡hš sh“Àoàadamªtše.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

5047 
	}
}

5049 
	$¥–l_´ÙeùiÚ_ev
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5051 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5053 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
´ÙeùiÚ_ev
)) {

5054 ià(
viùim
 =ğ
ch
)

5055 
	`¡c
("You‡»‡Ì—dy…rÙeùed.\n", 
ch
);

5057 
	`aù
("$N i ®»ady…rÙeùed.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5062 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

5063 
afãù
::
ty³
::
´ÙeùiÚ_ev
,

5064 
Ëv–
,

5066 
evŞutiÚ
,

5067 
çl£


5070 
	`¡c
("You f“ÈhŞy‡nd…u».\n", 
viùim
);

5072 ià(
ch
 !ğ
viùim
)

5073 
	`aù
("$N i ´Ùeùed fromƒv.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5074 
	}
}

5076 
	$¥–l_´ÙeùiÚ_good
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5078 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5080 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
´ÙeùiÚ_good
)) {

5081 ià(
viùim
 =ğ
ch
)

5082 
	`¡c
("You‡»‡Ì—dy…rÙeùed.\n", 
ch
);

5084 
	`aù
("$N i ®»ady…rÙeùed.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5089 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

5090 
afãù
::
ty³
::
´ÙeùiÚ_good
,

5091 
Ëv–
,

5093 
evŞutiÚ
,

5094 
çl£


5097 
	`¡c
("You f“È®igÃd w™h d¬kÃss.\n", 
viùim
);

5099 ià(
ch
 !ğ
viùim
)

5100 
	`aù
("$N i ´Ùeùed from good.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5101 
	}
}

5103 
	$¥–l_¿ybª
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5105 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5107 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
¿ybª
)) {

5108 ià(
viùim
 =ğ
ch
)

5109 
	`¡c
("You‡»‡Ì—dy…rÙeùed.\n", 
ch
);

5111 
	`aù
("$N i ®»ady…rÙeùed.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5116 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

5117 
afãù
::
ty³
::
¿ybª
,

5118 
Ëv–
,

5120 
evŞutiÚ
,

5121 
çl£


5124 
	`¡c
("You¸visiÚ di¡Üt mom’ry‡ th¥–È´Ùeù you¸eyes.\n", 
viùim
);

5126 ià(
ch
 !ğ
viùim
)

5127 
	`aù
("$N' eye ¬´Ùeùed.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5128 
	}
}

5130 
	$¥–l_»su¼eù
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5132 
Objeù
 *
obj
;

5133 
Ch¬aù”
 *
mob
;

5134 
buf
[
MAX_STRING_LENGTH
];

5135 
i
;

5136 
obj
 = 
	`g‘_obj_h”e
(
ch
, 
rg‘_Çme
);

5138 ià(
obj
 =ğ
nuÎ±r
) {

5139 
	`¡c
("Resu¼eù wh©?\n", 
ch
);

5143 ià(
obj
->
™em_ty³
 !ğ
ITEM_CORPSE_NPC
) {

5144 ià(
obj
->
™em_ty³
 =ğ
ITEM_CORPSE_PC
)

5145 
	`¡c
("You cª'ˆ»su¼eù…Ïy”s.\n", 
ch
);

5147 
	`¡c
("Iˆwould s”vnØpu½o£...\n", 
ch
);

5152 ià(
obj
->
Ëv–
 > (
ch
->level + 2)) {

5153 
	`¡c
("You couldn'ˆÿÎ fÜth such‡ g»© spœ™.\n", 
ch
);

5157 ià(
ch
->
³t
 !ğ
nuÎ±r
) {

5158 
	`¡c
("You‡Ì—dy hav¨³t.\n", 
ch
);

5162 
mob
 = 
	`ü—‹_mobe
(
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
MOB_VNUM_RESZOMBIE
));

5164 ià(! 
mob
) {

5165 
Loggšg
::
	`bug
("Memoryƒrror creating mob in spell_resurrect().", 0);

5166 
	`¡c
("You w”uÇbËØ»su¼eùhi ü—tu».\n", 
ch
);

5170 
mob
->
Ëv–
 = 
obj
->level;

5171 
mob
->
h™
 = 
	`ATTR_BASE
(mob, 
APPLY_HIT
èğ
	`numb”_¿nge
(mob->
Ëv–
 * mob->level / 4, mob->level * mob->level);

5172 
mob
->
mªa
 = 
	`ATTR_BASE
(mob, 
APPLY_MANA
èğ100 + 
	`diû
(mob->
Ëv–
, 10);

5173 
mob
->
¡am
 = 
	`ATTR_BASE
(mob, 
APPLY_STAM
èğ100 + 
	`diû
(mob->
Ëv–
, 10);

5175 
i
 = 0; i < 3; i++)

5176 
mob
->
¬mÜ_ba£
[
i
] = 
	`š‹½Ş©e
(mob->
Ëv–
, 50, -50);

5178 
mob
->
¬mÜ_ba£
[3] = 
	`š‹½Ş©e
(mob->
Ëv–
, 40, 0);

5180 
¡©
 = 0; sˆ< 
MAX_STATS
; stat++)

5181 
	`ATTR_BASE
(
mob
, 
	`¡©_to_©Œ
(
¡©
)èğ11 + mob->
Ëv–
 / 5;

5183 
	`ATTR_BASE
(
mob
, 
APPLY_HITROLL
èğmob->
Ëv–
 / 10;

5184 
	`ATTR_BASE
(
mob
, 
APPLY_DAMROLL
èğmob->
Ëv–
 / 20;

5185 
mob
->
damage
[
DICE_NUMBER
] = mob->
Ëv–
 / 4;

5186 
mob
->
damage
[
DICE_TYPE
] = 2;

5187 
FÜm©
::
	`¥rštf
(
buf
, "A zomb› madäom % i h”e.\n", 
obj
->
shÜt_desü
);

5188 
mob
->
lÚg_desü
 = 
buf
;

5189 
	`ch¬_to_room
(
mob
, 
ch
->
š_room
);

5190 
	`aù
("$°¥ršg tØliã‡ ¨hideou zomb›!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

5191 
	`aù
("$°¥ršg tØliã‡ ¨hideou zomb›!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5193 
Objeù
 *
o
 = 
obj
->
cÚšs
, *
o_Ãxt
; o; o = o_next) {

5194 
o_Ãxt
 = 
o
->
Ãxt_cÚ‹Á
;

5195 
	`obj_äom_obj
(
o
);

5196 
	`obj_to_ch¬
(
o
, 
mob
);

5199 
	`exŒaù_obj
(
obj
);

5201 
	`make_³t
(
ch
, 
mob
);

5202 
afãù
::
	`add_³rm_to_ch¬
(
mob
,‡fãù::
ty³
::
ch¬m_³rsÚ
);

5203 
mob
->
comm_æags
 = 
COMM_NOCHANNELS
;

5205 
	`do_§y
(
mob
, "How may I serve you, master?");

5206 
	}
}

5208 
	$¥–l_¿y_of_Œuth
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5210 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5211 
dam
, 
®ign
;

5213 ià(
	`IS_EVIL
(
ch
)) {

5214 
viùim
 = 
ch
;

5215 
	`¡c
("Th’”gyƒx¶ode šsidyou!\n", 
ch
);

5218 ià(
viùim
 !ğ
ch
) {

5219 
	`aù
("$À¿i£ $ hªd,‡nd‡ blšdšg„ay oàlighˆshoÙ fÜth!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5220 
	`¡c
("You„ai£ you¸hªd‡nd‡ blšdšg„ay oàlighˆshoÙ fÜth!\n", 
ch
);

5223 ià(
	`IS_GOOD
(
viùim
)) {

5224 
	`aù
("$À£em unh¬med byhlight.", 
viùim
, 
nuÎ±r
, viùim, 
TO_ROOM
);

5225 
	`¡c
("Thlighˆ£em pow”Ës tØafãù you.\n", 
viùim
);

5229 
dam
 = 
	`diû
(
Ëv–
 / 3, 20);

5231 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_HOLY
))

5232 
dam
 /= 2;

5234 
®ign
 = 
viùim
->
®ignm’t
;

5236 ià(
®ign
 < 350) {

5237 
®ign
 -= 350;

5238 
®ign
 *= -1;

5239 
dam
 *ğ
®ign
 / 400;

5242 
dam
 = 0;

5244 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_HOLY
 , 
Œue
,rue);

5246 ià(
ch
->
fightšg
 !ğ
nuÎ±r
)

5247 
	`¥–l_blšdÃss
(
skl
::
ty³
::
blšdÃss
, 3 * 
Ëv–
 / 4, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

5248 
	}
}

5250 
	$¥–l_»ch¬ge
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5252 
Objeù
 *
obj
 = (Objeù *è
vo
;

5253 
chªû
, 
³rûÁ
;

5256 ià(
ch
 =ğ
vo
)

5259 ià(
obj
->
™em_ty³
 !ğ
ITEM_WAND
 && obj->™em_ty³ !ğ
ITEM_STAFF
) {

5260 
	`¡c
("Th© i‹m dÛ nÙ c¬ry ch¬ges.\n", 
ch
);

5264 ià(
obj
->
v®ue
[3] >ğ3 * 
Ëv–
 / 2) {

5265 
	`¡c
("You¸skl ¬nÙ g»©ƒnough fÜh©.\n", 
ch
);

5269 ià(
obj
->
v®ue
[1] == 0) {

5270 
	`¡c
("Th© i‹m ha ®»ady b“À»ch¬ged onû.\n", 
ch
);

5274 
chªû
 = 40 + 2 * 
Ëv–
;

5275 
chªû
 -ğ
obj
->
v®ue
[3];

5276 
chªû
 -ğ(
obj
->
v®ue
[1] - obj->value[2]) * (obj->value[1] - obj->value[2]);

5277 
chªû
 = 
¡d
::
	`max
(
Ëv–
 / 2, chance);

5278 
³rûÁ
 = 
	`numb”_³rûÁ
();

5280 ià(
³rûÁ
 < 
chªû
 / 2) {

5281 
	`aù
("$°glow ¨brighˆg»’.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5282 
	`aù
("$°glow ¨brighˆg»’.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

5283 
obj
->
v®ue
[2] = 
¡d
::
	`max
(obj->value[1], obj->value[2]);

5284 
obj
->
v®ue
[1] = 0;

5287 ià(
³rûÁ
 <ğ
chªû
) {

5288 
ch¬geback
, 
ch¬gemax
;

5289 
	`aù
("$°glow ¨soá g»’.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5290 
	`aù
("$°glow ¨soá g»’.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

5291 
ch¬gemax
 = 
obj
->
v®ue
[1] - obj->value[2];

5293 ià(
ch¬gemax
 > 0)

5294 
ch¬geback
 = 
¡d
::
	`max
(1, 
ch¬gemax
 * 
³rûÁ
 / 100);

5296 
ch¬geback
 = 0;

5298 
obj
->
v®ue
[2] +ğ
ch¬geback
;

5299 
obj
->
v®ue
[1] = 0;

5302 ià(
³rûÁ
 <ğ
¡d
::
	`mš
(95, 3 * 
chªû
 / 2)) {

5303 
	`¡c
("NÙhšg s“m tØh­³n.\n", 
ch
);

5305 ià(
obj
->
v®ue
[1] > 1)

5306 --
obj
->
v®ue
[1];

5311 
	`aù
("$°glow brighy‡ndƒx¶odes!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5312 
	`aù
("$°glow brighy‡ndƒx¶odes!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

5313 
	`de¡roy_obj
(
obj
);

5315 
	}
}

5317 
	$¥–l_»äesh
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5319 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5320 
viùim
->
¡am
 = 
¡d
::
	`mš
(viùim->¡am + 
Ëv–
, 
	`GET_MAX_STAM
(victim));

5322 ià(
	`GET_MAX_STAM
(
viùim
è=ğviùim->
¡am
)

5323 
	`¡c
("You f“ÈfuÎy„eäeshed!\n", 
viùim
);

5325 
	`¡c
("You f“ÈËs tœed.\n", 
viùim
);

5327 ià(
ch
 !ğ
viùim
)

5328 
	`¡c
("Ok.\n", 
ch
);

5329 
	}
}

5332 
	$¥–l_divše_»g’”©iÚ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5334 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5336 ià(!
	`IS_IMMORTAL
(
ch
è&& (
viùim
 != ch)) {

5337 
	`¡c
("Thi ¥–ÈÿÂÙ bÿ¡ oÀÙh”s", 
ch
);

5341 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
divše_»g’”©iÚ
)

5342 || 
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
»g’”©iÚ
)) {

5343 ià(
viùim
 =ğ
ch
)

5344 
	`¡c
("You cª'ˆpossibly f“Èªy mÜvib¿Á!\n", 
ch
);

5346 
	`aù
("$N‡Ì—dy f“l a vib¿Á‡ possibË.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5351 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

5352 
afãù
::
ty³
::
divše_»g’”©iÚ
,

5353 
Ëv–
,

5354 
Ëv–
,

5355 
evŞutiÚ
,

5356 
çl£


5359 
evŞutiÚ
) {

5361 
	`¡c
("You f“Èamazšgly vib¿Á!\n", 
viùim
);

5362 
	`aù
("$Àlook amazšgly vib¿Á!", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5366 
	`¡c
("You f“Èsu´em–y vib¿Á!\n", 
viùim
);

5367 
	`aù
("$Àlook su´em–y vib¿Á!", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5371 
	`¡c
("You f“Èdivš–y vib¿Á!\n", 
viùim
);

5372 
	`aù
("$Àlook divš–y vib¿Á!", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5376 
	`¡c
("You‡» fËd w™h hŞy vib¿nû!\n", 
viùim
);

5377 
	`aù
("$Ài fËd w™h hŞy vib¿nû!", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5380 
	}
}

5382 
	$¥–l_»g’”©iÚ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5384 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5386 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
»g’”©iÚ
)

5387 || 
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
divše_»g’”©iÚ
)) {

5388 ià(
viùim
 =ğ
ch
)

5389 
	`¡c
("You cª'ˆpossibly f“Èªy mÜvib¿Á!\n", 
ch
);

5391 
	`aù
("$N‡Ì—dy f“l a vib¿Á‡ possibË.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5396 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

5397 
afãù
::
ty³
::
»g’”©iÚ
,

5398 
Ëv–
,

5399 
Ëv–
 / 2,

5400 
evŞutiÚ
,

5401 
çl£


5404 
evŞutiÚ
) {

5406 
	`¡c
("You f“ÈmÜvib¿Á!\n", 
viùim
);

5407 
	`aù
("$Àlook mÜvib¿Á!", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5411 
	`¡c
("You f“ÈabsŞu‹ly vib¿Á!\n", 
viùim
);

5412 
	`aù
("$Àlook absŞu‹ly vib¿Á!", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5416 
	`¡c
("You f“Èšüedibly vib¿Á!\n", 
viùim
);

5417 
	`aù
("$Àlook šüedibly vib¿Á!", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5421 
	`¡c
("You f“Èunb–›vably vib¿Á!\n", 
viùim
);

5422 
	`aù
("$Àlook unb–›vably vib¿Á!", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5425 
	}
}

5427 
	$¥–l_»move_®ignm’t
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5429 
Objeù
 *
obj
 = (Objeù *è
vo
;

5430 
»suÉ
, 
ç
;

5431 
®ign
;

5434 ià(
ch
 =ğ
vo
)

5437 ià(
obj
->
w—r_loc
 !ğ-1 || obj->
ÿ¼›d_by
 =ğ
nuÎ±r
) {

5438 
	`¡c
("Th™em mu¡ bÿ¼›dØ»mov®ignm’t.\n", 
ch
);

5442 ià((!
	`IS_OBJ_STAT
(
obj
, 
ITEM_ANTI_GOOD
))

5443 && (!
	`IS_OBJ_STAT
(
obj
, 
ITEM_ANTI_EVIL
))

5444 && (!
	`IS_OBJ_STAT
(
obj
, 
ITEM_ANTI_NEUTRAL
))) {

5445 
	`¡c
("Th™em ha nØ®ignm’t.\n", 
ch
);

5450 ià(
ch
->
gud
 !ğ
Gud
::
·Ïdš
) {

5451 
®ign
 = 25 * 
ch
->
®ignm’t
 / 1000;

5452 
ch
->
®ignm’t
 = 
	`URANGE
(-1000, (ch->®ignm’ˆ- 
®ign
), 1000);

5453 
	`¡c
("Thpow”fuÈÇtu» oàth¥–È»move somoàyou¸®ignm’t!\n", 
ch
);

5454 
	`aù
("Thpow”fuÈÇtu» oà$n' ¥–È»move somoà$ ®ignm’t!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5457 
ç
 = 15;

5460 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
)

5461 
ç
 += 15;

5464 
ç
 +ğ
obj
->
Ëv–
;

5465 
ç
 -ğ3 * 
Ëv–
 / 2;

5468 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_BLESS
))

5469 
ç
 += 5;

5471 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_EVIL
))

5472 
ç
 += 5;

5474 
ç
 = 
	`URANGE
(5, fail, 90);

5475 
»suÉ
 = 
	`numb”_³rûÁ
();

5478 ià(!
	`IS_IMMORTAL
(
ch
è&& 
»suÉ
 < (
ç
 / 5)) {

5479 
	`aù
("$°shiv” ªd shudd”s...h’ im¶odes!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5480 
	`aù
("$°shiv” ªd shudd”s...h’ im¶odes!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

5481 
	`de¡roy_obj
(
obj
);

5486 ià(
»suÉ
 < (
ç
 / 3)) {

5487 ià(
ch
->
gud
 !ğ
Gud
::
·Ïdš
) {

5488 
®ign
 = 25 * 
ch
->
®ignm’t
 / 1000;

5489 
ch
->
®ignm’t
 = 
	`URANGE
(-1000, (ch->®ignm’ˆ- 
®ign
), 1000);

5490 
	`¡c
("Th¥–Èbackfœe ªd„emove somoàYOUR‡lignm’t!\n", 
ch
);

5491 
	`aù
("$n' ¥–Èbackfœe ªd„emove somoà$ ®ignm’t!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5494 
	`¡c
("Th¥–Èçs.\n", 
ch
);

5495 
	`aù
("$n' ¥–Èçs.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5501 ià(!
	`IS_IMMORTAL
(
ch
è&& 
»suÉ
 <ğ
ç
) {

5502 
	`¡c
("NÙhšg s“medØh­³n.\n", 
ch
);

5507 
obj
->
exŒa_æags
 -ğ
ITEM_ANTI_EVIL
;

5508 
obj
->
exŒa_æags
 -ğ
ITEM_ANTI_GOOD
;

5509 
obj
->
exŒa_æags
 -ğ
ITEM_ANTI_NEUTRAL
;

5510 
	`aù
("You„emov$p' ®ignm’t!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5511 
	`aù
("$À»move $p' ®ignm’t!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

5512 
	}
}

5514 
	$¥–l_»move_švis
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5516 
Objeù
 *
obj
 = (Objeù *è
vo
;

5520 ià(
ch
 =ğ
vo
)

5523 ià(!
	`IS_OBJ_STAT
(
obj
, 
ITEM_INVIS
)) {

5524 
	`aù
("$°i ®»ady visibË.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5528 ià(!
	`IS_IMMORTAL
(
ch
è&& 
	`Ëv–_§ve
(
Ëv–
, 
obj
->level)) {

5529 
	`aù
("$°æick”s... buˆ»maš švisibË.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

5533 
obj
->
exŒa_æags
 -ğ
ITEM_INVIS
;

5534 
	`aù
("$°­³¬ ouˆoàthš‡œ!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

5535 
	}
}

5537 
	$¥–l_»move_cur£
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5539 
Ch¬aù”
 *
viùim
;

5540 
Objeù
 *
obj
;

5541 
boŞ
 
afãùed
 = 
çl£
;

5542 
boŞ
 
objeù
 = 
çl£
;

5545 ià(
rg‘
 =ğ
TARGET_OBJ
) {

5546 
obj
 = (
Objeù
 *è
vo
;

5548 ià(!
	`IS_OBJ_STAT
(
obj
, 
ITEM_NODROP
è&& !IS_OBJ_STAT(obj, 
ITEM_NOREMOVE
)) {

5549 
	`aù
("Th”dÛ¢'ˆ£emØb¨cur£ oÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5553 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_NOUNCURSE
)

5554 || (!
	`IS_IMMORTAL
(
ch
è&& 
	`Ëv–_§ve
(
Ëv–
 + 2, 
obj
->level))) {

5555 
	`aù
("Thcur£ oÀ$°i beyÚd you¸pow”.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5559 
obj
->
exŒa_æags
 -ğ
ITEM_NODROP
;

5560 
obj
->
exŒa_æags
 -ğ
ITEM_NOREMOVE
;

5561 
	`aù
("$°glow blue.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

5566 
viùim
 = (
Ch¬aù”
 *è
vo
;

5568 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
cur£
)) {

5569 
afãùed
 = 
Œue
;

5571 ià(
	`check_di¥–_ch¬
(
Ëv–
, 
viùim
, 
afãù
::
ty³
::
cur£
, 
çl£
)) {

5576 
obj
 = 
viùim
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
) {

5577 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_NODROP
è|| IS_OBJ_STAT(obj, 
ITEM_NOREMOVE
)) {

5578 
afãùed
 = 
Œue
;

5579 
objeù
 = 
Œue
;

5581 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_NOUNCURSE
)) {

5582 
	`aù
("You faØ»movthcur£ oÀ$p.", 
viùim
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5587 ià(
	`IS_IMMORTAL
(
ch
è|| !
	`Ëv–_§ve
(
Ëv–
, 
obj
->level)) {

5588 
obj
->
exŒa_æags
 -ğ
ITEM_NODROP
;

5589 
obj
->
exŒa_æags
 -ğ
ITEM_NOREMOVE
;

5590 
	`aù
("You¸$°glow blue.", 
viùim
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5591 
	`aù
("$n' $°glow blue.", 
viùim
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

5595 
	`aù
("You faØ»movthcur£ oÀ$p.", 
viùim
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

5599 ià(
afãùed
) {

5600 ià(!
objeù
)

5601 
	`¡c
("You faØ»movthcur£.\n", 
ch
);

5603 ià(
ch
 =ğ
viùim
)

5604 
	`¡c
("Ne™h” you‚Ü‡nythšg you‡» w—ršg i cur£d!\n", 
ch
);

5606 
	`aù
("Ne™h” $E‚Ü‡nythšg $E i w—ršg i cur£d!\n", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5607 
	}
}

5609 
	$¥–l_§nùu¬y
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5611 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5613 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
§nùu¬y
)) {

5614 ià(
viùim
 =ğ
ch
)

5615 
	`¡c
("You‡»‡Ì—dy iÀ§nùu¬y.\n", 
ch
);

5617 
	`aù
("$N i ®»ady iÀ§nùu¬y.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5622 
evŞutiÚ
) {

5624 
	`aù
("$Ài su¼ounded by‡ wh™au¿.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5625 
	`¡c
("You‡» su¼ounded by‡ wh™au¿.\n", 
viùim
);

5629 
	`aù
("$Ài su¼ounded by‡ brighˆwh™au¿.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5630 
	`¡c
("You‡» su¼ounded by‡ brighˆwh™au¿.\n", 
viùim
);

5634 
	`aù
("$Ài su¼ounded by‡ brlŸÁ wh™au¿.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5635 
	`¡c
("You‡» su¼ounded by‡ brlŸÁ wh™au¿.\n", 
viùim
);

5639 
	`aù
("A dazzling white‡ura of holiness…ermeateshe‡ir‡round $n.",

5640 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5641 
	`¡c
("A dazzlšg wh™au¿ oàhŞšes ³rm—‹ thaœ‡round you.\n", 
viùim
);

5645 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

5646 
afãù
::
ty³
::
§nùu¬y
,

5647 
Ëv–
,

5648 
Ëv–
 / 6,

5649 
evŞutiÚ
,

5650 
çl£


5652 
	}
}

5654 
	$¥–l_sh›ld
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5656 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5658 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
sh›ld
)) {

5659 ià(
viùim
 =ğ
ch
)

5660 
	`¡c
("You‡»‡Ì—dy sh›lded from h¬m.\n", 
ch
);

5662 
	`aù
("$N i ®»ady…rÙeùed by‡ sh›ld.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5667 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

5668 
afãù
::
ty³
::
sh›ld
,

5669 
Ëv–
,

5670 
Ëv–
 + 8,

5671 
evŞutiÚ
,

5672 
çl£


5675 
	`aù
("$Ài su¼ounded by‡ fÜû sh›ld.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5676 
	`¡c
("You‡» su¼ounded by‡ fÜû sh›ld.\n", 
viùim
);

5678 
	}
}

5680 
	$¥–l_suÄay
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5682 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5683 
dam
;

5684 
	`¡c
("You c®ÈfÜth‡ divš¿y oàlight!\n", 
ch
);

5685 
	`aù
("$Àbršg fÜth‡ b—m oàhŞy†ighˆäomhh—v’s.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5686 
dam
 = 
	`diû
(
Ëv–
, 25);

5688 ià(
viùim
->
®ignm’t
 > 350)

5689 
dam
 /= 2;

5691 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_LIGHT
, 
Œue
,rue);

5692 
	}
}

5694 
	$¥–l_æamesh›ld
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5696 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5698 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
æamesh›ld
)) {

5699 ià(
viùim
 =ğ
ch
)

5700 
	`¡c
("You‡»‡Ì—dy cœşed by fÏmes.\n", 
ch
);

5702 
	`aù
("$N i ®»ady cœşed by fÏmes.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5707 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

5708 
afãù
::
ty³
::
æamesh›ld
,

5709 
Ëv–
,

5710 
Ëv–
 / 2,

5711 
evŞutiÚ
,

5712 
çl£


5715 
	`aù
("$Ài su¼ounded by‡ cœşoàæames.", 
viùim
, 
nuÎ±r
,‚ullptr,

5716 
TO_ROOM
);

5717 
	`¡c
("You‡» su¼ounded by‡ cœşoàæames.\n", 
viùim
);

5719 
	}
}

5721 
	$¥–l_shockšg_g¿¥
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5723 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5724 cÚ¡ 
dam_—ch
[] = {

5732 
dam
;

5733 
Ëv–
 = 
¡d
::
	`mš
Öev–, ()((
dam_—ch
) / (dam_each[0])) - 1);

5734 
Ëv–
 = 
¡d
::
	`max
(0,†evel);

5735 
dam
 = 
	`numb”_¿nge
(
dam_—ch
[
Ëv–
] / 2, dam_each[level] * 2);

5737 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_ELECTRICITY
))

5738 
dam
 /= 2;

5740 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_ELECTRICITY
 , 
Œue
,rue);

5742 
	}
}

5744 
	$¥–l_¦“p
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5746 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5748 ià(
	`numb”_³rûÁ
(è< (
	`GET_ATTR_CHR
(
ch
) * 3))

5749 
Ëv–
 += 5;

5751 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
¦“p
)) {

5752 
	`aù
("$E isn't‡wakeƒnougho be‡ffected by your spell.",

5753 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5757 ià(
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
ACT_UNDEAD
)) {

5758 
	`aù
("$E isn't sufficiently‡liveo be‡ffected by your spell.",

5759 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5763 ià((
Ëv–
 + 2è< 
viùim
->level

5764 || 
	`§ves_¥–l
(
Ëv–
 - 4, 
viùim
, 
DAM_CHARM
)) {

5765 
	`aù
("$N'sƒyes close, but only for‡ moment. You have failed.",

5766 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5770 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

5771 
afãù
::
ty³
::
¦“p
,

5772 
Ëv–
,

5773 
Ëv–
 + 4,

5774 
evŞutiÚ
,

5775 
çl£


5778 ià(
	`IS_AWAKE
(
viùim
)) {

5779 
	`¡c
("You f“Èv”y sË•y ..... zzzzzz.\n", 
viùim
);

5780 
	`aù
("$ÀgÛ tØ¦“p.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5781 
viùim
->
pos™iÚ
 = 
POS_SLEEPING
;

5783 
	}
}

5785 
	$¥–l_¦ow
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5787 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5789 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
¦ow
)) {

5790 ià(
viùim
 =ğ
ch
)

5791 
	`¡c
("You cª'ˆmovªy slow”!\n", 
ch
);

5793 
	`aù
("$N can't get‡ny slowerhanhat.",

5794 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5799 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ha¡e
)) {

5800 ià(!
	`check_di¥–_ch¬
(
Ëv–
, 
viùim
, 
afãù
::
ty³
::
ha¡e
, (
ch
 != victim))) {

5801 ià(
viùim
 !ğ
ch
)

5802 
	`¡c
("S³Î faed.\n", 
ch
);

5804 
	`¡c
("You f“Èmom’ry slow”.\n", 
viùim
);

5811 ià(
viùim
 !ğ
ch
 && 
	`§ves_¥–l
(
Ëv–
, viùim, 
DAM_OTHER
)) {

5812 
	`¡c
("NÙhšg s“medØh­³n.\n", 
ch
);

5813 
	`¡c
("You f“Èmom’ry†‘h¬gic.\n", 
viùim
);

5817 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

5818 
afãù
::
ty³
::
¦ow
,

5819 
Ëv–
,

5820 
Ëv–
 / 2,

5821 
evŞutiÚ
,

5822 
çl£


5825 
	`¡c
("You f“Èyour£là¦owšg d o w‚...\n", 
viùim
);

5826 
	`aù
("$À¡¬t tØmovš slow mÙiÚ.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5828 
	}
}

5831 
	$¥–l_smokesü“n
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5833 
Ch¬aù”
 *
vch
;

5834 
Room
 *
š_room
;

5835 
Room
 *
to_room
;

5836 
Ex™
 *
³x™
;

5837 
doÜ
;

5839 ià(
rg‘_Çme
.
	`em±y
()) {

5840 
	`¡c
("W™houˆdœeùiÚ,hsmokha nØpu½o£...\n", 
ch
);

5844 
SŒšg
 
¬g
;

5845 
	`Úe_¬gum’t
(
rg‘_Çme
, 
¬g
);

5847 
doÜ
 = 
	`fšd_ex™
(
ch
, 
¬g
);

5848 
š_room
 = 
ch
->in_room;

5850 ià((
doÜ
 < 0) || (door > 5)

5851 || (
³x™
 = 
š_room
->
ex™
[
doÜ
]è=ğ
nuÎ±r


5852 || (
to_room
 = 
³x™
->to_roomè=ğ
nuÎ±r


5853 || !
	`ÿn_£e_room
(
ch
, 
³x™
->
to_room
)

5854 || (
³x™
->
ex™_æags
.
	`has
(
EX_CLOSED
))) {

5855 
	`¡c
("Thsmokha nowh”tØgØªd diss©es.\n", 
ch
);

5859 ià(
	`numb”_³rûÁ
() < 5) {

5860 
afãù
::
	`add_ty³_to_ch¬
(
ch
,

5861 
afãù
::
ty³
::
smokesü“n
,

5862 
Ëv–
 + 5,

5863 
	`numb”_¿nge
(0, 
Ëv–
 / 2),

5864 
evŞutiÚ
,

5865 
çl£


5868 
	`¡c
("You†o£ cÚŒŞ oàthsmokªd iˆtuº Ú you!\n", 
ch
);

5869 
	`aù
("$ÀcÚju» u°¨şoud oàsmokªd iˆtuº Ú $m!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5875 
vch
 = 
to_room
->
³İË
; vch !ğ
nuÎ±r
; vch = vch->
Ãxt_š_room
) {

5876 
boŞ
 
®»ady_blšded
 = 
	`is_blšded
(
vch
);

5878 ià(
	`is_§ã_¥–l
(
ch
, 
vch
, 
Œue
))

5881 ià(
	`§ves_¥–l
(
Ëv–
, 
vch
, 
DAM_OTHER
)) {

5882 ià(!
®»ady_blšded
)

5883 
	`¡c
("Smokmom’ry cloud you¸visiÚ.\n", 
vch
);

5886 
afãù
::
	`add_ty³_to_ch¬
(
vch
,

5887 
afãù
::
ty³
::
smokesü“n
,

5888 
Ëv–
,

5889 
	`numb”_¿nge
(0, 
Ëv–
 / 10),

5890 
evŞutiÚ
,

5891 
çl£


5894 
	`aù
("$n' visiÚ i obscu»d by‡ sŒªgşoud oàsmoke.", 
vch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5896 ià(!
®»ady_blšded
)

5897 
	`¡c
("Smokşoud you¸visiÚ.\n", 
vch
);

5901 
	`¡c
("You cÚju» u°¨smokesü“ÀtØcÚfound you¸’em›s.\n", 
ch
);

5902 
	`aù
("$ÀcÚju» u°¨smokesü“ÀtØcÚfound $ ’em›s.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5903 
	}
}

5905 
	$¥–l_¡Úe_skš
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5907 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

5909 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¡Úe_skš
)) {

5910 ià(
viùim
 =ğ
ch
)

5911 
	`¡c
("You¸skš i ®»ady‡ h¬d‡ ¨rock.\n", 
ch
);

5913 
	`aù
("$N i ®»ady‡ h¬d‡ ÿÀbe.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

5918 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

5919 
afãù
::
ty³
::
¡Úe_skš
,

5920 
Ëv–
,

5921 
Ëv–
,

5922 
evŞutiÚ
,

5923 
çl£


5926 
	`aù
("$n' skšuº tØ¡Úe.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

5927 
	`¡c
("You¸skšuº tØ¡Úe.\n", 
viùim
);

5929 
	}
}

5931 
	$¥–l_summÚ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

5933 
Ch¬aù”
 *
viùim
;

5934 
Ch¬aù”
 *
rch
;

5936 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r


5937 || 
viùim
 =ğ
ch


5938 || 
viùim
->
š_room
 =ğ
nuÎ±r


5940 || 
ch
->
š_room
 =ğ
nuÎ±r
) {

5941 
	`¡c
("You faed.\n", 
ch
);

5945 ià(
ch
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()) {

5946 
	`¡c
("You cªnÙ summÚ whšhque¡‡»a.\n", 
ch
);

5950 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
 && !
viùim
->
	`is_Åc
()) {

5951 
	`¡c
("You cªnÙ summÚ…Ïy” whšh¬’a.\n", 
ch
);

5955 ià(
	`ch¬_š_du–_room
(
ch
)) {

5956 
	`¡c
("You cªnÙ summÚ iÀthdu–‡»Ç.\n", 
ch
);

5960 ià(
viùim
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()) {

5961 
	`¡c
("Yourarget is inhe quest‡rea. You cannot summon fromhere.\n",

5962 
ch
);

5966 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a
 || 
	`ch¬_š_du–_room
(victim)) {

5967 
	`¡c
("Yourarget is inhe‡rena. You cannot summon fromhere.\n",

5968 
ch
);

5972 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
)

5973 || 
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
)

5974 || 
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_PRIVATE
)

5975 || 
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_SOLITARY
)

5976 || 
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_NO_RECALL
)

5977 || (
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
ACT_AGGRESSIVE
))

5978 || 
viùim
->
Ëv–
 >=†evel + 3

5979 || 
	`IS_IMMORTAL
(
viùim
)

5980 || 
viùim
->
fightšg
 !ğ
nuÎ±r


5981 || 
viùim
->
aù_æags
.
	`has
(
ACT_NOSUMMON
)

5982 || (
viùim
->
	`is_Åc
(è&& viùim->
pIndexD©a
->
pShİ
 !ğ
nuÎ±r
)

5983 || (
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_MALE_ONLY
è&& 
	`GET_ATTR_SEX
(
viùim
è!ğ
SEX_MALE
)

5984 || (
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_FEMALE_ONLY
è&& 
	`GET_ATTR_SEX
(
viùim
è!ğ
SEX_FEMALE
)

5986 
	`¡c
("You faed.\n", 
ch
);

5992 ià(!
viùim
->
	`is_Åc
()) {

5993 
rch
 = 
ch
->
š_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
) {

5994 ià(
rch
->
	`is_Åc
(è&&„ch->
aù_æags
.
	`has
(
ACT_AGGRESSIVE
)

5995 && 
rch
->
Ëv–
 + 6 > 
viùim
->level) {

5996 
	`aù
("I wouldn't dohat! $N would‡ttackhem immediately."

5997 , 
ch
, 
nuÎ±r
, 
rch
, 
TO_CHAR
);

5998 
	`wizÃt
("$N i ©‹m±šgØsummÚ‡ PC iÁØª‡gg›„oom.", 
ch
,

5999 
nuÎ±r
, 
WIZ_CHEAT
, 0, 
	`GET_RANK
(
ch
));

6005 ià(
viùim
->
	`is_Åc
(è&& 
	`§ves_¥–l
(
Ëv–
, viùim, 
DAM_OTHER
)) {

6006 
	`¡c
("You faed!\n", 
ch
);

6010 
	`aù
("$Àdi§µ—r sudd’ly.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

6011 
	`ch¬_äom_room
(
viùim
);

6012 
	`ch¬_to_room
(
viùim
, 
ch
->
š_room
);

6013 
	`aù
("$À¬rive sudd’ly.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

6014 
	`aù
("$Àha summÚed you!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

6015 
	`do_look
(
viùim
, "auto");

6017 
	}
}

6020 
	$¥–l_summÚ_objeù
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6022 
Objeù
 *
obj
;

6023 
numb”
, 
couÁ
 = 0;

6025 
SŒšg
 
¬g
;

6026 
numb”
 = 
	`numb”_¬gum’t
(
rg‘_Çme
, 
¬g
);

6028 ià(
¬g
.
	`em±y
()) {

6029 
	`¡c
("You mu¡ s³cify‡Àobjeù iàyou wªˆtØsummÚ oÃ.\n", 
ch
);

6034 ià(
	`IS_IMMORTAL
(
ch
)) {

6035 
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt
) {

6036 ià(!
	`ÿn_£e_obj
(
ch
, 
obj
)

6037 || !
obj
->
Çme
.
	`has_wÜds
(
¬g
))

6040 ià(++
couÁ
 < 
numb”
)

6043 ià(
obj
->
š_lock”
 || obj->
š_¡rÚgbox
 || obj->
š_obj
)

6045 ià(
obj
->
ÿ¼›d_by
) {

6046 ià(!
obj
->
ÿ¼›d_by
->
	`is_Åc
())

6049 
	`obj_äom_ch¬
(
obj
);

6052 ià(
obj
->
š_room
) {

6053 ià(
obj
->
š_room
->
³İË
)

6054 
	`aù
("$°di§µ—r sudd’ly.", 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

6056 
	`obj_äom_room
(
obj
);

6061 
Loggšg
::
	`bugf
("(%s) spell_summon_obj: object %d seemso be‚owhere",

6062 
ch
->
Çme
, 
obj
->
pIndexD©a
->
vnum
);

6063 
	`¡c
("Iˆcould‚Ù bfound.\n", 
ch
);

6068 ià(!
obj
) {

6069 
	`¡c
("You could‚Ù fšd it.\n", 
ch
);

6073 ià(!
	`CAN_WEAR
(
obj
, 
ITEM_TAKE
))

6074 
	`obj_to_room
(
obj
, 
ch
->
š_room
);

6076 
	`obj_to_ch¬
(
obj
, 
ch
);

6078 
	`¡c
("Sucûss.\n", 
ch
);

6082 ià(
ch
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()) {

6083 
	`¡c
("You‡» iÀthque¡‡»a. You cªnÙ summÚ objeù h”e.\n", 
ch
);

6087 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
)) {

6088 
	`¡c
("You faØdi¡urbh³aû oàthi room.\n", 
ch
);

6092 
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt
) {

6093 ià(!
	`ÿn_£e_obj
(
ch
, 
obj
)

6094 || !
obj
->
Çme
.
	`has_wÜds
(
¬g
)

6095 || 
	`IS_OBJ_STAT
(
obj
, 
ITEM_NOLOCATE
))

6099 
couÁ
++;

6102 ià(
couÁ
 < 
numb”
)

6105 ià(
obj
->
Ëv–
 > 
ch
->level + 2) {

6106 ià(
numb”
 == 1)

6109 
	`¡c
("You faed.\n", 
ch
);

6114 ià(
obj
->
ÿ¼›d_by
 !ğ
nuÎ±r
) {

6116 ià((
obj
->
ÿ¼›d_by
->
š_room
 =ğ
nuÎ±r
)

6117 || 
obj
->
ÿ¼›d_by
->
š_room
->
	`æags
().
	`has_ªy_of
(
ROOM_SAFE
 | 
ROOM_PRIVATE
 | 
ROOM_SOLITARY
 | 
ROOM_NO_RECALL
)

6118 || 
obj
->
ÿ¼›d_by
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


6119 || 
obj
->
ÿ¼›d_by
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()

6120 || (!
obj
->
ÿ¼›d_by
->
	`is_Åc
())

6121 || (
obj
->
ÿ¼›d_by
->
Ëv–
 > 
ch
->level + 3)

6122 || (
obj
->
ÿ¼›d_by
->
	`is_Åc
(è&& obj->ÿ¼›d_by->
pIndexD©a
->
pShİ
 !ğ
nuÎ±r
)

6123 || (!
	`ÿn_drİ_obj
(
obj
->
ÿ¼›d_by
, obj))

6124 || (
obj
->
ÿ¼›d_by
->
	`is_Åc
(è&& 
	`§ves_¥–l
(
Ëv–
, obj->ÿ¼›d_by, 
DAM_OTHER
))) {

6125 ià(
numb”
 == 1)

6128 
	`¡c
("You faed.\n", 
ch
);

6133 ià(
obj
->
š_room
 !ğ
nuÎ±r
) {

6135 ià(
obj
->
š_room
->
	`æags
().
	`has_ªy_of
(
ROOM_SAFE
 | 
ROOM_PRIVATE
 | 
ROOM_SOLITARY
 | 
ROOM_NO_RECALL
)

6136 || 
obj
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


6137 || 
obj
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()

6138 || (!
	`CAN_WEAR
(
obj
, 
ITEM_TAKE
))) {

6139 ià(
numb”
 == 1)

6142 
	`¡c
("You faed.\n", 
ch
);

6147 ià(
obj
->
š_lock”
 || obj->
š_¡rÚgbox
 || obj->
š_obj
) {

6153 
Loggšg
::
	`bugf
("(%s) spell_summon_obj: object %d seemso be‚owhere",

6154 
ch
->
Çme
, 
obj
->
pIndexD©a
->
vnum
);

6162 ià(
obj
 =ğ
nuÎ±r
) {

6163 
	`¡c
("You faed.\n", 
ch
);

6168 ià(
obj
->
™em_ty³
 =ğ
ITEM_CORPSE_PC
) {

6169 ià(
ch
->
š_room
->
	`şª
()

6170 || 
ch
->
š_room
->
	`gud
(è!ğ
Gud
::
nÚe


6171 || 
ch
->
š_room
->
	`¬—
().
Çme
 == "Playpen"

6172 || 
ch
->
š_room
->
	`¬—
().
Çme
 == "IMM-Zone"

6173 || 
ch
->
š_room
->
	`¬—
().
Çme
 == "Limbo"

6174 || 
ch
->
š_room
->
	`¬—
().
Çme
 == "Eilyndrae"

6175 || 
ch
->
š_room
->
	`¬—
().
Çme
 == "Torayna Cri"

6176 || 
ch
->
š_room
->
	`¬—
().
Çme
 == "Battle Arenas"

6177 || 
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


6178 || 
ch
->
š_room
->
	`æags
().
	`has_ªy_of
(

6179 
ROOM_MALE_ONLY


6180 | 
ROOM_FEMALE_ONLY


6181 | 
ROOM_PRIVATE


6182 | 
ROOM_SOLITARY


6183 | 
ROOM_PET_SHOP
)) {

6184 
	`¡c
("You cªnÙ summÚ‡…Ïy” cÜp£ h”e.\n", 
ch
);

6189 ià(
	`Ëv–_§ve
(
ch
->
Ëv–
, 
obj
->level)) {

6190 
	`¡c
("You faed.\n", 
ch
);

6194 ià(
obj
->
ÿ¼›d_by
 !ğ
nuÎ±r
)

6195 
	`aù
("$°di§µ—r sudd’ly.", 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

6196 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

6197 
	`aù
("$°di§µ—r sudd’ly.", 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

6199 ià(
obj
->
ÿ¼›d_by
 !ğ
nuÎ±r
)

6200 
	`obj_äom_ch¬
(
obj
);

6202 
	`obj_äom_room
(
obj
);

6204 
	`obj_to_room
(
obj
, 
ch
->
š_room
);

6206 ià(
obj
->
ÿ¼›d_by
 !ğ
nuÎ±r
)

6207 
	`aù
("$°­³¬ sudd’ly.", 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

6208 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr)

6209 
	`aù
("$°­³¬ sudd’ly.", 
obj
->
š_room
->
³İË
, obj, 
nuÎ±r
, 
TO_ALL
);

6210 
	}
}

6214 
	$¥–l_lÚ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6216 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

6218 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
lÚ
)) {

6219 ià(
viùim
 =ğ
ch
)

6220 
	`¡c
("If you hold your weapon‡nyighter…eople will starto wonder...\n"

6221 , 
ch
);

6223 
	`aù
("$N is‡lready holding his weapon‡sightly‡s is…rudent."

6224 , 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

6229 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

6230 
afãù
::
ty³
::
lÚ
,

6231 
Ëv–
,

6232 
Ëv–
 / 8,

6233 
evŞutiÚ
,

6234 
çl£


6237 
	`¡c
("You hŞd you¸w—pÚ iÀ¨viû-likgr.\n", 
viùim
);

6238 
	`aù
("$Ài NOT†‘tšg gØoà$ w—pÚ.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

6240 
	}
}

6243 
	$¥–l_‹ËpÜt_objeù
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6245 
Ch¬aù”
 *
viùim
;

6246 
Objeù
 *
obj
;

6247 
buf
[
MAX_STRING_LENGTH
];

6249 ià(
ch
->
š_room
 !ğ
nuÎ±r
 && ch->š_room->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()) {

6250 
	`¡c
("You cannoteleport objects inhe quest‡rea.\n",

6251 
ch
);

6256 
SŒšg
 
objeù
, 
Çme
;

6257 
rg‘_Çme
 = 
	`Úe_¬gum’t
Ñ¬g‘_Çme, 
objeù
);

6258 
	`Úe_¬gum’t
(
rg‘_Çme
, 
Çme
);

6262 ià(
objeù
.
	`em±y
()) {

6263 
	`¡c
("Wh© shouldh¥–Èbÿ¡ upÚ?\n", 
ch
);

6267 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
objeù
)è=ğ
nuÎ±r
) {

6268 
	`¡c
("You‡»‚Ù c¬ryšgh©.\n", 
ch
);

6272 ià(
obj
->
w—r_loc
 !ğ
WEAR_NONE
) {

6273 
	`¡c
("P”h­ you should„emov™ fœ¡...\n", 
ch
);

6277 ià(
	`IS_OBJ_STAT
(
obj
, 
ITEM_NODROP
)) {

6278 
	`¡c
("You cª'ˆ£emØËˆgØoà™.\n", 
ch
);

6284 ià(
Çme
.
	`em±y
())

6285 
viùim
 = 
ch
;

6287 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r
 ||

6288 
viùim
->
š_room
 =ğ
nuÎ±r
) {

6289 
	`¡c
("You faed.\n", 
ch
);

6294 ià(
viùim
 =ğ
ch
) {

6295 
	`¡c
("Th”would bnØpošt!\n", 
ch
);

6299 ià(!
viùim
->
	`is_Åc
()) {

6300 ià(
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_LINK_DEAD
)) {

6301 
FÜm©
::
	`¥rštf
(
buf
, "$N i ŒyšgØ‹ËpÜˆª objeùØthlškd—d ch¬aù” %s.", 
viùim
->
Çme
);

6302 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_CHEAT
, 0, 
	`GET_RANK
(ch));

6303 
	`¡c
("You¸»c›Á cªnÙ„eûiv‹ËpÜ‹d objeù šheœ cu¼’ˆ¡©e.\n", 
ch
);

6308 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


6309 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


6310 || 
	`ch¬_š_d¬’a_room
(
viùim
)) {

6311 
	`¡c
("You faed.\n", 
ch
);

6315 ià(
viùim
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()) {

6316 
	`¡c
(

6318 
ch
);

6322 ià(
viùim
->
	`is_Åc
()) {

6323 
	`¡c
("Mobe dØnÙ‚“d suchhšgs.\n", 
ch
);

6327 
	`obj_äom_ch¬
(
obj
);

6328 
	`obj_to_ch¬
(
obj
, 
viùim
);

6329 
	`aù
("$n opens‡ hole inhe fabric of„eality‡nd gives $po $N."

6330 , 
ch
, 
obj
, 
viùim
, 
TO_NOTVICT
);

6331 
	`aù
("$n opens‡ hole inhe fabric of„eality‡nd gives $po you."

6332 , 
ch
, 
obj
, 
viùim
, 
TO_VICT
);

6333 
	`aù
("You open‡ hole inhe fabric of„eality‡nd give $po $N."

6334 , 
ch
, 
obj
, 
viùim
, 
TO_CHAR
);

6336 ià(
ch
->
š_room
 !ğ
viùim
->in_room)

6337 
	`aù
("$N opens‡ hole inhe fabric of„eality‡nd gives $po $n."

6338 , 
viùim
, 
obj
, 
ch
, 
TO_ROOM
);

6339 
	}
}

6341 
	$¥–l_‹ËpÜt
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6343 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

6344 
Room
 *
room
;

6346 ià(
ch
->
š_room
 !ğ
nuÎ±r
 && ch->š_room->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()) {

6347 
	`¡c
("T–•ÜtiÚ dÛ nÙ wÜk iÀthque¡‡»a.\n", 
ch
);

6351 ià(
viùim
->
š_room
 =ğ
nuÎ±r


6353 || 
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_NO_RECALL
)

6354 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


6355 || 
viùim
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
şª¬’a


6356 || 
	`ch¬_š_du–_room
(
ch
)

6357 || 
	`ch¬_š_du–_room
(
viùim
)

6358 || 
ch
->
š_room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


6359 || (
viùim
 !ğ
ch
 && viùim->
aù_æags
.
	`has
(
ACT_NOSUMMON
))

6360 || (!
ch
->
	`is_Åc
(è&& 
viùim
->
fightšg
 !ğ
nuÎ±r
)

6361 || (
viùim
 !ğ
ch
 && 
	`§ves_¥–l
(
Ëv–
, viùim, 
DAM_OTHER
))) {

6362 
	`¡c
("You faed.\n", 
ch
);

6366 
room
 = 
	`g‘_¿ndom_room
(
viùim
);

6368 ià(
viùim
 !ğ
ch
)

6369 
	`¡c
("You havb“À‹ËpÜ‹d!\n", 
viùim
);

6371 
	`aù
("$Àvªishes!", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

6372 
	`ch¬_äom_room
(
viùim
);

6373 
	`ch¬_to_room
(
viùim
, 
room
);

6374 
	`aù
("$À¦owly fade štØexi¡’û.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

6375 
	`do_look
(
viùim
, "auto");

6376 
	}
}

6380 
	$¥–l_undo_¥–l
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6382 
Ch¬aù”
 *
viùim
;

6385 
SŒšg
 
¥–l
, 
Çme
;

6386 
rg‘_Çme
 = 
	`Úe_¬gum’t
Ñ¬g‘_Çme, 
¥–l
);

6387 
	`Úe_¬gum’t
(
rg‘_Çme
, 
Çme
);

6389 
afãù
::
ty³
 
undo_ty³
 =‡fãù::
	`lookup
(
¥–l
);

6391 ià(
undo_ty³
 =ğ
afãù
::
ty³
::
unknown
) {

6392 
	`¡c
("You'vÃv”ƒv’ h—rd oàth© s³Î.\n", 
ch
);

6396 ià(
Çme
.
	`em±y
())

6397 
viùim
 = 
ch
;

6399 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

6400 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

6405 ià(!
ch
->
	`is_Åc
()) {

6406 ià(!
	`is_§me_group
(
ch
, 
viùim
) && victim != ch) {

6407 ià(
	`is_§ã
(
ch
, 
viùim
, 
çl£
)) {

6408 
	`¡c
("NÙ oÀth©¬g‘.\n", 
ch
);

6412 
	`check_kËr
(
ch
, 
viùim
);

6416 ià((!
ch
->
	`is_Åc
(è&& 
viùim
->is_npc()

6417 && !(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 =ğ
viùim
))

6418 || (
ch
->
	`is_Åc
(è&& !
viùim
->is_npc())) {

6419 
	`¡c
("You faed,ry di¥– magic.\n", 
ch
);

6423 ià(
	`undo_¥–l
(
Ëv–
, 
viùim
, 
undo_ty³
, (
ch
 != victim))) {

6424 
	`¡c
("Ok.\n", 
ch
);

6427 
	`¡c
("S³Î faed.\n", 
ch
);

6428 
	}
}

6431 
	$¥–l_visiÚ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6433 
Ch¬aù”
 *
viùim
;

6434 
Room
 *
Üigš®_room
;

6436 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
rg‘_Çme
, 
VIS_CHAR
)è=ğ
nuÎ±r


6437 || 
viùim
 =ğ
ch


6438 || 
viùim
->
š_room
 =ğ
nuÎ±r


6439 || !
	`ÿn_£e_room
(
ch
, 
viùim
->
š_room
)

6440 || 
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_PRIVATE
)

6441 || 
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_SOLITARY
)

6442 || 
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_NOVISION
)

6443 || 
viùim
->
Ëv–
 >=†evel + 3

6444 || 
	`IS_IMMORTAL
(
viùim
)

6445 || (
viùim
->
	`is_Åc
(è&& 
	`§ves_¥–l
(
Ëv–
, viùim, 
DAM_OTHER
))) {

6446 
	`¡c
("You faed.\n", 
ch
);

6450 
	`¡c
("You cÚju»‡ my¡iÿÈ¥h”ªd…“¸šside...\n", 
ch
);

6451 
Üigš®_room
 = 
ch
->
š_room
;

6452 
	`ch¬_äom_room
(
ch
);

6453 
	`ch¬_to_room
(
ch
, 
viùim
->
š_room
);

6454 
	`aù
("You f“È¨´e£nû iÀthroom.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

6455 
	`do_look
(
ch
, "auto");

6456 
	`ch¬_äom_room
(
ch
);

6457 
	`ch¬_to_room
(
ch
, 
Üigš®_room
);

6458 
	}
}

6460 
	$¥–l_v’Œoqu©e
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6462 
buf1
[
MAX_STRING_LENGTH
];

6463 
buf2
[
MAX_STRING_LENGTH
];

6464 
Ch¬aù”
 *
vch
;

6466 
SŒšg
 
¥—k”
;

6467 
rg‘_Çme
 = 
	`Úe_¬gum’t
Ñ¬g‘_Çme, 
¥—k”
);

6468 
FÜm©
::
	`¥rštf
(
buf1
, "% §y '%s'.\n", 
¥—k”
, 
rg‘_Çme
);

6469 
FÜm©
::
	`¥rštf
(
buf2
, "SomeÚmake % §y '%s'.\n", 
¥—k”
, 
rg‘_Çme
);

6470 
buf1
[0] = 
	`touµ”
(buf1[0]);

6472 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = vch->
Ãxt_š_room
) {

6473 ià(!
vch
->
Çme
.
	`has_wÜds
(
¥—k”
))

6474 
	`¡c
(
	`§ves_¥–l
(
Ëv–
, 
vch
, 
DAM_OTHER
è? 
buf2
 : 
buf1
, vch);

6478 
	}
}

6481 
	$¥–l_w¿th
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6483 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

6484 
	`damage
(
ch
, 
viùim
, 
	`diû
(
Ëv–
, 23), 
¢
, -1, 
DAM_ENERGY
, 
Œue
,rue);

6485 
	}
}

6487 
	$¥–l_w—k’
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6489 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

6491 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
w—k’
)) {

6492 
	`aù
("Your spell comesoo†ate. $N is‡lready weak.",

6493 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

6497 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_OTHER
)) {

6498 
	`aù
("$N's„esistance is strongerhan your spell.",

6499 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

6503 
	`¡c
("You f“Èyou¸¡»ngth sl‡way.\n", 
viùim
);

6504 
	`aù
("$Àlook tœed‡nd w—k.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

6506 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

6507 
afãù
::
ty³
::
w—k’
,

6508 
Ëv–
,

6509 
Ëv–
 / 2,

6510 
evŞutiÚ
,

6511 
çl£


6513 
	}
}

6516 
	$¥–l_wÜd_of_»ÿÎ
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6518 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

6519 
Room
 *
loÿtiÚ
;

6521 ià(
viùim
->
	`is_Åc
())

6524 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a
) {

6525 ià((
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_TEMPLE
)))è=ğ
nuÎ±r
) {

6526 
	`¡c
("You‡» com¶‘–y†o¡.\n", 
viùim
);

6531 ià((
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_ARENACENTER
)))è=ğ
nuÎ±r
) {

6532 
	`¡c
("You‡» com¶‘–y†o¡.\n", 
ch
);

6537 ià(!
ch
->
	`is_Åc
())

6538 ià(
ch
->
pcd©a
->
pktim”
) {

6539 
	`¡c
("Thgod Ïugh‡ˆyou¸cow¬diû...\n", 
ch
);

6543 ià(
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_NO_RECALL
) ||

6544 
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
cur£
è|| 
	`ch¬_š_du–_room
(
ch
)) {

6545 
	`¡c
("S³Î faed.\n", 
viùim
);

6549 ià(
viùim
->
fightšg
 !ğ
nuÎ±r
)

6550 
	`¡İ_fightšg
(
viùim
, 
Œue
);

6552 ià(!
ch
->
š_room
->
	`şª
(è|| ch->š_room->şª(è!ğch->
şª
)

6553 
ch
->
¡am
 = (ch->stam * 3) / 4;

6555 
	`aù
("$Àdi§µ—rs.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

6556 
	`ch¬_äom_room
(
viùim
);

6557 
	`ch¬_to_room
(
viùim
, 
loÿtiÚ
);

6558 
	`aù
("$À­³¬ šhroom.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

6559 
	`do_look
(
viùim
, "auto");

6560 
	}
}

6565 
	$¥–l_acid_b»©h
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6567 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

6568 
dam
, 
hp_dam
, 
diû_dam
, 
hpch
;

6575 
	`aù
("$À¥™ acid‡ˆ$N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

6576 
	`aù
("$À¥™ ¨¡»am oàcÜrosivacid‡ˆyou.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

6577 
	`aù
("You sp™‡cid‡ˆ$N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

6578 
hpch
 = 
¡d
::
	`max
(12, 
ch
->
h™
);

6579 
hp_dam
 = 
	`numb”_¿nge
(
hpch
 / 11 + 1, hpch / 6);

6580 
diû_dam
 = 
	`diû
(
Ëv–
, 14);

6581 
dam
 = 
¡d
::
	`max
(
hp_dam
 + 
diû_dam
 / 10, dice_dam + hp_dam / 10);

6582 
dam
 *= 2;

6585 ià(
viùim
->
	`is_Åc
())

6586 
dam
 *= 4 / 3;

6588 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_ACID
)) {

6589 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a
)

6590 
	`acid_efãù
(
viùim
, 
Ëv–
 / 2, 
dam
 / 4, 
TARGET_CHAR
, 
evŞutiÚ
);

6592 
	`damage
(
ch
, 
viùim
, 
dam
 / 2, 
¢
, -1, 
DAM_ACID
, 
Œue
,rue);

6595 ià(
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a
)

6596 
	`acid_efãù
(
viùim
, 
Ëv–
, 
dam
, 
TARGET_CHAR
, 
evŞutiÚ
);

6598 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_ACID
, 
Œue
,rue);

6600 
	}
}

6602 
	$¥–l_fœe_b»©h
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6604 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

6605 
Ch¬aù”
 *
vch
, *
vch_Ãxt
;

6606 
dam
, 
hp_dam
, 
diû_dam
;

6607 
hpch
;

6614 
	`aù
("$Àb»©he fÜth‡ cÚoàfœe.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

6615 
	`aù
("$Àb»©he ¨cÚoàhÙ fœov” you!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

6616 
	`aù
("You b»©h fÜth‡ cÚoàfœe.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

6617 
hpch
 = 
¡d
::
	`max
(10, 
ch
->
h™
);

6618 
hp_dam
 = 
	`numb”_¿nge
(
hpch
 / 9 + 1, hpch / 5);

6619 
diû_dam
 = 
	`diû
(
Ëv–
, 18);

6620 
dam
 = 
¡d
::
	`max
(
hp_dam
 + 
diû_dam
 / 10, dice_dam + hp_dam / 10);

6621 
dam
 = dam / 2;

6622 
dam
 *= 2;

6625 ià(
viùim
->
	`is_Åc
())

6626 
dam
 *= 4 / 3;

6628 
	`fœe_efãù
(
viùim
->
š_room
, 
Ëv–
, 
dam
 / 2, 
TARGET_ROOM
, 
evŞutiÚ
);

6630 
vch
 = 
viùim
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = 
vch_Ãxt
) {

6631 
vch_Ãxt
 = 
vch
->
Ãxt_š_room
;

6633 ià(
	`is_§ã_¥–l
(
ch
, 
vch
, 
Œue
))

6636 ià(
vch
->
	`is_Åc
(è&& 
ch
->is_npc()

6637 && (
ch
->
fightšg
 !ğ
vch
 || vch->fighting != ch))

6641 ià(
	`is_§me_group
(
vch
, 
ch
))

6644 ià(
vch
 =ğ
viùim
) {

6645 ià(
	`§ves_¥–l
(
Ëv–
, 
vch
, 
DAM_FIRE
)) {

6646 
	`fœe_efãù
(
vch
, 
Ëv–
 / 2, 
dam
 / 4, 
TARGET_CHAR
, 
evŞutiÚ
);

6647 
	`damage
(
ch
, 
vch
, 2 * 
dam
 / 2, 
¢
, -1, 
DAM_FIRE
, 
Œue
,rue);

6650 
	`fœe_efãù
(
vch
, 
Ëv–
, 
dam
, 
TARGET_CHAR
, 
evŞutiÚ
);

6651 
	`damage
(
ch
, 
vch
, 2 * 
dam
, 
¢
, -1, 
DAM_FIRE
, 
Œue
,rue);

6655 ià(
	`§ves_¥–l
(
Ëv–
 - 2, 
vch
, 
DAM_FIRE
)) {

6656 
	`fœe_efãù
(
vch
, 
Ëv–
 / 4, 
dam
 / 8, 
TARGET_CHAR
, 
evŞutiÚ
);

6657 
	`damage
(
ch
, 
vch
, 
dam
 / 4, 
¢
, -1, 
DAM_FIRE
, 
Œue
,rue);

6660 
	`fœe_efãù
(
vch
, 
Ëv–
 / 2, 
dam
 / 4, 
TARGET_CHAR
, 
evŞutiÚ
);

6661 
	`damage
(
ch
, 
vch
, 
dam
 / 2, 
¢
, -1, 
DAM_FIRE
, 
Œue
,rue);

6665 
	}
}

6667 
	$¥–l_äo¡_b»©h
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6669 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

6670 
Ch¬aù”
 *
vch
, *
vch_Ãxt
;

6671 
dam
, 
hp_dam
, 
diû_dam
, 
hpch
;

6678 
	`aù
("$Àb»©he ouˆ¨ä“zšg cÚoàäo¡!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

6679 
	`aù
("$n breathes‡ freezing cone of frost over you!",

6680 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

6681 
	`aù
("You b»©h ouˆ¨cÚoàäo¡.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

6682 
hpch
 = 
¡d
::
	`max
(12, 
ch
->
h™
);

6683 
hp_dam
 = 
	`numb”_¿nge
(
hpch
 / 11 + 1, hpch / 6);

6684 
diû_dam
 = 
	`diû
(
Ëv–
, 14);

6685 
dam
 = 
¡d
::
	`max
(
hp_dam
 + 
diû_dam
 / 10, dice_dam + hp_dam / 10);

6686 
dam
 /= 2;

6687 
dam
 *= 2;

6690 ià(
viùim
->
	`is_Åc
())

6691 
dam
 *= 4 / 3;

6693 
	`cŞd_efãù
(
viùim
->
š_room
, 
Ëv–
, 
dam
 / 2, 
TARGET_ROOM
, 
evŞutiÚ
);

6695 
vch
 = 
viùim
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = 
vch_Ãxt
) {

6696 
vch_Ãxt
 = 
vch
->
Ãxt_š_room
;

6698 ià(
	`is_§ã_¥–l
(
ch
, 
vch
, 
Œue
)

6699 || (
vch
->
	`is_Åc
(è&& 
ch
->is_npc()

6700 && (
ch
->
fightšg
 !ğ
vch
 || vch->fighting != ch)))

6704 ià(
	`is_§me_group
(
vch
, 
ch
))

6707 ià(
vch
 =ğ
viùim
) {

6708 ià(
	`§ves_¥–l
(
Ëv–
, 
vch
, 
DAM_COLD
)) {

6709 
	`cŞd_efãù
(
vch
, 
Ëv–
 / 2, 
dam
 / 4, 
TARGET_CHAR
, 
evŞutiÚ
);

6710 
	`damage
(
ch
, 
vch
, 2 * 
dam
 / 2, 
¢
, -1, 
DAM_COLD
, 
Œue
,rue);

6713 
	`cŞd_efãù
(
vch
, 
Ëv–
, 
dam
, 
TARGET_CHAR
, 
evŞutiÚ
);

6714 
	`damage
(
ch
, 
vch
, 2 * 
dam
, 
¢
, -1, 
DAM_COLD
, 
Œue
,rue);

6718 ià(
	`§ves_¥–l
(
Ëv–
 - 2, 
vch
, 
DAM_COLD
)) {

6719 
	`cŞd_efãù
(
vch
, 
Ëv–
 / 4, 
dam
 / 8, 
TARGET_CHAR
, 
evŞutiÚ
);

6720 
	`damage
(
ch
, 
vch
, 
dam
 / 4, 
¢
, -1, 
DAM_COLD
, 
Œue
,rue);

6723 
	`cŞd_efãù
(
vch
, 
Ëv–
 / 2, 
dam
 / 4, 
TARGET_CHAR
, 
evŞutiÚ
);

6724 
	`damage
(
ch
, 
vch
, 
dam
 / 2, 
¢
, -1, 
DAM_COLD
, 
Œue
,rue);

6728 
	}
}

6730 
	$¥–l_gas_b»©h
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6732 
Ch¬aù”
 *
vch
;

6733 
Ch¬aù”
 *
vch_Ãxt
;

6734 
dam
, 
hp_dam
, 
diû_dam
, 
hpch
;

6741 
	`aù
("$Àb»©he ouˆ¨şoud oàpoisÚou gas!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

6742 
	`aù
("You b»©h ouˆ¨şoud oàpoisÚou gas.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

6743 
hpch
 = 
¡d
::
	`max
(16, 
ch
->
h™
);

6744 
hp_dam
 = 
	`numb”_¿nge
(
hpch
 / 15 + 1, 8);

6745 
diû_dam
 = 
	`diû
(
Ëv–
, 12);

6746 
dam
 = 
¡d
::
	`max
(
hp_dam
 + 
diû_dam
 / 10, dice_dam + hp_dam / 10);

6747 
dam
 /= 2;

6748 
dam
 *= 2;

6749 
	`poisÚ_efãù
(
ch
->
š_room
, 
Ëv–
, 
dam
, 
TARGET_ROOM
, 
evŞutiÚ
);

6751 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = 
vch_Ãxt
) {

6752 
vch_Ãxt
 = 
vch
->
Ãxt_š_room
;

6754 ià(
	`is_§ã_¥–l
(
ch
, 
vch
, 
Œue
)

6755 || (
ch
->
	`is_Åc
(è&& 
vch
->is_npc()

6756 && (
ch
->
fightšg
 =ğ
vch
 || vch->fighting == ch)))

6760 ià(
	`is_§me_group
(
vch
, 
ch
))

6763 ià(
	`§ves_¥–l
(
Ëv–
, 
vch
, 
DAM_POISON
)) {

6764 
	`poisÚ_efãù
(
vch
, 
Ëv–
 / 2, 
dam
 / 4, 
TARGET_CHAR
, 
evŞutiÚ
);

6765 
	`damage
(
ch
, 
vch
, 2 * 
dam
 / 2, 
¢
, -1, 
DAM_POISON
, 
Œue
,rue);

6768 
	`poisÚ_efãù
(
vch
, 
Ëv–
, 
dam
, 
TARGET_CHAR
, 
evŞutiÚ
);

6769 
	`damage
(
ch
, 
vch
, 2 * 
dam
, 
¢
, -1, 
DAM_POISON
, 
Œue
,rue);

6772 
	}
}

6774 
	$¥–l_lighŠšg_b»©h
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6776 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

6777 
dam
, 
hp_dam
, 
diû_dam
, 
hpch
;

6784 
	`aù
("$Àb»©he ¨bŞˆoàlighŠšg‡ˆ$N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

6785 
	`aù
("$Àb»©he ¨bŞˆoàlighŠšg‡ˆyou!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

6786 
	`aù
("You b»©h¨bŞˆoàlighŠšg‡ˆ$N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

6787 
hpch
 = 
¡d
::
	`max
(10, 
ch
->
h™
);

6788 
hp_dam
 = 
	`numb”_¿nge
(
hpch
 / 9 + 1, hpch / 5);

6789 
diû_dam
 = 
	`diû
(
Ëv–
, 18);

6790 
dam
 = 
¡d
::
	`max
(
hp_dam
 + 
diû_dam
 / 10, dice_dam + hp_dam / 10);

6791 
dam
 *= 2;

6794 ià(
viùim
->
	`is_Åc
())

6795 
dam
 *= 4 / 3;

6797 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_ELECTRICITY
)) {

6798 
	`shock_efãù
(
viùim
, 
Ëv–
 / 2, 
dam
 / 4, 
TARGET_CHAR
, 
evŞutiÚ
);

6799 
	`damage
(
ch
, 
viùim
, 
dam
 / 2, 
¢
, -1, 
DAM_ELECTRICITY
, 
Œue
,rue);

6802 
	`shock_efãù
(
viùim
, 
Ëv–
, 
dam
, 
TARGET_CHAR
, 
evŞutiÚ
);

6803 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_ELECTRICITY
, 
Œue
,rue);

6805 
	}
}

6810 
	$¥–l_g’”®_pu½o£
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6812 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

6813 
dam
;

6814 
dam
 = 
	`numb”_¿nge
(25, 100);

6816 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_PIERCE
))

6817 
dam
 /= 2;

6819 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_PIERCE
, 
Œue
,rue);

6821 
	}
}

6823 
	$¥–l_high_ex¶osive
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6825 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

6826 
dam
;

6827 
dam
 = 
	`numb”_¿nge
(30, 120);

6829 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_PIERCE
))

6830 
dam
 /= 2;

6832 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_PIERCE
, 
Œue
,rue);

6834 
	}
}

6837 
	$¥–l_age
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6839 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

6841 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
age
)) {

6842 
	`aù
("$N i ®»ady‡ged beyÚd $S y—rs.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

6846 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_OTHER
)) {

6847 
	`aù
("A iàby‡ mœaşe, $N„‘aš $S youth.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

6851 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

6852 
afãù
::
ty³
::
age
,

6853 
Ëv–
,

6854 
Ëv–
 / 4,

6855 
evŞutiÚ
,

6856 
çl£


6859 
	`¡c
("You f“Èyour£làgrow old‡nd f¿.\n", 
viùim
);

6860 
	`aù
("$Àlook much old”.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

6861 
	}
}

6870 
	$¥–l_¡¬ve
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

6872 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

6874 ià(! 
viùim
) ;

6877 ià(
viùim
->
	`is_Åc
()) {

6878 
	`¡c
("You¸¥–È£em tØhavnØefãù.\n", 
ch
);

6882 ià(
	`§ves_¥–l
(
Ëv–
, 
viùim
, 
DAM_OTHER
)) {

6883 
	`aù
("$N‡µ—r uÃfãùed.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

6887 
viùim
->
pcd©a
->
cÚd™iÚ
[
COND_HUNGER
] = 0;

6888 
viùim
->
pcd©a
->
cÚd™iÚ
[
COND_THIRST
] = 0;

6889 
viùim
->
pcd©a
->
cÚd™iÚ
[
COND_FULL
] = 0;

6890 
	`¡c
("You‡» sudd’ly v”y hungry.\n", 
viùim
);

6891 
	`aù
("$n' ¡omach growls.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

6892 
	}
}

	@src/marry.cc

40 
	~"aù.hh
"

41 
	~"¬gum’t.hh
"

42 
	~"Ch¬aù”.hh
"

43 
	~"deş¬e.hh
"

44 
	~"DesütÜ.hh
"

45 
	~"fšd.hh
"

46 
	~"FÏgs.hh
"

47 
	~"FÜm©.hh
"

48 
	~"Game.hh
"

49 
	~"memÜy.hh
"

50 
	~"m”c.hh
"

51 
	~"PÏy”.hh
"

52 
	~"SŒšg.hh
"

53 
	~"WÜld.hh
"

55 
	$do_m¬ry
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

57 
Ch¬aù”
 *
viùim
;

58 
Ch¬aù”
 *
viùim2
;

60 
SŒšg
 
¬g1
, 
¬g2
;

61 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

62 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

64 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.empty()) {

65 
	`¡c
("SyÁax: m¬ry <ch¬1> <ch¬2>\n", 
ch
);

69 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g1
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

70 
	`¡c
("Thfœ¡…”sÚ m’tiÚed i¢'ˆ¶ayšg.\n", 
ch
);

74 ià((
viùim2
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g2
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

75 
	`¡c
("Th£cÚd…”sÚ m’tiÚed i¢'ˆ¶ayšg.\n", 
ch
);

79 ià(
viùim
->
pcd©a
->
¥ou£
.
	`em±y
()

80 || 
viùim2
->
pcd©a
->
¥ou£
.
	`em±y
()

81 || 
viùim
->
pcd©a
->
¥ou£
 !ğ
viùim2
->
Çme


82 || 
viùim2
->
pcd©a
->
¥ou£
 !ğ
viùim
->
Çme
) {

83 
	`¡c
("They‡»‚Ùƒngaged.\n", 
ch
);

87 ià(
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_MARRIED
è|| 
viùim2
->pcdata->plr_flags.has(PLR_MARRIED)) {

88 
	`¡c
("They‡»‡Ì—dy m¬r›d.\n", 
ch
);

92 
	`¡c
("You…rÚounûhem husbªd‡nd wiã!\n", 
ch
);

93 
	`±c
(
ch
, "You m¬ry % ªd %s.\n", 
viùim
->
Çme
, 
viùim2
->name);

94 
	`¡c
("You sayhbig 'I do!'\n", 
viùim
);

95 
	`±c
(
viùim
, "You‡»‚ow m¬r›dØ%s.\n", 
viùim2
->
Çme
);

96 
	`¡c
("You sayhbig 'I do!'\n", 
viùim2
);

97 
	`±c
(
viùim2
, "You‡»‚ow m¬r›dØ%s.\n", 
viùim
->
Çme
);

98 
viùim
->
pcd©a
->
¶r_æags
 +ğ
PLR_MARRIED
;

99 
viùim2
->
pcd©a
->
¶r_æags
 +ğ
PLR_MARRIED
;

100 
	`§ve_ch¬_obj
(
viùim
);

101 
	`§ve_ch¬_obj
(
viùim2
);

103 
	}
}

105 
	$do_divÜû
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

107 
Ch¬aù”
 *
viùim
;

108 
Ch¬aù”
 *
viùim2
;

110 
SŒšg
 
¬g1
, 
¬g2
;

111 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

112 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

114 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.empty()) {

115 
	`¡c
("SyÁax: divÜû <ch¬1> <ch¬2>\n", 
ch
);

119 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g1
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

120 
	`¡c
("Thfœ¡…”sÚ m’tiÚed i¢'ˆ¶ayšg.\n", 
ch
);

124 ià((
viùim2
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g2
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

125 
	`¡c
("Th£cÚd…”sÚ m’tiÚed i¢'ˆ¶ayšg.\n", 
ch
);

129 ià(!
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_MARRIED
è|| !
viùim2
->pcdata->plr_flags.has(PLR_MARRIED)) {

130 
	`¡c
("They‡»n'ˆev’ m¬r›d.\n", 
ch
);

134 ià(
viùim
->
pcd©a
->
¥ou£
 !ğ
viùim2
->
Çme
) {

135 
	`¡c
("They‡»n'ˆev’ m¬r›dØ—ch oth”.\n", 
ch
);

139 
	`¡c
("You hªdhemheœ…­”s.\n", 
ch
);

140 
	`±c
(
ch
, "You divÜû % ªd %s.\n", 
viùim
->
Çme
, 
viùim2
->name);

141 
	`¡c
("You¸divÜû i fš®.\n", 
viùim
);

142 
	`±c
(
viùim
, "You‡»‚ow divÜûd from %s.\n", 
viùim2
->
Çme
);

143 
	`¡c
("You¸divÜû i fš®.\n", 
viùim2
);

144 
	`±c
(
viùim2
, "You‡»‚ow divÜûd from %s.\n", 
viùim
->
Çme
);

145 
viùim
->
pcd©a
->
¥ou£
.
	`”a£
();

146 
viùim2
->
pcd©a
->
¥ou£
.
	`”a£
();

147 
viùim
->
pcd©a
->
¶r_æags
 -ğ
PLR_MARRIED
;

148 
viùim2
->
pcd©a
->
¶r_æags
 -ğ
PLR_MARRIED
;

149 
	`§ve_ch¬_obj
(
viùim
);

150 
	`§ve_ch¬_obj
(
viùim2
);

152 
	}
}

154 
	$do_¥ou£lk
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

156 
buf
[
MAX_STRING_LENGTH
];

158 ià(
ch
->
	`is_Åc
()) {

159 
	`do_huh
(
ch
);

163 ià(!
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_MARRIED
)) {

164 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_SPOUSE
);

165 
	`¡c
("Buˆyou‡»n'ˆm¬r›d.\n", 
ch
);

166 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

170 ià(
ch
->
pcd©a
->
¥ou£
.
	`em±y
()) {

171 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_SPOUSE
);

172 
	`¡c
("You‡»n'ˆev’ƒngaged. How dØyouƒx³ùØlkØyou¸Ùh” h®f?\n", 
ch
);

173 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

177 ià(
¬gum’t
.
	`em±y
()) {

178 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_SPOUSE
);

179 
	`¡c
("Wh© dØyou wishØ‹Î you¸Ùh” h®f?\n", 
ch
);

180 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

184 
Ch¬aù”
 *
viùim
 = 
nuÎ±r
;

188 autØ
vch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

189 ià(
vch
->
š_room
 !ğ
nuÎ±r


190 && !
vch
->
	`is_Åc
()

191 && 
vch
->
Çme
.
	`has_wÜds
(
ch
->
pcd©a
->
¥ou£
)) {

192 
viùim
 = 
vch
;

197 ià(
viùim
 !ğ
nuÎ±r
) {

198 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_SPOUSE
);

199 
	`Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_SPOUSE
);

200 
FÜm©
::
	`¥rštf
(
buf
, "% §y tØyou, '%s'\n" , 
ch
->
Çme
, 
¬gum’t
);

201 
	`¡c
(
buf
, 
viùim
);

202 
FÜm©
::
	`¥rštf
(
buf
, "You sayØ%s, '%s'\n", 
ch
->
pcd©a
->
¥ou£
, 
¬gum’t
);

203 
	`¡c
(
buf
, 
ch
);

204 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

205 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

208 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_CHAN_SPOUSE
);

209 
	`¡c
("You¸¥ou£ i nÙ h”e.\n", 
ch
);

210 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

215 
	}
}

217 
	$do_´İo£
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

219 
Ch¬aù”
 *
viùim
;

221 ià(
ch
->
	`is_Åc
()) {

222 
	`do_huh
(
ch
);

226 ià(
¬gum’t
.
	`em±y
()) {

227 
	`¡c
("Prİo£Øwho?\n", 
ch
);

231 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_MARRIED
)) {

232 
	`¡c
("You‡»‡Ì—dy m¬r›d.\n", 
ch
);

236 ià(!
ch
->
pcd©a
->
¥ou£
.
	`em±y
()) {

237 
	`¡c
("You‡»‡Ì—dyƒngaged.\n", 
ch
);

241 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬gum’t
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

242 
	`¡c
("They‡»n'ˆšhroom.\n", 
ch
);

246 ià(
viùim
->
	`is_Åc
()) {

247 
	`¡c
("Th©' ju¡ sly.\n", 
ch
);

251 ià(
viùim
 =ğ
ch
) {

252 
	`¡c
("You u‰”ly„ejeù your£lf.\n", 
ch
);

256 ià(
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_MARRIED
)) {

257 
	`¡c
("They‡»‡Ì—dy m¬r›d.\n", 
ch
);

261 ià(!
viùim
->
pcd©a
->
¥ou£
.
	`em±y
()) {

262 
	`¡c
("They‡»‡Ì—dyƒngaged.\n", 
ch
);

266 
ch
->
pcd©a
->
´İo£
 = 
viùim
->
Çme
;

267 
	`aù
("You…rİo£ m¬rŸgtØ$M.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

268 
	`aù
("$Àg‘ dowÀÚ oÃ kÃªd…rİo£ tØ$N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

269 
	`aù
("$Àask you qu›y 'WÈyou m¬ry me?'", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

271 
	}
}

273 
	$do_acû±
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

275 
Ch¬aù”
 *
viùim
;

276 
buf
[
MSL
];

277 
DesütÜ
 *
d
;

279 ià(
ch
->
	`is_Åc
()) {

280 
	`do_huh
(
ch
);

284 ià(
¬gum’t
.
	`em±y
()) {

285 
	`¡c
("Acû± who' ´İo§l?\n", 
ch
);

289 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_MARRIED
)) {

290 
	`¡c
("You‡»‡Ì—dy m¬r›d.\n", 
ch
);

294 ià(!
ch
->
pcd©a
->
¥ou£
.
	`em±y
()) {

295 
	`¡c
("You‡»‡Ì—dyƒngaged.\n", 
ch
);

299 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬gum’t
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

300 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

304 ià(
viùim
->
	`is_Åc
()) {

305 
	`¡c
("Now why wouldhey…rİo£Øyou?\n", 
ch
);

309 ià(
viùim
 =ğ
ch
) {

310 
	`¡c
("NÙ‡ good id—h”e.\n", 
ch
);

314 ià(
viùim
->
pcd©a
->
´İo£
.
	`em±y
(è|| viùim->pcd©a->´İo£ !ğ
ch
->
Çme
) {

315 
	`¡c
("They hav’'ˆ´İo£dØyou.\n", 
ch
);

319 
viùim
->
pcd©a
->
´İo£
.
	`”a£
();

320 
ch
->
pcd©a
->
´İo£
.
	`”a£
();

321 
viùim
->
pcd©a
->
¥ou£
 = 
ch
->
Çme
;

322 
ch
->
pcd©a
->
¥ou£
 = 
viùim
->
Çme
;

323 
	`aù
("You‡cû± $S ofã¸oàm¬rŸge. Woohoo!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

324 
	`aù
("$Àacû± $N' ofã¸oàm¬rŸge. Woohoo!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

325 
	`aù
("$Àacû± you¸ofã¸oàm¬rŸge. Woohoo!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

326 
FÜm©
::
	`¥rštf
(
buf
, "{W[FYI] % ªd % ¬nowƒngaged! CÚg¿tuÏtiÚs!{x\n", 
ch
->
Çme
, 
viùim
->name);

328 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

329 
Ch¬aù”
 *
msgviù
;

330 
msgviù
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

332 ià(
d
->
	`is_¶ayšg
() &&

333 !
msgviù
->
comm_æags
.
	`has
(
COMM_NOANNOUNCE
) &&

334 !
msgviù
->
comm_æags
.
	`has
(
COMM_QUIET
))

335 
	`¡c
(
buf
, 
msgviù
);

338 
	`§ve_ch¬_obj
(
ch
);

339 
	`§ve_ch¬_obj
(
viùim
);

341 
	}
}

343 
	$do_»jeù
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

345 
Ch¬aù”
 *
viùim
;

347 ià(
ch
->
	`is_Åc
()) {

348 
	`do_huh
(
ch
);

352 ià(
¬gum’t
.
	`em±y
()) {

353 
	`¡c
("Rejeù who' ´İo§l?\n", 
ch
);

357 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_MARRIED
)) {

358 
	`¡c
("You‡»‡Ì—dy m¬r›d.\n", 
ch
);

362 ià(!
ch
->
pcd©a
->
¥ou£
.
	`em±y
()) {

363 
	`¡c
("You‡»‡Ì—dyƒngaged.\n", 
ch
);

367 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬gum’t
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

368 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

372 ià(
viùim
->
	`is_Åc
()) {

373 
	`¡c
("Now why wouldhey…rİo£Øyou?\n", 
ch
);

377 ià(
viùim
 =ğ
ch
) {

378 
	`¡c
("NÙ‡ good id—h”e.\n", 
ch
);

382 ià(
viùim
->
pcd©a
->
´İo£
 !ğ
ch
->
Çme
) {

383 
	`¡c
("They hav’'ˆ´İo£dØyou.\n", 
ch
);

387 
viùim
->
pcd©a
->
´İo£
.
	`”a£
();

388 
ch
->
pcd©a
->
´İo£
.
	`”a£
();

389 
	`aù
("You„ejeù $S ofã¸oàm¬rŸge.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

390 
	`aù
("$À»jeù $N' ofã¸oàm¬rŸge.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

391 
	`aù
("$À»jeù you¸ofã¸oàm¬rŸge.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

392 
	`§ve_ch¬_obj
(
ch
);

393 
	`§ve_ch¬_obj
(
viùim
);

395 
	}
}

397 
	$do_b»akup
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

399 
Ch¬aù”
 *
viùim
;

400 
buf
[
MSL
];

401 
DesütÜ
 *
d
;

403 ià(
ch
->
	`is_Åc
()) {

404 
	`do_huh
(
ch
);

408 ià(
¬gum’t
.
	`em±y
()) {

409 
	`¡c
("B»aku°w™h who?\n", 
ch
);

413 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_MARRIED
)) {

414 
	`¡c
("You‡» m¬r›d, you havtØg‘‡ divÜû.\n", 
ch
);

418 ià(
ch
->
pcd©a
->
¥ou£
.
	`em±y
()) {

419 
	`¡c
("You‡»n'ˆ’gaged.\n", 
ch
);

423 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬gum’t
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

424 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

428 ià(
viùim
 =ğ
ch
) {

429 
	`¡c
("NÙ w™h your£lf.\n", 
ch
);

433 ià(
viùim
->
	`is_Åc
()) {

434 
	`¡c
("Bad id—.\n", 
ch
);

438 ià(
ch
->
pcd©a
->
¥ou£
 !ğ
viùim
->
Çme


439 || 
viùim
->
pcd©a
->
¥ou£
.
	`em±y
()

440 || 
viùim
->
pcd©a
->
¥ou£
 !ğ
ch
->
Çme
) {

441 
	`¡c
("They‡»n'ˆev’ƒngagedØyou.\n\t", 
ch
);

445 
viùim
->
pcd©a
->
¥ou£
.
	`”a£
();

446 
ch
->
pcd©a
->
¥ou£
.
	`”a£
();

447 
	`aù
("You b»ak ofàyou¸’gagem’ˆw™h $M.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

448 
	`aù
("$Àb»ak ofà$ ’gagem’ˆw™h $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

449 
	`aù
("$Àb»ak ofà$ ’gagem’ˆw™h you.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

450 
FÜm©
::
	`¥rštf
(
buf
, "{W[FYI] % ªd % havbrok’ ofàtheœƒngagem’t.{x\n", 
ch
->
Çme
, 
viùim
->name);

452 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

453 
Ch¬aù”
 *
msgviù
;

454 
msgviù
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

456 ià(
d
->
	`is_¶ayšg
() &&

457 !
msgviù
->
comm_æags
.
	`has
(
COMM_NOANNOUNCE
) &&

458 !
msgviù
->
comm_æags
.
	`has
(
COMM_QUIET
))

459 
	`¡c
(
buf
, 
msgviù
);

462 
	`§ve_ch¬_obj
(
ch
);

463 
	`§ve_ch¬_obj
(
viùim
);

465 
	}
}

	@src/memory.cc

12 
	gtİ_ex™
;

13 
	gtİ_mob_šdex
;

14 
	gtİ_obj_šdex
;

15 
	gtİ_»£t
;

16 
	gtİ_room
;

17 
	gtİ_shİ
;

	@src/mob_commands.cc

29 
	~"aù.hh
"

30 
	~"¬gum’t.hh
"

31 
	~"afãù/Afãù.hh
"

32 
	~"Ch¬aù”.hh
"

33 
	~"deş¬e.hh
"

34 
	~"Ex™.hh
"

35 
	~"fšd.hh
"

36 
	~"FÏgs.hh
"

37 
	~"FÜm©.hh
"

38 
	~"Game.hh
"

39 
	~"Loggšg.hh
"

40 
	~"memÜy.hh
"

41 
	~"m”c.hh
"

42 
	~"MobePrÙÙy³.hh
"

43 
	~"MobProg.hh
"

44 
	~"Objeù.hh
"

45 
	~"PÏy”.hh
"

46 
	~"Room.hh
"

47 
	~"SŒšg.hh
"

48 
	~"WÜld.hh
"

56 
	$do_mp¡©
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

58 
buf
[ 
MAX_STRING_LENGTH
 ];

59 
Ch¬aù”
 *
viùim
;

61 
SŒšg
 
¬g
;

62 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

64 ià(
¬g
.
	`em±y
()) {

65 
	`¡c
("MobProg sˆwhom?\n", 
ch
);

69 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

70 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

74 ià(!
viùim
->
	`is_Åc
()) {

75 
	`¡c
("OÆy Mobe ÿÀhavProg¿ms!\n", 
ch
);

79 ià(
viùim
->
pIndexD©a
->
´ogty³_æags
.
	`em±y
()) {

80 
	`¡c
("Th© Mobha nØProg¿m £t.\n", 
ch
);

84 
FÜm©
::
	`¥rštf
(
buf
, "Name: %s. Vnum: %d.\n",

85 
viùim
->
Çme
, viùim->
pIndexD©a
->
vnum
);

86 
	`¡c
(
buf
, 
ch
);

87 
FÜm©
::
	`¥rštf
(
buf
, "Short description: %s.\nLong description: %s",

88 
viùim
->
shÜt_desü
,

89 !
viùim
->
lÚg_desü
.
	`em±y
() ?

90 
viùim
->
lÚg_desü
 : "(none).\n");

91 
	`¡c
(
buf
, 
ch
);

92 
FÜm©
::
	`¥rštf
(
buf
, "Hp: %d/%d. Mana: %d/%d. Stamina: %d/%d. \n",

93 
viùim
->
h™
, 
	`GET_MAX_HIT
(victim),

94 
viùim
->
mªa
, 
	`GET_MAX_MANA
(victim),

95 
viùim
->
¡am
, 
	`GET_MAX_STAM
(victim));

96 
	`¡c
(
buf
, 
ch
);

97 
FÜm©
::
	`¥rštf
(
buf
,

99 
viùim
->
Ëv–
, viùim->
gud
, viùim->
®ignm’t
,

100 
	`GET_AC
(
viùim
, 
AC_PIERCE
), viùim->
gŞd
, viùim->
exp
);

101 
	`¡c
(
buf
, 
ch
);

103 cÚ¡‡utØ
m´g
 : 
viùim
->
pIndexD©a
->
mob´ogs
) {

104 
FÜm©
::
	`¥rštf
(
buf
, ">%s %s\n%s\n",

105 
MobProg
::
	`ty³_to_Çme
(
m´g
->
ty³
),

106 
m´g
->
¬gli¡
,

107 
m´g
->
comli¡
);

108 
	`¡c
(
buf
, 
ch
);

112 
	}
}

116 
	$do_m·sound
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

118 
Room
 *
was_š_room
;

119 
doÜ
;

120 
boŞ
 
§ve_mobŒigg”
;

122 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

123 
	`¡c
("Huh?\n", 
ch
);

127 ià(
¬gum’t
.
	`em±y
()) {

128 
Loggšg
::
	`bugf
("M·sound - NØ¬gum’t: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

132 
was_š_room
 = 
ch
->
š_room
;

134 
doÜ
 = 0; door <= 5; door++) {

135 
Ex™
 *
³x™
;

137 ià((
³x™
 = 
was_š_room
->
ex™
[
doÜ
]è!ğ
nuÎ±r


138 && 
³x™
->
to_room
 !ğ
nuÎ±r


139 && 
³x™
->
to_room
 !ğ
was_š_room
) {

140 
ch
->
š_room
 = 
³x™
->
to_room
;

141 
§ve_mobŒigg”
 = 
MOBŒigg”
;

142 
MOBŒigg”
 = 
çl£
;

143 
	`aù
(
¬gum’t
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

144 
MOBŒigg”
 = 
§ve_mobŒigg”
;

148 
ch
->
š_room
 = 
was_š_room
;

150 
	}
}

154 
	$do_mpkl
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

156 
Ch¬aù”
 *
viùim
;

158 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

159 
	`¡c
("Huh?\n", 
ch
);

163 
SŒšg
 
¬g
;

164 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

166 ià(
¬g
.
	`em±y
()) {

167 
Loggšg
::
	`bugf
("MpKill -‚o‡rgument: vnum %d.",

168 
ch
->
pIndexD©a
->
vnum
);

172 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

173 
Loggšg
::
	`bugf
("MpKill - Victim‚ot in„oom: vnum %d.",

174 
ch
->
pIndexD©a
->
vnum
);

178 ià(
viùim
 =ğ
ch
) {

179 
Loggšg
::
	`bugf
("MpKill - Bad victimo‡ttack: vnum %d.",

180 
ch
->
pIndexD©a
->
vnum
);

184 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è&& ch->
ma¡”
 =ğ
viùim
) {

185 
Loggšg
::
	`bugf
("MpKill - Charmed mob‡ttacking master: vnum %d.",

186 
ch
->
pIndexD©a
->
vnum
);

190 ià(
ch
->
fightšg
) {

191 
Loggšg
::
	`bugf
("MpKill - Already fighting: vnum %d",

192 
ch
->
pIndexD©a
->
vnum
);

196 
	`muÉi_h™
(
ch
, 
viùim
, 
skl
::
ty³
::
unknown
);

198 
	}
}

204 
	$do_mpjunk
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

206 
Objeù
 *
obj
;

207 
Objeù
 *
obj_Ãxt
;

209 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

210 
	`¡c
("Huh?\n", 
ch
);

214 
SŒšg
 
¬g
;

215 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

217 ià(
¬g
.
	`em±y
()) {

218 
Loggšg
::
	`bugf
("Mpjunk - NØ¬gum’t: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

222 ià(
¬g
 !ğ"®l" && !¬g.
	`has_´efix
("all.")) {

223 ià((
obj
 = 
	`g‘_obj_w—r
(
ch
, 
¬g
)è!ğ
nuÎ±r
) {

224 
	`uÃqu_ch¬
(
ch
, 
obj
);

225 
	`exŒaù_obj
(
obj
);

229 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g
)è=ğ
nuÎ±r
)

232 
	`exŒaù_obj
(
obj
);

235 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

236 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

238 ià(
¬g
[3] =ğ'\0' || 
obj
->
Çme
.
	`has_wÜds
(&arg[4])) {

239 ià(
obj
->
w—r_loc
 !ğ
WEAR_NONE
)

240 
	`uÃqu_ch¬
(
ch
, 
obj
);

242 
	`exŒaù_obj
(
obj
);

247 
	}
}

251 
	$do_m³chßround
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

253 
Ch¬aù”
 *
viùim
;

255 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

256 
	`¡c
("Huh?\n", 
ch
);

260 
SŒšg
 
¬g
;

261 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

263 ià(
¬g
.
	`em±y
()) {

264 
Loggšg
::
	`bugf
("M³chßround - NØ¬gum’t: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

268 ià(!(
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
))) {

269 
Loggšg
::
	`bugf
("Mpechoaround - victim does‚otƒxist: vnum %d.",

270 
ch
->
pIndexD©a
->
vnum
);

274 
	`aù
(
¬gum’t
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

276 
	}
}

280 
	$do_m³chßt
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

282 
Ch¬aù”
 *
viùim
;

284 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

285 
	`¡c
("Huh?\n", 
ch
);

289 
SŒšg
 
¬g
;

290 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

292 ià(
¬g
.
	`em±y
(è|| 
¬gum’t
.empty()) {

293 
Loggšg
::
	`bugf
("Mpechoat - No‡rgument: vnum %d.",

294 
ch
->
pIndexD©a
->
vnum
);

298 ià(!(
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
))) {

299 
Loggšg
::
	`bugf
("Mpechoat - victim does‚otƒxist: vnum %d.",

300 
ch
->
pIndexD©a
->
vnum
);

304 
	`aù
(
¬gum’t
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

306 
	}
}

310 
	$do_m³cho
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

312 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

313 
	`¡c
("Huh?\n", 
ch
);

317 ià(
¬gum’t
.
	`em±y
()) {

318 
Loggšg
::
	`bugf
("Mpecho - called w/o‡rgument: vnum %d.",

319 
ch
->
pIndexD©a
->
vnum
);

323 
	`aù
(
¬gum’t
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

325 
	}
}

327 
	$do_mpş—rmÚey
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

329 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

330 
	`¡c
("Huh?\n", 
ch
);

334 
ch
->
gŞd
 = 0;

335 
ch
->
sv”
 = 0;

337 
	}
}

343 
	$do_mpmlßd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

345 
MobePrÙÙy³
 *
pMobIndex
;

346 
Ch¬aù”
 *
viùim
;

348 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

349 
	`¡c
("Huh?\n", 
ch
);

353 
SŒšg
 
¬g
;

354 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

356 ià(
¬g
.
	`em±y
(è|| !¬g.
	`is_numb”
()) {

357 
Loggšg
::
	`bugf
("Mpmlßd - Bad vnum‡ ¬g: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

361 ià((
pMobIndex
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
	`©oi
(
¬g
))è=ğ
nuÎ±r
) {

362 
Loggšg
::
	`bugf
("Mpmlßd - Bad mob vnum: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

366 
viùim
 = 
	`ü—‹_mobe
(
pMobIndex
);

368 ià(! 
viùim
) {

369 
Loggšg
::
	`bug
("Memoryƒrror in do_mpmload().", 0);

373 
	`ch¬_to_room
(
viùim
, 
ch
->
š_room
);

375 
	}
}

377 
	$do_mpŞßd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

379 
ObjeùPrÙÙy³
 *
pObjIndex
;

380 
Objeù
 *
obj
;

382 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

383 
	`do_huh
(
ch
);

387 
SŒšg
 
¬g1
, 
¬g2
;

388 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

389 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

391 ià(
¬g1
.
	`em±y
(è|| !¬g1.
	`is_numb”
()) {

392 
Loggšg
::
	`bugf
("Mpoload - Bad syntax: vnum %d.",

393 
ch
->
pIndexD©a
->
vnum
);

397 ià((
pObjIndex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
	`©oi
(
¬g1
))è=ğ
nuÎ±r
) {

398 
Loggšg
::
	`bugf
("MpŞßd - Bad vnum‡rg: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

402 
obj
 = 
	`ü—‹_objeù
(
pObjIndex
, 0);

404 ià(! 
obj
) {

405 
Loggšg
::
	`bug
("Memoryƒrror creating object in mpoload.", 0);

409 ià(
	`CAN_WEAR
(
obj
, 
ITEM_TAKE
))

410 
	`obj_to_ch¬
(
obj
, 
ch
);

412 
	`obj_to_room
(
obj
, 
ch
->
š_room
);

415 
	}
}

422 
	$do_mµurge
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

424 
Ch¬aù”
 *
viùim
;

425 
Objeù
 *
obj
;

427 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

428 
	`¡c
("Huh?\n", 
ch
);

432 
SŒšg
 
¬g
;

433 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

435 ià(
¬g
.
	`em±y
()) {

437 
Ch¬aù”
 *
vÃxt
;

438 
Objeù
 *
obj_Ãxt
;

440 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = 
vÃxt
) {

441 
vÃxt
 = 
viùim
->
Ãxt_š_room
;

443 ià(
viùim
->
	`is_Åc
(è&& viùim !ğ
ch
)

444 
	`exŒaù_ch¬
(
viùim
, 
Œue
);

447 
obj
 = 
ch
->
š_room
->
cÚ‹Ás
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

448 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

449 
	`exŒaù_obj
(
obj
);

455 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g
, 
VIS_CHAR
)è!ğ
nuÎ±r
) {

456 ià(!
viùim
->
	`is_Åc
()) {

457 
Loggšg
::
	`bugf
("Mµurg- Purgšg‡ PC: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

461 
	`exŒaù_ch¬
(
viùim
, 
Œue
);

464 ià((
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬g
)è!ğ
nuÎ±r
)

465 
	`exŒaù_obj
(
obj
);

467 
Loggšg
::
	`bugf
("Mµurg- Bad‡rgum’t: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

468 
	}
}

472 
	$do_mpgÙo
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

474 
Room
 *
loÿtiÚ
;

476 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

477 
	`¡c
("Huh?\n", 
ch
);

481 
SŒšg
 
¬g
;

482 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

484 ià(
¬g
.
	`em±y
()) {

485 
Loggšg
::
	`bugf
("MpgÙØ- NØ¬gum’t: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

489 ià((
loÿtiÚ
 = 
	`fšd_loÿtiÚ
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

490 
Loggšg
::
	`bugf
("MpgÙØ- NØsuch†oÿtiÚ: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

494 ià(
ch
->
fightšg
 !ğ
nuÎ±r
)

495 
	`¡İ_fightšg
(
ch
, 
Œue
);

497 
	`ch¬_äom_room
(
ch
);

498 
	`ch¬_to_room
(
ch
, 
loÿtiÚ
);

500 
	}
}

504 
	$do_m·t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

506 
Room
 *
loÿtiÚ
;

507 
Room
 *
Üigš®
;

509 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

510 
	`¡c
("Huh?\n", 
ch
);

514 
SŒšg
 
¬g
;

515 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

517 ià(
¬g
.
	`em±y
(è|| 
¬gum’t
.empty()) {

518 
Loggšg
::
	`bugf
("M·ˆ- Bad‡rgum’t: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

522 ià((
loÿtiÚ
 = 
	`fšd_loÿtiÚ
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

523 
Loggšg
::
	`bugf
("M·ˆ- NØsuch†oÿtiÚ: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

527 
Üigš®
 = 
ch
->
š_room
;

528 
	`ch¬_äom_room
(
ch
);

529 
	`ch¬_to_room
(
ch
, 
loÿtiÚ
);

530 
	`š‹½»t
(
ch
, 
¬gum’t
);

536 ià(
ch
->
	`is_g¬bage
())

539 
	`ch¬_äom_room
(
ch
);

540 
	`ch¬_to_room
(
ch
, 
Üigš®
);

541 
	}
}

546 
	$do_m±¿nsãr
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

548 
Room
 *
loÿtiÚ
;

551 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

552 
	`do_huh
(
ch
);

556 
SŒšg
 
¬g1
, 
¬g2
;

557 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

558 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

560 ià(
¬g1
.
	`em±y
()) {

561 
Loggšg
::
	`bugf
("M±¿nsã¸- Bad syÁax: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

585 ià(
¬g2
.
	`em±y
())

586 
loÿtiÚ
 = 
ch
->
š_room
;

588 ià((
loÿtiÚ
 = 
	`fšd_loÿtiÚ
(
ch
, 
¬g2
)è=ğ
nuÎ±r
) {

589 
Loggšg
::
	`bugf
("M±¿nsã¸- NØsuch†oÿtiÚ: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

593 ià(
loÿtiÚ
->
	`is_´iv©e
()) {

594 
Loggšg
::
	`bugf
("M±¿nsã¸- Priv©room: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

599 
Ch¬aù”
 *
viùim
 = 
nuÎ±r
;

600 autØ
vch
 : 
Game
::
	`wÜld
().
ch¬_li¡
)

601 ià(
vch
->
Çme
.
	`has_wÜds
(
¬g1
)) {

602 
viùim
 = 
vch
;

606 ià(
viùim
 =ğ
nuÎ±r
) {

607 
Loggšg
::
	`bugf
("M±¿nsã¸- NØsuch…”sÚ: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

611 ià(
viùim
->
š_room
 =ğ
nuÎ±r
) {

612 
Loggšg
::
	`bugf
("M±¿nsã¸- Viùim iÀnuÎ±¸room: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

616 ià(
viùim
->
fightšg
 !ğ
nuÎ±r
)

617 
	`¡İ_fightšg
(
viùim
, 
Œue
);

619 
	`ch¬_äom_room
(
viùim
);

620 
	`ch¬_to_room
(
viùim
, 
loÿtiÚ
);

622 
	}
}

626 
	$do_mpfÜû
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

628 ià(!
ch
->
	`is_Åc
(è|| ch->
aù_æags
.
	`has
(
ACT_MORPH
)) {

629 
	`do_huh
(
ch
);

633 
SŒšg
 
¬g
;

634 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

636 ià(
¬g
.
	`em±y
(è|| 
¬gum’t
.empty()) {

637 
Loggšg
::
	`bugf
("MpfÜû - Bad syÁax: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

641 ià(
¬g
 == "all") {

642 
Ch¬aù”
 *
vch
, *
vch_Ãxt
;

644 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = 
vch_Ãxt
) {

645 
vch_Ãxt
 = 
vch
->
Ãxt_š_room
;

647 ià(
vch
->
š_room
 =ğ
ch
->in_room

648 && !
	`IS_IMMORTAL
(
vch
))

650 
	`š‹½»t
(
vch
, 
¬gum’t
);

654 
Ch¬aù”
 *
viùim
;

656 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = viùim->
Ãxt_š_room
)

657 ià(
viùim
->
Çme
.
	`has_wÜds
(
¬g
))

660 ià(
viùim
 =ğ
nuÎ±r
) {

661 
Loggšg
::
	`bugf
("MpfÜû - NØsuch viùim: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

665 ià(
viùim
 =ğ
ch
) {

666 
Loggšg
::
	`bugf
("MpfÜû - FÜcšg oÃ£lf: vnum %d.", 
ch
->
pIndexD©a
->
vnum
);

670 
	`š‹½»t
(
viùim
, 
¬gum’t
);

672 
	}
}

	@src/mob_prog.cc

29 
	~<c¡ršg
>

31 
	~"¬gum’t.hh
"

32 
	~"afãù/Afãù.hh
"

33 
	~"A»a.hh
"

34 
	~"Ch¬aù”.hh
"

35 
	~"deş¬e.hh
"

36 
	~"DesütÜ.hh
"

37 
	~"FÏgs.hh
"

38 
	~"GameTime.hh
"

39 
	~"Loggšg.hh
"

40 
	~"memÜy.hh
"

41 
	~"m”c.hh
"

42 
	~"MobePrÙÙy³.hh
"

43 
	~"MobProg.hh
"

44 
	~"MobProgAùLi¡.hh
"

45 
	~"Objeù.hh
"

46 
	~"ObjeùPrÙÙy³.hh
"

47 
	~"ObjeùV®ue.hh
"

48 
	~"PÏy”.hh
"

49 
	~"¿ndom.hh
"

50 
	~"Room.hh
"

51 
	~"SŒšg.hh
"

52 
	~"WÜld.hh
"

54 
boŞ
 
	gMOBŒigg”
;

60 *
m´og_Ãxt_commªd
 
¬gs
((*
şi¡
));

61 
boŞ
 
m´og_£v®
 
¬gs
((cÚ¡ 
SŒšg
& 
lhs
, cÚ¡ SŒšg& 
İr
, cÚ¡ SŒšg& 
rhs
));

62 
boŞ
 
m´og_vev®
 
¬gs
((
lhs
, cÚ¡ 
SŒšg
& 
İr
, 
rhs
));

63 
boŞ
 
m´og_do_ifchck
 
¬gs
((cÚ¡ 
SŒšg
& 
ifchck
, 
Ch¬aù”
 *
mob
,

64 
Ch¬aù”
 *
aùÜ
, 
Objeù
 *
obj
,

65 *
vo
, 
Ch¬aù”
 *
ºdm
));

66 *
m´og_´oûss_if
 
¬gs
((cÚ¡ 
SŒšg
& 
ifchck
, *
com_li¡
,

67 
Ch¬aù”
 *
mob
, Ch¬aù” *
aùÜ
,

68 
Objeù
 *
obj
, *
vo
,

69 
Ch¬aù”
 *
ºdm
));

70 
SŒšg
 
m´og_Œª¦©e
 
¬gs
((
ch
, 
Ch¬aù”
 *
mob
,

71 
Ch¬aù”
 *
aùÜ
, 
Objeù
 *
obj
,

72 *
vo
, 
Ch¬aù”
 *
ºdm
));

73 
m´og_´oûss_cmnd
 
¬gs
((cÚ¡ 
SŒšg
& 
cmnd
, 
Ch¬aù”
 *
mob
,

74 
Ch¬aù”
 *
aùÜ
, 
Objeù
 *
obj
,

75 *
vo
, 
Ch¬aù”
 *
ºdm
));

76 
m´og_driv”
 
¬gs
((cÚ¡ 
SŒšg
& 
com_li¡
, 
Ch¬aù”
 *
mob
,

77 
Ch¬aù”
 *
aùÜ
, 
Objeù
 *
obj
,

78 *
vo
));

88 *
	$m´og_Ãxt_commªd
(*
şi¡
)

90 *
poš‹r
 = 
şi¡
;

92 *
poš‹r
 != '\n' && *pointer != '\0')

93 
poš‹r
++;

95 ià(*
poš‹r
 == '\n')

96 *
poš‹r
++ = '\0';

98  (
poš‹r
);

99 
	}
}

108 
boŞ
 
	$m´og_£v®
(cÚ¡ 
SŒšg
& 
lhs
, cÚ¡ *
İr
, cÚ¡ *
rhs
)

110 ià(!
	`¡rcmp
(
İr
, "=="))

111  (
boŞ
)(!
	`¡rcmp
(
lhs
, 
rhs
));

113 ià(!
	`¡rcmp
(
İr
, "!="))

114  (
boŞ
)(
	`¡rcmp
(
lhs
, 
rhs
));

116 ià(!
	`¡rcmp
(
İr
, "/"))

117  
lhs
.
	`has_šfix
(
rhs
);

119 ià(!
	`¡rcmp
(
İr
, "!/"))

120  !
lhs
.
	`has_šfix
(
rhs
);

122 
Loggšg
::
	`bug
("Improper MOBprog operator\n", 0);

124 
	}
}

126 
boŞ
 
	$m´og_vev®
(
lhs
, cÚ¡ *
İr
, 
rhs
)

128 ià(!
	`¡rcmp
(
İr
, "=="))

129  (
lhs
 =ğ
rhs
);

131 ià(!
	`¡rcmp
(
İr
, "!="))

132  (
lhs
 !ğ
rhs
);

134 ià(!
	`¡rcmp
(
İr
, ">"))

135  (
lhs
 > 
rhs
);

137 ià(!
	`¡rcmp
(
İr
, "<"))

138  (
lhs
 < 
rhs
);

140 ià(!
	`¡rcmp
(
İr
, "<="))

141  (
lhs
 <ğ
rhs
);

143 ià(!
	`¡rcmp
(
İr
, ">="))

144  (
lhs
 >ğ
rhs
);

146 ià(!
	`¡rcmp
(
İr
, "&"))

147  (
lhs
 & 
rhs
);

149 ià(!
	`¡rcmp
(
İr
, "|"))

150  (
lhs
 | 
rhs
);

152 
Loggšg
::
	`bug
("Improper MOBprog operator\n", 0);

154 
	}
}

166 
boŞ
 
	$m´og_do_ifchck
(cÚ¡ *
ifchck
, 
Ch¬aù”
 *
mob
, Ch¬aù” *
aùÜ
,

167 
Objeù
 *
obj
, *
vo
, 
Ch¬aù”
 *
ºdm
)

169 
buf
[ 
MAX_INPUT_LENGTH
 ];

170 
¬g
[ 
MAX_INPUT_LENGTH
 ];

171 
İr
[ 
MAX_INPUT_LENGTH
 ];

172 
v®
[ 
MAX_INPUT_LENGTH
 ];

173 
Ch¬aù”
 *
viù
 = (Ch¬aù” *è
vo
;

174 
Objeù
 *
v_obj
 = (Objeù *è
vo
;

175 *
buåt
 = 
buf
;

176 *
¬g±
 = 
¬g
;

177 *
İ½t
 = 
İr
;

178 *
v®±
 = 
v®
;

179 cÚ¡ *
pošt
 = 
ifchck
;

180 
lhsvl
;

181 
rhsvl
;

183 ià(*
pošt
 == '\0') {

184 
Loggšg
::
	`bugf
("Mob: %d‚uÎ ifchck", 
mob
->
pIndexD©a
->
vnum
);

189 *
pošt
 == ' ')

190 
pošt
++;

193 *
pošt
 != '(')

194 ià(*
pošt
 == '\0') {

195 
Loggšg
::
	`bugf
("Mob: %d ifchck syÁaxƒ¼Ü", 
mob
->
pIndexD©a
->
vnum
);

198 ià(*
pošt
 == ' ')

199 
pošt
++;

201 *
buåt
++ = *
pošt
++;

203 *
buåt
 = '\0';

204 
pošt
++;

207 *
pošt
 != ')')

208 ià(*
pošt
 == '\0') {

209 
Loggšg
::
	`bugf
("Mob: %d ifchck syÁaxƒ¼Ü", 
mob
->
pIndexD©a
->
vnum
);

212 ià(*
pošt
 == ' ')

213 
pošt
++;

215 *
¬g±
++ = *
pošt
++;

217 *
¬g±
 = '\0';

218 
pošt
++;

221 *
pošt
 == ' ')

222 
pošt
++;

224 ià(*
pošt
 == '\0') {

225 *
İr
 = '\0';

226 *
v®
 = '\0';

229 (*
pošt
 !ğ' 'è&& (!
	`i§Êum
(*point)))

230 ià(*
pošt
 == '\0') {

231 
Loggšg
::
	`bugf
("Mob: %d ifchck operator without value",

232 
mob
->
pIndexD©a
->
vnum
);

236 *
İ½t
++ = *
pošt
++;

238 *
İ½t
 = '\0';

241 *
pošt
 == ' ')

242 
pošt
++;

245 ià((*
pošt
 != ' ') && (*point == '\0'))

248 *
v®±
++ = *
pošt
++;

251 *
v®±
 = '\0';

254 
buåt
 = 
buf
;

255 
¬g±
 = 
¬g
;

256 
İ½t
 = 
İr
;

257 
v®±
 = 
v®
;

267 ià(!
	`¡rcmp
(
buf
, "rand"))

268  (
	`numb”_³rûÁ
(è<ğ
	`©oi
(
¬g
));

270 ià(!
	`¡rcmp
(
buf
, "mudtime")) {

271 
lhsvl
 = 
mob
->
š_room
->
	`¬—
().
wÜld
.
time
.
hour
;

272 
rhsvl
 = 
	`©oi
(
v®
);

273  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

276 ià(!
	`¡rcmp
(
buf
, "ispc")) {

277 
¬g
[1]) {

280 'n': ià(
aùÜ
è (!aùÜ->
	`is_Åc
());

283 't': ià(
viù
è (!viù->
	`is_Åc
());

286 'r': ià(
ºdm
è (!ºdm->
	`is_Åc
());

290 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'i¥c'", 
mob
->
pIndexD©a
->
vnum
);

295 ià(!
	`¡rcmp
(
buf
, "isnpc")) {

296 
¬g
[1]) {

299 'n': ià(
aùÜ
è (aùÜ->
	`is_Åc
());

302 't': ià(
viù
è (viù->
	`is_Åc
());

305 'r': ià(
ºdm
è (ºdm->
	`is_Åc
());

309 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'i¢pc'", 
mob
->
pIndexD©a
->
vnum
);

314 ià(!
	`¡rcmp
(
buf
, "isgood")) {

315 
¬g
[1]) {

316 'i':  
	`IS_GOOD
(
mob
);

318 'n': ià(
aùÜ
è 
	`IS_GOOD
(actor);

321 't': ià(
viù
è 
	`IS_GOOD
(vict);

324 'r': ià(
ºdm
è 
	`IS_GOOD
(rndm);

328 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'isgood'", 
mob
->
pIndexD©a
->
vnum
);

333 ià(!
	`¡rcmp
(
buf
, "isevil")) {

334 
¬g
[1]) {

335 'i':  
	`IS_EVIL
(
mob
);

337 'n': ià(
aùÜ
è 
	`IS_EVIL
(actor);

340 't': ià(
viù
è 
	`IS_EVIL
(vict);

343 'r': ià(
ºdm
è 
	`IS_EVIL
(rndm);

347 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'i£v'", 
mob
->
pIndexD©a
->
vnum
);

352 ià(!
	`¡rcmp
(
buf
, "isneutral")) {

353 
¬g
[1]) {

354 'i':  
	`IS_NEUTRAL
(
mob
);

356 'n': ià(
aùÜ
è 
	`IS_NEUTRAL
(actor);

359 't': ià(
viù
è 
	`IS_NEUTRAL
(vict);

362 'r': ià(
ºdm
è 
	`IS_NEUTRAL
(rndm);

366 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'i¢euŒ®'", 
mob
->
pIndexD©a
->
vnum
);

371 ià(!
	`¡rcmp
(
buf
, "isfight")) {

372 
¬g
[1]) {

373 'i':  (
mob
->
fightšg
) ? 1 : 0;

375 'n': ià(
aùÜ
è (aùÜ->
fightšg
) ? 1 : 0;

378 't': ià(
viù
è (viù->
fightšg
) ? 1 : 0;

381 'r': ià(
ºdm
è (ºdm->
fightšg
) ? 1 : 0;

385 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'isfight'", 
mob
->
pIndexD©a
->
vnum
);

390 ià(!
	`¡rcmp
(
buf
, "isimmort")) {

391 
¬g
[1]) {

394 'n': ià(
aùÜ
è 
	`IS_IMMORTAL
(actor);

397 't': ià(
viù
è 
	`IS_IMMORTAL
(vict);

400 'r': ià(
ºdm
è 
	`IS_IMMORTAL
(rndm);

404 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'isimmÜt'", 
mob
->
pIndexD©a
->
vnum
);

409 ià(!
	`¡rcmp
(
buf
, "iskiller")) {

410 
¬g
[1]) {

414 'n': ià(
aùÜ
)

415 ià(
	`IS_KILLER
(
aùÜ
))

423 't': ià(
viù
)

424 ià(
	`IS_KILLER
(
viù
))

432 'r': ià(
ºdm
)

433 ià(
	`IS_KILLER
(
ºdm
))

442 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'iskËr'", 
mob
->
pIndexD©a
->
vnum
);

448 ià(!
	`¡rcmp
(
buf
, "isthief")) {

449 
¬g
[1]) {

453 'n': ià(
aùÜ
)

454 ià(
	`IS_THIEF
(
aùÜ
))

462 't': ià(
viù
)

463 ià(
	`IS_THIEF
(
viù
))

471 'r': ià(
ºdm
)

472 ià(
	`IS_THIEF
(
ºdm
))

481 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'i¡h›f'", 
mob
->
pIndexD©a
->
vnum
);

487 ià(!
	`¡rcmp
(
buf
, "ischarmed")) {

488 
¬g
[1]) {

489 'i':  
afãù
::
	`exi¡s_Ú_ch¬
(
mob
,‡fãù::
ty³
::
ch¬m_³rsÚ
) ? 1 : 0;

491 'n': ià(
aùÜ
)

492  
afãù
::
	`exi¡s_Ú_ch¬
(
aùÜ
,‡fãù::
ty³
::
ch¬m_³rsÚ
) ? 1 : 0;

495 't': ià(
viù
)

496  
afãù
::
	`exi¡s_Ú_ch¬
(
viù
,‡fãù::
ty³
::
ch¬m_³rsÚ
) ? 1 : 0;

499 'r': ià(
ºdm
)

500  
afãù
::
	`exi¡s_Ú_ch¬
(
ºdm
,‡fãù::
ty³
::
ch¬m_³rsÚ
) ? 1 : 0;

504 
Loggšg
::
	`bugf
("Mob: %d bad‡rgumento 'ischarmed'",

505 
mob
->
pIndexD©a
->
vnum
);

510 ià(!
	`¡rcmp
(
buf
, "isfollow")) {

511 
¬g
[1]) {

512 'i':  (
mob
->
ma¡”
 !ğ
nuÎ±r
 && mob->ma¡”->
š_room
 == mob->in_room);

514 'n': ià(
aùÜ
)

515  (
aùÜ
->
ma¡”
 !ğ
nuÎ±r


516 && 
aùÜ
->
ma¡”
->
š_room
 ==‡ctor->in_room);

520 't': ià(
viù
)

521  (
viù
->
ma¡”
 !ğ
nuÎ±r


522 && 
viù
->
ma¡”
->
š_room
 == vict->in_room);

526 'r': ià(
ºdm
)

527  (
ºdm
->
ma¡”
 !ğ
nuÎ±r


528 && 
ºdm
->
ma¡”
->
š_room
 ==„ndm->in_room);

533 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'isfŞlow'", 
mob
->
pIndexD©a
->
vnum
);

538 ià(!
	`¡rcmp
(
buf
, "ismaster")) {

539 
¬g
[1]) {

542 'n': ià(
aùÜ
)

543  (
mob
->
ma¡”
 =ğ
aùÜ
);

547 't': ià(
viù
)

548  (
mob
->
ma¡”
 =ğ
viù
);

552 'r': ià(
ºdm
)

553  (
mob
->
ma¡”
 =ğ
ºdm
);

558 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'isma¡”'", 
mob
->
pIndexD©a
->
vnum
);

563 ià(!
	`¡rcmp
(
buf
, "isleader")) {

564 
¬g
[1]) {

567 'n': ià(
aùÜ
)

568  (
mob
->
Ëad”
 =ğ
aùÜ
);

572 't': ià(
viù
)

573  (
mob
->
Ëad”
 =ğ
viù
);

577 'r': ià(
ºdm
)

578  (
mob
->
Ëad”
 =ğ
ºdm
);

583 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'i¦—d”'", 
mob
->
pIndexD©a
->
vnum
);

588 ià(!
	`¡rcmp
(
buf
, "isaffected")) {

589 
skl
::
ty³
 
¢
 = skl::
	`lookup
(
¬g
);

591 ià(
¢
 <= 0) {

592 
Loggšg
::
	`bugf
("Mob: %d bad skÈty³ '%s'Ø'i§fãùed'", 
mob
->
pIndexD©a
->
vnum
, 
¬g
);

594 
¬g
[1]) {

595 'i':  
	`afãù_æag_Ú_ch¬
(
mob
, 
	`©oi
(
¬g
));

597 'n': ià(
aùÜ
)

598  
	`afãù_æag_Ú_ch¬
(
aùÜ
, 
	`©oi
(
¬g
));

601 't': ià(
viù
)

602  
	`afãù_æag_Ú_ch¬
(
viù
, 
	`©oi
(
¬g
));

605 'r': ià(
ºdm
)

606  
	`afãù_æag_Ú_ch¬
(
ºdm
, 
	`©oi
(
¬g
));

610 
Loggšg
::
	`bug
("Mob: %d bad‡rgument '%s'o 'isaffected'",

611 
mob
->
pIndexD©a
->
vnum
, );

616 ià(!
	`¡rcmp
(
buf
, "hitprcnt")) {

617 
¬g
[1]) {

618 'i': 
lhsvl
 = 
mob
->
h™
 / 
	`GET_MAX_HIT
(mob);

619 
rhsvl
 = 
	`©oi
(
v®
);

620  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

622 'n': ià(
aùÜ
) {

623 
lhsvl
 = 
aùÜ
->
h™
 / 
	`GET_MAX_HIT
(actor);

624 
rhsvl
 = 
	`©oi
(
v®
);

625  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

630 't': ià(
viù
) {

631 
lhsvl
 = 
viù
->
h™
 / 
	`GET_MAX_HIT
(vict);

632 
rhsvl
 = 
	`©oi
(
v®
);

633  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

638 'r': ià(
ºdm
) {

639 
lhsvl
 = 
ºdm
->
h™
 / 
	`GET_MAX_HIT
(rndm);

640 
rhsvl
 = 
	`©oi
(
v®
);

641  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

647 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'h™´út'", 
mob
->
pIndexD©a
->
vnum
);

652 ià(!
	`¡rcmp
(
buf
, "inroom")) {

653 
¬g
[1]) {

654 'i': 
lhsvl
 = 
mob
->
š_room
->
loÿtiÚ
.
	`to_št
();

655 
rhsvl
 = 
	`LoÿtiÚ
(
v®
).
	`to_št
();

656  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

658 'n': ià(
aùÜ
) {

659 
lhsvl
 = 
aùÜ
->
š_room
->
loÿtiÚ
.
	`to_št
();

660 
rhsvl
 = 
	`LoÿtiÚ
(
v®
).
	`to_št
();

661  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

666 't': ià(
viù
) {

667 
lhsvl
 = 
viù
->
š_room
->
loÿtiÚ
.
	`to_št
();

668 
rhsvl
 = 
	`LoÿtiÚ
(
v®
).
	`to_št
();

669  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

674 'r': ià(
ºdm
) {

675 
lhsvl
 = 
ºdm
->
š_room
->
loÿtiÚ
.
	`to_št
();

676 
rhsvl
 = 
	`LoÿtiÚ
(
v®
).
	`to_št
();

677  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

683 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'šroom'", 
mob
->
pIndexD©a
->
vnum
);

688 ià(!
	`¡rcmp
(
buf
, "sex")) {

689 
¬g
[1]) {

690 'i': 
lhsvl
 = 
	`GET_ATTR_SEX
(
mob
);

691 
rhsvl
 = 
	`©oi
(
v®
);

692  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

694 'n': ià(
aùÜ
) {

695 
lhsvl
 = 
	`GET_ATTR_SEX
(
aùÜ
);

696 
rhsvl
 = 
	`©oi
(
v®
);

697  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

702 't': ià(
viù
) {

703 
lhsvl
 = 
	`GET_ATTR_SEX
(
viù
);

704 
rhsvl
 = 
	`©oi
(
v®
);

705  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

710 'r': ià(
ºdm
) {

711 
lhsvl
 = 
	`GET_ATTR_SEX
(
ºdm
);

712 
rhsvl
 = 
	`©oi
(
v®
);

713  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

719 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'£x'", 
mob
->
pIndexD©a
->
vnum
);

724 ià(!
	`¡rcmp
(
buf
, "position")) {

725 
¬g
[1]) {

726 'i': 
lhsvl
 = 
mob
->
pos™iÚ
;

727 
rhsvl
 = 
	`©oi
(
v®
);

728  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

730 'n': ià(
aùÜ
) {

731 
lhsvl
 = 
aùÜ
->
pos™iÚ
;

732 
rhsvl
 = 
	`©oi
(
v®
);

733  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

738 't': ià(
viù
) {

739 
lhsvl
 = 
viù
->
pos™iÚ
;

740 
rhsvl
 = 
	`©oi
(
v®
);

741  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

746 'r': ià(
ºdm
) {

747 
lhsvl
 = 
ºdm
->
pos™iÚ
;

748 
rhsvl
 = 
	`©oi
(
v®
);

749  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

755 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'pos™iÚ'", 
mob
->
pIndexD©a
->
vnum
);

760 ià(!
	`¡rcmp
(
buf
, "level")) {

761 
¬g
[1]) {

762 'i': 
lhsvl
 = 
mob
->
Ëv–
;

763 
rhsvl
 = 
	`©oi
(
v®
);

764  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

766 'n': ià(
aùÜ
) {

767 
lhsvl
 = 
aùÜ
->
Ëv–
;

768 
rhsvl
 = 
	`©oi
(
v®
);

769  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

774 't': ià(
viù
) {

775 
lhsvl
 = 
viù
->
Ëv–
;

776 
rhsvl
 = 
	`©oi
(
v®
);

777  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

782 'r': ià(
ºdm
) {

783 
lhsvl
 = 
ºdm
->
Ëv–
;

784 
rhsvl
 = 
	`©oi
(
v®
);

785  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

791 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'Ëv–'", 
mob
->
pIndexD©a
->
vnum
);

796 ià(!
	`¡rcmp
(
buf
, "class")) {

797 
¬g
[1]) {

798 'i': 
lhsvl
 = 
mob
->
gud
;

799 
rhsvl
 = 
	`©oi
(
v®
);

800  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

802 'n': ià(
aùÜ
) {

803 
lhsvl
 = 
aùÜ
->
gud
;

804 
rhsvl
 = 
	`©oi
(
v®
);

805  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

810 't': ià(
viù
) {

811 
lhsvl
 = 
viù
->
gud
;

812 
rhsvl
 = 
	`©oi
(
v®
);

813  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

818 'r': ià(
ºdm
) {

819 
lhsvl
 = 
ºdm
->
gud
;

820 
rhsvl
 = 
	`©oi
(
v®
);

821  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

827 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'şass'", 
mob
->
pIndexD©a
->
vnum
);

832 ià(!
	`¡rcmp
(
buf
, "goldamt")) {

833 
¬g
[1]) {

834 'i': 
lhsvl
 = 
mob
->
gŞd
;

835 
rhsvl
 = 
	`©oi
(
v®
);

836  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

838 'n': ià(
aùÜ
) {

839 
lhsvl
 = 
aùÜ
->
gŞd
;

840 
rhsvl
 = 
	`©oi
(
v®
);

841  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

846 't': ià(
viù
) {

847 
lhsvl
 = 
viù
->
gŞd
;

848 
rhsvl
 = 
	`©oi
(
v®
);

849  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

854 'r': ià(
ºdm
) {

855 
lhsvl
 = 
ºdm
->
gŞd
;

856 
rhsvl
 = 
	`©oi
(
v®
);

857  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

863 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'gŞdamt'", 
mob
->
pIndexD©a
->
vnum
);

868 ià(!
	`¡rcmp
(
buf
, "objtype")) {

869 
¬g
[1]) {

870 'o': ià(
obj
) {

871 
lhsvl
 = 
obj
->
™em_ty³
;

872 
rhsvl
 = 
	`©oi
(
v®
);

873  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

878 'p': ià(
v_obj
) {

879 
lhsvl
 = 
v_obj
->
™em_ty³
;

880 
rhsvl
 = 
	`©oi
(
v®
);

881  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

887 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'objty³'", 
mob
->
pIndexD©a
->
vnum
);

892 ià(!
	`¡rcmp
(
buf
, "objval0")) {

893 
¬g
[1]) {

894 'o': ià(
obj
) {

895 
lhsvl
 = 
obj
->
v®ue
[0];

896 
rhsvl
 = 
	`©oi
(
v®
);

897  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

902 'p': ià(
v_obj
) {

903 
lhsvl
 = 
v_obj
->
v®ue
[0];

904 
rhsvl
 = 
	`©oi
(
v®
);

905  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

911 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'objv®0'", 
mob
->
pIndexD©a
->
vnum
);

916 ià(!
	`¡rcmp
(
buf
, "objval1")) {

917 
¬g
[1]) {

918 'o': ià(
obj
) {

919 
lhsvl
 = 
obj
->
v®ue
[1];

920 
rhsvl
 = 
	`©oi
(
v®
);

921  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

926 'p': ià(
v_obj
) {

927 
lhsvl
 = 
v_obj
->
v®ue
[1];

928 
rhsvl
 = 
	`©oi
(
v®
);

929  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

935 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'objv®1'", 
mob
->
pIndexD©a
->
vnum
);

940 ià(!
	`¡rcmp
(
buf
, "objval2")) {

941 
¬g
[1]) {

942 'o': ià(
obj
) {

943 
lhsvl
 = 
obj
->
v®ue
[2];

944 
rhsvl
 = 
	`©oi
(
v®
);

945  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

950 'p': ià(
v_obj
) {

951 
lhsvl
 = 
v_obj
->
v®ue
[2];

952 
rhsvl
 = 
	`©oi
(
v®
);

953  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

959 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'objv®2'", 
mob
->
pIndexD©a
->
vnum
);

964 ià(!
	`¡rcmp
(
buf
, "objval3")) {

965 
¬g
[1]) {

966 'o': ià(
obj
) {

967 
lhsvl
 = 
obj
->
v®ue
[3];

968 
rhsvl
 = 
	`©oi
(
v®
);

969  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

974 'p': ià(
v_obj
) {

975 
lhsvl
 = 
v_obj
->
v®ue
[3];

976 
rhsvl
 = 
	`©oi
(
v®
);

977  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

983 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'objv®3'", 
mob
->
pIndexD©a
->
vnum
);

988 ià(!
	`¡rcmp
(
buf
, "number")) {

989 
¬g
[1]) {

990 'i': 
lhsvl
 = 
mob
->
gŞd
;

991 
rhsvl
 = 
	`©oi
(
v®
);

992  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

994 'n': ià(
aùÜ
) {

995 ià(
aùÜ
->
	`is_Åc
()) {

996 
lhsvl
 = 
aùÜ
->
pIndexD©a
->
vnum
.
	`v®ue
();

997 
rhsvl
 = 
	`©oi
(
v®
);

998  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

1004 't': ià(
viù
) {

1005 ià(
aùÜ
->
	`is_Åc
()) {

1006 
lhsvl
 = 
viù
->
pIndexD©a
->
vnum
.
	`v®ue
();

1007 
rhsvl
 = 
	`©oi
(
v®
);

1008  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

1014 'r': ià(
ºdm
) {

1015 ià(
aùÜ
->
	`is_Åc
()) {

1016 
lhsvl
 = 
ºdm
->
pIndexD©a
->
vnum
.
	`v®ue
();

1017 
rhsvl
 = 
	`©oi
(
v®
);

1018  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

1023 'o': ià(
obj
) {

1024 
lhsvl
 = 
obj
->
pIndexD©a
->
vnum
.
	`v®ue
();

1025 
rhsvl
 = 
	`©oi
(
v®
);

1026  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

1031 'p': ià(
v_obj
) {

1032 
lhsvl
 = 
v_obj
->
pIndexD©a
->
vnum
.
	`v®ue
();

1033 
rhsvl
 = 
	`©oi
(
v®
);

1034  
	`m´og_vev®
(
lhsvl
, 
İr
, 
rhsvl
);

1040 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'numb”'", 
mob
->
pIndexD©a
->
vnum
);

1045 ià(!
	`¡rcmp
(
buf
, "name")) {

1046 
¬g
[1]) {

1047 'i':  
	`m´og_£v®
(
mob
->
Çme
, 
İr
, 
v®
);

1049 'n': ià(
aùÜ
)

1050  
	`m´og_£v®
(
aùÜ
->
Çme
, 
İr
, 
v®
);

1054 't': ià(
viù
)

1055  
	`m´og_£v®
(
viù
->
Çme
, 
İr
, 
v®
);

1059 'r': ià(
ºdm
)

1060  
	`m´og_£v®
(
ºdm
->
Çme
, 
İr
, 
v®
);

1064 'o': ià(
obj
)

1065  
	`m´og_£v®
(
obj
->
Çme
, 
İr
, 
v®
);

1069 'p': ià(
v_obj
)

1070  
	`m´og_£v®
(
v_obj
->
Çme
, 
İr
, 
v®
);

1075 
Loggšg
::
	`bugf
("Mob: %d bad‡rgum’ˆtØ'Çme'", 
mob
->
pIndexD©a
->
vnum
);

1083 
Loggšg
::
	`bugf
("Mob: %d unknowÀifchck", 
mob
->
pIndexD©a
->
vnum
);

1085 
	}
}

1105 *
	$m´og_´oûss_if
(cÚ¡ *
ifchck
, *
com_li¡
, 
Ch¬aù”
 *
mob
,

1106 
Ch¬aù”
 *
aùÜ
, 
Objeù
 *
obj
, *
vo
,

1107 
Ch¬aù”
 *
ºdm
)

1109 cÚ¡ *
mÜebuf
 = 
nuÎ±r
;

1110 *
cmnd
 = 
nuÎ±r
;

1111 
boŞ
 
loİdÚe
 = 
çl£
;

1112 
boŞ
 
æag
 = 
çl£
;

1113 
Ëg®
;

1116 ià((
Ëg®
 = 
	`m´og_do_ifchck
(
ifchck
, 
mob
, 
aùÜ
, 
obj
, 
vo
, 
ºdm
))) {

1117 ià(
Ëg®
 == 1)

1118 
æag
 = 
Œue
;

1120  
nuÎ±r
;

1123 
SŒšg
 
buf
;

1125 
loİdÚe
 =ğ
çl£
) {

1126 
cmnd
 = 
com_li¡
;

1127 
com_li¡
 = 
	`m´og_Ãxt_commªd
(com_list);

1129 *
cmnd
 == ' ')

1130 
cmnd
++;

1132 ià(*
cmnd
 == '\0') {

1133 
Loggšg
::
	`bugf
("Mob: %d‚Øcommªd aá” IF/OR", 
mob
->
pIndexD©a
->
vnum
);

1134  
nuÎ±r
;

1137 
mÜebuf
 = 
	`Úe_¬gum’t
(
cmnd
, 
buf
);

1139 ià(!
	`¡rcmp
(
buf
, "or")) {

1140 ià((
Ëg®
 = 
	`m´og_do_ifchck
(
mÜebuf
, 
mob
, 
aùÜ
, 
obj
, 
vo
, 
ºdm
))) {

1141 ià(
Ëg®
 == 1)

1142 
æag
 = 
Œue
;

1144  
nuÎ±r
;

1148 
loİdÚe
 = 
Œue
;

1151 ià(
æag
)

1153 ià(!
	`¡rcmp
(
buf
, "if")) {

1154 
com_li¡
 = 
	`m´og_´oûss_if
(
mÜebuf
, com_li¡, 
mob
, 
aùÜ
, 
obj
, 
vo
, 
ºdm
);

1156 *
cmnd
 == ' ')

1157 
cmnd
++;

1159 ià(
com_li¡
 =ğ
nuÎ±r
 || *com_list == '\0')

1160  
nuÎ±r
;

1162 
cmnd
 = 
com_li¡
;

1163 
com_li¡
 = 
	`m´og_Ãxt_commªd
(com_list);

1164 
mÜebuf
 = 
	`Úe_¬gum’t
(
cmnd
, 
buf
);

1168 ià(!
	`¡rcmp
(
buf
, "break"))

1169  
nuÎ±r
;

1171 ià(!
	`¡rcmp
(
buf
, "endif"))

1172  
com_li¡
;

1174 ià(!
	`¡rcmp
(
buf
, "else")) {

1175 
	`¡rcmp
(
buf
, "endif")) {

1176 
cmnd
 = 
com_li¡
;

1177 
com_li¡
 = 
	`m´og_Ãxt_commªd
(com_list);

1179 *
cmnd
 == ' ')

1180 
cmnd
++;

1182 ià(*
cmnd
 == '\0') {

1183 
Loggšg
::
	`bugf
("Mob: %d missingƒndif‡fterƒlse",

1184 
mob
->
pIndexD©a
->
vnum
);

1185  
nuÎ±r
;

1188 
mÜebuf
 = 
	`Úe_¬gum’t
(
cmnd
, 
buf
);

1191  
com_li¡
;

1194 
	`m´og_´oûss_cmnd
(
cmnd
, 
mob
, 
aùÜ
, 
obj
, 
vo
, 
ºdm
);

1196 ià(
mob
->
	`is_g¬bage
())

1197  
nuÎ±r
;

1199 
cmnd
 = 
com_li¡
;

1200 
com_li¡
 = 
	`m´og_Ãxt_commªd
(com_list);

1202 *
cmnd
 == ' ')

1203 
cmnd
++;

1205 ià(*
cmnd
 == '\0') {

1206 
Loggšg
::
	`bugf
("Mob: %d missšgƒl£ o¸’dif", 
mob
->
pIndexD©a
->
vnum
);

1207  
nuÎ±r
;

1210 
mÜebuf
 = 
	`Úe_¬gum’t
(
cmnd
, 
buf
);

1213 (
	`¡rcmp
(
buf
, "else")) && (strcmp(buf, "endif"))) {

1214 
cmnd
 = 
com_li¡
;

1215 
com_li¡
 = 
	`m´og_Ãxt_commªd
(com_list);

1217 *
cmnd
 == ' ')

1218 
cmnd
++;

1220 ià(*
cmnd
 == '\0') {

1221 
Loggšg
::
	`bugf
("Mob: %d missing‡nƒlse orƒndif",

1222 
mob
->
pIndexD©a
->
vnum
);

1223  
nuÎ±r
;

1226 
mÜebuf
 = 
	`Úe_¬gum’t
(
cmnd
, 
buf
);

1230 ià(!
	`¡rcmp
(
buf
, "endif"))

1231  
com_li¡
;

1233 
cmnd
 = 
com_li¡
;

1234 
com_li¡
 = 
	`m´og_Ãxt_commªd
(com_list);

1236 *
cmnd
 == ' ')

1237 
cmnd
++;

1239 ià(*
cmnd
 == '\0') {

1240 
Loggšg
::
	`bugf
("Mob: %d missšgƒndif", 
mob
->
pIndexD©a
->
vnum
);

1241  
nuÎ±r
;

1244 
mÜebuf
 = 
	`Úe_¬gum’t
(
cmnd
, 
buf
);

1247 ià(!
	`¡rcmp
(
buf
, "if")) {

1248 
com_li¡
 = 
	`m´og_´oûss_if
(
mÜebuf
, com_li¡, 
mob
, 
aùÜ
,

1249 
obj
, 
vo
, 
ºdm
);

1251 *
cmnd
 == ' ')

1252 
cmnd
++;

1254 ià(
com_li¡
 =ğ
nuÎ±r
 || *com_list == '\0')

1255  
nuÎ±r
;

1257 
cmnd
 = 
com_li¡
;

1258 
com_li¡
 = 
	`m´og_Ãxt_commªd
(com_list);

1259 
mÜebuf
 = 
	`Úe_¬gum’t
(
cmnd
, 
buf
);

1263 ià(!
	`¡rcmp
(
buf
, "else")) {

1264 
Loggšg
::
	`bugf
("Mob: %d foundƒlse in‡nƒlse section",

1265 
mob
->
pIndexD©a
->
vnum
);

1266  
nuÎ±r
;

1269 ià(!
	`¡rcmp
(
buf
, "break"))

1270  
nuÎ±r
;

1272 ià(!
	`¡rcmp
(
buf
, "endif"))

1273  
com_li¡
;

1275 
	`m´og_´oûss_cmnd
(
cmnd
, 
mob
, 
aùÜ
, 
obj
, 
vo
, 
ºdm
);

1277 ià(
mob
->
	`is_g¬bage
())

1278  
nuÎ±r
;

1280 
cmnd
 = 
com_li¡
;

1281 
com_li¡
 = 
	`m´og_Ãxt_commªd
(com_list);

1283 *
cmnd
 == ' ')

1284 
cmnd
++;

1286 ià(*
cmnd
 == '\0') {

1287 
Loggšg
::
	`bugf
("Mob:%d missingƒndif inƒlse section",

1288 
mob
->
pIndexD©a
->
vnum
);

1289  
nuÎ±r
;

1292 
mÜebuf
 = 
	`Úe_¬gum’t
(
cmnd
, 
buf
);

1295 
	}
}

1308 
SŒšg
 
	$m´og_Œª¦©e
(
ch
, 
Ch¬aù”
 *
mob
, Ch¬aù” *
aùÜ
,

1309 
Objeù
 *
obj
, *
vo
, 
Ch¬aù”
 *
ºdm
)

1311 *
he_she
 [] = { "it", "he", "she" };

1312 *
him_h”
 [] = { "it", "him", "her" };

1313 *
his_h”
 [] = { "its", "his", "her" };

1314 
Ch¬aù”
 *
viù
 = (Ch¬aù” *è
vo
;

1315 
Objeù
 *
v_obj
 = (Objeù *è
vo
;

1316 
SŒšg
 
t
;

1318 
ch
) {

1320 
t
 = 
mob
->
Çme
.
	`l¥l™
();

1324 
t
 = 
mob
->
shÜt_desü
;

1328 ià(
aùÜ
) {

1329 ià(
	`ÿn_£e_ch¬
(
mob
, 
aùÜ
))

1330 
t
 = 
aùÜ
->
Çme
;

1332 ià(!
aùÜ
->
	`is_Åc
())

1333 
t
[0] = 
	`touµ”
(t[0]);

1339 ià(
aùÜ
) {

1340 ià(
	`ÿn_£e_ch¬
(
mob
, 
aùÜ
)) {

1341 ià(
aùÜ
->
	`is_Åc
())

1342 
t
 = 
aùÜ
->
shÜt_desü
;

1344 
t
 = 
aùÜ
->
Çme
;

1345 
t
 += " ";

1346 
t
 +ğ
aùÜ
->
pcd©a
->
t™Ë
;

1350 
t
 = "someone";

1356 ià(
viù
) {

1357 ià(
	`ÿn_£e_ch¬
(
mob
, 
viù
))

1358 
t
 = 
viù
->
Çme
;

1360 ià(!
viù
->
	`is_Åc
())

1361 
t
[0] = 
	`touµ”
(t[0]);

1367 ià(
viù
) {

1368 ià(
	`ÿn_£e_ch¬
(
mob
, 
viù
)) {

1369 ià(
viù
->
	`is_Åc
())

1370 
t
 = 
viù
->
shÜt_desü
;

1372 
t
 = 
viù
->
Çme
;

1373 
t
 += " ";

1374 
t
 +ğ
viù
->
pcd©a
->
t™Ë
;

1378 
t
 = "someone";

1384 ià(
ºdm
) {

1385 ià(
	`ÿn_£e_ch¬
(
mob
, 
ºdm
))

1386 
t
 = 
ºdm
->
Çme
.
	`l¥l™
();

1388 
t
 = "someone";

1390 ià(!
ºdm
->
	`is_Åc
())

1391 
t
[0] = 
	`touµ”
(t[0]);

1397 ià(
ºdm
) {

1398 ià(
	`ÿn_£e_ch¬
(
mob
, 
ºdm
)) {

1399 ià(
ºdm
->
	`is_Åc
())

1400 
t
 = 
ºdm
->
shÜt_desü
;

1402 
t
 = 
ºdm
->
Çme
;

1403 
t
 += " ";

1404 
t
 +ğ
ºdm
->
pcd©a
->
t™Ë
;

1408 
t
 = "someone";

1414 ià(
aùÜ
)

1415 
t
 = 
	`ÿn_£e_ch¬
(
mob
, 
aùÜ
è? 
he_she
[
	`GET_ATTR_SEX
(actor)] : "someone";

1420 ià(
aùÜ
)

1421 
t
 = 
	`ÿn_£e_ch¬
(
mob
, 
aùÜ
è? 
him_h”
[
	`GET_ATTR_SEX
(actor)] : "someone";

1426 ià(
aùÜ
)

1427 
t
 = 
	`ÿn_£e_ch¬
(
mob
, 
aùÜ
è? 
his_h”
[
	`GET_ATTR_SEX
(actor)] : "someone's";

1432 ià(
viù
)

1433 
t
 = 
	`ÿn_£e_ch¬
(
mob
, 
viù
è? 
he_she
[
	`GET_ATTR_SEX
(vict)] : "someone";

1438 ià(
viù
)

1439 
t
 = 
	`ÿn_£e_ch¬
(
mob
, 
viù
è? 
him_h”
[
	`GET_ATTR_SEX
(vict)] : "someone";

1444 ià(
viù
)

1445 
t
 = 
	`ÿn_£e_ch¬
(
mob
, 
viù
è? 
his_h”
[
	`GET_ATTR_SEX
(vict)] : "someone's";

1450 
t
 = 
he_she
[
	`GET_ATTR_SEX
(
mob
)];

1454 
t
 = 
him_h”
[
	`GET_ATTR_SEX
(
mob
)];

1458 
t
 = 
his_h”
[
	`GET_ATTR_SEX
(
mob
)];

1462 ià(
ºdm
)

1463 
t
 = 
	`ÿn_£e_ch¬
(
mob
, 
ºdm
è? 
he_she
[
	`GET_ATTR_SEX
(rndm)] : "someone";

1468 ià(
ºdm
)

1469 
t
 = 
	`ÿn_£e_ch¬
(
mob
, 
ºdm
è? 
him_h”
[
	`GET_ATTR_SEX
(rndm)] : "someone";

1474 ià(
ºdm
)

1475 
t
 = 
	`ÿn_£e_ch¬
(
mob
, 
ºdm
è? 
his_h”
[
	`GET_ATTR_SEX
(rndm)] : "someone's";

1480 ià(
obj
)

1481 
t
 = 
	`ÿn_£e_obj
(
mob
, 
obj
è? 
	`SŒšg
(obj->
Çme
).
	`l¥l™
() : "something";

1486 ià(
obj
)

1487 
t
 = 
	`ÿn_£e_obj
(
mob
, 
obj
è? obj->
shÜt_desü
 : "something";

1492 ià(
v_obj
)

1493 
t
 = 
	`ÿn_£e_obj
(
mob
, 
v_obj
è? 
	`SŒšg
(v_obj->
Çme
).
	`l¥l™
() : "something";

1498 ià(
v_obj
)

1499 
t
 = 
	`ÿn_£e_obj
(
mob
, 
v_obj
è? v_obj->
shÜt_desü
 : "something";

1504 ià(
obj
)

1505 
	`tŞow”
(
obj
->
Çme
[0])) {

1507 'o': 'u': 
t
 = "an";

1510 : 
t
 = "a";

1516 ià(
v_obj
)

1517 
	`tŞow”
(
v_obj
->
Çme
[0])) {

1519 'o': 'u': 
t
 = "an";

1522 : 
t
 = "a";

1528 
t
 = "$";

1532 
Loggšg
::
	`bugf
("Mob: %d bad $v¬", 
mob
->
pIndexD©a
->
vnum
);

1536  
t
;

1537 
	}
}

1543 
	$m´og_´oûss_cmnd
(cÚ¡ 
SŒšg
& 
cmnd
, 
Ch¬aù”
 *
mob
, Ch¬aù” *
aùÜ
,

1544 
Objeù
 *
obj
, *
vo
, 
Ch¬aù”
 *
ºdm
)

1546 
SŒšg
 
buf
;

1547 cÚ¡ *
¡r
 = 
cmnd
.
	`c_¡r
();

1549 *
¡r
 != '\0') {

1550 ià(*
¡r
 != '$') {

1551 
buf
 +ğ*
¡r
++;

1555 
¡r
++;

1556 
buf
 +ğ
	`m´og_Œª¦©e
(*
¡r
, 
mob
, 
aùÜ
, 
obj
, 
vo
, 
ºdm
);

1557 
¡r
++;

1560 
	`š‹½»t
(
mob
, 
buf
);

1562 
	}
}

1569 
	$m´og_driv”
(cÚ¡ 
SŒšg
& 
com_li¡
, 
Ch¬aù”
 *
mob
, Ch¬aù” *
aùÜ
,

1570 
Objeù
 *
obj
, *
vo
)

1572 
tmpcmndl¡
[ 
MAX_STRING_LENGTH
 ];

1573 cÚ¡ *
mÜebuf
;

1574 *
commªd_li¡
;

1575 *
cmnd
;

1576 
Ch¬aù”
 *
ºdm
 = 
nuÎ±r
;

1577 
Ch¬aù”
 *
vch
 = 
nuÎ±r
;

1578 
couÁ
 = 0;

1584 
vch
 = 
mob
->
š_room
->
³İË
; vch; vch = vch->
Ãxt_š_room
) {

1585 ià(!
vch
->
	`is_Åc
()

1586 && !
	`IS_IMMORTAL
(
vch
)

1587 && 
	`ÿn_£e_ch¬
(
mob
, 
vch
)) {

1588 ià(
	`numb”_¿nge
(0, 
couÁ
) == 0)

1589 
ºdm
 = 
vch
;

1591 
couÁ
++;

1595 
	`¡rıy
(
tmpcmndl¡
, 
com_li¡
);

1596 
commªd_li¡
 = 
tmpcmndl¡
;

1597 
cmnd
 = 
commªd_li¡
;

1598 
commªd_li¡
 = 
	`m´og_Ãxt_commªd
(command_list);

1600 
buf
[
MSL
];

1602 *
cmnd
 != '\0') {

1603 
mÜebuf
 = 
	`Úe_¬gum’t
(
cmnd
, 
buf
);

1605 ià(!
	`¡rcmp
(
buf
, "if")) {

1606 
commªd_li¡
 = 
	`m´og_´oûss_if
(
mÜebuf
, commªd_li¡, 
mob
,

1607 
aùÜ
, 
obj
, 
vo
, 
ºdm
);

1609 ià(
commªd_li¡
 =ğ
nuÎ±r
)

1613 
	`m´og_´oûss_cmnd
(
cmnd
, 
mob
, 
aùÜ
, 
obj
, 
vo
, 
ºdm
);

1615 ià(
mob
->
	`is_g¬bage
())

1619 
cmnd
 = 
commªd_li¡
;

1620 
commªd_li¡
 = 
	`m´og_Ãxt_commªd
(command_list);

1622 
	}
}

1632 
	$m´og_wÜdli¡_check
(cÚ¡ 
SŒšg
& 
¬g
, 
Ch¬aù”
 *
mob
, Ch¬aù” *
aùÜ
,

1633 
Objeù
 *
obj
, *
vo
, 
FÏgs
::
B™
 
ty³
)

1635 
‹mp1
[ 
MAX_STRING_LENGTH
 ];

1636 
‹mp2
[ 
MAX_INPUT_LENGTH
 ];

1637 cÚ¡ *
li¡
;

1638 *
¡¬t
;

1639 *
du¶
;

1640 *
’d
;

1642 
SŒšg
 
wÜd
;

1644 cÚ¡‡utØ
m´g
 : 
mob
->
pIndexD©a
->
mob´ogs
) {

1645 ià(
mob
->
	`is_g¬bage
())

1648 ià(
m´g
->
ty³
 ==ype) {

1649 
	`¡rıy
(
‹mp1
, 
m´g
->
¬gli¡
);

1651 
i
 = 0; i < 
	`¡¾’
(
‹mp1
); i++)

1652 
‹mp1
[
i
] = 
	`tŞow”
(temp1[i]);

1654 
li¡
 = 
‹mp1
;

1655 
	`¡rıy
(
‹mp2
, 
¬g
);

1656 
du¶
 = 
‹mp2
;

1658 
i
 = 0; i < 
	`¡¾’
(
du¶
); i++)

1659 
du¶
[
i
] = 
	`tŞow”
(dupl[i]);

1661 ià((
li¡
[0] == 'p') && (list[1] == ' ')) {

1662 
li¡
 += 2;

1664 (
¡¬t
 = 
¡d
::
	`¡r¡r
(
du¶
, 
li¡
)))

1665 ià((
¡¬t
 =ğ
du¶
 || *(start - 1) == ' ')

1666 && (*(
’d
 = 
¡¬t
 + 
	`¡¾’
(
li¡
)) == ' '

1667 || *
’d
 == '\n'

1668 || *
’d
 == '\r'

1669 || *
’d
 == '\0')) {

1670 
	`m´og_driv”
(
m´g
->
comli¡
, 
mob
, 
aùÜ
, 
obj
, 
vo
);

1674 
du¶
 = 
¡¬t
 + 1;

1677 
li¡
 = 
	`Úe_¬gum’t
Öi¡, 
wÜd
);

1679 ; !
wÜd
.
	`em±y
(); 
li¡
 = 
	`Úe_¬gum’t
(list, word))

1680 (
¡¬t
 = 
	`¡r¡r
(
du¶
, 
wÜd
)))

1681 ià((
¡¬t
 =ğ
du¶
 || *(start - 1) == ' ')

1682 && (*(
’d
 = 
¡¬t
 + 
	`¡¾’
(
wÜd
)) == ' '

1683 || *
’d
 == '\n'

1684 || *
’d
 == '\r'

1685 || *
’d
 == '\0')) {

1686 
	`m´og_driv”
(
m´g
->
comli¡
, 
mob
, 
aùÜ
, 
obj
, 
vo
);

1690 
du¶
 = 
¡¬t
 + 1;

1696 
	}
}

1698 
	$m´og_³rûÁ_check
(
Ch¬aù”
 *
mob
, Ch¬aù” *
aùÜ
, 
Objeù
 *
obj
,

1699 *
vo
, 
FÏgs
::
B™
 
ty³
)

1701 cÚ¡‡utØ
m´g
 : 
mob
->
pIndexD©a
->
mob´ogs
) {

1702 ià(
mob
->
	`is_g¬bage
())

1705 ià((
m´g
->
ty³
 ==ype)

1706 && (
	`numb”_³rûÁ
(è< 
	`©oi
(
m´g
->
¬gli¡
))) {

1707 
	`m´og_driv”
(
m´g
->
comli¡
, 
mob
, 
aùÜ
, 
obj
, 
vo
);

1709 ià(
ty³
 !ğ
GREET_PROG
 &&y³ !ğ
ALL_GREET_PROG
)

1715 
	}
}

1725 
	$m´og_aù_Œigg”
(cÚ¡ *
buf
, 
Ch¬aù”
 *
mob
, Ch¬aù” *
ch
,

1726 
Objeù
 *
obj
, *
vo
)

1728 ià(
mob
->
	`is_Åc
()

1729 && (
mob
->
pIndexD©a
->
´ogty³_æags
.
	`has
(
ACT_PROG
))) {

1730 
MobProgAùLi¡
 *
tmp_aù
 = 
Ãw
 MobProgActList;

1732 
tmp_aù
->
Ãxt
 = 
mob
->
m·ù
;

1733 
mob
->
m·ù
 = 
tmp_aù
;

1734 
mob
->
m·ù
->
buf
 = buf;

1735 
mob
->
m·ù
->
ch
 = ch;

1736 
mob
->
m·ù
->
obj
 = obj;

1737 
mob
->
m·ù
->
vo
 = vo;

1741 
	}
}

1743 
	$m´og_bribe_Œigg”
(
Ch¬aù”
 *
mob
, Ch¬aù” *
ch
, 
amouÁ
)

1745 
Objeù
 *
obj
;

1747 ià(!
mob
->
	`is_Åc
())

1750 cÚ¡‡utØ
m´g
 : 
mob
->
pIndexD©a
->
mob´ogs
)

1751 ià(
m´g
->
ty³
 =ğ
BRIBE_PROG
) {

1752 ià((
obj
 = 
	`ü—‹_mÚey
(0, 
amouÁ
)è=ğ
nuÎ±r
)

1755 
	`deduù_co¡
(
mob
, 
amouÁ
);

1757 ià(
amouÁ
 >ğ
	`©oi
(
m´g
->
¬gli¡
))

1758 
	`m´og_driv”
(
m´g
->
comli¡
, 
mob
, 
ch
, 
obj
, 
nuÎ±r
);

1762 
	}
}

1764 
	$m´og_d—th_Œigg”
(
Ch¬aù”
 *
mob
)

1766 ià(
mob
->
	`is_Åc
()

1767 && (
mob
->
pIndexD©a
->
´ogty³_æags
.
	`has
(
DEATH_PROG
)))

1768 
	`m´og_³rûÁ_check
(
mob
, 
nuÎ±r
,‚uÎ±r,‚uÎ±r, 
DEATH_PROG
);

1770 
	`d—th_üy
(
mob
);

1772 
	}
}

1774 
	$m´og_’Œy_Œigg”
(
Ch¬aù”
 *
mob
)

1776 ià(
mob
->
	`is_Åc
()

1777 && (
mob
->
pIndexD©a
->
´ogty³_æags
.
	`has
(
ENTRY_PROG
)))

1778 
	`m´og_³rûÁ_check
(
mob
, 
nuÎ±r
,‚uÎ±r,‚uÎ±r, 
ENTRY_PROG
);

1781 
	}
}

1783 
	$m´og_fight_Œigg”
(
Ch¬aù”
 *
mob
, Ch¬aù” *
ch
)

1785 ià(
mob
->
	`is_Åc
()

1786 && (
mob
->
pIndexD©a
->
´ogty³_æags
.
	`has
(
FIGHT_PROG
)))

1787 
	`m´og_³rûÁ_check
(
mob
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
FIGHT_PROG
);

1790 
	}
}

1792 
	$m´og_buy_Œigg”
(
Ch¬aù”
 *
mob
, Ch¬aù” *
ch
)

1794 ià(
mob
->
	`is_Åc
()

1795 && (
mob
->
pIndexD©a
->
´ogty³_æags
.
	`has
(
BUY_PROG
)))

1796 
	`m´og_³rûÁ_check
(
mob
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
BUY_PROG
);

1799 
	}
}

1801 
	$m´og_give_Œigg”
(
Ch¬aù”
 *
mob
, Ch¬aù” *
ch
, 
Objeù
 *
obj
)

1803 
SŒšg
 
buf
;

1805 ià(
mob
->
	`is_Åc
()

1806 && (
mob
->
pIndexD©a
->
´ogty³_æags
.
	`has
(
GIVE_PROG
)))

1807 cÚ¡‡utØ
m´g
 : 
mob
->
pIndexD©a
->
mob´ogs
) {

1808 
	`Úe_¬gum’t
(
m´g
->
¬gli¡
, 
buf
);

1810 ià((
m´g
->
ty³
 =ğ
GIVE_PROG
)

1811 && ((!
	`¡rcmp
(
obj
->
Çme
, 
m´g
->
¬gli¡
))

1812 || (!
	`¡rcmp
("®l", 
buf
)))) {

1813 
	`m´og_driv”
(
m´g
->
comli¡
, 
mob
, 
ch
, 
obj
, 
nuÎ±r
);

1819 
	}
}

1821 
	$m´og_g»‘_Œigg”
(
Ch¬aù”
 *
ch
)

1823 
Ch¬aù”
 *
vmob
;

1825 
vmob
 = 
ch
->
š_room
->
³İË
; vmob !ğ
nuÎ±r
; vmob = vmob->
Ãxt_š_room
) {

1826 ià(
ch
->
	`is_g¬bage
())

1829 ià(
vmob
->
	`is_Åc
()

1830 && 
ch
 !ğ
vmob


1831 && 
	`ÿn_£e_ch¬
(
vmob
, 
ch
)

1832 && (
vmob
->
fightšg
 =ğ
nuÎ±r
)

1833 && 
	`IS_AWAKE
(
vmob
)

1834 && (
vmob
->
pIndexD©a
->
´ogty³_æags
.
	`has
(
GREET_PROG
)))

1835 
	`m´og_³rûÁ_check
(
vmob
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
GREET_PROG
);

1836 ià(
vmob
->
	`is_Åc
()

1837 && 
ch
 !ğ
vmob


1838 && 
	`ÿn_£e_ch¬
(
vmob
, 
ch
)

1839 && (
vmob
->
fightšg
 =ğ
nuÎ±r
)

1840 && 
	`IS_AWAKE
(
vmob
)

1841 && (
vmob
->
pIndexD©a
->
´ogty³_æags
.
	`has
(
ALL_GREET_PROG
)))

1842 
	`m´og_³rûÁ_check
(
vmob
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
ALL_GREET_PROG
);

1846 
	}
}

1848 
	$m´og_h™´út_Œigg”
(
Ch¬aù”
 *
mob
, Ch¬aù” *
ch
)

1850 ià(
mob
->
	`is_Åc
()

1851 && (
mob
->
pIndexD©a
->
´ogty³_æags
.
	`has
(
HITPRCNT_PROG
)))

1852 cÚ¡‡utØ
m´g
 : 
mob
->
pIndexD©a
->
mob´ogs
)

1853 ià((
m´g
->
ty³
 =ğ
HITPRCNT_PROG
)

1854 && ((100 * 
mob
->
h™
 / 
	`GET_MAX_HIT
(mob)è< 
	`©oi
(
m´g
->
¬gli¡
))) {

1855 
	`m´og_driv”
(
m´g
->
comli¡
, 
mob
, 
ch
, 
nuÎ±r
,‚ullptr);

1860 
	}
}

1862 
	$m´og_boÙ_Œigg”
(
Ch¬aù”
 *
mob
)

1864 ià(
mob
->
pIndexD©a
->
´ogty³_æags
.
	`has
(
BOOT_PROG
))

1865 
	`m´og_³rûÁ_check
(
mob
, 
nuÎ±r
,‚uÎ±r,‚uÎ±r, 
BOOT_PROG
);

1868 
	}
}

1870 
	$m´og_¿ndom_Œigg”
(
Ch¬aù”
 *
mob
)

1872 ià(
mob
->
pIndexD©a
->
´ogty³_æags
.
	`has
(
RAND_PROG
))

1873 
	`m´og_³rûÁ_check
(
mob
, 
nuÎ±r
,‚uÎ±r,‚uÎ±r, 
RAND_PROG
);

1876 
	}
}

1878 
	$m´og_¿ndom_¬—_Œigg”
(
Ch¬aù”
 *
mob
)

1880 ià(!
mob
->
pIndexD©a
->
´ogty³_æags
.
	`has
(
RAND_AREA_PROG
))

1884 
¡d
::
£t
<
Room
 *> 
rooms
;

1887 
DesütÜ
 *
d
 = 
desütÜ_li¡
; d; d = d->
Ãxt
) {

1888 ià(
d
->
	`is_¶ayšg
()

1889 && 
d
->
ch¬aù”
->
š_room


1890 && 
d
->
ch¬aù”
->
š_room
->
	`¬—
(è=ğ
mob
->in_room->area())

1891 
rooms
.
	`em¶aû
(
d
->
ch¬aù”
->
š_room
);

1894 ià(
rooms
.
	`em±y
())

1897 
Room
 *
Üig_room
 = 
mob
->
š_room
;

1898 
	`ch¬_äom_room
(
mob
);

1900 
Room
 *
room
 : 
rooms
) {

1901 
	`ch¬_to_room
(
mob
, 
room
);

1902 
	`m´og_³rûÁ_check
(
mob
, 
nuÎ±r
,‚uÎ±r,‚uÎ±r, 
RAND_AREA_PROG
);

1903 
	`ch¬_äom_room
(
mob
);

1905 ià(
mob
->
	`is_g¬bage
())

1909 ià(!
mob
->
	`is_g¬bage
())

1910 
	`ch¬_to_room
(
mob
, 
Üig_room
);

1912 
rooms
.
	`ş—r
();

1913 
	}
}

1915 
	$m´og_tick_Œigg”
(
Ch¬aù”
 *
mob
)

1917 ià(
mob
->
pIndexD©a
->
´ogty³_æags
.
	`has
(
TICK_PROG
))

1918 
	`m´og_³rûÁ_check
(
mob
, 
nuÎ±r
,‚uÎ±r,‚uÎ±r, 
TICK_PROG
);

1921 
	}
}

1923 
	$m´og_¥“ch_Œigg”
(cÚ¡ 
SŒšg
& 
txt
, 
Ch¬aù”
 *
mob
)

1925 
Ch¬aù”
 *
vmob
;

1927 
vmob
 = 
mob
->
š_room
->
³İË
; vmob !ğ
nuÎ±r
; vmob = vmob->
Ãxt_š_room
) {

1928 ià(
mob
->
	`is_g¬bage
())

1931 ià(
vmob
->
	`is_Åc
(è&& (vmob->
pIndexD©a
->
´ogty³_æags
.
	`has
(
SPEECH_PROG
)))

1932 
	`m´og_wÜdli¡_check
(
txt
.
	`c_¡r
(), 
vmob
, 
mob
, 
nuÎ±r
,‚uÎ±r, 
SPEECH_PROG
);

1936 
	}
}

	@src/mobiles.cc

28 
	~"aù.hh
"

29 
	~"¬gum’t.hh
"

30 
	~"Ch¬aù”.hh
"

31 
	~"deş¬e.hh
"

32 
	~"FÏgs.hh
"

33 
	~"FÜm©.hh
"

34 
	~"magic.hh
"

35 
	~"memÜy.hh
"

36 
	~"m”c.hh
"

37 
	~"PÏy”.hh
"

38 
	~"¿ndom.hh
"

39 
	~"Room.hh
"

40 
	~"SŒšg.hh
"

42 
	$do_h—l
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

44 
buf
[
MAX_STRING_LENGTH
];

45 *
wÜds
;

46 
Ch¬aù”
 *
mob
;

47 
Ch¬aù”
 *
rch
;

48 
SPELL_FUN
 *
¥–l
;

49 
co¡
;

50 
skl
::
ty³
 
¢
 = skl::ty³::
unknown
;

53 
mob
 = 
ch
->
š_room
->
³İË
; mob; mob = mob->
Ãxt_š_room
) {

54 ià(
mob
->
	`is_Åc
(è&& mob->
aù_æags
.
	`has
(
ACT_IS_HEALER
)) ;

57 ià(
mob
 =ğ
nuÎ±r
) {

58 
	`¡c
("You cª'ˆdØth© h”e.\n", 
ch
);

62 
SŒšg
 
¬g
;

63 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

65 ià(
¬g
.
	`em±y
()) {

67 
	`aù
("$N say 'I ofã¸thfŞlowšg s³Îs:'", 
ch
, 
nuÎ±r
, 
mob
, 
TO_CHAR
);

68 
	`¡c
("†ight: cu»†ighˆwound  5 gŞd\n", 
ch
);

69 
	`¡c
(" s”ious: cu» s”iou wound  10 gŞd\n", 
ch
);

70 
	`¡c
(" cr™ic: cu» cr™iÿÈwound  20 gŞd\n", 
ch
);

71 
	`¡c
(" h—l: h—lšg s³Î 30 gŞd\n", 
ch
);

72 
	`¡c
(" blšd: cu» blšdÃs  1 gŞd\n", 
ch
);

73 
	`¡c
(" di£a£: cu» di£a£ 1 gŞd\n", 
ch
);

74 
	`¡c
("…oisÚ: cu»…oisÚ 1 gŞd\n", 
ch
);

75 
	`¡c
(" uncur£:„emovcur£ 1 gŞd\n", 
ch
);

76 
	`¡c
("„eäesh:„e¡Ü¡amš¨ 15 gŞd\n", 
ch
);

77 
	`¡c
(" mªa:„e¡Ümª¨ 35 gŞd\n", 
ch
);

78 
	`¡c
(" Ty³ h—È<ty³>Øbh—Ëd.\n", 
ch
);

82 ià(
¬g
.
	`is_´efix_of
("light")) {

83 
¥–l
 = 
¥–l_cu»_light
;

84 
¢
 = 
skl
::
ty³
::
cu»_light
;

85 
wÜds
 = "judicandus dies";

86 
co¡
 = 500;

88 ià(
¬g
.
	`is_´efix_of
("serious")) {

89 
¥–l
 = 
¥–l_cu»_£rious
;

90 
¢
 = 
skl
::
ty³
::
cu»_£rious
;

91 
wÜds
 = "judicandus gzfuajg";

92 
co¡
 = 1000;

94 ià(
¬g
.
	`is_´efix_of
("critical")) {

95 
¥–l
 = 
¥–l_cu»_ü™iÿl
;

96 
¢
 = 
skl
::
ty³
::
cu»_ü™iÿl
;

97 
wÜds
 = "judicandus qfuhuqar";

98 
co¡
 = 2000;

100 ià(
¬g
.
	`is_´efix_of
("heal")) {

101 
¥–l
 = 
¥–l_h—l
;

102 
¢
 = 
skl
::
ty³
::
h—l
;

103 
wÜds
 = "Parr";

104 
co¡
 = 3000;

106 ià(
¬g
.
	`is_´efix_of
("blindness")) {

107 
¥–l
 = 
¥–l_cu»_blšdÃss
;

108 
¢
 = 
skl
::
ty³
::
cu»_blšdÃss
;

109 
wÜds
 = "judicandus‚oselacri";

110 
co¡
 = 100;

112 ià(
¬g
.
	`is_´efix_of
("disease")) {

113 
¥–l
 = 
¥–l_cu»_di£a£
;

114 
¢
 = 
skl
::
ty³
::
cu»_di£a£
;

115 
wÜds
 = "judicandusƒugzagz";

116 
co¡
 = 100;

118 ià(
¬g
.
	`is_´efix_of
("poison")) {

119 
¥–l
 = 
¥–l_cu»_poisÚ
;

120 
¢
 = 
skl
::
ty³
::
cu»_poisÚ
;

121 
wÜds
 = "judicandus sausabru";

122 
co¡
 = 100;

124 ià(
¬g
.
	`is_´efix_of
("uncurse") ||‡rg.is_prefix_of("curse")) {

125 
¥–l
 = 
¥–l_»move_cur£
;

126 
¢
 = 
skl
::
ty³
::
»move_cur£
;

127 
wÜds
 = "candussido judifgz";

128 
co¡
 = 100;

130 ià(
¬g
.
	`is_´efix_of
("mana") ||‡rg.is_prefix_of("energize")) {

131 
¥–l
 = 
nuÎ±r
;

132 
¢
 = 
skl
::
ty³
::
unknown
;

133 
wÜds
 = "energizer";

134 
co¡
 = 3500;

136 ià(
¬g
.
	`is_´efix_of
("refresh") ||‡rg.is_prefix_of("stamina")) {

137 
¥–l
 = 
¥–l_»äesh
;

138 
¢
 = 
skl
::
ty³
::
»äesh
;

139 
wÜds
 = "candusima";

140 
co¡
 = 1500;

143 
	`aù
("$N say 'Ty³ 'h—l' fÜ‡†i¡ oà¥–ls.'", 
ch
, 
nuÎ±r
, 
mob
, 
TO_CHAR
);

147 ià(
co¡
 > (
ch
->
gŞd
 * 100 + ch->
sv”
)) {

148 
	`aù
("$N say 'You dØnÙ hav’ough gŞd fÜ my s”viûs.'", 
ch
, 
nuÎ±r
, 
mob
, 
TO_CHAR
);

152 
	`WAIT_STATE
(
ch
, 
PULSE_VIOLENCE
);

153 
	`deduù_co¡
(
ch
, 
co¡
);

154 
mob
->
gŞd
 +ğ
co¡
 / 100;

156 
rch
 = 
ch
->
š_room
->
³İË
;„ch;„ch =„ch->
Ãxt_š_room
) {

157 ià(
	`numb”_³rûÁ
(è< 
	`g‘_skl_Ëv–
(
rch
, 
skl
::
ty³
::
Ïnguages
)) {

158 
FÜm©
::
	`¥rštf
(
buf
, "$Àu‰” thwÜd '%s'.", 
¬g
);

159 
	`aù
(
buf
, 
mob
, 
nuÎ±r
, 
rch
, 
TO_VICT
);

160 
	`check_im´ove
(
rch
, 
skl
::
ty³
::
Ïnguages
, 
Œue
, 8);

163 
FÜm©
::
	`¥rštf
(
buf
, "$Àu‰” thwÜd '%s'.", 
wÜds
);

164 
	`aù
(
buf
, 
mob
, 
nuÎ±r
, 
rch
, 
TO_VICT
);

166 ià(
	`g‘_skl_Ëv–
(
rch
, 
skl
::
ty³
::
Ïnguages
))

167 
	`check_im´ove
(
rch
, 
skl
::
ty³
::
Ïnguages
, 
çl£
, 8);

171 ià(
¥–l
 =ğ
nuÎ±r
) {

172 
ch
->
mªa
 +ğ
	`diû
(9, 10è+ 
mob
->
Ëv–
 / 2;

173 
ch
->
mªa
 = 
¡d
::
	`mš
(ch->mªa, 
	`GET_MAX_MANA
(ch));

174 
	`¡c
("A w¬m glow…as£ through you.\n", 
ch
);

178 ià(
¢
 =ğ
skl
::
ty³
::
unknown
) ;

181 
	`¥–l
(
¢
, 
mob
->
Ëv–
, mob, 
ch
, 
TARGET_CHAR
, 1);

182 
	}
}

	@src/music.cc

28 
	~"music.hh
"

30 
	~"aù.hh
"

31 
	~"¬gum’t.hh
"

32 
	~"Ch¬aù”.hh
"

33 
	~"DesütÜ.hh
"

34 
	~"fe.hh
"

35 
	~"FÏgs.hh
"

36 
	~"FÜm©.hh
"

37 
	~"Game.hh
"

38 
	~"Loggšg.hh
"

39 
	~"memÜy.hh
"

40 
	~"m”c.hh
"

41 
	~"Objeù.hh
"

42 
	~"ObjeùV®ue.hh
"

43 
	~"PÏy”.hh
"

44 
	~"Room.hh
"

45 
	~"WÜld.hh
"

47 
	gchªÃl_sÚgs
[
MAX_GLOBAL
 + 1];

48 
	g¡d
::
veùÜ
<
sÚg_d©a
> 
sÚg_bË
;

50 
	$sÚg_upd©e
()

52 
Objeù
 *
obj
;

53 
Ch¬aù”
 *
viùim
;

54 
Room
 *
room
;

55 
DesütÜ
 *
d
;

56 
buf
[
MAX_STRING_LENGTH
];

57 
SŒšg
 
lše
;

58 
i
;

61 ià(()
chªÃl_sÚgs
[1] >ğ
sÚg_bË
.
	`size
())

62 
chªÃl_sÚgs
[1] = -1;

64 ià(
chªÃl_sÚgs
[1] > -1) {

65 ià(
chªÃl_sÚgs
[0] >ğ
MAX_LINES


66 || 
chªÃl_sÚgs
[0] >ğ
sÚg_bË
[chªÃl_sÚgs[1]].
lšes
) {

67 
chªÃl_sÚgs
[0] = -1;

70 
i
 = 1; i < 
MAX_GLOBAL
; i++)

71 
chªÃl_sÚgs
[
i
] = channel_songs[i + 1];

73 
chªÃl_sÚgs
[
MAX_GLOBAL
] = -1;

76 ià(
chªÃl_sÚgs
[0] < 0) {

77 
FÜm©
::
	`¥rštf
(
buf
, "Music: %s, %s",

78 
sÚg_bË
[
chªÃl_sÚgs
[1]].
group
,

79 
sÚg_bË
[
chªÃl_sÚgs
[1]].
Çme
);

80 
chªÃl_sÚgs
[0] = 0;

83 
FÜm©
::
	`¥rštf
(
buf
, "Music: '%s'",

84 
sÚg_bË
[
chªÃl_sÚgs
[1]].
lyrics
[channel_songs[0]]);

85 
chªÃl_sÚgs
[0]++;

88 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

89 
viùim
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

91 ià(
d
->
	`is_¶ayšg
() &&

92 !
viùim
->
comm_æags
.
	`has
(
COMM_NOMUSIC
) &&

93 !
viùim
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

94 
	`Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_MUSIC
);

95 
	`aù
("$t", 
d
->
ch¬aù”
, 
buf
, 
nuÎ±r
, 
TO_CHAR
, 
POS_SLEEPING
, 
çl£
);

96 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

102 
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt
) {

103 ià(
obj
->
™em_ty³
 !ğ
ITEM_JUKEBOX
 || obj->
v®ue
[1] < 0)

106 ià((è
obj
->
v®ue
[1] >ğ
sÚg_bË
.
	`size
()) {

107 
obj
->
v®ue
[1] = -1;

113 ià((
room
 = 
obj
->
š_room
è=ğ
nuÎ±r
) {

114 ià(
obj
->
ÿ¼›d_by
 =ğ
nuÎ±r
)

116 ià((
room
 = 
obj
->
ÿ¼›d_by
->
š_room
è=ğ
nuÎ±r
)

120 ià(
obj
->
v®ue
[0] < 0) {

121 
FÜm©
::
	`¥rštf
(
buf
, "$p starts…laying %s, %s.",

122 
sÚg_bË
[
obj
->
v®ue
[1]].
group
, sÚg_bË[obj->v®ue[1]].
Çme
);

124 ià(
room
->
³İË
 !ğ
nuÎ±r
)

125 
	`aù
(
buf
, 
room
->
³İË
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

127 
obj
->
v®ue
[0] = 0;

131 ià(
obj
->
v®ue
[0] >ğ
MAX_LINES


132 || 
obj
->
v®ue
[0] >ğ
sÚg_bË
[obj->v®ue[1]].
lšes
) {

133 
obj
->
v®ue
[0] = -1;

135 
obj
->
v®ue
[1] = obj->value[2];

136 
obj
->
v®ue
[2] = obj->value[3];

137 
obj
->
v®ue
[3] = obj->value[4];

138 
obj
->
v®ue
[4] = -1;

142 
lše
 = 
sÚg_bË
[
obj
->
v®ue
[1]].
lyrics
[obj->value[0]];

143 ++
obj
->
v®ue
[0];

146 
FÜm©
::
	`¥rštf
(
buf
, "$°bİs: '%s'", 
lše
);

148 ià(
room
->
³İË
 !ğ
nuÎ±r
)

149 
	`aù
(
buf
, 
room
->
³İË
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

151 
	}
}

153 
	$lßd_sÚgs
()

155 
FILE
 *
å
;

156 
i
;

157 
Ë‰”
;

160 
i
 = 0; i <ğ
MAX_GLOBAL
; i++)

161 
chªÃl_sÚgs
[
i
] = -1;

163 ià((
å
 = 
	`fİ’
(
MUSIC_FILE
, "r")è=ğ
nuÎ±r
) {

164 
Loggšg
::
	`bug
("Couldn't open music file,‚o songs‡vailable.", 0);

168 
Œue
) {

169 
Ë‰”
 = 
	`ä—d_Ë‰”
(
å
);

171 ià(
Ë‰”
 == '#') {

172 
	`fşo£
(
å
);

176 
	`ung‘c
(
Ë‰”
, 
å
);

178 
sÚg_d©a
 
sÚg
;

179 
sÚg
.
group
 = 
	`ä—d_¡ršg
(
å
);

180 
sÚg
.
Çme
 = 
	`ä—d_¡ršg
(
å
);

181 
sÚg
.
lšes
 = 0;

185 
Ë‰”
 = 
	`ä—d_Ë‰”
(
å
);

187 ià(
Ë‰”
 == '~') {

191 
	`ung‘c
(
Ë‰”
, 
å
);

193 ià(
sÚg
.
lšes
 >ğ
MAX_LINES
) {

194 
Loggšg
::
	`bug
("ToØmªy†še š‡ sÚg --†im™ i  %d.", 
MAX_LINES
);

199 
sÚg
.
lyrics
[sÚg.
lšes
] = 
	`ä—d_¡ršg_eŞ
(
å
);

200 
sÚg
.
lšes
++;

203 ià(
sÚg
.
lšes
 > 0)

204 
sÚg_bË
.
	`push_back
(
sÚg
);

207 
	`fşo£
(
å
);

208 
	}
}

210 
	$do_¶ay
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

212 
Objeù
 *
juke
;

213 cÚ¡ *
¡r
;

214 
boŞ
 
glob®
 = 
çl£
;

216 
SŒšg
 
¬g
;

217 
¡r
 = 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

219 
juke
 = 
ch
->
ÿ¼yšg
; juk!ğ
nuÎ±r
; jukğjuke->
Ãxt_cÚ‹Á
) {

220 ià(
juke
->
™em_ty³
 =ğ
ITEM_JUKEBOX
 && 
	`ÿn_£e_obj
(
ch
, juke))

224 ià(
juke
 =ğ
nuÎ±r
) {

225 
juke
 = 
ch
->
š_room
->
cÚ‹Ás
; juk!ğ
nuÎ±r
; jukğjuke->
Ãxt_cÚ‹Á
) {

226 ià(
juke
->
™em_ty³
 =ğ
ITEM_JUKEBOX
 && 
	`ÿn_£e_obj
(
ch
, juke))

231 ià(
juke
 =ğ
nuÎ±r
) {

232 
	`¡c
("You s“‚ÙhšgØ¶ay.\n", 
ch
);

236 ià(
¬gum’t
.
	`em±y
()) {

237 
	`¡c
("PÏy wh©?\n", 
ch
);

241 ià(
¬g
 == "list") {

242 
SŒšg
 
bufãr
;

243 
buf
[
MAX_STRING_LENGTH
];

244 
cŞ
 = 0;

245 
boŞ
 
¬ti¡
 = 
çl£
, 
m©ch
 = false;

246 
¬gum’t
 = 
¡r
;

247 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

249 ià(
¬g
 == "artist")

250 
¬ti¡
 = 
Œue
;

252 ià(!
¬gum’t
.
	`em±y
())

253 
m©ch
 = 
Œue
;

255 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("% ha thfŞlowšg sÚg avaabË:\n", 
juke
->
shÜt_desü
.
	`ÿp™®ize
());

257 cÚ¡‡uto& 
’Œy
 : 
sÚg_bË
) {

258 ià(
¬ti¡


259 && (!
m©ch
 || 
¬gum’t
.
	`is_´efix_of
(
’Œy
.
group
)))

260 
FÜm©
::
	`¥rštf
(
buf
, "%-39 %-39s\n", 
’Œy
.
group
,ƒÁry.
Çme
);

261 ià(!
¬ti¡


262 && (!
m©ch
 || 
¬gum’t
.
	`is_´efix_of
(
’Œy
.
Çme
)))

263 
FÜm©
::
	`¥rštf
(
buf
, "%-35 ", 
’Œy
.
Çme
);

267 
bufãr
 +ğ
buf
;

269 ià(!
¬ti¡
 && ++
cŞ
 % 2 == 0)

270 
bufãr
 += "\n";

273 ià(!
¬ti¡
 && 
cŞ
 % 2 != 0)

274 
bufãr
 += "\n";

276 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

280 ià(
¬g
 =ğ"loud" && 
	`IS_IMMORTAL
(
ch
)) {

281 
¬gum’t
 = 
¡r
;

282 
glob®
 = 
Œue
;

285 ià(
¬g
 == "stop") {

286 ià(
juke
) {

287 ià(!
juke
->
ÿ¼›d_by
) {

288 ià(!
	`IS_IMMORTAL
(
ch
)) {

289 
	`¡c
("You cª oÆy stİ‡ jukebox iÀyou¸šv’tÜy.\n", 
ch
);

294 
	`±c
(
ch
, "You stİ %s.\n", 
juke
->
shÜt_desü
);

296 
i
 = 0; i < 5; i++)

297 
juke
->
v®ue
[
i
] = -1;

302 ià(!
	`IS_IMMORTAL
(
ch
)) {

303 
	`¡c
("You dÚ'ˆ£¨jukebox‡round.\n", 
ch
);

307 
i
 = 0; i <ğ
MAX_GLOBAL
; i++)

308 
chªÃl_sÚgs
[
i
] = -1;

313 ià(
¬gum’t
.
	`em±y
()) {

314 
	`¡c
("PÏy wh©?\n", 
ch
);

318 ià((
glob®
 && 
chªÃl_sÚgs
[
MAX_GLOBAL
] > -1)

319 || (!
glob®
 && 
juke
->
v®ue
[4] > -1)) {

320 
	`¡c
("Thjukebox i fuÎ u°righˆnow.\n", 
ch
);

324 
sÚg
;

325 
sÚg
 = 0; sÚg < 
sÚg_bË
.
	`size
(); song++) {

326 ià(
¬gum’t
.
	`is_´efix_of
(
sÚg_bË
[
sÚg
].
Çme
))

330 ià(
sÚg
 >ğ
sÚg_bË
.
	`size
()) {

331 
	`¡c
("Th© sÚg i¢'ˆavaabË.\n", 
ch
);

335 
	`¡c
("Comšg„ighˆup.\n", 
ch
);

337 ià(
glob®
) {

338 
i
 = 1; i <ğ
MAX_GLOBAL
; i++)

339 ià(
chªÃl_sÚgs
[
i
] < 0) {

340 ià(
i
 == 1)

341 
chªÃl_sÚgs
[0] = -1;

343 
chªÃl_sÚgs
[
i
] = 
sÚg
;

348 
i
 = 1; i < 5; i++)

349 ià(
juke
->
v®ue
[
i
] < 0) {

350 ià(
i
 == 1)

351 
juke
->
v®ue
[0] = -1;

353 
juke
->
v®ue
[
i
] = 
sÚg
;

357 
	}
}

	@src/objstate.cc

7 
	~<veùÜ
>

9 
	~"afãù/Afãù.hh
"

10 
	~"JSON/cJSON.hh
"

11 
	~"deş¬e.hh
"

12 
	~"ExŒaDesü.hh
"

13 
	~"fe.hh
"

14 
	~"FÏgs.hh
"

15 
	~"FÜm©.hh
"

16 
	~"Game.hh
"

17 
	~"Loggšg.hh
"

18 
	~"m”c.hh
"

19 
	~"Objeù.hh
"

20 
	~"ObjeùPrÙÙy³.hh
"

21 
	~"ObjeùV®ue.hh
"

22 
	~"Re£t.hh
"

23 
	~"Room.hh
"

24 
	~"SŒšg.hh
"

25 
	~"WÜld.hh
"

27 
CURRENT_VERSION
;

28 
cJSON
 *
fwr™e_obj
(
Objeù
 *);

29 
Objeù
 *
ä—d_obj
(
cJSON
 *, );

33 
boŞ
 
	$has_modif›d_cÚ‹Ás
(
Objeù
 *
obj
)

35 
Objeù
 *
cobj
;

37 
cobj
 = 
obj
->
cÚšs
; cobj; cobj = cobj->
Ãxt_cÚ‹Á
)

38 ià(!
cobj
->
»£t


39 || 
cobj
->
»£t
->
commªd
 != 'P'

40 || 
cobj
->
»£t
->
¬g3
 !ğ
obj
->
pIndexD©a
->
vnum
)

41  
Œue
;

43  
çl£
;

44 
	}
}

50 
boŞ
 
	$is_wÜth_§všg
(
Objeù
 *
obj
)

52 ià(!
obj
->
š_room


53 || 
obj
->
ÿ¼›d_by


54 || 
obj
->
š_obj
)

55  
çl£
;

61 
obj
->
™em_ty³
) {

62 
ITEM_POTION
:

63 
ITEM_SCROLL
:

64 
ITEM_PILL
:

65 
ITEM_STAFF
:

66 
ITEM_WAND
:

67 
ITEM_CORPSE_NPC
:

68  
çl£
;

72 ià(
obj
->
Ëv–
 >ğ
LEVEL_IMMORTAL
)

73  
çl£
;

75 ià((
obj
->
tim”
 > 0 || obj->
ş—n_tim”
 > 0è&& obj->
™em_ty³
 !ğ
ITEM_CORPSE_PC
)

76  
çl£
;

79 ià(
obj
->
»£t
 && obj->»£t->
commªd
 == 'O')

80 ià(
	`LoÿtiÚ
(()
obj
->
»£t
->
¬g3
è=ğobj->
š_room
->
loÿtiÚ
)

81 ià(!
obj
->
cÚšs
 || !
	`has_modif›d_cÚ‹Ás
(obj))

82  
çl£
;

84  
Œue
;

85 
	}
}

90 
	$obj¡©e_§ve_™ems
()

92 ià(
Game
::
pÜt
 !ğ
DIZZYPORT
)

95 
cJSON
 *
roÙ
 = 
	`cJSON_C»©eObjeù
();

96 
	`cJSON_AddNumb”ToObjeù
(
roÙ
, "v”siÚ", 
CURRENT_VERSION
);

98 
cJSON
 *
objeùs
 = 
	`cJSON_C»©eA¼ay
();

100 
Objeù
 *
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt
) {

101 ià(
	`is_wÜth_§všg
(
obj
)) {

102 
cJSON
 *
o
 = 
	`cJSON_C»©eObjeù
();

103 
	`cJSON_AddNumb”ToObjeù
(
o
, "room", 
obj
->
š_room
->
loÿtiÚ
.
	`to_št
());

104 
	`cJSON_AddI‹mToObjeù
(
o
, "obj", 
	`fwr™e_obj
(
obj
));

105 
	`cJSON_AddI‹mToA¼ay
(
objeùs
, 
o
);

109 
	`cJSON_AddI‹mToObjeù
(
roÙ
, "objeùs", 
objeùs
);

110 *
JSON¡ršg
 = 
	`cJSON_Pršt
(
roÙ
);

111 
	`cJSON_D–‘e
(
roÙ
);

113 
FILE
 *
å
;

114 ià((
å
 = 
	`fİ’
(
TEMP_FILE
, "w")è!ğ
nuÎ±r
) {

115 
	`åuts
(
JSON¡ršg
, 
å
);

116 
	`fşo£
(
å
);

117 
	`»Çme
(
TEMP_FILE
, 
COPYOVER_ITEMS
 ".json");

120 
Loggšg
::
	`bugf
("Could‚Ù wr™tØcİyov” fe: %s", 
COPYOVER_ITEMS
);

123 
	`ä“
(
JSON¡ršg
);

125 
	}
}

127 
	$couÁ_™ems
(cÚ¡ 
Objeù
 *
obj
) {

128 
couÁ
 = 1;

130 cÚ¡ 
Objeù
 *
c
 = 
obj
->
cÚšs
; c !ğ
nuÎ±r
; c = c->
Ãxt_cÚ‹Á
)

131 
couÁ
 +ğ
	`couÁ_™ems
(
c
);

133  
couÁ
;

134 
	}
}

136 
	$obj¡©e_lßd_™ems
() {

137 
cJSON
 *
roÙ
 = 
JSON
::
	`»ad_fe
(
COPYOVER_ITEMS
 ".json");

139 ià(
roÙ
 =ğ
nuÎ±r
)

142 
v”siÚ
 = 
CURRENT_VERSION
;

143 
JSON
::
	`g‘_št
(
roÙ
, &
v”siÚ
, "version");

145 
cJSON
 *
objeùs
 = 
	`cJSON_G‘ObjeùI‹m
(
roÙ
, "objects");

146 
tÙ®_couÁ
 = 0;

148 
cJSON
 *
o
 = 
objeùs
->
chd
; o; o = o->
Ãxt
) {

149 
room_loc_št
;

150 
JSON
::
	`g‘_št
(
o
, &
room_loc_št
, "room");

151 
Room
 *
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
room_loc_št
));

153 ià(
room
 =ğ
nuÎ±r
)

156 
Objeù
 *
obj
 = 
	`ä—d_obj
(
	`cJSON_G‘ObjeùI‹m
(
o
, "obj"), 
v”siÚ
);

158 ià(
obj
 =ğ
nuÎ±r
)

163 
Objeù
 *
cobj
 = 
room
->
cÚ‹Ás
; cobj !ğ
nuÎ±r
; cobj = cobj->
Ãxt_cÚ‹Á
) {

164 ià(
cobj
->
pIndexD©a
->
vnum
 =ğ
obj
->pIndexData->vnum) {

165 
	`obj_äom_room
(
cobj
);

166 
	`exŒaù_obj
(
cobj
);

171 
couÁ
 = 
	`couÁ_™ems
(
obj
);

173 ià(
obj
->
pIndexD©a
->
vnum
 =ğ
OBJ_VNUM_PIT
 && 
Game
::
	`wÜld
().
dÚ©iÚ_p™
 =ğ
nuÎ±r
) {

174 
Game
::
	`wÜld
().
dÚ©iÚ_p™
 = 
obj
;

175 
FÜm©
::
	`´štf
("Lßded dÚ©iÚ…™ w™h %d i‹ms.\n", 
couÁ
);

178 
	`obj_to_room
(
obj
, 
room
);

179 
tÙ®_couÁ
 +ğ
couÁ
;

182 
	`cJSON_D–‘e
(
roÙ
);

183  
tÙ®_couÁ
;

184 
	}
}

	@src/paint.cc

1 
	~"aù.hh
"

2 
	~"afãù/Afãù.hh
"

3 
	~"chªÃls.hh
"

4 
	~"Ch¬aù”.hh
"

5 
	~"deş¬e.hh
"

6 
	~"fšd.hh
"

7 
	~"FÏgs.hh
"

8 
	~"FÜm©.hh
"

9 
	~"Game.hh
"

10 
	~"š‹½.hh
"

11 
	~"memÜy.hh
"

12 
	~"m”c.hh
"

13 
	~"Objeù.hh
"

14 
	~"ObjeùV®ue.hh
"

15 
	~"PÏy”.hh
"

16 
	~"¿ndom.hh
"

17 
	~"Room.hh
"

18 
	~"SŒšg.hh
"

19 
	~<®gÜ™hm
>

20 
	~"WÜld.hh
"

22 
	$do_·štbow
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

24 ià(
ch
->
	`is_Åc
()) {

25 
	`¡c
("Mobe dÚ'ˆliktØ¶ay…aštb®È=).\n", 
ch
);

29 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PAINT
)) {

30 
	`¡c
("You…uÎ ouˆthwh™æag.\n", 
ch
);

31 
ch
->
pcd©a
->
¶r_æags
 -ğ
PLR_PAINT
;

32 
	`wizÃt
("$N i now iÀ*NPB* mode.", 
ch
, 
nuÎ±r
, 
WIZ_MISC
, 0, 0);

35 
	`¡c
("You…»·» fÜ comb©.\n", 
ch
);

36 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_PAINT
;

37 
	`wizÃt
("$N i now iÀ*PB* mode.", 
ch
, 
nuÎ±r
, 
WIZ_MISC
, 0, 0);

39 
	}
}

42 
	$do_»lßd
(
Ch¬aù”
 *
ch
)

44 
buf
[
MAX_STRING_LENGTH
];

45 
Objeù
 *
tube
;

46 
Objeù
 *
gun
;

48 ià((
tube
 = 
	`g‘_obj_ÿ¼y
(
ch
, "tube")è=ğ
nuÎ±r
) {

49 
	`¡c
("You dÚ'ˆhavªy…ašˆtubes!\n", 
ch
);

53 ià(
tube
->
™em_ty³
 !ğ
ITEM_PBTUBE
) {

54 
	`¡c
("Th© i nÙ‡…aštb®Ètube!\n", 
ch
);

58 ià((
gun
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_HOLD
)è=ğ
nuÎ±r
) {

59 
	`¡c
("You¸nÙ hŞdšg you¸·štgun!\n", 
ch
);

63 ià(
gun
->
™em_ty³
 !ğ
ITEM_PBGUN
) {

64 
	`¡c
("Th© i nÙ‡…aštb®Ègun!\n", 
ch
);

68 ià((
gun
->
v®ue
[0] + 
tube
->value[0]) > gun->value[1]) {

69 
FÜm©
::
	`¥rštf
(
buf
, "Your…aint gun can only hold %d…aintballs.\n",

70 
gun
->
v®ue
[1]);

71 
	`¡c
(
buf
, 
ch
);

75 
	`exŒaù_obj
(
tube
);

76 
gun
->
v®ue
[0] +ğ
tube
->value[0];

77 
FÜm©
::
	`¥rštf
(
buf
, "{VYou‚ow hav{W[{V%d{W]{V…aštb®ls!{x\n", 
gun
->
v®ue
[0]);

78 
	`¡c
(
buf
, 
ch
);

79 
	}
}

81 
	$do_¥Ït
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

83 
Objeù
 *
gun
;

84 
Room
 *
loÿtiÚ
;

85 
Ch¬aù”
 *
viùim
;

87 ià((
gun
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_HOLD
)è=ğ
nuÎ±r
) {

88 
	`¡c
("You'»‚Ù hŞdšg you¸·štgun!\n", 
ch
);

92 ià(
gun
->
™em_ty³
 !ğ
ITEM_PBGUN
) {

93 
	`¡c
("Th© i nÙ‡…aštb®Ègun!\n", 
ch
);

97 ià(
¬gum’t
.
	`em±y
()) {

98 
	`¡c
("ShoÙ who?\n", 
ch
);

102 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬gum’t
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

103 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

107 ià((
ch
->
	`is_Åc
()è|| (
viùim
->is_npc())) {

108 
	`¡c
("Mobe ÿn'ˆ¶ay…aštb®l.\n", 
ch
);

112 ià(!
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PAINT
) ||

113 !
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_PAINT
)) {

114 
	`¡c
("BÙh…Ïy” mu¡ havtheœ…aštb®Èæag on.\n", 
ch
);

118 ià(
ch
->
š_room
 =ğ
nuÎ±r
 || 
viùim
->in_room ==‚ullptr)

121 ià(
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_SAFE
)) {

122 
	`¡c
("Oddlyƒnough, iÀthi room you f“È³aûful.\n", 
ch
);

126 ià(
gun
->
v®ue
[0] <= 0) {

127 
	`¡c
("You¸guÀi em±y! R–ßd!\n", 
ch
);

131 ià(
gun
->
v®ue
[3] > 25) {

132 
	`¡c
("You¸guÀi damagedoØbadly!\n", 
ch
);

136 ià(
ch
 =ğ
viùim
) {

137 
	`¡c
("OUCH!\n", 
ch
);

138 
gun
->
v®ue
[0] -= 1;

139 
	`WAIT_STATE
(
ch
, 
gun
->
v®ue
[2].
	`v®ue
());

143 ià(
	`numb”_³rûÁ
(è> (75 - 
gun
->
v®ue
[4])) {

144 ià((
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_ALTAR
)))è=ğ
nuÎ±r
)

147 
	`aù
("{P$n‚ails $N with‡ bullseye…aintball shot! {HSPLAT!{x",

148 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

149 
	`aù
("{PYou blast $N with‡…erfect shot! {HSPLAT!{x",

150 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

151 
	`aù
("{PA…ellet from $n's gun soarshroughhe‡ir‡nd hits you! {HSPLAT!{x",

152 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

154 ià((
viùim
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
¬’a
) &&

155 (!
viùim
->
š_room
->
	`æags
().
	`has
(
ROOM_NO_RECALL
)) &&

156 !
	`ch¬_š_du–_room
(
viùim
) &&

157 (!
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
cur£
))) {

158 
	`ch¬_äom_room
(
viùim
);

159 
	`ch¬_to_room
(
viùim
, 
loÿtiÚ
);

161 ià(
viùim
->
³t
 !ğ
nuÎ±r
) {

162 
	`ch¬_äom_room
(
viùim
->
³t
);

163 
	`ch¬_to_room
(
viùim
->
³t
, 
loÿtiÚ
);

166 
	`do_look
(
viùim
, "auto");

169 
gun
->
v®ue
[0] -= 1;

170 
	`WAIT_STATE
(
ch
, 
gun
->
v®ue
[2].
	`v®ue
());

173 ià(
	`numb”_³rûÁ
(è> (25 - 
gun
->
v®ue
[4])) {

174 
	`aù
("{B$n fires‡t $N, but misses by‡ mile.{x",

175 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

176 
	`aù
("{BYou miss $N! You couldn't hithe broadside of‡ barn!{x",

177 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

178 
	`aù
("{B$n shoots‡t you‡nd misses. Whew!{x",

179 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

180 
gun
->
v®ue
[0] -= 1;

181 
	`WAIT_STATE
(
ch
, 
gun
->
v®ue
[2].
	`v®ue
());

185 
	`¡c
("{YDo'h, You¸guÀi jammed!!!{x\n", 
ch
);

186 
gun
->
v®ue
[0] -= 1;

187 
	`WAIT_STATE
(
ch
, 
gun
->
v®ue
[2] * 2);

188 
gun
->
v®ue
[3] += 1;

191 
	}
}

	@src/quest.cc

13 
	~<veùÜ
>

15 
	~"aù.hh
"

16 
	~"¬gum’t.hh
"

17 
	~"afãù/Afãù.hh
"

18 
	~"A»a.hh
"

19 
	~"chªÃls.hh
"

20 
	~"Ch¬aù”.hh
"

21 
	~"deş¬e.hh
"

22 
	~"DesütÜ.hh
"

23 
	~"ExŒaDesü.hh
"

24 
	~"fšd.hh
"

25 
	~"FÏgs.hh
"

26 
	~"FÜm©.hh
"

27 
	~"Game.hh
"

28 
	~"š‹½.hh
"

29 
	~"Loggšg.hh
"

30 
	~"loÙv2.hh
"

31 
	~"memÜy.hh
"

32 
	~"m”c.hh
"

33 
	~"MobePrÙÙy³.hh
"

34 
	~"Objeù.hh
"

35 
	~"ObjeùPrÙÙy³.hh
"

36 
	~"PÏy”.hh
"

37 
	~"Que¡A»a.hh
"

38 
	~"¿ndom.hh
"

39 
	~"Room.hh
"

40 
	~"skl/skl.hh
"

41 
	~"SŒšg.hh
"

42 
	~"bËs.hh
"

43 
	~"WÜld.hh
"

44 
	~"RoomPrÙÙy³.hh
"

47 
	#QUEST_OBJQUEST1
 1283

	)

48 
	#QUEST_OBJQUEST2
 1284

	)

49 
	#QUEST_OBJQUEST3
 1285

	)

50 
	#QUEST_OBJQUEST4
 1286

	)

51 
	#QUEST_OBJQUEST5
 1287

	)

54 
	#MAXMSYL1
 77

	)

55 
	#MAXMSYL2
 38

	)

56 
	#MAXMSYL3
 83

	)

57 
	#MAXFSYL1
 76

	)

58 
	#MAXFSYL2
 42

	)

59 
	#MAXFSYL3
 54

	)

63 
	$que¡_u§ge
(
Ch¬aù”
 *
ch
)

65 
	`£t_cŞÜ
(
ch
, 
YELLOW
, 
BOLD
);

66 
	`¡c
("QUEST commªds: REQUEST INFO TIME COMPLETE FORFEIT POINTS JOIN.\n", 
ch
);

68 ià(
	`IS_IMMORTAL
(
ch
))

69 
	`¡c
("Imm QUEST commªds: OPEN CLOSE LIST DOUBLE DEDUCT PK.\n", 
ch
);

71 
	`¡c
("FÜ mÜšfÜm©iÚ,y³ 'HELP QUEST'.\n", 
ch
);

72 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

73 
	}
}

75 
	$que¡_ş—nup
(
Ch¬aù”
 *
ch
) {

76 
ch
->
pcd©a
->
¶r_æags
 -ğ
PLR_QUESTOR
;

77 
ch
->
pcd©a
->
que¡_giv”
 = 0;

78 
ch
->
pcd©a
->
couÁdown
 = 0;

79 
ch
->
pcd©a
->
que¡mob
 = 0;

80 
ch
->
pcd©a
->
que¡obj
 = 0;

81 
ch
->
pcd©a
->
que¡obf
 = 0;

82 
ch
->
pcd©a
->
que¡loc
 = 
	`LoÿtiÚ
();

83 
	}
}

85 
	$sq_ş—nup
(
Ch¬aù”
 *
ch
)

87 
Objeù
 *
obj
;

88 
ch
->
pcd©a
->
¶r_æags
 -ğ
PLR_SQUESTOR
;

89 
ch
->
pcd©a
->
sque¡_giv”
 = 0;

90 
ch
->
pcd©a
->
sqcouÁdown
 = 0;

92 ià(
ch
->
pcd©a
->
sque¡obj
 !ğ
nuÎ±r
) {

93 
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt
)

94 ià(
obj
 =ğ
ch
->
pcd©a
->
sque¡obj
) {

95 
	`exŒaù_obj
(
obj
);

99 
ch
->
pcd©a
->
sque¡obj
 = 
nuÎ±r
;

102 ià(
ch
->
pcd©a
->
sque¡mob
 !ğ
nuÎ±r
) {

103 ià(!
ch
->
pcd©a
->
sque¡mob
->
	`is_g¬bage
())

104 
	`exŒaù_ch¬
(
ch
->
pcd©a
->
sque¡mob
, 
Œue
);

106 
ch
->
pcd©a
->
sque¡mob
 = 
nuÎ±r
;

109 
ch
->
pcd©a
->
sque¡objf
 = 
çl£
;

110 
ch
->
pcd©a
->
sque¡mobf
 = 
çl£
;

111 
	}
}

113 
boŞ
 
	$que¡_Ëv–_diff
(
şev–
, 
mËv–
)

115 ià(
şev–
 <ğ5 && 
mËv–
 <ğ5è 
Œue
;

116 ià(
şev–
 > 5 && cËv– <ğ15 && 
mËv–
 > 5 && mËv– <ğ15è 
Œue
;

117 ià(
şev–
 > 15 && cËv– <ğ20 && 
mËv–
 > 15 && mËv– <ğ20è 
Œue
;

118 ià(
şev–
 > 20 && cËv– <ğ25 && 
mËv–
 > 20 && mËv– <ğ25è 
Œue
;

119 ià(
şev–
 > 25 && cËv– <ğ35 && 
mËv–
 > 25 && mËv– <ğ35è 
Œue
;

120 ià(
şev–
 > 35 && cËv– <ğ45 && 
mËv–
 > 35 && mËv– <ğ45è 
Œue
;

121 ià(
şev–
 > 45 && cËv– <ğ50 && 
mËv–
 > 45 && mËv– <ğ50è 
Œue
;

122 ià(
şev–
 > 50 && cËv– <ğ55 && 
mËv–
 > 50 && mËv– <ğ55è 
Œue
;

123 ià(
şev–
 > 55 && cËv– <ğ65 && 
mËv–
 > 55 && mËv– <ğ65è 
Œue
;

124 ià(
şev–
 > 65 && cËv– <ğ75 && 
mËv–
 > 65 && mËv– <ğ75è 
Œue
;

125 ià(
şev–
 > 75 && cËv– <ğ85 && 
mËv–
 > 75 && mËv– <ğ85è 
Œue
;

126 ià(
şev–
 > 85 && 
mËv–
 > 85è 
Œue
;

127  
çl£
;

128 
	}
}

133 
Ch¬aù”
 *
	$fšd_que¡ma¡”
(
Ch¬aù”
 *
ch
)

135 
Ch¬aù”
 *
que¡mª
;

137 
que¡mª
 = 
ch
->
š_room
->
³İË
; que¡mª !ğ
nuÎ±r
; que¡mª = que¡mª->
Ãxt_š_room
) {

138 ià(!
que¡mª
->
	`is_Åc
())

141 ià(
que¡mª
->
¥ec_fun
 =ğ
	`¥ec_lookup
("spec_questmaster"))

145 ià(
que¡mª
 =ğ
nuÎ±r
)

146  
nuÎ±r
;

148 ià(
que¡mª
->
pIndexD©a
 =ğ
nuÎ±r
) {

149 
Loggšg
::
	`bug
("find_questmaster: Questmaster has‚ullptr…IndexData!", 0);

150  
nuÎ±r
;

153 ià(
que¡mª
->
fightšg
 !ğ
nuÎ±r
) {

154 
	`¡c
("Wa™ uÁhfightšg stİs.\n", 
ch
);

155  
nuÎ±r
;

158  
que¡mª
;

159 
	}
}

161 
Ch¬aù”
 *
	$fšd_sque¡ma¡”
(
Ch¬aù”
 *
ch
)

163 
Ch¬aù”
 *
que¡mª
;

165 
que¡mª
 = 
ch
->
š_room
->
³İË
; que¡mª !ğ
nuÎ±r
; que¡mª = que¡mª->
Ãxt_š_room
) {

166 ià(!
que¡mª
->
	`is_Åc
())

169 ià(
que¡mª
->
¥ec_fun
 =ğ
	`¥ec_lookup
("spec_squestmaster"))

173 ià(
que¡mª
 =ğ
nuÎ±r
)

174  
nuÎ±r
;

176 ià(
que¡mª
->
pIndexD©a
 =ğ
nuÎ±r
) {

177 
Loggšg
::
	`bug
("find_questmaster: Questmaster has‚ullptr…IndexData!", 0);

178  
nuÎ±r
;

181 ià(
que¡mª
->
fightšg
 !ğ
nuÎ±r
) {

182 
	`¡c
("Wa™ uÁhfightšg stİs.\n", 
ch
);

183  
nuÎ±r
;

186  
que¡mª
;

187 
	}
}

190 
	$que¡_wh”e
(
Ch¬aù”
 *
ch
, *
wh©
)

192 
Room
 *
room
;

194 ià(!
ch
->
pcd©a
->
que¡loc
.
	`is_v®id
()) {

195 
Loggšg
::
	`bugf
("QUEST INFO: ch->pcd©a->que¡loøğ%d", 
ch
->
pcd©a
->
que¡loc
);

199 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

202 
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
pcd©a
->
que¡loc
);

204 
	`±c
(
ch
, "RumÜ ha ™hi % wa Ï¡ s“Àšh¬— knowÀa %s", 
wh©
, 
room
->
	`¬—
().
Çme
);

206 ià(
room
->
	`Çme
().
	`em±y
())

207 
	`±c
(
ch
, ".\n");

209 
	`±c
(
ch
, ",\Â—¸%s.\n", 
room
->
	`Çme
());

210 
	}
}

212 
	$sque¡_šfo
(
Ch¬aù”
 *
ch
)

214 
MobePrÙÙy³
 *
que¡mª
;

215 
Room
 *
que¡room_obj
, *
que¡room_mob
;

217 ià(!
	`IS_SQUESTOR
(
ch
)) {

218 
	`¡c
("You‡»n'ˆcu¼’y oÀ¨skÈque¡.\n", 
ch
);

222 ià(
ch
->
pcd©a
->
sque¡_giv”
 < 1) {

223 
Loggšg
::
	`bugf
("QUEST INFO: que¡ giv” = %d", 
ch
->
pcd©a
->
sque¡_giv”
);

224 
	`¡c
("Iˆ£em thque¡mi¡»s d›d oàŞd‡gwa™šg fÜ you.\n", 
ch
);

225 
	`sq_ş—nup
(
ch
);

229 
que¡mª
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
ch
->
pcd©a
->
sque¡_giv”
);

231 ià(
que¡mª
 =ğ
nuÎ±r
) {

232 
Loggšg
::
	`bugf
("QUEST INFO: skÈque¡ giv” %d ha nØMobePrÙÙy³!", 
ch
->
pcd©a
->
sque¡_giv”
);

233 
	`¡c
("Thque¡mi¡»s ha çÎ’ v”y iÎ. PËa£ cÚù‡Àimm!\n", 
ch
);

234 
	`sq_ş—nup
(
ch
);

238 ià(
ch
->
pcd©a
->
sque¡obj
 =ğ
nuÎ±r
 && ch->pcd©a->
sque¡mob
 ==‚ullptr) {

239 
	`¡c
("You'vfÜgÙ‹Àwh© you¸skÈque¡ was.\n", 
ch
);

240 
Loggšg
::
	`bug
("QUEST INFO: skill quest with‚o obj or mob", 0);

241 
	`sq_ş—nup
(
ch
);

245 
	`±c
(
ch
, "You„eÿÎhskÈque¡ which % gavyou.\n", 
que¡mª
->
shÜt_desü
);

247 ià(
ch
->
pcd©a
->
sque¡obj
 !ğ
nuÎ±r
 && ch->pcd©a->
sque¡mob
 ==‚ullptr) {

248 ià(
ch
->
pcd©a
->
sque¡objf
) {

249 
	`¡c
("You¸skÈque¡ i ALMOST com¶‘e!\n", 
ch
);

250 
	`±c
(
ch
, "Get backo %s before yourime„uns out!\n",

251 (
que¡mª
->
shÜt_desü
.
	`em±y
() ? "your quest master" : questman->short_descr));

255 ià((
que¡room_obj
 = 
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
pcd©a
->
sque¡loc1
)è=ğ
nuÎ±r
) {

256 
Loggšg
::
	`bug
("QUEST INFO: sqobj quest with‚o†ocation", 0);

257 
	`¡c
("You'vfÜgÙ‹Àwh”you¸que¡ objeù is.\n", 
ch
);

258 
	`sq_ş—nup
(
ch
);

262 
	`±c
(
ch
, "You‡re on‡ questo„ecoverhe†egendary %s!\n",

263 
ch
->
pcd©a
->
sque¡obj
->
shÜt_desü
);

264 
	`±c
(
ch
, "Th¬tiçù wa Ï¡ knowÀtØbš %s{x,\n", 
que¡room_obj
->
	`Çme
());

265 
	`±c
(
ch
, "šh¬— knowÀa %s{x.\n", 
que¡room_obj
->
	`¬—
().
Çme
);

269 ià(
ch
->
pcd©a
->
sque¡obj
 =ğ
nuÎ±r
 && ch->pcd©a->
sque¡mob
 !=‚ullptr) {

270 ià(
ch
->
pcd©a
->
sque¡mobf
) {

271 
	`¡c
("You¸skÈque¡ i ALMOST com¶‘e!\n", 
ch
);

272 
	`±c
(
ch
, "Get backo %s before yourime„uns out!\n",

273 (
que¡mª
->
shÜt_desü
.
	`em±y
() ? "the questmistress" : questman->short_descr));

277 ià((
que¡room_mob
 = 
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
pcd©a
->
sque¡loc2
)è=ğ
nuÎ±r
) {

278 
Loggšg
::
	`bug
("QUEST INFO: sqmob quest with‚o†ocation", 0);

279 
	`¡c
("You'vfÜgÙ‹Àwh”you¸que¡ mob is.\n", 
ch
);

280 
	`sq_ş—nup
(
ch
);

284 
	`±c
(
ch
, "You‡re on‡ questo†earn fromhe†egendary %s!\n",

285 
ch
->
pcd©a
->
sque¡mob
->
shÜt_desü
);

286 
	`±c
(
ch
, "%s can usually be found in %s{x,\n",

287 
	`GET_ATTR_SEX
(
ch
->
pcd©a
->
sque¡mob
è=ğ1 ? "He" : "She", 
que¡room_mob
->
	`Çme
());

288 
	`±c
(
ch
, "šh¬— knowÀa %s{x.\n", 
que¡room_mob
->
	`¬—
().
Çme
);

292 ià(
ch
->
pcd©a
->
sque¡obj
 !ğ
nuÎ±r
 && ch->pcd©a->
sque¡mob
 !=‚ullptr) {

293 ià((
que¡room_obj
 = 
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
pcd©a
->
sque¡loc1
)è=ğ
nuÎ±r
) {

294 
Loggšg
::
	`bug
("QUEST INFO: sqobj/mob quest with‚o obj†ocation", 0);

295 
	`¡c
("You'vfÜgÙ‹Àwh”you¸que¡ objeù is.\n", 
ch
);

296 
	`sq_ş—nup
(
ch
);

300 ià((
que¡room_mob
 = 
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
pcd©a
->
sque¡loc2
)è=ğ
nuÎ±r
) {

301 
Loggšg
::
	`bug
("QUEST INFO: sqobj/mob quest with‚o mob†ocation", 0);

302 
	`¡c
("You'vfÜgÙ‹Àwh”you¸que¡ mob is.\n", 
ch
);

303 
	`sq_ş—nup
(
ch
);

307 ià(
ch
->
pcd©a
->
sque¡objf
 && ch->pcd©a->
sque¡mobf
) {

308 
	`¡c
("You¸skÈque¡ i ALMOST com¶‘e!\n", 
ch
);

309 
	`±c
(
ch
, "Get backo %s before yourime„uns out!\n",

310 (
que¡mª
->
shÜt_desü
.
	`em±y
() ? "the questmistress" : questman->short_descr));

314 ià(!
ch
->
pcd©a
->
sque¡mobf
 && ch->pcd©a->
sque¡objf
) {

315 
	`±c
(
ch
, "You must„eturnhe %so %s.\n",

316 
ch
->
pcd©a
->
sque¡obj
->
shÜt_desü
, ch->pcd©a->
sque¡mob
->short_descr);

317 
	`±c
(
ch
, "%s can usually be found in %s{x,\n",

318 
	`GET_ATTR_SEX
(
ch
->
pcd©a
->
sque¡mob
è=ğ1 ? "He" : "She", 
que¡room_mob
->
	`Çme
());

319 
	`±c
(
ch
, "šh¬— knowÀa %s{x.\n", 
que¡room_mob
->
	`¬—
().
Çme
);

323 
	`±c
(
ch
, "You‡» oÀ¨que¡Ø»cov”hËg’d¬y %s,\n", ch->
pcd©a
->
sque¡obj
->
shÜt_desü
);

324 
	`±c
(
ch
, "äom %s{x, iÀth¬— knowÀa %s{x,\n", 
que¡room_obj
->
	`Çme
(), que¡room_obj->
	`¬—
().
Çme
);

325 
	`±c
(
ch
, "ªd„‘uº iˆtØ™' rightfuÈowÃr, %s.\n", ch->
pcd©a
->
sque¡mob
->
shÜt_desü
);

326 
	`±c
(
ch
, "%s can usually be found in %s{x,\n",

327 
	`GET_ATTR_SEX
(
ch
->
pcd©a
->
sque¡mob
è=ğ1 ? "He" : "She", 
que¡room_mob
->
	`Çme
());

328 
	`±c
(
ch
, "šh¬— knowÀa %s{x.\n", 
que¡room_mob
->
	`¬—
().
Çme
);

330 
	}
}

332 
	$que¡_šfo
(
Ch¬aù”
 *
ch
)

334 
MobePrÙÙy³
 *
que¡mª
, *
que¡šfo
;

335 
ObjeùPrÙÙy³
 *
que¡šfoobj
;

337 ià(!
	`IS_QUESTOR
(
ch
)) {

338 
	`¡c
("You‡»n'ˆcu¼’y oÀ¨que¡.\n", 
ch
);

342 ià(
ch
->
pcd©a
->
que¡_giv”
 < 1) {

343 
Loggšg
::
	`bugf
("QUEST INFO: que¡ giv” = %d", 
ch
->
pcd©a
->
que¡_giv”
);

344 
	`¡c
("Iˆ£em thque¡ma¡” d›d oàŞd‡gwa™šg fÜ you.\n", 
ch
);

345 
	`que¡_ş—nup
(
ch
);

349 
que¡mª
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
ch
->
pcd©a
->
que¡_giv”
);

351 ià(
que¡mª
 =ğ
nuÎ±r
) {

352 
Loggšg
::
	`bugf
("QUEST INFO: que¡ giv” %d ha nØMobePrÙÙy³!", 
ch
->
pcd©a
->
que¡_giv”
);

353 
	`¡c
("Thque¡ma¡” ha çÎ’ v”y iÎ. PËa£ cÚù‡Àimm!\n", 
ch
);

354 
	`que¡_ş—nup
(
ch
);

358 ià(
ch
->
pcd©a
->
que¡mob
 == -1) {

359 
	`¡c
("You¸que¡ i ALMOST com¶‘e!\n", 
ch
);

360 
	`±c
(
ch
, "Get backo %s before yourime„uns out!\n",

361 (
que¡mª
->
shÜt_desü
.
	`em±y
() ? "your quest master" : questman->short_descr));

364 ià(
ch
->
pcd©a
->
que¡obj
 > 0) {

365 
que¡šfoobj
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
ch
->
pcd©a
->
que¡obj
);

367 ià(
que¡šfoobj
 !ğ
nuÎ±r
) {

368 
	`¡c
("You„eÿÎhque¡ whichhque¡ma¡” gavyou.\n", 
ch
);

369 
	`±c
(
ch
, "You‡» oÀ¨que¡Ø»cov”hçbËd %s!\n", 
que¡šfoobj
->
Çme
);

370 
	`que¡_wh”e
(
ch
, "treasure");

375 
Loggšg
::
	`bugf
("NØšfØfÜ que¡ objeù %d", 
ch
->
pcd©a
->
que¡obj
);

376 
	`que¡_ş—nup
(
ch
);

379 ià(
ch
->
pcd©a
->
que¡mob
 > 0) {

380 
que¡šfo
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
ch
->
pcd©a
->
que¡mob
);

382 ià(
que¡šfo
 !ğ
nuÎ±r
) {

383 
	`±c
(
ch
, "You‡» oÀ¨que¡Ø¦ayhd»aded %s!\n", 
que¡šfo
->
shÜt_desü
);

384 
	`que¡_wh”e
(
ch
, "fiend");

389 
Loggšg
::
	`bugf
("NØšfØfÜ que¡ mob %d", 
ch
->
pcd©a
->
que¡mob
);

390 
	`que¡_ş—nup
(
ch
);

395 
Loggšg
::
	`bug
("QUEST INFO: Questor with‚o kill, mob or obj", 0);

397 
	}
}

399 
	gskl
::
ty³
 
	$g‘_¿ndom_skl
(
Ch¬aù”
 *
ch
)

401 
couÁ
;

402 
skl
::
ty³
 
¢
;

403 
·ss
 = 1;

404 
rg‘
 = 0;

407 
·ss
 != 0) {

408 
couÁ
 = 0;

410 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

411 
¢
 = 
·œ
.
fœ¡
;

413 ià(
	`g‘_skl_Ëv–
(
ch
, 
¢
) <= 0

414 || 
	`g‘_skl_Ëv–
(
ch
, 
¢
) >= 100)

417 cÚ¡‡utØ&
’Œy
 = 
·œ
.
£cÚd
;

419 ià(
’Œy
.
»mÜt_gud
 !ğ
Gud
::
nÚe
 && !
	`CAN_USE_RSKILL
(
ch
, 
¢
))

422 ià(
	`g‘_u§bË_Ëv–
(
¢
, 
ch
->
gud
è> ch->
Ëv–
)

425 ià(
·ss
 =ğ2 && 
couÁ
 =ğ
rg‘
) {

426 
·ss
 = 0;

430 
couÁ
++;

433 ià(
couÁ
 == 0) {

434 
·ss
 = 0;

435 
¢
 = 
skl
::
ty³
::
unknown
;

438 ià(
·ss
 != 0) {

439 
rg‘
 = 
	`numb”_¿nge
(0, 
couÁ
-1);

440 
·ss
 = 2;

444  
¢
;

445 
	}
}

447 
	$sque¡obj_to_sque¡mob
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, Ch¬aù” *
mob
)

449 
SŒšg
 
buf
;

450 
	`check_socŸl
(
mob
, "b—m", 
ch
->
Çme
);

451 
buf
 = 
FÜm©
::
	`fÜm©
("Thªk you, %s, fÜ„‘uºšg my†o¡ %s!", 
ch
->
Çme
, 
obj
->
shÜt_desü
);

452 
	`do_§y
(
mob
, 
buf
);

453 
	`exŒaù_obj
(
obj
);

454 
	`do_§y
(
mob
, "I†efthe gold„eward withhe Questmistress. Farewell,‡ndhank you!");

455 
	`aù
("$Àtuº ªd w®k away.", 
mob
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

456 
	`¡c
("{YYou hav®mo¡ com¶‘ed you¸{VSKILL QUEST!{x\n", 
ch
);

457 
	`¡c
("{YR‘uºØthque¡ma¡” befÜyou¸timrun out!{x\n", 
ch
);

458 
buf
 = 
FÜm©
::
	`fÜm©
("{Y:SKILL QUEST: {x$N ha »tuºed % tØ%s", 
obj
->
shÜt_desü
, 
mob
->short_descr);

459 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

460 
	`exŒaù_ch¬
(
mob
, 
Œue
);

461 
ch
->
pcd©a
->
sque¡mobf
 = 
Œue
;

462 
	}
}

464 
	$sque¡mob_found
(
Ch¬aù”
 *
ch
, Ch¬aù” *
mob
)

466 ià(
ch
->
pcd©a
->
sque¡mobf
) {

467 
Loggšg
::
	`bug
("At squestmob_found,…layer's squestmob‡lready found. Continuing...", 0);

468 
ch
->
pcd©a
->
sque¡mobf
 = 
çl£
;

471 ià(
mob
->
aù_æags
.
	`has
(
ACT_MAGE
)) {

472 
	`numb”_¿nge
(1, 1)) {

474 
	`do_§y
(
mob
, "Greetings, young spellcaster!");

475 
	`do_§y
(
mob
, "I willeach you‡bout magic in it's most basic form.");

476 
	`do_§y
(
mob
, "It is importanto concentrate on clearlyƒnvisioning\n"

481 
	`aù
("$N†—d youhrough somsim¶ex”ci£ tØş—¸you¸mšd,", 
ch
, 
nuÎ±r
, 
mob
, 
TO_CHAR
);

482 
	`aù
("th’ h–p youØvisu®izthab¡¿ù†ogiø»quœedØfÜm", 
ch
, 
nuÎ±r
, 
mob
, 
TO_CHAR
);

483 
	`aù
("¨fœeb®l.", 
ch
, 
nuÎ±r
, 
mob
, 
TO_CHAR
);

484 
	`aù
("$Nouche ¨fšg”Ø$n' h—d,‡nd $look mÜ»Ïxed.", 
ch
, 
nuÎ±r
, 
mob
, 
TO_NOTVICT
);

485 
	`do_§y
(
mob
, "Any mage can cast‡ simple fireball. But‡rue student of\n"

487 
	`aù
("IÀyou¸mšd,hfœeb®È¡¬t tØglow brigh‹r, it' cŞÜ", 
ch
, 
nuÎ±r
, 
mob
, 
TO_CHAR
);

488 
	`aù
("tuºšgØ¨soá g»’.", 
ch
, 
nuÎ±r
, 
mob
, 
TO_CHAR
);

489 
	`aù
("B—d oàsw—ˆ¡¬ˆtØruÀdowÀ$n' fÜeh—d‡ $cÚûÁ¿‹s.", 
ch
, 
nuÎ±r
, 
mob
, 
TO_NOTVICT
);

490 
	`do_§y
(
mob
, "Theruly great magicians striveo make spellsheir own.");

491 
	`aù
("Thfœeb®Èš you¸mšd fades.", 
ch
, 
nuÎ±r
, 
mob
, 
TO_CHAR
);

492 
	`aù
("$Àİ’ $ eyes.", 
ch
, 
nuÎ±r
, 
mob
, 
TO_NOTVICT
);

496 ià(
mob
->
aù_æags
.
	`has
(
ACT_CLERIC
)) {

497 
	`numb”_¿nge
(1, 1)) {

499 
	`aù
("$N sme w¬mly‡ˆ$n.", 
ch
, 
nuÎ±r
, 
mob
, 
TO_NOTVICT
);

500 
	`aù
("$N sme w¬mly‡ˆyou.", 
ch
, 
nuÎ±r
, 
mob
, 
TO_CHAR
);

501 
	`do_§y
(
mob
, "Persons of‡ godly…rofession‡ct inheir deity's‚ame.");

502 
	`do_§y
(
mob
, "One cannot‡lways knowheir deity'sruehoughts‡nd\n"

504 
	`do_§y
(
mob
, "Will your deity be…leased with your‡ctions? You can\n"

506 
	`do_§y
(
mob
, "But, whilst you‡ct in good faith, you will‚ever be\n"

511 ià(
mob
->
aù_æags
.
	`has
(
ACT_THIEF
)) {

512 
	`numb”_¿nge
(1, 1)) {

514 
	`±c
(
ch
, "You f“È¨°Ú you¸should”,‡nduºØ£%s.\n", 
mob
->
shÜt_desü
);

515 
	`do_§y
(
mob
, "Many…eopleƒxpress distaste‡the†ife of‡†owly…ickpocket.");

516 
	`do_§y
(
mob
, "But, few occupations„equire such skill, dexterity,‡nd daring.");

517 
	`aù
("$À¡¬t štØ¨lÚg mÚŞogud‘ašgh‘hic oàtheá fÜ‡†ivšg.", 
mob
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

518 
	`do_§y
(
mob
, "Is it„ighto steal? I'll†et you decide for yourself,‚o one\n"

520 
	`aù
("$N hªd $À$ gŞd…ouch,‡nd wšks.", 
ch
, 
nuÎ±r
, 
mob
, 
TO_NOTVICT
);

521 
	`aù
("$N hªd you you¸gŞd…ouch,‡nd wšks.", 
ch
, 
nuÎ±r
, 
mob
, 
TO_CHAR
);

526 
	`numb”_¿nge
(1, 2)) {

528 
	`aù
("$Àd¿w $ bÏdªd…Ïû ™ ov” $ should”.", 
mob
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

529 
	`do_§y
(
mob
, "The blade is ofhe most…owerful of weapons.");

530 
	`do_§y
(
mob
, "It can be used for close combat, distanced,‡nd defense.");

531 
	`aù
("$Àke ¨fightšg snû,„aisšg $ bÏdštØthaœ.", 
mob
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

532 
	`do_§y
(
mob
, "In one fluid movement one can overcome‡n untrained oppenent.");

533 
	`aù
("$n whirlshe blade down swiftly,…ulls it back up into\n"

534 "haœ‡nd sliû dowÀagaš.", 
mob
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

535 
	`do_§y
(
mob
, "A blade can be used for good, or forƒvil.");

536 
	`aù
("$ÀpuÎ thbÏdback u°ªd slide ™ iÁØ™ sh—th.", 
mob
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

537 
	`do_§y
(
mob
, "But its‚othe blade who decides...");

541 
	`aù
("$N d¿w $S bÏdªd mÙiÚ tow¬d $n.", 
ch
, 
nuÎ±r
, 
mob
, 
TO_NOTVICT
);

542 
	`aù
("$N d¿w $S bÏdªd mÙiÚ tow¬d you.", 
ch
, 
nuÎ±r
, 
mob
, 
TO_CHAR
);

543 
	`do_§y
(
mob
, "A blade isrue, unyeilding,‡nd unstoppable.");

544 
	`do_§y
(
mob
, "It can be usedo…rotect,o defend,o destroy,o disarm.");

545 
	`aù
("$N…os™iÚ $S bÏdtØpošˆtow¬d $n.", 
ch
, 
nuÎ±r
, 
mob
, 
TO_NOTVICT
);

546 
	`aù
("$N…os™iÚ $S bÏdtØpošˆtow¬d you.", 
ch
, 
nuÎ±r
, 
mob
, 
TO_CHAR
);

547 
	`do_§y
(
mob
, "The soul of‡ blade is within you,‡nd only by your hand can it be‡wakened.");

552 
	`aù
("$Àtuº ªd w®k away.", 
mob
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

553 
	`¡c
("{YYou hav®mo¡ com¶‘ed you¸{VSKILL QUEST!{x\n", 
ch
);

554 
	`¡c
("{YR‘uºØthque¡ma¡” befÜyou¸timrun out!{x\n", 
ch
);

555 
SŒšg
 
buf
 = 
FÜm©
::
	`fÜm©
("{Y:SKILL QUEST: {x$N ha ¥ok’ w™h %s", 
mob
->
shÜt_desü
);

556 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

557 
	`exŒaù_ch¬
(
mob
, 
Œue
);

558 
ch
->
pcd©a
->
sque¡mobf
 = 
Œue
;

559 
	}
}

561 
Objeù
 *
	$g’”©e_sklque¡_obj
(
Ch¬aù”
 *
ch
, 
Ëv–
)

563 
ExŒaDesü
 *
ed
;

564 
Objeù
 *
que¡obj
;

565 
num_objs
, 
desúum
;

566 
	ssq_™em_ty³
 {

567 *
Çme
;

568 *
shÜtdesc
;

569 *
lÚgdesc
;

570 *
ex‹nded
;

572 cÚ¡ 
sq_™em_ty³
 
sq_™em_bË
 [] = {

597 {
nuÎ±r
,‚ullptr,‚ullptr,‚ullptr}

601 
num_objs
 = 0; 
sq_™em_bË
[num_objs].
Çme
 !ğ
nuÎ±r
;‚um_objs++);

603 
num_objs
--;

604 
desúum
 = 
	`numb”_¿nge
(0, 
num_objs
);

605 
que¡obj
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_SQUESTOBJ
), 
Ëv–
);

607 ià(! 
que¡obj
) {

608 
Loggšg
::
	`bug
("Memoryƒrror creating quest object.", 0);

609  
nuÎ±r
;

612 
que¡obj
->
tim”
 = (4 * 
ch
->
pcd©a
->
sqcouÁdown
 + 10) / 3;

613 
SŒšg
 
buf
 = 
FÜm©
::
	`fÜm©
("% %s", 
sq_™em_bË
[
desúum
].
Çme
, 
ch
->name);

614 
que¡obj
->
Çme
 = 
buf
;

615 
que¡obj
->
shÜt_desü
 = 
sq_™em_bË
[
desúum
].
shÜtdesc
;

616 
que¡obj
->
desütiÚ
 = 
sq_™em_bË
[
desúum
].
lÚgdesc
;

617 
ed
 = 
Ãw
 
	`ExŒaDesü
(

618 
sq_™em_bË
[
desúum
].
Çme
,

619 
sq_™em_bË
[
desúum
].
ex‹nded


621 
ed
->
Ãxt
 = 
que¡obj
->
exŒa_desü
;

622 
que¡obj
->
exŒa_desü
 = 
ed
;

623 
ch
->
pcd©a
->
sque¡obj
 = 
que¡obj
;

624  
que¡obj
;

625 
	}
}

627 
Room
 *
	$g’”©e_sklque¡_room
(
Ch¬aù”
 *
ch
, 
Ëv–
)

629 
pick
 = 0, 
·ss
 = 1;

631 
·ss
 <= 2) {

632 
couÁ
 = 0;

634 auto& 
¬—_·œ
 : 
Game
::
	`wÜld
().
¬—s
) {

635 auto& 
’Œy
 : 
¬—_·œ
.
£cÚd
->
rooms
) {

637 
Room
 *
room
 = 
’Œy
.
£cÚd
;

639 ià(
room
 =ğ
nuÎ±r


640 || !
	`ÿn_£e_room
(
ch
, 
room
)

641 || 
room
->
	`¬—
().
»giÚ
 !ğ
nuÎ±r


642 || 
room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()

643 || 
room
->
	`¬—
().
low_¿nge
 > 
Ëv–


644 || 
room
->
	`¬—
().
high_¿nge
 < 
Ëv–


645 || (
room
->
	`¬—
().
mš_vnum
 >= 24000

646 && 
room
->
	`¬—
().
mš_vnum
 <= 26999)

647 || 
room
->
	`gud
(è!ğ
Gud
::
nÚe


648 || 
room
->
	`¬—
().
Çme
 == "Playpen"

649 || 
room
->
	`¬—
().
Çme
 == "IMM-Zone"

650 || 
room
->
	`¬—
().
Çme
 == "Limbo"

651 || 
room
->
	`¬—
().
Çme
 == "Midgaard"

652 || 
room
->
	`¬—
().
Çme
 == "New Thalos"

653 || 
room
->
	`¬—
().
Çme
 == "Eilyndrae"

654 || 
room
->
	`¬—
().
Çme
 == "Torayna Cri"

655 || 
room
->
	`¬—
().
Çme
 == "The Abyss"

656 || 
room
->
	`¬—
().
Çme
 == "Battle Arenas"

657 || 
room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


658 || 
room
->
	`æags
().
	`has_ªy_of
(

659 
ROOM_MALE_ONLY


660 | 
ROOM_FEMALE_ONLY


661 | 
ROOM_PRIVATE


662 | 
ROOM_SOLITARY


663 | 
ROOM_NOQUEST
))

667 
Room
 *
´ev
;

668 ià((
´ev
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
room
->
´ÙÙy³
.
vnum
.
	`v®ue
(è- 1)))è!ğ
nuÎ±r
)

669 ià(
´ev
->
	`æags
().
	`has
(
ROOM_PET_SHOP
))

672 ià(
·ss
 =ğ2 && 
couÁ
 =ğ
pick
)

673  
room
;

675 
couÁ
++;

679 ià(
·ss
++ =ğ2 || 
couÁ
 == 0)

682 
pick
 = 
	`numb”_¿nge
(0, 
couÁ
-1);

685  
nuÎ±r
;

686 
	}
}

688 
	$g’”©e_sklque¡_mob
(
Ch¬aù”
 *
ch
, Ch¬aù” *
que¡mª
, 
Ëv–
, 
ty³
)

690 
Objeù
 *
que¡obj
;

691 
Ch¬aù”
 *
que¡mob
;

692 
Room
 *
que¡room
;

693 
x
;

694 
SŒšg
 
t™Ë
;

695 
SŒšg
 
que¡
;

696 
SŒšg
 
shÜtdesc
;

698 ià((
que¡mob
 = 
	`ü—‹_mobe
(
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
MOB_VNUM_SQUESTMOB
))è=ğ
nuÎ±r
) {

699 
Loggšg
::
	`bug
("Bad skillquest mob vnum, from generate_skillquest_mob", 0);

703 
	`ATTR_BASE
(
que¡mob
, 
APPLY_SEX
èğ
	`numb”_¿nge
(1, 2);

704 
que¡mob
->
Ëv–
 = 
ch
->level;

707 ià(
	`GET_ATTR_SEX
(
que¡mob
) == 1)

708 
shÜtdesc
 = 
FÜm©
::
	`fÜm©
("%s%s%s",

709 
Msyl1
[
	`numb”_¿nge
(0, (
MAXMSYL1
 - 1))],

710 
Msyl2
[
	`numb”_¿nge
(0, (
MAXMSYL2
 - 1))],

711 
Msyl3
[
	`numb”_¿nge
(0, (
MAXMSYL3
 - 1))]);

713 
shÜtdesc
 = 
FÜm©
::
	`fÜm©
("%s%s%s",

714 
Fsyl1
[
	`numb”_¿nge
(0, (
MAXFSYL1
 - 1))],

715 
Fsyl2
[
	`numb”_¿nge
(0, (
MAXFSYL2
 - 1))],

716 
Fsyl3
[
	`numb”_¿nge
(0, (
MAXFSYL3
 - 1))]);

718 
que¡mob
->
Çme
 = 
FÜm©
::
	`fÜm©
("sque¡mob %s", 
shÜtdesc
);

719 
que¡mob
->
shÜt_desü
 = 
shÜtdesc
;

722 
	`numb”_¿nge
(1, 4)) {

724 
x
 = 
	`numb”_¿nge
(0, 
MagT_bË
.
	`size
()-1);

725 
t™Ë
 = 
	`GET_ATTR_SEX
(
que¡mob
è=ğ1 ? 
MagT_bË
[
x
].
m®e
 : MagT_bË[x].
ãm®e
;

726 
que¡
 = "the…owers of magic";

727 
que¡mob
->
aù_æags
 +ğ
ACT_MAGE
;

731 
x
 = 
	`numb”_¿nge
(0, 
CËT_bË
.
	`size
()-1);

732 
t™Ë
 = 
	`GET_ATTR_SEX
(
que¡mob
è=ğ1 ? 
CËT_bË
[
x
].
m®e
 : CËT_bË[x].
ãm®e
;

733 
que¡
 = "the wisdom of holiness";

734 
que¡mob
->
aù_æags
 +ğ
ACT_CLERIC
;

738 
x
 = 
	`numb”_¿nge
(0, 
ThiT_bË
.
	`size
()-1);

739 
t™Ë
 = 
	`GET_ATTR_SEX
(
que¡mob
è=ğ1 ? 
ThiT_bË
[
x
].
m®e
 : ThiT_bË[x].
ãm®e
;

740 
que¡
 = "the‡rt ofhievery";

741 
que¡mob
->
aù_æags
 +ğ
ACT_THIEF
;

745 
x
 = 
	`numb”_¿nge
(0, 
W¬T_bË
.
	`size
()-1);

746 
t™Ë
 = 
	`GET_ATTR_SEX
(
que¡mob
è=ğ1 ? 
W¬T_bË
[
x
].
m®e
 : W¬T_bË[x].
ãm®e
;

747 
que¡
 = "the ways of weaponcraft";

748 
que¡mob
->
aù_æags
 +ğ
ACT_WARRIOR
;

752 
que¡mob
->
lÚg_desü
 = 
FÜm©
::
	`fÜm©
("Th%s, %s, snd h”e.\n", 
t™Ë
, que¡mob->
shÜt_desü
);

754 ià((
que¡room
 = 
	`g’”©e_sklque¡_room
(
ch
, 
Ëv–
)è=ğ
nuÎ±r
) {

755 
Loggšg
::
	`bug
("Bad generate_skillquest_room, from generate_skillquest_mob", 0);

759 
	`ch¬_to_room
(
que¡mob
, 
que¡room
);

760 
ch
->
pcd©a
->
sque¡mob
 = 
que¡mob
;

762 ià(
ty³
 == 1) {

763 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("S“k ouˆth%s, %s, fÜ—chšg š %s!", 
t™Ë
, 
que¡mob
->
shÜt_desü
, 
que¡
));

764 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("% »side somewh”šh¬— oà%s{x,", 
que¡mob
->
shÜt_desü
, que¡mob->
š_room
->
	`¬—
().
Çme
));

765 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("ªd cª usu®ly bfound iÀ%s{x.", 
que¡mob
->
š_room
->
	`Çme
()));

767 ià(
ty³
 == 2) {

768 ià((
que¡obj
 = 
	`g’”©e_sklque¡_obj
(
ch
, 
Ëv–
)è=ğ
nuÎ±r
) {

769 
Loggšg
::
	`bug
(" Bad generate_skillquest_obj, from generate_skillquest_mob", 0);

774 ià((
que¡room
 = 
	`g’”©e_sklque¡_room
(
ch
, 
Ëv–
)è=ğ
nuÎ±r
) {

775 
Loggšg
::
	`bug
("Bad generate_skillquest_room, from generate_skillquest_mob", 0);

779 ià(
que¡room
->
	`¬—
(è=ğ
que¡mob
->
š_room
->area())

782 
	`obj_to_room
(
que¡obj
, 
que¡room
);

786 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("The %s %s{x has„eported missinghe†egendary‡rtifact,",

787 
t™Ë
, 
que¡mob
->
shÜt_desü
));

788 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("the %s{x! %s{x„esides somewhere in %s{x,",

789 
que¡obj
->
shÜt_desü
, 
que¡mob
->shÜt_desü, que¡mob->
š_room
->
	`¬—
().
Çme
));

790 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("ªd cª usu®ly bfound iÀ%s{x.", 
que¡mob
->
š_room
->
	`Çme
()));

791 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("%s†ast„ecallsravellinghrough %s{x, inhe",

792 
	`GET_ATTR_SEX
(
que¡mob
è=ğ1 ? "He" : "She", 
que¡obj
->
š_room
->
	`Çme
()));

793 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("area of %s{x, when %s†osthereasure.",

794 
que¡obj
->
š_room
->
	`¬—
().
Çme
, 
	`GET_ATTR_SEX
(
que¡mob
) == 1 ? "he" : "she"));

796 
	}
}

798 
	$g’”©e_sklque¡
(
Ch¬aù”
 *
ch
, Ch¬aù” *
que¡mª
)

800 
Objeù
 *
que¡obj
;

801 
Room
 *
que¡room
;

803 
Ëv–
 = 
	`URANGE
(1, 
ch
->Ëv–, 
LEVEL_HERO
);

804 
ch
->
pcd©a
->
sqcouÁdown
 = 
	`numb”_¿nge
(15, 30);

805 
ch
->
pcd©a
->
sque¡_giv”
 = 
que¡mª
->
pIndexD©a
->
vnum
;

808 ià(
	`rŞl_chªû
(40)) {

809 ià((
que¡obj
 = 
	`g’”©e_sklque¡_obj
(
ch
, 
Ëv–
)è=ğ
nuÎ±r
) {

810 
Loggšg
::
	`bug
("Bad generate_skillquest_obj, from generate_skillquest", 0);

814 ià((
que¡room
 = 
	`g’”©e_sklque¡_room
(
ch
, 
Ëv–
)è=ğ
nuÎ±r
) {

815 
Loggšg
::
	`bug
("Bad generate_skillquest_room, from generate_skillquest", 0);

819 
	`obj_to_room
(
que¡obj
, 
que¡room
);

820 
ch
->
pcd©a
->
sque¡loc1
 = 
que¡room
->
loÿtiÚ
;

821 
ch
->
pcd©a
->
sque¡obj
 = 
que¡obj
;

822 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("ThËg’d¬y‡¹içù,h%s{x, ha b“À»pÜ‹d stŞ’!", 
que¡obj
->
shÜt_desü
));

823 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("Thth›ve w”£’ h—dšg iÀthdœeùiÚ oà%s{x,", 
que¡room
->
	`¬—
().
Çme
));

824 
	`do_§y
(
que¡mª
, "and witnesses inhat‡rea sayhatheyravelled");

825 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("through %s{x.", 
que¡room
->
	`Çme
()));

829 ià(
	`rŞl_chªû
(66)) {

830 
	`g’”©e_sklque¡_mob
(
ch
, 
que¡mª
, 
Ëv–
, 1);

831 
ch
->
pcd©a
->
sque¡loc2
 = ch->pcd©a->
sque¡mob
->
š_room
->
loÿtiÚ
;

835 
	`g’”©e_sklque¡_mob
(
ch
, 
que¡mª
, 
Ëv–
, 2);

836 
ch
->
pcd©a
->
sque¡loc1
 = ch->pcd©a->
sque¡obj
->
š_room
->
loÿtiÚ
;

837 
ch
->
pcd©a
->
sque¡loc2
 = ch->pcd©a->
sque¡mob
->
š_room
->
loÿtiÚ
;

839 
	}
}

841 
	$g’”©e_que¡
(
Ch¬aù”
 *
ch
, Ch¬aù” *
que¡mª
)

843 
Ch¬aù”
 *
viùim
;

844 
Room
 *
room
;

845 
Objeù
 *
que¡™em
;

855 
®igÃd
;

856 
tÙ®
;

857 
·ss
;

858 
rg‘
 = 0;

865 
·ss
 = 1;

867 
·ss
 != 0) {

868 
®igÃd
 = 0;

869 
tÙ®
 = 0;

871 autØ
vch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

872 ià(!
vch
->
	`is_Åc
()

873 || 
vch
->
pIndexD©a
 =ğ
nuÎ±r


874 || 
vch
->
š_room
 =ğ
nuÎ±r


875 || 
vch
->
pIndexD©a
->
pShİ
 !ğ
nuÎ±r


876 || 
vch
->
aù_æags
.
	`has
(
ACT_NOSUMMON
)

877 || 
vch
->
aù_æags
.
	`has
(
ACT_PET
)

878 || !
	`¡rcmp
(
vch
->
š_room
->
	`¬—
().
Çme
, "Playpen")

879 || 
vch
->
š_room
->
	`¬—
().
»giÚ
 !ğ
nuÎ±r


880 || 
vch
->
š_room
->
	`şª
()

881 || 
afãù
::
	`exi¡s_Ú_ch¬
(
vch
,‡fãù::
ty³
::
ch¬m_³rsÚ
)

882 || 
vch
->
š_room
->
	`æags
().
	`has_ªy_of
(
ROOM_PRIVATE
 | 
ROOM_SOLITARY
)

883 || 
vch
->
š_room
->
	`æags
().
	`has_ªy_of
(
ROOM_SAFE
 | 
ROOM_MALE_ONLY
 | 
ROOM_FEMALE_ONLY
)

884 || 
	`que¡_Ëv–_diff
(
ch
->
Ëv–
, 
vch
->Ëv–è!ğ
Œue
)

887 
viùim
 = 
vch
;

890 
tÙ®
++;

892 ià(
	`IS_NEUTRAL
(
ch
)

893 || (
	`IS_GOOD
(
ch
è&& !IS_GOOD(
viùim
))

894 || (
	`IS_EVIL
(
ch
è&& !IS_EVIL(
viùim
)))

895 
®igÃd
++;

897 ià((
·ss
 =ğ2 && 
®igÃd
 =ğ
rg‘
)

898 || (
·ss
 =ğ3 && 
tÙ®
 =ğ
rg‘
)) {

899 
·ss
 = 0;

905 ià(
·ss
 == 1) {

906 ià(
®igÃd
 > 0) {

907 
rg‘
 = 
	`numb”_¿nge
(1, 
®igÃd
);

908 
·ss
 = 2;

910 ià(
tÙ®
 > 0) {

911 
rg‘
 = 
	`numb”_¿nge
(1, 
tÙ®
);

912 
·ss
 = 3;

916 
viùim
 = 
nuÎ±r
;

922 ià(
viùim
 =ğ
nuÎ±r
) {

923 
	`do_§y
(
que¡mª
, "I'm sorry, but I don't have‡ny quests for you‡thisime.");

924 
	`do_§y
(
que¡mª
, "Try‡gain†ater.");

925 
ch
->
pcd©a
->
Ãxtque¡
 = 1;

930 
room
 = 
viùim
->
š_room
;

931 
ch
->
pcd©a
->
que¡_giv”
 = 
que¡mª
->
pIndexD©a
->
vnum
;

932 
ch
->
pcd©a
->
que¡loc
 = 
room
->
loÿtiÚ
;

935 ià(
	`rŞl_chªû
(40)) {

936 
objvnum
 = 0;

938 
	`numb”_¿nge
(0, 4)) {

939 0: 
objvnum
 = 
QUEST_OBJQUEST1
; ;

941 1: 
objvnum
 = 
QUEST_OBJQUEST2
; ;

943 2: 
objvnum
 = 
QUEST_OBJQUEST3
; ;

945 3: 
objvnum
 = 
QUEST_OBJQUEST4
; ;

947 4: 
objvnum
 = 
QUEST_OBJQUEST5
; ;

950 
que¡™em
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
objvnum
), 
ch
->
Ëv–
);

952 ià(! 
que¡™em
) {

953 
Loggšg
::
	`bug
("Error creating quest item.", 0);

958 
que¡™em
->
Çme
 = 
FÜm©
::
	`fÜm©
("% %s", que¡™em->Çme, 
ch
->name);

963 
ch
->
pcd©a
->
couÁdown
 = 
	`numb”_¿nge
(10, 30);

964 
que¡™em
->
tim”
 = (4 * 
ch
->
pcd©a
->
couÁdown
 + 10) / 3;

965 
	`obj_to_room
(
que¡™em
, 
room
);

966 
ch
->
pcd©a
->
que¡obj
 = 
que¡™em
->
pIndexD©a
->
vnum
;

967 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("Vpã»r hav¡Ş’ % äomhroy®»asury!", 
que¡™em
->
shÜt_desü
));

968 
	`do_§y
(
que¡mª
, "My court wizardess, with her magic mirror, has…inpointed its†ocation.");

969 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("Look iÀthg’”®‡»¨oà% fÜ %s!", 
room
->
	`¬—
().
Çme
,„oom->
	`Çme
()));

974 
	`numb”_¿nge
(0, 3)) {

976 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("Anƒnemy of mine, %s, is making vilehreats‡gainsthe crown.",

977 
viùim
->
shÜt_desü
));

978 
	`do_§y
(
que¡mª
, "Thishreat must beƒliminated!");

982 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("Thera's most heinous criminal, %s, hasƒscaped fromhe dungeon!",

983 
viùim
->
shÜt_desü
));

984 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("Sinceheƒscape, %s has murdered %d civilians!",

985 
viùim
->
shÜt_desü
, 
	`numb”_¿nge
(2, 20)));

986 
	`do_§y
(
que¡mª
, "The…enalty forhis crime is death,‡nd you‡reo deliverhe sentence!");

990 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("The Mayor of Midgaard has„ecently been‡ttacked by %s. This is‡n‡ct of war!",

991 
viùim
->
shÜt_desü
));

992 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("%s must be severly dealt with forhis injustice.",

993 
viùim
->
shÜt_desü
));

997 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("%s has been stealing valuables fromhe citizens of Solace.",

998 
viùim
->
shÜt_desü
));

999 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("Make surehat %s‚ever hashe chanceo steal‡gain.",

1000 
viùim
->
shÜt_desü
));

1004 ià(!
room
->
	`Çme
().
	`em±y
()) {

1005 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("Seek %s out somewhere inhe vicinity of %s!",

1006 
viùim
->
shÜt_desü
, 
room
->
	`Çme
()));

1007 
	`do_§y
(
que¡mª
, 
FÜm©
::
	`fÜm©
("Th©†oÿtiÚ i šhg’”®‡»¨oà%s.", 
room
->
	`¬—
().
Çme
));

1010 
ch
->
pcd©a
->
couÁdown
 = 
	`numb”_¿nge
(10, 30);

1011 
ch
->
pcd©a
->
que¡mob
 = 
viùim
->
pIndexD©a
->
vnum
;

1013 
	}
}

1016 
	$do_que¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1018 
Ch¬aù”
 *
que¡mª
;

1019 
SŒšg
 
buf
;

1021 ià(
ch
->
	`is_Åc
()) {

1022 
	`do_§y
(
ch
, "Don't be silly, mobs can't quest!");

1026 
SŒšg
 
¬g1
;

1027 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

1029 ià(
¬g1
.
	`em±y
()) {

1030 
	`que¡_u§ge
(
ch
);

1040 ià(
	`IS_IMP
(
ch
è&& 
¬g1
.
	`is_´efix_of
("award")) {

1041 
numb”
 = -1;

1042 
Ch¬aù”
 *
wch
;

1043 
DesütÜ
 *
d
;

1045 
SŒšg
 
¶ay”
;

1046 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¶ay”
);

1048 ià(
¶ay”
.
	`em±y
()) {

1049 
	`¡c
("Que¡‡w¬dØwhom?\n", 
ch
);

1053 
wch
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¶ay”
, 
VIS_PLR
);

1055 ià(
wch
 =ğ
nuÎ±r
 && !
¶ay”
.
	`has_´efix
("allchars")) {

1056 
	`±c
(
ch
, "You fšd‚Ø¶ay”‚amed '%s' iÀthgame!\n", 
¶ay”
);

1060 ià(!
¬gum’t
.
	`em±y
())

1061 
numb”
 = 
	`©oi
(
¬gum’t
);

1063 ià(
numb”
 < 0 ||‚umber > 10) {

1064 
	`±c
(
ch
, "Aw¬d % how mªy que¡…ošt (0..10è?\n", 
wch
->
Çme
);

1068 ià(
¶ay”
.
	`has_´efix
("allchars")) {

1069 
d
 = 
desütÜ_li¡
; d; d = d->
Ãxt
) {

1070 ià(
d
->
	`is_¶ayšg
(è&& !
	`IS_IMMORTAL
(d->
ch¬aù”
è&& !d->ch¬aù”->
	`is_Åc
()) {

1071 
d
->
ch¬aù”
->
pcd©a
->
que¡pošts
 +ğ
numb”
;

1072 
	`±c
(
ch
, "You‡w¬d % %d que¡pošts.\n", 
d
->
ch¬aù”
->
Çme
, 
numb”
);

1073 
	`±c
(
d
->
ch¬aù”
, "% ha aw¬ded you %d que¡pošts.\n", 
ch
->
Çme
, 
numb”
);

1077 
SŒšg
 
buf
 = 
FÜm©
::
	`fÜm©
("Log %s: QUEST AWARD‡Îch¬ %d", 
ch
->
Çme
, 
numb”
);

1078 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_SECURE
, 0, 
	`GET_RANK
(ch));

1079 
Loggšg
::
	`log
(
buf
);

1083 
wch
->
pcd©a
->
que¡pošts
 +ğ
numb”
;

1084 
	`±c
(
ch
, "You‡w¬d %d que¡…ošt tØ%s.\n", 
numb”
, 
wch
->
Çme
);

1085 
	`±c
(
wch
, "% aw¬d %d que¡…ošt tØyou.\n", 
ch
->
Çme
, 
numb”
);

1086 
buf
 = 
FÜm©
::
	`fÜm©
("Log %s: QUEST AWARD %dØ%s", 
ch
->
Çme
, 
numb”
, 
¶ay”
);

1087 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_SECURE
, 0, 
	`GET_RANK
(ch));

1088 
Loggšg
::
	`log
(
buf
);

1093 ià(
¬g1
.
	`is_´efix_of
("complete")) {

1094 
Objeù
 *
obj
 = 
nuÎ±r
;

1096 ià(
	`g‘_pos™iÚ
(
ch
è< 
POS_RESTING
) {

1097 
	`¡c
("You‡»oØbusy sË•šg.\n", 
ch
);

1101 ià((
que¡mª
 = 
	`fšd_sque¡ma¡”
(
ch
)è!ğ
nuÎ±r
) {

1102 
	`aù
("$ÀšfÜm $N $ha com¶‘ed $ skÈque¡.", 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_ROOM
);

1103 
	`aù
("You infÜm $N you havcom¶‘ed you¸skÈque¡.", 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_CHAR
);

1105 ià(
ch
->
pcd©a
->
sque¡_giv”
 !ğ
que¡mª
->
pIndexD©a
->
vnum
) {

1106 
	`do_§y
(
que¡mª
, "I‚ever sent you on‡ skill quest! Perhaps you'rehinking of someoneƒlse.");

1110 ià(!
	`IS_SQUESTOR
(
ch
)) {

1111 
	`do_§y
(
que¡mª
, "But you‡ren't on‡ skill quest‡the moment!");

1112 
buf
 = 
FÜm©
::
	`fÜm©
("You havtØREQUEST‡ skÈque¡ fœ¡, %s.", 
ch
->
Çme
);

1113 
	`do_§y
(
que¡mª
, 
buf
);

1115 
	`sq_ş—nup
(
ch
);

1119 ià(
ch
->
pcd©a
->
Ãxtsque¡
 > 0 || ch->pcd©a->
sqcouÁdown
 <= 0) {

1120 
	`do_§y
(
que¡mª
, "But you didn't complete your skill quest inime!");

1122 
	`sq_ş—nup
(
ch
);

1127 ià(
ch
->
pcd©a
->
sque¡obj
 && !ch->pcd©a->
sque¡mob
) {

1128 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
) {

1129 ià(
obj
->
pIndexD©a
 =ğ
nuÎ±r
) {

1130 
Loggšg
::
	`bug
("SQUEST COMPLETE: obj with‚ullptr…IndexData", 0);

1131 
obj
 = 
nuÎ±r
;

1134 ià(
obj
 =ğ
ch
->
pcd©a
->
sque¡obj
)

1139 ià(
ch
->
pcd©a
->
sque¡objf
 && 
obj
 =ğ
nuÎ±r
) {

1140 
	`do_§y
(
que¡mª
, "You must have†osthe item onhe way here. Hurry‡nd find it!");

1141 
ch
->
pcd©a
->
sque¡objf
 = 
çl£
;

1146 ià(!
ch
->
pcd©a
->
sque¡objf
) {

1147 
	`do_§y
(
que¡mª
, "You haven't foundhe‡rtifact yet, buthere is stillime!");

1151 
	`aù
("You hªdh$°tØ$N.", 
ch
, 
obj
, 
que¡mª
, 
TO_CHAR
);

1152 
	`aù
("$Àhªd th$°tØ$N.", 
ch
, 
obj
, 
que¡mª
, 
TO_ROOM
);

1153 
	`exŒaù_obj
(
obj
);

1156 ià(
ch
->
pcd©a
->
sque¡mob
 && !ch->pcd©a->
sque¡obj
) {

1157 ià(!
ch
->
pcd©a
->
sque¡mobf
) {

1158 
buf
 = 
FÜm©
::
	`fÜm©
("You haven't spoken with %s yet! Come back when you have.",

1159 
ch
->
pcd©a
->
sque¡mob
->
shÜt_desü
);

1160 
	`do_§y
(
que¡mª
, 
buf
);

1165 ià(
ch
->
pcd©a
->
sque¡mob
 && ch->pcd©a->
sque¡obj
) {

1166 ià(
ch
->
pcd©a
->
sque¡objf
 && !ch->pcd©a->
sque¡mobf
) {

1167 
buf
 = 
FÜm©
::
	`fÜm©
("You must„eturnhe %so %s before you„eturn here.",

1168 
ch
->
pcd©a
->
sque¡obj
->
shÜt_desü
, ch->pcd©a->
sque¡mob
->short_descr);

1169 
	`do_§y
(
que¡mª
, 
buf
);

1173 ià(
ch
->
pcd©a
->
sque¡mobf
 && !ch->pcd©a->
sque¡objf
) {

1174 
Loggšg
::
	`bug
("SQuest mob found without object", 0);

1175 
	`do_§y
(
que¡mª
, "They must†ike you‡ great deal...");

1176 
	`sq_ş—nup
(
ch
);

1180 ià(!
ch
->
pcd©a
->
sque¡mobf
 && !ch->pcd©a->
sque¡objf
) {

1181 
	`do_§y
(
que¡mª
, "You haven't completed your quest yet, buthere is stillime!");

1186 
Loggšg
::
	`bug
("Skill quest‚ot found", 0);

1187 
	`sq_ş—nup
(
ch
);

1191 
pošŒew¬d
 = 
	`numb”_¿nge
(1, 10);

1194 
ch
->
pcd©a
->
Ãxtsque¡
 = 
pošŒew¬d
;

1196 ià(
Game
::
que¡_doubË
)

1197 
pošŒew¬d
 +ğ
	`numb”_¿nge
(0, 10);

1206 
pošŒew¬d
 +ğ
	`numb”_¿nge
(0, 
	`GET_ATTR
(
ch
, 
APPLY_SKILLPOINTS
));

1207 
gŞd»w¬d
 = 
	`numb”_¿nge
(
ch
->
Ëv–
 / 4, ch->level * 3 / 2) + 1;

1210 
	`do_§y
(
que¡mª
, "Congratulations on completing your skill quest!");

1211 
buf
 = 
FÜm©
::
	`fÜm©
("As‡„eward, I‡m giving you %d skill…oint%s‡nd %d gold.",

1212 
pošŒew¬d
, (pošŒew¬d =ğ1 ? "" : "s"), 
gŞd»w¬d
);

1213 
	`do_§y
(
que¡mª
, 
buf
);

1215 ià(!
ch
->
»voke_æags
.
	`has
(
REVOKE_EXP
)) {

1216 
xp
 = 
	`numb”_¿nge
(100, 300);

1217 
	`±c
(
ch
, "{PYou„eûiv%dƒx³r›nû…ošts.{x\n", 
xp
);

1218 
	`gaš_exp
(
ch
, 
xp
);

1221 
skl
::
ty³
 
¢
 = 
	`g‘_¿ndom_skl
(
ch
);

1223 ià(
	`rŞl_chªû
(20è&& 
¢
 !ğ
skl
::
ty³
::
unknown
) {

1224 
buf
 = 
FÜm©
::
	`fÜm©
("I wÈ®sØ‹ach you somoàthfš”…ošt oà%s.", 
skl
::
	`lookup
(
¢
).
Çme
);

1225 
	`do_§y
(
que¡mª
, 
buf
);

1226 
	`±c
(
ch
, "% h–p you…¿ùiû %s.\n", 
que¡mª
->
shÜt_desü
, 
skl
::
	`lookup
(
¢
).
Çme
);

1227 
	`check_im´ove
(
ch
, 
¢
, 
Œue
, -1);

1230 
	`sq_ş—nup
(
ch
);

1231 
ch
->
gŞd
 +ğ
gŞd»w¬d
;

1232 
ch
->
pcd©a
->
skÍošts
 +ğ
pošŒew¬d
;

1233 
	`wizÃt
("{Y:SKILL QUEST:{x $N ha com¶‘ed‡ skÈque¡", 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

1236 ià((
que¡mª
 = 
	`fšd_que¡ma¡”
(
ch
)è!ğ
nuÎ±r
) {

1237 
	`aù
("$ÀšfÜm $N $ha com¶‘ed $ que¡.", 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_ROOM
);

1238 
	`aù
("You infÜm $N you havcom¶‘ed you¸que¡.", 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_CHAR
);

1240 ià(
ch
->
pcd©a
->
que¡_giv”
 !ğ
que¡mª
->
pIndexD©a
->
vnum
) {

1241 
	`do_§y
(
que¡mª
, "I‚ever sent you on‡ quest! Perhaps you'rehinking of someoneƒlse.");

1245 ià(!
	`IS_QUESTOR
(
ch
)) {

1246 
	`do_§y
(
que¡mª
, "But you‡ren't on‡ quest‡the moment!");

1247 
buf
 = 
FÜm©
::
	`fÜm©
("You havtØREQUEST‡ que¡ fœ¡, %s.", 
ch
->
Çme
);

1248 
	`do_§y
(
que¡mª
, 
buf
);

1250 
	`que¡_ş—nup
(
ch
);

1254 ià(
ch
->
pcd©a
->
Ãxtque¡
 > 0 || ch->pcd©a->
couÁdown
 <= 0) {

1255 
	`do_§y
(
que¡mª
, "But you didn't complete your quest inime!");

1257 
	`que¡_ş—nup
(
ch
);

1262 ià(
ch
->
pcd©a
->
que¡obj
 > 0) {

1263 
obj
 = 
ch
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
) {

1264 ià(
obj
->
pIndexD©a
 =ğ
nuÎ±r
) {

1265 
Loggšg
::
	`bug
("QUEST COMPLETE: obj with‚ullptr…IndexData", 0);

1266 
obj
 = 
nuÎ±r
;

1269 ià(
obj
->
pIndexD©a
->
vnum
 =ğ
ch
->
pcd©a
->
que¡obj
)

1275 ià(
ch
->
pcd©a
->
que¡obf
 < 0 && 
obj
 =ğ
nuÎ±r
) {

1276 
	`do_§y
(
que¡mª
, "You must have†ost your quest item onhe way here. Hurry‡nd find it!");

1277 
ch
->
pcd©a
->
que¡obf
 = 0;

1282 ià(
ch
->
pcd©a
->
que¡mob
 > 0 || (ch->pcd©a->
que¡obj
 > 0 && 
obj
 =ğ
nuÎ±r
)) {

1283 
	`do_§y
(
que¡mª
, "You haven't completedhe quest yet, buthere is stillime!");

1289 ià(
ch
->
pcd©a
->
que¡obj
 > 0 && 
obj
 !ğ
nuÎ±r
) {

1290 
	`aù
("You hªd $°tØ$N.", 
ch
, 
obj
, 
que¡mª
, 
TO_CHAR
);

1291 
	`aù
("$Àhªd $°tØ$N.", 
ch
, 
obj
, 
que¡mª
, 
TO_ROOM
);

1292 
	`exŒaù_obj
(
obj
);

1293 
obj
 = 
nuÎ±r
;

1295 ià(
ch
->
pcd©a
->
que¡mob
 != -1) {

1297 
Loggšg
::
	`bug
("QUEST COMPLETE:‡t„eward…hase without kill or object", 0);

1301 
pošŒew¬d
 = 
	`numb”_¿nge
(1, 5);

1304 
ch
->
pcd©a
->
Ãxtque¡
 = 
pošŒew¬d
;

1306 ià(
Game
::
que¡_doubË
)

1307 
pošŒew¬d
 +ğ
	`numb”_¿nge
(0, 5);

1317 
pošŒew¬d
 +ğ
	`numb”_¿nge
(0, 
	`GET_ATTR
(
ch
, 
APPLY_QUESTPOINTS
));

1319 
´aüew¬d
 = 0;

1320 ià(
	`rŞl_chªû
(5))

1321 
´aüew¬d
 = 
	`numb”_¿nge
(1, 3);

1323 
gŞd»w¬d
 = 
	`numb”_¿nge
(
ch
->
Ëv–
 / 2, ch->level * 5 / 2) + 1;

1326 
	`do_§y
(
que¡mª
, "Congratulations on completing your quest!");

1327 
buf
 = 
FÜm©
::
	`fÜm©
("As‡„eward, I‡m giving you %d quest…oint%s‡nd %d gold.",

1328 
pošŒew¬d
, (pošŒew¬d =ğ1 ? "" : "s"), 
gŞd»w¬d
);

1329 
	`do_§y
(
que¡mª
, 
buf
);

1331 ià(!
ch
->
»voke_æags
.
	`has
(
REVOKE_EXP
)) {

1332 
xp
 = 
	`numb”_¿nge
(100, 300);

1333 
	`±c
(
ch
, "{PYou„eûiv%dƒx³r›nû…ošts.{x\n", 
xp
);

1334 
	`gaš_exp
(
ch
, 
xp
);

1337 ià(
´aüew¬d
 > 0)

1338 
	`±c
(
ch
, "{YYou‡lsØgaš %d…¿ùiû%s!{x\n", 
´aüew¬d
, (pracreward == 1 ? "" : "s"));

1340 
	`que¡_ş—nup
(
ch
);

1342 
ch
->
gŞd
 +ğ
gŞd»w¬d
;

1343 
ch
->
pcd©a
->
que¡pošts
 +ğ
pošŒew¬d
;

1344 
ch
->
´aùiû
 +ğ
´aüew¬d
;

1345 
	`wizÃt
("{Y:QUEST:{x $N ha com¶‘ed‡ que¡", 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

1349 
	`¡c
("You cª'ˆdØth© h”e.\n", 
ch
);

1355 ià(
	`IS_IMMORTAL
(
ch
è&& 
¬g1
.
	`is_´efix_of
("close")) {

1356 
num_š_¬—
;

1357 
num_to_ou¡
 = 0;

1358 
Room
 *
‹m¶e
;

1360 ià(!
Game
::
	`wÜld
().
que¡
.
İ’
) {

1361 
	`¡c
("Thque¡‡»¨i nÙ cu¼’y o³n.\n", 
ch
);

1365 
SŒšg
 
num_¬g
;

1366 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
num_¬g
);

1368 ià(!
num_¬g
.
	`em±y
(è&&‚um_¬g.
	`is_numb”
())

1369 
num_to_ou¡
 = 
	`©oi
(
num_¬g
);

1371 
num_š_¬—
 = 
Game
::
	`wÜld
().
que¡
.
	`¬—
().
	`num_¶ay”s
();

1373 ià(
num_š_¬—
 > 0) {

1374 ià(
num_to_ou¡
 < 
num_š_¬—
 - 1 ||‚um_to_oust >‚um_in_area + 1) {

1375 
	`±c
(
ch
, "Th”¬¡È%d…Ïy” šhque¡‡»a.\n", 
num_š_¬—
);

1376 
	`¡c
("Clo£hque¡ oÀhow mªy…Ïy”s?\n", 
ch
);

1380 
‹m¶e
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_TEMPLE
)));

1382 ià(
‹m¶e
 =ğ
nuÎ±r
)

1383 
Loggšg
::
	`bug
("QUEST CLOSE: Tem¶loÿtiÚ‚Ù found (%d)", 
ROOM_VNUM_TEMPLE
);

1385 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

1386 ià(!
viùim
->
	`is_Åc
(è&& viùim->
š_room
 !ğ
nuÎ±r


1387 && 
viùim
->
š_room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()) {

1388 
	`aù
("Youƒx³È$N fromhque¡‡»a.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1389 
	`¡c
("You‡»ƒx³Îed fromhque¡‡»a.\n", 
viùim
);

1390 
	`ch¬_äom_room
(
viùim
);

1391 
	`ch¬_to_room
(
viùim
, 
‹m¶e
);

1392 
	`aù
("$À¬rive äom‡ mushroom cloud.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1393 
	`do_look
(
viùim
, "auto");

1399 
	`¡c
("*** You havşo£dhque¡‡»¨***\n", 
ch
);

1400 
buf
 = 
FÜm©
::
	`fÜm©
("% ha şo£dhque¡‡»a.\n", 
ch
->
Çme
);

1401 
	`do_£nd_ªnounû
(
ch
, 
buf
);

1402 
Game
::
	`wÜld
().
que¡
.
İ’
 = 
çl£
;

1407 ià(
	`IS_IMMORTAL
(
ch
è&& 
¬g1
.
	`is_´efix_of
("deduct")) {

1408 
Ch¬aù”
 *
viùim
;

1409 
qpošt
;

1411 
SŒšg
 
¬g
;

1412 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1414 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

1415 
	`¡c
("PÏy”‚Ù found.\n", 
ch
);

1419 ià(!
¬gum’t
.
	`is_numb”
()) {

1420 
	`¡c
("V®umu¡ bnum”ic.\n", 
ch
);

1424 
qpošt
 = 
	`©oi
(
¬gum’t
);

1426 ià(
qpošt
 < 0) {

1427 
	`¡c
("V®umu¡ bpos™ive.\n", 
ch
);

1431 ià(
qpošt
 > 
viùim
->
pcd©a
->
que¡pošts
) {

1432 
	`¡c
("They dØnÙ hav’ough que¡…ošt fÜh©.\n", 
ch
);

1436 
viùim
->
pcd©a
->
que¡pošts
 -ğ
qpošt
;

1437 
buf
 = 
FÜm©
::
	`fÜm©
("%d que¡pošt havb“Àdeduùed, %d„emaššg.\n", 
qpošt
, 
viùim
->
pcd©a
->
que¡pošts
);

1438 
	`¡c
(
buf
, 
ch
);

1439 
	`¡c
(
buf
, 
viùim
);

1440 
buf
 = 
FÜm©
::
	`fÜm©
("% deduùed %d q°äom % [%d„emaššg].", 
ch
->
Çme
, 
qpošt
, 
viùim
->Çme, viùim->
pcd©a
->
que¡pošts
);

1441 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_SECURE
, 
WIZ_QUEST
, 
	`GET_RANK
(ch));

1446 ià(
	`IS_IMMORTAL
(
ch
è&& 
¬g1
.
	`is_´efix_of
("double")) {

1447 ià(!
Game
::
que¡_doubË
) {

1448 
	`¡c
("You deş¬doubË QP fÜ‡Î!\n", 
ch
);

1449 
	`wizÃt
("{Y:QUEST:{x $N ha deş¬ed doubË QP", 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

1450 
	`do_£nd_ªnounû
(
ch
, "The Gods have declared Double QP for‡ll! Happy Questing!");

1451 
Game
::
que¡_doubË
 = 1;

1454 
	`¡c
("You deş¬nÜm® QP fÜ‡Î.\n", 
ch
);

1455 
	`wizÃt
("{Y:QUEST:{x $N ha deş¬ed‚Üm® QP", 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

1456 
	`do_£nd_ªnounû
(
ch
, "The Gods have declared‚ormal questing.");

1457 
Game
::
que¡_doubË
 = 0;

1464 ià(
¬g1
.
	`is_´efix_of
("forfeit")) {

1465 ià(!
	`IS_QUESTOR
(
ch
è&& !
	`IS_SQUESTOR
(ch)) {

1466 
	`¡c
("You‡»n'ˆcu¼’y oÀ¨que¡.\n", 
ch
);

1470 ià(
	`IS_SQUESTOR
(
ch
è&& 
	`fšd_sque¡ma¡”
(chè!ğ
nuÎ±r
) {

1471 
	`sq_ş—nup
(
ch
);

1472 
ch
->
pcd©a
->
Ãxtsque¡
 = 10;

1473 
	`wizÃt
("{Y:SKILL QUEST:{x $N ha fÜã™ed $S skÈque¡", 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

1474 
	`¡c
("You havfÜã™ed you¸skÈque¡.\n", 
ch
);

1478 ià(
	`IS_QUESTOR
(
ch
è&& 
	`fšd_que¡ma¡”
(chè!ğ
nuÎ±r
) {

1479 
	`que¡_ş—nup
(
ch
);

1480 
ch
->
pcd©a
->
Ãxtque¡
 = 6;

1481 
	`wizÃt
("{Y:QUEST:{x $N ha fÜã™ed $S que¡", 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

1482 
	`¡c
("You havfÜã™ed you¸que¡.\n", 
ch
);

1486 
	`¡c
("You cª'ˆdØth© h”e.\n", 
ch
);

1491 ià(
¬g1
.
	`is_´efix_of
("info")) {

1492 ià(
ch
->
š_room
 =ğ
nuÎ±r
) {

1493 
	`¡c
("You cªnÙ„eÿÎ you¸que¡ fromhi loÿtiÚ.\n", 
ch
);

1497 
	`sque¡_šfo
(
ch
);

1498 
	`¡c
("\n", 
ch
);

1499 
	`que¡_šfo
(
ch
);

1504 ià(
¬g1
.
	`is_´efix_of
("join")) {

1505 ià(
	`g‘_pos™iÚ
(
ch
è< 
POS_RESTING
) {

1506 
	`¡c
("You‡»oØbusy sË•šg.\n", 
ch
);

1510 ià(
ch
->
š_room
 =ğ
nuÎ±r
) {

1511 
	`¡c
("Som‘hšg…»v’t you from joššghque¡.\n", 
ch
);

1515 ià(!
Game
::
	`wÜld
().
que¡
.
İ’
) {

1516 
	`¡c
("SÜry, buˆthque¡‡»¨ha nÙ b“Àİ’ed!\n", 
ch
);

1520 ià(
ch
->
Ëv–
 < 
Game
::
	`wÜld
().
que¡
.
mš_Ëv–
 || ch->Ëv– > Game::wÜld().que¡.
max_Ëv–
) {

1521 
	`¡c
("SÜry, buˆthque¡‡»¨i nÙ o³ÀtØyou¸Ëv–!\n", 
ch
);

1525 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_NO_RECALL
)) {

1526 
	`¡c
("You cªnÙ jošhque¡ fromhi loÿtiÚ.\n", 
ch
);

1530 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
cur£
)) {

1531 
	`¡c
("You cªnÙ jošhque¡ iÀyou¸cu¼’ˆcÚt™iÚ.\n", 
ch
);

1535 ià(
ch
->
fightšg
 !ğ
nuÎ±r
) {

1536 
	`¡c
("You wÈÃedØ¡İ fightšg befÜyou cª jošhque¡.\n", 
ch
);

1540 
	`aù
("$Àjoš thque¡!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1541 
	`ch¬_äom_room
(
ch
);

1542 
	`ch¬_to_room
(
ch
, 
Game
::
	`wÜld
().
que¡
.
¡¬Œoom
);

1543 
	`aù
("$À­³¬ šhroom.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1544 
	`¡c
("You jošhQue¡!\n", 
ch
);

1545 
	`do_look
(
ch
, "auto");

1550 ià(
	`IS_IMMORTAL
(
ch
è&& 
¬g1
.
	`is_´efix_of
("list")) {

1551 
SŒšg
 
qblock
, 
sqblock
, 
mblock
, 
oblock
, 
lblock
;

1552 
SŒšg
 
ouut
;

1553 
DesütÜ
 *
d
;

1554 
	`¡c
(" {YQue¡ {GSkÈQue¡{x\n", 
ch
);

1555 
	`¡c
("Nam MobObjeù LoùÀ Tim QP --- MobLoøObjLoø Tim SP\n", 
ch
);

1556 
	`¡c
("-----------------------------------------------------------------------------\n", 
ch
);

1558 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

1559 
Ch¬aù”
 *
wch
;

1561 ià(!
d
->
	`is_¶ayšg
(è|| !
	`ÿn_£e_who
(
ch
, d->
ch¬aù”
))

1564 
wch
 = (
d
->
Üigš®
 !ğ
nuÎ±r
è? d->Üigš® : d->
ch¬aù”
;

1566 ià(
wch
->
	`is_Åc
(è|| !
	`ÿn_£e_who
(
ch
, wch))

1569 ià(
	`IS_QUESTOR
(
wch
)) {

1570 ià(
wch
->
pcd©a
->
que¡obj
 > 0) {

1571 
mblock
 = 
FÜm©
::
	`fÜm©
("{Y<%5d>{x", 0);

1573 ià(
wch
->
pcd©a
->
que¡obf
 < 0) {

1574 
oblock
 = 
FÜm©
::
	`fÜm©
("{C<{Yfound{C>{x");

1575 
lblock
 = 
FÜm©
::
	`fÜm©
("{C<{Yfound{C>{x");

1578 
oblock
 = 
FÜm©
::
	`fÜm©
("{T<{Y%5d{T>{x", 
wch
->
pcd©a
->
que¡obj
);

1579 
lblock
 = 
FÜm©
::
	`fÜm©
("{T<{Y%5s{T>{x", 
wch
->
pcd©a
->
que¡loc
);

1583 
oblock
 = 
FÜm©
::
	`fÜm©
("{Y<%5d>{x", 0);

1585 ià(
wch
->
pcd©a
->
que¡mob
 == -1) {

1586 
mblock
 = 
FÜm©
::
	`fÜm©
("{C<{Y dead{C>{x");

1587 
lblock
 = 
FÜm©
::
	`fÜm©
("{C<{Yfound{C>{x");

1590 
mblock
 = 
FÜm©
::
	`fÜm©
("{T<{Y%5d{T>{x", 
wch
->
pcd©a
->
que¡mob
);

1591 
lblock
 = 
FÜm©
::
	`fÜm©
("{T<{Y%5s{T>{x", 
wch
->
pcd©a
->
que¡loc
);

1595 
qblock
 = 
FÜm©
::
	`fÜm©
("%s%s%s {Y[%2d][%4d]{x",

1596 
mblock
, 
oblock
, 
lblock
, 
wch
->
pcd©a
->
couÁdown
, wch->pcd©a->
que¡pošts
);

1599 
qblock
 = 
FÜm©
::
	`fÜm©
("<%5d><%5d><%5d> [%2d][%4d]",

1600 0, 0, 0, 
wch
->
pcd©a
->
Ãxtque¡
, wch->pcd©a->
que¡pošts
);

1602 ià(
	`IS_SQUESTOR
(
wch
)) {

1603 ià(
wch
->
pcd©a
->
sque¡mob
 =ğ
nuÎ±r


1604 && 
wch
->
pcd©a
->
sque¡obj
 !ğ
nuÎ±r
) {

1605 
mblock
 = 
FÜm©
::
	`fÜm©
("{G<%5d>{x", 0);

1607 ià(
wch
->
pcd©a
->
sque¡objf
)

1608 
oblock
 = 
FÜm©
::
	`fÜm©
("{C<{Gfound{C>{x");

1610 
oblock
 = 
FÜm©
::
	`fÜm©
("{T<{G%5s{T>{x", 
wch
->
pcd©a
->
sque¡loc1
);

1612 ià(
wch
->
pcd©a
->
sque¡obj
 =ğ
nuÎ±r


1613 && 
wch
->
pcd©a
->
sque¡mob
 !ğ
nuÎ±r
) {

1614 
oblock
 = 
FÜm©
::
	`fÜm©
("{G<%5d>{x", 0);

1616 ià(
wch
->
pcd©a
->
sque¡mobf
)

1617 
mblock
 = 
FÜm©
::
	`fÜm©
("{C<{Gfound{C>{x");

1619 
mblock
 = 
FÜm©
::
	`fÜm©
("{T<{G%5s{T>{x", 
wch
->
pcd©a
->
sque¡loc2
);

1621 ià(
wch
->
pcd©a
->
sque¡obj
 !ğ
nuÎ±r


1622 && 
wch
->
pcd©a
->
sque¡mob
 !ğ
nuÎ±r
) {

1623 ià(
wch
->
pcd©a
->
sque¡objf
)

1624 
oblock
 = 
FÜm©
::
	`fÜm©
("{C<{Gfound{C>{x");

1626 
oblock
 = 
FÜm©
::
	`fÜm©
("{T<{G%5s{T>{x", 
wch
->
pcd©a
->
sque¡loc1
);

1628 ià(
wch
->
pcd©a
->
sque¡mobf
)

1629 
mblock
 = 
FÜm©
::
	`fÜm©
("{C<{Gfound{C>{x");

1631 
mblock
 = 
FÜm©
::
	`fÜm©
("{T<{G%5s{T>{x", 
wch
->
pcd©a
->
sque¡loc2
);

1634 
oblock
 = 
FÜm©
::
	`fÜm©
("{P<? ? ? ? ?>{x");

1635 
mblock
 = 
FÜm©
::
	`fÜm©
("{P<? ? ? ? ?>{x");

1638 
sqblock
 = 
FÜm©
::
	`fÜm©
("%s%s {G[%2d][%4d]{x",

1639 
mblock
, 
oblock
, 
wch
->
pcd©a
->
sqcouÁdown
, wch->pcd©a->
skÍošts
);

1642 
sqblock
 = 
FÜm©
::
	`fÜm©
("<%5d><%5d> [%2d][%4d]",

1643 0, 0, 
wch
->
pcd©a
->
Ãxtsque¡
, wch->pcd©a->
skÍošts
);

1645 
ouut
 +ğ
FÜm©
::
	`fÜm©
("%-14 %  %s{x\n", 
wch
->
Çme
, 
qblock
, 
sqblock
);

1646 
ouut
 +ğ
buf
;

1649 
	`·ge_to_ch¬
(
ouut
, 
ch
);

1654 ià(
	`IS_IMMORTAL
(
ch
è&& 
¬g1
.
	`is_´efix_of
("open")) {

1655 ià(
Game
::
	`wÜld
().
que¡
.
¡¬Œoom
 =ğ
nuÎ±r
) {

1656 
	`¡c
("Thque¡‡»¨i nÙ‡vaabË iÀthi »boÙ.\n", 
ch
);

1660 ià(
Game
::
	`wÜld
().
que¡
.
İ’
) {

1661 
	`±c
(
ch
, "Thque¡‡»¨i ®»ady o³n,ØËv– %dØ%d\n", 
Game
::
	`wÜld
().
que¡
.
mš_Ëv–
, Game::wÜld().que¡.
max_Ëv–
);

1665 
SŒšg
 
num_¬g
;

1666 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
num_¬g
);

1668 ià(!
num_¬g
.
	`em±y
(è&&‚um_¬g.
	`is_numb”
())

1669 
Game
::
	`wÜld
().
que¡
.
mš_Ëv–
 = 
	`©oi
(
num_¬g
);

1671 ià(
Game
::
	`wÜld
().
que¡
.
mš_Ëv–
 < 1 || Game::world().quest.min_level > 100) {

1672 
	`¡c
("O³Àthque¡Øwhich mšimum†ev– (1..100è?\n", 
ch
);

1676 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
num_¬g
);

1678 ià(!
num_¬g
.
	`em±y
(è&&‚um_¬g.
	`is_numb”
())

1679 
Game
::
	`wÜld
().
que¡
.
max_Ëv–
 = 
	`©oi
(
num_¬g
);

1681 ià(
Game
::
	`wÜld
().
que¡
.
max_Ëv–
 < Game::wÜld().que¡.
mš_Ëv–
 || Game::world().quest.max_level > 100) {

1682 
	`±c
(
ch
, "Openhe quest for†evels %do which maximum†evel (%d..100) ?\n",

1683 
Game
::
	`wÜld
().
que¡
.
mš_Ëv–
, Game::world().quest.min_level);

1687 
buf
 = 
FÜm©
::
	`fÜm©
("% ha İ’edhque¡‡»¨tØËv– %dhrough %d!\n", 
ch
->
Çme
, 
Game
::
	`wÜld
().
que¡
.
mš_Ëv–
, Game::wÜld().que¡.
max_Ëv–
);

1688 
	`do_£nd_ªnounû
(
ch
, 
buf
);

1689 
	`±c
(
ch
, "You o³Àthque¡‡»¨tØËv– %dhrough %d.\n", 
Game
::
	`wÜld
().
que¡
.
mš_Ëv–
, Game::wÜld().que¡.
max_Ëv–
);

1690 
Game
::
	`wÜld
().
que¡
.
İ’
 = 
Œue
;

1695 ià(
	`IS_IMMORTAL
(
ch
è&& 
¬g1
.
	`is_´efix_of
("pk")) {

1696 
Ch¬aù”
 *
§Ësgnome
;

1697 
Room
 *
to_room
;

1698 
§Ësgnome
 = 
	`g‘_mob_wÜld
(
ch
, "§Ësgnome", 
VIS_CHAR
);

1700 ià(
§Ësgnome
 =ğ
nuÎ±r
)

1701 
Loggšg
::
	`bug
("QUEST PK: salesgnome‚othere", 0);

1703 
	`¡c
("PK iÀQue¡Ïnd i now ", 
ch
);

1704 
Game
::
	`wÜld
().
que¡
.
pk
 = !Game::world().quest.pk;

1706 ià(
Game
::
	`wÜld
().
que¡
.
pk
) {

1707 
	`¡c
("UNLIMITED (Que¡Ïnd ğO³ÀA»Ç)\n", 
ch
);

1708 
	`wizÃt
("{Y:QUEST:{x $N ha İ’ed Que¡Ïnd fÜ O³ÀA»Ç", 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

1710 ià(
§Ësgnome
 !ğ
nuÎ±r
) {

1711 
to_room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_ARENATICKET
)));

1713 ià(
to_room
 =ğ
nuÎ±r
) {

1714 
Loggšg
::
	`bug
("QUEST PK: Can't findicket booth", 0);

1718 
	`ch¬_äom_room
(
§Ësgnome
);

1719 
	`ch¬_to_room
(
§Ësgnome
, 
to_room
);

1723 
	`¡c
("LIMITED (likev”ywh”–£)\n", 
ch
);

1724 
	`wizÃt
("{Y:QUEST:{x $N ha »¡riùed PK iÀQue¡Ïnds", 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

1726 ià(
§Ësgnome
 !ğ
nuÎ±r
) {

1727 
to_room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_TICKETBACKROOM
)));

1729 ià(
to_room
 =ğ
nuÎ±r
) {

1730 
Loggšg
::
	`bug
("QUEST PK: Can't findicket booth back„oom", 0);

1734 
	`ch¬_äom_room
(
§Ësgnome
);

1735 
	`ch¬_to_room
(
§Ësgnome
, 
to_room
);

1743 ià(
¬g1
.
	`is_´efix_of
("points")) {

1744 
	`±c
(
ch
, "You have %d quest…oints‡nd %d skill…oints.\n",

1745 
ch
->
pcd©a
->
que¡pošts
, ch->pcd©a->
skÍošts
);

1750 ià(
¬g1
.
	`is_´efix_of
("request")) {

1751 ià(
	`g‘_pos™iÚ
(
ch
è< 
POS_RESTING
) {

1752 
	`¡c
("You‡»oØbusy sË•šg.\n", 
ch
);

1756 ià((
que¡mª
 = 
	`fšd_sque¡ma¡”
(
ch
)è!ğ
nuÎ±r
) {

1757 
	`aù
("$Àask $N fÜ‡ skÈque¡.", 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_ROOM
);

1758 
	`aù
("You‡sk $N fÜ‡ skÈque¡.", 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_CHAR
);

1760 ià(
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
ACT_PET
)) {

1761 
	`check_socŸl
(
que¡mª
, "roæ", 
ch
->
Çme
);

1763 
buf
 = 
FÜm©
::
	`fÜm©
("Whoƒver heard of‡…et questing for its %s?",

1764 
	`GET_ATTR_SEX
(
ch
) == 2 ? "mistress" : "master");

1765 
	`do_§y
(
que¡mª
, 
buf
);

1767 ià(
ch
->
Ëad”
 !ğ
nuÎ±r
)

1768 
	`check_socŸl
(
que¡mª
, "Ïugh", 
ch
->
Ëad”
->
Çme
);

1773 ià(
	`IS_SQUESTOR
(
ch
)) {

1774 
	`do_§y
(
que¡mª
, "But you're‡lready on‡ quest!");

1778 ià(
ch
->
pcd©a
->
Ãxtsque¡
 > 0) {

1779 
	`aù
("$N says 'You're very brave, $n, but†et someoneƒlse have‡ chance.'",

1780 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_ROOM
);

1781 
	`aù
("$N says 'You're very brave, $n, but†et someoneƒlse have‡ chance.'",

1782 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_CHAR
);

1786 
	`aù
("$N say 'Thªk you, b¿v$n!", 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_ROOM
);

1787 
	`aù
("$N say 'Thªk you, b¿v$n!", 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_CHAR
);

1788 
	`sq_ş—nup
(
ch
);

1789 
	`g’”©e_sklque¡
(
ch
, 
que¡mª
);

1790 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_SQUESTOR
;

1791 
buf
 = 
FÜm©
::
	`fÜm©
("You hav%d mšu‹ tØcom¶‘thi que¡.", 
ch
->
pcd©a
->
sqcouÁdown
);

1792 
	`do_§y
(
que¡mª
, 
buf
);

1793 
	`do_§y
(
que¡mª
, "Mayhe gods go with you!");

1794 
	`wizÃt
("{Y:SKILL QUEST:{x $N ha beguÀ¨skÈque¡", 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

1798 ià((
que¡mª
 = 
	`fšd_que¡ma¡”
(
ch
)è!ğ
nuÎ±r
) {

1799 
	`aù
("$Àask $N fÜ‡ que¡.", 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_ROOM
);

1800 
	`aù
("You‡sk $N fÜ‡ que¡.", 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_CHAR
);

1802 ià(
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
ACT_PET
)) {

1803 
	`check_socŸl
(
que¡mª
, "roæ", 
ch
->
Çme
);

1805 
buf
 = 
FÜm©
::
	`fÜm©
("Whoƒver heard of‡…et questing for its %s?",

1806 
	`GET_ATTR_SEX
(
ch
) == 2 ? "mistress" : "master");

1807 
	`do_§y
(
que¡mª
, 
buf
);

1809 ià(
ch
->
Ëad”
 !ğ
nuÎ±r
)

1810 
	`check_socŸl
(
que¡mª
, "Ïugh", 
ch
->
Ëad”
->
Çme
);

1815 ià(
	`IS_QUESTOR
(
ch
)) {

1816 
	`do_§y
(
que¡mª
, "But you're‡lready on‡ quest!");

1820 ià(
ch
->
pcd©a
->
Ãxtque¡
 > 0) {

1821 
	`aù
("$N say 'You'» v”y b¿ve, $n, buˆËˆsomeÚ–£ hav¨chªû.'", 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_ROOM
);

1822 
	`aù
("$N say 'You'» v”y b¿ve, $n, buˆËˆsomeÚ–£ hav¨chªû.'", 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_CHAR
);

1826 
	`aù
("$N say 'Thªk you, b¿v$n!", 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_ROOM
);

1827 
	`aù
("$N say 'Thªk you, b¿v$n!", 
ch
, 
nuÎ±r
, 
que¡mª
, 
TO_CHAR
);

1828 
ch
->
pcd©a
->
que¡mob
 = 0;

1829 
ch
->
pcd©a
->
que¡obj
 = 0;

1830 
ch
->
pcd©a
->
que¡obf
 = 0;

1831 
ch
->
pcd©a
->
que¡loc
 = 
	`LoÿtiÚ
();

1832 
	`g’”©e_que¡
(
ch
, 
que¡mª
);

1834 ià(
ch
->
pcd©a
->
que¡mob
 > 0 || ch->pcd©a->
que¡obj
 > 0) {

1835 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_QUESTOR
;

1836 
buf
 = 
FÜm©
::
	`fÜm©
("You hav%d mšu‹ tØcom¶‘thi que¡.", 
ch
->
pcd©a
->
couÁdown
);

1837 
	`do_§y
(
que¡mª
, 
buf
);

1838 
	`do_§y
(
que¡mª
, "Mayhe gods go with you!");

1841 
	`wizÃt
("{Y:QUEST:{x $N ha beguÀ¨que¡", 
ch
, 
nuÎ±r
, 
WIZ_QUEST
, 0, 0);

1845 
	`¡c
("You cª'ˆdØth© h”e.\n", 
ch
);

1851 ià(
	`IS_IMMORTAL
(
ch
è&& 
¬g1
.
	`is_´efix_of
("status")) {

1852 ià(
Game
::
	`wÜld
().
que¡
.
İ’
)

1853 
	`¡c
("ThQue¡ A»¨i cu¼’y o³ÀfÜ‡ {Rque¡{x.\n", 
ch
);

1855 
	`¡c
("Th”i cu¼’y {GnØque¡{x gošg on.\n", 
ch
);

1857 ià(
Game
::
	`wÜld
().
que¡
.
pk
)

1858 
	`¡c
("Th”i {GuÄe¡riùed c¬Çge{x iÀthQue¡ A»a.\n", 
ch
);

1860 
	`¡c
("ThQue¡ A»¨i cu¼’y PK {R»¡riùed{x.\n", 
ch
);

1866 ià(
¬g1
.
	`is_´efix_of
("time")) {

1867 ià(!
	`IS_QUESTOR
(
ch
)) {

1868 
	`¡c
("You‡»n'ˆcu¼’y oÀ¨que¡.\n", 
ch
);

1870 ià(
ch
->
pcd©a
->
Ãxtque¡
 > 1)

1871 
	`±c
(
ch
, "There‡re %d minutes„emaining until you can quest‡gain.\n",

1872 
ch
->
pcd©a
->
Ãxtque¡
);

1873 ià(
ch
->
pcd©a
->
Ãxtque¡
 == 1)

1874 
	`¡c
("Th”i Ës thª‡ mšu‹„emaššg uÁ you cª que¡‡gaš.\n", 
ch
);

1876 ià(
ch
->
pcd©a
->
couÁdown
 > 0)

1877 
	`±c
(
ch
, "You hav%d mšu‹ ËáØcom¶‘you¸cu¼’ˆque¡.\n", ch->
pcd©a
->
couÁdown
);

1879 ià(!
	`IS_SQUESTOR
(
ch
)) {

1880 
	`¡c
("You‡»n'ˆcu¼’y oÀ¨skÈque¡.\n", 
ch
);

1882 ià(
ch
->
pcd©a
->
Ãxtsque¡
 > 1)

1883 
	`±c
(
ch
, "There‡re %d minutes„emaining until you can go on‡nother skill quest.\n",

1884 
ch
->
pcd©a
->
Ãxtsque¡
);

1885 ià(
ch
->
pcd©a
->
Ãxtsque¡
 == 1)

1886 
	`¡c
("Th”i Ës thª‡ mšu‹„emaššg uÁ you cª gØÚ‡nÙh” skÈque¡.\n", 
ch
);

1888 ià(
ch
->
pcd©a
->
sqcouÁdown
 > 0)

1889 
	`±c
(
ch
, "You have %d minutes†efto complete your current skill quest.\n",

1890 
ch
->
pcd©a
->
sqcouÁdown
);

1896 
	`que¡_u§ge
(
ch
);

1897 
	}
}

	@src/random.cc

11 
	~<c¡dlib
>

12 
	~<time.h
>

13 
	~<®gÜ™hm
>

16 
	$š™_mm
()

18 
	`¤ªd
(
	`time
(
nuÎ±r
));

20 
	}
}

22 
	$numb”_mm
()

24  
	`¿nd
() >> 6;

25 
	}
}

29 
	$numb”_¿nge
(
äom
, 
to
)

31 
pow”
, 
numb”
;

33 ià(
äom
 =ğ0 && 
to
 == 0)

36 ià((
to
 =Ø- 
äom
 + 1) <= 1)

37  
äom
;

39 
pow”
 = 2;…ow” < 
to
;…ower <<= 1);

41 (
numb”
 = 
	`numb”_mm
(è& (
pow”
 - 1)è>ğ
to
);

43  
äom
 + 
numb”
;

44 
	}
}

47 
	$diû
(
numb”
, 
size
)

49 
idiû
, 
sum
;

51 
size
) {

54 1:  
numb”
;

57 
idiû
 = 0, 
sum
 = 0; idiû < 
numb”
; idice++)

58 
sum
 +ğ
	`numb”_¿nge
(1, 
size
);

60  
sum
;

61 
	}
}

65 
	$numb”_³rûÁ
()

67 
³rûÁ
;

69 (
³rûÁ
 = 
	`numb”_mm
() & (128 - 1)) > 99);

71  1 + 
³rûÁ
;

72 
	}
}

75 
	$numb”_doÜ
()

77 
doÜ
;

79 (
doÜ
 = 
	`numb”_mm
() & (8 - 1)) > 5);

81  
doÜ
;

82 
	}
}

84 
	$numb”_b™s
(
width
)

86  
	`numb”_mm
(è& ((1 << 
width
) - 1);

87 
	}
}

90 
	$numb”_fuzzy
(
numb”
)

92 
	`numb”_b™s
(2)) {

93 0: 
numb”
 -= 1; ;

95 3: 
numb”
 += 1; ;

98  
¡d
::
	`max
(1, 
numb”
);

99 
	}
}

101 
	$rŞl_chªû
(
³rûÁ
) {

102  
	`numb”_³rûÁ
(è<ğ
³rûÁ
;

103 
	}
}

135 
	s´d_bË_’Œy
 {

136 
	mp
;

137 
	mc
;

140 cÚ¡ 
	g´d_bË
[] = {

245 
boŞ
 
	$´d_chªû
(*
´ev_çs
, 
p
) {

246 
p
 = 
¡d
::
	`max
(0, std::
	`mš
(100,…));

249 
ı
 = 
´d_bË
[
p
] * ((*
´ev_çs
) + 1);

250 
boŞ
 
sucûss
 = (
	`numb”_³rûÁ
()-1è< (
ı
 * 100);

252 ià(
sucûss
)

253 *
´ev_çs
 = 0;

255 (*
´ev_çs
)++;

257  
sucûss
;

258 
	}
}

	@src/remort.cc

28 
	~<veùÜ
>

30 
	~"¬gum’t.hh
"

31 
	~"afãù/Afãù.hh
"

32 
	~"Ch¬aù”.hh
"

33 
	~"deş¬e.hh
"

34 
	~"fšd.hh
"

35 
	~"FÏgs.hh
"

36 
	~"FÜm©.hh
"

37 
	~"š‹½.hh
"

38 
	~"lookup.hh
"

39 
	~"Loggšg.hh
"

40 
	~"magic.hh
"

41 
	~"m”c.hh
"

42 
	~"PÏy”.hh
"

43 
	~"¿ndom.hh
"

44 
	~"skl/skl.hh
"

45 
	~"SŒšg.hh
"

46 
	~"bËs.hh
"

53 
	$¿ff_lookup
(
šdex
)

55 
i
;

57 
i
 = 1; i < 
MAX_RAFFECTS
; i++) {

58 ià(
¿fãùs
[
i
].
id
 =ğ
šdex
)

59  
i
;

65 
	}
}

67 
	$fix_bÏnk_¿ff
(
Ch¬aù”
 *
ch
, 
¡¬t
)

71 
i
, 
x
, 
Ï¡
;

73 ià(
ch
->
	`is_Åc
(è|| !
	`IS_REMORT
(ch))

76 
Ï¡
 = ((
ch
->
pcd©a
->
»mÜt_couÁ
 / 10) + 1);

79 
i
 = 
¡¬t
; i < 
Ï¡
; i++) {

81 ià(
ch
->
pcd©a
->
¿fãù
[
i
] < 1) {

82 
x
 = 
i
; x < 
Ï¡
; x++)

84 
ch
->
pcd©a
->
¿fãù
[
x
] = ((x =ğ
Ï¡
) ? 0 : ch->pcdata->raffect[x + 1]);

89 
	}
}

91 
	$»m_¿ff_afãù
(
Ch¬aù”
 *
ch
, 
šdex
)

93 ià(!
¿fãùs
[
šdex
].
add
.
	`em±y
()) {

94 ià((
¿fãùs
[
šdex
].
id
 >= 900) && (raffects[index].id <= 949))

95 
afãù
::
	`»mÜt_afãù_modify_ch¬
(
ch
, 
TO_VULN
, 
¿fãùs
[
šdex
].
add
, 
çl£
);

96 ià((
¿fãùs
[
šdex
].
id
 >= 950) && (raffects[index].id <= 999))

97 
afãù
::
	`»mÜt_afãù_modify_ch¬
(
ch
, 
TO_RESIST
, 
¿fãùs
[
šdex
].
add
, 
çl£
);

101 
	}
}

103 
boŞ
 
	$HAS_RAFF
(
Ch¬aù”
 *
ch
, 
æag
)

105 
i
;

107 ià(
æag
 <= 0)

108  
çl£
;

110 ià(
ch
->
	`is_Åc
())

111  
çl£
;

113 
i
 = 0; i < ((
ch
->
pcd©a
->
»mÜt_couÁ
 / 10) + 1); i++) {

114 ià(
ch
->
pcd©a
->
¿fãù
[
i
] =ğ
æag
)

115  
Œue
;

118  
çl£
;

119 
	}
}

121 
boŞ
 
	$HAS_RAFF_GROUP
(
Ch¬aù”
 *
ch
, 
æag
)

123 
i
;

125 ià(
ch
->
	`is_Åc
())

126  
çl£
;

128 
i
 = 0; i < ((
ch
->
pcd©a
->
»mÜt_couÁ
 / 10) + 1); i++) {

129 ià(
¿fãùs
[
	`¿ff_lookup
(
ch
->
pcd©a
->
¿fãù
[
i
])].
group
 =ğ
æag
)

130  
Œue
;

133  
çl£
;

134 
	}
}

136 
	$¿ff_add_to_ch¬
(
Ch¬aù”
 *
ch
, 
¿ff_id
) {

137 
šdex
;

139 
šdex
 = 1; index < 
MAX_RAFFECTS
; index++)

140 ià(
¿fãùs
[
šdex
].
id
 =ğ
¿ff_id
)

143 ià(
šdex
 =ğ
MAX_RAFFECTS
) {

144 
Loggšg
::
	`bugf
("¿fãù::add_to_ch¬: inv®id„afãù ID %d", 
¿ff_id
);

148 ià(!
¿fãùs
[
šdex
].
add
.
	`em±y
()) {

149 ià((
¿fãùs
[
šdex
].
id
 >= 900) && (raffects[index].id <= 949))

150 
afãù
::
	`»mÜt_afãù_modify_ch¬
(
ch
, 
TO_VULN
, 
¿fãùs
[
šdex
].
add
, 
Œue
);

151 ià((
¿fãùs
[
šdex
].
id
 >= 950) && (raffects[index].id <= 999))

152 
afãù
::
	`»mÜt_afãù_modify_ch¬
(
ch
, 
TO_RESIST
, 
¿fãùs
[
šdex
].
add
, 
Œue
);

154 
	}
}

156 
	$rŞl_Úe_¿ff
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
¶aû
)

158 
‹¡
;

159 
boŞ
 
ÿn_add
 = 
çl£
;

162 
‹¡
 = 
	`numb”_¿nge
(1, 
MAX_RAFFECTS
);

164 
‹¡
 < 1 ||e¡ > 
MAX_RAFFECTS


165 || 
¿fãùs
[
‹¡
].
id
 < 1

166 || 
	`numb”_³rûÁ
(è< 
¿fãùs
[
‹¡
].
chªû
)

167 
‹¡
 = 
	`numb”_¿nge
(1, 
MAX_RAFFECTS
);

170 ià((
¿fãùs
[
‹¡
].
id
 >= 1)

171 && (
¿fãùs
[
‹¡
].
id
 <= 99)

172 && (
	`numb”_³rûÁ
(è<ğ(
¿fãùs
[
‹¡
].
chªû
 + (
viùim
->
pcd©a
->
»mÜt_couÁ
 / 10))))

173 
ÿn_add
 = 
Œue
;

174 ià((
¿fãùs
[
‹¡
].
id
 >= 100)

175 && (
¿fãùs
[
‹¡
].
id
 <= 199)

176 && (
	`numb”_³rûÁ
(è<ğ(
¿fãùs
[
‹¡
].
chªû
 - (
viùim
->
pcd©a
->
»mÜt_couÁ
 / 10))))

177 
ÿn_add
 = 
Œue
;

178 ià((
¿fãùs
[
‹¡
].
id
 >= 900)

179 && (
¿fãùs
[
‹¡
].
id
 <= 949)

180 && (
	`numb”_³rûÁ
(è<ğ(
¿fãùs
[
‹¡
].
chªû
 - (
viùim
->
pcd©a
->
»mÜt_couÁ
 / 10))))

181 
ÿn_add
 = 
Œue
;

182 ià((
¿fãùs
[
‹¡
].
id
 >= 950)

183 && (
¿fãùs
[
‹¡
].
id
 <= 999)

184 && (
	`numb”_³rûÁ
(è<ğ(
¿fãùs
[
‹¡
].
chªû
 + (
viùim
->
pcd©a
->
»mÜt_couÁ
 / 10))))

185 
ÿn_add
 = 
Œue
;

187 ià(
	`HAS_RAFF
(
viùim
, 
¿fãùs
[
‹¡
].
id
))

188 
ÿn_add
 = 
çl£
;

191 ià(
¿fãùs
[
‹¡
].
group
 != 0)

192 ià(
	`HAS_RAFF_GROUP
(
viùim
, 
¿fãùs
[
‹¡
].
group
))

193 
ÿn_add
 = 
çl£
;

195 !
ÿn_add
);

197 
viùim
->
pcd©a
->
¿fãù
[
¶aû
] = 
¿fãùs
[
‹¡
].
id
;

199 
	`¿ff_add_to_ch¬
(
viùim
, 
‹¡
);

201 ià(
ch
 !ğ
viùim
)

202 
	`±c
(
ch
, "({C%3d{xè{W%s{x‡dded.\n", 
¿fãùs
[
‹¡
].
id
,„afãùs[‹¡].
desütiÚ
);

204 
	`±c
(
viùim
, "{C--- {W%s.{x\n", 
¿fãùs
[
‹¡
].
desütiÚ
);

205 
	}
}

207 
	$rŞl_¿fãùs
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

211 
c
;

213 
c
 = 0; c < 
viùim
->
pcd©a
->
»mÜt_couÁ
 / 10 + 1; c++)

214 
	`rŞl_Úe_¿ff
(
ch
, 
viùim
, 
c
);

215 
	}
}

221 
boŞ
 
	$HAS_EXTRACLASS
(
Ch¬aù”
 *
ch
, 
skl
::
ty³
 
¢
)

223 
i
;

225 ià(
¢
 =ğ
skl
::
ty³
::
unknown
)

226  
çl£
;

228 ià(
ch
->
	`is_Åc
())

229  
çl£
;

231 
i
 = 0; i < ((
ch
->
pcd©a
->
»mÜt_couÁ
 / 
EXTRACLASS_SLOT_LEVELS
) + 1); i++) {

232 ià(
ch
->
pcd©a
->
exŒaşass
[
i
] =ğ
¢
)

233  
Œue
;

236  
çl£
;

237 
	}
}

239 
boŞ
 
	$CAN_USE_RSKILL
(
Ch¬aù”
 *
ch
, 
skl
::
ty³
 
¢
)

241 ià(
ch
->
	`is_Åc
()) {

242 ià(
skl
::
	`lookup
(
¢
).
¥–l_fun
 =ğ
¥–l_nuÎ
)

243  
çl£
;

245  
Œue
;

248 ià(
	`IS_IMMORTAL
(
ch
))

249  
Œue
;

251 ià(!
	`IS_REMORT
(
ch
))

252  
çl£
;

254 ià(
ch
->
gud
 =ğ
Gud
::
nÚe
)

255  
çl£
;

257 ià(!
	`g‘_skl_Ëv–
(
ch
, 
¢
))

258  
çl£
;

260 ià((
ch
->
gud
 !ğ
skl
::
	`lookup
(
¢
).
»mÜt_gud
è&& (!
	`HAS_EXTRACLASS
(ch, sn)))

261  
çl£
;

263  
Œue
;

264 
	}
}

266 
	$li¡_exŒaskl
(
Ch¬aù”
 *
ch
)

268 ià(
ch
->
gud
 =ğ
Gud
::
nÚe
)

271 
SŒšg
 
ouut
;

272 
ouut
 += "\n {BExtraclass Remort Skills{x\n";

274 
ú
 = 
Gud
::
fœ¡
; cÀ< Gud::
size
; cn++) {

275 ià(!
	`IS_IMMORTAL
(
ch
))

276 ià(
ú
 =ğ
ch
->
gud
)

279 
ouut
 +ğ
FÜm©
::
	`fÜm©
("\n{W% Skls{x\À ", 
gud_bË
[
ú
].
Çme
.
	`ÿp™®ize
());

280 
cŞ
 = 0;

282 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

283 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

284 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

286 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

289 ià(
’Œy
.
»mÜt_gud
 !ğ
ú
)

292 ià(!
	`IS_IMMORTAL
(
ch
)

293 && (
’Œy
.
»mÜt_gud
 =ğ
ch
->
gud


294 || 
	`g‘_u§bË_Ëv–
(
ty³
, 
ch
->
gud
) <= 0

295 || 
	`g‘_u§bË_Ëv–
(
ty³
, 
ch
->
gud
è> 
LEVEL_HERO
))

298 
ouut
 +ğ
FÜm©
::
	`fÜm©
("%-15s %s%-8d{x",

299 
’Œy
.
Çme
,

300 
ch
->
Œaš
 >ğ
’Œy
.
¿tšg
[ch->
gud
] ? "{C" : "{T",

301 
’Œy
.
¿tšg
[
ch
->
gud
]);

303 ià(++
cŞ
 % 3 == 0)

304 
ouut
 += "\n";

307 
ouut
 += "\n";

309 ià(
cŞ
 % 3 != 0)

310 
ouut
 += "\n";

313 
	`·ge_to_ch¬
(
ouut
, 
ch
);

314 
	}
}

316 
	$do_”emÜt
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

318 
SŒšg
 
ouut
;

319 
x
;

320 
skl
::
ty³
 
¢
;

322 
SŒšg
 
¬g1
;

323 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

325 ià(
ch
->
	`is_Åc
()) {

326 
	`do_huh
(
ch
);

330 ià(
	`IS_IMMORTAL
(
ch
)) {

331 
	`li¡_exŒaskl
(
ch
);

335 ià(
ch
->
pcd©a
->
»mÜt_couÁ
 < 1) {

336 
	`do_huh
(
ch
);

341 ià(
¬g1
.
	`em±y
()) {

342 
	`li¡_exŒaskl
(
ch
);

344 ià(
ch
->
pcd©a
->
exŒaşass
[0] !ğ
skl
::
ty³
::
unknown


345 || 
ch
->
pcd©a
->
exŒaşass
[1] !ğ
skl
::
ty³
::
unknown


346 || 
ch
->
pcd©a
->
exŒaşass
[2] !ğ
skl
::
ty³
::
unknown


347 || 
ch
->
pcd©a
->
exŒaşass
[3] !ğ
skl
::
ty³
::
unknown


348 || 
ch
->
pcd©a
->
exŒaşass
[4] !ğ
skl
::
ty³
::
unknown
) {

349 
ouut
 +ğ
FÜm©
::
	`fÜm©
("\nYour currentƒxtraclass skill%s",

350 
ch
->
pcd©a
->
exŒaşass
[1] !ğ
skl
::
ty³
::
unknown
 ? "s‡re" : " is");

352 ià(
ch
->
pcd©a
->
exŒaşass
[0] !ğ
skl
::
ty³
::
unknown
)

353 
ouut
 +ğ
FÜm©
::
	`fÜm©
(" %s",

354 
skl
::
	`lookup
(
ch
->
pcd©a
->
exŒaşass
[0]).
Çme
);

356 
x
 = 1; x < 
ch
->
pcd©a
->
»mÜt_couÁ
 / 
EXTRACLASS_SLOT_LEVELS
 + 1; x++)

357 ià(
ch
->
pcd©a
->
exŒaşass
[
x
] !ğ
skl
::
ty³
::
unknown
)

358 
ouut
 +ğ
FÜm©
::
	`fÜm©
(", %s",

359 
skl
::
	`lookup
(
ch
->
pcd©a
->
exŒaşass
[
x
]).
Çme
);

361 
ouut
 += ".\n";

362 
	`·ge_to_ch¬
(
ouut
, 
ch
);

369 ià((
¢
 = 
skl
::
	`lookup
(
¬g1
)è=ğskl::
ty³
::
unknown
) {

370 
	`¡c
("Th© i nÙƒv’‡ v®id skl, much†es ¨»mÜˆskl.\n", 
ch
);

375 ià(
skl
::
	`lookup
(
¢
).
»mÜt_gud
 =ğ
Gud
::
nÚe
) {

376 
	`¡c
("Th© i nÙ‡„emÜˆskl.\n", 
ch
);

381 ià(
skl
::
	`lookup
(
¢
).
»mÜt_gud
 =ğ
ch
->
gud
) {

382 
	`¡c
("You havknowËdgoàthi skÈ®»ady,…ick oÃ outsidyou¸şass.\n", 
ch
);

387 ià(
	`g‘_u§bË_Ëv–
(
¢
, 
ch
->
gud
) <= 0

388 || 
	`g‘_u§bË_Ëv–
(
¢
, 
ch
->
gud
è> 
LEVEL_HERO
) {

389 
	`¡c
("You¸şas ÿÂÙ gašh© skl.\n", 
ch
);

394 ià(
	`HAS_EXTRACLASS
(
ch
, 
¢
)) {

395 
	`¡c
("You‡Ì—dy knowh© skl.\n", 
ch
);

399 ià(
ch
->
Œaš
 < 
skl
::
	`lookup
(
¢
).
¿tšg
[ch->
gud
]) {

400 
	`¡c
("You dØnÙ hav’ough¿ššgØma¡”hi skl.\n", 
ch
);

405 
x
 = 0; x < 
ch
->
pcd©a
->
»mÜt_couÁ
 / 
EXTRACLASS_SLOT_LEVELS
 + 1; x++) {

406 ià(
ch
->
pcd©a
->
exŒaşass
[
x
] =ğ
skl
::
ty³
::
unknown
) {

407 
ch
->
pcd©a
->
exŒaşass
[
x
] = 
¢
;

409 ià(
	`g‘_Ë¬Ãd
(
ch
, 
¢
) == 0)

410 
	`£t_Ë¬Ãd
(
ch
, 
¢
, 1);

412 
ch
->
Œaš
 -ğ
skl
::
	`lookup
(
¢
).
¿tšg
[ch->
gud
];

413 
	`±c
(
ch
, "You have gained %s‡s‡nƒxtraclass„emort skill.\n",

414 
skl
::
	`lookup
(
¢
).
Çme
);

420 
	`¡c
("You hav’oughƒxŒaşas »mÜˆskls! DÚ'ˆbg»edy!\n", 
ch
);

421 
	}
}

425 
	$do_»mÜt
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

427 
Ch¬aù”
 *
viùim
;

428 
buf
[
MSL
];

429 
¿û
, 
x
, 
c
;

431 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
;

432 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

433 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

434 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g3
);

436 ià(
¬g1
.
	`em±y
()

437 || (!
¬g2
.
	`em±y
()

438 && (
¬g3
.
	`em±y
()

439 || 
¬gum’t
.
	`em±y
()))) {

440 
	`¡c
("Syntax:\n"

442 "„emÜˆ<viùim> <¿û> <de™y> <t™Ë>\n", 
ch
);

446 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g1
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

447 
	`¡c
("Hmmm...they mu¡ hav¿Àofàš f—¸>=).\n", 
ch
);

451 ià(
	`IS_IMMORTAL
(
viùim
)) {

452 
	`¡c
("Thi ÿÀÚly bu£d oÀmÜls.\n", 
ch
);

456 ià(
viùim
->
Ëv–
 !ğ
LEVEL_HERO
) {

457 
	`¡c
("OÆy h”Û ÿÀ»mÜt.\n", 
ch
);

461 ià(
viùim
->
pcd©a
->
»mÜt_couÁ
 >= 99) {

462 
	`¡c
("That…layer can‚o†onger„emort. If you've hithis†imit you‚eed\n"

463 "tØlkhcod” štØchªgšghwhØli¡. A»n'ˆyou s³cŸl?\n", 
ch
);

467 ià(
¬g2
.
	`em±y
(è&& 
viùim
->
pcd©a
->
»mÜt_couÁ
 < 1) {

468 
	`¡c
("Syntax:\n"

469 "„emÜˆ<viùim> <¿û> <de™y> <t™Ë>\n", 
ch
);

474 
x
 = 0; x < 
MAX_WEAR
; x++) {

475 ià(
	`g‘_eq_ch¬
(
viùim
, 
x
è!ğ
nuÎ±r
) {

476 
	`¡c
("T–ÈthemØ»mov®Èoàtheœƒq fœ¡.\n", 
ch
);

481 ià(
¬g2
.
	`em±y
())

482 
¿û
 = 
viùim
->race;

484 
¿û
 = 
	`¿û_lookup
(
¬g2
);

486 ià((
¿û
 = 
	`¿û_lookup
(
¬g2
)) == 0

487 || !
¿û_bË
[
¿û
].
pc_¿û
) {

488 
	`¡c
("Th© i nÙ‡ v®id„aû. PËa£ choo£ from:\n", 
ch
);

490 cÚ¡‡uto& 
’Œy
 : 
¿û_bË
) {

491 ià(!
’Œy
.
pc_¿û
)

494 
	`¡c
(
¿û_bË
[
¿û
].
Çme
, 
ch
);

495 
	`¡c
(" ", 
ch
);

498 
	`¡c
("\n", 
ch
);

502 ià((
viùim
->
pcd©a
->
»mÜt_couÁ
 + 1è< 
pc_¿û_bË
[
¿û
].
»mÜt_Ëv–
) {

503 
	`¡c
("They‡»‚Ùƒx³r›nûdƒnough fÜh©„aû.\n", 
ch
);

508 
afãù
::
	`»move_®l_äom_ch¬
(
viùim
, 
Œue
);

509 
afãù
::
	`»move_®l_äom_ch¬
(
viùim
, 
çl£
);

511 
viùim
->
¿û
 =„ace;

513 
afãù
::
	`add_¿cŸl_to_ch¬
(
viùim
);

515 
viùim
->
Ëv–
 = 1;

517 
viùim
->
h™
 = 
	`ATTR_BASE
(viùim, 
APPLY_HIT
) = 20;

518 
viùim
->
mªa
 = 
	`ATTR_BASE
(viùim, 
APPLY_MANA
) = 100;

519 
viùim
->
¡am
 = 
	`ATTR_BASE
(viùim, 
APPLY_STAM
) = 100;

521 
viùim
->
fÜm_æags
 = 
¿û_bË
[
¿û
].
fÜm
;

522 
viùim
->
·¹s_æags
 = 
¿û_bË
[
¿û
].
·¹s
;

525 
¡©
 = 0; sˆ< 
MAX_STATS
; stat++)

526 
	`ATTR_BASE
(
viùim
, 
	`¡©_to_©Œ
(
¡©
))

527 ğ
¡d
::
	`mš
(
	`ATTR_BASE
(
viùim
, 
	`¡©_to_©Œ
(
¡©
)), 
	`g‘_max_Œaš
(victim, stat));

529 ià(!
¬g2
.
	`em±y
()) {

530 
viùim
->
pcd©a
->
de™y
 = 
¬g3
;

531 
viùim
->
pcd©a
->
¡©us
 = 
¬gum’t
;

534 
viùim
->
pcd©a
->
»mÜt_couÁ
++;

535 
viùim
->
exp
 = 
	`exp_³r_Ëv–
(viùim, viùim->
pcd©a
->
pošts
);

537 ià(
viùim
->
³t
 !ğ
nuÎ±r
) {

538 
afãù
::
	`»move_®l_äom_ch¬
(
viùim
->
³t
, 
çl£
);

541 
viùim
->
³t
->
Ëv–
 = 1;

542 
viùim
->
³t
->
h™
 = 
	`ATTR_BASE
(viùim->³t, 
APPLY_HIT
) = 20;

543 
viùim
->
³t
->
mªa
 = 
	`ATTR_BASE
(viùim->³t, 
APPLY_MANA
) = 100;

544 
viùim
->
³t
->
¡am
 = 
	`ATTR_BASE
(viùim->³t, 
APPLY_STAM
) = 100;

545 
	`ATTR_BASE
(
viùim
->
³t
, 
APPLY_HITROLL
) = 2;

546 
	`ATTR_BASE
(
viùim
->
³t
, 
APPLY_DAMROLL
) = 0;

547 
viùim
->
³t
->
damage
[
DICE_NUMBER
] = 1;

548 
viùim
->
³t
->
damage
[
DICE_TYPE
] = 4;

549 
¡©
 = 0; sˆ< 
MAX_STATS
; stat++)

550 
	`ATTR_BASE
(
viùim
->
³t
, 
	`¡©_to_©Œ
(
¡©
)) = 12;

551 
	`ATTR_BASE
(
viùim
->
³t
, 
APPLY_SAVES
) = 0;

553 
c
 = 0; c < 4; c++)

554 
viùim
->
³t
->
¬mÜ_ba£
[
c
] = 100;

557 
viùim
->
pcd©a
->
Œašs_to_h™
 = 0;

558 
viùim
->
pcd©a
->
Œašs_to_mªa
 = 0;

559 
viùim
->
pcd©a
->
Œašs_to_¡am
 = 0;

562 
c
 = 0; c < 10; c++)

563 
viùim
->
pcd©a
->
¿fãù
[
c
] = 0;

566 
c
 = 0; c < 5; c++)

567 
viùim
->
pcd©a
->
exŒaşass
[
c
] = 
skl
::
ty³
::
unknown
;

569 
	`¡c
("You¸de™y be¡ow upÚ you...\n", 
viùim
);

570 
	`rŞl_¿fãùs
(
ch
, 
viùim
);

572 ià(
viùim
->
pcd©a
->
»mÜt_couÁ
 == 1)

573 
viùim
->
pcd©a
->
¶r_æags
 +ğ
PLR_SHOWRAFF
;

575 
FÜm©
::
	`¥rštf
(
buf
, "% ha b“À»bÜn!", 
viùim
->
Çme
);

576 
	`do_£nd_ªnounû
(
viùim
, 
buf
);

577 
	`¡c
("You sudd’ly f“Èlik¨Ãwb›!! Do'h!!!\n", 
viùim
);

578 
	`¡c
("SucûssfuÈRemÜt.\n", 
ch
);

579 
	}
}

	@src/rmagic.cc

3 
	~"aù.hh
"

4 
	~"afãù/Afãù.hh
"

5 
	~"A»a.hh
"

6 
	~"Ch¬aù”.hh
"

7 
	~"deş¬e.hh
"

8 
	~"di¥–.hh
"

9 
	~"FÏgs.hh
"

10 
	~"Game.hh
"

11 
	~"GameTime.hh
"

12 
	~"Loggšg.hh
"

13 
	~"magic.hh
"

14 
	~"m”c.hh
"

15 
	~"Objeù.hh
"

16 
	~"ObjeùV®ue.hh
"

17 
	~"PÏy”.hh
"

18 
	~"¿ndom.hh
"

19 
	~"Room.hh
"

20 
	~"SŒšg.hh
"

21 
	~"WÜld.hh
"

24 
w—r_obj
 
¬gs
((
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, 
boŞ
 
fR•Ïû
));

26 
boŞ
 
glob®_quick
;

30 
	$¥–l_sh“n
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

32 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

34 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
sh“n
)) {

35 ià(
viùim
 =ğ
ch
)

36 
	`¡c
("You¸¬mÜ i ®»ady cß‹d w™h magiÿÈ¡“l.\n", 
ch
);

38 
	`aù
("$N' ¬mÜ i ®»ady cß‹d w™h magiÿÈ¡“l.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

42 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

43 
afãù
::
ty³
::
sh“n
,

44 
Ëv–
,

45 
Ëv–
,

46 
evŞutiÚ
,

47 
çl£


50 
	`¡c
("A…rÙeùivsh“Àcov” you¸¬mÜ.\n", 
viùim
);

51 
	}
}

53 
	$¥–l_focus
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

55 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

57 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
focus
)) {

58 
	`¡c
("You¸¥–l ¬®»ady focu£d.\n", 
ch
);

62 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

63 
afãù
::
ty³
::
focus
,

64 
Ëv–
,

65 
Ëv–
 / 3,

66 
evŞutiÚ
,

67 
çl£


70 
	`¡c
("You focu Ú you¸magiø-- you f“ÈmÜd—dly!\n", 
viùim
);

71 
	}
}

73 
	$¥–l_·¿lyze
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

75 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

77 ià(
ch
 =ğ
viùim
) {

78 
	`¡c
("Th© wouldn'ˆbv”y sm¬ˆnow, would it?\n", 
ch
);

82 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
·¿lyze
)) {

83 
	`aù
("$N i ®»ady…¬®yzed.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

87 ià(!
viùim
->
	`is_Åc
(è&& 
	`§ves_¥–l
(
Ëv–
, viùim, 
DAM_MENTAL
)) {

88 
	`aù
("$N slows, buˆÚly mom’ry. You¸·¿lysi ha çed.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

92 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

93 
afãù
::
ty³
::
·¿lyze
,

94 
Ëv–
,

95 
Ëv–
 / 20,

96 
evŞutiÚ
,

97 
çl£


100 
	`¡c
("You cª'ˆmovªymÜe!\n", 
viùim
);

101 
	`aù
("$À£em ·¿lyzed!", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

102 
	}
}

104 
	$¥–l_œÚskš
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

106 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

108 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
œÚskš
)) {

109 
	`¡c
("You¸skš i ®»ady h¬d‡ œÚ.\n", 
ch
);

113 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

114 
afãù
::
ty³
::
œÚskš
,

115 
Ëv–
,

116 
Ëv–
,

117 
evŞutiÚ
,

118 
çl£


121 
	`¡c
("You¸skšake ÚhcÚsi¡’cy oàœÚ.\n", 
viùim
);

122 
	}
}

126 
	$¥–l_b¬r›r
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

128 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

130 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
b¬r›r
)) {

131 ià(
viùim
 =ğ
ch
)

132 
	`¡c
("You‡»‡Ì—dy su¼ounded by‡ b¬r›r.\n", 
ch
);

134 
	`aù
("$N i ®»ady su¼ounded by‡ b¬r›r.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

138 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

139 
afãù
::
ty³
::
b¬r›r
,

140 
Ëv–
,

141 
Ëv–
 / 5,

142 
evŞutiÚ
,

143 
çl£


146 
	`¡c
("You‡» su¼ounded by‡…rÙeùivb¬r›r.\n", 
viùim
);

147 
	}
}

150 
	$¥–l_dazzË
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

152 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

153 
chªû
;

155 ià(
ch
 =ğ
viùim
 && ch->
fightšg
 !ğ
nuÎ±r
)

156 
viùim
 = 
ch
->
fightšg
;

158 ià(
	`is_blšded
(
viùim
)) {

159 
	`¡c
("They cª'ˆ£e, wh© good would iˆdo?\n", 
ch
);

163 ià(
ch
 =ğ
viùim
) {

164 
	`¡c
("And ju¡ whØ¬youryšgØdazzË?\n", 
ch
);

169 
chªû
 = 70 - (
viùim
->
Ëv–
 -†ev–è* 2 + 
	`GET_ATTR_SAVES
(victim);

172 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
b”£rk
))

173 
chªû
 -ğ
viùim
->
Ëv–
 / 4;

176 ià(
ch
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
šside


177 && 
ch
->
š_room
->
	`£ùÜ_ty³
(è!ğ
SeùÜ
::
c™y
) {

178 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_DARK
))

179 
chªû
 += 25;

180 ià(
Game
::
	`wÜld
().
time
.
suÆight
 =ğ
GameTime
::
Night
)

181 
chªû
 += 20;

182 ià(
Game
::
	`wÜld
().
time
.
suÆight
 =ğ
GameTime
::
Sun£t
)

183 
chªû
 += 15;

186 
def
 = 
	`GET_DEFENSE_MOD
(
viùim
, 
DAM_LIGHT
);

188 ià(
def
 >= 100)

189 
chªû
 = 0;

191 
chªû
 -ğ25 * 
def
 / 100;

194 ià(
	`numb”_³rûÁ
(è< 
chªû
) {

195 
	`aù
("A brilliant†ight flashes from $n's fingertips,‡nd $s blinded opponent stops fighting.",

196 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

197 
	`aù
("You¸æash dazzË $N' eyes,‡ndhfighˆ¡İs.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

198 
	`aù
("A brilliant flash of†ight dazzles yourƒyes,‡ndhe fighting stops.",

199 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

201 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

202 
afãù
::
ty³
::
dazzË
,

203 
Ëv–
,

205 
evŞutiÚ
,

206 
çl£


209 
	`¡İ_fightšg
(
ch
, 
Œue
);

213 
	`aù
("A brilliant flash of†ight bursts from $n's fingertips, but‚othing happens.",

214 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

215 
	`aù
("You¸æash oàlighˆha nØefãù.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

216 
	`aù
("A brilliant flash of†ight bursts from $n's fingertips, but you close yourƒyes inime.",

217 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

219 
	}
}

222 
	$¥–l_fuÎ_h—l
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

224 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

225 
mªa
, 
mªa_co¡
;

226 
mªa
 = 
	`g‘_skl_co¡
(
ch
, 
¢
);

227 
mªa_co¡
 = (
	`GET_MAX_HIT
(
ch
è/ 4è- 
mªa
;

229 ià(
	`HAS_RAFF
(
ch
, 
RAFF_COSTLYSPELLS
))

230 
mªa_co¡
 += mana_cost / 5;

232 ià(
	`HAS_RAFF
(
ch
, 
RAFF_CHEAPSPELLS
))

233 
mªa_co¡
 -= mana_cost / 5;

235 ià(
ch
->
mªa
 < 
mªa_co¡
) {

236 
	`¡c
("You dÚ'ˆhav’ough mªa.\n", 
ch
);

237 
ch
->
mªa
 += mana;

256 
viùim
->
h™
 = 
	`GET_MAX_HIT
(victim);

257 
ch
->
mªa
 -ğ
mªa_co¡
;

258 
	`aù
("$Àlook »vived‡ $ wound vªish com¶‘–y.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

259 
	`¡c
("You¸wound vªish com¶‘–y.\n", 
viùim
);

260 
	}
}

264 
	$¥–l_midnight
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

266 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

268 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
midnight
è&& (viùim =ğ
ch
)) {

269 ià(
viùim
 =ğ
ch
)

270 
	`¡c
("You faØšvadthshadow fu¹h”.\n", 
ch
);

272 
	`aù
("You faØşßkhem.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

276 
	`¡c
("You bËnd iÁØthnight.\n", 
viùim
);

277 
	`aù
("$Àvªishe štØthshadows.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

279 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

280 
afãù
::
ty³
::
midnight
,

281 
Ëv–
,

283 
evŞutiÚ
,

284 
çl£


286 
	}
}

290 
	$¥–l_§p
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

292 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

293 
dam
, 
muÉ
;

294 
dam
 = 
	`diû
(
Ëv–
, 22);

295 
muÉ
 = ((100 - (((
ch
->
h™
 * 100è/ 
	`GET_MAX_HIT
(ch)) * 2)) * 2);

296 
dam
 = 
¡d
::
	`max
(dam, dam + ((dam * 
muÉ
) / 100));

298 ià(
ch
->
h™
 < 31000) {

299 
def_mod
 = 
	`GET_DEFENSE_MOD
(
viùim
, 
DAM_NEGATIVE
);

301 ià(
def_mod
 < 100) {

302 
gaš
 = 
dam
;

303 
gaš
 -ğgaš * 
def_mod
 / 100;

304 
ch
->
h™
 +ğ(
gaš
 / 10);

308 ià(
dam
 != 0) {

309 
	`¡c
("You f“Èäa‡nd w—k.\n", 
viùim
);

310 
	`¡c
("You‡» in¡ªy„ev™®ized!\n", 
ch
);

313 
	`damage
(
ch
, 
viùim
, 
dam
, 
¢
, -1, 
DAM_NEGATIVE
, 
Œue
,rue);

314 
	}
}

317 
	$¥–l_·š
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

319 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

320 
dam
;

322 ià(
ch
 =ğ
viùim
) {

323 
	`¡c
("De¥™you¸masochi¡iø‹nd’c›s, you cª'ˆdØth©.\n", 
ch
);

327 
	`aù
("You be¡ow…u»‡gÚy upÚ $N!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

328 
	`aù
("$N wr™he š‡gÚy‡ th·š oà$S wound ov”ke $M.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

329 
	`aù
("You sü—m iÀagÚy‡ th·š oàyou¸wound šü—£s.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

330 
dam
 = (
¡d
::
	`mš
(
viùim
->
h™
, (4 * 
Ëv–
))è+ 
	`numb”_¿nge
(1, (level * 2));

331 
	`damage
(
ch
, (
Ch¬aù”
 *è
vo
, 
dam
, 
¢
, -1, 
DAM_HARM
, 
Œue
,rue);

333 ià(
ch
->
fightšg
 !ğ
nuÎ±r
) {

334 
	`¥–l_¦ow
(
skl
::
ty³
::
¦ow
, 
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

335 
	`¥–l_w—k’
(
skl
::
ty³
::
w—k’
, 
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

336 
	`¥–l_¶ague
(
skl
::
ty³
::
¶ague
, 
Ëv–
, 
ch
, (*è
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
¢
));

340 
	}
}

343 
	$¥–l_hex
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

345 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

347 ià(
ch
 =ğ
viùim
) {

348 
	`¡c
("MÜÈã¬ oàthd¬k god ´ev’t you from hexšg your£lf.\n", 
ch
);

352 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
hex
)) {

353 
	`aù
("Thd¬k god hav®»ady cur£d $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

357 
	`aù
("UnhŞy d¬kÃs su¼ound $N, guidšg you¸©cks.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

358 
	`aù
("$N i su¼ounded by‡ d¬k mi¡.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

359 
	`aù
("AÀunhŞy mi¡ su¼ound you.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

361 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

362 
afãù
::
ty³
::
hex
,

363 
Ëv–
,

364 
Ëv–
 / 30,

365 
evŞutiÚ
,

366 
çl£


368 
	}
}

371 
	$¥–l_bÚe_w®l
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

373 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

375 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

376 
afãù
::
ty³
::
bÚe_w®l
,

377 
Ëv–
,

378 
Ëv–
,

379 
evŞutiÚ
,

380 
çl£


383 
	`¡c
("BÚe liá fromhground‡nd begšØswœÈ¬ound you.\n", 
ch
);

384 
	`aù
("BÚe liá fromhground‡nd begšØswœÈ¬ound $n.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

385 
	}
}

389 
	$¥–l_fÜû
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

391 
Ch¬aù”
 *
viùim
 = (Ch¬aù” *è
vo
;

393 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
fÜû_sh›ld
)) {

394 ià(
viùim
 =ğ
ch
)

395 
	`¡c
("You‡»‡Ì—dy…rÙeùed byhfÜû.\n", 
ch
);

397 
	`aù
("$N i ®»ady…rÙeùed byhfÜû.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

401 
	`aù
("$Ài su¼ounded by‡ my¡iÿÈau¿.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

402 
	`¡c
("You‡» su¼ounded by‡ my¡iÿÈau¿.\n", 
viùim
);

404 
afãù
::
	`add_ty³_to_ch¬
(
viùim
,

405 
afãù
::
ty³
::
fÜû_sh›ld
,

406 
Ëv–
,

408 
evŞutiÚ
,

409 
çl£


411 
	}
}

414 
	$¥–l_hŞy_swÜd
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

416 
Objeù
 *
swÜd
, *
w›lded
;

418 ià(!
	`IS_IMMORTAL
(
ch
)) {

419 ià(
ch
->
®ignm’t
 < 1000 && ch->alignment > -1000) {

420 
	`¡c
("Impur™y iÀyou¸h—¹…»v’t summÚšg‡ godly bÏde.\n", 
ch
);

425 
w›lded
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_WIELD
);

427 ià(
w›lded
 !ğ
nuÎ±r
 && 
	`IS_OBJ_STAT
(w›lded, 
ITEM_NOREMOVE
)) {

428 
	`aù
("You cª'ˆ»mov$p.", 
ch
, 
w›lded
, 
nuÎ±r
, 
TO_CHAR
);

433 
swÜd
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_HOLYSWORD
), 0);

435 ià(! 
swÜd
) {

436 
Loggšg
::
	`bug
("Memoryƒrror while creating holy sword.", 0);

437 
	`¡c
("UÇbËØü—‹‡ hŞy swÜd.\n", 
ch
);

441 
swÜd
->
v®ue
[1] = 
Ëv–
 / 8 + 1;

442 
swÜd
->
tim”
 = 
Ëv–
 * 2 - 
	`numb”_¿nge
(0,†evel / 2);

443 
swÜd
->
Ëv–
 =†evel;

444 
swÜd
->
exŒa_æags
 +ğ
ITEM_INVENTORY
;

446 
afãù
::
Afãù
 
af
;

447 
af
.
wh”e
 = 
TO_WEAPON
;

448 
af
.
Ëv–
 =†evel;

449 
af
.
du¿tiÚ
 = -1;

450 
af
.
loÿtiÚ
 = 0;

451 
af
.
modif›r
 = 0;

452 
af
.
evŞutiÚ
 =ƒvolution;

454 ià(
swÜd
->
Ëv–
 >= 20) {

455 
af
.
ty³
 = 
afãù
::ty³::
w—pÚ_shockšg
;

456 
afãù
::
	`cİy_to_obj
(
swÜd
, &
af
);

459 ià(
swÜd
->
Ëv–
 >= 45){

460 
af
.
ty³
 = 
afãù
::ty³::
w—pÚ_vÜ·l
;

461 
afãù
::
	`cİy_to_obj
(
swÜd
, &
af
);

464 ià(
swÜd
->
Ëv–
 >= 70){

465 
af
.
ty³
 = 
afãù
::ty³::
w—pÚ_æamšg
;

466 
afãù
::
	`cİy_to_obj
(
swÜd
, &
af
);

469 
af
.
wh”e
 = 
TO_OBJECT
;

470 
af
.
ty³
 = 
afãù
::ty³::
’chªt_w—pÚ
;

471 
af
.
du¿tiÚ
 = -1;

472 
af
.
modif›r
 = 
Ëv–
 / 10 + 1;

473 
af
.
	`b™veùÜ
(0);

474 
af
.
evŞutiÚ
 =ƒvolution;

476 
af
.
loÿtiÚ
 = 
APPLY_HITROLL
;

477 
afãù
::
	`još_to_obj
(
swÜd
, &
af
);

479 
af
.
loÿtiÚ
 = 
APPLY_DAMROLL
;

480 
afãù
::
	`još_to_obj
(
swÜd
, &
af
);

482 ià(
ch
->
®ignm’t
 >= 1) {

483 
swÜd
->
shÜt_desü
 = "{Wa Holy Avenger{x";

484 
swÜd
->
exŒa_æags
 +ğ
ITEM_BLESS
;

485 
swÜd
->
exŒa_æags
 +ğ
ITEM_ANTI_EVIL
;

488 
swÜd
->
shÜt_desü
 = "{can Unholy Avenger{x";

489 
swÜd
->
exŒa_æags
 +ğ
ITEM_EVIL
;

490 
swÜd
->
exŒa_æags
 +ğ
ITEM_ANTI_GOOD
;

493 
	`aù
("$À´ay fÜ‡ mom’t,‡nd‡ hŞy swÜd m©”Ÿlize š $ hªd.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

494 
	`¡c
("You summÚ‡ godly bÏdfÜ you¸divšju¡iû.\n", 
ch
);

495 
	`obj_to_ch¬
(
swÜd
, 
ch
);

496 
	`w—r_obj
(
ch
, 
swÜd
, 
Œue
);

497 
ch
->
mªa
 = 0;

499 
	}
}

504 
	$¥–l_quick
(
skl
::
ty³
 
¢
, 
Ëv–
, 
Ch¬aù”
 *
ch
, *
vo
, 
rg‘
, 
evŞutiÚ
)

507 
	`aù
("$ÀbÏze štØ¨wd flu¼y oà©cks!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

508 
	`¡c
("You bÏzštØ¨wd flu¼y oà©cks!\n", 
ch
);

509 
glob®_quick
 = 
Œue
;

510 
	`muÉi_h™
(
ch
, ch->
fightšg
, 
skl
::
ty³
::
unknown
);

511 
glob®_quick
 = 
çl£
;

512 
	}
}

	@src/save.cc

28 
	~<m­
>

29 
	~<ut™y
>

30 
	~<veùÜ
>

32 
	~"fe.hh
"

33 
	~"../d•s/cJSON/cJSON.h
"

34 
	~"¬gum’t.hh
"

35 
	~"afãù/Afãù.hh
"

36 
	~"JSON/cJSON.hh
"

37 
	~"Ch¬aù”.hh
"

38 
	~"CÏn.hh
"

39 
	~"deş¬e.hh
"

40 
	~"DesütÜ.hh
"

41 
	~"ExŒaDesü.hh
"

42 
	~"FÏgs.hh
"

43 
	~"FÜm©.hh
"

44 
	~"Game.hh
"

45 
	~"š‹½.hh
"

46 
	~"lookup.hh
"

47 
	~"Loggšg.hh
"

48 
	~"memÜy.hh
"

49 
	~"m”c.hh
"

50 
	~"MobePrÙÙy³.hh
"

51 
	~"Objeù.hh
"

52 
	~"ObjeùPrÙÙy³.hh
"

53 
	~"ObjeùV®ue.hh
"

54 
	~"PÏy”.hh
"

55 
	~"Room.hh
"

56 
	~"SŒšg.hh
"

57 
	~"gem/gem.hh
"

58 
	~"sql.hh
"

59 
	~"WÜld.hh
"

62 
	gCURRENT_VERSION
 = 21;

64 
boŞ
 
	gdebug_jsÚ
 = 
çl£
;

68 
»Çme
(cÚ¡ *
Şdâame
, cÚ¡ *
Ãwâame
);

73 
cJSON
 * 
fwr™e_¶ay”
 
¬gs
((
Ch¬aù”
 *
ch
));

74 
cJSON
 * 
fwr™e_ch¬
 
¬gs
((
Ch¬aù”
 *
ch
));

75 
cJSON
 * 
fwr™e_objeùs
 
¬gs
((
Objeù
 *
h—d
));

76 
cJSON
 * 
fwr™e_³t
 
¬gs
((
Ch¬aù”
 *
³t
));

77 
ä—d_ch¬
 
¬gs
((
Ch¬aù”
 *
ch
, 
cJSON
 *
jsÚ
, 
v”siÚ
));

78 
ä—d_¶ay”
 
¬gs
((
Ch¬aù”
 *
ch
, 
cJSON
 *
jsÚ
, 
v”siÚ
));

79 
ä—d_³t
 
¬gs
((
Ch¬aù”
 *
ch
, 
cJSON
 *
jsÚ
, 
v”siÚ
));

80 
ä—d_objeùs
 
¬gs
((
Ch¬aù”
 *
ch
, 
cJSON
 *
jsÚ
, (*
obj_to
)(
Objeù
 *, Ch¬aù” *), 
v”siÚ
));

81 
boŞ
 
	`check_·r£_Çme
(cÚ¡ 
SŒšg
& 
Çme
);

84 cÚ¡ 
Objeù
 *
	`g‘_w¬p_üy¡®
(cÚ¡ 
SŒšg
&);

85 cÚ¡ 
SŒšg
 
	`g‘_w¬p_loc_¡ršg
(cÚ¡ 
Objeù
 *);

92 
	$§ve_ch¬_obj
(
Ch¬aù”
 *
ch
)

94 
¡r§ve
[
MIL
];

95 
FILE
 *
å
;

97 ià(
ch
 =ğ
nuÎ±r
 || ch->
	`is_Åc
())

100 ià(
ch
->
desc
 !ğ
nuÎ±r
 && ch->desc->
Üigš®
 !=‚ullptr)

101 
ch
 = ch->
desc
->
Üigš®
;

103 
ch
->
pcd©a
->
Ï¡_§ved
 = 
Game
::
cu¼’t_time
;

105 
cJSON
 *
roÙ
 = 
	`cJSON_C»©eObjeù
();

107 
	`cJSON_AddNumb”ToObjeù
(
roÙ
, "v”siÚ", 
CURRENT_VERSION
);

108 
	`cJSON_AddI‹mToObjeù
(
roÙ
, "¶ay”", 
	`fwr™e_¶ay”
(
ch
));

109 
	`cJSON_AddI‹mToObjeù
(
roÙ
, "ch¬aù”", 
	`fwr™e_ch¬
(
ch
));

111 
	`cJSON_AddI‹mToObjeù
(
roÙ
, "šv’tÜy", 
	`fwr™e_objeùs
(
ch
->
ÿ¼yšg
));

112 
	`cJSON_AddI‹mToObjeù
(
roÙ
, "lock”", 
	`fwr™e_objeùs
(
ch
->
pcd©a
->
lock”
));

113 
	`cJSON_AddI‹mToObjeù
(
roÙ
, "¡rÚgbox", 
	`fwr™e_objeùs
(
ch
->
pcd©a
->
¡rÚgbox
));

115 ià(
ch
->
³t
) {

116 
	`cJSON_AddI‹mToObjeù
(
roÙ
, "³t", 
	`fwr™e_³t
(
ch
->
³t
));

117 
	`cJSON_AddI‹mToObjeù
(
roÙ
, "³t_šv’tÜy", 
	`fwr™e_objeùs
(
ch
->
³t
->
ÿ¼yšg
));

120 *
JSON¡ršg
 = 
	`cJSON_Pršt
(
roÙ
);

121 
	`cJSON_D–‘e
(
roÙ
);

124 
SŒšg
 
buf
;

125 
	`Úe_¬gum’t
(
ch
->
Çme
, 
buf
);

126 
FÜm©
::
	`¥rštf
(
¡r§ve
, "%s%s", 
PLAYER_DIR
, 
buf
.
	`low”ÿ£
().
	`ÿp™®ize
());

128 ià((
å
 = 
	`fİ’
(
TEMP_FILE
, "w")è!ğ
nuÎ±r
) {

129 
	`åuts
(
JSON¡ršg
, 
å
);

130 
	`fşo£
(
å
);

131 
	`»Çme
(
TEMP_FILE
, 
¡r§ve
);

134 
Loggšg
::
	`bug
("Save_char_obj: fopen", 0);

135 
	`³¼Ü
(
¡r§ve
);

138 
	`ä“
(
JSON¡ršg
);

139 
	`upd©e_pc_šdex
(
ch
, 
çl£
);

140 
	}
}

142 
	$backup_ch¬_obj
(
Ch¬aù”
 *
ch
)

144 
	`§ve_ch¬_obj
(
ch
);

146 
¡r§ve
[
MIL
], 
¡rback
[MIL];

147 
SŒšg
 
buf
;

148 
	`Úe_¬gum’t
(
ch
->
Çme
, 
buf
);

150 
FÜm©
::
	`¥rštf
(
¡r§ve
, "%s%s", 
PLAYER_DIR
, 
buf
.
	`low”ÿ£
().
	`ÿp™®ize
());

151 
FÜm©
::
	`¥rštf
(
¡rback
, "%s%s", 
BACKUP_DIR
, 
buf
.
	`low”ÿ£
().
	`ÿp™®ize
());

153 
FÜm©
::
	`¥rštf
(
buf
, "ı % %s", 
¡r§ve
, 
¡rback
);

154 
	`sy¡em
(
buf
.
	`c_¡r
());

155 
FÜm©
::
	`¥rštf
(
buf
, "gz -fq %s", 
¡rback
);

156 
	`sy¡em
(
buf
.
	`c_¡r
());

157 
	}
}

159 
cJSON
 *
	$fwr™e_¶ay”
(
Ch¬aù”
 *
ch
)

161 
cJSON
 *
™em
;

162 
cJSON
 *
o
 = 
	`cJSON_C»©eObjeù
();

164 
™em
 = 
nuÎ±r
;

166 ià(!
ch
->
pcd©a
->
®Ÿs
.
	`em±y
()) {

167 
™em
 = 
	`cJSON_C»©eA¼ay
();

169 cÚ¡‡uto& 
kv
: 
ch
->
pcd©a
->
®Ÿs
) {

170 
cJSON
 *
®Ÿs
 = 
	`cJSON_C»©eA¼ay
();

171 
	`cJSON_AddI‹mToA¼ay
(
®Ÿs
, 
	`cJSON_C»©eSŒšg
(
kv
.
fœ¡
.
	`c_¡r
()));

172 
	`cJSON_AddI‹mToA¼ay
(
®Ÿs
, 
	`cJSON_C»©eSŒšg
(
kv
.
£cÚd
.
	`c_¡r
()));

173 
	`cJSON_AddI‹mToA¼ay
(
™em
, 
®Ÿs
);

176 
	`cJSON_AddI‹mToObjeù
(
o
, "AlŸs", 
™em
);

179 ià(!
ch
->
pcd©a
->
afk
.
	`em±y
())

180 
JSON
::
	`addSŒšgToObjeù
(
o
, "Afk", 
ch
->
pcd©a
->
afk
);

182 
	`cJSON_AddNumb”ToObjeù
(
o
, "Akls", 
ch
->
pcd©a
->
¬’akls
);

183 
	`cJSON_AddNumb”ToObjeù
(
o
, "AkËd", 
ch
->
pcd©a
->
¬’akËd
);

185 ià(!
ch
->
pcd©a
->
au¿
.
	`em±y
())

186 
JSON
::
	`addSŒšgToObjeù
(
o
, "Au¿", 
ch
->
pcd©a
->
au¿
);

188 
	`cJSON_AddNumb”ToObjeù
(
o
, "Back", 
ch
->
pcd©a
->
backup
);

190 ià(!
ch
->
pcd©a
->
bamfš
.
	`em±y
())

191 
JSON
::
	`addSŒšgToObjeù
(
o
, "Bš", 
ch
->
pcd©a
->
bamfš
);

193 ià(!
ch
->
pcd©a
->
bamfout
.
	`em±y
())

194 
JSON
::
	`addSŒšgToObjeù
(
o
, "Bout", 
ch
->
pcd©a
->
bamfout
);

196 
JSON
::
	`addSŒšgToObjeù
(
o
, "Cg½", 
ch
->
pcd©a
->
cgroup_æags
.
	`to_¡ršg
());

198 
™em
 = 
	`cJSON_C»©eObjeù
();

199 
	`cJSON_AddNumb”ToObjeù
(
™em
, "drunk", 
ch
->
pcd©a
->
cÚd™iÚ
[
COND_DRUNK
]);

200 
	`cJSON_AddNumb”ToObjeù
(
™em
, "fuÎ", 
ch
->
pcd©a
->
cÚd™iÚ
[
COND_FULL
]);

201 
	`cJSON_AddNumb”ToObjeù
(
™em
, "thœ¡", 
ch
->
pcd©a
->
cÚd™iÚ
[
COND_THIRST
]);

202 
	`cJSON_AddNumb”ToObjeù
(
™em
, "hung”", 
ch
->
pcd©a
->
cÚd™iÚ
[
COND_HUNGER
]);

203 
	`cJSON_AddI‹mToObjeù
(
o
, "Cnd", 
™em
);

205 
™em
 = 
	`cJSON_C»©eA¼ay
();

206 
pos
 = 0;…o < 
MAX_COLORS
;…os++) {

207 ià(
ch
->
pcd©a
->
cŞÜ
[
pos
] <= 0)

210 
cJSON
 *
p
 = 
	`cJSON_C»©eObjeù
();

211 
	`cJSON_AddNumb”ToObjeù
(
p
, "¦Ù", 
pos
);

212 
	`cJSON_AddNumb”ToObjeù
(
p
, "cŞÜ", 
ch
->
pcd©a
->
cŞÜ
[
pos
]);

213 
	`cJSON_AddNumb”ToObjeù
(
p
, "bŞd", 
ch
->
pcd©a
->
bŞd
[
pos
]);

214 
	`cJSON_AddI‹mToA¼ay
(
™em
, 
p
);

216 
	`cJSON_AddI‹mToObjeù
(
o
, "CŞr", 
™em
);

218 ià(!
ch
->
pcd©a
->
de™y
.
	`em±y
())

219 
JSON
::
	`addSŒšgToObjeù
(
o
, "De™", 
ch
->
pcd©a
->
de™y
);

221 ià(!
ch
->
pcd©a
->
ema
.
	`em±y
())

222 
JSON
::
	`addSŒšgToObjeù
(
o
, "Ema", 
ch
->
pcd©a
->
ema
);

224 
	`cJSON_AddNumb”ToObjeù
(
o
, "FamŸr", 
ch
->
pcd©a
->
çmŸr
);

226 ià(!
ch
->
pcd©a
->
fšg”šfo
.
	`em±y
())

227 
JSON
::
	`addSŒšgToObjeù
(
o
, "Fšf", 
ch
->
pcd©a
->
fšg”šfo
);

229 ià(
ch
->
pcd©a
->
æag_kËr
)

230 
	`cJSON_AddNumb”ToObjeù
(
o
, "FÏgKËr", 
ch
->
pcd©a
->
æag_kËr
);

232 ià(
ch
->
pcd©a
->
æag_th›f
)

233 
	`cJSON_AddNumb”ToObjeù
(
o
, "FÏgTh›f", 
ch
->
pcd©a
->
æag_th›f
);

235 ià(!
ch
->
pcd©a
->
gameš
.
	`em±y
())

236 
JSON
::
	`addSŒšgToObjeù
(
o
, "GameIn", 
ch
->
pcd©a
->
gameš
);

238 ià(!
ch
->
pcd©a
->
gameout
.
	`em±y
())

239 
JSON
::
	`addSŒšgToObjeù
(
o
, "GameOut", 
ch
->
pcd©a
->
gameout
);

241 ià(
ch
->
pcd©a
->
gŞd_dÚ©ed
)

242 
	`cJSON_AddNumb”ToObjeù
(
o
, "GlDÚ©ed", 
ch
->
pcd©a
->
gŞd_dÚ©ed
);

244 
™em
 = 
nuÎ±r
;

245 
gn
 = 0; gÀ< 
group_bË
.
	`size
(); gn++) {

246 ià(
ch
->
pcd©a
->
group_known
[
gn
] == 0)

249 ià(
™em
 =ğ
nuÎ±r
)

250 
™em
 = 
	`cJSON_C»©eA¼ay
();

252 
	`cJSON_AddI‹mToA¼ay
(
™em
, 
	`cJSON_C»©eSŒšg
(
group_bË
[
gn
].
Çme
.
	`c_¡r
()));

254 ià(
™em
 !ğ
nuÎ±r
)

255 
	`cJSON_AddI‹mToObjeù
(
o
, "Gr", 
™em
);

257 
	`cJSON_AddNumb”ToObjeù
(
o
, "Id", 
ch
->
pcd©a
->
id
);

259 ià(!
ch
->
pcd©a
->
ignÜe
.
	`em±y
()) {

260 
™em
 = 
	`cJSON_C»©eA¼ay
();

262 cÚ¡‡uto& 
™
: 
ch
->
pcd©a
->
ignÜe
)

263 
	`cJSON_AddI‹mToA¼ay
(
™em
, 
	`cJSON_C»©eSŒšg
(
™
.
	`c_¡r
()));

265 
	`cJSON_AddI‹mToObjeù
(
o
, "IgnÜe", 
™em
);

268 ià(!
ch
->
pcd©a
->
immÇme
.
	`em±y
())

269 
JSON
::
	`addSŒšgToObjeù
(
o
, "Immn", 
ch
->
pcd©a
->
immÇme
);

270 ià(!
ch
->
pcd©a
->
imm´efix
.
	`em±y
())

271 
JSON
::
	`addSŒšgToObjeù
(
o
, "Immp", 
ch
->
pcd©a
->
imm´efix
);

273 ià(
ch
->
gud
 =ğ
Gud
::
·Ïdš
) {

274 
	`cJSON_AddNumb”ToObjeù
(
o
, "Lay", 
ch
->
pcd©a
->
Ïys
);

275 
	`cJSON_AddNumb”ToObjeù
(
o
, "Lay_Next", 
ch
->
pcd©a
->
Ãxt_Ïy_couÁdown
);

278 
	`cJSON_AddNumb”ToObjeù
(
o
, "LLev", 
ch
->
pcd©a
->
Ï¡_Ëv–
);

279 
	`cJSON_AddNumb”ToObjeù
(
o
, "LogO", 
Game
::
cu¼’t_time
);

281 ià(!
ch
->
pcd©a
->
Ï¡_ls™e
.
	`em±y
())

282 
JSON
::
	`addSŒšgToObjeù
(
o
, "Ls™", 
ch
->
pcd©a
->
Ï¡_ls™e
);

284 
JSON
::
	`addSŒšgToObjeù
(
o
, "Ltim", 
	`dizzy_ùime
(&
ch
->
pcd©a
->
Ï¡_Éime
));

285 
JSON
::
	`addSŒšgToObjeù
(
o
, "LSav", 
	`dizzy_ùime
(&
ch
->
pcd©a
->
Ï¡_§ved
));

287 ià(
ch
->
pcd©a
->
m¬k_room
.
	`is_v®id
())

288 
	`cJSON_AddNumb”ToObjeù
(
o
, "M¬k", 
ch
->
pcd©a
->
m¬k_room
.
	`to_št
());

290 
	`cJSON_AddNumb”ToObjeù
(
o
, "Mexp", 
ch
->
pcd©a
->
mud_exp
);

292 
™em
 = 
	`cJSON_C»©eObjeù
();

293 
	`cJSON_AddNumb”ToObjeù
(
™em
, "nÙe", 
ch
->
pcd©a
->
Ï¡_nÙe
);

294 
	`cJSON_AddNumb”ToObjeù
(
™em
, "id—", 
ch
->
pcd©a
->
Ï¡_id—
);

295 
	`cJSON_AddNumb”ToObjeù
(
™em
, "rŞe", 
ch
->
pcd©a
->
Ï¡_rŞ•Ïy
);

296 
	`cJSON_AddNumb”ToObjeù
(
™em
, "que¡", 
ch
->
pcd©a
->
Ï¡_immque¡
);

297 
	`cJSON_AddNumb”ToObjeù
(
™em
, "chªge", 
ch
->
pcd©a
->
Ï¡_chªges
);

298 
	`cJSON_AddNumb”ToObjeù
(
™em
, "³rs", 
ch
->
pcd©a
->
Ï¡_³rsÚ®
);

299 
	`cJSON_AddNumb”ToObjeù
(
™em
, "Œade", 
ch
->
pcd©a
->
Ï¡_Œade
);

300 
	`cJSON_AddI‹mToObjeù
(
o
, "NÙe", 
™em
);

302 
JSON
::
	`addSŒšgToObjeù
(
o
, "Pass", 
ch
->
pcd©a
->
pwd
);

303 
	`cJSON_AddNumb”ToObjeù
(
o
, "PCkls", 
ch
->
pcd©a
->
pckls
);

304 
	`cJSON_AddNumb”ToObjeù
(
o
, "PCkËd", 
ch
->
pcd©a
->
pckËd
);

305 
	`cJSON_AddNumb”ToObjeù
(
o
, "PKRªk", 
ch
->
pcd©a
->
pk¿nk
);

306 
JSON
::
	`addSŒšgToObjeù
(
o
, "PÌ", 
ch
->
pcd©a
->
¶r_æags
.
	`to_¡ršg
());

307 
	`cJSON_AddNumb”ToObjeù
(
o
, "Plyd", 
ch
->
pcd©a
->
¶ayed
);

308 
	`cJSON_AddNumb”ToObjeù
(
o
, "PÁs", 
ch
->
pcd©a
->
pošts
);

310 ià(!
ch
->
pcd©a
->
qu”y
.
	`em±y
()) {

311 
™em
 = 
	`cJSON_C»©eA¼ay
();

313 cÚ¡‡uto& 
™
: 
ch
->
pcd©a
->
qu”y
)

314 
	`cJSON_AddI‹mToA¼ay
(
™em
, 
	`cJSON_C»©eSŒšg
(
™
.
	`c_¡r
()));

316 
	`cJSON_AddI‹mToObjeù
(
o
, "Qu”y", 
™em
);

319 ià(
ch
->
pcd©a
->
que¡pošts_dÚ©ed
)

320 
	`cJSON_AddNumb”ToObjeù
(
o
, "QpDÚ©ed", 
ch
->
pcd©a
->
que¡pošts_dÚ©ed
);

322 ià(
ch
->
pcd©a
->
que¡pošts
)

323 
	`cJSON_AddNumb”ToObjeù
(
o
, "Que¡PÁs", 
ch
->
pcd©a
->
que¡pošts
);

325 ià(
ch
->
pcd©a
->
Ãxtque¡
)

326 
	`cJSON_AddNumb”ToObjeù
(
o
, "Que¡Next", 
ch
->
pcd©a
->
Ãxtque¡
);

327 ià(
ch
->
pcd©a
->
couÁdown
)

328 
	`cJSON_AddNumb”ToObjeù
(
o
, "QuestNext", 12);

330 ià(!
ch
->
pcd©a
->
¿nk
.
	`em±y
())

331 
JSON
::
	`addSŒšgToObjeù
(
o
, "Rªk", 
ch
->
pcd©a
->
¿nk
);

333 ià(
ch
->
pcd©a
->
rŞ•ošts
)

334 
	`cJSON_AddNumb”ToObjeù
(
o
, "RŞePÁs", 
ch
->
pcd©a
->
rŞ•ošts
);

336 
™em
 = 
nuÎ±r
;

337 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

338 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

340 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

343 ià(
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) <= 0)

346 ià(
™em
 =ğ
nuÎ±r
)

347 
™em
 = 
	`cJSON_C»©eA¼ay
();

349 
cJSON
 *
sk
 = 
	`cJSON_C»©eObjeù
();

350 
JSON
::
	`addSŒšgToObjeù
(
sk
, "Çme", 
skl
::
	`lookup
(
ty³
).
Çme
);

351 
	`cJSON_AddNumb”ToObjeù
(
sk
, "´ac", 
	`g‘_Ë¬Ãd
(
ch
, 
ty³
));

352 
	`cJSON_AddNumb”ToObjeù
(
sk
, "evŞ", 
	`g‘_evŞutiÚ
(
ch
, 
ty³
));

353 
	`cJSON_AddI‹mToA¼ay
(
™em
, 
sk
);

355 ià(
™em
 !ğ
nuÎ±r
)

356 
	`cJSON_AddI‹mToObjeù
(
o
, "Sk", 
™em
);

358 ià(
ch
->
pcd©a
->
skÍošts
)

359 
	`cJSON_AddNumb”ToObjeù
(
o
, "SklPÁs", 
ch
->
pcd©a
->
skÍošts
);

361 ià(!
ch
->
pcd©a
->
¥ou£
.
	`em±y
())

362 
JSON
::
	`addSŒšgToObjeù
(
o
, "Spou", 
ch
->
pcd©a
->
¥ou£
);

364 ià(
ch
->
pcd©a
->
Ãxtsque¡
)

365 
	`cJSON_AddNumb”ToObjeù
(
o
, "SQue¡Next", 
ch
->
pcd©a
->
Ãxtsque¡
);

366 ià(
ch
->
pcd©a
->
sqcouÁdown
)

367 
	`cJSON_AddNumb”ToObjeù
(
o
, "SQuestNext", 20);

369 ià(
ch
->
pcd©a
->
»mÜt_couÁ
 > 0) {

370 ià(!
ch
->
pcd©a
->
¡©us
.
	`em±y
())

371 
JSON
::
	`addSŒšgToObjeù
(
o
, "Stus", 
ch
->
pcd©a
->
¡©us
);

373 
	`cJSON_AddNumb”ToObjeù
(
o
, "RmCt", 
ch
->
pcd©a
->
»mÜt_couÁ
);

375 
™em
 = 
nuÎ±r
;

376 
i
 = 0; i < (
ch
->
pcd©a
->
»mÜt_couÁ
 / 
EXTRACLASS_SLOT_LEVELS
) + 1; i++) {

377 ià(
ch
->
pcd©a
->
exŒaşass
[
i
] =ğ
skl
::
ty³
::
unknown
)

380 ià(
™em
 =ğ
nuÎ±r
)

381 
™em
 = 
	`cJSON_C»©eA¼ay
();

383 
	`cJSON_AddI‹mToA¼ay
(
™em
,

384 
	`cJSON_C»©eSŒšg
(
skl
::
	`lookup
(
ch
->
pcd©a
->
exŒaşass
[
i
]).
Çme
.
	`c_¡r
()));

387 ià(
™em
 !ğ
nuÎ±r
)

388 
	`cJSON_AddI‹mToObjeù
(
o
, "ExSk", 
™em
);

390 
™em
 = 
	`cJSON_C»©eIÁA¼ay
(
ch
->
pcd©a
->
¿fãù
, ch->pcd©a->
»mÜt_couÁ
 / 10 + 1);

391 
	`cJSON_AddI‹mToObjeù
(
o
, "Raff", 
™em
);

394 
™em
 = 
	`cJSON_C»©eObjeù
();

395 
	`cJSON_AddNumb”ToObjeù
(
™em
, "h™", 
ch
->
pcd©a
->
Œašs_to_h™
);

396 
	`cJSON_AddNumb”ToObjeù
(
™em
, "mªa", 
ch
->
pcd©a
->
Œašs_to_mªa
);

397 
	`cJSON_AddNumb”ToObjeù
(
™em
, "¡am", 
ch
->
pcd©a
->
Œašs_to_¡am
);

398 
	`cJSON_AddI‹mToObjeù
(
o
, "THMS", 
™em
);

400 ià(!
ch
->
pcd©a
->
t™Ë
.
	`em±y
())

401 
JSON
::
	`addSŒšgToObjeù
(
o
, "T™l", 
ch
->
pcd©a
->
t™Ë
[0] == ' ' ?

402 
ch
->
pcd©a
->
t™Ë
.
	`sub¡r
(1) : ch->pcdata->title);

403 
JSON
::
	`addSŒšgToObjeù
(
o
, "Video", 
ch
->
pcd©a
->
video_æags
.
	`to_¡ršg
());

405 ià(!
ch
->
pcd©a
->
w¬p_locs
.
	`em±y
()) {

406 
™em
 = 
	`cJSON_C»©eA¼ay
();

408 cÚ¡‡uto& 
™
: 
ch
->
pcd©a
->
w¬p_locs
)

409 
	`cJSON_AddI‹mToA¼ay
(
™em
, 
	`cJSON_C»©eSŒšg
(
™
.
	`c_¡r
()));

411 
	`cJSON_AddI‹mToObjeù
(
o
, "W¬pLocs", 
™em
);

414 ià(!
ch
->
pcd©a
->
whi¥”
.
	`em±y
())

415 
JSON
::
	`addSŒšgToObjeù
(
o
, "W¥r", 
ch
->
pcd©a
->
whi¥”
);

417  
o
;

418 
	}
}

423 
cJSON
 *
	$fwr™e_ch¬
(
Ch¬aù”
 *
ch
)

425 
cJSON
 *
™em
;

426 
cJSON
 *
o
 = 
	`cJSON_C»©eObjeù
();

428 
JSON
::
	`addSŒšgToObjeù
(
o
, "Aù", 
ch
->
aù_æags
.
	`to_¡ršg
());

430 
™em
 = 
nuÎ±r
;

431 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_ch¬
(
ch
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
) {

432 ià(
·f
->
ty³
 <ğ
afãù
::ty³::
unknown
 ||…af->ty³ >ğafãù::ty³::
size
)

436 ià(
·f
->
³rmª’t
)

439 ià(
™em
 =ğ
nuÎ±r
)

440 
™em
 = 
	`cJSON_C»©eA¼ay
();

442 
cJSON
 *
aff
 = 
	`cJSON_C»©eObjeù
();

443 
JSON
::
	`addSŒšgToObjeù
(
aff
, "Çme", 
afãù
::
	`lookup
(
·f
->
ty³
).
Çme
);

444 
	`cJSON_AddNumb”ToObjeù
(
aff
, "wh”e", 
·f
->
wh”e
);

445 
	`cJSON_AddNumb”ToObjeù
(
aff
, "Ëv–", 
·f
->
Ëv–
);

446 
	`cJSON_AddNumb”ToObjeù
(
aff
, "dur", 
·f
->
du¿tiÚ
);

447 
	`cJSON_AddNumb”ToObjeù
(
aff
, "mod", 
·f
->
modif›r
);

448 
	`cJSON_AddNumb”ToObjeù
(
aff
, "loc", 
·f
->
loÿtiÚ
);

449 
	`cJSON_AddNumb”ToObjeù
(
aff
, "b™v", 
·f
->
	`b™veùÜ
().
	`to_ulÚg
());

450 
	`cJSON_AddNumb”ToObjeù
(
aff
, "evo", 
·f
->
evŞutiÚ
);

451 
	`cJSON_AddI‹mToA¼ay
(
™em
, 
aff
);

453 ià(
™em
 !ğ
nuÎ±r
)

454 
	`cJSON_AddI‹mToObjeù
(
o
, "Affc", 
™em
);

456 
	`cJSON_AddNumb”ToObjeù
(
o
, "Alig", 
ch
->
®ignm’t
);

458 
™em
 = 
	`cJSON_C»©eObjeù
();

459 
	`cJSON_AddNumb”ToObjeù
(
™em
, "¡r", 
	`ATTR_BASE
(
ch
, 
APPLY_STR
));

460 
	`cJSON_AddNumb”ToObjeù
(
™em
, "št", 
	`ATTR_BASE
(
ch
, 
APPLY_INT
));

461 
	`cJSON_AddNumb”ToObjeù
(
™em
, "wis", 
	`ATTR_BASE
(
ch
, 
APPLY_WIS
));

462 
	`cJSON_AddNumb”ToObjeù
(
™em
, "dex", 
	`ATTR_BASE
(
ch
, 
APPLY_DEX
));

463 
	`cJSON_AddNumb”ToObjeù
(
™em
, "cÚ", 
	`ATTR_BASE
(
ch
, 
APPLY_CON
));

464 
	`cJSON_AddNumb”ToObjeù
(
™em
, "chr", 
	`ATTR_BASE
(
ch
, 
APPLY_CHR
));

465 
	`cJSON_AddI‹mToObjeù
(
o
, "AŒib", 
™em
);

468 ià(
ch
->
şª
)

469 
JSON
::
	`addSŒšgToObjeù
(
o
, "CÏn", 
ch
->
şª
->
Çme
);

471 
	`cJSON_AddNumb”ToObjeù
(
o
, "CÏ", 
ch
->
gud
);

472 
JSON
::
	`addSŒšgToObjeù
(
o
, "Cn¤", 
ch
->
ûnsÜ_æags
.
	`to_¡ršg
());

473 
JSON
::
	`addSŒšgToObjeù
(
o
, "Comm", 
ch
->
comm_æags
.
	`to_¡ršg
());

475 ià(!
ch
->
desütiÚ
.
	`em±y
())

476 
JSON
::
	`addSŒšgToObjeù
(
o
, "Desc", 
ch
->
desütiÚ
);

478 
	`cJSON_AddNumb”ToObjeù
(
o
, "Exp", 
ch
->
exp
);

480 
	`cJSON_AddNumb”ToObjeù
(
o
, "GŞd", 
ch
->
gŞd
);

482 ià(
ch
->
gŞd_š_bªk
 > 0)

483 
	`cJSON_AddNumb”ToObjeù
(
o
, "GŞd_š_bªk", 
ch
->
gŞd_š_bªk
);

485 
™em
 = 
	`cJSON_C»©eObjeù
();

486 
	`cJSON_AddNumb”ToObjeù
(
™em
, "h™", 
ch
->
h™
);

487 
	`cJSON_AddNumb”ToObjeù
(
™em
, "mªa", 
ch
->
mªa
);

488 
	`cJSON_AddNumb”ToObjeù
(
™em
, "¡am", 
ch
->
¡am
);

489 
	`cJSON_AddI‹mToObjeù
(
o
, "HMS", 
™em
);

491 
™em
 = 
	`cJSON_C»©eObjeù
();

492 
	`cJSON_AddNumb”ToObjeù
(
™em
, "h™", 
	`ATTR_BASE
(
ch
, 
APPLY_HIT
));

493 
	`cJSON_AddNumb”ToObjeù
(
™em
, "mªa", 
	`ATTR_BASE
(
ch
, 
APPLY_MANA
));

494 
	`cJSON_AddNumb”ToObjeù
(
™em
, "¡am", 
	`ATTR_BASE
(
ch
, 
APPLY_STAM
));

495 
	`cJSON_AddI‹mToObjeù
(
o
, "HMSP", 
™em
);

497 
	`cJSON_AddNumb”ToObjeù
(
o
, "Levl", 
ch
->
Ëv–
);

499 ià(!
ch
->
lÚg_desü
.
	`em±y
())

500 
JSON
::
	`addSŒšgToObjeù
(
o
, "LnD", 
ch
->
lÚg_desü
);

502 
JSON
::
	`addSŒšgToObjeù
(
o
, "Name", 
ch
->
Çme
);

503 
	`cJSON_AddNumb”ToObjeù
(
o
, "Pos", 
ch
->
pos™iÚ
);

504 
	`cJSON_AddNumb”ToObjeù
(
o
, "PosP", 
ch
->
¡¬t_pos
);

505 
	`cJSON_AddNumb”ToObjeù
(
o
, "P¿c", 
ch
->
´aùiû
);

507 ià(!
ch
->
´om±
.
	`em±y
())

508 
JSON
::
	`addSŒšgToObjeù
(
o
, "Prom", 
ch
->
´om±
);

510 
JSON
::
	`addSŒšgToObjeù
(
o
, "Raû", 
¿û_bË
[
ch
->
¿û
].
Çme
);

511 
JSON
::
	`addSŒšgToObjeù
(
o
, "Revk", 
ch
->
»voke_æags
.
	`to_¡ršg
());

512 
	`cJSON_AddNumb”ToObjeù
(
o
, "Room",

513 (
ch
->
š_room
 =ğ
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_LIMBO
))è&& ch->
was_š_room
 !ğ
nuÎ±r
)

514 ? 
ch
->
was_š_room
->
loÿtiÚ
.
	`to_št
()

515 : 
ch
->
š_room
 =ğ
nuÎ±r


517 : 
ch
->
š_room
->
loÿtiÚ
.
	`to_št
());

519 
	`cJSON_AddNumb”ToObjeù
(
o
, "Süo", 
ch
->
lšes
);

520 
	`cJSON_AddNumb”ToObjeù
(
o
, "Sex", 
	`ATTR_BASE
(
ch
, 
APPLY_SEX
));

521 
	`cJSON_AddNumb”ToObjeù
(
o
, "Sv", 
ch
->
sv”
);

523 ià(
ch
->
sv”_š_bªk
 > 0)

524 
	`cJSON_AddNumb”ToObjeù
(
o
, "Sv”_š_bªk", 
ch
->
sv”_š_bªk
);

526 ià(!
ch
->
shÜt_desü
.
	`em±y
())

527 
JSON
::
	`addSŒšgToObjeù
(
o
, "ShD", 
ch
->
shÜt_desü
);

529 
	`cJSON_AddNumb”ToObjeù
(
o
, "T¿i", 
ch
->
Œaš
);

530 
	`cJSON_AddNumb”ToObjeù
(
o
, "Wimp", 
ch
->
wimpy
);

532 ià(
	`IS_IMMORTAL
(
ch
)) {

533 
JSON
::
	`addSŒšgToObjeù
(
o
, "Wizn", 
ch
->
wizÃt_æags
.
	`to_¡ršg
());

534 
	`cJSON_AddNumb”ToObjeù
(
o
, "Invi", 
ch
->
švis_Ëv–
);

535 
	`cJSON_AddNumb”ToObjeù
(
o
, "Lurk", 
ch
->
lurk_Ëv–
);

536 
	`cJSON_AddNumb”ToObjeù
(
o
, "Secu", 
ch
->
£cu»_Ëv–
);

539  
o
;

540 
	}
}

543 
cJSON
 *
	$fwr™e_³t
(
Ch¬aù”
 *
³t
)

545 
cJSON
 *
o
 = 
	`fwr™e_ch¬
(
³t
);

547 
	`cJSON_AddNumb”ToObjeù
(
o
, "Vnum", 
³t
->
pIndexD©a
->
vnum
.
	`v®ue
());

549 ià(
	`ATTR_BASE
(
³t
, 
APPLY_SAVES
) != 0)

550 
	`cJSON_AddNumb”ToObjeù
(
o
, "Save", 
	`ATTR_BASE
(
³t
, 
APPLY_SAVES
));

552 ià(
	`ATTR_BASE
(
³t
, 
APPLY_HITROLL
è!ğ³t->
pIndexD©a
->
h™rŞl
)

553 
	`cJSON_AddNumb”ToObjeù
(
o
, "H™", 
	`ATTR_BASE
(
³t
, 
APPLY_HITROLL
));

555 ià(
	`ATTR_BASE
(
³t
, 
APPLY_DAMROLL
è!ğ³t->
pIndexD©a
->
damage
[
DICE_BONUS
])

556 
	`cJSON_AddNumb”ToObjeù
(
o
, "Dam", 
	`ATTR_BASE
(
³t
, 
APPLY_DAMROLL
));

558  
o
;

559 
	}
}

564 
cJSON
 *
	$fwr™e_obj
(
Objeù
 *
obj
)

566 
cJSON
 *
™em
;

567 
cJSON
 *
o
 = 
	`cJSON_C»©eObjeù
();

569 ià(
obj
->
cÚd™iÚ
 !ğobj->
pIndexD©a
->condition)

570 
	`cJSON_AddNumb”ToObjeù
(
o
, "CÚd", 
obj
->
cÚd™iÚ
);

571 ià(
obj
->
co¡
 !ğobj->
pIndexD©a
->cost)

572 
	`cJSON_AddNumb”ToObjeù
(
o
, "Co¡", 
obj
->
co¡
);

573 ià(
obj
->
desütiÚ
 !ğobj->
pIndexD©a
->description)

574 
JSON
::
	`addSŒšgToObjeù
(
o
, "Desc", 
obj
->
desütiÚ
);

576 ià(
afãù
::
	`’chª‹d_obj
(
obj
)) {

578 
™em
 = 
	`cJSON_C»©eA¼ay
();

580 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
) {

581 ià(
·f
->
ty³
 <ğ
afãù
::ty³::
unknown
 ||…af->ty³ >ğafãù::ty³::
size
)

584 
cJSON
 *
aff
 = 
	`cJSON_C»©eObjeù
();

585 
JSON
::
	`addSŒšgToObjeù
(
aff
, "Çme", 
afãù
::
	`lookup
(
·f
->
ty³
).
Çme
);

586 
	`cJSON_AddNumb”ToObjeù
(
aff
, "wh”e", 
·f
->
wh”e
);

587 
	`cJSON_AddNumb”ToObjeù
(
aff
, "Ëv–", 
·f
->
Ëv–
);

588 
	`cJSON_AddNumb”ToObjeù
(
aff
, "dur", 
·f
->
du¿tiÚ
);

589 
	`cJSON_AddNumb”ToObjeù
(
aff
, "mod", 
·f
->
modif›r
);

590 
	`cJSON_AddNumb”ToObjeù
(
aff
, "loc", 
·f
->
loÿtiÚ
);

591 
	`cJSON_AddNumb”ToObjeù
(
aff
, "b™v", 
·f
->
	`b™veùÜ
().
	`to_ulÚg
());

592 
	`cJSON_AddNumb”ToObjeù
(
aff
, "evo", 
·f
->
evŞutiÚ
);

593 
	`cJSON_AddI‹mToA¼ay
(
™em
, 
aff
);

596 
	`cJSON_AddI‹mToObjeù
(
o
, "Affc", 
™em
);

599 
™em
 = 
nuÎ±r
;

600 
ExŒaDesü
 *
ed
 = 
obj
->
exŒa_desü
;ƒd !ğ
nuÎ±r
;ƒd =ƒd->
Ãxt
) {

601 ià(
™em
 =ğ
nuÎ±r
)

602 
™em
 = 
	`cJSON_C»©eObjeù
();

604 
JSON
::
	`addSŒšgToObjeù
(
™em
, 
ed
->
keywÜd
,ƒd->
desütiÚ
);

606 ià(
™em
 !ğ
nuÎ±r
)

607 
	`cJSON_AddI‹mToObjeù
(
o
, "ExDe", 
™em
);

609 ià(
obj
->
exŒa_æags
 !ğobj->
pIndexD©a
->extra_flags)

610 
	`cJSON_AddNumb”ToObjeù
(
o
, "ExtF", 
obj
->
exŒa_æags
.
	`to_ulÚg
());

611 ià(
obj
->
™em_ty³
 !ğobj->
pIndexD©a
->item_type)

612 
	`cJSON_AddNumb”ToObjeù
(
o
, "Ityp", 
obj
->
™em_ty³
);

613 ià(
obj
->
Ëv–
 !ğobj->
pIndexD©a
->level)

614 
	`cJSON_AddNumb”ToObjeù
(
o
, "Lev", 
obj
->
Ëv–
);

615 ià(
obj
->
m©”Ÿl
 !ğobj->
pIndexD©a
->material)

616 
JSON
::
	`addSŒšgToObjeù
(
o
, "M©", 
obj
->
m©”Ÿl
);

617 ià(
obj
->
Çme
 !ğobj->
pIndexD©a
->name)

618 
JSON
::
	`addSŒšgToObjeù
(
o
, "Name", 
obj
->
Çme
);

619 ià(
obj
->
shÜt_desü
 !ğobj->
pIndexD©a
->short_descr)

620 
JSON
::
	`addSŒšgToObjeù
(
o
, "ShD", 
obj
->
shÜt_desü
);

622 ià(
obj
->
tim”
 != 0)

623 
	`cJSON_AddNumb”ToObjeù
(
o
, "Time", 
obj
->
tim”
);

625 ià(
obj
->
v®ue
[0] !ğobj->
pIndexD©a
->value[0]

626 || 
obj
->
v®ue
[1] !ğobj->
pIndexD©a
->value[1]

627 || 
obj
->
v®ue
[2] !ğobj->
pIndexD©a
->value[2]

628 || 
obj
->
v®ue
[3] !ğobj->
pIndexD©a
->value[3]

629 || 
obj
->
v®ue
[4] !ğobj->
pIndexD©a
->value[4]) {

631 
¬r
[5];

632 
i
 = 0; i < 5; i++)

633 
¬r
[
i
] = 
obj
->
v®ue
[i];

634 
	`cJSON_AddI‹mToObjeù
(
o
, "V®", 
	`cJSON_C»©eIÁA¼ay
(
¬r
, 5));

637 
	`cJSON_AddNumb”ToObjeù
(
o
, "Vnum", 
obj
->
pIndexD©a
->
vnum
.
	`v®ue
());

639 ià(
obj
->
w—r_loc
 !ğ
WEAR_NONE
)

640 
	`cJSON_AddNumb”ToObjeù
(
o
, "W—r", 
obj
->
w—r_loc
);

642 ià(
obj
->
w—r_æags
 !ğobj->
pIndexD©a
->wear_flags)

643 
	`cJSON_AddNumb”ToObjeù
(
o
, "W—F", 
obj
->
w—r_æags
.
	`to_ulÚg
());

644 ià(
obj
->
weight
 !ğobj->
pIndexD©a
->weight)

645 
	`cJSON_AddNumb”ToObjeù
(
o
, "Wt", 
obj
->
weight
);

648 
	`cJSON_AddI‹mToObjeù
(
o
, "cÚšs", 
	`fwr™e_objeùs
(
obj
->
cÚšs
));

650 
	`cJSON_AddI‹mToObjeù
(
o
, "gems", 
	`fwr™e_objeùs
(
obj
->
gems
));

652  
o
;

653 
	}
}

655 
cJSON
 *
	$fwr™e_objeùs
(
Objeù
 *
h—d
) {

656 
cJSON
 *
¬¿y
 = 
	`cJSON_C»©eA¼ay
();

662 
Objeù
 *
obj
 = 
h—d
; obj; obj = obj->
Ãxt_cÚ‹Á
) {

665 
cJSON
 *
™em
 = 
	`fwr™e_obj
(
obj
);

667 ià(
™em
)

668 
	`cJSON_In£¹I‹mInA¼ay
(
¬¿y
, 0, 
™em
);

672 ià(
	`cJSON_G‘A¼aySize
(
¬¿y
) == 0) {

673 
	`cJSON_D–‘e
(
¬¿y
);

674 
¬¿y
 = 
nuÎ±r
;

677  
¬¿y
;

678 
	}
}

683 
boŞ
 
	$lßd_ch¬_obj
(
DesütÜ
 *
d
, cÚ¡ 
SŒšg
& 
Çme
)

685 
¡r§ve
[
MAX_INPUT_LENGTH
];

686 
Ch¬aù”
 *
ch
;

687 
boŞ
 
found
;

688 
ch
 = 
Ãw
 
	`Ch¬aù”
();

689 
ch
->
pcd©a
 = 
Ãw
 
	`PÏy”
(*ch);

690 
d
->
ch¬aù”
 = 
ch
;

691 
ch
->
desc
 = 
d
;

692 
ch
->
Çme
 =‚ame;

693 
ch
->
¿û
 = 
	`¿û_lookup
("human");

694 
ch
->
aù_æags
 = 
PLR_NOSUMMON
 | 
PLR_AUTOASSIST
 | 
PLR_AUTOEXIT
 | 
PLR_AUTOLOOT
 |

695 
PLR_AUTOSAC
 | 
PLR_AUTOSPLIT
 | 
PLR_AUTOGOLD
 | 
PLR_TICKS
 | 
PLR_WIMPY
 |

696 
PLR_COLOR
 | 
PLR_COLOR2
;

697 
ch
->
comm_æags
 = 
COMM_COMBINE
 | 
COMM_PROMPT
;

698 
ch
->
£cu»_Ëv–
 = 
RANK_IMM
;

699 
ch
->
ûnsÜ_æags
 = 
CENSOR_CHAN
;

700 
ch
->
´om±
 = "%CW<%CC%h%CThp %CG%m%CHma %CB%v%CNst%CW> ";

701 
ch
->
pcd©a
->
de™y
 = "Nobody";

702 
ch
->
pcd©a
->
mud_exp
 = 
MEXP_LEGACY_OLDBIE
;

705 
¡©
 = 0; sˆ< 
MAX_STATS
; stat++)

706 
	`ATTR_BASE
(
ch
, 
	`¡©_to_©Œ
(
¡©
)) = 3;

708 
ch
->
pcd©a
->
comb©tim”
 = -1;

709 
ch
->
pcd©a
->
cÚd™iÚ
[
COND_THIRST
] = 48;

710 
ch
->
pcd©a
->
cÚd™iÚ
[
COND_FULL
] = 48;

711 
ch
->
pcd©a
->
cÚd™iÚ
[
COND_HUNGER
] = 48;

712 
	`ATTR_BASE
(
ch
, 
APPLY_HIT
) = 20;

713 
	`ATTR_BASE
(
ch
, 
APPLY_MANA
) = 100;

714 
	`ATTR_BASE
(
ch
, 
APPLY_STAM
) = 100;

715 
ch
->
pcd©a
->
Ï¡_logoff
 = 
Game
::
cu¼’t_time
;

716 
found
 = 
çl£
;

718 
FÜm©
::
	`¥rštf
(
¡r§ve
, "%s%s", 
PLAYER_DIR
, 
Çme
.
	`low”ÿ£
().
	`ÿp™®ize
());

720 
cJSON
 *
roÙ
 = 
JSON
::
	`»ad_fe
(
¡r§ve
);

722 ià(
roÙ
 !ğ
nuÎ±r
) {

724 
v”siÚ
 = 
CURRENT_VERSION
;

725 
JSON
::
	`g‘_št
(
roÙ
, &
v”siÚ
, "version");

727 
	`ä—d_ch¬
(
ch
, 
	`cJSON_G‘ObjeùI‹m
(
roÙ
, "ch¬aù”"), 
v”siÚ
);

728 
	`ä—d_¶ay”
(
ch
, 
	`cJSON_G‘ObjeùI‹m
(
roÙ
, "¶ay”"), 
v”siÚ
);

730 
	`ä—d_objeùs
(
ch
, 
	`cJSON_G‘ObjeùI‹m
(
roÙ
, "šv’tÜy"), &
obj_to_ch¬
, 
v”siÚ
);

732 
Objeù
 *
obj
 = 
ch
->
ÿ¼yšg
; obj; obj = obj->
Ãxt_cÚ‹Á
)

733 ià(
obj
->
w—r_loc
 !ğ
WEAR_NONE
)

734 
	`equ_ch¬
(
ch
, 
obj
, obj->
w—r_loc
);

736 
	`ä—d_objeùs
(
ch
, 
	`cJSON_G‘ObjeùI‹m
(
roÙ
, "lock”"), &
obj_to_lock”
, 
v”siÚ
);

737 
	`ä—d_objeùs
(
ch
, 
	`cJSON_G‘ObjeùI‹m
(
roÙ
, "¡rÚgbox"), &
obj_to_¡rÚgbox
, 
v”siÚ
);

739 
	`ä—d_³t
(
ch
, 
	`cJSON_G‘ObjeùI‹m
(
roÙ
, "³t"), 
v”siÚ
);

741 ià(
ch
->
³t
)

742 
	`ä—d_objeùs
(
ch
->
³t
, 
	`cJSON_G‘ObjeùI‹m
(
roÙ
, "³t_šv’tÜy"), &
obj_to_ch¬
, 
v”siÚ
);

744 
	`cJSON_D–‘e
(
roÙ
);

745 
found
 = 
Œue
;

750 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

751 
ch
->
š_room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_TEMPLE
)));

753 ià(
ch
->
£cu»_Ëv–
 > 
	`GET_RANK
(ch))

754 
ch
->
£cu»_Ëv–
 = 
	`GET_RANK
(ch);

757 ià(
v”siÚ
 < 12 && 
ch
->
aù_æags
.
	`has
(
FÏgs
::
N
))

758 
ch
->
aù_æags
 -ğ
FÏgs
::
N
;

761 ià(
v”siÚ
 < 19 && !
ch
->
pcd©a
->
immÇme
.
	`em±y
())

762 
ch
->
pcd©a
->
immÇme
 = ch->pcdata->immname

763 .
	`»¶aû
("{W[{x", "")

764 .
	`»¶aû
("{W]{x", "")

765 .
	`¡r
();

768 ià(
v”siÚ
 < 16 && 
ch
->
pcd©a
->
¶r_æags
.
	`has
(
FÏgs
::
U
))

769 
ch
->
pcd©a
->
¶r_æags
 -ğ
FÏgs
::
U
;

772 ià(
v”siÚ
 < 15 && 
ch
->
aù_æags
.
	`has
(
FÏgs
::
N
)) {

773 
ch
->
aù_æags
 -ğ
FÏgs
::
N
;

774 
ch
->
	`add_cgroup
(
GROUP_DEPUTY
);

777 ià(
v”siÚ
 < 15 && 
ch
->
aù_æags
.
	`has
(
FÏgs
::
e
)) {

778 
ch
->
aù_æags
 -ğ
FÏgs
::
e
;

779 
ch
->
	`add_cgroup
(
GROUP_LEADER
);

783 ià(
v”siÚ
 < 16 && 
ch
->
aù_æags
.
	`has
(
FÏgs
::
Q
)) {

784 
ch
->
aù_æags
 -ğ
FÏgs
::
Q
;

785 
ch
->
aù_æags
 +ğ
PLR_NOSUMMON
;

789 ià(
v”siÚ
 < 21) {

790 
ch
->
aù_æags
 -ğ(
FÏgs
::
K
);

793 ià(
ch
->
pcd©a
->
»mÜt_couÁ
 > 0) {

794 
ch
->
	`add_cgroup
(
GROUP_AVATAR
);

795 
ch
->
	`add_cgroup
(
GROUP_HERO
);

798 ià(
ch
->
Ëv–
 >ğ
LEVEL_AVATAR
)

799 
ch
->
	`add_cgroup
(
GROUP_AVATAR
);

801 ià(
ch
->
Ëv–
 >ğ
LEVEL_HERO
)

802 
ch
->
	`add_cgroup
(
GROUP_HERO
);

804 ià(
ch
->
şª
 =ğ
nuÎ±r
 && !
	`IS_IMMORTAL
(ch)) {

805 
ch
->
	`»move_cgroup
(
GROUP_LEADER
);

806 
ch
->
	`»move_cgroup
(
GROUP_DEPUTY
);

809 ià(
ch
->
şª
 !ğ
nuÎ±r
)

810 
ch
->
	`add_cgroup
(
GROUP_CLAN
);

812 ià(!
	`IS_IMMORTAL
(
ch
)) {

813 
¡©
 = 0; sˆ< 
MAX_STATS
; stat++)

814 
	`ATTR_BASE
(
ch
, 
	`¡©_to_©Œ
(
¡©
))

815 ğ
¡d
::
	`mš
(
	`ATTR_BASE
(
ch
, 
	`¡©_to_©Œ
(
¡©
)), 
	`g‘_max_Œaš
(ch, stat));

820 ià(
found
) {

821 
i
, 
³rûÁ
;

823 ià(
ch
->
¿û
 == 0)

824 
ch
->
¿û
 = 
	`¿û_lookup
("human");

828 
afãù
::
	`add_¿cŸl_to_ch¬
(
ch
);

830 
	`¿ff_add_to_ch¬
(
Ch¬aù”
 *
ch
, 
¿ff
);

831 ià(
ch
->
pcd©a
->
»mÜt_couÁ
 > 0)

832 
c
 = 0; c < 
ch
->
pcd©a
->
»mÜt_couÁ
 / 10 + 1; c++)

833 
	`¿ff_add_to_ch¬
(
ch
, ch->
pcd©a
->
¿fãù
[
c
]);

835 
ch
->
size
 = 
pc_¿û_bË
[ch->
¿û
].size;

836 
ch
->
dam_ty³
 = 17;

838 
i
 = 0; i < 5; i++) {

839 ià(
pc_¿û_bË
[
ch
->
¿û
].
skls
[
i
].
	`em±y
())

842 
	`group_add
(
ch
, 
pc_¿û_bË
[ch->
¿û
].
skls
[
i
], 
çl£
);

846 
ch
->
aù_æags
 -ğ(
FÏgs
::
e
);

847 
ch
->
aù_æags
 -ğ(
FÏgs
::
N
);

848 
ch
->
	`add_cgroup
(
GROUP_PLAYER
);

851 ià(!
ch
->
wizÃt_æags
.
	`em±y
())

852 cÚ¡‡uto& 
’Œy
 : 
wizÃt_bË
)

853 ià(
ch
->
wizÃt_æags
.
	`has
(
’Œy
.
æag
è&& 
	`GET_RANK
(chè<ƒÁry.
Ëv–
)

854 
ch
->
wizÃt_æags
 -ğ
’Œy
.
æag
;

858 
³rûÁ
 = (
Game
::
cu¼’t_time
 - 
ch
->
pcd©a
->
Ï¡_logoff
) * 25 / (2 * 60 * 60);

859 
³rûÁ
 = 
¡d
::
	`mš
(percent, 100);

861 ià(
³rûÁ
 > 0 && !
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
poisÚ
è&& !afãù::exi¡s_Ú_ch¬(ch,‡fãù::ty³::
¶ague
)) {

862 
ch
->
h™
 +ğ(
	`GET_MAX_HIT
(chè- ch->h™è* 
³rûÁ
 / 100;

863 
ch
->
mªa
 +ğ(
	`GET_MAX_MANA
(chè- ch->mªaè* 
³rûÁ
 / 100;

864 
ch
->
¡am
 +ğ(
	`GET_MAX_STAM
(chè- ch->¡amè* 
³rûÁ
 / 100;

868  
found
;

869 
	}
}

875 #ià
defšed
(
STRKEY
)

876 #undeà
STRKEY


879 
	$£t¡r
(
SŒšg
 *
f›ld
, cÚ¡ * 
v®ue
) {

880 *
f›ld
 = 
v®ue
;

881 
	}
}

883 
	#STRKEY
Ğ
l™”®
, 
f›ld
, 
v®ue
 ) \

884 iàĞ
key
 =ğ
l™”®
 ) \

886 
f›ld
 = 
v®ue
; \

887 
fM©ch
 = 
Œue
; \

889 }

	)

891 #ià
defšed
(
INTKEY
)

892 #undeà
INTKEY


895 
	#INTKEY
Ğ
l™”®
, 
f›ld
, 
v®ue
 ) \

896 iàĞ
key
 =ğ
l™”®
 ) \

898 
f›ld
 = 
v®ue
; \

899 
fM©ch
 = 
Œue
; \

901 }

	)

903 #ià
defšed
(
FLAGKEY
)

904 #undeà
FLAGKEY


907 
	#FLAGKEY
Ğ
l™”®
, 
f›ld
, 
v®ue
 ) \

908 iàĞ
key
 =ğ
l™”®
 ) \

910 
f›ld
 = 
	`FÏgs
(
v®ue
); \

911 
fM©ch
 = 
Œue
; \

913 }

	)

915 #ià
defšed
(
SKIPKEY
)

916 #undeà
SKIPKEY


919 
	#SKIPKEY
Ğ
l™”®
 ) \

920 iàĞ
key
 =ğ
l™”®
 ) \

922 
fM©ch
 = 
Œue
; \

924 }

	)

927 
	$ä—d_¶ay”
(
Ch¬aù”
 *
ch
, 
cJSON
 *
jsÚ
, 
v”siÚ
) {

928 ià(
jsÚ
 =ğ
nuÎ±r
)

937 
cJSON
 *
o
 = 
jsÚ
->
chd
; o; o = o->
Ãxt
) {

938 
SŒšg
 
key
 = 
o
->
¡ršg
;

939 
boŞ
 
fM©ch
 = 
çl£
;

940 
couÁ
 = 0;

942 
	`touµ”
(
key
[0])) {

944 ià(
key
 == "Alias") {

946 
cJSON
 *
™em
 = 
o
->
chd
; i‹m !ğ
nuÎ±r
; i‹m = i‹m->
Ãxt
, 
couÁ
++)

947 
ch
->
pcd©a
->
®Ÿs
[
™em
->
chd
->
v®ue¡ršg
] = i‹m->chd->
Ãxt
->valuestring;

949 
fM©ch
 = 
Œue
; ;

952 
	`STRKEY
("Afk", 
ch
->
pcd©a
->
afk
, 
o
->
v®ue¡ršg
);

953 
	`INTKEY
("Akls", 
ch
->
pcd©a
->
¬’akls
, 
o
->
v®uešt
);

954 
	`INTKEY
("AkËd", 
ch
->
pcd©a
->
¬’akËd
, 
o
->
v®uešt
);

955 
	`STRKEY
("Au¿", 
ch
->
pcd©a
->
au¿
, 
o
->
v®ue¡ršg
);

958 
	`INTKEY
("Back", 
ch
->
pcd©a
->
backup
, 
o
->
v®uešt
);

959 
	`STRKEY
("Bš", 
ch
->
pcd©a
->
bamfš
, 
o
->
v®ue¡ršg
);

960 
	`STRKEY
("Bout", 
ch
->
pcd©a
->
bamfout
, 
o
->
v®ue¡ršg
);

963 ià(
key
 == "Cnd") {

964 
JSON
::
	`g‘_shÜt
(
o
, &
ch
->
pcd©a
->
cÚd™iÚ
[
COND_DRUNK
], "drunk");

965 
JSON
::
	`g‘_shÜt
(
o
, &
ch
->
pcd©a
->
cÚd™iÚ
[
COND_FULL
], "full");

966 
JSON
::
	`g‘_shÜt
(
o
, &
ch
->
pcd©a
->
cÚd™iÚ
[
COND_THIRST
], "thirst");

967 
JSON
::
	`g‘_shÜt
(
o
, &
ch
->
pcd©a
->
cÚd™iÚ
[
COND_HUNGER
], "hunger");

968 
fM©ch
 = 
Œue
; ;

971 ià(
key
 == "Colr") {

972 
cJSON
 *
™em
 = 
o
->
chd
; i‹m !ğ
nuÎ±r
; i‹m = i‹m->
Ãxt
) {

973 
¦Ù
 = 
	`cJSON_G‘ObjeùI‹m
(
™em
, "¦Ù")->
v®uešt
;

974 
JSON
::
	`g‘_shÜt
(
™em
, &
ch
->
pcd©a
->
cŞÜ
[
¦Ù
], "color");

975 
JSON
::
	`g‘_shÜt
(
™em
, &
ch
->
pcd©a
->
bŞd
[
¦Ù
], "bold");

977 
fM©ch
 = 
Œue
; ;

980 
	`FLAGKEY
("Cg½", 
ch
->
pcd©a
->
cgroup_æags
, 
o
->
v®ue¡ršg
);

983 
	`STRKEY
("De™", 
ch
->
pcd©a
->
de™y
, 
o
->
v®ue¡ršg
);

986 ià(
key
 == "ExSk") {

987 
couÁ
 = 0;

988 
cJSON
 *
™em
 = 
o
->
chd
; i‹m !ğ
nuÎ±r
 && 
couÁ
 < 
MAX_EXTRACLASS_SLOTS
; i‹m = i‹m->
Ãxt
) {

989 
skl
::
ty³
 
¢
 = skl::
	`lookup
(
™em
->
v®ue¡ršg
);

991 ià(
¢
 =ğ
skl
::
ty³
::
unknown
) {

992 
Loggšg
::
	`bugf
("unknowÀexŒaşas skÈ'%s'", 
™em
->
v®ue¡ršg
);

996 cÚ¡‡utØ
’Œy
 = 
skl
::
	`lookup
(
¢
);

998 ià(
’Œy
.
»mÜt_gud
 =ğ
Gud
::
nÚe
)

1001 
ch
->
pcd©a
->
exŒaşass
[
couÁ
++] = 
¢
;

1003 
fM©ch
 = 
Œue
; ;

1006 
	`STRKEY
("Ema", 
ch
->
pcd©a
->
ema
, 
o
->
v®ue¡ršg
);

1009 
	`INTKEY
("FamŸr", 
ch
->
pcd©a
->
çmŸr
, 
o
->
v®uešt
);

1010 
	`STRKEY
("Fšf", 
ch
->
pcd©a
->
fšg”šfo
, 
o
->
v®ue¡ršg
);

1011 
	`INTKEY
("FÏgTh›f", 
ch
->
pcd©a
->
æag_th›f
, 
o
->
v®uešt
);

1012 
	`INTKEY
("FÏgKËr", 
ch
->
pcd©a
->
æag_kËr
, 
o
->
v®uešt
);

1015 ià(
key
 == "Gr") {

1016 
cJSON
 *
™em
 = 
o
->
chd
; i‹m !ğ
nuÎ±r
; i‹m = i‹m->
Ãxt
) {

1017 
gn
 = 
	`group_lookup
(
™em
->
v®ue¡ršg
);

1019 ià(
gn
 < 0) {

1020 
FÜm©
::
	`årštf
(
¡d”r
, "%s", 
™em
->
v®ue¡ršg
);

1021 
Loggšg
::
	`bug
("Unknown group. ", 0);

1025 
	`gn_add
(
ch
, 
gn
);

1027 
fM©ch
 = 
Œue
; ;

1030 
	`STRKEY
("GameIn", 
ch
->
pcd©a
->
gameš
, 
o
->
v®ue¡ršg
);

1031 
	`STRKEY
("GameOut", 
ch
->
pcd©a
->
gameout
, 
o
->
v®ue¡ršg
);

1032 
	`INTKEY
("GlDÚ©ed", 
ch
->
pcd©a
->
gŞd_dÚ©ed
, 
o
->
v®uešt
);

1035 ià(
key
 == "HMSP") {

1036 
JSON
::
	`g‘_št
(
o
, &
	`ATTR_BASE
(
ch
, 
APPLY_HIT
), "hit");

1037 
JSON
::
	`g‘_št
(
o
, &
	`ATTR_BASE
(
ch
, 
APPLY_MANA
), "mana");

1038 
JSON
::
	`g‘_št
(
o
, &
	`ATTR_BASE
(
ch
, 
APPLY_STAM
), "stam");

1039 
fM©ch
 = 
Œue
; ;

1044 ià(
key
 == "Ignore") {

1045 
cJSON
 *
™em
 = 
o
->
chd
; i‹m !ğ
nuÎ±r
; i‹m = i‹m->
Ãxt
)

1046 
ch
->
pcd©a
->
ignÜe
.
	`push_back
(
™em
->
v®ue¡ršg
);

1047 
fM©ch
 = 
Œue
; ;

1050 
	`INTKEY
("Id", 
ch
->
pcd©a
->
id
, 
o
->
v®uešt
);

1051 
	`STRKEY
("Immn", 
ch
->
pcd©a
->
immÇme
, 
o
->
v®ue¡ršg
);

1052 
	`STRKEY
("Immp", 
ch
->
pcd©a
->
imm´efix
, 
o
->
v®ue¡ršg
);

1055 
	`INTKEY
("Lay", 
ch
->
pcd©a
->
Ïys
, 
o
->
v®uešt
);

1056 
	`INTKEY
("Lay_Next", 
ch
->
pcd©a
->
Ãxt_Ïy_couÁdown
, 
o
->
v®uešt
);

1057 
	`INTKEY
("LLev", 
ch
->
pcd©a
->
Ï¡_Ëv–
, 
o
->
v®uešt
);

1058 
	`INTKEY
("LogO", 
ch
->
pcd©a
->
Ï¡_logoff
, 
o
->
v®uešt
);

1059 
	`STRKEY
("Ls™", 
ch
->
pcd©a
->
Ï¡_ls™e
, 
o
->
v®ue¡ršg
);

1060 
	`INTKEY
("Ltim", 
ch
->
pcd©a
->
Ï¡_Éime
, 
	`dizzy_sÿÁime
(
o
->
v®ue¡ršg
));

1061 
	`INTKEY
("L§v", 
ch
->
pcd©a
->
Ï¡_§ved
, 
	`dizzy_sÿÁime
(
o
->
v®ue¡ršg
));

1064 
	`INTKEY
("M¬k", 
ch
->
pcd©a
->
m¬k_room
, 
	`LoÿtiÚ
(
o
->
v®uešt
));

1065 
	`INTKEY
("Mexp", 
ch
->
pcd©a
->
mud_exp
, 
o
->
v®uešt
);

1068 ià(
key
 == "Note") {

1069 
JSON
::
	`g‘_lÚg
(
o
, &
ch
->
pcd©a
->
Ï¡_nÙe
, "note");

1070 
JSON
::
	`g‘_lÚg
(
o
, &
ch
->
pcd©a
->
Ï¡_id—
, "idea");

1071 
JSON
::
	`g‘_lÚg
(
o
, &
ch
->
pcd©a
->
Ï¡_rŞ•Ïy
, "role");

1072 
JSON
::
	`g‘_lÚg
(
o
, &
ch
->
pcd©a
->
Ï¡_immque¡
, "quest");

1073 
JSON
::
	`g‘_lÚg
(
o
, &
ch
->
pcd©a
->
Ï¡_chªges
, "change");

1074 
JSON
::
	`g‘_lÚg
(
o
, &
ch
->
pcd©a
->
Ï¡_³rsÚ®
, "pers");

1075 
JSON
::
	`g‘_lÚg
(
o
, &
ch
->
pcd©a
->
Ï¡_Œade
, "trade");

1076 
fM©ch
 = 
Œue
; ;

1081 
	`STRKEY
("Pass", 
ch
->
pcd©a
->
pwd
, 
o
->
v®ue¡ršg
);

1082 
	`INTKEY
("PCkls", 
ch
->
pcd©a
->
pckls
, 
o
->
v®uešt
);

1083 
	`INTKEY
("PCkËd", 
ch
->
pcd©a
->
pckËd
, 
o
->
v®uešt
);

1084 
	`INTKEY
("PKRªk", 
ch
->
pcd©a
->
pk¿nk
, 
o
->
v®uešt
);

1085 
	`INTKEY
("Plyd", 
ch
->
pcd©a
->
¶ayed
, 
o
->
v®uešt
);

1086 
	`FLAGKEY
("PÌ", 
ch
->
pcd©a
->
¶r_æags
, 
o
->
v®ue¡ršg
);

1087 
	`INTKEY
("PÁs", 
ch
->
pcd©a
->
pošts
, 
o
->
v®uešt
);

1090 ià(
key
 == "Query") {

1091 
cJSON
 *
™em
 = 
o
->
chd
; i‹m !ğ
nuÎ±r
 && 
couÁ
 < 
MAX_QUERY
; i‹m = i‹m->
Ãxt
)

1092 
ch
->
pcd©a
->
qu”y
.
	`push_back
(
™em
->
v®ue¡ršg
);

1093 
fM©ch
 = 
Œue
; ;

1096 
	`INTKEY
("Que¡PÁs", 
ch
->
pcd©a
->
que¡pošts
, 
o
->
v®uešt
);

1097 
	`INTKEY
("QpDÚ©ed", 
ch
->
pcd©a
->
que¡pošts_dÚ©ed
, 
o
->
v®uešt
);

1098 
	`INTKEY
("Que¡Next", 
ch
->
pcd©a
->
Ãxtque¡
, 
o
->
v®uešt
);

1101 ià(
key
 == "Raff") {

1102 
cJSON
 *
™em
 = 
o
->
chd
; i‹m !ğ
nuÎ±r
 && 
couÁ
 < 
MAX_RAFFECT_SLOTS
; i‹m = i‹m->
Ãxt
)

1103 
ch
->
pcd©a
->
¿fãù
[
couÁ
++] = 
™em
->
v®uešt
;

1104 
fM©ch
 = 
Œue
; ;

1107 
	`STRKEY
("Rªk", 
ch
->
pcd©a
->
¿nk
, 
o
->
v®ue¡ršg
);

1108 
	`INTKEY
("RmCt", 
ch
->
pcd©a
->
»mÜt_couÁ
, 
o
->
v®uešt
);

1109 
	`INTKEY
("RŞePÁs", 
ch
->
pcd©a
->
rŞ•ošts
, 
o
->
v®uešt
);

1112 ià(
key
 == "Sk") {

1113 
cJSON
 *
™em
 = 
o
->
chd
; i‹m !ğ
nuÎ±r
; i‹m = i‹m->
Ãxt
) {

1114 
skl
::
ty³
 
¢
 = skl::
	`lookup
(
	`cJSON_G‘ObjeùI‹m
(
™em
, "Çme")->
v®ue¡ršg
);

1116 ià(
¢
 =ğ
skl
::
ty³
::
unknown
) {

1117 
Loggšg
::
	`bugf
("F»ad_ch¬: unknowÀskÈ'%s'.", 
	`cJSON_G‘ObjeùI‹m
(
™em
, "Çme")->
v®ue¡ršg
);

1121 
	`£t_Ë¬Ãd
(
ch
, 
¢
, 
	`cJSON_G‘ObjeùI‹m
(
™em
, "´ac")->
v®uešt
);

1122 
	`£t_evŞutiÚ
(
ch
, 
¢
, 
	`cJSON_G‘ObjeùI‹m
(
™em
, "evŞ")->
v®uešt
);

1124 
fM©ch
 = 
Œue
; ;

1127 
	`INTKEY
("SklPÁs", 
ch
->
pcd©a
->
skÍošts
, 
o
->
v®uešt
);

1128 
	`STRKEY
("Stus", 
ch
->
pcd©a
->
¡©us
, 
o
->
v®ue¡ršg
);

1129 
	`STRKEY
("Spou", 
ch
->
pcd©a
->
¥ou£
, 
o
->
v®ue¡ršg
);

1130 
	`INTKEY
("SQue¡Next", 
ch
->
pcd©a
->
Ãxtsque¡
, 
o
->
v®uešt
);

1133 ià(
key
 == "THMS") {

1134 
JSON
::
	`g‘_shÜt
(
o
, &
ch
->
pcd©a
->
Œašs_to_h™
, "hit");

1135 
JSON
::
	`g‘_shÜt
(
o
, &
ch
->
pcd©a
->
Œašs_to_h™
, "mana");

1136 
JSON
::
	`g‘_shÜt
(
o
, &
ch
->
pcd©a
->
Œašs_to_h™
, "stam");

1137 
fM©ch
 = 
Œue
; ;

1140 ià(
key
 == "Titl") {

1141 
	`£t_t™Ë
(
ch
, 
o
->
v®ue¡ršg
);

1142 
fM©ch
 = 
Œue
; ;

1145 
	`INTKEY
("TSex", 
	`ATTR_BASE
(
ch
, 
APPLY_SEX
), 
o
->
v®uešt
);

1148 
	`FLAGKEY
("Video", 
ch
->
pcd©a
->
video_æags
, 
o
->
v®ue¡ršg
);

1151 ià(
key
 == "WarpLocs") {

1152 
cJSON
 *
™em
 = 
o
->
chd
; i‹m !ğ
nuÎ±r
; i‹m = i‹m->
Ãxt
) {

1153 cÚ¡ 
Objeù
 *
obj
 = 
	`g‘_w¬p_üy¡®
(
™em
->
v®ue¡ršg
);

1155 ià(!
obj
)

1159 
ch
->
pcd©a
->
w¬p_locs
.
	`em¶aû
(
	`g‘_w¬p_loc_¡ršg
(
obj
));

1161 
fM©ch
 = 
Œue
; ;

1164 
	`STRKEY
("W¥r", 
ch
->
pcd©a
->
whi¥”
, 
o
->
v®ue¡ršg
);

1171 ià(!
fM©ch
)

1172 
Loggšg
::
	`bugf
("ä—d_¶ay”: unknowÀkey %s", 
key
);

1176 
	}
}

1179 
	$ä—d_ch¬
(
Ch¬aù”
 *
ch
, 
cJSON
 *
jsÚ
, 
v”siÚ
)

1181 ià(
jsÚ
 =ğ
nuÎ±r
)

1184 
buf
[
MSL
];

1185 
FÜm©
::
	`¥rštf
(
buf
, "Lßdšg %s.", 
ch
->
Çme
);

1186 
Loggšg
::
	`log
(
buf
);

1192 
cJSON
 *
o
 = 
jsÚ
->
chd
; o; o = o->
Ãxt
) {

1193 
SŒšg
 
key
 = 
o
->
¡ršg
;

1194 
boŞ
 
fM©ch
 = 
çl£
;

1197 
	`touµ”
(
key
[0])) {

1199 ià(
key
 == "Affc") {

1202 
cJSON
 *
™em
 = 
o
->
chd
; i‹m !ğ
nuÎ±r
; i‹m = i‹m->
Ãxt
) {

1203 
afãù
::
ty³
y³ =‡fãù::
	`lookup
(
	`cJSON_G‘ObjeùI‹m
(
™em
, "Çme")->
v®ue¡ršg
);

1205 ià(
ty³
 =ğ
afãù
::ty³::
unknown
) {

1206 
Loggšg
::
	`bugf
("F»ad_ch¬: unknowÀafãù '%s'.", 
	`cJSON_G‘ObjeùI‹m
(
™em
, "Çme")->
v®ue¡ršg
);

1210 
afãù
::
Afãù
 
af
;

1211 
af
.
ty³
 =ype;

1212 
JSON
::
	`g‘_shÜt
(
™em
, &
af
.
wh”e
, "where");

1213 
JSON
::
	`g‘_shÜt
(
™em
, &
af
.
Ëv–
, "level");

1214 
JSON
::
	`g‘_shÜt
(
™em
, &
af
.
du¿tiÚ
, "dur");

1215 
JSON
::
	`g‘_shÜt
(
™em
, &
af
.
modif›r
, "mod");

1216 
JSON
::
	`g‘_shÜt
(
™em
, &
af
.
loÿtiÚ
, "loc");

1217 
b™veùÜ
;

1218 
JSON
::
	`g‘_št
(
™em
, &
b™veùÜ
, "bitv");

1219 
af
.
	`b™veùÜ
(
	`FÏgs
(
b™veùÜ
));

1220 
JSON
::
	`g‘_shÜt
(
™em
, &
af
.
evŞutiÚ
, "evo");

1221 
af
.
³rmª’t
 = 
çl£
;

1223 
afãù
::
	`cİy_to_ch¬
(
ch
, &
af
);

1225 
fM©ch
 = 
Œue
; ;

1228 ià(
key
 == "Atrib") {

1229 
JSON
::
	`g‘_št
(
o
, &
	`ATTR_BASE
(
ch
, 
APPLY_STR
), "str");

1230 
JSON
::
	`g‘_št
(
o
, &
	`ATTR_BASE
(
ch
, 
APPLY_INT
), "int");

1231 
JSON
::
	`g‘_št
(
o
, &
	`ATTR_BASE
(
ch
, 
APPLY_WIS
), "wis");

1232 
JSON
::
	`g‘_št
(
o
, &
	`ATTR_BASE
(
ch
, 
APPLY_DEX
), "dex");

1233 
JSON
::
	`g‘_št
(
o
, &
	`ATTR_BASE
(
ch
, 
APPLY_CON
), "con");

1234 
JSON
::
	`g‘_št
(
o
, &
	`ATTR_BASE
(
ch
, 
APPLY_CHR
), "chr");

1235 
fM©ch
 = 
Œue
; ;

1238 
	`FLAGKEY
("Aù", 
ch
->
aù_æags
, 
o
->
v®ue¡ršg
);

1239 
	`INTKEY
("Alig", 
ch
->
®ignm’t
, 
o
->
v®uešt
);

1242 
	`INTKEY
("CÏn", 
ch
->
şª
, 
	`şª_lookup
(
o
->
v®ue¡ršg
));

1243 
	`INTKEY
("CÏ", 
ch
->
gud
, (
Gud
)
o
->
v®uešt
);

1244 
	`FLAGKEY
("Comm", 
ch
->
comm_æags
, 
o
->
v®ue¡ršg
);

1245 
	`FLAGKEY
("Cn¤", 
ch
->
ûnsÜ_æags
, 
o
->
v®ue¡ršg
);

1248 
	`INTKEY
("Dam", 
	`ATTR_BASE
(
ch
, 
APPLY_DAMROLL
), 
o
->
v®uešt
);

1249 
	`STRKEY
("Desc", 
ch
->
desütiÚ
, 
o
->
v®ue¡ršg
);

1252 
	`INTKEY
("Exp", 
ch
->
exp
, 
o
->
v®uešt
);

1257 ià(
key
 =ğ"GlDÚ©ed" && !
ch
->
	`is_Åc
()) {

1258 
ch
->
pcd©a
->
gŞd_dÚ©ed
 = 
o
->
v®uešt
;

1259 
fM©ch
 = 
Œue
; ;

1262 
	`INTKEY
("GŞd_š_bªk", 
ch
->
gŞd_š_bªk
, 
o
->
v®uešt
);

1263 
	`INTKEY
("GŞd", 
ch
->
gŞd
, 
o
->
v®uešt
);

1266 ià(
key
 == "HMS") {

1267 
JSON
::
	`g‘_shÜt
(
o
, &
ch
->
h™
, "hit");

1268 
JSON
::
	`g‘_shÜt
(
o
, &
ch
->
mªa
, "mana");

1269 
JSON
::
	`g‘_shÜt
(
o
, &
ch
->
¡am
, "stam");

1270 
fM©ch
 = 
Œue
; ;

1273 ià(
key
 == "HMSP") {

1274 
JSON
::
	`g‘_št
(
o
, &
	`ATTR_BASE
(
ch
, 
APPLY_HIT
), "hit");

1275 
JSON
::
	`g‘_št
(
o
, &
	`ATTR_BASE
(
ch
, 
APPLY_MANA
), "mana");

1276 
JSON
::
	`g‘_št
(
o
, &
	`ATTR_BASE
(
ch
, 
APPLY_STAM
), "stam");

1277 
fM©ch
 = 
Œue
; ;

1280 
	`INTKEY
("H™", 
	`ATTR_BASE
(
ch
, 
APPLY_HITROLL
), 
o
->
v®uešt
);

1283 ià(
key
 =ğ"Id" && !
ch
->
	`is_Åc
()) {

1284 
ch
->
pcd©a
->
id
 = 
o
->
v®uešt
;

1285 
fM©ch
 = 
Œue
; ;

1287 
	`INTKEY
("Invi", 
ch
->
švis_Ëv–
, 
o
->
v®uešt
);

1290 
	`INTKEY
("Levl", 
ch
->
Ëv–
, 
o
->
v®uešt
);

1291 
	`STRKEY
("LnD", 
ch
->
lÚg_desü
, 
o
->
v®ue¡ršg
);

1292 
	`INTKEY
("Lurk", 
ch
->
lurk_Ëv–
, 
o
->
v®uešt
);

1295 
	`STRKEY
("Name", 
ch
->
Çme
, 
o
->
v®ue¡ršg
);

1298 
	`INTKEY
("Pos", 
ch
->
pos™iÚ
, 
o
->
v®uešt
);

1299 
	`INTKEY
("PosP", 
ch
->
¡¬t_pos
, 
o
->
v®uešt
);

1300 
	`INTKEY
("P¿c", 
ch
->
´aùiû
, 
o
->
v®uešt
);

1301 
	`STRKEY
("Prom", 
ch
->
´om±
, 
o
->
v®ue¡ršg
);

1304 ià(
key
 =ğ"Que¡PÁs" && !
ch
->
	`is_Åc
()) {

1305 
ch
->
pcd©a
->
que¡pošts
 = 
o
->
v®uešt
;

1306 
fM©ch
 = 
Œue
; ;

1308 ià(
key
 =ğ"QpDÚ©ed" && !
ch
->
	`is_Åc
()) {

1309 
ch
->
pcd©a
->
que¡pošts_dÚ©ed
 = 
o
->
v®uešt
;

1310 
fM©ch
 = 
Œue
; ;

1312 ià(
key
 =ğ"Que¡Next" && !
ch
->
	`is_Åc
()) {

1313 
ch
->
pcd©a
->
Ãxtque¡
 = 
o
->
v®uešt
;

1314 
fM©ch
 = 
Œue
; ;

1318 
	`INTKEY
("Raû", 
ch
->
¿û
, 
	`¿û_lookup
(
o
->
v®ue¡ršg
));

1319 
	`INTKEY
("Room", 
ch
->
š_room
, 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
o
->
v®uešt
)));

1320 
	`FLAGKEY
("Revk", 
ch
->
»voke_æags
, 
o
->
v®ue¡ršg
);

1323 
	`INTKEY
("Save", 
	`ATTR_BASE
(
ch
, 
APPLY_SAVES
), 
o
->
v®uešt
);

1324 
	`INTKEY
("Süo", 
ch
->
lšes
, 
o
->
v®uešt
);

1325 
	`INTKEY
("Secu", 
ch
->
£cu»_Ëv–
, 
o
->
v®uešt
);

1326 
	`INTKEY
("Sex", 
	`ATTR_BASE
(
ch
, 
APPLY_SEX
), 
o
->
v®uešt
);

1327 
	`STRKEY
("ShD", 
ch
->
shÜt_desü
, 
o
->
v®ue¡ršg
);

1328 
	`INTKEY
("Sv”_š_bªk",
ch
->
sv”_š_bªk
, 
o
->
v®uešt
);

1329 
	`INTKEY
("Sv", 
ch
->
sv”
, 
o
->
v®uešt
);

1332 
	`INTKEY
("T¿i", 
ch
->
Œaš
, 
o
->
v®uešt
);

1335 
	`SKIPKEY
("Vnum");

1338 
	`INTKEY
("Wimp", 
ch
->
wimpy
, 
o
->
v®uešt
);

1339 
	`FLAGKEY
("Wizn", 
ch
->
wizÃt_æags
, 
o
->
v®ue¡ršg
);

1346 ià(!
fM©ch
)

1347 
Loggšg
::
	`bugf
("ä—d_ch¬: unknowÀkey %s", 
key
);

1349 
	}
}

1352 
Objeù
 * 
	$ä—d_obj
(
cJSON
 *
jsÚ
, 
v”siÚ
) {

1353 
Objeù
 *
obj
 = 
nuÎ±r
;

1354 
cJSON
 *
o
;

1356 ià((
o
 = 
	`cJSON_G‘ObjeùI‹m
(
jsÚ
, "Vnum")è!ğ
nuÎ±r
) {

1357 
ObjeùPrÙÙy³
 *
šdex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
o
->
v®uešt
);

1359 ià(
šdex
 =ğ
nuÎ±r
)

1360 
Loggšg
::
	`bug
("F»ad_obj: bad vnum %d iÀä—d_obj().", 
o
->
v®uešt
);

1362 
obj
 = 
	`ü—‹_objeù
(
šdex
, -1);

1364 ià(
obj
 =ğ
nuÎ±r
)

1365 
Loggšg
::
	`bug
("fread_obj: create_object„eturned‚ullptr", 0);

1369 
Loggšg
::
	`bug
("fread_obj:‚o vnum field in JSON object", 0);

1371 ià(
obj
 =ğ
nuÎ±r
) {

1377 
obj
 = 
Ãw
 
	`Objeù
();

1384 ià(
v”siÚ
 < 20

1385 && 
obj
->
™em_ty³
 =ğ
ITEM_WEAPON
) {

1386 
afãù
::
	`»move_ty³_äom_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_æamšg
);

1387 
afãù
::
	`»move_ty³_äom_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_äo¡
);

1388 
afãù
::
	`»move_ty³_äom_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_shockšg
);

1389 
afãù
::
	`»move_ty³_äom_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_vampœic
);

1391 
afãù
::
	`»move_ty³_äom_obj
(
obj
,‡fãù::
ty³
::
poisÚ
);

1392 
afãù
::
	`»move_ty³_äom_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_sh¬p
);

1393 
afãù
::
	`»move_ty³_äom_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_vÜ·l
);

1394 
afãù
::
	`»move_ty³_äom_obj
(
obj
,‡fãù::
ty³
::
w—pÚ_two_hªds
);

1397 
cJSON
 *
o
 = 
jsÚ
->
chd
; o; o = o->
Ãxt
) {

1398 
SŒšg
 
key
 = 
o
->
¡ršg
;

1399 
boŞ
 
fM©ch
 = 
çl£
;

1402 
	`touµ”
(
key
[0])) {

1404 ià(
key
 == "Affc") {

1411 ià(
v”siÚ
 > 15 && version < 17) {

1412 
fM©ch
 = 
Œue
; ;

1416 
afãù
::
	`»move_®l_äom_obj
(
obj
, 
Œue
);

1418 
cJSON
 *
™em
 = 
o
->
chd
; i‹m !ğ
nuÎ±r
; i‹m = i‹m->
Ãxt
) {

1419 
afãù
::
Afãù
 
af
;

1420 
af
.
ty³
 = 
afãù
::
	`lookup
(
	`cJSON_G‘ObjeùI‹m
(
™em
, "Çme")->
v®ue¡ršg
);

1423 
JSON
::
	`g‘_shÜt
(
™em
, &
af
.
wh”e
, "where");

1424 
JSON
::
	`g‘_shÜt
(
™em
, &
af
.
Ëv–
, "level");

1425 
JSON
::
	`g‘_shÜt
(
™em
, &
af
.
du¿tiÚ
, "dur");

1426 
JSON
::
	`g‘_shÜt
(
™em
, &
af
.
modif›r
, "mod");

1427 
JSON
::
	`g‘_shÜt
(
™em
, &
af
.
loÿtiÚ
, "loc");

1428 
tb™v
;

1429 
JSON
::
	`g‘_št
(
™em
, &
tb™v
, "bitv");

1430 
af
.
	`b™veùÜ
(
	`FÏgs
(
tb™v
));

1431 
JSON
::
	`g‘_shÜt
(
™em
, &
af
.
evŞutiÚ
, "evo");

1438 ià(
af
.
wh”e
 =ğ
TO_AFFECTS
 &&‡f.
ty³
 =ğ
afãù
::ty³::
nÚe
 &&‡f.
	`b™veùÜ
().
	`em±y
())

1439 
af
.
wh”e
 = 
TO_OBJECT
;

1441 ià(
af
.
ty³
 =ğ
afãù
::ty³::
unknown
) {

1442 
Loggšg
::
	`bugf
("F»ad_obj: unknowÀafãùy³ '%s'.", 
	`cJSON_G‘ObjeùI‹m
(
™em
, "Çme")->
v®ue¡ršg
);

1446 ià(
af
.
wh”e
 =ğ
TO_WEAPON
)

1447 
obj
->
v®ue
[4] -ğ
	`FÏgs
(
af
.
	`b™veùÜ
());

1454 
FÏgs
 
	`b™veùÜ
(
af
.bitvector());

1459 ià(
afãù
::
	`·r£_æags
(0, &
af
, 
b™veùÜ
)) {

1460 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

1463 
af
.
loÿtiÚ
 = 0;

1464 
af
.
modif›r
 = 0;

1467 
af
.
ty³
 = 
afãù
::ty³::
nÚe
;

1468 } !
b™veùÜ
.
	`em±y
());

1470 
fM©ch
 = 
Œue
; ;

1474 ià(
key
 == "contains") {

1477 
cJSON
 *
™em
 = 
o
->
chd
; i‹m; i‹m = i‹m->
Ãxt
) {

1478 
Objeù
 *
cÚ‹Á
 = 
	`ä—d_obj
(
™em
, 
v”siÚ
);

1480 ià(
cÚ‹Á
->
pIndexD©a
) {

1481 ià(
cÚ‹Á
->
cÚd™iÚ
 == 0)

1482 
cÚ‹Á
->
cÚd™iÚ
 = cÚ‹Á->
pIndexD©a
->condition;

1484 
	`obj_to_obj
(
cÚ‹Á
, 
obj
);

1488 
cÚ‹Á
->
cÚšs
) {

1489 
Objeù
 *
c
 = 
cÚ‹Á
->
cÚšs
;

1490 
cÚ‹Á
->
cÚšs
 = 
c
->
Ãxt_cÚ‹Á
;

1491 
	`obj_to_obj
(
c
, 
obj
);

1494 
	`exŒaù_obj
(
cÚ‹Á
);

1497 
fM©ch
 = 
Œue
; ;

1500 
	`INTKEY
("CÚd", 
obj
->
cÚd™iÚ
, 
o
->
v®uešt
);

1501 
	`INTKEY
("Co¡", 
obj
->
co¡
, 
o
->
v®uešt
);

1504 
	`STRKEY
("Desc", 
obj
->
desütiÚ
, 
o
->
v®ue¡ršg
);

1507 ià(
key
 == "ExDe") {

1508 
cJSON
 *
™em
 = 
o
->
chd
; i‹m; i‹m = i‹m->
Ãxt
) {

1509 
ExŒaDesü
 *
ed
 = 
Ãw
 
	`ExŒaDesü
(
™em
->
¡ršg
, i‹m->
v®ue¡ršg
);

1510 
ed
->
Ãxt
 = 
obj
->
exŒa_desü
;

1511 
obj
->
exŒa_desü
 = 
ed
;

1513 
fM©ch
 = 
Œue
; ;

1516 
	`FLAGKEY
("ExtF", 
obj
->
exŒa_æags
, 
o
->
v®uešt
);

1519 ià(
key
 == "gems") {

1522 
cJSON
 *
™em
 = 
o
->
chd
; i‹m; i‹m = i‹m->
Ãxt
) {

1523 
Objeù
 *
gem
 = 
	`ä—d_obj
(
™em
, 
v”siÚ
);

1525 ià(
gem
->
pIndexD©a
) {

1526 
gem
::
	`š£t
(gem, 
obj
);

1529 
	`exŒaù_obj
(
gem
);

1532 
fM©ch
 = 
Œue
; ;

1536 
	`INTKEY
("Ityp", 
obj
->
™em_ty³
, 
o
->
v®uešt
);

1539 
	`INTKEY
("Lev", 
obj
->
Ëv–
, 
o
->
v®uešt
);

1542 
	`STRKEY
("M©", 
obj
->
m©”Ÿl
, 
o
->
v®ue¡ršg
);

1545 
	`STRKEY
("Name", 
obj
->
Çme
, 
	`SŒšg
(
o
->
v®ue¡ršg
).
	`uncŞÜ
().
	`»¶aû
("(", "").replace(")", ""));

1548 
	`STRKEY
("ShD", 
obj
->
shÜt_desü
, 
o
->
v®ue¡ršg
);

1551 
	`INTKEY
("Time", 
obj
->
tim”
, 
o
->
v®uešt
);

1554 ià(
key
 == "Val") {

1555 
¦Ù
 = 0;

1556 
cJSON
 *
™em
 = 
o
->
chd
; i‹m; i‹m = i‹m->
Ãxt
, 
¦Ù
++)

1557 
obj
->
v®ue
[
¦Ù
] = 
™em
->
v®uešt
;

1559 
fM©ch
 = 
Œue
; ;

1562 
	`SKIPKEY
("Vnum");

1565 
	`FLAGKEY
("W—F", 
obj
->
w—r_æags
, 
o
->
v®uešt
);

1566 
	`INTKEY
("W—r", 
obj
->
w—r_loc
, 
o
->
v®uešt
);

1567 
	`INTKEY
("Wt", 
obj
->
weight
, 
o
->
v®uešt
);

1573 ià(!
fM©ch
)

1574 
Loggšg
::
	`bugf
("ä—d_obj: unknowÀkey %s", 
key
);

1581 ià(
v”siÚ
 < 20

1582 && 
obj
->
™em_ty³
 =ğ
ITEM_WEAPON
) {

1583 
FÏgs
 
b™veùÜ
 = 
obj
->
v®ue
[4];

1585 
afãù
::
Afãù
 
af
;

1586 
af
.
Ëv–
 = 
obj
->level;

1587 
af
.
du¿tiÚ
 = -1;

1588 
af
.
evŞutiÚ
 = 1;

1589 
af
.
³rmª’t
 = 
Œue
;

1590 
af
.
loÿtiÚ
 = 0;

1591 
af
.
modif›r
 = 0;

1593 !
b™veùÜ
.
	`em±y
()) {

1594 
af
.
ty³
 = 
afãù
::ty³::
nÚe
;

1596 ià(
afãù
::
	`·r£_æags
('W', &
af
, 
b™veùÜ
)) {

1598 ià(!
afãù
::
	`exi¡s_Ú_obj
(
obj
, 
af
.
ty³
))

1599 
afãù
::
	`cİy_to_obj
(
obj
, &
af
);

1603 
obj
->
v®ue
[4] = 0;

1606  
obj
;

1607 
	}
}

1610 
ä—d_objeùs
(
Ch¬aù”
 *
ch
, 
cJSON
 *
cÚšs
, (*
obj_to
)(
Objeù
 *, Ch¬aù” *), 
v”siÚ
) {

1611 ià(
cÚšs
 =ğ
nuÎ±r
)

1614 
cJSON
 *
™em
 = 
cÚšs
->
chd
; i‹m; i‹m = i‹m->
Ãxt
) {

1615 
Objeù
 *
cÚ‹Á
 = 
	`ä—d_obj
(
™em
, 
v”siÚ
);

1617 ià(
cÚ‹Á
->
pIndexD©a
) {

1618 ià(
cÚ‹Á
->
cÚd™iÚ
 == 0)

1619 
cÚ‹Á
->
cÚd™iÚ
 = cÚ‹Á->
pIndexD©a
->condition;

1621 (*
obj_to
)(
cÚ‹Á
, 
ch
);

1625 
cÚ‹Á
->
cÚšs
) {

1626 
Objeù
 *
c
 = 
cÚ‹Á
->
cÚšs
;

1627 
cÚ‹Á
->
cÚšs
 = 
c
->
Ãxt_cÚ‹Á
;

1628 (*
obj_to
)(
c
, 
ch
);

1632 
	`exŒaù_obj
(
cÚ‹Á
);

1635 
	}
}

1638 
	$ä—d_³t
(
Ch¬aù”
 *
ch
, 
cJSON
 *
jsÚ
, 
v”siÚ
)

1640 
cJSON
 *
o
;

1642 ià(
jsÚ
 =ğ
nuÎ±r
)

1645 
vnum
;

1648 ià((
o
 = 
	`cJSON_G‘ObjeùI‹m
(
jsÚ
, "Vnum")è!ğ
nuÎ±r
) {

1649 
vnum
 = 
o
->
v®uešt
;

1652 
Loggšg
::
	`bug
("fread_pet:‚o vnum field in JSON object", 0);

1653 
vnum
 = 
MOB_VNUM_FIDO
;

1656 
MobePrÙÙy³
 *
šdex
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
vnum
);

1658 ià(
šdex
 =ğ
nuÎ±r
) {

1659 
Loggšg
::
	`bug
("F»ad_³t: bad vnum %d iÀä—d_³t().", 
vnum
);

1660 
šdex
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
MOB_VNUM_FIDO
);

1663 
Ch¬aù”
 *
³t
 = 
	`ü—‹_mobe
(
šdex
);

1666 ià(!
³t
) {

1667 
Loggšg
::
	`bug
("Memoryƒrror creating mob in fread_pet().", 0);

1672 
afãù
::
	`»move_®l_äom_ch¬
(
³t
, 
çl£
);

1674 
	`ä—d_ch¬
(
³t
, 
jsÚ
, 
v”siÚ
);

1676 
³t
->
Ëad”
 = 
ch
;

1677 
³t
->
ma¡”
 = 
ch
;

1678 
ch
->
³t
 =…et;

1681 
³rûÁ
;

1682 
³rûÁ
 = (
Game
::
cu¼’t_time
 - 
ch
->
pcd©a
->
Ï¡_logoff
) * 25 / (2 * 60 * 60);

1683 
³rûÁ
 = 
¡d
::
	`mš
(percent, 100);

1685 ià(
³rûÁ
 > 0 && !
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
poisÚ
)

1686 && !
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¶ague
)) {

1687 
³t
->
h™
 +ğ(
	`GET_MAX_HIT
Õ‘è-…‘->h™è* 
³rûÁ
 / 100;

1688 
³t
->
mªa
 +ğ(
	`GET_MAX_MANA
Õ‘è-…‘->mªaè* 
³rûÁ
 / 100;

1689 
³t
->
¡am
 +ğ(
	`GET_MAX_STAM
Õ‘è-…‘->¡amè* 
³rûÁ
 / 100;

1691 
	}
}

1694 
	$upd©e_pc_šdex
(cÚ¡ 
Ch¬aù”
 *
ch
, 
boŞ
 
»move
)

1696 
	`db_commªdf
("upd©e_pc_šdex", "DELETE FROM…c_šdex WHERE‚ame='%s'", 
	`db_esc
(
ch
->
Çme
));

1698 ià(!
»move
)

1699 
	`db_commªdf
("update_pc_index",

1701 
	`db_esc
(
ch
->
Çme
),

1702 
	`db_esc
(
ch
->
pcd©a
->
t™Ë
),

1703 
	`db_esc
(
ch
->
pcd©a
->
de™y
),

1704 
	`db_esc
(
ch
->
pcd©a
->
de™y
.
	`uncŞÜ
()),

1705 
ch
->
pcd©a
->
cgroup_æags
.
	`to_ulÚg
(),

1706 
ch
->
Ëv–
,

1707 
ch
->
pcd©a
->
»mÜt_couÁ
,

1708 
ch
->
şª
 ? 
	`db_esc
(ch->şª->
Çme
) : "",

1709 
ch
->
şª
 && !ch->
pcd©a
->
¿nk
.
	`em±y
(è? 
	`db_esc
(ch->pcdata->rank) : "");

1710 
	}
}

1713 
	$do_fšg”
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1715 
f’ame
[
MAX_INPUT_LENGTH
];

1716 
buf
[
MAX_STRING_LENGTH
];

1717 
SŒšg
 
dbuf
;

1720 
SŒšg
 
ema
, 
fšg”šfo
, 
Ï¡_ls™e
, 
Çme
, 
t™Ë
, 
¥ou£
, 
¿û
, 
de™y
;

1721 
gud
, 
pks
, 
pkd
, 
pkr
, 
aks
, 
akd
, 
Ëv–
, 
rmù
;

1722 
FÏgs
 
cgroup
, 
¶r
;

1723 
time_t
 
Ï¡_Éime
, 
Ï¡_§ved
;

1724 
CÏn
 *
şª
 = 
nuÎ±r
;

1726 
SŒšg
 
¬g
;

1727 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1729 ià(
¬g
.
	`em±y
()) {

1730 
	`¡c
("Syntax:\n"

1733 " {YShowÏ¡{x : hide you¸Ï¡†ogš/§vtimes\n", 
ch
);

1737 ià(
¬g
 == "private") {

1738 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_SHOWEMAIL
)) {

1739 
	`¡c
("You¸ema wÈnØlÚg” di¥Ïy iÀyou¸fšg” info.\n", 
ch
);

1740 
ch
->
pcd©a
->
¶r_æags
 -ğ
PLR_SHOWEMAIL
;

1743 
	`¡c
("You¸ema wÈnow di¥Ïy iÀyou¸fšg” info.\n", 
ch
);

1744 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_SHOWEMAIL
;

1747 
	`do_§ve
(
ch
, "");

1751 ià(!
	`check_·r£_Çme
(
¬g
)) {

1752 
	`¡c
("Th© i nÙ‡ v®id…Ïy”‚ame.\n", 
ch
);

1756 
FÜm©
::
	`¥rštf
(
f’ame
, "%s%s", 
PLAYER_DIR
, 
¬g
.
	`low”ÿ£
().
	`ÿp™®ize
());

1758 
cJSON
 *
roÙ
 = 
JSON
::
	`»ad_fe
(
f’ame
);

1760 ià(
roÙ
 =ğ
nuÎ±r
) {

1761 
	`¡c
("Th©…Ïy” dÛ nÙƒxi¡.\n", 
ch
);

1767 
gud
 = 
pks
 = 
pkd
 = 
pkr
 = 
aks
 = 
akd
 = 
Ëv–
 = 
rmù
 = 0;

1769 
cJSON
 *
£ùiÚ
, *
™em
;

1770 
£ùiÚ
 = 
	`cJSON_G‘ObjeùI‹m
(
roÙ
, "character");

1771 
JSON
::
	`g‘_¡ršg
(
£ùiÚ
, &
Çme
, "Name");

1772 
JSON
::
	`g‘_¡ršg
(
£ùiÚ
, &
¿û
, "Race");

1773 
JSON
::
	`g‘_št
(
£ùiÚ
, &
Ëv–
, "Levl");

1774 
JSON
::
	`g‘_št
(
£ùiÚ
, &
gud
, "Cla");

1776 ià((
™em
 = 
	`cJSON_G‘ObjeùI‹m
(
£ùiÚ
, "CÏn")è!ğ
nuÎ±r
)

1777 
şª
 = 
	`şª_lookup
(
™em
->
v®ue¡ršg
);

1779 
£ùiÚ
 = 
	`cJSON_G‘ObjeùI‹m
(
roÙ
, "player");

1780 
JSON
::
	`g‘_¡ršg
(
£ùiÚ
, &
ema
, "Email");

1781 
JSON
::
	`g‘_¡ršg
(
£ùiÚ
, &
fšg”šfo
, "Finf");

1782 
JSON
::
	`g‘_¡ršg
(
£ùiÚ
, &
t™Ë
, "Titl");

1783 
JSON
::
	`g‘_¡ršg
(
£ùiÚ
, &
¥ou£
, "Spou");

1784 
JSON
::
	`g‘_¡ršg
(
£ùiÚ
, &
de™y
, "Deit");

1785 
JSON
::
	`g‘_¡ršg
(
£ùiÚ
, &
Ï¡_ls™e
, "Lsit");

1786 
JSON
::
	`g‘_št
(
£ùiÚ
, &
pks
, "PCkills");

1787 
JSON
::
	`g‘_št
(
£ùiÚ
, &
pkd
, "PCkilled");

1788 
JSON
::
	`g‘_št
(
£ùiÚ
, &
pkr
, "PKRank");

1789 
JSON
::
	`g‘_št
(
£ùiÚ
, &
aks
, "Akills");

1790 
JSON
::
	`g‘_št
(
£ùiÚ
, &
akd
, "Akilled");

1791 
JSON
::
	`g‘_št
(
£ùiÚ
, &
rmù
, "RmCt");

1792 
JSON
::
	`g‘_æags
(
£ùiÚ
, &
cgroup
, "Cgrp");

1793 
JSON
::
	`g‘_æags
(
£ùiÚ
, &
¶r
, "Plr");

1795 ià((
™em
 = 
	`cJSON_G‘ObjeùI‹m
(
£ùiÚ
, "Ltim")è!ğ
nuÎ±r
)

1796 
Ï¡_Éime
 = 
	`dizzy_sÿÁime
(
™em
->
v®ue¡ršg
);

1797 ià((
™em
 = 
	`cJSON_G‘ObjeùI‹m
(
£ùiÚ
, "LSav")è!ğ
nuÎ±r
)

1798 
Ï¡_§ved
 = 
	`dizzy_sÿÁime
(
™em
->
v®ue¡ršg
);

1800 
	`cJSON_D–‘e
(
roÙ
);

1804 ià(
t™Ë
[0] != '.' &&itle[0] != ',' &&itle[0] != '!' &&itle[0] != '?') {

1805 
FÜm©
::
	`¥rštf
(
buf
, " %s{x", 
t™Ë
);

1806 
t™Ë
 = 
buf
;

1809 ià(
	`RANK
(
cgroup
è>ğ
RANK_IMM
)

1810 
FÜm©
::
	`¥rštf
(
buf
, "{W[{CIMM{W] %s%s{x\n", 
Çme
, 
t™Ë
);

1811 ià(
rmù
 == 0)

1812 
FÜm©
::
	`¥rštf
(
buf
, "{W[{B%2d{W] %s%s{x\n", 
Ëv–
, 
Çme
, 
t™Ë
);

1814 
FÜm©
::
	`¥rštf
(
buf
, "{W[{GR%d{T/{B%2d{W] %s%s{x\n", 
rmù
, 
Ëv–
, 
Çme
, 
t™Ë
);

1816 
dbuf
 +ğ
buf
;

1818 ià(
şª
) {

1819 ià(
cgroup
.
	`has
(
GROUP_LEADER
))

1820 
FÜm©
::
	`¥rštf
(
buf
, "{BLeader of ");

1821 ià(
cgroup
.
	`has
(
GROUP_DEPUTY
))

1822 
FÜm©
::
	`¥rštf
(
buf
, "{BDeputy of ");

1824 
FÜm©
::
	`¥rštf
(
buf
, "{BMember of ");

1826 
dbuf
 +ğ
buf
;

1827 
FÜm©
::
	`¥rštf
(
buf
, "%s{x\n", 
şª
->
şªÇme
);

1828 
dbuf
 +ğ
buf
;

1831 
FÜm©
::
	`¥rštf
(
buf
, "{C% ", 
¿û
.
	`ÿp™®ize
());

1832 
dbuf
 +ğ
buf
;

1833 
FÜm©
::
	`¥rštf
(
buf
, "{C%s, follower of %s{x\n",

1834 (
Gud
)
gud
 =ğGud::
nÚe
 ? "adv’tu»r" : 
gud_bË
[gud].
Çme
.
	`ÿp™®ize
(), 
de™y
);

1835 
dbuf
 +ğ
buf
;

1836 
FÜm©
::
	`¥rštf
(
buf
, "{GA»Ç RecÜd: %d wšs, %d†os£s{x\n", 
aks
, 
akd
);

1837 
dbuf
 +ğ
buf
;

1838 
FÜm©
::
	`¥rštf
(
buf
, "{PBlood T¿ (%d): %d kls, %d d—ths{x\n\n", 
pkr
, 
pks
, 
pkd
);

1839 
dbuf
 +ğ
buf
;

1841 ià(!
fšg”šfo
.
	`em±y
()) {

1842 
FÜm©
::
	`¥rštf
(
buf
, "{CAdd™iÚ® Info:{x\n%s{x\n", 
fšg”šfo
);

1843 
dbuf
 +ğ
buf
;

1846 ià(!
¥ou£
.
	`em±y
()) {

1847 ià(!
¶r
.
	`has
(
PLR_MARRIED
))

1848 
FÜm©
::
	`¥rštf
(
buf
, "{Y% i ’gagedØ%s.{x\n", 
Çme
, 
¥ou£
);

1850 
FÜm©
::
	`¥rštf
(
buf
, "{Y% i h­py m¬r›dØ%s.{x\n", 
Çme
, 
¥ou£
);

1852 
dbuf
 +ğ
buf
;

1855 ià(!
ema
.
	`em±y
(è&& (
	`IS_IMMORTAL
(
ch
è|| 
¶r
.
	`has
(
PLR_SHOWEMAIL
))) {

1856 
FÜm©
::
	`¥rštf
(
buf
, "{GEma: %s{x\n", 
ema
);

1857 
dbuf
 +ğ
buf
;

1860 ià(
	`IS_IMMORTAL
(
ch
è|| !
¶r
.
	`has
(
PLR_NOSHOWLAST
)) {

1861 ià(
Ï¡_Éime
) {

1862 
FÜm©
::
	`¥rštf
(
buf
, "{HLa¡ Logš : %s\n{x", 
	`dizzy_ùime
(&
Ï¡_Éime
));

1863 
dbuf
 +ğ
buf
;

1866 ià(
Ï¡_§ved
) {

1867 
FÜm©
::
	`¥rštf
(
buf
, "{HLa¡ Saved : %s\n{x", 
	`dizzy_ùime
(&
Ï¡_§ved
));

1868 
dbuf
 +ğ
buf
;

1872 ià(
	`IS_IMP
(
ch
)) {

1873 
FÜm©
::
	`¥rštf
(
buf
, "{HLa¡ S™ : %s{x\n", 
Ï¡_ls™e
);

1874 
dbuf
 +ğ
buf
;

1877 
dbuf
 += "\n";

1878 
	`·ge_to_ch¬
(
dbuf
, 
ch
);

1879 
	}
}

1884 
boŞ
 
	$check_·r£_Çme
(cÚ¡ 
SŒšg
& 
Çme
)

1886 
CÏn
 *
şª
;

1891 ià(
	`SŒšg
(

1893 ).
	`has_wÜds
(
Çme
))

1894  
çl£
;

1896 ià((
şª
 = 
	`şª_lookup
(
Çme
)è!ğ
nuÎ±r
)

1897  
çl£
;

1903 ià(
	`¡¾’
(
Çme
) < 2)

1904  
çl£
;

1906 ià(
	`¡¾’
(
Çme
) > 12)

1907  
çl£
;

1914 
boŞ
 
fIÎ
, 
adjÿps
 = 
çl£
, 
ş—nÿps
 = false;

1915 
tÙ®_ÿps
 = 0;

1916 
fIÎ
 = 
Œue
;

1918 cÚ¡ *
pc
 = 
Çme
.
	`c_¡r
(); *pc != '\0';…c++) {

1919 ià(!
	`i§Íha
(*
pc
))

1920  
çl£
;

1922 ià(
	`isuµ”
(*
pc
)) {

1923 ià(
adjÿps
)

1924 
ş—nÿps
 = 
Œue
;

1926 
tÙ®_ÿps
++;

1927 
adjÿps
 = 
Œue
;

1930 
adjÿps
 = 
çl£
;

1932 ià(
	`tŞow”
(*
pc
) != 'i' &&olower(*pc) != 'l')

1933 
fIÎ
 = 
çl£
;

1936 ià(
fIÎ
)

1937  
çl£
;

1939 ià(
ş—nÿps
 || (
tÙ®_ÿps
 > (
	`¡¾’
(
Çme
)) / 2 && strlen(name) < 3))

1940  
çl£
;

1943  
Œue
;

1944 
	}
}

	@src/scan.cc

28 
	~"aù.hh
"

29 
	~"¬gum’t.hh
"

30 
	~"Ch¬aù”.hh
"

31 
	~"deş¬e.hh
"

32 
	~"Ex™.hh
"

33 
	~"FÏgs.hh
"

34 
	~"FÜm©.hh
"

35 
	~"lookup.hh
"

36 
	~"m”c.hh
"

37 
	~"Room.hh
"

38 
	~"SŒšg.hh
"

40 *cÚ¡ 
	gdi¡ªû
[4] = {

47 
sÿn_li¡
 
¬gs
((
Room
 *
sÿn_room
, 
Ch¬aù”
 *
ch
, 
d•th
, 
doÜ
));

48 
sÿn_room
 
¬gs
((
Room
 *
room
, 
Ch¬aù”
 *
ch
, 
d•th
, 
doÜ
, 
Ex™
 *
³x™
));

49 
sÿn_ch¬
 
¬gs
((
Ch¬aù”
 *
viùim
, Ch¬aù” *
ch
, 
d•th
, 
doÜ
));

51 
	$do_sÿn
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

53 
buf
[
MIL
];

54 
Room
 *
room
;

55 
Ex™
 *
pEx™
;

56 
doÜ
, 
d•th
;

58 
SŒšg
 
¬g1
;

59 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

61 ià(
¬g1
.
	`em±y
()) {

62 
	`aù
("$Àsÿn ®È¬ound.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_NOTVIEW
);

63 
	`¡c
("{PLookšg‡round you s“:{x\n", 
ch
);

64 
	`sÿn_room
(
ch
->
š_room
, ch, 0, -1, 
nuÎ±r
);

66 
doÜ
 = 0; door < 6; door++) {

67 ià((
pEx™
 = 
ch
->
š_room
->
ex™
[
doÜ
]è=ğ
nuÎ±r


68 || (
pEx™
->
to_room
è=ğ
nuÎ±r


69 || !
	`ÿn_£e_room
(
ch
, 
pEx™
->
to_room
))

72 
	`sÿn_room
(
pEx™
->
to_room
, 
ch
, 1, 
doÜ
,…Exit);

77 ià(
¬g1
.
	`is_´efix_of
("nÜth")è
doÜ
 = 0;

78 ià(
¬g1
.
	`is_´efix_of
("—¡")è
doÜ
 = 1;

79 ià(
¬g1
.
	`is_´efix_of
("south")è
doÜ
 = 2;

80 ià(
¬g1
.
	`is_´efix_of
("we¡")è
doÜ
 = 3;

81 ià(
¬g1
.
	`is_´efix_of
("up")è
doÜ
 = 4;

82 ià(
¬g1
.
	`is_´efix_of
("down")è
doÜ
 = 5;

84 
	`¡c
("Which way dØyou wªˆtØsÿn?\n", 
ch
);

88 
	`aù
("{PYou…“¸š‹Ály $T.{x", 
ch
, 
nuÎ±r
, 
Ex™
::
	`dœ_Çme
(
doÜ
), 
TO_CHAR
);

89 
	`aù
("$À³” š‹Ály $T.", 
ch
, 
nuÎ±r
, 
Ex™
::
	`dœ_Çme
(
doÜ
), 
TO_NOTVIEW
);

90 
FÜm©
::
	`¥rštf
(
buf
, "{GLookšg % you s“:{x\n", 
Ex™
::
	`dœ_Çme
(
doÜ
));

91 
room
 = 
ch
->
š_room
;

93 
d•th
 = 1; depth < 4; depth++) {

94 ià((
pEx™
 = 
room
->
ex™
[
doÜ
]è=ğ
nuÎ±r


95 || (
pEx™
->
to_room
è=ğ
nuÎ±r


96 || !
	`ÿn_£e_room
(
ch
, 
pEx™
->
to_room
))

99 
room
 = 
pEx™
->
to_room
;

100 
	`sÿn_room
(
room
, 
ch
, 
d•th
, 
doÜ
, 
pEx™
);

102 ià(
pEx™
->
ex™_æags
.
	`has
(
EX_CLOSED
))

105 
	}
}

107 
	$do_Şdsÿn
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

109 
buf
[
MIL
];

110 
Room
 *
sÿn_room
;

111 
Ex™
 *
pEx™
;

112 
doÜ
, 
d•th
;

114 
SŒšg
 
¬g1
;

115 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

117 ià(
¬g1
.
	`em±y
()) {

118 
	`aù
("$Àsÿn ®È¬ound.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_NOTVIEW
);

119 
	`¡c
("{PLookšg‡round you s“:{x\n", 
ch
);

120 
	`sÿn_li¡
(
ch
->
š_room
, ch, 0, -1);

122 
doÜ
 = 0; door < 6; door++) {

123 ià((
pEx™
 = 
ch
->
š_room
->
ex™
[
doÜ
]è=ğ
nuÎ±r


124 || (
pEx™
->
to_room
è=ğ
nuÎ±r


125 || !
	`ÿn_£e_room
(
ch
, 
pEx™
->
to_room
)

126 || !
	`ÿn_£e_š_room
(
ch
, 
pEx™
->
to_room
))

129 ià(
pEx™
->
ex™_æags
.
	`has
(
EX_CLOSED
)) {

130 
	`±c
(
ch
, "{YTh”i ¨şo£dƒx™Øth%s.{x\n", 
Ex™
::
	`dœ_Çme
(
doÜ
));

134 
	`sÿn_li¡
(
pEx™
->
to_room
, 
ch
, 1, 
doÜ
);

139 ià(
¬g1
.
	`is_´efix_of
("nÜth")è
doÜ
 = 0;

140 ià(
¬g1
.
	`is_´efix_of
("—¡")è
doÜ
 = 1;

141 ià(
¬g1
.
	`is_´efix_of
("south")è
doÜ
 = 2;

142 ià(
¬g1
.
	`is_´efix_of
("we¡")è
doÜ
 = 3;

143 ià(
¬g1
.
	`is_´efix_of
("up")è
doÜ
 = 4;

144 ià(
¬g1
.
	`is_´efix_of
("down")è
doÜ
 = 5;

146 
	`¡c
("Which way dØyou wªˆtØsÿn?\n", 
ch
);

150 
	`aù
("{PYou…“¸š‹Ály $T.{x", 
ch
, 
nuÎ±r
, 
Ex™
::
	`dœ_Çme
(
doÜ
), 
TO_CHAR
);

151 
	`aù
("$À³” š‹Ály $T.", 
ch
, 
nuÎ±r
, 
Ex™
::
	`dœ_Çme
(
doÜ
), 
TO_NOTVIEW
);

152 
FÜm©
::
	`¥rštf
(
buf
, "{GLookšg % you s“:{x\n", 
Ex™
::
	`dœ_Çme
(
doÜ
));

153 
sÿn_room
 = 
ch
->
š_room
;

155 
d•th
 = 1; depth < 4; depth++) {

156 ià((
pEx™
 = 
sÿn_room
->
ex™
[
doÜ
]è=ğ
nuÎ±r


157 || (
pEx™
->
to_room
è=ğ
nuÎ±r


158 || !
	`ÿn_£e_room
(
ch
, 
pEx™
->
to_room
))

161 ià(!
	`ÿn_£e_š_room
(
ch
, 
pEx™
->
to_room
)) {

162 
	`¡c
("Iˆi toØd¬kØ£ªy f¬th” iÀth© dœeùiÚ.\n", 
ch
);

166 ià(
pEx™
->
ex™_æags
.
	`has
(
EX_CLOSED
)) {

167 
	`±c
(
ch
, "{YTh”i ¨şo£dƒx™Øth%s.{x\n", 
Ex™
::
	`dœ_Çme
(
doÜ
));

171 
sÿn_room
 = 
pEx™
->
to_room
;

172 
	`sÿn_li¡
(
pEx™
->
to_room
, 
ch
, 
d•th
, 
doÜ
);

174 
	}
}

176 
	$sÿn_room
(
Room
 *
room
, 
Ch¬aù”
 *
ch
, 
d•th
, 
doÜ
, 
Ex™
 *
³x™
)

178 
	`±c
(
ch
, "{C(%5s){x ",

179 
doÜ
 =ğ-1 ? "h”e" : 
Ex™
::
	`dœ_Çme
(door)

182 ià(
³x™
 &&…ex™->
ex™_æags
.
	`has
(
EX_CLOSED
))

183 
	`¡c
("{Y(şo£d){x\n", 
ch
);

184 ià(!
	`ÿn_£e_š_room
(
ch
, 
room
))

185 
	`¡c
("{c[toØd¬kØ‹Î]{x\n", 
ch
);

187 
	`±c
(
ch
, "%s {B(%s){x\n",

188 
room
->
	`Çme
(),

189 
	`£ùÜ_lookup
(
room
->
	`£ùÜ_ty³
())

192 
	`sÿn_li¡
(
room
, 
ch
, 
d•th
, 
doÜ
);

194 
	}
}

196 
	$sÿn_li¡
(
Room
 *
sÿn_room
, 
Ch¬aù”
 *
ch
, 
d•th
, 
doÜ
)

198 
Ch¬aù”
 *
rch
;

200 ià(
sÿn_room
 =ğ
nuÎ±r
)

203 
rch
 = 
sÿn_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
) {

204 ià(
rch
 =ğ
ch
)

207 ià(
	`ÿn_£e_ch¬
(
ch
, 
rch
)) {

208 
	`sÿn_ch¬
(
rch
, 
ch
, 
d•th
, 
doÜ
);

211 
	}
}

213 
	$sÿn_ch¬
(
Ch¬aù”
 *
viùim
, Ch¬aù” *
ch
, 
d•th
, 
doÜ
)

215 *cÚ¡ 
di¡ªû
[];

216 ià(
viùim
->
	`is_Åc
())

217 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_MOBILES
);

219 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_MISC_PLAYERS
);

221 
	`±c
(
ch
, " %s, %s%s.\n", 
	`PERS
(
viùim
, ch, 
VIS_CHAR
), 
di¡ªû
[
d•th
], d•th ? 
Ex™
::
	`dœ_Çme
(
doÜ
) : "");

222 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

223 
	}
}

	@src/set-stat.cc

28 
	~<veùÜ
>

30 
	~"¬gum’t.hh
"

31 
	~"afãù/Afãù.hh
"

32 
	~"A»a.hh
"

33 
	~"Ch¬aù”.hh
"

34 
	~"CÏn.hh
"

35 
	~"deş¬e.hh
"

36 
	~"Ex™.hh
"

37 
	~"ExŒaDesü.hh
"

38 
	~"fšd.hh
"

39 
	~"FÏgs.hh
"

40 
	~"FÜm©.hh
"

41 
	~"Game.hh
"

42 
	~"lookup.hh
"

43 
	~"Loggšg.hh
"

44 
	~"magic.hh
"

45 
	~"memÜy.hh
"

46 
	~"m”c.hh
"

47 
	~"MobePrÙÙy³.hh
"

48 
	~"Objeù.hh
"

49 
	~"ObjeùPrÙÙy³.hh
"

50 
	~"ObjeùV®ue.hh
"

51 
	~"PÏy”.hh
"

52 
	~"Room.hh
"

53 
	~"SŒšg.hh
"

54 
	~"bËs.hh
"

55 
	~"ty³Çme.hh
"

56 
	~"gem/gem.hh
"

57 
	~"WÜld.hh
"

60 
DECLARE_DO_FUN
Ğ
do_m£t
 );

61 
DECLARE_DO_FUN
Ğ
do_r£t
 );

62 
DECLARE_DO_FUN
Ğ
do_o£t
 );

63 
DECLARE_DO_FUN
Ğ
do_s£t
 );

64 
DECLARE_DO_FUN
Ğ
do_evo£t
 );

65 
DECLARE_DO_FUN
Ğ
do_¿ff£t
 );

66 
DECLARE_DO_FUN
Ğ
do_exŒa£t
 );

68 
	$do_£t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

70 
SŒšg
 
¬g
;

71 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

73 ià(
¬g
.
	`em±y
()) {

74 
	`¡c
("SyÁax:\n", 
ch
);

75 
	`¡c
(" s‘ mob <Çme> <f›ld> <v®ue>\n", 
ch
);

76 
	`¡c
(" s‘ obj <Çme> <f›ld> <v®ue>\n", 
ch
);

77 
	`¡c
(" s‘„oom <room> <f›ld> <v®ue>\n", 
ch
);

79 ià(
	`IS_HEAD
(
ch
)) {

80 
	`¡c
(" s‘…Ì <Çme> <f›ld> <v®ue>\n", 
ch
);

81 
	`¡c
(" s‘ skÈ<Çme> <¥–ÈÜ skl> <v®ue>\n", 
ch
);

82 
	`¡c
(" s‘ƒvŞ <Çme> <¥–ÈÜ skl> <v®ue>\n", 
ch
);

83 
	`¡c
(" s‘„afà <Çme> <»mÜˆafãù>\n", 
ch
);

84 
	`¡c
(" s‘ƒxŒ¨<Çme> <skl>\n", 
ch
);

90 ià(
¬g
.
	`is_´efix_of
("mobile") ||‡rg.is_prefix_of("character")) {

91 
	`do_m£t
(
ch
, 
¬gum’t
);

95 ià(
¬g
.
	`is_´efix_of
("room")) {

96 
	`do_r£t
(
ch
, 
¬gum’t
);

100 ià(
¬g
.
	`is_´efix_of
("object")) {

101 
	`do_o£t
(
ch
, 
¬gum’t
);

106 ià(!
	`IS_HEAD
(
ch
)) {

107 
	`do_£t
(
ch
, "");

111 ià(
¬g
.
	`is_´efix_of
("plr") ||‡rg.is_prefix_of("player")) {

112 
	`do_m£t
(
ch
, 
¬gum’t
);

116 ià(
¬g
.
	`is_´efix_of
("skill") ||‡rg.is_prefix_of("spell")) {

117 
	`do_s£t
(
ch
, 
¬gum’t
);

121 ià(
¬g
.
	`is_´efix_of
("evolve") ||‡rg.is_prefix_of("evolution")) {

122 
	`do_evo£t
(
ch
, 
¬gum’t
);

126 ià(
¬g
.
	`is_´efix_of
("raffect")) {

127 
	`do_¿ff£t
(
ch
, 
¬gum’t
);

131 ià(
¬g
.
	`is_´efix_of
("extraclass")) {

132 
	`do_exŒa£t
(
ch
, 
¬gum’t
);

136 
	`do_£t
(
ch
, "");

137 
	}
}

139 
	$do_s£t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

141 
buf
[1024];

142 
Ch¬aù”
 *
viùim
;

143 
v®ue
;

144 
skl
::
ty³
 
¢
;

145 
boŞ
 
fAÎ
;

147 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
;

148 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

149 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

150 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g3
);

152 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.em±y(è|| 
¬g3
.empty()) {

153 
	`¡c
("SyÁax:\n", 
ch
);

154 
	`¡c
(" s‘ skÈ<¶ay”> <¥–ÈÜ skl> <v®ue>\n", 
ch
);

155 
	`¡c
(" s‘ skÈ<¶ay”>‡Î <v®ue>\n", 
ch
);

156 
	`¡c
(" (u£hÇmoàthskl,‚Ùhnumb”)\n", 
ch
);

160 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g1
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

161 
FÜm©
::
	`¥rštf
(
buf
, "After searching‡ll overhe mud,…layer %s could‚ot be found.\n",

162 
¬g1
);

163 
	`¡c
(
buf
, 
ch
);

167 ià(
viùim
->
	`is_Åc
()) {

168 
	`¡c
("I'm sÜry, you cªnÙ s‘‡ mobe' skls.\n", 
ch
);

172 
fAÎ
 = 
¬g2
 == "all";

174 ià(!
fAÎ
 && (
¢
 = 
skl
::
	`lookup
(
¬g2
)è=ğskl::
ty³
::
unknown
) {

175 
FÜm©
::
	`¥rštf
(
buf
, "% i nÙ‡ v®id skÈÜ s³Î.\n", 
¬g2
);

176 
	`¡c
(
buf
, 
ch
);

183 ià(!
¬g3
.
	`is_numb”
()) {

184 
FÜm©
::
	`¥rštf
(
buf
, "Ththœd‡rgum’ˆgiv’, '%s', i nÙ‚um”ic.\n", 
¬g3
);

185 
	`¡c
(
buf
, 
ch
);

189 
v®ue
 = 
	`©oi
(
¬g3
);

191 ià(
v®ue
 < 0 || value > 100) {

192 
FÜm©
::
	`¥rštf
(
buf
, "YouƒÁ”ed %s,hv®id„ªgi b‘w“À0‡nd 100.\n", 
¬g3
);

193 
	`¡c
(
buf
, 
ch
);

197 ià(
fAÎ
) {

198 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

199 ià(
·œ
.
fœ¡
 =ğ
skl
::
ty³
::
unknown
)

202 
	`£t_Ë¬Ãd
(
viùim
, 
·œ
.
fœ¡
, 
v®ue
);

205 
FÜm©
::
	`¥rštf
(
buf
, "AÎ oà%s' skl ªd s³Î £ˆtØ%d.\n", 
viùim
->
Çme
, 
v®ue
);

208 
	`£t_Ë¬Ãd
(
viùim
, 
¢
, 
v®ue
);

209 
FÜm©
::
	`¥rštf
(
buf
, "%s's %s %s seto %d.\n",

210 
viùim
->
Çme
,

211 
skl
::
	`lookup
(
¢
).
Çme
,

212 
skl
::
	`lookup
(
¢
).
¥–l_fun
 !ğ
¥–l_nuÎ
 ? "Spell" : "Skill",

213 
v®ue
);

216 
	`¡c
(
buf
, 
ch
);

217 
	}
}

219 
	$do_evo£t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

221 
buf
[
MAX_STRING_LENGTH
];

222 
Ch¬aù”
 *
viùim
;

223 
v®ue
;

225 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
;

226 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

227 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

228 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g3
);

230 ià(
¬g1
.
	`em±y
(è|| (!
¬g2
.em±y(è&& 
¬g3
.empty())) {

231 
	`¡c
("SyÁax:\n", 
ch
);

232 
	`¡c
(" s‘ƒvŞv<¶ay”> (li¡ ®ÈevŞved oÀ¨¶ay”)\n", 
ch
);

233 
	`¡c
(" s‘ƒvŞv<¶ay”> <¥–ÈÜ skl> <v®ue>\n", 
ch
);

234 
	`¡c
(" (u£hÇmoàthskl,‚Ùhnumb”)\n", 
ch
);

238 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g1
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

239 
	`±c
(
ch
, "Aá” s—rchšg‡Î ov”hmud,…Ïy” % could‚Ù bfound.\n", 
¬g1
);

243 ià(
viùim
->
	`is_Åc
()) {

244 
	`¡c
("I'm sÜry, you cªnÙ s‘‡ mobe' skÈevŞutiÚ.\n", 
ch
);

248 ià(
viùim
->
gud
 =ğ
Gud
::
nÚe
) {

249 
	`¡c
("A…Ïy” mu¡ još‡ gud befÜevŞvšg skls.\n", 
ch
);

253 ià(
¬g2
.
	`em±y
()) {

254 
ÿn_evŞve
 
	`¬gs
((
Ch¬aù”
 * 
ch
, 
skl
::
ty³
 
¢
));

255 
SŒšg
 
bufãr
;

256 
ÿn
;

257 
bufãr
 += "They havehe following skills‡nd spellsƒvolved:\n\n";

259 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

260 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

261 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

263 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

266 ià((
ÿn
 = 
	`ÿn_evŞve
(
viùim
, 
ty³
)) == -1)

269 
FÜm©
::
	`¥rštf
(
buf
, "They have %s‡t %d%%,ƒvolution %d.\n",

270 
’Œy
.
Çme
,

271 
	`g‘_Ë¬Ãd
(
viùim
, 
ty³
),

272 
	`g‘_evŞutiÚ
(
viùim
, 
ty³
));

273 
bufãr
 +ğ
buf
;

275 ià(
ÿn
 == 1)

276 
FÜm©
::
	`¥rštf
(
buf
, "They‚eed %d skill…ointsoƒvolve %so %d.\n",

277 
	`g‘_evŞutiÚ
(
viùim
, 
ty³
) == 1 ?

278 
’Œy
.
evoco¡_£c
[
viùim
->
gud
] :

279 
’Œy
.
evoco¡_´i
[
viùim
->
gud
],

280 
’Œy
.
Çme
,

281 
	`g‘_evŞutiÚ
(
viùim
, 
ty³
) + 1);

283 
bufãr
 +ğ
buf
;

284 
bufãr
 += "\n";

287 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

291 
skl
::
ty³
y³ = skl::
	`lookup
(
¬g2
);

293 ià(
ty³
 =ğ
skl
::ty³::
unknown
) {

294 
	`±c
(
ch
, "% i nÙ‡ v®id skÈÜ s³Î.\n", 
¬g2
);

298 ià(!
¬g3
.
	`is_numb”
()) {

299 
	`±c
(
ch
, "Ththœd‡rgum’ˆgiv’, '%s', i nÙ‚um”ic.\n", 
¬g3
);

303 cÚ¡‡uto& 
’Œy
 = 
skl
::
	`lookup
(
ty³
);

305 ià(
’Œy
.
evoco¡_£c
[
viùim
->
gud
] <ğ0 && !
	`IS_IMMORTAL
(victim)) {

306 
	`±c
(
ch
, "%ss cannotƒvolve %s.\n",

307 
gud_bË
[
viùim
->
gud
].
Çme
.
	`ÿp™®ize
(), 
’Œy
.name);

311 
v®ue
 = 
	`©oi
(
¬g3
);

313 ià(
v®ue
 < 1 || value > 4) {

314 
	`±c
(
ch
, "YouƒÁ”ed %s,hv®id„ªgi b‘w“À1‡nd 4.\n", 
¬g3
);

318 ià(
’Œy
.
evoco¡_´i
[
viùim
->
gud
] <ğ0 && 
v®ue
 > 2 && !
	`IS_IMMORTAL
(victim)) {

319 
	`¡c
("SecÚd¬y cÏs£ ÿÂÙƒvŞv¨skÈÜ s³Î…a¡ 2.\n", 
ch
);

323 
	`£t_evŞutiÚ
(
viùim
, 
ty³
, 
v®ue
);

324 
	`±c
(
ch
, "%s' % % ha b“À£ˆtØevŞutiÚ %d.\n", 
viùim
->
Çme
, 
’Œy
.name,

325 
’Œy
.
¥–l_fun
 !ğ
¥–l_nuÎ
 ? "¥–l" : "skl", 
v®ue
);

326 
	}
}

328 
	$do_¿ff£t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

330 
	`fix_bÏnk_¿ff
(
Ch¬aù”
 * 
ch
, 
¡¬t
);

331 
	`rŞl_Úe_¿ff
(
Ch¬aù”
 * 
ch
, Ch¬aù” * 
viùim
, 
¶aû
);

332 
	`rŞl_¿fãùs
(
Ch¬aù”
 * 
ch
, Ch¬aù” * 
viùim
);

333 
	`»m_¿ff_afãù
(
Ch¬aù”
 * 
ch
, 
šdex
);

334 
Ch¬aù”
 *
viùim
;

335 
i
, 
šdex
;

337 
SŒšg
 
¬g1
, 
¬g2
;

338 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

339 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

341 ià(
¬g1
.
	`em±y
()) {

342 
	`¡c
("SyÁax:\n", 
ch
);

343 
	`¡c
(" s‘„afãù (di¥Ïy syÁax)\n", 
ch
);

344 
	`¡c
(" s‘„afãù†i¡ (di¥Ïy ¨li¡ oà»mÜˆafãùs)\n", 
ch
);

345 
	`¡c
(" s‘„afãù <¶ay”> (di¥Ïy li¡ oà£ˆ»mÜˆafãùs)\n", 
ch
);

346 
	`¡c
(" s‘„afãù <¶ay”>‚Ú (ş—r ®È»mÜˆafãùs)\n", 
ch
);

347 
	`¡c
(" s‘„afãù <¶ay”>„ŞlÚ (rŞl Ú¿ndom„emÜˆafãù)\n", 
ch
);

348 
	`¡c
(" s‘„afãù <¶ay”>„”ŞÈ (»rŞl ®È»mÜˆafãùs)\n", 
ch
);

349 
	`¡c
(" s‘„afãù <¶ay”> <»mÜˆafãù‚umb”>\n", 
ch
);

350 
	`¡c
(" (toggË »mÜˆafãù oÀÜ off, u£h¿fãù‚umb”)\n", 
ch
);

354 ià(
¬g1
 == "list") {

355 
i
 = 1; i < 
MAX_RAFFECTS
; i++)

356 
	`±c
(
ch
, "{W[{C%3d{W] %10s {x%s\n",

357 
¿fãùs
[
i
].
id
,„afãùs[i].
shÜŠame
,„afãùs[i].
desütiÚ
);

362 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g1
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

363 
	`¡c
("They‡»‚Ù h”e.\n", 
ch
);

367 ià(
viùim
->
	`is_Åc
()) {

368 
	`¡c
("Mobe dØnÙ hav»mÜˆafãùs.\n", 
ch
);

372 ià(
	`IS_IMMORTAL
(
viùim
)) {

373 
	`¡c
("ImmÜl dØnÙ‚“d„emÜˆafãùs.\n", 
ch
);

377 ià(!
	`IS_REMORT
(
viùim
)) {

378 
	`¡c
("OÆy„emÜt ÿÀhav»mÜˆafãùs.\n", 
ch
);

383 
	`fix_bÏnk_¿ff
(
viùim
, 0);

385 ià(
¬g2
.
	`em±y
()) {

386 ià(
viùim
->
pcd©a
->
¿fãù
[0] == 0) {

387 
	`¡c
("Th©…Ïy” dÛ nÙ havªy„emÜˆafãùs.\n", 
ch
);

391 
	`¡c
("They havb“ÀbËs£d(?èw™hhfŞlowšg„emÜˆafãùs:\n\n", 
ch
);

393 
i
 = 0; i < ((
viùim
->
pcd©a
->
»mÜt_couÁ
 / 10) + 1); i++) {

394 
ršdex
;

395 
ršdex
 = 
	`¿ff_lookup
(
viùim
->
pcd©a
->
¿fãù
[
i
]);

397 ià(!
ršdex
)

398 
	`¡c
("{W[{C000{W] {xNÚe\n", 
ch
);

400 
	`±c
(
ch
, "{W[{C%3d{W] {x%s\n", 
¿fãùs
[
ršdex
].
id
,„afãùs[ršdex].
desütiÚ
);

406 ià(
¬g2
 == "none" ||‡rg2 == "reroll") {

408 
i
 = 0; i < 10; i++) {

409 
	`»m_¿ff_afãù
(
viùim
, 
	`¿ff_lookup
(viùim->
pcd©a
->
¿fãù
[
i
]));

410 
viùim
->
pcd©a
->
¿fãù
[
i
] = 0;

413 ià(
¬g2
 == "none") {

414 
	`¡c
("Th¶ay”' »mÜˆafãù havb“Àş—»d.\n", 
ch
);

418 
	`¡c
("You„”ŞÈtheœ„emÜˆafãùs...\n", 
ch
);

419 
	`¡c
("AÀimmÜÈ»rŞl you¸»mÜˆafãùs...\n", 
viùim
);

420 
	`rŞl_¿fãùs
(
ch
, 
viùim
);

424 ià(
¬g2
 == "rollone") {

426 
i
 = 0; i < ((
viùim
->
pcd©a
->
»mÜt_couÁ
 / 10) + 1); i++) {

427 ià(
viùim
->
pcd©a
->
¿fãù
[
i
] < 1) {

428 
	`¡c
("You‡dd‡„ªdom„emÜˆafãù...\n", 
ch
);

429 
	`¡c
("AÀimmÜÈadd ¨¿ndom„emÜˆafãùØyou...\n", 
viùim
);

430 
	`rŞl_Úe_¿ff
(
ch
, 
viùim
, 
i
);

435 
	`¡c
("Th©…Ïy” ha thmaximum‚umb” oà»mÜˆafãùs.\n", 
ch
);

439 ià(!
¬g2
.
	`is_numb”
()) {

440 
	`¡c
("PËa£ u£hnumb” id fÜ„emÜˆafãùs. Ty³ '£ˆ¿fãù†i¡' fÜ‡†i¡.\n", 
ch
);

444 
šdex
 = 
	`¿ff_lookup
(
	`©oi
(
¬g2
));

447 ià(
	`HAS_RAFF
(
viùim
, 
	`©oi
(
¬g2
))) {

448 
i
 = 0; i < ((
viùim
->
pcd©a
->
»mÜt_couÁ
 / 10) + 1); i++) {

449 ià(
viùim
->
pcd©a
->
¿fãù
[
i
] =ğ
	`©oi
(
¬g2
)) {

450 
	`»m_¿ff_afãù
(
viùim
, 
šdex
);

451 
viùim
->
pcd©a
->
¿fãù
[
i
] = 0;

452 
	`fix_bÏnk_¿ff
(
viùim
, 
i
);

453 
	`¡c
("RemÜˆafãù„emoved.\n", 
ch
);

458 
	`¡c
("Couldn'ˆfšdh©„emÜˆafãù oÀth¶ay”.\n", 
ch
);

459 
Loggšg
::
	`bug
("Couldn't find„affect on…layer.", 0);

464 ià(!
šdex
) {

465 
	`¡c
("Th© i nÙ‡ v®id„emÜˆafãù. Ty³ '£ˆ¿fãù†i¡' fÜ‡†i¡.\n", 
ch
);

470 
i
 = 0; i < ((
viùim
->
pcd©a
->
»mÜt_couÁ
 / 10) + 1); i++) {

471 ià(
viùim
->
pcd©a
->
¿fãù
[
i
] < 1) {

472 ià(
¿fãùs
[
šdex
].
group
 > 0) {

473 ià(
	`HAS_RAFF_GROUP
(
viùim
, 
¿fãùs
[
šdex
].
group
)) {

474 
	`¡c
("They‡Ì—dy havthİpos™oàth©„emÜˆafãù.\n", 
ch
);

479 
viùim
->
pcd©a
->
¿fãù
[
i
] = 
	`©oi
(
¬g2
);

480 
	`¡c
("RemÜˆafãù‡dded.\n", 
ch
);

486 
	`¡c
("Th©…Ïy” ha thmaximum‡mouÁ oà»mÜˆafãùs.\n", 
ch
);

488 
	}
}

490 
	$do_exŒa£t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

492 
	`fix_bÏnk_exŒaşass
(
Ch¬aù”
 * 
ch
, 
šdex
);

493 
buf
[
MAX_STRING_LENGTH
];

494 
SŒšg
 
ouut
;

495 
Ch¬aù”
 *
viùim
;

496 
skl
::
ty³
 
¢
;

497 
x
, 
i
, 
ú
, 
cŞ
 = 0;

499 
SŒšg
 
¬g1
, 
¬g2
;

500 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

501 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

503 ià(
¬g1
.
	`em±y
()) {

504 
	`¡c
("SyÁax:\n", 
ch
);

505 
	`¡c
(" s‘ƒxŒaşas  (di¥Ïy syÁax)\n", 
ch
);

506 
	`¡c
(" s‘ƒxŒaşas li¡ (di¥Ïy ¨li¡ oàexŒaşas skls)\n", 
ch
);

507 
	`¡c
(" s‘ƒxŒaşas <¶ay”> (di¥Ïy li¡ oà£ˆexŒaşas skls)\n", 
ch
);

508 
	`¡c
(" s‘ƒxŒaşas <¶ay”>‚Ú (ş—r ®ÈexŒaşas skls)\n", 
ch
);

509 
	`¡c
(" s‘ƒxŒaşas <¶ay”> <skl>\n", 
ch
);

510 
	`¡c
(" (toggË ÚexŒaşas skÈa gašed o¸nÙ)\n", 
ch
);

515 ià(
¬g1
 == "list") {

516 
ouut
 += "\n {BExtraclass Remort Skills{x\n";

518 
ú
 = 
Gud
::
fœ¡
; cÀ< Gud::
size
; cn++) {

519 
FÜm©
::
	`¥rštf
(
buf
, "\n{W% Skls{x\À ", 
gud_bË
[
ú
].
Çme
.
	`ÿp™®ize
());

520 
ouut
 +ğ
buf
;

521 
cŞ
 = 0;

523 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

524 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

525 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

527 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

530 ià(
’Œy
.
»mÜt_gud
 !ğ
Gud
::
nÚe


531 && 
’Œy
.
»mÜt_gud
 =ğ
ú
) {

532 
FÜm©
::
	`¥rštf
(
buf
, "%-15 %-8d", 
’Œy
.
Çme
,ƒÁry.
¿tšg
[
ch
->
gud
]);

533 
ouut
 +ğ
buf
;

537 
ouut
 += "\n";

540 ià(
cŞ
 % 3 != 0)

541 
ouut
 += "\n\n";

543 
	`·ge_to_ch¬
(
ouut
, 
ch
);

547 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g1
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

548 
	`¡c
("They‡»‚Ù h”e.\n", 
ch
);

552 ià(
viùim
->
	`is_Åc
()) {

553 
	`¡c
("Mobe dØnÙ havexŒaşas skls.\n", 
ch
);

557 ià(
viùim
->
gud
 =ğ
Gud
::
nÚe
) {

558 
	`¡c
("OÆy…Ïy” w™h gud ÿÀhavexŒaşas skls.\n", 
ch
);

562 ià(
	`IS_IMMORTAL
(
viùim
)) {

563 
	`¡c
("ImmÜl dØnÙ‚“dƒxŒaşas skls.\n", 
ch
);

567 ià(!
	`IS_REMORT
(
viùim
)) {

568 
	`¡c
("OÆy„emÜt ÿÀhavexŒaşas skls.\n", 
ch
);

575 ià(
¬g2
.
	`em±y
()) {

576 ià(
viùim
->
pcd©a
->
exŒaşass
[0] !ğ
skl
::
ty³
::
unknown


577 || 
viùim
->
pcd©a
->
exŒaşass
[1] !ğ
skl
::
ty³
::
unknown


578 || 
viùim
->
pcd©a
->
exŒaşass
[2] !ğ
skl
::
ty³
::
unknown


579 || 
viùim
->
pcd©a
->
exŒaşass
[3] !ğ
skl
::
ty³
::
unknown


580 || 
viùim
->
pcd©a
->
exŒaşass
[4] !ğ
skl
::
ty³
::
unknown
) {

581 
FÜm©
::
	`¥rštf
(
buf
, "Their currentƒxtraclass skill%s",

582 
viùim
->
pcd©a
->
exŒaşass
[1] !ğ
skl
::
ty³
::
unknown
 ? "s‡re" : " is");

583 
ouut
 +ğ
buf
;

585 ià(
viùim
->
pcd©a
->
exŒaşass
[0] !ğ
skl
::
ty³
::
unknown
) {

586 
FÜm©
::
	`¥rštf
(
buf
, " %s", 
skl
::
	`lookup
(
viùim
->
pcd©a
->
exŒaşass
[0]).
Çme
);

587 
ouut
 +ğ
buf
;

590 
x
 = 1; x < 
viùim
->
pcd©a
->
»mÜt_couÁ
 / 
EXTRACLASS_SLOT_LEVELS
 + 1; x++) {

591 ià(
viùim
->
pcd©a
->
exŒaşass
[
x
] !ğ
skl
::
ty³
::
unknown
) {

592 
FÜm©
::
	`¥rštf
(
buf
, ", %s", 
skl
::
	`lookup
(
viùim
->
pcd©a
->
exŒaşass
[
x
]).
Çme
);

593 
ouut
 +ğ
buf
;

597 
ouut
 += ".\n";

598 
	`·ge_to_ch¬
(
ouut
, 
ch
);

602 
	`¡c
("Th©…Ïy” dÛ nÙ havªyƒxŒaşas skls.\n", 
ch
);

606 ià(
¬g2
 == "none") {

608 
i
 = 0; i < 5; i++)

609 
viùim
->
pcd©a
->
exŒaşass
[
i
] = 
skl
::
ty³
::
unknown
;

611 
	`¡c
("Th¶ay”' exŒaşas skl havb“Àş—»d.\n", 
ch
);

616 ià((
¢
 = 
skl
::
	`lookup
(
¬g2
)è=ğskl::
ty³
::
unknown
) {

617 
	`¡c
("Th© i nÙƒv’‡ v®id skl, much†es ¨»mÜˆskl.\n", 
ch
);

622 ià(
	`HAS_EXTRACLASS
(
viùim
, 
¢
)) {

623 
x
 = 0; x < 
viùim
->
pcd©a
->
»mÜt_couÁ
 / 
EXTRACLASS_SLOT_LEVELS
 + 1; x++) {

624 ià(
viùim
->
pcd©a
->
exŒaşass
[
x
] =ğ
¢
) {

625 
viùim
->
pcd©a
->
exŒaşass
[
x
] = 
skl
::
ty³
::
unknown
;

626 
	`¡c
("ExŒaşas skÈ»moved.\n", 
ch
);

636 ià(
skl
::
	`lookup
(
¢
).
»mÜt_gud
 =ğ
Gud
::
nÚe
) {

637 
	`¡c
("Th© i nÙ‡„emÜˆskl.\n", 
ch
);

642 ià(
skl
::
	`lookup
(
¢
).
»mÜt_gud
 =ğ
viùim
->
gud
) {

643 
	`¡c
("They cªnÙ havªƒxŒaşas skÈw™hšheœ cÏss. Pick‡nÙh”.\n", 
ch
);

648 ià((
	`g‘_u§bË_Ëv–
(
¢
, 
viùim
->
gud
) < 0)

649 || (
skl
::
	`lookup
(
¢
).
¿tšg
[
viùim
->
gud
] < 0)) {

650 
	`¡c
("Theœ cÏs ÿÂÙ gašh© skl.\n", 
ch
);

655 
x
 = 0; x < 
viùim
->
pcd©a
->
»mÜt_couÁ
 / 
EXTRACLASS_SLOT_LEVELS
 + 1; x++) {

656 ià(
viùim
->
pcd©a
->
exŒaşass
[
x
] =ğ
skl
::
ty³
::
unknown
) {

657 
viùim
->
pcd©a
->
exŒaşass
[
x
] = 
¢
;

659 ià(
	`g‘_Ë¬Ãd
(
viùim
, 
¢
) == 0)

660 
	`£t_Ë¬Ãd
(
viùim
, 
¢
, 1);

662 
	`¡c
("ExŒaşas skÈadded.\n", 
ch
);

663 
	`±c
(
viùim
, "You havb“Àgiv’ % a ªƒxŒaşas »mÜˆskl.\n", 
skl
::
	`lookup
(
¢
).
Çme
);

669 
	`¡c
("They havthmaximum‡mouÁ oàexŒaşas skl fÜheœ„emÜˆËv–.\n", 
ch
);

671 
	}
}

673 
	$do_m£t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

675 
Ch¬aù”
 *
viùim
;

676 
v®ue
;

678 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
, 
buf
;

679 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

680 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

681 
¬g3
 = 
¬gum’t
;

683 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.em±y(è|| 
¬g3
.empty()) {

684 
	`¡c
("SyÁax:\n", 
ch
);

685 
	`¡c
(" s‘ ch¬ <Çme> <f›ld> <v®ue>\n", 
ch
);

686 
	`¡c
(" F›ld bešg oÃ of:\n", 
ch
);

687 
	`¡c
(" str int wis dex con chr sex†evel„ace‚ectimer\n"

689 " damdiû damside damty³\n", 
ch
);

691 ià(
	`IS_HEAD
(
ch
))

692 
	`¡c
(" class…racrainhirst hunger drunk full\n"

695 "…k¿nk\n", 
ch
);

700 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g1
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

701 
	`±c
(
ch
, "Aá” s—rchšg‡Î ov”hmud, % could‚Ù bfound.\n", 
¬g1
);

705 ià(!
viùim
->
	`is_Åc
(è&& !
	`IS_IMP
(
ch
) && victim != ch) {

706 
	`¡c
("You cªnÙ s‘…Ïy” © you¸Ëv–.\n", 
ch
);

711 
v®ue
 = 
¬g3
.
	`is_numb”
(è? 
	`©oi
(arg3) : -1;

715 ià(
¬g2
 == "str") {

716 ià(
v®ue
 < 3 || v®u> 
	`g‘_max_Œaš
(
viùim
, 
STAT_STR
)) {

717 
	`±c
(
ch
, "SŒ’gth„ªgi 3Ø%d.\n", 
	`g‘_max_Œaš
(
viùim
, 
STAT_STR
));

721 
	`ATTR_BASE
(
viùim
, 
APPLY_STR
èğ
v®ue
;

722 
	`±c
(
ch
, "%s' ¡»ngth s‘Ø%d.\n", 
viùim
->
Çme
, 
v®ue
);

726 ià(
¬g2
 == "int") {

727 ià(
v®ue
 < 3 || v®u> 
	`g‘_max_Œaš
(
viùim
, 
STAT_INT
)) {

728 
	`±c
(
ch
, "IÁ–lig’û„ªgi 3Ø%d.\n", 
	`g‘_max_Œaš
(
viùim
, 
STAT_INT
));

732 
	`ATTR_BASE
(
viùim
, 
APPLY_INT
èğ
v®ue
;

733 
	`±c
(
ch
, "%s' š‹Îig’û s‘Ø%d.\n", 
viùim
->
Çme
, 
v®ue
);

737 ià(
¬g2
 == "wis") {

738 ià(
v®ue
 < 3 || v®u> 
	`g‘_max_Œaš
(
viùim
, 
STAT_WIS
)) {

739 
	`±c
(
ch
, "Wisdom„ªgi 3Ø%d.\n", 
	`g‘_max_Œaš
(
viùim
, 
STAT_WIS
));

743 
	`ATTR_BASE
(
viùim
, 
APPLY_WIS
èğ
v®ue
;

744 
	`±c
(
ch
, "%s' wisdom s‘Ø%d.\n", 
viùim
->
Çme
, 
v®ue
);

748 ià(
¬g2
 == "dex") {

749 ià(
v®ue
 < 3 || v®u> 
	`g‘_max_Œaš
(
viùim
, 
STAT_DEX
)) {

750 
	`±c
(
ch
, "Dex‹r™y„ªgi 3Ø%d.\n", 
	`g‘_max_Œaš
(
viùim
, 
STAT_DEX
));

754 
	`ATTR_BASE
(
viùim
, 
APPLY_DEX
èğ
v®ue
;

755 
	`±c
(
ch
, "%s' dex‹r™y s‘Ø%d.\n", 
viùim
->
Çme
, 
v®ue
);

759 ià(
¬g2
 == "con") {

760 ià(
v®ue
 < 3 || v®u> 
	`g‘_max_Œaš
(
viùim
, 
STAT_CON
)) {

761 
	`±c
(
ch
, "CÚ¡™utiÚ„ªgi 3Ø%d.\n", 
	`g‘_max_Œaš
(
viùim
, 
STAT_CON
));

765 
	`ATTR_BASE
(
viùim
, 
APPLY_CON
èğ
v®ue
;

766 
	`±c
(
ch
, "%s' cÚ¡™utiÚ s‘Ø%d.\n", 
viùim
->
Çme
, 
v®ue
);

770 ià(
¬g2
 == "chr") {

771 ià(
v®ue
 < 3 || v®u> 
	`g‘_max_Œaš
(
viùim
, 
STAT_CHR
)) {

772 
	`±c
(
ch
, "Ch¬ism¨¿ngi 3Ø%d.\n", 
	`g‘_max_Œaš
(
viùim
, 
STAT_CHR
));

776 
	`ATTR_BASE
(
viùim
, 
APPLY_CHR
èğ
v®ue
;

777 
	`±c
(
ch
, "%s' ch¬ism¨£ˆtØ%d.\n", 
viùim
->
Çme
, 
v®ue
);

781 ià(
¬g2
.
	`is_´efix_of
("sex")) {

782 
v®ue
) {

783 0: 
FÜm©
::
	`¥rštf
(
buf
, "%s", "an it"); ;

785 1: 
FÜm©
::
	`¥rštf
(
buf
, "%s", "a male"); ;

787 2: 
FÜm©
::
	`¥rštf
(
buf
, "%s", "a female"); ;

790 
	`¡c
("Sex„ªgi 0Ø2.\n", 
ch
);

794 
	`ATTR_BASE
(
viùim
, 
APPLY_SEX
èğ
v®ue
;

795 
	`±c
(
ch
, "% i now %s.\n", 
viùim
->
Çme
, 
buf
);

799 ià(
¬g2
.
	`is_´efix_of
("level")) {

800 ià(!
viùim
->
	`is_Åc
()) {

801 
	`¡c
("You may‚ot set‡…layer's†evel.\n"

802 "U£ ADVANCE in¡—d!\n", 
ch
);

806 ià(
v®ue
 < 1 || value > 1000) {

807 
	`¡c
("A v®id†ev– mu¡ bb‘w“À1‡nd 1000.\n", 
ch
);

811 
viùim
->
Ëv–
 = 
v®ue
;

812 
	`±c
(
ch
, "% i now†ev– %d.\n", 
viùim
->
Çme
, 
v®ue
);

816 ià(
¬g2
.
	`is_´efix_of
("gold")) {

817 
viùim
->
gŞd
 = 
v®ue
;

818 
	`±c
(
ch
, "% now ha %d gŞd.\n", 
viùim
->
Çme
, 
v®ue
);

822 ià(
¬g2
.
	`is_´efix_of
("silver")) {

823 
viùim
->
sv”
 = 
v®ue
;

824 
	`±c
(
ch
, "% now ha %d sv”.\n", 
viùim
->
Çme
, 
v®ue
);

828 ià(
¬g2
.
	`is_´efix_of
("hp")) {

829 ià(
v®ue
 < -10 || value > 30000) {

830 
	`¡c
("A v®id h°v®umu¡ bb‘w“À-10‡nd 30,000 h™…ošts.\n", 
ch
);

834 
	`ATTR_BASE
(
viùim
, 
APPLY_HIT
èğ
v®ue
;

836 
	`±c
(
ch
, "% now ha %d h™…ošts.\n", 
viùim
->
Çme
, 
v®ue
);

840 ià(
¬g2
.
	`is_´efix_of
("mana")) {

841 ià(
v®ue
 < -10 || value > 30000) {

842 
	`¡c
("A v®id mª¨v®umu¡ bb‘w“À-10‡nd 30,000 mª¨pošts.\n", 
ch
);

846 
	`ATTR_BASE
(
viùim
, 
APPLY_MANA
èğ
v®ue
;

848 
	`±c
(
ch
, "% now ha %d mªa.\n", 
viùim
->
Çme
, 
v®ue
);

852 ià(
¬g2
.
	`is_´efix_of
("stamina")) {

853 ià(
v®ue
 < -10 || value > 30000) {

854 
	`¡c
("A v®id smš¨v®umu¡ bb‘w“À-10‡nd 30,000 smš¨pošts.\n", 
ch
);

858 
	`ATTR_BASE
(
viùim
, 
APPLY_STAM
èğ
v®ue
;

860 
	`±c
(
ch
, "% now ha %d smš¨pošts.\n", 
viùim
->
Çme
, 
v®ue
);

864 ià(
¬g2
.
	`is_´efix_of
("align")) {

865 ià(
v®ue
 < -1000 || value > 1000) {

866 
	`¡c
("A v®id‡lignm’ˆmu¡ bb‘w“À-1000‡nd 1000.\n", 
ch
);

870 
viùim
->
®ignm’t
 = 
v®ue
;

871 
	`±c
(
ch
, "%s' ®ignm’ˆi now %d.\n", 
viùim
->
Çme
, 
v®ue
);

875 ià(
¬g2
 == "hunt") {

876 
Ch¬aù”
 *
huÁed
 = 0;

878 ià(!
viùim
->
	`is_Åc
()) {

879 
	`¡c
("You cª'ˆmak¨¶ay” huÁ!\n", 
ch
);

883 ià(
¬g3
 == ".") {

884 
	`±c
(
ch
, "% i now huÁšg‚ØÚe.\n", 
viùim
->
Çme
);

888 ià((
huÁed
 = 
	`g‘_ch¬_¬—
(
viùim
, 
¬g3
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

889 
	`±c
(
ch
, "% could‚Ù fšd %s.\n", 
viùim
->
Çme
, 
¬g3
);

893 
viùim
->
huÁšg
 = 
huÁed
;

894 
	`±c
(
ch
, "% i now huÁšg %s!\n", 
viùim
->
Çme
, 
huÁed
->name);

898 ià(
¬g2
.
	`is_´efix_of
("race")) {

899 
¿û
 = 
	`¿û_lookup
(
¬g3
);

901 ià(
¿û
 =ğ0 || (!
viùim
->
	`is_Åc
(è&& !
¿û_bË
[¿û].
pc_¿û
)) {

902 
	`±c
(
ch
, "% i nÙ‡ v®id % ¿û.\n", 
¬g3
, !
viùim
->
	`is_Åc
() ? "PC" : "NPC");

903 
	`¡c
("V®id„aû ¬:\n\n", 
ch
);

905 cÚ¡‡uto& 
’Œy
 : 
¿û_bË
) {

906 ià((!
viùim
->
	`is_Åc
(è&& !
’Œy
.
pc_¿û
)

907 || (
viùim
->
	`is_Åc
(è&& 
’Œy
.
pc_¿û
))

910 
	`±c
(
ch
, "%-10.10s\n", 
’Œy
.
Çme
);

913 
	`¡c
("\n", 
ch
);

917 
viùim
->
¿û
 =„ace;

918 
	`±c
(
ch
, "% i now‡ memb” oàth% ¿û.\n", 
viùim
->
Çme
, 
¿û_bË
[
¿û
].name);

922 ià(
¬g2
.
	`is_´efix_of
("nectimer")) {

923 ià(!
viùim
->
	`is_Åc
()) {

924 
	`¡c
("You cª'ˆ£ˆ¨¶ay”' Ãüomªû¸tim”!\n", 
ch
);

928 ià(
v®ue
 < -1 || value > 100) {

929 
	`¡c
("A v®id NecTim” v®umu¡ bb‘w“À -1‡nd 100.\n", 
ch
);

933 
viùim
->
Ãùim”
 = 
v®ue
;

934 
	`±c
(
ch
, "%s' Ãüomªû¸tim” i now s‘Ø%d.\n", 
viùim
->
Çme
, 
v®ue
);

938 ià(
¬g2
.
	`is_´efix_of
("damdice")) {

939 ià(!
viùim
->
	`is_Åc
()) {

940 
	`¡c
("You cªnÙ s‘‡…Ïy”' damagdiû.\n", 
ch
);

944 ià(
v®ue
 < 1 || value > 30000) {

945 
	`¡c
("Thv®umu¡ bb‘w“À1‡nd 30000.\n", 
ch
);

949 
viùim
->
damage
[
DICE_NUMBER
] = 
v®ue
;

950 
	`±c
(
ch
, "% now„Şl %d diû fÜ damage.\n", 
viùim
->
shÜt_desü
, 
v®ue
);

954 ià(
¬g2
.
	`is_´efix_of
("damsides")) {

955 ià(!
viùim
->
	`is_Åc
()) {

956 
	`¡c
("You cªnÙ s‘‡…Ïy”' damagdiûy³.\n", 
ch
);

960 ià(
v®ue
 < 1 || value > 30000) {

961 
	`¡c
("Thv®umu¡ bb‘w“À1‡nd 30000.\n", 
ch
);

965 
viùim
->
damage
[
DICE_TYPE
] = 
v®ue
;

966 
	`±c
(
ch
, "% now„Şl %d sided diû fÜ damage.\n", 
viùim
->
shÜt_desü
, 
v®ue
);

970 ià(
¬g2
.
	`is_´efix_of
("damtype")) {

971 
i
;

973 ià(!
viùim
->
	`is_Åc
()) {

974 
	`¡c
("You cªnÙ s‘‡…Ïy”' damagty³.\n", 
ch
);

978 
i
 = 0; i < 
©ck_bË
.
	`size
(); i++)

979 ià(
¬g3
.
	`is_´efix_of
(
©ck_bË
[
i
].
Çme
))

982 ià(
i
 >ğ
©ck_bË
.
	`size
()) {

983 
	`¡c
("That is‚ot‡ valid damageype.\n"

984 "U£ {Vty³li¡‡‰ack{xØ£v®idy³s.\n", 
ch
);

988 
viùim
->
dam_ty³
 = 
i
;

989 
	`±c
(
ch
, "% now h™ w™h %s.\n", 
viùim
->
shÜt_desü
, 
©ck_bË
[
i
].
noun
);

993 ià(
viùim
->
	`is_Åc
()) {

994 
	`¡c
("You cª'ˆ£ˆth© oÀmobes.\n", 
ch
);

995 
	`do_m£t
(
ch
, "");

1003 ià(
¬g2
.
	`is_´efix_of
("class")) {

1004 
Gud
 
gud
 = 
	`gud_lookup
(
¬g3
);

1006 ià(
gud
 =ğ
Gud
::
nÚe
) {

1007 
FÜm©
::
	`¥rštf
(
buf
, "Possible classes‡re: ");

1009 
i
 = 
Gud
::
fœ¡
; i < Gud::
size
; i++) {

1010 ià(
i
 > 
Gud
::
fœ¡
)

1011 
buf
 += " ";

1013 
buf
 +ğ
gud_bË
[
i
].
Çme
;

1016 
buf
 += ".\n";

1017 
	`¡c
(
buf
, 
ch
);

1021 
viùim
->
gud
 = guild;

1022 
	`±c
(
ch
, "% i now‡ %s.\n", 
viùim
->
Çme
, 
gud_bË
[
gud
].name);

1026 ià(
¬g2
.
	`is_´efix_of
("remort_count")) {

1027 ià(
v®ue
 < 0 || value > 99) {

1028 
	`¡c
("A v®id„emÜˆcouÁ mu¡ bb‘w“À0‡nd 99.\n", 
ch
);

1032 
viùim
->
pcd©a
->
»mÜt_couÁ
 = 
v®ue
;

1033 
	`±c
(
ch
, "%s' »mÜˆcouÁ ha b“À£ˆtØ%d.\n", 
viùim
->
Çme
, 
v®ue
);

1037 ià(
¬g2
.
	`is_´efix_of
("hours")) {

1038 ià(
v®ue
 < 0 || value > 10000) {

1039 
	`¡c
("Hour mu¡ bb‘w“À0‡nd 10000.\n", 
ch
);

1043 
viùim
->
pcd©a
->
¶ayed
 = 
v®ue
 * 3600;

1044 
	`±c
(
ch
, "% ha now…Ïyed fÜ %d hours. Shhh, dÚ'ˆ‹Î‡nyÚe!\n", 
viùim
->
Çme
, 
v®ue
);

1048 ià(
¬g2
.
	`is_´efix_of
("experience")) {

1049 
viùim
->
exp
 = 
v®ue
;

1050 
	`±c
(
ch
, "% now ha %dƒx³r›nû…ošts.\n", 
viùim
->
Çme
, 
v®ue
);

1054 ià(
¬g2
.
	`is_´efix_of
("quest")) {

1055 ià(
v®ue
 < 0 || value > 30) {

1056 
	`¡c
("A v®id NexˆQue¡„ªgi 0Ø10.\n", 
ch
);

1060 
viùim
->
pcd©a
->
Ãxtque¡
 = 
v®ue
;

1061 
	`±c
(
ch
, "% ÿÀnow que¡‡gaš iÀ%d mšu‹s.\n", 
viùim
->
Çme
, 
v®ue
);

1065 ià(
¬g2
.
	`is_´efix_of
("squest")) {

1066 ià(
v®ue
 < 0 || value > 30) {

1067 
	`¡c
("A v®id‚exˆskÈque¡„ªgi 0Ø30.\n", 
ch
);

1071 
viùim
->
pcd©a
->
Ãxtsque¡
 = 
v®ue
;

1072 
	`±c
(
ch
, "% ÿÀnow skÈque¡‡gaš iÀ%d mšu‹s.\n", 
viùim
->
Çme
, 
v®ue
);

1076 ià(
¬g2
.
	`is_´efix_of
("qp")) {

1077 ià(
v®ue
 < 0 || value > 5000) {

1078 
	`¡c
("A v®id que¡…ošˆv®umu¡ bb‘w“À0‡nd 5000.\n", 
ch
);

1082 
viùim
->
pcd©a
->
que¡pošts
 = 
v®ue
;

1083 
	`±c
(
ch
, "% now ha %d que¡…ošts.\n", 
viùim
->
Çme
, 
v®ue
);

1087 ià(
¬g2
.
	`is_´efix_of
("sp")) {

1088 ià(
v®ue
 < 0 || value > 5000) {

1089 
	`¡c
("A v®id skÈpošˆv®umu¡ bb‘w“À0‡nd 5000.\n", 
ch
);

1093 
viùim
->
pcd©a
->
skÍošts
 = 
v®ue
;

1094 
	`±c
(
ch
, "% now ha %d skÈpošts.\n", 
viùim
->
Çme
, 
v®ue
);

1098 ià(
¬g2
.
	`is_´efix_of
("rpp")) {

1099 ià(
v®ue
 < 0 || value > 5000) {

1100 
	`¡c
("A v®id„Ş•Ïy…ošˆv®umu¡ bb‘w“À0‡nd 5000.\n", 
ch
);

1104 
viùim
->
pcd©a
->
rŞ•ošts
 = 
v®ue
;

1105 
	`±c
(
ch
, "% now ha %d„Ş•Ïy…ošts.\n", 
viùim
->
Çme
, 
v®ue
);

1109 ià(
¬g2
.
	`is_´efix_of
("practice")) {

1110 ià(
v®ue
 < 0 || value > 15000) {

1111 
	`¡c
("A v®id…¿ùiû v®umu¡ bb‘w“À0‡nd 15000 sessiÚs.\n", 
ch
);

1115 
viùim
->
´aùiû
 = 
v®ue
;

1116 
	`±c
(
ch
, "% now ha %d…¿ùiû sessiÚs.\n", 
viùim
->
Çme
, 
v®ue
);

1120 ià(
¬g2
.
	`is_´efix_of
("train")) {

1121 ià(
v®ue
 < 0 || value > 15000) {

1122 
	`¡c
("A v®id¿š v®umu¡ bb‘w“À0‡nd 15000 sessiÚs.\n", 
ch
);

1126 
viùim
->
Œaš
 = 
v®ue
;

1127 
	`±c
(
ch
, "% now ha %d¿ššg sessiÚs.\n", 
viùim
->
Çme
, 
v®ue
);

1131 ià(
¬g2
.
	`is_´efix_of
("thirst")) {

1132 ià(
v®ue
 < -1 || value > 100) {

1133 
	`¡c
("A v®idhœ¡ v®umu¡ bb‘w“À-1‡nd 100.\n", 
ch
);

1137 
viùim
->
pcd©a
->
cÚd™iÚ
[
COND_THIRST
] = 
v®ue
;

1138 
	`±c
(
ch
, "% now ha ¨thœ¡ oà%d.\n", 
viùim
->
Çme
, 
v®ue
);

1142 ià(
¬g2
.
	`is_´efix_of
("drunk")) {

1143 ià(
v®ue
 < -1 || value > 100) {

1144 
	`¡c
("A v®id drunk v®umu¡ bb‘w“À-1‡nd 100.\n", 
ch
);

1148 
viùim
->
pcd©a
->
cÚd™iÚ
[
COND_DRUNK
] = 
v®ue
;

1149 
	`±c
(
ch
, "% now ha ¨drunk v®uoà%d.\n", 
viùim
->
Çme
, 
v®ue
);

1151 ià(
v®ue
 > 70)

1152 
	`±c
(
ch
, "% i {PW{YA{GS{BT{CE{VD!{x\n", 
viùim
->
Çme
);

1157 ià(
¬g2
.
	`is_´efix_of
("full")) {

1158 ià(
v®ue
 < -1 || value > 100) {

1159 
	`¡c
("A v®id fuÎ v®umu¡ bb‘w“À-1‡nd 100.\n", 
ch
);

1163 
viùim
->
pcd©a
->
cÚd™iÚ
[
COND_FULL
] = 
v®ue
;

1164 
	`±c
(
ch
, "% now ha ¨fuÎ v®uoà%d.\n", 
viùim
->
Çme
, 
v®ue
);

1168 ià(
¬g2
.
	`is_´efix_of
("hunger")) {

1169 ià(
v®ue
 < -1 || value > 100) {

1170 
	`¡c
("A v®id hung” v®umu¡ bb‘w“À-1‡nd 100.\n", 
ch
);

1174 
viùim
->
pcd©a
->
cÚd™iÚ
[
COND_HUNGER
] = 
v®ue
;

1175 
	`±c
(
ch
, "% now ha ¨hung” v®uoà%d.\n", 
viùim
->
Çme
, 
v®ue
);

1179 ià(
¬g2
.
	`is_´efix_of
("pckills")) {

1180 ià(
v®ue
 < 0 || value > 1000) {

1181 
	`¡c
("A v®id…Ïy” kl v®umu¡ bb‘w“À0‡nd 1000.\n", 
ch
);

1185 
viùim
->
pcd©a
->
pckls
 = 
v®ue
;

1186 
	`±c
(
ch
, "% ha now kËd %d…Ïy”s.\n", 
viùim
->
Çme
, 
v®ue
);

1190 ià(
¬g2
.
	`is_´efix_of
("pckilled")) {

1191 ià(
v®ue
 < 0 || value > 1000) {

1192 
	`¡c
("A v®id PCKËd v®umu¡ bb‘w“À0‡nd 1000.\n", 
ch
);

1196 
viùim
->
pcd©a
->
pckËd
 = 
v®ue
;

1197 
	`±c
(
ch
, "%s' ha now b“ÀkËd by %d…Ïy”s.\n", 
viùim
->
Çme
, 
v®ue
);

1201 ià(
¬g2
.
	`is_´efix_of
("akills")) {

1202 ià(
v®ue
 < 0 || value > 1000) {

1203 
	`¡c
("A v®id‡»Ç kl v®umu¡ bb‘w“À0‡nd 1000.\n", 
ch
);

1207 
viùim
->
pcd©a
->
¬’akls
 = 
v®ue
;

1208 
	`±c
(
ch
, "% ha now kËd %d…Ïy” šh¬’a.\n", 
viùim
->
Çme
, 
v®ue
);

1212 ià(
¬g2
.
	`is_´efix_of
("akilled")) {

1213 ià(
v®ue
 < 0 || value > 1000) {

1214 
	`¡c
("A v®id‡»Ç kËd v®umu¡ bb‘w“À0‡nd 1000.\n", 
ch
);

1218 
viùim
->
pcd©a
->
¬’akËd
 = 
v®ue
;

1219 
	`±c
(
ch
, "%s' ha now b“ÀkËd by %d…Ïy” šh¬’a.\n", 
viùim
->
Çme
, 
v®ue
);

1223 ià(
¬g2
.
	`is_´efix_of
("pkrank")) {

1224 ià(
v®ue
 < 0 || value > 5) {

1225 
	`¡c
("PK Rªk mu¡ bb‘w“À0‡nd 5.\n", 
ch
);

1229 
viùim
->
pcd©a
->
pk¿nk
 = 
v®ue
;

1230 
	`±c
(
ch
, "% now ha ¨PK„ªk oà%d.\n", 
viùim
->
Çme
, 
v®ue
);

1234 ià(
¬g2
.
	`is_´efix_of
("thief")) {

1235 ià(
v®ue
 < 0 || v®u> 
MAX_THIEF
) {

1236 
	`±c
(
ch
, "A v®id {BTHIEF{ximi b‘w“À0‡nd %dicks.\n", 
MAX_THIEF
);

1240 
viùim
->
pcd©a
->
æag_th›f
 = 
v®ue
;

1241 
viùim
->
aù_æags
 +ğ
PLR_NOPK
;

1243 ià(
v®ue
) {

1244 
viùim
->
aù_æags
 +ğ
PLR_THIEF
;

1245 
	`±c
(
ch
, "% wÈhav¨{BTHIEF{x fÏg fÜ %dicks.\n", 
viùim
->
Çme
, 
v®ue
);

1248 
viùim
->
aù_æags
 -ğ
PLR_THIEF
;

1249 
	`±c
(
ch
, "% i nØlÚg”‡ {BTHIEF{x.\n", 
viùim
->
Çme
);

1255 ià(
¬g2
.
	`is_´efix_of
("killer")) {

1256 ià(
v®ue
 < 0 || v®u> 
MAX_KILLER
) {

1257 
	`±c
(
ch
, "A v®id {RKILLER{ximi b‘w“À0‡nd %dicks.\n", 
MAX_KILLER
);

1261 
viùim
->
pcd©a
->
æag_kËr
 = 
v®ue
;

1262 
viùim
->
aù_æags
 +ğ
PLR_NOPK
;

1264 ià(
v®ue
) {

1265 
viùim
->
aù_æags
 +ğ
PLR_KILLER
;

1266 
	`±c
(
ch
, "% wÈhav¨{RKILLER{x fÏg fÜ %dicks.\n", 
viùim
->
Çme
, 
v®ue
);

1269 
viùim
->
aù_æags
 -ğ
PLR_KILLER
;

1270 
	`±c
(
ch
, "% i nØlÚg”‡ {RKILLER{x.\n", 
viùim
->
Çme
);

1277 
	`do_m£t
(
ch
, "");

1278 
	}
}

1280 
	$do_o£t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1282 
buf
[1024];

1283 
Objeù
 *
obj
;

1284 
v®ue
;

1286 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
;

1287 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

1288 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

1289 
¬g3
 = 
¬gum’t
;

1291 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.em±y(è|| 
¬g3
.empty()) {

1292 
	`¡c
("SyÁax:\n", 
ch
);

1293 
	`¡c
(" s‘ obj <objeù> <f›ld> <v®ue>\n", 
ch
);

1294 
	`¡c
(" F›ld bešg oÃ of:\n", 
ch
);

1295 
	`¡c
(" v®ue0 v®ue1 v®ue2 v®ue3 v®ue4 (v1-v4)\n", 
ch
);

1296 
	`¡c
(" cÚd™iÚ†ev– weighˆco¡im”\n", 
ch
);

1300 ià((
obj
 = 
	`g‘_obj_wÜld
(
ch
, 
¬g1
)è=ğ
nuÎ±r
) {

1301 
FÜm©
::
	`¥rštf
(
buf
, "Aá” s—rchšg‡Î ov”hmud, % could‚Ù bfound.\n", 
¬g1
);

1302 
	`¡c
(
buf
, 
ch
);

1312 
v®ue
 = 
	`©oi
(
¬g3
);

1317 ià(
¬g2
 == "value0" ||‡rg2 == "v0") {

1318 
obj
->
v®ue
[0] = value;

1319 
	`±c
(
ch
, "%s' v0 ha b“À£ˆtØ%d.\n", 
obj
->
shÜt_desü
, 
v®ue
);

1323 ià(
¬g2
 == "value1" ||‡rg2 == "v1") {

1324 
obj
->
v®ue
[1] = value;

1325 
	`±c
(
ch
, "%s' v1 ha b“À£ˆtØ%d.\n", 
obj
->
shÜt_desü
, 
v®ue
);

1329 ià(
¬g2
 == "value2" ||‡rg2 == "v2") {

1331 ià((
obj
->
™em_ty³
 =ğ
ITEM_FOUNTAIN


1332 || 
obj
->
™em_ty³
 =ğ
ITEM_DRINK_CON
)

1333 && ()
v®ue
 >ğ
liq_bË
.
	`size
()) {

1334 
	`±c
(
ch
, "Thmax fÜ dršk ªd fouÁaš i %d.\n", 
liq_bË
.
	`size
()-1);

1338 
obj
->
v®ue
[2] = value;

1339 
	`±c
(
ch
, "%s' v2 ha b“À£ˆtØ%d.\n", 
obj
->
shÜt_desü
, 
v®ue
);

1343 ià(
¬g2
 == "value3" ||‡rg2 == "v3") {

1345 ià(
obj
->
™em_ty³
 =ğ
ITEM_WEAPON
 && ()
v®ue
 >ğ
©ck_bË
.
	`size
()) {

1346 
	`±c
(
ch
, "Thmax fÜ w—pÚ i %d.\n", 
©ck_bË
.
	`size
()-1);

1350 ià(
obj
->
™em_ty³
 =ğ
ITEM_PORTAL
) {

1351 cÚ¡ 
Room
 *
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
¬g3
));

1353 ià(
room
 =ğ
nuÎ±r
) {

1354 
	`±c
(
ch
, "There is‚o such†ocation.\n");

1358 
obj
->
v®ue
[3] = 
room
->
loÿtiÚ
.
	`to_št
();

1359 
	`±c
(
ch
, "%s' v3 ha b“À£ˆtØ%s.\n", 
obj
->
shÜt_desü
, 
room
->
loÿtiÚ
);

1363 
obj
->
v®ue
[3] = value;

1364 
	`±c
(
ch
, "%s' v3 ha b“À£ˆtØ%d.\n", 
obj
->
shÜt_desü
, 
v®ue
);

1368 ià(
¬g2
 == "value4" ||‡rg2 == "v4") {

1369 ià(
obj
->
™em_ty³
 =ğ
ITEM_WEAPON
) {

1370 
	`¡c
("PËa£ u£hæag commªdØadd o¸»movw—pÚ fÏgs.\n", 
ch
);

1374 
obj
->
v®ue
[4] = value;

1375 
	`±c
(
ch
, "%s' v4 ha b“À£ˆtØ%d.\n", 
obj
->
shÜt_desü
, 
v®ue
);

1379 ià(
¬g2
.
	`is_´efix_of
("condition")) {

1380 ià(
v®ue
 < -1 || value > 100) {

1381 
	`¡c
("A v®id cÚd™iÚ v®umu¡ bb‘w“À-1‡nd 100.\n", 
ch
);

1385 
obj
->
cÚd™iÚ
 = 
v®ue
;

1386 
FÜm©
::
	`¥rštf
(
buf
, "%s' cÚd™iÚ v®uha b“ÀchªgedØ%d.\n", 
obj
->
shÜt_desü
, 
v®ue
);

1387 
	`¡c
(
buf
, 
ch
);

1391 ià(
¬g2
.
	`is_´efix_of
("level")) {

1392 
obj
->
Ëv–
 = 
v®ue
;

1393 
FÜm©
::
	`¥rštf
(
buf
, "%s' Ëv– ha b“ÀchªgedØ%d.\n", 
obj
->
shÜt_desü
, 
v®ue
);

1394 
	`¡c
(
buf
, 
ch
);

1398 ià(
¬g2
.
	`is_´efix_of
("weight")) {

1399 
obj
->
weight
 = 
v®ue
;

1400 
FÜm©
::
	`¥rštf
(
buf
, "%s' weighˆha b“ÀchªgedØ%d.\n", 
obj
->
shÜt_desü
, 
v®ue
);

1401 
	`¡c
(
buf
, 
ch
);

1405 ià(
¬g2
.
	`is_´efix_of
("cost")) {

1406 
obj
->
co¡
 = 
v®ue
;

1407 
FÜm©
::
	`¥rštf
(
buf
, "%s' co¡ ha b“ÀchªgedØ%d.\n", 
obj
->
shÜt_desü
, 
v®ue
);

1408 
	`¡c
(
buf
, 
ch
);

1412 ià(
¬g2
.
	`is_´efix_of
("timer")) {

1413 
obj
->
tim”
 = 
v®ue
;

1414 
FÜm©
::
	`¥rštf
(
buf
, "%s' tim” v®uha b“ÀchªgedØ%d.\n", 
obj
->
shÜt_desü
, 
v®ue
);

1415 
	`¡c
(
buf
, 
ch
);

1419 ià(
¬g2
.
	`is_´efix_of
("settings")) {

1420 ià(
v®ue
 < 0 || v®u> 
MAX_GEM_SETTINGS
) {

1421 
	`±c
(
ch
, "A v®id s‘tšg vaui b‘w“À0‡nd %d.\n", 
MAX_GEM_SETTINGS
);

1425 
obj
->
num_£‰šgs
 = 
v®ue
;

1426 
FÜm©
::
	`¥rštf
(
buf
, "%s' numb” oà£‰šg ha b“ÀchªgedØ%d.\n", 
obj
->
shÜt_desü
, 
v®ue
);

1427 
	`¡c
(
buf
, 
ch
);

1434 
	`do_o£t
(
ch
, "");

1435 
	}
}

1437 
	$do_r£t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1439 
buf
 [
MAX_STRING_LENGTH
];

1440 
Room
 *
loÿtiÚ
;

1443 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
;

1444 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

1445 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

1446 
¬g3
 = 
¬gum’t
;

1448 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.empty()) {

1449 
	`¡c
("SyÁax:\n", 
ch
);

1450 
	`¡c
(" s‘„oom <loÿtiÚ> <f›ld> <v®ue>\n", 
ch
);

1451 
	`¡c
(" F›ld bešg oÃ of:\n", 
ch
);

1452 
	`¡c
(" seùÜ\n", 
ch
);

1456 ià((
loÿtiÚ
 = 
	`fšd_loÿtiÚ
(
ch
, 
¬g1
)è=ğ
nuÎ±r
) {

1457 
FÜm©
::
	`¥rštf
(
buf
, "NØsuch†oÿtiÚ, %s.\n", 
¬g1
);

1458 
	`¡c
(
buf
, 
ch
);

1462 ià(!
	`is_room_owÃr
(
ch
, 
loÿtiÚ
è&& ch->
š_room
 !=†ocation

1463 && 
loÿtiÚ
->
	`is_´iv©e
(è&& !
	`IS_IMP
(
ch
)) {

1464 
FÜm©
::
	`¥rštf
(
buf
, "I'm sÜry, buˆ% i ¨´iv©room.\n", 
loÿtiÚ
->
	`Çme
());

1465 
	`¡c
(
buf
, 
ch
);

1469 ià(
¬g3
.
	`em±y
()) {

1471 ià(
¬g2
.
	`is_´efix_of
("sector")) {

1472 
	`¡c
("Current sectorypes‡re:\n"

1485 " 21 cÏÇ»Ç\n", 
ch
);

1489 
	`do_r£t
(
ch
, "");

1496 ià(!
¬g3
.
	`is_numb”
()) {

1497 
FÜm©
::
	`¥rštf
(
buf
, "Thv®u’‹»d, %s, i nÙ‚um”ic.\n", 
¬g3
);

1498 
	`¡c
(
buf
, 
ch
);

1508 ià(
¬g2
.
	`is_´efix_of
("sector")) {

1509 
	`¡c
("SÜry, s‘tšg seùÜ v®ui cu¼’y di§bËd.\n", 
ch
);

1519 
	`do_r£t
(
ch
, "");

1520 
	}
}

1523 
	$fÜm©_m¡©
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

1525 ià(
viùim
->
	`is_Åc
())

1526 
	`±c
(
ch
, "Vnum: %d Group: %s Count: %d Killed: %d\n",

1527 
viùim
->
pIndexD©a
->
vnum
,

1528 
viùim
->
group_æags
,

1529 
viùim
->
pIndexD©a
->
couÁ
, viùim->pIndexD©a->
kËd
);

1531 
	`±c
(
ch
, "{WRoom: %s {CName: %s{x\n",

1532 
viùim
->
š_room
 =ğ
nuÎ±r
 ? "0" : viùim->š_room->
loÿtiÚ
.
	`to_¡ršg
(), viùim->
Çme
);

1534 ià(!
viùim
->
	`is_Åc
())

1535 
	`±c
(
ch
, "{CRemÜˆ%d, {x", 
viùim
->
pcd©a
->
»mÜt_couÁ
);

1537 
	`±c
(
ch
, "{CLev– %d{x", 
viùim
->
Ëv–
);

1539 ià(!
viùim
->
	`is_Åc
())

1540 
	`±c
(
ch
, "{C Age: %d (%d hours){x", 
	`g‘_age
(
viùim
), 
	`g‘_¶ay_hours
(victim));

1542 
	`¡c
("\n", 
ch
);

1543 
	`±c
(
ch
, "{MRace: %s Sex: %s Guild: %s Size: %s{x\n",

1544 
¿û_bË
[
viùim
->
¿û
].
Çme
, 
£x_bË
[
	`GET_ATTR_SEX
(victim)].name,

1545 
viùim
->
	`is_Åc
(è? "mobe" : viùim->
gud
 =ğ
Gud
::
nÚe
 ? "nÚe" : 
gud_bË
[viùim->gud].
Çme
,

1546 
size_bË
[
viùim
->
size
].
Çme
);

1548 ià(!
viùim
->
	`is_Åc
())

1549 
	`±c
(
ch
, "Killer: %d\tThief: %d\n",

1550 
viùim
->
pcd©a
->
æag_kËr
, viùim->pcd©a->
æag_th›f
);

1552 
	`±c
(
ch
, "Short description: %s{x\nLong description: %s{x",

1553 
viùim
->
shÜt_desü
, !viùim->
lÚg_desü
.
	`em±y
() ? victim->long_descr : "(none)\n");

1554 
	`¡c
("\n", 
ch
);

1555 
	`±c
(
ch
, "{PStr: %-2d(%-2d)\t{BAC Pierce : %-10d{RHit Points: %d/%d\n",

1556 
	`ATTR_BASE
(
viùim
, 
APPLY_STR
), 
	`GET_ATTR_STR
(victim),

1557 
	`GET_AC
(
viùim
, 
AC_PIERCE
), viùim->
h™
, 
	`GET_MAX_HIT
(victim));

1558 
	`±c
(
ch
, "{PInt: %-2d(%-2d)\t{BAC Bash : %-10d{RMana : %d/%d\n",

1559 
	`ATTR_BASE
(
viùim
, 
APPLY_INT
), 
	`GET_ATTR_INT
(victim),

1560 
	`GET_AC
(
viùim
, 
AC_BASH
), viùim->
mªa
, 
	`GET_MAX_MANA
(victim));

1561 
	`±c
(
ch
, "{PWis: %-2d(%-2d)\t{BAC Slash : %-10d{RStamina : %d/%d\n",

1562 
	`ATTR_BASE
(
viùim
, 
APPLY_WIS
), 
	`GET_ATTR_WIS
(victim),

1563 
	`GET_AC
(
viùim
, 
AC_SLASH
), viùim->
¡am
, 
	`GET_MAX_STAM
(victim));

1564 
	`±c
(
ch
, "{PDex: %-2d(%-2d)\t{BAC Magic : %-10d{HItems : %d\n",

1565 
	`ATTR_BASE
(
viùim
, 
APPLY_DEX
), 
	`GET_ATTR_DEX
(victim),

1566 
	`GET_AC
(
viùim
, 
AC_EXOTIC
), 
	`g‘_ÿ¼y_numb”
(victim));

1567 
	`±c
(
ch
, "{PCon: %-2d(%-2d)\t{bPrac : %-10d{HWeight : %d\n",

1568 
	`ATTR_BASE
(
viùim
, 
APPLY_CON
), 
	`GET_ATTR_CON
(victim),

1569 
viùim
->
	`is_Åc
(è? 0 : viùim->
´aùiû
, 
	`g‘_ÿ¼y_weight
(victim) / 10);

1570 
	`±c
(
ch
, "{PChr: %-2d(%-2d)\t{bTrain : %-10d{GHit Roll : %d\n",

1571 
	`ATTR_BASE
(
viùim
, 
APPLY_CHR
), 
	`GET_ATTR_CHR
(victim),

1572 
viùim
->
	`is_Åc
(è? 0 : viùim->
Œaš
 , 
	`GET_ATTR_HITROLL
(victim));

1573 
	`±c
(
ch
, "\t\t{YGold : %-10ld{GDam Roll : %d\n",

1574 
viùim
->
gŞd
, 
	`GET_ATTR_DAMROLL
(victim));

1575 
	`±c
(
ch
, "{CThirst: %-8d{YSilver : %-10ld{WAlignment : %d\n",

1576 (!
viùim
->
	`is_Åc
(è? viùim->
pcd©a
->
cÚd™iÚ
[
COND_THIRST
] : -1),

1577 
viùim
->
sv”
, viùim->
®ignm’t
);

1578 
	`±c
(
ch
, "{CHunger: %-8d{WSaves : %-10dWimpy : %d\n",

1579 (!
viùim
->
	`is_Åc
(è? viùim->
pcd©a
->
cÚd™iÚ
[
COND_HUNGER
] : -1),

1580 
	`GET_ATTR_SAVES
(
viùim
), viùim->
wimpy
);

1581 
	`±c
(
ch
, "{CFull : %-8d{cLast Level: %-10dMobTimer : %d\n",

1582 (!
viùim
->
	`is_Åc
(è? viùim->
pcd©a
->
cÚd™iÚ
[
COND_FULL
] : -1),

1583 (!
viùim
->
	`is_Åc
(è? viùim->
pcd©a
->
Ï¡_Ëv–
 : -1),

1584 (!
viùim
->
	`is_Åc
(è? viùim->
tim”
 : -1));

1585 
	`±c
(
ch
, "{CDrunk : %-8d{cExp : %-10dPosition : %s{x\n",

1586 (!
viùim
->
	`is_Åc
(è? viùim->
pcd©a
->
cÚd™iÚ
[
COND_DRUNK
] : -1),

1587 
viùim
->
exp
, 
pos™iÚ_bË
[viùim->
pos™iÚ
].
Çme
);

1589 ià(
viùim
->
	`is_Åc
())

1590 
	`±c
(
ch
, "Damage: %dd%d Message: %s\n",

1591 
viùim
->
damage
[
DICE_NUMBER
], viùim->damage[
DICE_TYPE
],

1592 
©ck_bË
[
viùim
->
dam_ty³
].
noun
);

1594 
	`±c
(
ch
, "Fightšg: %s\n", 
viùim
->
fightšg
 ? viùim->fightšg->
Çme
 : "(none)");

1596 ià(
viùim
->
	`is_Åc
(è&& viùim->
huÁšg
 !ğ
nuÎ±r
)

1597 
	`±c
(
ch
, "Hunting victim: %s (%s)\n",

1598 
viùim
->
huÁšg
->
	`is_Åc
(è? viùim->huÁšg->
shÜt_desü


1599 : 
viùim
->
huÁšg
->
Çme
,

1600 
viùim
->
huÁšg
->
	`is_Åc
() ? "MOB" : "PLAYER");

1602 ià(!
viùim
->
	`is_Åc
())

1603 ià(!
viùim
->
pcd©a
->
ema
.
	`em±y
())

1604 
	`±c
(
ch
, "Ema: %s\n", 
viùim
->
pcd©a
->
ema
);

1606 
	`±c
(
ch
, "{WAù: %s\n", 
	`aù_b™_Çme
(
viùim
->
aù_æags
, viùim->
	`is_Åc
()));

1608 ià(!
viùim
->
	`is_Åc
()) {

1609 
	`±c
(
ch
, "{WPÌ: %s\n", 
	`¶r_b™_Çme
(
viùim
->
pcd©a
->
¶r_æags
));

1611 ià(!
viùim
->
pcd©a
->
cgroup_æags
.
	`em±y
(è&& 
	`IS_IMP
(
ch
))

1612 
	`±c
(
ch
, "{WCommªd Groups: %s\n", 
	`cgroup_b™_Çme
(
viùim
->
pcd©a
->
cgroup_æags
));

1615 ià(!
viùim
->
comm_æags
.
	`em±y
())

1616 
	`±c
(
ch
, "{WComm: %s\n", 
	`comm_b™_Çme
(
viùim
->
comm_æags
));

1618 ià(!
viùim
->
»voke_æags
.
	`em±y
())

1619 
	`±c
(
ch
, "{WRevoke: %s\n", 
	`»voke_b™_Çme
(
viùim
->
»voke_æags
));

1621 ià(!
viùim
->
ûnsÜ_æags
.
	`em±y
())

1622 
	`±c
(
ch
, "{WC’sÜ: %s\n", 
	`ûnsÜ_b™_Çme
(
viùim
->
ûnsÜ_æags
));

1624 ià(
viùim
->
	`is_Åc
(è&& !viùim->
off_æags
.
	`em±y
())

1625 
	`±c
(
ch
, "{WOfãn£: %s\n", 
	`off_b™_Çme
(
viùim
->
off_æags
));

1628 
SŒšg
 
buf
;

1629 
buf
 = 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_ABSORB
);

1630 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, "Abs : %s\n", buf);

1631 
buf
 = 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_IMMUNE
);

1632 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, "Imm : %s\n", buf);

1633 
buf
 = 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_RESIST
);

1634 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, "Res : %s\n", buf);

1635 
buf
 = 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_VULN
);

1636 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, "Vuln: %s\n", buf);

1637 
buf
 = 
afãù
::
	`´št_ÿche
(
viùim
);

1638 ià(!
buf
.
	`em±y
()è
	`±c
(
ch
, "Aff : %s\n", buf);

1641 
	`±c
(
ch
, "{xFÜm: %s\nP¬ts: %s\n", 
	`fÜm_b™_Çme
(
viùim
->
fÜm_æags
), 
	`·¹_b™_Çme
(viùim->
·¹s_æags
));

1642 
	`±c
(
ch
, "Master: %s Leader: %s Pet: %s\n",

1643 
viùim
->
ma¡”
 ? viùim->ma¡”->
Çme
 : "(none)",

1644 
viùim
->
Ëad”
 ? viùim->Ëad”->
Çme
 : "(none)",

1645 
viùim
->
³t
 ? viùim->³t->
Çme
 : "(none)");

1647 ià(!
viùim
->
	`is_Åc
(è&& viùim->
pcd©a
->
m¬k_room
.
	`is_v®id
())

1648 
	`±c
(
ch
, "MARKed„oom: %s\n", 
viùim
->
pcd©a
->
m¬k_room
.
	`to_¡ršg
());

1650 ià(
viùim
->
	`is_Åc
(è&& viùim->
¥ec_fun
 != 0)

1651 
	`±c
(
ch
, "Mobha ¥ecŸÈ´oûdu» %s.\n", 
	`¥ec_Çme
(
viùim
->
¥ec_fun
));

1653 ià(!
viùim
->
	`is_Åc
(è&& viùim->
pcd©a
->
¿fãù
[0] != 0) {

1654 
SŒšg
 
buf
;

1655 
¿ff
, 
id
;

1656 
	`¡c
("{VRemÜˆafãùs{x:\n", 
ch
);

1657 
id
 = (
	`¿ff_lookup
(
viùim
->
pcd©a
->
¿fãù
[0]));

1659 ià(
id
 == -1)

1660 
FÜm©
::
	`¥rštf
(
buf
, "Unknown");

1662 
FÜm©
::
	`¥rštf
(
buf
, "%s", 
¿fãùs
[
id
].
shÜŠame
);

1664 
¿ff
 = 1;„afà< ((
viùim
->
pcd©a
->
»mÜt_couÁ
 / 10) + 1);„aff++) {

1665 
id
 = (
	`¿ff_lookup
(
viùim
->
pcd©a
->
¿fãù
[
¿ff
]));

1667 ià(
id
 == -1)

1668 
buf
 += ", Unknown";

1670 
buf
 += ", ";

1671 
buf
 +ğ
¿fãùs
[
id
].
shÜŠame
;

1675 
buf
 += "\n";

1676 
	`¡c
(
buf
, 
ch
);

1679 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_ch¬
(
viùim
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
) {

1680 ià(
·f
->
³rmª’t
)

1683 
	`±c
(
ch
, "{bS³Î: '%s'", 
afãù
::
	`lookup
(
·f
->
ty³
).
Çme
);

1685 ià(
·f
->
wh”e
 =ğ
TO_AFFECTS
) {

1686 ià(
·f
->
loÿtiÚ
 !ğ
APPLY_NONE
 &&…af->
modif›r
 != 0)

1687 
	`±c
(
ch
, " modif› % by %d", 
	`afãù_loc_Çme
(
·f
->
loÿtiÚ
),…af->
modif›r
);

1689 ià(
·f
->
wh”e
 =ğ
TO_DEFENSE
)

1690 
	`±c
(
ch
, " %s damage from %s by %d%%",

1691 
·f
->
modif›r
 > 0 ? "reduces" : "increases",

1692 
	`dam_ty³_Çme
(
·f
->
loÿtiÚ
),

1693 
·f
->
modif›r
 > 0 ?…af->modifier : -paf->modifier);

1695 
	`¡c
(" dÛ som‘hšg weœd", 
ch
);

1697 ià(
·f
->
du¿tiÚ
 >= 0)

1698 
	`±c
(
ch
, " fÜ %d hours", 
·f
->
du¿tiÚ
);

1700 
	`±c
(
ch
, ",†ev– %d", 
·f
->
Ëv–
);

1702 ià(
·f
->
evŞutiÚ
 > 1)

1703 
	`±c
(
ch
, ",ƒvŞv%d", 
·f
->
evŞutiÚ
);

1705 
	`¡c
(".\n", 
ch
);

1707 
	}
}

1709 
	$fÜm©_o¡©
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
)

1711 
	`±c
(
ch
, "{CVnum: %d Lev–: %d\n", 
obj
->
pIndexD©a
->
vnum
, obj->
Ëv–
);

1712 
	`±c
(
ch
, "{CName(s):{x %s{x\n", 
obj
->
Çme
);

1713 
	`±c
(
ch
, "Short description: %s{x\nLong description: %s{x\n",

1714 
obj
->
shÜt_desü
, obj->
desütiÚ
);

1716 ià(
obj
->
exŒa_desü
 !ğ
nuÎ±r
 || obj->
pIndexD©a
->extra_descr !=‚ullptr) {

1717 
ExŒaDesü
 *
ed
;

1718 
	`¡c
("ExŒ¨desütiÚ keywÜds: '", 
ch
);

1720 
ed
 = 
obj
->
exŒa_desü
;ƒd !ğ
nuÎ±r
;ƒd =ƒd->
Ãxt
) {

1721 
	`¡c
(
ed
->
keywÜd
, 
ch
);

1723 ià(
ed
->
Ãxt
 !ğ
nuÎ±r
)

1724 
	`¡c
(" ", 
ch
);

1727 
	`¡c
("'\n", 
ch
);

1728 
	`¡c
("DeçuÉ desütiÚ keywÜds: '", 
ch
);

1730 
ed
 = 
obj
->
pIndexD©a
->
exŒa_desü
;ƒd !ğ
nuÎ±r
;ƒd =ƒd->
Ãxt
) {

1731 
	`¡c
(
ed
->
keywÜd
, 
ch
);

1733 ià(
ed
->
Ãxt
 !ğ
nuÎ±r
)

1734 
	`¡c
(" ", 
ch
);

1738 
	`¡c
("\n", 
ch
);

1739 
	`±c
(
ch
, "{PValue0 : %-9d{BCost : %-13d{GIn„oom : %s\n",

1740 
obj
->
v®ue
[0], obj->
co¡
, obj->
š_room
 =ğ
nuÎ±r
 ? "0" : obj->š_room->
loÿtiÚ
.
	`to_¡ršg
());

1741 
	`±c
(
ch
, "{PValue1 : %-9d{BCondition: %-13d{GIn object : %s\n",

1742 
obj
->
v®ue
[1], obj->
cÚd™iÚ
, obj->
š_obj
 =ğ
nuÎ±r
 ? "ÒÚe)" : obj->š_obj->
shÜt_desü
);

1743 
	`±c
(
ch
, "{PValue2 : %-9d{BType : %-13s{GIn %s : %s\n",

1744 
obj
->
v®ue
[2], 
	`™em_ty³_Çme
(obj),

1745 
obj
->
š_¡rÚgbox
 ? "StrBox" : "Locker",

1746 
obj
->
š_lock”
 ? 
	`PERS
(obj->š_lock”, 
ch
, 
VIS_PLR
) :

1747 
obj
->
š_¡rÚgbox
 ? 
	`PERS
(obj->š_¡rÚgbox, 
ch
, 
VIS_PLR
) : "(none)");

1749 
	`±c
(
ch
, "{PValue3 : ");

1750 ià(
obj
->
™em_ty³
 =ğ
ITEM_PORTAL
)

1751 
	`±c
(
ch
, "%-9s", 
	`LoÿtiÚ
(
obj
->
v®ue
[3]));

1753 
	`±c
(
ch
, "%-9d", 
obj
->
v®ue
[3]);

1755 
	`±c
(
ch
, "{BResets : %-13d{GCarried by: %s\n",

1756 
obj
->
pIndexD©a
->
»£t_num
,

1757 
obj
->
ÿ¼›d_by
 =ğ
nuÎ±r
 ? "ÒÚe)" : 
	`PERS
(obj->ÿ¼›d_by, 
ch
, 
VIS_PLR
));

1758 
	`±c
(
ch
, "{PValue4 : %-9d{BTimer : %-13d{GOwned by : %s\n",

1759 
obj
->
v®ue
[4], obj->
tim”
, 
	`g‘_owÃr
(
ch
, obj));

1760 
	`±c
(
ch
, "\t\t{BNumber : %d/%-11d{GWear Loc. : %d\n",

1761 1, 
	`g‘_obj_numb”
(
obj
), obj->
w—r_loc
);

1762 
	`±c
(
ch
, "\t\t{BWeight : %d/%d/%d (10th…ounds){x\n",

1763 
obj
->
weight
, 
	`g‘_obj_weight
(obj), 
	`g‘_Œue_weight
(obj));

1764 
	`±c
(
ch
, "{W\nWear bits : %s\nExtra bits: %s{b\n\n",

1765 
	`w—r_b™_Çme
(
obj
->
w—r_æags
), 
	`exŒa_b™_Çme
(obj->
exŒa_æags
 + obj->
ÿched_exŒa_æags
));

1766 ià(
obj
->
pIndexD©a
->
gud
 !ğ
Gud
::
nÚe
){

1767 
gudÇme
 = 
obj
->
pIndexD©a
->
gud
;

1768 
	`±c
(
ch
, "{WCÏs Re¡riùiÚs: %s{Y.{x\n\n", 
gud_bË
[
gudÇme
].
Çme
 );

1774 
obj
->
™em_ty³
) {

1775 
ITEM_SCROLL
:

1776 
ITEM_POTION
:

1777 
ITEM_PILL
:

1778 
	`±c
(
ch
, "Lev– %d s³Î of:", 
obj
->
v®ue
[0]);

1780 
i
 = 1; i <= 4; i++) {

1781 
skl
::
ty³
y³ = skl::
	`äom_št
(
obj
->
v®ue
[
i
]);

1783 ià(
ty³
 !ğ
skl
::ty³::
unknown
)

1784 
	`±c
(
ch
, " '%s'", 
skl
::
	`lookup
(
ty³
).
Çme
);

1787 
	`¡c
(".\n", 
ch
);

1790 
ITEM_WAND
:

1791 
ITEM_STAFF
:

1792 
	`±c
(
ch
, "Ha %d ch¬ge oàËv– %d", 
obj
->
v®ue
[2], obj->value[0]);

1793 
	`±c
(
ch
, " '%s'", 
skl
::
	`lookup
(skl::
	`äom_št
(
obj
->
v®ue
[3])).
Çme
);

1795 
	`¡c
(".\n", 
ch
);

1798 
ITEM_DRINK_CON
:

1799 
	`±c
(
ch
, "It holds %s-colored %s.\n",

1800 
liq_bË
[
obj
->
v®ue
[2]].
cŞÜ
,†iq_bË[obj->v®ue[2]].
Çme
);

1803 
ITEM_CONTAINER
:

1804 
	`±c
(
ch
, "Capacity: %d# Maximum weight: %d# flags: %s\n",

1805 
obj
->
v®ue
[0], obj->v®ue[3], 
	`cÚt_b™_Çme
(obj->value[1]));

1807 ià(
obj
->
v®ue
[4] != 100)

1808 
	`±c
(
ch
, "WeighˆmuÉl›r: %d%%\n", 
obj
->
v®ue
[4]);

1812 
ITEM_WEAPON
:

1813 
	`¡c
("W—pÚy³ i ", 
ch
);

1815 
obj
->
v®ue
[0]) {

1816 (
WEAPON_EXOTIC
è: 
	`¡c
("exÙic.\n", 
ch
); ;

1818 (
WEAPON_SWORD
è: 
	`¡c
("swÜd.\n", 
ch
); ;

1820 (
WEAPON_DAGGER
è: 
	`¡c
("dagg”.\n", 
ch
); ;

1822 (
WEAPON_SPEAR
è: 
	`¡c
("¥—r/¡aff.\n", 
ch
); ;

1824 (
WEAPON_MACE
è: 
	`¡c
("maû/şub.\n", 
ch
); ;

1826 (
WEAPON_AXE
è: 
	`¡c
("axe.\n", 
ch
); ;

1828 (
WEAPON_FLAIL
è: 
	`¡c
("æa.\n", 
ch
); ;

1830 (
WEAPON_WHIP
è: 
	`¡c
("wh.\n", 
ch
); ;

1832 (
WEAPON_POLEARM
): 
	`¡c
("pŞ—rm.\n", 
ch
); ;

1834  : 
	`¡c
("unknown.\n", 
ch
); ;

1837 
	`±c
(
ch
, "Damage is %dd%d (average %d).\n",

1838 
obj
->
v®ue
[1], obj->value[2], (1 + obj->value[2]) * obj->value[1] / 2);

1845 
ITEM_ARMOR
:

1846 
	`±c
(
ch
, "Armor class is %d…ierce, %d bash, %d slash,‡nd %d vs. magic.\n",

1847 
obj
->
v®ue
[0], obj->value[1], obj->value[2], obj->value[3]);

1850 
ITEM_MATERIAL
:

1851 
	`±c
(
ch
, "Skill modifier: %d, Dice Bonus %d, Sides Bonus %d\n",

1852 
obj
->
v®ue
[0], obj->value[1], obj->value[2]);

1856 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
) {

1858 
	`±c
(
ch
, "wh: %dp: %d†v: %d dr: %d†o: %d md: %dƒv: %d bv: %d csum: %ld\n",

1859 
·f
->
wh”e
,…af->
ty³
,…af->
Ëv–
,…af->
du¿tiÚ
,…af->
loÿtiÚ
,

1860 
·f
->
modif›r
,…af->
evŞutiÚ
,…af->
	`b™veùÜ
(), 
afãù
::
	`checksum
(paf));

1862 
	`show_afãù_to_ch¬
(
·f
, 
ch
);

1865 ià(
obj
->
num_£‰šgs
 > 0) {

1866 
	`±c
(
ch
, "Ha %d s‘tšgs.\n", 
obj
->
num_£‰šgs
);

1869 
Objeù
 *
gem
 = 
obj
->
gems
; gem; gem = gem->
Ãxt_cÚ‹Á
)

1870 
	`±c
(
ch
, "Has‡ gem %s ofype %d with quality %d.\n",

1871 
gem
->
shÜt_desü
, gem->
v®ue
[0], gem->value[1]);

1872 ià(
obj
->
gems
) {

1873 
	`¡c
("Gem ¬addšg:", 
ch
);

1875 cÚ¡ 
afãù
::
Afãù
 *
·f
 = 
obj
->
gem_afãùed
;…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
)

1876 
	`show_afãù_to_ch¬
(
·f
, 
ch
);

1879 
	}
}

1881 
	$fÜm©_r¡©
(
Ch¬aù”
 *
ch
, 
Room
 *
loÿtiÚ
)

1883 
SŒšg
 
buf
;

1884 
Objeù
 *
obj
;

1885 
Ch¬aù”
 *
rch
;

1886 
doÜ
;

1887 
	`±c
(
ch
, "{W[%s] {gName: {P% {W(%s){x\n", 
loÿtiÚ
->loÿtiÚ.
	`to_¡ršg
(),†oÿtiÚ->
	`Çme
(),†oÿtiÚ->
	`¬—
().
Çme
);

1888 
	`±c
(
ch
, "{YSector: %d\tLight: %d\tHealing: %d\tMana: %d{x\n",

1889 
loÿtiÚ
->
	`£ùÜ_ty³
(),†oÿtiÚ->
light
,†oÿtiÚ->
	`h—l_¿‹
(),†oÿtiÚ->
	`mªa_¿‹
());

1891 ià(
loÿtiÚ
->
	`şª
())

1892 
	`±c
(
ch
, "{VCÏn: %s{x\n", 
loÿtiÚ
->
	`şª
()->
who_Çme
);

1894 ià(
loÿtiÚ
->
	`gud
(è!ğ
Gud
::
nÚe
)

1895 
	`±c
(
ch
, "{VGud: %s{x\n", 
gud_bË
[
loÿtiÚ
->
	`gud
()].
Çme
);

1897 
	`±c
(
ch
, "{BDesütiÚ:{x\n%s\n", 
loÿtiÚ
->
	`desütiÚ
());

1899 ià(
loÿtiÚ
->
	`exŒa_desü
(è!ğ
nuÎ±r
) {

1900 cÚ¡ 
ExŒaDesü
 *
ed
;

1901 
	`¡c
("{BExŒ¨desütiÚ keywÜds: '{x", 
ch
);

1903 
ed
 = 
loÿtiÚ
->
	`exŒa_desü
();ƒd;ƒd =ƒd->
Ãxt
)

1904 
	`±c
(
ch
, "%s{x%s", 
ed
->
keywÜd
,ƒd->
Ãxt
 =ğ
nuÎ±r
 ? "{B.{x\n" : " ");

1907 ià(!
loÿtiÚ
->
	`æags
().
	`em±y
())

1908 
	`±c
(
ch
, "{CRoom fÏgs: %s{x\n", 
	`room_b™_Çme
(
loÿtiÚ
->
	`æags
()));

1910 ià(
loÿtiÚ
->
³İË
) {

1911 
	`¡c
("{GCh¬aù”s:{x ", 
ch
);

1913 
rch
 = 
loÿtiÚ
->
³İË
;„ch;„ch =„ch->
Ãxt_š_room
)

1914 ià(
	`ÿn_£e_ch¬
(
ch
, 
rch
)) {

1915 
	`Úe_¬gum’t
(
rch
->
Çme
, 
buf
);

1916 
	`±c
(
ch
, "%s{x%s", 
buf
, 
rch
->
Ãxt_š_room
 ? " " : "\n");

1920 ià(
loÿtiÚ
->
cÚ‹Ás
) {

1921 
	`¡c
("{bObjeù  :{x ", 
ch
);

1923 
obj
 = 
loÿtiÚ
->
cÚ‹Ás
; obj; obj = obj->
Ãxt_cÚ‹Á
) {

1924 
	`Úe_¬gum’t
(
obj
->
Çme
, 
buf
);

1925 
	`±c
(
ch
, "%s{x%s", 
buf
, 
obj
->
Ãxt_cÚ‹Á
 ? " " : "\n");

1929 
doÜ
 = 0; door <= 5; door++) {

1930 
Ex™
 *
³x™
;

1932 ià((
³x™
 = 
loÿtiÚ
->
ex™
[
doÜ
]è!ğ
nuÎ±r
) {

1933 
	`±c
(
ch
, "{WDoor: %d -> %s{c (Key: %d) Exit flags: %d. Keyword: '%s'{x\n",

1934 
doÜ
, (
³x™
->
to_room
 =ğ
nuÎ±r
 ? "-1" :…ex™->to_room->
loÿtiÚ
.
	`to_¡ršg
()),

1935 
³x™
->
	`key
(),…ex™->
ex™_æags
,…ex™->
	`keywÜd
());

1937 ià(!
³x™
->
	`desütiÚ
().
	`em±y
())

1938 
	`±c
(
ch
, "{cDesütiÚ: %s{x", 
³x™
->
	`desütiÚ
());

1942 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_room
(
loÿtiÚ
);…aà!ğ
nuÎ±r
;…aàğ·f->
Ãxt
)

1943 
	`±c
(
ch
, "{bAffect: '%s' modifies %s by %d for %d hours with bits %s,†evel %d,ƒvolve %d.{x\n",

1944 
afãù
::
	`lookup
(
·f
->
ty³
).
Çme
,

1945 
	`afãù_loc_Çme
(
·f
->
loÿtiÚ
),

1946 
·f
->
modif›r
,

1947 
·f
->
du¿tiÚ
 + 1,

1948 
	`room_b™_Çme
(
·f
->
	`b™veùÜ
()),

1949 
·f
->
Ëv–
,

1950 
·f
->
evŞutiÚ
);

1951 
	}
}

1954 
	$do_¡©
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1956 
Room
 *
room
;

1957 
Objeù
 *
obj
;

1958 
Ch¬aù”
 *
vch
;

1960 ià(
¬gum’t
.
	`em±y
()) {

1961 
	`¡c
("Syntax:\n"

1967 " sˆobj <Çme>\n", 
ch
);

1971 
SŒšg
 
¬g1
;

1972 
SŒšg
 
¬g2
 = 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g1
);

1974 ià(
¬g1
 == "char") {

1975 ià(
¬g2
.
	`em±y
()) {

1976 
	`¡c
("Sˆwh© ch¬aù”?\n", 
ch
);

1980 ià((
vch
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g2
, 
VIS_CHAR
)è=ğ
nuÎ±r
)

1981 ià((
vch
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g2
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

1982 
	`¡c
("NØ¶ay” Ü mobe byh©‚am¬šhwÜld.\n", 
ch
);

1986 
	`fÜm©_m¡©
(
ch
, 
vch
);

1988 ià(
¬g1
.
	`is_´efix_of
("mobile")) {

1989 ià(
¬g2
.
	`em±y
()) {

1990 
	`¡c
("Sˆwh© mobe?\n", 
ch
);

1994 ià((
vch
 = 
	`g‘_mob_h”e
(
ch
, 
¬g2
, 
VIS_CHAR
)è=ğ
nuÎ±r
)

1995 ià((
vch
 = 
	`g‘_mob_wÜld
(
ch
, 
¬g2
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

1996 
	`¡c
("NØmobe byh©‚am¬šhwÜld.\n", 
ch
);

2000 
	`fÜm©_m¡©
(
ch
, 
vch
);

2002 ià(
¬g1
.
	`is_´efix_of
("player")) {

2003 ià(
¬g2
.
	`em±y
()) {

2004 
	`¡c
("Sˆwh©…Ïy”?\n", 
ch
);

2008 ià((
vch
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g2
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

2009 
	`¡c
("NØ¶ay” byh©‚ami šhwÜld.\n", 
ch
);

2013 
	`fÜm©_m¡©
(
ch
, 
vch
);

2015 ià(
¬g1
.
	`is_´efix_of
("object")) {

2016 ià(
¬g2
.
	`em±y
()) {

2017 
	`¡c
("Sˆwh© objeù?\n", 
ch
);

2021 ià((
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬g2
)è=ğ
nuÎ±r
)

2022 ià((
obj
 = 
	`g‘_obj_wÜld
(
ch
, 
¬g2
)è=ğ
nuÎ±r
) {

2023 
	`¡c
("NØobjeù byh©‚am¬šhwÜld.\n", 
ch
);

2027 
	`fÜm©_o¡©
(
ch
, 
obj
);

2029 ià(
¬g1
 == "room")

2030 
	`fÜm©_r¡©
(
ch
, ch->
š_room
);

2031 ià((
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
¬g1
))è!ğ
nuÎ±r
) {

2033 ià(!
	`is_room_owÃr
(
ch
, 
room
)

2034 && 
ch
->
š_room
 !ğ
room


2035 && 
room
->
	`is_´iv©e
()

2036 && !
	`IS_IMP
(
ch
)) {

2037 
	`¡c
("Th©„oom i ´iv©e.\n", 
ch
);

2041 
	`fÜm©_r¡©
(
ch
, 
room
);

2044 ià((
vch
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬gum’t
, 
VIS_PLR
)))
	`fÜm©_m¡©
(ch, vch);

2045 ià((
vch
 = 
	`g‘_mob_h”e
(
ch
, 
¬gum’t
, 
VIS_CHAR
))è
	`fÜm©_m¡©
(ch, vch);

2046 ià((
obj
 = 
	`g‘_obj_h”e
(
ch
, 
¬gum’t
))è
	`fÜm©_o¡©
(ch, obj);

2047 ià((
obj
 = 
	`g‘_obj_wÜld
(
ch
, 
¬gum’t
))è
	`fÜm©_o¡©
(ch, obj);

2048 ià((
vch
 = 
	`g‘_mob_wÜld
(
ch
, 
¬gum’t
, 
VIS_CHAR
))è
	`fÜm©_m¡©
(ch, vch);

2050 
	`¡c
("IˆdÛ nÙƒxi¡.\n", 
ch
);

2052 
	}
}

2055 
	$do_p¡©
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2057 
Ch¬aù”
 *
viùim
;

2058 
x¶
, 
xÆ
;

2060 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬gum’t
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

2061 
	`±c
(
ch
, "NØ¶ay”‚amed '%s' found iÀthgame.\n", 
¬gum’t
);

2065 ià(!
viùim
->
pcd©a
) {

2066 
Loggšg
::
	`bug
("do_pstat:…layer without…cdata", 0);

2067 
	`¡c
("NØšfÜm©iÚ‡vaabË‡bouˆth©…Ïy”.\n", 
ch
);

2072 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_PKILL
);

2073 
	`¡c
("PLAYER: ", 
ch
);

2074 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_NAME
);

2075 
	`¡c
(
viùim
->
Çme
, 
ch
);

2077 ià(!
viùim
->
pcd©a
->
t™Ë
.
	`em±y
()) {

2078 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2079 
	`¡c
(" [", 
ch
);

2080 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_NAME
);

2081 
	`¡c
(
viùim
->
pcd©a
->
t™Ë
, 
ch
);

2082 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2083 
	`¡c
("]", 
ch
);

2086 
	`¡c
("\n", 
ch
);

2088 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_NAME
);

2089 
	`±c
(
ch
, "LvÈ%d", 
viùim
->
Ëv–
);

2091 ià(
viùim
->
pcd©a
->
»mÜt_couÁ
)

2092 
	`±c
(
ch
, "/R%d", 
viùim
->
pcd©a
->
»mÜt_couÁ
);

2094 
	`±c
(
ch
, " %s %s %s",

2095 
¿û_bË
[
viùim
->
¿û
].
Çme
,

2096 
£x_bË
[
	`GET_ATTR_SEX
(
ch
)].
Çme
,

2097 
viùim
->
gud
 =ğ
Gud
::
nÚe
 ? "nÚe" : 
gud_bË
[viùim->gud].
Çme
);

2099 ià(
viùim
->
şª
) {

2100 
	`¡c
(", ", 
ch
);

2101 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2102 
	`±c
(
ch
, "%s of clan %s",

2103 
viùim
->
	`has_cgroup
(
GROUP_LEADER
) ? "Leader" :

2104 
viùim
->
	`has_cgroup
(
GROUP_DEPUTY
) ? "Deputy" :

2106 
viùim
->
şª
->
who_Çme
);

2109 
	`¡c
("\n", 
ch
);

2112 ià(!
viùim
->
pcd©a
->
ema
.
	`em±y
()) {

2113 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2114 
	`±c
(
ch
, "Ema: %s\n", 
viùim
->
pcd©a
->
ema
);

2118 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_STAT
);

2119 
	`±c
(
ch
, "Str %-2d(%-2d)",

2120 
	`ATTR_BASE
(
viùim
, 
APPLY_STR
), 
	`GET_ATTR_STR
(victim));

2121 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_ALIGN
);

2122 
	`±c
(
ch
, " Align %s%-7d",

2123 
viùim
->
®ignm’t
 < 0 ? "{R" : "{Y", victim->alignment);

2124 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_POINTS
);

2125 
	`±c
(
ch
, " HP %-5d/%-5d\n",

2126 
viùim
->
h™
, 
	`GET_MAX_HIT
(victim));

2128 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_STAT
);

2129 
	`±c
(
ch
, "Int %-2d(%-2d)",

2130 
	`ATTR_BASE
(
viùim
, 
APPLY_INT
), 
	`GET_ATTR_INT
(victim));

2131 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_GAIN
);

2132 
	`±c
(
ch
, " T¿š %-7d", 
viùim
->
Œaš
);

2133 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_POINTS
);

2134 
	`±c
(
ch
, " Mana %-5d/%-5d\n",

2135 
viùim
->
mªa
, 
	`GET_MAX_MANA
(victim));

2137 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_STAT
);

2138 
	`±c
(
ch
, "Wis %-2d(%-2d)",

2139 
	`ATTR_BASE
(
viùim
, 
APPLY_WIS
), 
	`GET_ATTR_WIS
(victim));

2140 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_GAIN
);

2141 
	`±c
(
ch
, " Pracs %-7d",

2142 
viùim
->
´aùiû
);

2143 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_POINTS
);

2144 
	`±c
(
ch
, " Stm %-5d/%-5d\n",

2145 
viùim
->
¡am
, 
	`GET_MAX_STAM
(victim));

2147 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_STAT
);

2148 
	`±c
(
ch
, "Dex %-2d(%-2d)",

2149 
	`ATTR_BASE
(
viùim
, 
APPLY_DEX
), 
	`GET_ATTR_DEX
(victim));

2150 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_QP
);

2151 
	`±c
(
ch
, " QP: %-5d\n", 
viùim
->
pcd©a
->
que¡pošts
);

2153 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_STAT
);

2154 
	`±c
(
ch
, "Con %-2d(%-2d)",

2155 
	`ATTR_BASE
(
viùim
, 
APPLY_CON
), 
	`GET_ATTR_CON
(victim));

2156 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_MONEY
);

2157 
	`±c
(
ch
, " Gold %-7ld",

2158 
viùim
->
gŞd
);

2159 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_SP
);

2160 
	`±c
(
ch
, " SP: %-5d\n", 
viùim
->
pcd©a
->
skÍošts
);

2162 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_STAT
);

2163 
	`±c
(
ch
, "Chr %-2d(%-2d)",

2164 
	`ATTR_BASE
(
viùim
, 
APPLY_CHR
), 
	`GET_ATTR_CHR
(victim));

2165 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_MONEY
);

2166 
	`±c
(
ch
, " Sv %-7ld", 
viùim
->
sv”
);

2167 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_RPP
);

2168 
	`±c
(
ch
, " RPP: %d\n", 
viùim
->
pcd©a
->
rŞ•ošts
);

2170 
x¶
 = 
	`exp_³r_Ëv–
(
viùim
, viùim->
pcd©a
->
pošts
);

2171 
xÆ
 = (
viùim
->
Ëv–
 + 1è* 
x¶
;

2172 
	`Ãw_cŞÜ
(
ch
, 
CSLOT_OLDSCORE_STAT
);

2173 
	`±c
(
ch
, "Xtl %-6d X/lv %-7d Exp %d\n",

2174 
xÆ
 - 
viùim
->
exp
, 
x¶
, victim->exp);

2176 
	`±c
(
ch
, "%s%s%s%s%s%s%s%s%s%s{x\n",

2177 
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_LINK_DEAD
) ? "{G(LinkDead) " : "",

2178 
viùim
->
comm_æags
.
	`has
(
COMM_AFK
) ? "{b[AFK] " : "",

2179 
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
švis
) ? "{C(Invis) " : "",

2180 
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
hide
) ? "{B(Hide) " : "",

2181 
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
midnight
) ? "{c(Shadowy) " : "",

2182 
viùim
->
švis_Ëv–
 ? "{T(Wizi) " : "",

2183 
viùim
->
lurk_Ëv–
 ? "{H(Lurk) " : "",

2184 
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ch¬m_³rsÚ
) ? "{M(Charmed) " : "",

2185 
viùim
->
aù_æags
.
	`has
(
PLR_KILLER
) ? "{R(KILLER) " : "",

2186 
viùim
->
aù_æags
.
	`has
(
PLR_THIEF
) ? "{B(THIEF) " : "");

2188 
	`±c
(
ch
, "{W%s in„oom [%s]",

2189 
pos™iÚ_bË
[
viùim
->
pos™iÚ
].
Çme
,

2190 
viùim
->
š_room
 ? viùim->š_room->
loÿtiÚ
.
	`to_¡ršg
() : "0");

2192 ià(
viùim
->
fightšg
)

2193 
	`±c
(
ch
, ", {Rš comb©{x w™h %s", 
viùim
->
fightšg
->
Çme
);

2195 
	`¡c
("{a{x\n", 
ch
);

2196 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2197 
	}
}

	@src/skill/skill_table.cc

1 
	~"skl/skl.hh
"

2 
	~"Loggšg.hh
"

4 
Çme¥aû
 
	gskl
 {

6 
ty³
 
lookup
(cÚ¡ 
SŒšg
& 
Çme
) {

7 cÚ¡‡uto& 
	g·œ
 : ::
skl_bË
)

8 ià(
Çme
.
is_´efix_of
(
·œ
.
£cÚd
.name))

9  
·œ
.
fœ¡
;

11  
	gskl
::
ty³
::
unknown
;

14 cÚ¡ 
	gskl_bË_t
& 
lookup
(
ty³
 
t
) {

15 cÚ¡‡uto& 
	g·œ
 = ::
skl_bË
.
fšd
(
t
);

17 ià(
	g·œ
 =ğ::
skl_bË
.
ûnd
()) {

18 
Loggšg
::
bugf
("skÈlookup:y³ %d‚Ù found", 
t
);

19  ::
skl_bË
.
fšd
(
ty³
::
unknown
)->
£cÚd
;

22  
	g·œ
->
	g£cÚd
;

25 
	gskl
::
ty³
 
äom_št
(
¢
) {

26 cÚ¡‡uto& 
·œ
 : ::
skl_bË
)

27 ià(()
·œ
.
fœ¡
 =ğ
¢
)

28  
·œ
.
fœ¡
;

30  
	gskl
::
ty³
::
unknown
;

33 
num_skls
() {

34  
	gskl_bË
.
size
()-1;

	@src/skills.cc

28 
	~<veùÜ
>

30 
	~"aù.hh
"

31 
	~"¬gum’t.hh
"

32 
	~"Ch¬aù”.hh
"

33 
	~"deş¬e.hh
"

34 
	~"FÏgs.hh
"

35 
	~"FÜm©.hh
"

36 
	~"š‹½.hh
"

37 
	~"lookup.hh
"

38 
	~"loÙv2.hh
"

39 
	~"magic.hh
"

40 
	~"memÜy.hh
"

41 
	~"m”c.hh
"

42 
	~"PÏy”.hh
"

43 
	~"¿ndom.hh
"

44 
	~"Room.hh
"

45 
	~"SŒšg.hh
"

46 
	~"bËs.hh
"

49 
boŞ
 
	$com¶‘ed_group
(
Ch¬aù”
 *
ch
, 
gn
)

51 ià(
ch
->
gud
 =ğ
Gud
::
nÚe
)

52  
çl£
;

54 ià(
ch
->
pcd©a
->
group_known
[
gn
])

55  
Œue
;

57 cÚ¡‡uto& 
¥–l
 : 
group_bË
[
gn
].
¥–ls
) {

58 
ngn
 = 
	`group_lookup
(
¥–l
);

60 ià(
ngn
 >= 0) {

61 ià(
group_bË
[
ngn
].
¿tšg
[
ch
->
gud
] <= 0)

64 ià(!
	`com¶‘ed_group
(
ch
, 
ngn
))

65  
çl£
;

70 ià(
	`g‘_Ë¬Ãd
(
ch
, 
skl
::
	`lookup
(
¥–l
)) <= 0)

71  
çl£
;

74  
Œue
;

75 
	}
}

78 
	$comp_grou²ames
(cÚ¡ *
gn1
, cÚ¡ *
gn2
)

80  
	`¡rcmp
(
group_bË
[*((*è
gn1
)].
Çme
, group_bË[*((*è
gn2
)].name);

81 
	}
}

84 
	ss_¥–l_šfo
 {

85 
	mskl
::
ty³
ype;

86 
	mËv–
;

90 
	$comp_¥–ls
(cÚ¡ *
¢1
, cÚ¡ *
¢2
)

92 cÚ¡ 
s_¥–l_šfo
 *
si1
 = (s_¥–l_šfØ*)
¢1
;

93 cÚ¡ 
s_¥–l_šfo
 *
si2
 = (s_¥–l_šfØ*)
¢2
;

94 
Ëv–_diff
 = 
si1
->
Ëv–
 - 
si2
->level;

96 ià(
Ëv–_diff
 != 0)

97  
Ëv–_diff
;

99  
	`¡rcmp
(
skl
::
	`lookup
(
si1
->
ty³
).
Çme
, skl::lookup(
si2
->type).name);

100 
	}
}

111 
	$do_¥–ls
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

113 
mš_Ëv–
 = 1;

114 
max_Ëv–
 = 
LEVEL_HERO
;

115 
group
 = -1;

116 
j
;

117 
group_li¡
[
group_bË
.
	`size
()];

118 
ngroups
 = 0;

119 
s_¥–l_šfo
 
¥–l_li¡
[
skl_bË
.
	`size
()-1];

120 
n¥–ls
 = 0;

121 
SŒšg
 
¬g
;

122 
cŞs
 = 0;

123 
pos
 = 18;

124 
boŞ
 
found
 = 
çl£
;

125 
boŞ
 
Ãw_Ëv–
 = 
Œue
;

126 
SŒšg
 
bufãr
;

127 
boŞ
 
»ached_¶ay”_Ëv–
 = 
çl£
;

129 ià(
ch
->
	`is_Åc
()) {

130 
	`¡c
("You know‡Îh© you‚“d,ru¡ me. ;)\n", 
ch
);

135 ià(
¬gum’t
.
	`em±y
()) {

136 
	`do_¥–ls
(
ch
, "1");

143 
gn
 = 
	`group_lookup
("©ck"); gÀ< 
group_bË
.
	`size
(); gn++) {

144 
group_li¡
[
ngroups
++] = 
gn
;

148 
	`qsÜt
(
group_li¡
, 
ngroups
, (), 
comp_grou²ames
);

151 ià(
¬gum’t
.
	`is_´efix_of
("groups")) {

152 
	`¡c
("Spell groups (* = gained):\n"

153 "--------------------------\n", 
ch
);

155 
j
 = 0; j < 
ngroups
; j++) {

156 
gn
 = 
group_li¡
[
j
];

158 ià(
cŞs
 > 0)

159 
	`¡c
(" ", 
ch
);

161 
	`±c
(
ch
, "%ø%-22s", ch->
pcd©a
->
group_known
[
gn
] ? '*' : ' ', 
group_bË
[gn].
Çme
);

163 ià(++
cŞs
 >= 3) {

164 
	`¡c
("\n", 
ch
);

165 
cŞs
 = 0;

169 ià(
cŞs
 > 0)

170 
	`¡c
("\n", 
ch
);

176 
j
 = 0; j < 
ngroups
; j++) {

177 
gn
 = 
group_li¡
[
j
];

179 ià(
¬gum’t
 =ğ
group_bË
[
gn
].
Çme
) {

181 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

182 
group
 = 
gn
;

183 
found
 = 
Œue
;

189 
SŒšg
 
¥–l_Çme
;

191 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

193 ià(!
found
 && !
¬g
.
	`is_numb”
()) {

194 
¥–l_Çme
 = 
¬g
;

195 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

199 ià(
¬g
.
	`is_numb”
()) {

200 
mš_Ëv–
 = 
	`©oi
(
¬g
);

202 ià(
mš_Ëv–
 < 0 || mš_Ëv– > 
LEVEL_HERO
) {

203 
	`¡c
("Th©' nÙ‡ v®id mšimum†ev–.\n", 
ch
);

207 ià(!
¬gum’t
.
	`em±y
()) {

208 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

210 ià(
¬g
.
	`is_numb”
()) {

211 
max_Ëv–
 = 
	`©oi
(
¬g
);

213 ià(
max_Ëv–
 < 
mš_Ëv–
)

214 
max_Ëv–
 = 
mš_Ëv–
;

215 ià(
max_Ëv–
 > 
LEVEL_HERO
) {

216 
	`¡c
("Th©' nÙ‡ v®id maximum†ev–.\n", 
ch
);

224 ià(
group
 != -1) {

226 cÚ¡‡uto& 
¥–l
 : 
group_bË
[
group
].
¥–ls
) {

227 
skl
::
ty³
y³ = skl::
	`lookup
(
¥–l
);

229 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

232 
Ëv–
 = 
	`g‘_u§bË_Ëv–
(
ty³
, 
ch
->
gud
);

234 ià(
Ëv–
 < 
mš_Ëv–
 || 
max_Ëv–
 <†evel)

237 
¥–l_li¡
[
n¥–ls
].
ty³
 =ype;

238 
¥–l_li¡
[
n¥–ls
].
Ëv–
 =†evel;

239 
n¥–ls
++;

240 
found
 = 
Œue
;

245 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

246 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

247 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

249 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

252 
Ëv–
 = 
	`g‘_u§bË_Ëv–
(
ty³
, 
ch
->
gud
);

254 ià(
Ëv–
 < 
mš_Ëv–


255 || 
max_Ëv–
 < 
Ëv–


256 || 
’Œy
.
¥–l_fun
 =ğ
¥–l_nuÎ
)

259 ià(
¥–l_Çme
.
	`em±y
()) {

260 ià(
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) <= 0

261 || (
’Œy
.
»mÜt_gud
 !ğ
Gud
::
nÚe
 && !
	`IS_IMMORTAL
(
ch
)

262 && 
ch
->
gud
 !ğ
’Œy
.
»mÜt_gud
 && !
	`HAS_EXTRACLASS
(ch, 
ty³
)))

265 ià(!
’Œy
.
Çme
.
	`has_wÜds
(
¥–l_Çme
))

268 
found
 = 
Œue
;

269 
¥–l_li¡
[
n¥–ls
].
ty³
 =ype;

270 
¥–l_li¡
[
n¥–ls
].
Ëv–
 =†evel;

271 
n¥–ls
++;

275 ià(!
found
) {

277 ià(
mš_Ëv–
 =ğ1 && 
max_Ëv–
 =ğ
LEVEL_HERO
 && 
¥–l_Çme
.
	`em±y
())

278 
	`¡c
("You know‚Ø¥–ls.\n", 
ch
);

280 
	`¡c
("No spell group ofhat‚ame‡nd\n"

281 "nØ¥–l w™hh©‚amªd/Ü†ev– found.\n", 
ch
);

287 ià(
group
 != -1) {

288 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("S³Î š grou°'%s':\n\n", 
group_bË
[
group
].
Çme
);

292 ià(
n¥–ls
 > 0)

293 
	`qsÜt
(
¥–l_li¡
, 
n¥–ls
, (¥–l_li¡[0]), 
comp_¥–ls
);

296 
Ëv–
 = -1;

298 
j
 = 0; j < 
n¥–ls
; j++) {

299 ià(
¥–l_li¡
[
j
].
Ëv–
 !=†evel) {

300 
Ãw_Ëv–
 = 
Œue
;

301 
Ëv–
 = 
¥–l_li¡
[
j
].level;

303 ià(
cŞs
 > 0) {

304 
bufãr
 += "\n";

305 
cŞs
 = 0;

308 ià(
Ëv–
 > 
ch
->Ëv– && !
»ached_¶ay”_Ëv–
) {

309 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("Lev– %3d: %  (you¸Ëv–)\n", 
ch
->
Ëv–
,

311 
»ached_¶ay”_Ëv–
 = 
Œue
;

315 ià(
cŞs
 == 0) {

316 
SŒšg
 
buf
 = 
FÜm©
::
	`fÜm©
("Lev– %3d: ", 
Ëv–
);

318 ià(!
Ãw_Ëv–
)

319 
buf
 = 
FÜm©
::
	`fÜm©
("%*s", buf.
	`size
(), " ");

321 
Ãw_Ëv–
 = 
çl£
;

322 
bufãr
 +ğ
buf
;

325 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("%*s", 24 - 
pos
, " ");

328 
skl
::
ty³
y³ = 
¥–l_li¡
[
j
].type;

329 cÚ¡‡uto& 
’Œy
 = 
skl
::
	`lookup
(
ty³
);

331 ià(
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) <= 0

332 || (
’Œy
.
»mÜt_gud
 !ğ
Gud
::
nÚe
 && !
	`IS_IMMORTAL
(
ch
)

333 && 
ch
->
gud
 !ğ
’Œy
.
»mÜt_gud
 && !
	`HAS_EXTRACLASS
(ch, 
ty³
)))

334 
bufãr
 += "[not gained] ";

335 ià(
ch
->
Ëv–
 <†evel)

336 
bufãr
 += "[ ] ";

338 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("[{V%3d%% %3d Ma{x] ", 
	`g‘_Ë¬Ãd
(
ch
, 
ty³
), 
	`g‘_skl_co¡
(ch,ype));

340 
FÜm©
::
	`¥rštf
(
¬g
, "{C%-1.20s{x", 
’Œy
.
Çme
);

341 
bufãr
 +ğ
¬g
;

343 ià(++
cŞs
 < 2)

344 
pos
 = 
	`¡¾’
(
¬g
);

346 
bufãr
 += "\n";

347 
cŞs
 = 0;

351 ià(
cŞs
 > 0) {

352 
bufãr
 += "\n";

353 
cŞs
 = 0;

356 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

357 
	}
}

366 
	$do_skls
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

368 
mš_Ëv–
 = 1;

369 
max_Ëv–
 = 
LEVEL_HERO
;

370 
j
;

371 
s_¥–l_šfo
 
skl_li¡
[
skl_bË
.
	`size
()-1];

372 
nskls
 = 0;

373 
SŒšg
 
buf
;

374 
cŞs
 = 0;

375 
pos
 = 18;

376 
boŞ
 
found
 = 
çl£
;

377 
boŞ
 
Ãw_Ëv–
 = 
Œue
;

378 
SŒšg
 
bufãr
;

379 
boŞ
 
»ached_¶ay”_Ëv–
 = 
çl£
;

381 ià(
ch
->
	`is_Åc
()) {

382 
	`¡c
("You know‡Îh© you‚“d,ru¡ me. ;)\n", 
ch
);

387 ià(
¬gum’t
.
	`em±y
()) {

388 
	`do_skls
(
ch
, "1");

393 
SŒšg
 
skl_Çme
;

395 
SŒšg
 
¬g
;

396 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

398 ià(!
¬g
.
	`is_numb”
()) {

399 
skl_Çme
 = 
¬g
;

400 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

404 ià(
¬g
.
	`is_numb”
()) {

405 
mš_Ëv–
 = 
	`©oi
(
¬g
);

407 ià(
mš_Ëv–
 < 1)

408 
mš_Ëv–
 = 1;

409 ià(
mš_Ëv–
 > 
LEVEL_HERO
)

410 
mš_Ëv–
 = 
LEVEL_HERO
;

412 ià(!
¬gum’t
.
	`em±y
()) {

413 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

415 ià(
¬g
.
	`is_numb”
()) {

416 
max_Ëv–
 = 
	`©oi
(
¬g
);

418 ià(
max_Ëv–
 < 
mš_Ëv–
)

419 
max_Ëv–
 = 
mš_Ëv–
;

420 ià(
max_Ëv–
 > 
LEVEL_HERO
)

421 
max_Ëv–
 = 
LEVEL_HERO
;

427 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

428 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

429 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

431 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

434 
Ëv–
 = 
	`g‘_u§bË_Ëv–
(
ty³
, 
ch
->
gud
);

436 ià(
Ëv–
 < 
mš_Ëv–


437 || 
max_Ëv–
 < 
Ëv–


438 || 
’Œy
.
¥–l_fun
 !ğ
¥–l_nuÎ
)

441 ià(
skl_Çme
.
	`em±y
()) {

442 ià(
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) <= 0

443 || (
’Œy
.
»mÜt_gud
 !ğ
Gud
::
nÚe
 && !
	`IS_IMMORTAL
(
ch
)

444 && 
ch
->
gud
 !ğ
’Œy
.
»mÜt_gud
 && !
	`HAS_EXTRACLASS
(ch, 
ty³
)))

447 ià(!
’Œy
.
Çme
.
	`has_wÜds
(
skl_Çme
))

450 
found
 = 
Œue
;

451 
skl_li¡
[
nskls
].
ty³
 =ype;

452 
skl_li¡
[
nskls
].
Ëv–
 =†evel;

453 
nskls
++;

456 ià(!
found
) {

458 ià(
mš_Ëv–
 =ğ1 && 
max_Ëv–
 =ğ
LEVEL_HERO
 && 
skl_Çme
.
	`em±y
())

459 
	`¡c
("You know‚Øskls.\n", 
ch
);

461 
	`¡c
("NØskl oàth©‚amfound.\n", 
ch
);

468 ià(
nskls
 > 0)

469 
	`qsÜt
(
skl_li¡
, 
nskls
, (skl_li¡[0]), 
comp_¥–ls
);

472 
Ëv–
 = -1;

474 
j
 = 0; j < 
nskls
; j++) {

475 ià(
skl_li¡
[
j
].
Ëv–
 !=†evel) {

476 
Ãw_Ëv–
 = 
Œue
;

477 
Ëv–
 = 
skl_li¡
[
j
].level;

479 ià(
cŞs
 > 0) {

480 
bufãr
 += "\n";

481 
cŞs
 = 0;

484 ià(
Ëv–
 > 
ch
->Ëv– && !
»ached_¶ay”_Ëv–
) {

485 
FÜm©
::
	`¥rštf
(
buf
, "Lev– %3d: %  (you¸Ëv–)\n", 
ch
->
Ëv–
,

487 
bufãr
 +ğ
buf
;

488 
»ached_¶ay”_Ëv–
 = 
Œue
;

492 ià(
cŞs
 == 0) {

493 
FÜm©
::
	`¥rštf
(
buf
, "Lev– %3d: ", 
Ëv–
);

495 ià(!
Ãw_Ëv–
)

496 
FÜm©
::
	`¥rštf
(
buf
, "%*s", ()
	`¡¾’
(buf), " ");

498 
Ãw_Ëv–
 = 
çl£
;

499 
bufãr
 +ğ
buf
;

502 
FÜm©
::
	`¥rštf
(
buf
, "%*s", 24 - 
pos
, " ");

503 
bufãr
 +ğ
buf
;

506 
skl
::
ty³
y³ = 
skl_li¡
[
j
].type;

507 cÚ¡‡uto& 
’Œy
 = 
skl
::
	`lookup
(
ty³
);

509 ià(
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) <= 0

510 || (
’Œy
.
»mÜt_gud
 !ğ
Gud
::
nÚe
 && !
	`IS_IMMORTAL
(
ch
)

511 && 
ch
->
gud
 !ğ
’Œy
.
»mÜt_gud
 && !
	`HAS_EXTRACLASS
(ch, 
ty³
)))

512 
FÜm©
::
	`¥rštf
(
buf
, "[not gained] ");

513 ià(
ch
->
Ëv–
 <†evel)

514 
FÜm©
::
	`¥rštf
(
buf
, "[ ] ");

516 
FÜm©
::
	`¥rštf
(
buf
, "[{G%3d%% %3d St{x] ", 
	`g‘_Ë¬Ãd
(
ch
, 
ty³
), 
	`g‘_skl_co¡
(ch,ype));

518 
FÜm©
::
	`¥rštf
(
¬g
, "{H%-1.20s{x", 
’Œy
.
Çme
);

519 
buf
 +ğ
¬g
;

521 ià(++
cŞs
 < 2)

522 
pos
 = 
	`¡¾’
(
¬g
);

524 
buf
 += "\n";

525 
cŞs
 = 0;

528 
bufãr
 +ğ
buf
;

531 ià(
cŞs
 > 0) {

532 
bufãr
 += "\n";

533 
cŞs
 = 0;

536 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

537 
	}
}

540 
	$do_Ëv–s
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

542 
SŒšg
 
li¡
[
LEVEL_HERO
];

543 
cŞumns
[
LEVEL_HERO
] = {0};

544 
x
, 
y
;

545 
buf
[
MAX_STRING_LENGTH
];

546 
SŒšg
 
bufãr
;

548 ià(
ch
->
	`is_Åc
())

551 
SŒšg
 
¬g
;

552 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

554 ià(
¬g
.
	`em±y
()) {

555 ià(!
	`IS_IMMORTAL
(
ch
)) {

556 
	`¡c
("Wh© cÏs dØyou wªˆËv– infØÚ?\n", 
ch
);

560 
	`¡c
("Skl/S³Î Mag CË Th˜W¬ NeøPdÀB¬ Rª\n\n", 
ch
);

562 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

563 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

564 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

566 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

569 ià(
’Œy
.
»mÜt_gud
 !ğ
Gud
::
nÚe
)

573 
boŞ
 
gašabË
 = 
çl£
;

574 
i
 = 
Gud
::
fœ¡
; i < Gud::
size
; i++)

575 ià(
	`g‘_u§bË_Ëv–
(
ty³
, (
Gud
)
i
) >= 0) {

576 
gašabË
 = 
Œue
;

580 ià(!
gašabË
)

583 
FÜm©
::
	`¥rštf
(
buf
, "%-21s", 
’Œy
.
Çme
);

584 
bufãr
 +ğ
buf
;

586 
x
 = 
Gud
::
fœ¡
; x < Gud::
size
; x++) {

587 
Ëv–
 = 
	`g‘_u§bË_Ëv–
(
ty³
, (
Gud
)
x
);

588 ià(
Ëv–
 < 0 ||†ev– > 
LEVEL_HERO
)

589 
FÜm©
::
	`¥rštf
(
buf
, "{c NA{x");

591 
FÜm©
::
	`¥rštf
(
buf
, "%4d", 
Ëv–
);

593 
bufãr
 +ğ
buf
;

596 
FÜm©
::
	`¥rštf
(
buf
, "\n");

597 
bufãr
 +ğ
buf
;

600 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

605 ià(
¬g
.
	`is_´efix_of
("»mÜt"è&& 
	`IS_IMMORTAL
(
ch
)) {

606 
	`¡c
(" Lev–/T¿šs\n", 
ch
);

607 
	`¡c
(" Mag CË Th˜ W¬ Neø PdÀ B¬ Rª\n", 
ch
);

609 
x
 = 
Gud
::
fœ¡
; x < Gud::
size
; x++) {

610 
FÜm©
::
	`¥rštf
(
buf
, "{W% Skls:{x\n", 
gud_bË
[
x
].
Çme
.
	`ÿp™®ize
());

611 
bufãr
 +ğ
buf
;

613 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

614 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

615 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

617 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

620 ià(
’Œy
.
»mÜt_gud
 !ğ
x
)

623 
FÜm©
::
	`¥rštf
(
buf
, " {g%-19s{x", 
’Œy
.
Çme
);

624 
bufãr
 +ğ
buf
;

626 
y
 = 
Gud
::
fœ¡
; y < Gud::
size
; y++) {

627 
Ëv–
 = 
	`g‘_u§bË_Ëv–
(
ty³
, (
Gud
)
y
);

628 ià(
Ëv–
 < 0 ||†ev– > 
LEVEL_HERO
)

629 
FÜm©
::
	`¥rštf
(
buf
, " {TNA{c/{HNA {x");

631 
FÜm©
::
	`¥rštf
(
buf
, "{C%3d{c/{G%-3d{x", 
Ëv–
, 
’Œy
.
¿tšg
[
y
]);

633 
bufãr
 +ğ
buf
;

636 
FÜm©
::
	`¥rštf
(
buf
, "\n");

637 
bufãr
 +ğ
buf
;

641 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

645 
Gud
 
gud
 = 
	`gud_lookup
(
¬g
);

647 ià(
gud
 =ğ
Gud
::
nÚe
) {

648 
	`¡c
("Inv®id cÏss.\n", 
ch
);

652 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

653 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

654 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

656 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

659 
Ëv–
 = 
	`g‘_u§bË_Ëv–
(
ty³
, 
gud
);

661 ià(
Ëv–
 < 0)

664 ià(
Ëv–
 < 
LEVEL_HERO
 &&

665 
’Œy
.
¥–l_fun
 !ğ
¥–l_nuÎ
) {

666 
FÜm©
::
	`¥rštf
(
buf
, "{G%-20  {C%3d{x {Tmªa{x ", 
’Œy
.
Çme
,

667 
’Œy
.
mš_mªa
);

669 ià(
li¡
[
Ëv–
].
	`em±y
())

670 
FÜm©
::
	`¥rštf
(
li¡
[
Ëv–
], "\n{HLev– %2d: %s",†ev–, 
buf
);

672 ià(++
cŞumns
[
Ëv–
] % 2 == 0)

673 
li¡
[
Ëv–
] += "\n ";

675 
li¡
[
Ëv–
] +ğ
buf
;

680 
Ëv
 = 0;†ev < 
LEVEL_HERO
;†ev++)

682 
bufãr
 +ğ
li¡
[
Ëv
];

684 
bufãr
 += "\n";

687 
Ëv
 = 0;†ev < 
LEVEL_HERO
;†ev++) {

688 
cŞumns
[
Ëv
] = 0;

689 
li¡
[
Ëv
].
	`ş—r
();

692 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

693 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

694 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

696 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

699 
Ëv
 = 
	`g‘_u§bË_Ëv–
(
ty³
, 
ch
->
gud
);

701 ià(
Ëv
 < 0)

704 ià(
Ëv
 < 
LEVEL_HERO
 &&

705 
’Œy
.
¥–l_fun
 =ğ
¥–l_nuÎ
) {

706 
FÜm©
::
	`¥rštf
(
buf
, "{G%-20  {x ", 
’Œy
.
Çme
);

708 ià(
li¡
[
Ëv
].
	`em±y
())

709 
FÜm©
::
	`¥rštf
(
li¡
[
Ëv
], "\n{HLev– %2d: %s{x",†ev, 
buf
);

711 ià(++
cŞumns
[
Ëv
] % 2 == 0)

712 
li¡
[
Ëv
] += "\n ";

714 
li¡
[
Ëv
] +ğ
buf
;

719 
Ëv
 = 0;†ev < 
LEVEL_HERO
;†ev++)

721 
bufãr
 +ğ
li¡
[
Ëv
];

723 
bufãr
 += "\n";

724 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

725 
	}
}

728 
	$exp_³r_Ëv–
(
Ch¬aù”
 *
ch
, 
pošts
)

730 
šc
;

731 
ex¶
;

733 ià(
ch
->
	`is_Åc
())

736 
ex¶
 = 1000;

738 ià(
pošts
 >= 40) {

740 
šc
 = 500;

741 
pošts
 -= 40;

743 
pošts
 >= 10) {

744 
ex¶
 +ğ
šc
;

745 
pošts
 -= 10;

747 ià(
pošts
 >= 10) {

748 
ex¶
 +ğ
šc
;

749 
šc
 *= 2;

750 
pošts
 -= 10;

754 
ex¶
 +ğ
pošts
 * 
šc
 / 10;

757 ià(
ch
->
gud
 !ğ
Gud
::
nÚe
) {

758 
ex¶
 *ğ
pc_¿û_bË
[
ch
->
¿û
].
gud_muÉ
[ch->
gud
];

759 
ex¶
 /= 100;

769  
ex¶
;

770 
	}
}

773 
	$do_groups
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

775 
buf
[100];

777 ià(
ch
->
	`is_Åc
())

780 
cŞ
 = 0;

782 ià(
¬gum’t
.
	`em±y
()) {

784 
gn
 = 0; gÀ< 
group_bË
.
	`size
(); gn++) {

785 ià(
ch
->
pcd©a
->
group_known
[
gn
]) {

786 
FÜm©
::
	`¥rštf
(
buf
, "%-18 ", 
group_bË
[
gn
].
Çme
);

787 
	`¡c
(
buf
, 
ch
);

789 ià(++
cŞ
 % 3 == 0)

790 
	`¡c
("\n", 
ch
);

794 ià(
cŞ
 % 3 != 0)

795 
	`¡c
("\n", 
ch
);

797 
FÜm©
::
	`¥rštf
(
buf
, "C»©iÚ…ošts: %d\n", 
ch
->
pcd©a
->
pošts
);

798 
	`¡c
(
buf
, 
ch
);

802 ià(
¬gum’t
 == "all") {

803 
gn
 = 0; gÀ< 
group_bË
.
	`size
(); gn++) {

804 
FÜm©
::
	`¥rštf
(
buf
, "%-18 ", 
group_bË
[
gn
].
Çme
);

805 
	`¡c
(
buf
, 
ch
);

807 ià(++
cŞ
 % 3 == 0)

808 
	`¡c
("\n", 
ch
);

811 ià(
cŞ
 % 3 != 0)

812 
	`¡c
("\n", 
ch
);

818 
gn
 = 
	`group_lookup
(
¬gum’t
);

820 ià(
gn
 == -1) {

821 
	`¡c
("NØgrou°oàth©‚amexi¡.\n", 
ch
);

822 
	`¡c
(

823 "Ty³ 'group ®l' o¸'šfØ®l' fÜ‡ fuÎ†i¡šg.\n", 
ch
);

827 
SŒšg
 
¥–l
 : 
group_bË
[
gn
].
¥–ls
) {

828 
FÜm©
::
	`¥rštf
(
buf
, "%-18 ", 
¥–l
);

829 
	`¡c
(
buf
, 
ch
);

831 ià(++
cŞ
 % 3 == 0)

832 
	`¡c
("\n", 
ch
);

835 ià(
cŞ
 % 3 != 0)

836 
	`¡c
("\n", 
ch
);

837 
	}
}

840 
	$check_im´ove
(
Ch¬aù”
 *
ch
, 
skl
::
ty³
y³, 
boŞ
 
sucûss
, 
muÉl›r
)

842 
chªû
;

843 
buf
[100];

844 
xp
;

846 ià(
ch
->
	`is_Åc
())

849 ià(
ch
->
gud
 =ğ
Gud
::
nÚe
)

852 ià(
ch
->
Ëv–
 < 
	`g‘_u§bË_Ëv–
(
ty³
, ch->
gud
)

853 || 
skl
::
	`lookup
(
ty³
).
¿tšg
[
ch
->
gud
] == 0

854 || 
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) == 0

855 || 
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) == 100)

859 
chªû
 = 10 * 
št_­p
[
	`GET_ATTR_INT
(
ch
)].
Ë¬n
;

860 
chªû
 /ğ(
muÉl›r


861 * 
skl
::
	`lookup
(
ty³
).
¿tšg
[
ch
->
gud
]

863 
chªû
 +ğ
ch
->
Ëv–
;

865 ià(
skl
::
	`lookup
(
ty³
).
»mÜt_gud
 !ğ
Gud
::
nÚe
)

866 { 
chªû
 *= 2; chance /= 3; }

869 ià(
	`numb”_¿nge
(1, 1000è> 
chªû
 && 
muÉl›r
 != -1)

873 
xp
 = 2 * 
skl
::
	`lookup
(
ty³
).
¿tšg
[
ch
->
gud
];

881 ià(
sucûss
) {

882 
chªû
 = 
	`URANGE
(5, 100 - 
	`g‘_Ë¬Ãd
(
ch
, 
ty³
), 95);

884 ià(
	`numb”_³rûÁ
(è< 
chªû
 || 
muÉl›r
 == -1) {

885 
FÜm©
::
	`¥rštf
(
buf
, "{GYou have become better‡t {H%s{G!{x\n",

886 
skl
::
	`lookup
(
ty³
).
Çme
);

887 
	`¡c
(
buf
, 
ch
);

888 
	`£t_Ë¬Ãd
(
ch
, 
ty³
, 
	`g‘_Ë¬Ãd
(ch,ype) + 1);

889 
	`gaš_exp
(
ch
, 
xp
);

893 
chªû
 = 
	`URANGE
(5, 
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) / 2, 30);

895 ià(
	`numb”_³rûÁ
(è< 
chªû
 || 
muÉl›r
 == -1) {

896 
FÜm©
::
	`¥rštf
(
buf
,

898 
skl
::
	`lookup
(
ty³
).
Çme
);

899 
	`¡c
(
buf
, 
ch
);

900 
	`£t_Ë¬Ãd
(
ch
, 
ty³
, 
	`g‘_Ë¬Ãd
(ch,y³è+ 
	`numb”_¿nge
(1, 3));

901 
	`gaš_exp
(
ch
, 
xp
);

904 
	}
}

907 
	$group_lookup
(cÚ¡ 
SŒšg
& 
Çme
)

909 
gn
 = 0; gÀ< 
group_bË
.
	`size
(); gn++)

910 ià(
Çme
 =ğ
group_bË
[
gn
].name)

911  
gn
;

914 
	}
}

917 
	$gn_add
(
Ch¬aù”
 *
ch
, 
gn
)

919 
ch
->
pcd©a
->
group_known
[
gn
] = 
Œue
;

921 cÚ¡‡uto& 
¥–l
 : 
group_bË
[
gn
].
¥–ls
)

922 
	`group_add
(
ch
, 
¥–l
, 
çl£
);

923 
	}
}

926 
	$gn_»move
(
Ch¬aù”
 *
ch
, 
gn
)

928 
ch
->
pcd©a
->
group_known
[
gn
] = 
çl£
;

930 cÚ¡‡uto& 
¥–l
 : 
group_bË
[
gn
].
¥–ls
)

931 
	`group_»move
(
ch
, 
¥–l
);

932 
	}
}

935 
	$group_add
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
Çme
, 
boŞ
 
deduù
)

937 ià(
ch
->
	`is_Åc
())

940 ià(
ch
->
gud
 =ğ
Gud
::
nÚe
)

943 
skl
::
ty³
y³ = skl::
	`lookup
(
Çme
);

945 ià(
ty³
 !ğ
skl
::ty³::
unknown
) {

946 ià(
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) == 0) {

947 
	`£t_Ë¬Ãd
(
ch
, 
ty³
, 1);

948 
	`£t_evŞutiÚ
(
ch
, 
ty³
, 1);

950 ià(
deduù
)

951 
ch
->
pcd©a
->
pošts
 +ğ
skl
::
	`lookup
(
ty³
).
¿tšg
[ch->
gud
];

958 
gn
 = 
	`group_lookup
(
Çme
);

960 ià(
gn
 != -1) {

961 ià(
ch
->
pcd©a
->
group_known
[
gn
] =ğ
çl£
) {

962 
ch
->
pcd©a
->
group_known
[
gn
] = 
Œue
;

964 ià(
deduù
)

965 
ch
->
pcd©a
->
pošts
 +ğ
group_bË
[
gn
].
¿tšg
[ch->
gud
];

968 
	`gn_add
(
ch
, 
gn
);

970 
	}
}

974 
	$group_»move
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
Çme
)

976 
skl
::
ty³
y³ = skl::
	`lookup
(
Çme
);

978 ià(
ty³
 !ğ
skl
::ty³::
unknown
) {

979 
	`£t_Ë¬Ãd
(
ch
, 
ty³
, 0);

980 
	`£t_evŞutiÚ
(
ch
, 
ty³
, 1);

985 
gn
 = 
	`group_lookup
(
Çme
);

987 ià(
gn
 !ğ-1 && 
ch
->
pcd©a
->
group_known
[gn] =ğ
Œue
) {

988 
ch
->
pcd©a
->
group_known
[
gn
] = 
çl£
;

989 
	`gn_»move
(
ch
, 
gn
);

991 
	}
}

993 
	$£t_Ë¬Ãd
(
Ch¬aù”
 *
ch
, 
skl
::
ty³
 
¢
, 
v®ue
) {

994 ià(
ch
->
	`is_Åc
(è|| 
¢
 =ğ
skl
::
ty³
::
unknown
)

997 
ch
->
pcd©a
->
Ë¬Ãd
[()
¢
] = 
	`URANGE
(0, 
v®ue
, 100);

998 
	}
}

1000 
	$g‘_Ë¬Ãd
(cÚ¡ 
Ch¬aù”
 *
ch
, 
skl
::
ty³
 
¢
) {

1001 ià(
ch
->
	`is_Åc
(è|| 
¢
 =ğ
skl
::
ty³
::
unknown
)

1004  
ch
->
pcd©a
->
Ë¬Ãd
[()
¢
];

1005 
	}
}

1007 
	$g‘_u§bË_Ëv–
(
skl
::
ty³
 
¢
, 
Gud
 
gud
) {

1008 cÚ¡‡uto& 
sk
 = 
skl
::
	`lookup
(
¢
);

1010 ià(
gud
 =ğ
Gud
::
nÚe
) {

1011 
highe¡
 = 0;

1014 
i
 = 
Gud
::
fœ¡
; i < Gud::
size
; i++) {

1016 ià(
sk
.
skl_Ëv–
[
i
] == -1)

1019 ià(
sk
.
skl_Ëv–
[
i
] > 
highe¡
)

1020 
highe¡
 = 
sk
.
skl_Ëv–
[
i
];

1023  
highe¡
;

1026  
sk
.
skl_Ëv–
[
gud
];

1027 
	}
}

1030 
	$g‘_skl_Ëv–
(cÚ¡ 
Ch¬aù”
 *
ch
, 
skl
::
ty³
 
¢
)

1032 
skl
 = 0;

1034 ià(
¢
 =ğ
skl
::
ty³
::
unknown
)

1035 
skl
 = 
ch
->
Ëv–
 * 5 / 2;

1036 ià(!
ch
->
	`is_Åc
()) {

1037 ià(
ch
->
Ëv–
 < 
	`g‘_u§bË_Ëv–
(
¢
, ch->
gud
))

1038 
skl
 = 0;

1040 
skl
 = 
	`g‘_Ë¬Ãd
(
ch
, 
¢
);

1043 
¢
) {

1044 
skl
::
ty³
::
dodge
:

1045 ià(
ch
->
off_æags
.
	`has
(
OFF_DODGE
)è
skl
 = 10 + ch->
Ëv–
; ;

1046 
skl
::
ty³
::
·¼y
:

1047 ià(
ch
->
off_æags
.
	`has
(
OFF_PARRY
)è
skl
 = 10 + ch->
Ëv–
; ;

1048 
skl
::
ty³
::
kick
:

1049 ià(
ch
->
off_æags
.
	`has
(
OFF_KICK
)è
skl
 = 10 + ch->
Ëv–
; ;

1050 
skl
::
ty³
::
£cÚd_©ck
:

1051 ià(
ch
->
aù_æags
.
	`has_ªy_of
(
ACT_WARRIOR
|
ACT_THIEF
)è
skl
 = 25 + ch->
Ëv–
; ;

1052 
skl
::
ty³
::
thœd_©ck
:

1053 ià(
ch
->
aù_æags
.
	`has
(
ACT_WARRIOR
)è
skl
 = 15 + ch->
Ëv–
; ;

1054 
skl
::
ty³
::
fou¹h_©ck
:

1055 ià(
ch
->
aù_æags
.
	`has
(
ACT_WARRIOR
)è
skl
 = 2 * (ch->
Ëv–
 - 60); ;

1056 
skl
::
ty³
::
hªd_to_hªd
: skÈğ
ch
->
Ëv–
 * 3 / 2; ;

1057 
skl
::
ty³
::
Œ
:

1058 ià(
ch
->
off_æags
.
	`has
(
OFF_TRIP
)è
skl
 = 10 + (ch->
Ëv–
 * 3 / 2); ;

1059 
skl
::
ty³
::
dœt_kickšg
:

1060 ià(
ch
->
off_æags
.
	`has
(
OFF_KICK_DIRT
)è
skl
 = 10 + (ch->
Ëv–
 * 3 / 2); ;

1061 
skl
::
ty³
::
bash
:

1062 ià(
ch
->
off_æags
.
	`has
(
OFF_BASH
)è
skl
 = 10 + (ch->
Ëv–
 * 5 / 4); ;

1063 
skl
::
ty³
::
üush
:

1064 ià(
ch
->
off_æags
.
	`has
(
OFF_CRUSH
)è
skl
 = ch->
Ëv–
; ;

1065 
skl
::
ty³
::
di§rm
:

1066 ià(
ch
->
off_æags
.
	`has
(
OFF_DISARM
)

1067 || 
ch
->
aù_æags
.
	`has_ªy_of
(
ACT_WARRIOR
|
ACT_THIEF
)è
skl
 = 20 + (ch->
Ëv–
 * 2 / 3); ;

1068 
skl
::
ty³
::
b”£rk
:

1069 ià(
ch
->
off_æags
.
	`has
(
OFF_BERSERK
)è
skl
 = 3 * ch->
Ëv–
; ;

1070 
skl
::
ty³
::
back¡ab
:

1071 ià(
ch
->
aù_æags
.
	`has
(
ACT_THIEF
)è
skl
 = 20 + (ch->
Ëv–
 * 2); ;

1072 
skl
::
ty³
::
sh›ld_block
: skÈğ15 + 
ch
->
Ëv–
; ;

1073 
skl
::
ty³
::
»scue
: skÈğ40 + (
ch
->
Ëv–
 / 2); ;

1074 
skl
::
ty³
::
»ÿÎ
: skÈğ40 + 
ch
->
Ëv–
; ;

1075 
skl
::
ty³
::
süŞls
: skÈğ
ch
->
Ëv–
; ;

1076 
skl
::
ty³
::
huÁ
: skill = 75; ;

1077 
skl
::
ty³
::
swÜd
:

1078 
skl
::
ty³
::
dagg”
:

1079 
skl
::
ty³
::
¥—r
:

1080 
skl
::
ty³
::
maû
:

1081 
skl
::
ty³
::
axe
:

1082 
skl
::
ty³
::
æa
:

1083 
skl
::
ty³
::
wh
:

1084 
skl
::
ty³
::
pŞ—rm
: skÈğ40 + (5 * 
ch
->
Ëv–
 / 2); ;

1085 : 
skl
 = 0; ;

1089 ià(
ch
->
daze
 > 0) {

1090 ià(
skl
::
	`lookup
(
¢
).
¥–l_fun
 !ğ
¥–l_nuÎ
)

1091 
skl
 /= 2;

1093 
skl
 = 2 * skill / 3;

1096 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
cÚd™iÚ
[
COND_DRUNK
] > 10)

1097 
skl
 = 9 * skill / 10;

1099  
	`URANGE
(0, 
skl
, 100);

1100 
	}
}

1102 
	$£t_evŞutiÚ
(
Ch¬aù”
 *
ch
, 
skl
::
ty³
 
¢
, 
v®ue
) {

1103 ià(
ch
->
	`is_Åc
(è|| 
¢
 =ğ
skl
::
ty³
::
unknown
)

1106 
ch
->
pcd©a
->
evŞutiÚ
[()
¢
] = 
	`URANGE
(1, 
v®ue
, 4);

1107 
	}
}

1109 
	$g‘_evŞutiÚ
(cÚ¡ 
Ch¬aù”
 *
ch
, 
skl
::
ty³
ype)

1111 
evŞutiÚ
;

1113 ià(
ch
->
	`is_Åc
())

1114 
evŞutiÚ
 = 1;

1116 
evŞutiÚ
 = 
	`URANGE
(1, 
ch
->
pcd©a
->evŞutiÚ[()
ty³
], 4);

1118  
evŞutiÚ
;

1119 
	}
}

1121 
	$ÿn_evŞve
(
Ch¬aù”
 *
ch
, 
skl
::
ty³
ype)

1124 ià(
	`IS_IMMORTAL
(
ch
)) {

1125 
i
, 
tco¡
 = 0;

1127 
i
 = 0; i < 8; i++) {

1128 
tco¡
 +ğ
skl
::
	`lookup
(
ty³
).
evoco¡_£c
[
i
];

1129 
tco¡
 +ğ
skl
::
	`lookup
(
ty³
).
evoco¡_´i
[
i
];

1132 ià(!
tco¡
)

1134 ià(
	`g‘_evŞutiÚ
(
ch
, 
ty³
) >= 4)

1140 ià(
skl
::
	`lookup
(
ty³
).
evoco¡_£c
[
ch
->
gud
] <= 0)

1143 ià(
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) <= 0)

1147 ià(
skl
::
	`lookup
(
ty³
).
evoco¡_´i
[
ch
->
gud
] <= 0) {

1148 ià(
	`g‘_evŞutiÚ
(
ch
, 
ty³
) >= 2)

1154 ià(
	`g‘_evŞutiÚ
(
ch
, 
ty³
) >= 3)

1161 
	}
}

1163 
	$evŞve_li¡
(
Ch¬aù”
 *
ch
)

1165 
SŒšg
 
bufãr
;

1166 
ÿn
;

1167 
bufãr
 += "Currentlyƒvolvable skills‡nd spells:\n\n";

1168 
bufãr
 += "{GSkill or spell {C| {GPct {C| {GEvo {C| {GNext{x\n";

1169 
bufãr
 += "{C--------------------+-----+-----+-----{x\n";

1171 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

1172 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

1173 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

1175 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

1178 ià((
ÿn
 = 
	`ÿn_evŞve
(
ch
, 
ty³
)) == -1)

1181 ià(
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) < 1) {

1182 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("{H%-20s{C| {H0 {C| {H0 {C| {H%4d{x\n",

1183 
’Œy
.
Çme
,

1184 
’Œy
.
evoco¡_£c
[
ch
->
gud
]);

1188 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("{G%-20s{C| {G%3d {C| {G%d {C| {G",

1189 
’Œy
.
Çme
,

1190 
	`g‘_Ë¬Ãd
(
ch
, 
ty³
),

1191 
	`g‘_evŞutiÚ
(
ch
, 
ty³
));

1193 ià(
ÿn
 == 1)

1194 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("%4d{x\n",

1195 
	`g‘_evŞutiÚ
(
ch
, 
ty³
) == 1 ?

1196 
’Œy
.
evoco¡_£c
[
ch
->
gud
] :

1197 
’Œy
.
evoco¡_´i
[
ch
->
gud
]);

1199 
bufãr
 += "----{x\n";

1202 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("\nYou hav%d skÈpošt tØ¥’d.\n", 
ch
->
pcd©a
->
skÍošts
);

1203 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

1204 
	}
}

1206 
	$evŞve_šfo
(
Ch¬aù”
 *
ch
)

1208 
SŒšg
 
bufãr
;

1209 
evo_sum
[8] = {0};

1211 
bufãr
 += "Currentlyƒvolvable skills‡nd spells:\n\n";

1212 
bufãr
 += "{GSkill or spell {C|{G";

1214 
gud
 = 0; guild < 8; guild++) {

1215 
bufãr
 +ğ
gud_bË
[
gud
].
who_Çme
;

1216 
bufãr
 += "{C|{G";

1219 
bufãr
 += "\n";

1221 
bufãr
 += "{C--------------------+---+---+---+---+---+---+---+---+{x\n";

1223 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

1224 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

1225 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

1227 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

1230 
max_evo
[8] = {0};

1231 
boŞ
 
should_show
 = 
çl£
;

1233 
gud
 = 0; guild < 8; guild++) {

1234 ià(
’Œy
.
evoco¡_£c
[
gud
] > 0) {

1235 
max_evo
[
gud
]++;

1236 
should_show
 = 
Œue
;

1239 ià(
’Œy
.
evoco¡_´i
[
gud
] > 0)

1240 
max_evo
[
gud
]++;

1243 ià(!
should_show
)

1246 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("{H%-20s{C|", 
’Œy
.
Çme
);

1248 
gud
 = 0; guild < 8; guild++) {

1249 ià(
max_evo
[
gud
] == 0)

1250 
bufãr
 += " |";

1252 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("{%s %d {C|",

1253 
max_evo
[
gud
] > 1 ? "Y" : "G",

1254 
max_evo
[
gud
]+1);

1256 
evo_sum
[
gud
] +ğ
max_evo
[guild]+1;

1260 
bufãr
 += "\n";

1264 
bufãr
 += "{C--------------------+---+---+---+---+---+---+---+---+{x\n";

1266 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("{H%-20s{C|", "sum");

1268 
gud
 = 0; guild < 8; guild++)

1269 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("{G%3d{C|", 
evo_sum
[
gud
]);

1271 
bufãr
 += "\n";

1272 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

1273 
	}
}

1275 
	$do_evŞve
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1277 
SŒšg
 
which
;

1278 
co¡
, 
ÿn
, 
³rc
;

1279 
¥ecŸl
 = 0;

1281 ià(
ch
->
	`is_Åc
()) {

1282 
	`¡c
("SÜry, you¸skl ¬lim™ed.\n", 
ch
);

1286 
SŒšg
 
¬g
;

1287 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1289 ià(
¬g
.
	`em±y
()) {

1290 
	`evŞve_li¡
(
ch
);

1294 ià(
	`IS_IMMORTAL
(
ch
è&& 
¬g
 == "info") {

1295 
	`evŞve_šfo
(
ch
);

1299 
skl
::
ty³
y³ = skl::
	`lookup
(
¬g
);

1301 ià(
ty³
 =ğ
skl
::ty³::
unknown
) {

1302 
	`¡c
("NØskÈÜ s³Î byh©‚amexi¡s.\n", 
ch
);

1306 cÚ¡‡uto& 
’Œy
 = 
skl
::
	`lookup
(
ty³
);

1308 ià(
’Œy
.
¥–l_fun
 =ğ
¥–l_nuÎ
)

1309 
which
 = "skill";

1311 
which
 = "spell";

1313 ià(
	`g‘_Ë¬Ãd
(
ch
, 
ty³
è< 1 && 
¥ecŸl
 < 1) {

1314 
	`±c
(
ch
, "You havnØknowËdgoàth© %s.", 
which
);

1318 
ÿn
 = 
	`ÿn_evŞve
(
ch
, 
ty³
);

1320 ià(
ÿn
 == -1) {

1321 
	`±c
(
ch
, "That %s is‚otƒvolvable. Type 'evolve' by itself for‡†ist\n"

1322 "oàskl ªd s³Î th© cª bevŞved by you¸şass.\n", 
which
);

1326 ià(
ÿn
 == 0) {

1327 
	`±c
(
ch
, "You cªnÙƒvŞvth© % ªy high”.\n", 
which
);

1331 ià(
¥ecŸl
 == 1) {

1332 
co¡
 = 
’Œy
.
evoco¡_£c
[
ch
->
gud
];

1333 
³rc
 = 0;

1335 ià(
	`IS_IMMORTAL
(
ch
è&& 
¥ecŸl
 == 0) {

1336 
co¡
 = 0;

1337 
³rc
 = 1;

1339 ià(
	`g‘_evŞutiÚ
(
ch
, 
ty³
è=ğ1 && 
¥ecŸl
 == 0) {

1340 
co¡
 = 
’Œy
.
evoco¡_£c
[
ch
->
gud
];

1341 
³rc
 = 85;

1343 ià(
	`g‘_evŞutiÚ
(
ch
, 
ty³
è=ğ1 && 
¥ecŸl
 == 1) {

1344 
co¡
 = 
’Œy
.
evoco¡_´i
[
ch
->
gud
];

1345 
³rc
 = 0;

1348 
co¡
 = 
’Œy
.
evoco¡_´i
[
ch
->
gud
];

1349 
³rc
 = 95;

1352 ià(
ch
->
pcd©a
->
skÍošts
 < 
co¡
) {

1353 
	`±c
(
ch
, "You havnÙƒ¬Ãdƒnough skÈpošt tØevŞvth© % fu¹hur.\n", 
which
);

1357 ià(
	`g‘_Ë¬Ãd
(
ch
, 
ty³
è< 
³rc
 && 
¥ecŸl
 < 1) {

1358 
	`±c
(
ch
, "You only havehat %s‡t %d%%, you‚eed %d%%oƒvolve.\n",

1359 
which
, 
	`g‘_Ë¬Ãd
(
ch
, 
ty³
), 
³rc
);

1364 
ch
->
pcd©a
->
skÍošts
 -ğ
co¡
;

1365 
	`£t_evŞutiÚ
(
ch
, 
ty³
, 
	`g‘_evŞutiÚ
(ch,ype)+1);

1367 ià(!
	`IS_IMMORTAL
(
ch
))

1368 
	`£t_Ë¬Ãd
(
ch
, 
ty³
, 1);

1370 
	`±c
(
ch
, "Insighˆdawn Ú you‡ youƒnvisiÚ‚ew way tØu£ %s.\n", 
’Œy
.
Çme
);

1371 
	}
}

1373 
	$g‘_skl_co¡
(
Ch¬aù”
 *
ch
, 
skl
::
ty³
ype)

1375 
co¡
 = 
skl
::
	`lookup
(
ty³
).
mš_mªa
;

1388 ià(
skl
::
	`lookup
(
ty³
).
¥–l_fun
 =ğ
¥–l_nuÎ
) {

1389 iàĞ
ch
->
Ëv–
 <= 50) {

1390 
pù_max
, 
Ëv–
 = 
	`g‘_u§bË_Ëv–
(
ty³
, 
ch
->
gud
);

1391 
pù_max
 = 100 * (
ch
->
Ëv–
 -†ev–è/ 
¡d
::
	`max
(50 -†evel, 1);

1392 
co¡
 = (co¡ / 2è+ (((co¡ / 2è* 
pù_max
) / 100);

1395 ià(!
ch
->
	`is_Åc
()) {

1397 ià(
	`HAS_RAFF
(
ch
, 
RAFF_COSTLYSPELLS
))

1398 
co¡
 += cost / 5;

1401 ià(
	`HAS_RAFF
(
ch
, 
RAFF_CHEAPSPELLS
))

1402 
co¡
 -= cost / 5;

1405  
co¡
;

1406 
	}
}

1408 
boŞ
 
	$deduù_¡amša
(
Ch¬aù”
 *
ch
, 
skl
::
ty³
ype)

1410 ià(
skl
::
	`lookup
(
ty³
).
¥–l_fun
 !ğ
¥–l_nuÎ
)

1411  
çl£
;

1413 ià(
skl
::
	`lookup
(
ty³
).
mš_mªa
 <= 0)

1414  
Œue
;

1416 
¡am_co¡
 = 
	`g‘_skl_co¡
(
ch
, 
ty³
);

1427 
¡am_co¡
 -ğ¡am_co¡ * 
	`GET_ATTR
(
ch
, 
APPLY_STAM_COST_PCT
) / 100;

1431 ià(
	`GET_ATTR
(
ch
, 
SET_WARRIOR_BESERKER
) >= 4)

1432 
¡am_co¡
 -= stam_cost * 45 / 100;

1434 ià(
ch
->
¡am
 < 
¡am_co¡
) {

1435 
	`±c
(
ch
, "You‡»oØtœedØ%s.\n", 
skl
::
	`lookup
(
ty³
).
Çme
);

1436  
çl£
;

1439 
ch
->
¡am
 -ğ
¡am_co¡
;

1440  
Œue
;

1441 
	}
}

1444 
	$do_gaš
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1446 
Ch¬aù”
 *
Œaš”
;

1448 ià(
ch
->
	`is_Åc
()) {

1449 
	`¡c
("Tru¡ me, you know‡Î you‚“d.\n", 
ch
);

1453 ià(
ch
->
gud
 =ğ
Gud
::
nÚe
) {

1454 
	`¡c
("You mu¡ još‡ gudØË¬ÀÃw skls.\n", 
ch
);

1459 
Œaš”
 = 
ch
->
š_room
->
³İË
;¿š”;¿š” =¿š”->
Ãxt_š_room
)

1460 ià(
Œaš”
->
	`is_Åc
(è&&¿š”->
aù_æags
.
	`has
(
ACT_GAIN
è&& 
	`ÿn_£e_ch¬
(
ch
,rainer))

1463 ià(
Œaš”
 =ğ
nuÎ±r
) {

1464 
	`¡c
("You cª'ˆdØth© h”e.\n", 
ch
);

1468 
SŒšg
 
¬g
;

1469 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1471 ià(
¬g
.
	`em±y
()) {

1472 
	`¡c
("Syntax:\n"

1477 "gaš <skÈÜ s³Î group>\n", 
ch
);

1481 ià(
¬g
.
	`is_´efix_of
("list")) {

1482 
cŞ
 = 0;

1483 
SŒšg
 
ouut
;

1484 
boŞ
 
found£ù
 = 
çl£
, 
found®l
 = false;

1485 
ouut
 +ğ
FÜm©
::
	`fÜm©
("%-18s %-5s %-18s %-5s %-18s %-5s\n",

1488 
gn
 = 0; gÀ< 
group_bË
.
	`size
(); gn++) {

1489 ià(
	`com¶‘ed_group
(
ch
, 
gn
)

1490 || 
group_bË
[
gn
].
¿tšg
[
ch
->
gud
] <= 0)

1493 
found£ù
 = 
Œue
;

1494 
ouut
 +ğ
FÜm©
::
	`fÜm©
("%-18s %s%-5d{x ",

1495 
group_bË
[
gn
].
Çme
,

1496 
group_bË
[
gn
].
¿tšg
[
ch
->
gud
] > ch->
Œaš
 ? "{T" : "{C",

1497 
group_bË
[
gn
].
¿tšg
[
ch
->
gud
]);

1499 ià(++
cŞ
 % 3 == 0)

1500 
ouut
 += "\n";

1503 ià(
cŞ
 % 3 != 0)

1504 
ouut
 += "\n";

1506 
ouut
 += "\n";

1508 ià(
found£ù
) {

1509 
	`·ge_to_ch¬
(
ouut
, 
ch
);

1510 
ouut
.
	`”a£
();

1511 
found®l
 = 
Œue
;

1514 
ouut
 +ğ
FÜm©
::
	`fÜm©
("%-18s %-5s %-18s %-5s %-18s %-5s\n",

1517 
cŞ
 = 0;

1518 
found£ù
 = 
çl£
;

1520 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

1521 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

1522 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

1524 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

1527 ià(
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) == 0

1528 && 
’Œy
.
¿tšg
[
ch
->
gud
] > 0

1529 && 
’Œy
.
¥–l_fun
 =ğ
¥–l_nuÎ


1530 && 
’Œy
.
»mÜt_gud
 =ğ
Gud
::
nÚe
) {

1531 
found£ù
 = 
Œue
;

1532 
ouut
 +ğ
FÜm©
::
	`fÜm©
("%s%-18s %s%-5d{x ",

1533 
	`g‘_u§bË_Ëv–
(
ty³
, 
ch
->
gud
è> ch->
Ëv–
 ? "{c" : "{g",

1534 
’Œy
.
Çme
,

1535 
’Œy
.
¿tšg
[
ch
->
gud
] > ch->
Œaš
 ? "{T" : "{C",

1536 
’Œy
.
¿tšg
[
ch
->
gud
]);

1538 ià(++
cŞ
 % 3 == 0)

1539 
ouut
 += "\n";

1543 ià(
cŞ
 % 3 != 0)

1544 
ouut
 += "\n";

1546 ià(
found£ù
) {

1547 
	`·ge_to_ch¬
(
ouut
, 
ch
);

1548 
ouut
.
	`”a£
();

1549 
found®l
 = 
Œue
;

1553 ià(
ch
->
pcd©a
->
»mÜt_couÁ
 < 1) {

1554 ià(!
found®l
)

1555 
ouut
 += "You have‚othing†efto†earn until you„emort.\n";

1557 
ouut
 +ğ
FÜm©
::
	`fÜm©
("You have %drain%s†eft.\n",

1558 
ch
->
Œaš
, ch->train == 1 ? "" : "s");

1559 
	`·ge_to_ch¬
(
ouut
, 
ch
);

1563 ià(
found®l
)

1564 
ouut
 += "\n";

1566 
ouut
 +ğ
FÜm©
::
	`fÜm©
("Remort specials for class %s\n",

1567 
gud_bË
[
ch
->
gud
].
Çme
);

1568 
ouut
 += "---------------\n";

1570 
cŞ
 = 0;

1571 
found£ù
 = 
çl£
;

1573 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

1574 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

1575 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

1577 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

1580 ià(
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) == 0

1581 && 
’Œy
.
¿tšg
[
ch
->
gud
] > 0

1582 && 
’Œy
.
»mÜt_gud
 !ğ
Gud
::
nÚe


1583 && 
’Œy
.
»mÜt_gud
 =ğ
ch
->
gud
) {

1584 
found£ù
 = 
Œue
;

1585 
ouut
 +ğ
FÜm©
::
	`fÜm©
("%s%-18s %s%-5d{x ",

1586 
	`g‘_u§bË_Ëv–
(
ty³
, 
ch
->
gud
è> ch->
Ëv–
 ? "{c" : "{g",

1587 
’Œy
.
Çme
,

1588 
’Œy
.
¿tšg
[
ch
->
gud
] > ch->
Œaš
 ? "{T" : "{C",

1589 
’Œy
.
¿tšg
[
ch
->
gud
]);

1591 ià(++
cŞ
 % 3 == 0)

1592 
ouut
 += "\n";

1596 ià(
cŞ
 % 3 != 0)

1597 
ouut
 += "\n";

1599 ià(
found£ù
) {

1600 
	`·ge_to_ch¬
(
ouut
, 
ch
);

1601 
ouut
.
	`”a£
();

1602 
found®l
 = 
Œue
;

1606 ià(!
found®l
)

1607 
ouut
 += "You have‚othing†efto†earn!\n";

1609 
ouut
 +ğ
FÜm©
::
	`fÜm©
("You have %drain%s†eft.\n",

1610 
ch
->
Œaš
, ch->train == 1 ? "" : "s");

1611 
	`·ge_to_ch¬
(
ouut
, 
ch
);

1615 ià(
¬g
.
	`is_´efix_of
("convert")) {

1616 ià(
ch
->
´aùiû
 < 10) {

1617 
	`aù
("$N–l you 'You‡»‚Ù y‘„—dy.'", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1621 
	`aù
("$N h–p you‡µly you¸´aùiûØŒaššg.", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1622 
ch
->
´aùiû
 -= 10;

1623 
ch
->
Œaš
++;

1627 ià(
¬g
.
	`is_´efix_of
("revert")) {

1628 ià(
ch
->
Œaš
 < 1) {

1629 
	`aù
("$N–l you 'You‡»‚Ù y‘„—dy.'", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1633 
	`aù
("$N h–p you‡µly you¸ŒaššgØ´aùiûs.", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1634 
ch
->
´aùiû
 += 10;

1635 
ch
->
Œaš
--;

1639 ià(
¬g
.
	`is_´efix_of
("points")) {

1640 
mod
;

1642 ià(
ch
->
Œaš
 < 1) {

1643 
	`aù
("$N–l you 'You‡»‚Ù y‘„—dy.'", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1647 ià(
ch
->
pcd©a
->
pošts
 <= 40) {

1648 
	`aù
("$N–l you 'Th”would bnØpošˆšh©.'", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1652 
	`aù
("$N¿š you,‡nd you f“ÈmÜ©ƒa£ w™h you¸skls.", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1653 
mod
 = 
ch
->
exp
 - (
	`exp_³r_Ëv–
(ch, ch->
pcd©a
->
pošts
è* ch->
Ëv–
);

1654 
ch
->
Œaš
--;

1655 
ch
->
pcd©a
->
pošts
--;

1656 
ch
->
exp
 = 
¡d
::
	`mš
(
	`exp_³r_Ëv–
(ch, ch->
pcd©a
->
pošts
è* ch->
Ëv–
 + 
mod
,

1657 
	`exp_³r_Ëv–
(
ch
, ch->
pcd©a
->
pošts
è* (ch->
Ëv–
 + 1) - 1);

1662 
gn
 = 
	`group_lookup
(
¬gum’t
);

1664 ià(
gn
 >= 0) {

1665 ià(
ch
->
pcd©a
->
group_known
[
gn
]) {

1666 
	`aù
("$N–l you 'You‡Ì—dy knowh© group!'", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1670 ià(
group_bË
[
gn
].
¿tšg
[
ch
->
gud
] <= 0) {

1671 
	`aù
("$N–l you 'Th© grou°i beyÚd you¸pow”s.'", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1675 ià(
ch
->
Œaš
 < 
group_bË
[
gn
].
¿tšg
[ch->
gud
]) {

1676 
	`aù
("$N–l you 'You‡»‚Ù y‘„—dy fÜh© group.'", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1681 
	`gn_add
(
ch
, 
gn
);

1682 
	`aù
("$N¿š you iÀth¬ˆoà$t.", 
ch
, 
group_bË
[
gn
].
Çme
, 
Œaš”
, 
TO_CHAR
);

1683 
ch
->
Œaš
 -ğ
group_bË
[
gn
].
¿tšg
[ch->
gud
];

1687 
skl
::
ty³
y³ = skl::
	`lookup
(
¬gum’t
);

1689 ià(
ty³
 > 
skl
::ty³::
unknown
) {

1690 ià(
skl
::
	`lookup
(
ty³
).
¥–l_fun
 !ğ
¥–l_nuÎ


1691 && 
skl
::
	`lookup
(
ty³
).
»mÜt_gud
 =ğ
Gud
::
nÚe
) {

1692 
	`aù
("$N–l you 'You mu¡†—ºhfuÎ group.'", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1696 ià(
skl
::
	`lookup
(
ty³
).
»mÜt_gud
 !ğ
Gud
::
nÚe
) {

1697 ià(
ch
->
pcd©a
->
»mÜt_couÁ
 < 1) {

1698 
	`aù
("$Nells you 'That skill is‡vailable onlyo„emorts.'",

1699 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1703 ià(
ch
->
gud
 !ğ
skl
::
	`lookup
(
ty³
).
»mÜt_gud
) {

1704 
	`aù
("$Nells you 'Useƒxtraclass for skills‡nd spells outside your class.'",

1705 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1710 ià(
	`g‘_Ë¬Ãd
(
ch
, 
ty³
) > 0) {

1711 
	`aù
("$N–l you 'You‡Ì—dy knowh© skl!'", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1715 ià(
skl
::
	`lookup
(
ty³
).
¿tšg
[
ch
->
gud
] <= 0) {

1716 
	`aù
("$N–l you 'Th© skÈi beyÚd you¸pow”s.'", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1720 ià(
ch
->
Œaš
 < 
skl
::
	`lookup
(
ty³
).
¿tšg
[ch->
gud
]) {

1721 
	`aù
("$N–l you 'You‡»‚Ù y‘„—dy fÜh© skl.'", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1726 
	`£t_Ë¬Ãd
(
ch
, 
ty³
, 1);

1727 
	`£t_evŞutiÚ
(
ch
, 
ty³
, 1);

1728 
	`aù
("$N¿š you iÀth¬ˆoà$t.", 
ch
, 
skl
::
	`lookup
(
ty³
).
Çme
, 
Œaš”
, 
TO_CHAR
);

1729 
ch
->
Œaš
 -ğ
skl
::
	`lookup
(
ty³
).
¿tšg
[ch->
gud
];

1733 
	`aù
("$N–l you 'I havnØknowËdgoàth© skÈÜ s³Î group.'", 
ch
, 
nuÎ±r
, 
Œaš”
, 
TO_CHAR
);

1734 
	}
}

1745 
	$do_cÚv”t
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1747 
u£_pošts
;

1748 
bufãr
[
MAX_INPUT_LENGTH
];

1750 ià(
¬gum’t
.
	`em±y
()) {

1751 
	`¡c
("CÚv”t: Chªg<X>‚umb” oàskÈpošt štØ´aùiû sessiÚs.\n", 
ch
);

1752 
	`¡c
("SyÁax: cÚv”ˆ<skl_pošts>\n", 
ch
);

1756 ià(!
¬gum’t
.
	`is_numb”
()) {

1757 
	`¡c
("PËa£…rovid¨v®id‚umb” oàskÈpošt tØcÚv”t.\n", 
ch
);

1761 
u£_pošts
 = 
	`©oi
(
¬gum’t
);

1763 ià((
u£_pošts
 < 10) || (use_points > 1000)) {

1764 
	`¡c
("PËa£ u£‡‚umb” iÀth¿ngoà10-1000. OÆy muÉË oà10‡»‡cû±ed,„ounded down.\n", 
ch
);

1769 
u£_pošts
 % 10)

1770 
u£_pošts
--;

1772 ià(
ch
->
pcd©a
->
skÍošts
 < 
u£_pošts
) {

1773 
	`¡c
("You havšsuffic›Á skÈpošts.\n", 
ch
);

1778 
ch
->
pcd©a
->
skÍošts
 -ğ
u£_pošts
;

1779 
ch
->
´aùiû
 +ğ
u£_pošts
 / 10;

1780 
FÜm©
::
	`¥rštf
(
bufãr
, "You‚ow have %d skill…oints‡nd %d…ractice sessions.\n",

1781 
ch
->
pcd©a
->
skÍošts
, ch->
´aùiû
);

1782 
	`¡c
(
bufãr
, 
ch
);

1783 
	}
}

	@src/social.cc

35 
	~"¬gum’t.hh
"

36 
	~"Ch¬aù”.hh
"

37 
	~"deş¬e.hh
"

38 
	~"fe.hh
"

39 
	~"FÜm©.hh
"

40 
	~"š‹½.hh
"

41 
	~"Loggšg.hh
"

42 
	~"memÜy.hh
"

43 
	~"SocŸl.hh
"

44 
	~"SŒšg.hh
"

46 
	#SOCIAL_FILE
 "../misc/socŸl.txt"

	)

48 
š£¹_socŸl
(
SocŸl
 *);

49 
»move_socŸl
(cÚ¡ 
SŒšg
&);

50 
couÁ_socŸls
();

52 
	gmaxSocŸl
;

54 
SocŸl
 *
	gsocŸl_bË_h—d
;

55 
SocŸl
 *
	gsocŸl_bË_
;

57 
	$lßd_socŸl
(
FILE
 *
å
, 
SocŸl
 *
socŸl
)

59 
socŸl
->
Çme
 = 
	`ä—d_¡ršg
(
å
);

60 
socŸl
->
ch¬_no_¬g
 = 
	`ä—d_¡ršg
(
å
);

61 
socŸl
->
Ùh”s_no_¬g
 = 
	`ä—d_¡ršg
(
å
);

62 
socŸl
->
ch¬_found
 = 
	`ä—d_¡ršg
(
å
);

63 
socŸl
->
Ùh”s_found
 = 
	`ä—d_¡ršg
(
å
);

64 
socŸl
->
viù_found
 = 
	`ä—d_¡ršg
(
å
);

65 
socŸl
->
ch¬_auto
 = 
	`ä—d_¡ršg
(
å
);

66 
socŸl
->
Ùh”s_auto
 = 
	`ä—d_¡ršg
(
å
);

67 
	}
}

69 
	$lßd_socŸl_bË
()

71 
FILE
 *
å
;

72 
i
;

73 
SocŸl
 *
Ãw_socŸl
;

74 
å
 = 
	`fİ’
(
SOCIAL_FILE
, "r");

76 ià(!
å
) {

77 
Loggšg
::
	`bug
("Could‚Ù o³À" 
SOCIAL_FILE
 " for„eading.", 0);

81 
	`fsÿnf
(
å
, "%d\n", &
maxSocŸl
);

82 
socŸl_bË_h—d
 = 
Ãw
 
SocŸl
;

83 
socŸl_bË_
 = 
Ãw
 
SocŸl
;

84 
socŸl_bË_h—d
->
Ãxt
 = 
socŸl_bË_
;

85 
socŸl_bË_
->
´evious
 = 
socŸl_bË_h—d
;

87 
i
 = 0; i < 
maxSocŸl
; i++) {

88 
Ãw_socŸl
 = 
Ãw
 
SocŸl
;

89 
	`lßd_socŸl
(
å
, 
Ãw_socŸl
);

90 
	`š£¹_socŸl
(
Ãw_socŸl
);

93 
	`fşo£
(
å
);

94 
	}
}

100 
	$š£¹_socŸl
(
SocŸl
 *
s
)

102 
SocŸl
 *
™”©Ü
;

110 
™”©Ü
 = 
socŸl_bË_h—d
->
Ãxt
;

112 
™”©Ü
 !ğ
socŸl_bË_
) {

113 ià(
	`¡rÿ£cmp
(
s
->
Çme
, 
™”©Ü
->name) < 1) {

114 
s
->
´evious
 = 
™”©Ü
->previous;

115 
s
->
´evious
->
Ãxt
 = s;

116 
s
->
Ãxt
 = 
™”©Ü
;

117 
™”©Ü
->
´evious
 = 
s
;

121 
™”©Ü
 = i‹¿tÜ->
Ãxt
;

125 
™”©Ü
 = 
socŸl_bË_
->
´evious
;

126 
™”©Ü
->
Ãxt
 = 
s
;

127 
s
->
´evious
 = 
™”©Ü
;

128 
s
->
Ãxt
 = 
socŸl_bË_
;

129 
socŸl_bË_
->
´evious
 = 
s
;

130 
	}
}

136 
	$»move_socŸl
(cÚ¡ 
SŒšg
& 
Çme
)

138 
SocŸl
 *
™”©Ü
;

140 
™”©Ü
 = 
socŸl_bË_h—d
->
Ãxt
; i‹¿tÜ !ğ
socŸl_bË_
; iterator = iterator->next) {

141 ià(!
	`¡rÿ£cmp
(
Çme
, 
™”©Ü
->name)) {

142 
SocŸl
 *
p
 = 
™”©Ü
->
´evious
;

143 
SocŸl
 *
n
 = 
™”©Ü
->
Ãxt
;

144 
p
->
Ãxt
 = 
n
;

145 
n
->
´evious
 = 
p
;

146 
d–‘e
 
™”©Ü
;

150 
	}
}

156 
	$couÁ_socŸls
()

158 
SocŸl
 *
™”©Ü
;

159 
socŸls
 = 0;

161 
™”©Ü
 = 
socŸl_bË_h—d
->
Ãxt
;

163 
™”©Ü
 !ğ
socŸl_bË_
) {

164 
socŸls
++;

165 
™”©Ü
 = i‹¿tÜ->
Ãxt
;

168  
socŸls
;

169 
	}
}

171 
	$§ve_socŸl
(cÚ¡ 
SocŸl
 *
s
, 
FILE
 *
å
)

174 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
s
->
Çme
.
	`»¶aû
("~", "-"));

175 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
s
->
ch¬_no_¬g
.
	`»¶aû
("~", "-"));

176 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
s
->
Ùh”s_no_¬g
.
	`»¶aû
("~", "-"));

177 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
s
->
ch¬_found
.
	`»¶aû
("~", "-"));

178 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
s
->
Ùh”s_found
.
	`»¶aû
("~", "-"));

179 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
s
->
viù_found
.
	`»¶aû
("~", "-"));

180 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
s
->
ch¬_auto
.
	`»¶aû
("~", "-"));

181 
FÜm©
::
	`årštf
(
å
, "%s~\n\n", 
s
->
Ùh”s_auto
.
	`»¶aû
("~", "-"));

182 
	}
}

184 
	$§ve_socŸl_bË
()

186 
FILE
 *
å
;

187 
SocŸl
 *
™”©Ü
;

188 
å
 = 
	`fİ’
(
SOCIAL_FILE
, "w");

190 ià(!
å
) {

191 
Loggšg
::
	`bug
("Could‚Ù o³À" 
SOCIAL_FILE
 " for writing.", 0);

195 
FÜm©
::
	`årštf
(
å
, "%d\n", 
	`couÁ_socŸls
());

197 
™”©Ü
 = 
socŸl_bË_h—d
->
Ãxt
;

199 
™”©Ü
 !ğ
socŸl_bË_
) {

200 
	`§ve_socŸl
(
™”©Ü
, 
å
);

201 
™”©Ü
 = i‹¿tÜ->
Ãxt
;

204 
	`fşo£
(
å
);

205 
	}
}

208 
SocŸl
 *
	$socŸl_lookup
(cÚ¡ 
SŒšg
& 
Çme
)

210 
SocŸl
 *
™”©Ü
;

212 
™”©Ü
 = 
socŸl_bË_h—d
->
Ãxt
;

214 
™”©Ü
 !ğ
socŸl_bË_
) {

215 ià(
Çme
 =ğ
™”©Ü
->name)

216  
™”©Ü
;

218 
™”©Ü
 = i‹¿tÜ->
Ãxt
;

221  
nuÎ±r
;

222 
	}
}

228 
	$do_£d™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

230 
buf
[
MAX_STRING_LENGTH
];

231 
SocŸl
 *
iSocŸl
;

233 
SŒšg
 
cmd
, 
socŸl
;

234 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
cmd
);

235 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
socŸl
);

237 ià(
cmd
.
	`em±y
()) {

238 
	`¡c
("Huh? Ty³ HELP SEDITØ£syÁax.\n", 
ch
);

242 ià(
socŸl
.
	`em±y
()) {

243 ià(
cmd
 == "find")

244 
	`¡c
("Wh© dØyou wishØfšd?\n", 
ch
);

246 
	`¡c
("Wh© socŸÈdØyou wªˆtØİ”©Ú?\n", 
ch
);

251 
iSocŸl
 = 
	`socŸl_lookup
(
socŸl
);

253 ià(
cmd
 !ğ"Ãw" && cmd !ğ"fšd" && (
iSocŸl
 =ğ
nuÎ±r
)) {

254 
	`¡c
("NØsuch socŸÈexi¡s.\n", 
ch
);

258 ià(
cmd
 == "delete") {

259 
	`»move_socŸl
(
iSocŸl
->
Çme
);

260 
	`¡c
("Th© socŸÈi hi¡Üy‚ow.\n", 
ch
);

262 ià(
cmd
 == "new") {

263 ià(
iSocŸl
 !ğ
nuÎ±r
) {

264 
	`¡c
("A socŸÈw™hh©‚am®»adyƒxi¡s.\n", 
ch
);

268 cÚ¡‡uto& 
’Œy
 : 
cmd_bË
) {

269 ià(
socŸl
.
	`is_´efix_of
(
’Œy
.
Çme
)) {

270 
	`¡c
("A commªd w™hh©‚am®»adyƒxi¡s.\n", 
ch
);

275 
SocŸl
 *
Ãw_socŸl
 = 
Ãw
 Social;

277 
Ãw_socŸl
->
Çme
 = 
socŸl
;

278 
	`š£¹_socŸl
(
Ãw_socŸl
);

279 
	`¡c
("New socŸÈadded.\n", 
ch
);

281 ià(
cmd
 == "rename") {

282 ià(
¬gum’t
.
	`em±y
()) {

283 
	`¡c
("R’am™Øwh©?\n", 
ch
);

287 ià(
	`socŸl_lookup
(
¬gum’t
è!ğ
nuÎ±r
) {

288 
	`¡c
("A socŸÈw™hh©‚am®»adyƒxi¡s.\n", 
ch
);

292 cÚ¡‡uto& 
’Œy
 : 
cmd_bË
) {

293 ià(
¬gum’t
.
	`is_´efix_of
(
’Œy
.
Çme
)) {

294 
	`¡c
("A commªd w™hh©‚am®»adyƒxi¡s.\n", 
ch
);

299 
SocŸl
 *
Ãw_socŸl
 = 
Ãw
 Social;

301 
Ãw_socŸl
->
Çme
 = 
¬gum’t
;

302 
Ãw_socŸl
->
ch¬_no_¬g
 = 
iSocŸl
->char_no_arg;

303 
Ãw_socŸl
->
Ùh”s_no_¬g
 = 
iSocŸl
->others_no_arg;

304 
Ãw_socŸl
->
ch¬_found
 = 
iSocŸl
->char_found;

305 
Ãw_socŸl
->
Ùh”s_found
 = 
iSocŸl
->others_found;

306 
Ãw_socŸl
->
viù_found
 = 
iSocŸl
->vict_found;

307 
Ãw_socŸl
->
ch¬_auto
 = 
iSocŸl
->char_auto;

308 
Ãw_socŸl
->
Ùh”s_auto
 = 
iSocŸl
->others_auto;

309 
	`š£¹_socŸl
(
Ãw_socŸl
);

310 
	`»move_socŸl
(
iSocŸl
->
Çme
);

311 
	`¡c
("SocŸÈ»Çmed.\n", 
ch
);

313 ià(
cmd
 == "show") {

314 
FÜm©
::
	`¥rštf
(
buf
, "{HSocial: %s{x\n"

329 
iSocŸl
->
Çme
,

330 
iSocŸl
->
ch¬_no_¬g
,

331 
iSocŸl
->
Ùh”s_no_¬g
,

332 
iSocŸl
->
ch¬_found
,

333 
iSocŸl
->
Ùh”s_found
,

334 
iSocŸl
->
viù_found
,

335 
iSocŸl
->
ch¬_auto
,

336 
iSocŸl
->
Ùh”s_auto
);

337 
	`¡c
(
buf
, 
ch
);

340 ià(
cmd
.
	`is_´efix_of
("find")) {

341 
SocŸl
 *
i
;

342 
boŞ
 
fAÎ
 = 
çl£
;

344 ià(
¬gum’t
.
	`em±y
())

345 
fAÎ
 = 
Œue
;

347 ià(
socŸl
 == "unfinished") {

348 
boŞ
 
unfš
;

349 
couÁ
 = 0;

351 
i
 = 
socŸl_bË_h—d
->
Ãxt
; i !ğ
socŸl_bË_
; i = i->next) {

352 
unfš
 = 
çl£
;

354 ià(
i
->
ch¬_no_¬g
 =ğ"" && (
fAÎ
 || 
¬gum’t
 == "cnoarg"))

355 
unfš
 = 
Œue
;

357 ià(
i
->
Ùh”s_no_¬g
 =ğ"" && (
fAÎ
 || 
¬gum’t
 == "onoarg"))

358 
unfš
 = 
Œue
;

360 ià(
i
->
ch¬_found
 =ğ"" && (
fAÎ
 || 
¬gum’t
 == "cfound"))

361 
unfš
 = 
Œue
;

363 ià(
i
->
Ùh”s_found
 =ğ"" && (
fAÎ
 || 
¬gum’t
 == "ofound"))

364 
unfš
 = 
Œue
;

366 ià(
i
->
viù_found
 =ğ"" && (
fAÎ
 || 
¬gum’t
 == "vfound"))

367 
unfš
 = 
Œue
;

369 ià(
i
->
ch¬_auto
 =ğ"" && (
fAÎ
 || 
¬gum’t
 == "cself"))

370 
unfš
 = 
Œue
;

372 ià(
i
->
Ùh”s_auto
 =ğ"" && (
fAÎ
 || 
¬gum’t
 == "oself"))

373 
unfš
 = 
Œue
;

375 ià(
unfš
) {

376 
	`±c
(
ch
, "%s\n", 
i
->
Çme
);

377 
couÁ
++;

381 
	`±c
(
ch
, "%sYou found %d socials matching your criteria.\n",

382 
couÁ
 > 0 ? "\n" : "", count);

386 
	`¡c
("Fšd wh©?\n", 
ch
);

389 ià(
cmd
 == "cnoarg") {

390 
iSocŸl
->
ch¬_no_¬g
 = 
¬gum’t
;

392 ià(
¬gum’t
.
	`em±y
())

393 
	`¡c
("Ch¬aù” wÈnow s“‚Ùhšg wh’hi socŸÈi u£d w™houˆ¬gum’ts.\n", 
ch
);

395 
	`±c
(
ch
, "New mes§gi now:\n%s\n", 
¬gum’t
);

397 ià(
cmd
 == "onoarg") {

398 
iSocŸl
->
Ùh”s_no_¬g
 = 
¬gum’t
;

400 ià(
¬gum’t
.
	`em±y
())

401 
	`¡c
("Oth” wÈnow s“‚Ùhšg wh’hi socŸÈi u£d w™houˆ¬gum’ts.\n", 
ch
);

403 
	`±c
(
ch
, "New mes§gi now:\n%s\n", 
¬gum’t
);

405 ià(
cmd
 == "cfound") {

406 
iSocŸl
->
ch¬_found
 = 
¬gum’t
;

408 ià(
¬gum’t
.
	`em±y
())

409 
	`¡c
("Thch¬aù” wÈnow s“‚Ùhšg wh’‡¬g‘ i found.\n", 
ch
);

411 
	`±c
(
ch
, "New mes§gi now:\n%s\n", 
¬gum’t
);

413 ià(
cmd
 == "ofound") {

414 
iSocŸl
->
Ùh”s_found
 = 
¬gum’t
;

416 ià(
¬gum’t
.
	`em±y
())

417 
	`¡c
("Oth” wÈnow s“‚Ùhšg wh’‡¬g‘ i found.\n", 
ch
);

419 
	`±c
(
ch
, "New mes§gi now:\n%s\n", 
¬gum’t
);

421 ià(
cmd
 == "vfound") {

422 
iSocŸl
->
viù_found
 = 
¬gum’t
;

424 ià(
¬gum’t
.
	`em±y
())

425 
	`¡c
("Viùim wÈnow s“‚Ùhšg wh’‡¬g‘ i found.\n", 
ch
);

427 
	`±c
(
ch
, "New mes§gi now:\n%s\n", 
¬gum’t
);

429 ià(
cmd
 == "cself") {

430 
iSocŸl
->
ch¬_auto
 = 
¬gum’t
;

432 ià(
¬gum’t
.
	`em±y
())

433 
	`¡c
("Ch¬aù” wÈnow s“‚Ùhšg wh’¬g‘tšg s–f.\n", 
ch
);

435 
	`±c
(
ch
, "New mes§gi now:\n%s\n", 
¬gum’t
);

437 ià(
cmd
 == "oself") {

438 
iSocŸl
->
Ùh”s_auto
 = 
¬gum’t
;

440 ià(
¬gum’t
.
	`em±y
())

441 
	`¡c
("Oth” wÈnow s“‚Ùhšg wh’ ch¬aù”¬g‘ £lf.\n", 
ch
);

443 
	`±c
(
ch
, "New mes§gi now:\n%s\n", 
¬gum’t
);

446 
	`¡c
("Huh? Try HELP SEDIT.\n", 
ch
);

451 
	`§ve_socŸl_bË
();

452 
	}
}

	@src/special.cc

28 
	~<veùÜ
>

30 
	~"aù.hh
"

31 
	~"afãù/Afãù.hh
"

32 
	~"A»a.hh
"

33 
	~"Ch¬aù”.hh
"

34 
	~"deş¬e.hh
"

35 
	~"fšd.hh
"

36 
	~"FÏgs.hh
"

37 
	~"FÜm©.hh
"

38 
	~"Game.hh
"

39 
	~"GameTime.hh
"

40 
	~"š‹½.hh
"

41 
	~"lookup.hh
"

42 
	~"magic.hh
"

43 
	~"memÜy.hh
"

44 
	~"m”c.hh
"

45 
	~"MobePrÙÙy³.hh
"

46 
	~"Objeù.hh
"

47 
	~"ObjeùPrÙÙy³.hh
"

48 
	~"PÏy”.hh
"

49 
	~"¿ndom.hh
"

50 
	~"Room.hh
"

51 
	~"SŒšg.hh
"

52 
	~"WÜld.hh
"

54 
DECLARE_SPELL_FUN
(
¥–l_id’tify
);

55 
DECLARE_SPELL_FUN
(
¥–l_ch¬m_³rsÚ
);

57 
obj_»·œ
 
¬gs
((
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
));

62 
DECLARE_SPEC_FUN
(
¥ec_b»©h_ªy
);

63 
DECLARE_SPEC_FUN
(
¥ec_b»©h_acid
);

64 
DECLARE_SPEC_FUN
(
¥ec_b»©h_fœe
);

65 
DECLARE_SPEC_FUN
(
¥ec_b»©h_äo¡
);

66 
DECLARE_SPEC_FUN
(
¥ec_b»©h_gas
);

67 
DECLARE_SPEC_FUN
(
¥ec_b»©h_lighŠšg
);

68 
DECLARE_SPEC_FUN
(
¥ec_ÿ¡_ad•t
);

69 
DECLARE_SPEC_FUN
(
¥ec_ÿ¡_ş”ic
);

70 
DECLARE_SPEC_FUN
(
¥ec_ÿ¡_judge
);

71 
DECLARE_SPEC_FUN
(
¥ec_ÿ¡_mage
);

72 
DECLARE_SPEC_FUN
(
¥ec_ÿ¡_und—d
);

73 
DECLARE_SPEC_FUN
(
¥ec_executiÚ”
);

74 
DECLARE_SPEC_FUN
(
¥ec_fido
);

75 
DECLARE_SPEC_FUN
(
¥ec_gu¬d
);

76 
DECLARE_SPEC_FUN
(
¥ec_jª™Ü
);

77 
DECLARE_SPEC_FUN
(
¥ec_mayÜ
);

78 
DECLARE_SPEC_FUN
(
¥ec_poisÚ
);

79 
DECLARE_SPEC_FUN
(
¥ec_th›f
);

80 
DECLARE_SPEC_FUN
(
¥ec_Ç¡y
);

81 
DECLARE_SPEC_FUN
(
¥ec_ŒŞl_memb”
);

82 
DECLARE_SPEC_FUN
(
¥ec_og»_memb”
);

83 
DECLARE_SPEC_FUN
(
¥ec_·ŒŞmª
);

84 
DECLARE_SPEC_FUN
(
¥ec_que¡ma¡”
);

85 
DECLARE_SPEC_FUN
(
¥ec_sque¡ma¡”
);

86 
DECLARE_SPEC_FUN
(
¥ec_§ge
);

87 
DECLARE_SPEC_FUN
(
¥ec_bÏcksm™h
);

88 
DECLARE_SPEC_FUN
(
¥ec_ch¬m
);

89 
DECLARE_SPEC_FUN
(
¥ec_şªgu¬d
);

90 
DECLARE_SPEC_FUN
(
¥ec_fight_şªgu¬d
);

93 cÚ¡ 
	g¡d
::
veùÜ
<
¥ec_ty³
> 
¥ec_bË
 = {

94 { "¥ec_b»©h_ªy", 
¥ec_b»©h_ªy
 },

95 { "¥ec_b»©h_acid", 
¥ec_b»©h_acid
 },

96 { "¥ec_b»©h_fœe", 
¥ec_b»©h_fœe
 },

97 { "¥ec_b»©h_äo¡", 
¥ec_b»©h_äo¡
 },

98 { "¥ec_b»©h_gas", 
¥ec_b»©h_gas
 },

99 { "¥ec_b»©h_lighŠšg", 
¥ec_b»©h_lighŠšg
 },

100 { "¥ec_ÿ¡_ad•t", 
¥ec_ÿ¡_ad•t
 },

101 { "¥ec_ÿ¡_ş”ic", 
¥ec_ÿ¡_ş”ic
 },

102 { "¥ec_ÿ¡_judge", 
¥ec_ÿ¡_judge
 },

103 { "¥ec_ÿ¡_mage", 
¥ec_ÿ¡_mage
 },

104 { "¥ec_ÿ¡_und—d", 
¥ec_ÿ¡_und—d
 },

105 { "¥ec_executiÚ”", 
¥ec_executiÚ”
 },

106 { "¥ec_fido", 
¥ec_fido
 },

107 { "¥ec_gu¬d", 
¥ec_gu¬d
 },

108 { "¥ec_jª™Ü", 
¥ec_jª™Ü
 },

109 { "¥ec_mayÜ", 
¥ec_mayÜ
 },

110 { "¥ec_poisÚ", 
¥ec_poisÚ
 },

111 { "¥ec_th›f", 
¥ec_th›f
 },

112 { "¥ec_Ç¡y", 
¥ec_Ç¡y
 },

113 { "¥ec_ŒŞl_memb”", 
¥ec_ŒŞl_memb”
 },

114 { "¥ec_og»_memb”", 
¥ec_og»_memb”
 },

115 { "¥ec_·ŒŞmª", 
¥ec_·ŒŞmª
 },

116 { "¥ec_que¡ma¡”", 
¥ec_que¡ma¡”
 },

117 { "¥ec_sque¡ma¡”", 
¥ec_sque¡ma¡”
 },

118 { "¥ec_§ge", 
¥ec_§ge
 },

119 { "¥ec_bÏcksm™h", 
¥ec_bÏcksm™h
 },

120 { "¥ec_ch¬m", 
¥ec_ch¬m
 },

121 { "¥ec_şªgu¬d", 
¥ec_şªgu¬d
 },

122 { "¥ec_fight_şªgu¬d", 
¥ec_fight_şªgu¬d
 },

126 
SPEC_FUN
 *
	$¥ec_lookup
(cÚ¡ 
SŒšg
& 
Çme
)

128 cÚ¡‡uto& 
’Œy
 : 
¥ec_bË
)

129 ià(
	`tŞow”
(
Çme
[0]è=ğtŞow”(
’Œy
.Çme[0]è&&‚ame.
	`is_´efix_of
(entry.name))

130  
’Œy
.
funùiÚ
;

133 
	}
}

135 
SŒšg
 
	$¥ec_Çme
(
SPEC_FUN
 *
funùiÚ
)

137 cÚ¡‡uto& 
’Œy
 : 
¥ec_bË
)

138 ià(
funùiÚ
 =ğ
’Œy
.function)

139  
’Œy
.
Çme
;

142 
	}
}

144 
boŞ
 
	$¥ec_ŒŞl_memb”
(
Ch¬aù”
 *
ch
)

146 
Ch¬aù”
 *
vch
, *
viùim
 = 
nuÎ±r
;

147 
couÁ
 = 0;

148 *
mes§ge
;

150 ià(!
	`IS_AWAKE
(
ch
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
ÿlm
è|| ch->
š_room
 =ğ
nuÎ±r


151 || 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è|| ch->
fightšg
 !ğ
nuÎ±r
)

152  
çl£
;

155 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = vch->
Ãxt_š_room
) {

156 ià(!
vch
->
	`is_Åc
(è|| 
ch
 == vch)

159 ià(
vch
->
pIndexD©a
->
vnum
 =ğ
MOB_VNUM_PATROLMAN
)

160  
çl£
;

162 ià(
vch
->
pIndexD©a
->
group_æags
.
	`has
(
GROUP_VNUM_OGRES
è&& 
ch
->
Ëv–
 > vch->Ëv– - 2 && !
	`is_§ã
(ch, vch, 
Œue
)) {

163 ià(
	`numb”_¿nge
(0, 
couÁ
) == 0)

164 
viùim
 = 
vch
;

166 
couÁ
++;

170 ià(
viùim
 =ğ
nuÎ±r
)

171  
çl£
;

174 
	`numb”_¿nge
(0, 6)) {

175 : 
mes§ge
 = "$n yells 'I've been†ooking for you,…unk!'";

178 1: 
mes§ge
 = "With‡ scream of„age, $n‡ttacks $N.";

181 2: 
mes§ge
 = "$n says 'What's slimy Ogrerash†ike you doing‡round here?'";

184 3: 
mes§ge
 = "$n cracks his knuckles‡nd says 'Do ya feel†ucky?'";

187 4: 
mes§ge
 = "$n says 'There's‚o copso save youhisime!'";

190 5: 
mes§ge
 = "$n says 'Timeo join your brother, spud.'";

193 6: 
mes§ge
 = "$n says 'Let's„ock.'";

197 
	`aù
(
mes§ge
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_ALL
);

198 
	`muÉi_h™
(
ch
, 
viùim
, 
skl
::
ty³
::
unknown
);

199  
Œue
;

200 
	}
}

202 
boŞ
 
	$¥ec_og»_memb”
(
Ch¬aù”
 *
ch
)

204 
Ch¬aù”
 *
vch
, *
viùim
 = 
nuÎ±r
;

205 
couÁ
 = 0;

206 *
mes§ge
;

208 ià(!
	`IS_AWAKE
(
ch
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
ÿlm
è|| ch->
š_room
 =ğ
nuÎ±r


209 || 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è|| ch->
fightšg
 !ğ
nuÎ±r
)

210  
çl£
;

213 
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = vch->
Ãxt_š_room
) {

214 ià(!
vch
->
	`is_Åc
(è|| 
ch
 == vch)

217 ià(
vch
->
pIndexD©a
->
vnum
 =ğ
MOB_VNUM_PATROLMAN
)

218  
çl£
;

220 ià(
vch
->
pIndexD©a
->
group_æags
.
	`has
(
GROUP_VNUM_TROLLS
è&& 
ch
->
Ëv–
 > vch->Ëv– - 2 && !
	`is_§ã
(ch, vch, 
Œue
)) {

221 ià(
	`numb”_¿nge
(0, 
couÁ
) == 0)

222 
viùim
 = 
vch
;

224 
couÁ
++;

228 ià(
viùim
 =ğ
nuÎ±r
)

229  
çl£
;

232 
	`numb”_¿nge
(0, 6)) {

233 : 
mes§ge
 = "$n yells 'I've been†ooking for you,…unk!'";

236 1: 
mes§ge
 = "With‡ scream of„age, $n‡ttacks $N.'";

239 2: 
mes§ge
 = "$n says 'What's Troll filth†ike you doing‡round here?'";

242 3: 
mes§ge
 = "$n cracks his knuckles‡nd says 'Do ya feel†ucky?'";

245 4: 
mes§ge
 = "$n says 'There's‚o copso save youhisime!'";

248 5: 
mes§ge
 = "$n says 'Timeo join your brother, spud.'";

251 6: 
mes§ge
 = "$n says 'Let's„ock.'";

255 
	`aù
(
mes§ge
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_ALL
);

256 
	`muÉi_h™
(
ch
, 
viùim
, 
skl
::
ty³
::
unknown
);

257  
Œue
;

258 
	}
}

260 
boŞ
 
	$¥ec_·ŒŞmª
(
Ch¬aù”
 *
ch
)

262 
Ch¬aù”
 *
viùim
 = 
nuÎ±r
;

263 
Objeù
 *
obj
;

264 *
mes§ge
;

265 
couÁ
 = 0;

267 ià(!
	`IS_AWAKE
(
ch
è|| 
afãù
::
	`exi¡s_Ú_ch¬
(ch,‡fãù::
ty³
::
ÿlm
è|| ch->
š_room
 =ğ
nuÎ±r


268 || 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
è|| ch->
fightšg
 !ğ
nuÎ±r
)

269  
çl£
;

272 
Ch¬aù”
 *
vch
 = 
ch
->
š_room
->
³İË
; vch !ğ
nuÎ±r
; vch = vch->
Ãxt_š_room
) {

273 ià(
vch
 =ğ
ch
)

276 ià(
vch
->
fightšg
 !ğ
nuÎ±r
) {

277 ià(
	`numb”_¿nge
(0, 
couÁ
) == 0)

278 
viùim
 = (
vch
->
Ëv–
 > vch->
fightšg
->level)

279 ? 
vch
 : vch->
fightšg
;

281 
couÁ
++;

285 ià(
viùim
 =ğ
nuÎ±r
 || (viùim->
	`is_Åc
(è&& viùim->
¥ec_fun
 =ğ
ch
->spec_fun))

286  
çl£
;

288 ià(((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_NECK_1
)è!ğ
nuÎ±r


289 && 
obj
->
pIndexD©a
->
vnum
 =ğ
OBJ_VNUM_WHISTLE
)

290 || ((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_NECK_2
)è!ğ
nuÎ±r


291 && 
obj
->
pIndexD©a
->
vnum
 =ğ
OBJ_VNUM_WHISTLE
)) {

292 
	`aù
("You blow dowÀh¬d oÀ$p.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

293 
	`aù
("$Àblow Ú $p, ***WHEEEEEEEEEEEET***", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

295 autØ
vch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

296 ià(
vch
->
š_room
 =ğ
nuÎ±r
)

299 ià(
vch
->
š_room
 !ğ
ch
->in_room

300 && 
vch
->
š_room
->
	`¬—
(è=ğ
ch
->in_room->area())

301 
	`¡c
("You h—¸¨shrÈwhi¡lšg sound.\n", 
vch
);

305 
	`numb”_¿nge
(0, 6)) {

306 : 
mes§ge
 = 
nuÎ±r
; ;

308 0: 
mes§ge
 = "$n yells 'All„oit! All„oit! break it up!'";

311 1: 
mes§ge
 =

315 2: 
mes§ge
 =

319 3: 
mes§ge
 = "$n shouts 'Stophat! Stophat!'‡nd‡ttacks.";

322 4: 
mes§ge
 = "$n…ulls out his billy‡nd goeso work.";

325 5: 
mes§ge
 =

329 6: 
mes§ge
 = "$n says 'Settle down, you hooligans!'";

333 ià(
mes§ge
 !ğ
nuÎ±r
)

334 
	`aù
(
mes§ge
, 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ALL
);

336 
	`muÉi_h™
(
ch
, 
viùim
, 
skl
::
ty³
::
unknown
);

337  
Œue
;

338 
	}
}

339 
boŞ
 
	$¥ec_que¡ma¡”
(
Ch¬aù”
 *
ch
)

341 ià(
ch
->
fightšg
 !ğ
nuÎ±r
è 
	`¥ec_ÿ¡_mage
(ch);

343  
çl£
;

344 
	}
}

346 
boŞ
 
	$¥ec_sque¡ma¡”
(
Ch¬aù”
 *
ch
)

348 ià(
ch
->
fightšg
 !ğ
nuÎ±r
)

349  
	`¥ec_ÿ¡_mage
(
ch
);

351  
çl£
;

352 
	}
}

354 
boŞ
 
	$¥ec_bÏcksm™h
(
Ch¬aù”
 *
ch
)

356 ià(
ch
->
fightšg
 !ğ
nuÎ±r
è 
	`¥ec_ÿ¡_mage
(ch);

358  
çl£
;

359 
	}
}

360 
boŞ
 
	$¥ec_§ge
(
Ch¬aù”
 *
ch
)

362 ià(
ch
->
fightšg
 !ğ
nuÎ±r
è 
	`¥ec_ÿ¡_mage
(ch);

364  
çl£
;

365 
	}
}

367 
boŞ
 
	$¥ec_Ç¡y
(
Ch¬aù”
 *
ch
)

369 
Ch¬aù”
 *
viùim
, *
v_Ãxt
;

370 
gŞd
;

372 ià(!
	`IS_AWAKE
(
ch
))

373  
çl£
;

375 ià(!
ch
->
fightšg
) {

376 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = 
v_Ãxt
) {

377 
v_Ãxt
 = 
viùim
->
Ãxt_š_room
;

379 ià(!
viùim
->
	`is_Åc
()

380 && (
viùim
->
Ëv–
 > 
ch
->level)

381 && (
viùim
->
Ëv–
 < 
ch
->level + 10)) {

382 
	`do_back¡ab
(
ch
, 
viùim
->
Çme
);

384 ià(!
ch
->
fightšg
)

385 
	`do_kl
(
ch
, 
viùim
->
Çme
);

388  
Œue
;

392  
çl£
;

396 ià((
viùim
 = 
ch
->
fightšg
è=ğ
nuÎ±r
)

397  
çl£
;

399 
	`numb”_b™s
(2)) {

400 0: 
	`aù
("$n„ips‡part your coin…urse, spilling your gold!",

401 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

402 
	`aù
("You slash‡part $N's coin…urse‡nd gather his gold.",

403 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

404 
	`aù
("$N's coin…urse is„ipped‡part!",

405 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

406 
gŞd
 = 
viùim
->gold / 10;

407 
viùim
->
gŞd
 -= gold;

408 
ch
->
gŞd
 += gold;

409  
Œue
;

411 1: 
	`do_æ“
(
ch
, "");

412  
Œue
;

414 :  
çl£
;

416 
	}
}

419 
boŞ
 
	$d¿gÚ
(
Ch¬aù”
 *
ch
, 
skl
::
ty³
 
¢
)

421 
Ch¬aù”
 *
viùim
;

423 ià(
	`g‘_pos™iÚ
(
ch
è!ğ
POS_FIGHTING
)

424  
çl£
;

426 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = viùim->
Ãxt_š_room
)

427 ià(
viùim
->
fightšg
 =ğ
ch


428 && 
	`ÿn_£e_ch¬
(
ch
, 
viùim
)

429 && 
	`numb”_b™s
(3) == 0)

432 ià(
viùim
 =ğ
nuÎ±r
)

433  
çl£
;

436 ià(
ch
->
mªa
 < 
skl
::
	`lookup
(
¢
).
mš_mªa
)

437  
çl£
;

439 (*
skl
::
	`lookup
(
¢
).
¥–l_fun
)

440 (
¢
, 
ch
->
Ëv–
, ch, 
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, sn));

441  
Œue
;

442 
	}
}

445 
boŞ
 
	$¥ec_b»©h_ªy
(
Ch¬aù”
 *
ch
)

447 
	`numb”_b™s
(3)) {

449 1:  
	`d¿gÚ
(
ch
, 
skl
::
ty³
::
lighŠšg_b»©h
);

453 4:  
	`d¿gÚ
(
ch
, 
skl
::
ty³
::
äo¡_b»©h
);

455 5:  
	`d¿gÚ
(
ch
, 
skl
::
ty³
::
fœe_b»©h
);

457 6:  
	`d¿gÚ
(
ch
, 
skl
::
ty³
::
gas_b»©h
);

459 7:  
	`d¿gÚ
(
ch
, 
skl
::
ty³
::
acid_b»©h
);

462  
çl£
;

463 
	}
}

465 
boŞ
 
	$¥ec_b»©h_acid
(
Ch¬aù”
 *
ch
)

467  
	`d¿gÚ
(
ch
, 
skl
::
ty³
::
acid_b»©h
);

468 
	}
}

470 
boŞ
 
	$¥ec_b»©h_fœe
(
Ch¬aù”
 *
ch
)

472  
	`d¿gÚ
(
ch
, 
skl
::
ty³
::
fœe_b»©h
);

473 
	}
}

475 
boŞ
 
	$¥ec_b»©h_äo¡
(
Ch¬aù”
 *
ch
)

477  
	`d¿gÚ
(
ch
, 
skl
::
ty³
::
äo¡_b»©h
);

478 
	}
}

480 
boŞ
 
	$¥ec_b»©h_gas
(
Ch¬aù”
 *
ch
)

482  
	`d¿gÚ
(
ch
, 
skl
::
ty³
::
gas_b»©h
);

483 
	}
}

485 
boŞ
 
	$¥ec_b»©h_lighŠšg
(
Ch¬aù”
 *
ch
)

487  
	`d¿gÚ
(
ch
, 
skl
::
ty³
::
lighŠšg_b»©h
);

488 
	}
}

490 
boŞ
 
	$¥ec_ÿ¡_ad•t
(
Ch¬aù”
 *
ch
)

492 
Ch¬aù”
 *
viùim
;

493 
Ch¬aù”
 *
v_Ãxt
;

495 ià(!
	`IS_AWAKE
(
ch
))

496  
çl£
;

498 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = 
v_Ãxt
) {

499 
v_Ãxt
 = 
viùim
->
Ãxt_š_room
;

501 ià(
viùim
 !ğ
ch
 && 
	`ÿn_£e_ch¬
(ch, viùimè&& 
	`numb”_b™s
(1) == 0

502 && !
viùim
->
	`is_Åc
(è&& viùim->
Ëv–
 < 11)

506 ià(
viùim
 =ğ
nuÎ±r
)

507  
çl£
;

509 
	`numb”_b™s
(4)) {

511 #ià(
	`defšed
(
HALLOWEEN
))

512 
	`aù
("$Àu‰” thwÜd 'bhŸw¯i'.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

513 
	`¥–l_blood_moÚ
(
skl
::
ty³
::
blood_moÚ
, 
ch
->
Ëv–
, ch, 
viùim
, 
TARGET_CHAR
,

514 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
blood_moÚ
));

516 
	`aù
("$Àu‰” thwÜd 'ab¿zak'.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

517 
	`¥–l_¬mÜ
(
skl
::
ty³
::
¬mÜ
, 
ch
->
Ëv–
, ch, 
viùim
, 
TARGET_CHAR
,

518 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
¬mÜ
));

520  
Œue
;

523 
	`aù
("$Àu‰” thwÜd 'fido'.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

524 
	`¥–l_bËss
(
skl
::
ty³
::
bËss
, 
ch
->
Ëv–
, ch, 
viùim
, 
TARGET_CHAR
,

525 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
bËss
));

526  
Œue
;

529 
	`aù
("$Àu‰” thwÜd 'judiÿndu no£Ïüi'.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

530 
	`¥–l_cu»_blšdÃss
(
skl
::
ty³
::
cu»_blšdÃss
,

531 
ch
->
Ëv–
, ch, 
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
skl
::
ty³
::
cu»_blšdÃss
));

532  
Œue
;

535 
	`aù
("$Àu‰” thwÜd 'judiÿndu d›s'.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

536 
	`¥–l_cu»_light
(
skl
::
ty³
::
cu»_light
,

537 
ch
->
Ëv–
, ch, 
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
skl
::
ty³
::
cu»_light
));

538  
Œue
;

541 
	`aù
("$Àu‰” thwÜd 'judiÿndu §u§bru'.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

542 
	`¥–l_cu»_poisÚ
(
skl
::
ty³
::
cu»_poisÚ
,

543 
ch
->
Ëv–
, ch, 
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
skl
::
ty³
::
cu»_poisÚ
));

544  
Œue
;

547 
	`aù
("$Àu‰” thwÜd 'ÿndusima'.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

548 
	`¥–l_»äesh
(
skl
::
ty³
::
»äesh
, 
ch
->
Ëv–
, ch, 
viùim
, 
TARGET_CHAR
,

549 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
»äesh
));

550  
Œue
;

553 
	`aù
("$Àu‰” thwÜd 'judiÿndu eugzagz'.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

554 
	`¥–l_cu»_di£a£
(
skl
::
ty³
::
cu»_di£a£
,

555 
ch
->
Ëv–
, ch, 
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, 
skl
::
ty³
::
cu»_di£a£
));

558  
çl£
;

559 
	}
}

561 
boŞ
 
	$¥ec_ÿ¡_judge
(
Ch¬aù”
 *
ch
)

563 
Ch¬aù”
 *
viùim
;

564 
Ch¬aù”
 *
v_Ãxt
;

565 *
¥–l
;

566 
skl
::
ty³
 
¢
;

568 ià(
	`g‘_pos™iÚ
(
ch
è!ğ
POS_FIGHTING
)

569  
çl£
;

571 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = 
v_Ãxt
) {

572 
v_Ãxt
 = 
viùim
->
Ãxt_š_room
;

574 ià(
viùim
->
fightšg
 =ğ
ch
 && 
	`numb”_b™s
(2) == 0)

578 ià(
viùim
 =ğ
nuÎ±r
)

579  
çl£
;

581 
¥–l
 = "highƒxplosive";

583 ià((
¢
 = 
skl
::
	`lookup
(
¥–l
)è=ğskl::
ty³
::
unknown
)

584  
çl£
;

586 (*
skl
::
	`lookup
(
¢
).
¥–l_fun
)(¢, 
ch
->
Ëv–
, ch, 
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, sn));

587  
Œue
;

588 
	}
}

590 
boŞ
 
	$¥ec_ÿ¡_ş”ic
(
Ch¬aù”
 *
ch
)

592 
Ch¬aù”
 *
viùim
;

593 
skl
::
ty³
 
¢
;

594 
i
;

596 ià(
	`g‘_pos™iÚ
(
ch
è!ğ
POS_FIGHTING
)

597  
çl£
;

599 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = viùim->
Ãxt_š_room
)

600 ià(
viùim
->
fightšg
 =ğ
ch
 && 
	`numb”_b™s
(2) == 0)

603 ià(
viùim
 =ğ
nuÎ±r
)

604  
çl£
;

606 
i
 = 0; ; i++) {

607 ià(
i
 == 10)

608  
çl£
;

610 
	`numb”_b™s
(4)) {

611 0: 
¢
 = 
skl
::
ty³
::
blšdÃss
; ;

613 1: 
¢
 = 
skl
::
ty³
::
ÿu£_£rious
; ;

615 2: 
¢
 = 
skl
::
ty³
::
—¹hquake
; ;

617 3: 
¢
 = 
skl
::
ty³
::
ÿu£_ü™iÿl
; ;

619 4: 
¢
 = 
skl
::
ty³
::
di¥–_ev
; ;

621 5: 
¢
 = 
skl
::
ty³
::
cur£
; ;

623 6: 
¢
 = 
skl
::
ty³
::
chªge_£x
; ;

625 7: 
¢
 = 
skl
::
ty³
::
æame¡rike
; ;

629 10: 
¢
 = 
skl
::
ty³
::
h¬m
; ;

631 11: 
¢
 = 
skl
::
ty³
::
¶ague
; ;

633 : 
¢
 = 
skl
::
ty³
::
di¥–_magic
; ;

636 ià(
ch
->
Ëv–
 < 
	`g‘_u§bË_Ëv–
(
¢
, 
Gud
::
ş”ic
)

637 || 
ch
->
mªa
 < 
skl
::
	`lookup
(
¢
).
mš_mªa
)

643 (*
skl
::
	`lookup
(
¢
).
¥–l_fun
)(¢, 
ch
->
Ëv–
, ch, 
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, sn));

644  
Œue
;

645 
	}
}

647 
boŞ
 
	$¥ec_ÿ¡_mage
(
Ch¬aù”
 *
ch
)

649 
Ch¬aù”
 *
viùim
;

650 
skl
::
ty³
 
¢
;

651 
i
;

653 ià(
	`g‘_pos™iÚ
(
ch
è!ğ
POS_FIGHTING
)

654  
çl£
;

656 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = viùim->
Ãxt_š_room
)

657 ià(
viùim
->
fightšg
 =ğ
ch
 && 
	`numb”_b™s
(2) == 0)

660 ià(
viùim
 =ğ
nuÎ±r
)

661  
çl£
;

663 
i
 = 0; ; i++) {

664 ià(
i
 == 10)

665  
çl£
;

667 
	`numb”_b™s
(4)) {

668 0: 
¢
 = 
skl
::
ty³
::
blšdÃss
; ;

670 1: 
¢
 = 
skl
::
ty³
::
chl_touch
; ;

672 2: 
¢
 = 
skl
::
ty³
::
w—k’
; ;

674 3: 
¢
 = 
skl
::
ty³
::
‹ËpÜt
; ;

676 4: 
¢
 = 
skl
::
ty³
::
cŞour_¥¿y
; ;

678 5: 
¢
 = 
skl
::
ty³
::
chªge_£x
; ;

680 6: 
¢
 = 
skl
::
ty³
::
’”gy_d¿š
; ;

684 9: 
¢
 = 
skl
::
ty³
::
fœeb®l
; ;

687 11: 
¢
 = 
skl
::
ty³
::
acid_bÏ¡
; ;

689 : 
¢
 = 
skl
::
ty³
::
¶ague
; ;

692 ià(
ch
->
Ëv–
 < 
	`g‘_u§bË_Ëv–
(
¢
, 
Gud
::
mage
)

693 || 
ch
->
mªa
 < 
skl
::
	`lookup
(
¢
).
mš_mªa
)

699 (*
skl
::
	`lookup
(
¢
).
¥–l_fun
)(¢, 
ch
->
Ëv–
, ch, 
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, sn));

700  
Œue
;

701 
	}
}

703 
boŞ
 
	$¥ec_ÿ¡_und—d
(
Ch¬aù”
 *
ch
)

705 
Ch¬aù”
 *
viùim
;

706 
skl
::
ty³
 
¢
;

707 
i
;

709 ià(
	`g‘_pos™iÚ
(
ch
è!ğ
POS_FIGHTING
)

710  
çl£
;

712 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = viùim->
Ãxt_š_room
)

713 ià(
viùim
->
fightšg
 =ğ
ch
 && 
	`numb”_b™s
(2) == 0)

716 ià(
viùim
 =ğ
nuÎ±r
)

717  
çl£
;

719 
i
 = 0; ; i++) {

720 ià(
i
 == 10)

721  
çl£
;

723 
	`numb”_b™s
(4)) {

724 0: 
¢
 = 
skl
::
ty³
::
cur£
; ;

727 2: 
¢
 = 
skl
::
ty³
::
chl_touch
; ;

729 3: 
¢
 = 
skl
::
ty³
::
blšdÃss
; ;

731 4: 
¢
 = 
skl
::
ty³
::
’”gy_d¿š
; ;

733 5: 
¢
 = 
skl
::
ty³
::
‹ËpÜt
; ;

736 7: 
¢
 = 
skl
::
ty³
::
poisÚ
; ;

739 9: 
¢
 = 
skl
::
ty³
::
¶ague
; ;

742 11: 
¢
 = 
skl
::
ty³
::
h¬m
; ;

744 : 
¢
 = 
skl
::
ty³
::
w—k’
; ;

747 ià((
ch
->
Ëv–
 < 
	`g‘_u§bË_Ëv–
(
¢
, 
Gud
::
ş”ic
)

748 && 
ch
->
Ëv–
 < 
	`g‘_u§bË_Ëv–
(
¢
, 
Gud
::
mage
))

749 || 
ch
->
mªa
 < 
skl
::
	`lookup
(
¢
).
mš_mªa
)

755 (*
skl
::
	`lookup
(
¢
).
¥–l_fun
)(¢, 
ch
->
Ëv–
, ch, 
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, sn));

756  
Œue
;

757 
	}
}

759 
boŞ
 
	$¥ec_executiÚ”
(
Ch¬aù”
 *
ch
)

761 
buf
[
MAX_STRING_LENGTH
];

762 
Ch¬aù”
 *
viùim
;

763 
Ch¬aù”
 *
v_Ãxt
;

764 *
üime
;

766 ià(!
	`IS_AWAKE
(
ch
è|| ch->
fightšg
 !ğ
nuÎ±r
)

767  
çl£
;

769 
üime
 = "";

771 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = 
v_Ãxt
) {

772 
v_Ãxt
 = 
viùim
->
Ãxt_š_room
;

774 ià(!
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
PLR_KILLER
)

775 && 
	`ÿn_£e_ch¬
(
ch
, 
viùim
))

776 { 
üime
 = "KILLER"; ; }

778 ià(!
viùim
->
	`is_Åc
(è&& viùim->
aù_æags
.
	`has
(
PLR_THIEF
)

779 && 
	`ÿn_£e_ch¬
(
ch
, 
viùim
))

780 { 
üime
 = "THIEF"; ; }

783 ià(
viùim
 =ğ
nuÎ±r
)

784  
çl£
;

786 
FÜm©
::
	`¥rštf
(
buf
, "%s is‡ %s! PROTECT THE INNOCENT! MORE BLOOOOD!!!",

787 
viùim
->
Çme
, 
üime
);

788 
ch
->
comm_æags
 -ğ
COMM_NOCHANNELS
;

789 
	`do_y–l
(
ch
, 
buf
);

790 
	`muÉi_h™
(
ch
, 
viùim
, 
skl
::
ty³
::
unknown
);

791  
Œue
;

792 
	}
}

794 
boŞ
 
	$¥ec_fido
(
Ch¬aù”
 *
ch
)

796 
Objeù
 *
cÜp£
;

797 
Objeù
 *
c_Ãxt
;

799 ià(!
	`IS_AWAKE
(
ch
))

800  
çl£
;

802 
cÜp£
 = 
ch
->
š_room
->
cÚ‹Ás
; cÜp£ !ğ
nuÎ±r
; cÜp£ = 
c_Ãxt
) {

803 
c_Ãxt
 = 
cÜp£
->
Ãxt_cÚ‹Á
;

805 ià(
cÜp£
->
™em_ty³
 !ğ
ITEM_CORPSE_NPC
)

808 
	`aù
("$À§vag–y devour ¨cÜp£.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

809 
	`de¡roy_obj
(
cÜp£
);

810  
Œue
;

813  
çl£
;

814 
	}
}

816 
boŞ
 
	$¥ec_gu¬d
(
Ch¬aù”
 *
ch
)

818 
buf
[
MAX_STRING_LENGTH
];

819 
Ch¬aù”
 *
viùim
;

820 
Ch¬aù”
 *
v_Ãxt
;

821 
Ch¬aù”
 *
ech
;

822 *
üime
;

823 
max_ev
;

825 ià(!
	`IS_AWAKE
(
ch
è|| ch->
fightšg
 !ğ
nuÎ±r
)

826  
çl£
;

828 
max_ev
 = 300;

829 
ech
 = 
nuÎ±r
;

830 
üime
 = "";

832 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = 
v_Ãxt
) {

833 
v_Ãxt
 = 
viùim
->
Ãxt_š_room
;

845 ià(
viùim
->
fightšg
 !ğ
nuÎ±r


846 && 
viùim
->
fightšg
 !ğ
ch


847 && 
viùim
->
®ignm’t
 < 
max_ev
) {

848 
max_ev
 = 
viùim
->
®ignm’t
;

849 
ech
 = 
viùim
;

853 ià(
viùim
 !ğ
nuÎ±r
) {

854 
FÜm©
::
	`¥rštf
(
buf
, "%s is‡ %s! PROTECT THE INNOCENT!! BANZAI!!",

855 
viùim
->
Çme
, 
üime
);

856 
ch
->
comm_æags
 -ğ
COMM_NOCHANNELS
;

857 
	`do_y–l
(
ch
, 
buf
);

858 
	`muÉi_h™
(
ch
, 
viùim
, 
skl
::
ty³
::
unknown
);

859  
Œue
;

862 ià(
ech
 !ğ
nuÎ±r
) {

863 
	`aù
("$n screams 'PROTECT THE INNOCENT!! BANZAI!!",

864 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

865 
	`muÉi_h™
(
ch
, 
ech
, 
skl
::
ty³
::
unknown
);

866  
Œue
;

869  
çl£
;

870 
	}
}

872 
boŞ
 
	$¥ec_jª™Ü
(
Ch¬aù”
 *
ch
)

874 
Objeù
 *
Œash
;

875 
Objeù
 *
Œash_Ãxt
;

877 ià(!
	`IS_AWAKE
(
ch
))

878  
çl£
;

880 
Œash
 = 
ch
->
š_room
->
cÚ‹Ás
;¿sh !ğ
nuÎ±r
;¿sh = 
Œash_Ãxt
) {

881 
Œash_Ãxt
 = 
Œash
->
Ãxt_cÚ‹Á
;

883 ià(!
Œash
->
w—r_æags
.
	`has
(
ITEM_TAKE
è|| !
	`ÿn_loÙ
(
ch
,rash))

886 ià(
Œash
->
™em_ty³
 =ğ
ITEM_CORPSE_PC
)

889 ià(
Œash
->
™em_ty³
 =ğ
ITEM_DRINK_CON


890 || 
Œash
->
™em_ty³
 =ğ
ITEM_TRASH


891 || 
Œash
->
co¡
 < 10) {

892 
	`aù
("$Àpick u°somŒash.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

893 
	`obj_äom_room
(
Œash
);

894 
	`obj_to_ch¬
(
Œash
, 
ch
);

895  
Œue
;

899  
çl£
;

900 
	}
}

902 
boŞ
 
	$¥ec_mayÜ
(
Ch¬aù”
 *
ch
)

904 cÚ¡ 
İ’_·th
[] =

906 cÚ¡ 
şo£_·th
[] =

908 cÚ¡ *
·th
;

909 
pos
;

910 
boŞ
 
move
;

912 ià(!
move
) {

913 ià(
Game
::
	`wÜld
().
time
.
hour
 == 6) {

914 
·th
 = 
İ’_·th
;

915 
move
 = 
Œue
;

916 
pos
 = 0;

919 ià(
Game
::
	`wÜld
().
time
.
hour
 == 20) {

920 
·th
 = 
şo£_·th
;

921 
move
 = 
Œue
;

922 
pos
 = 0;

926 ià(
ch
->
fightšg
 !ğ
nuÎ±r
)

927  
	`¥ec_ÿ¡_mage
(
ch
);

929 ià(!
move
 || 
	`g‘_pos™iÚ
(
ch
è< 
POS_SLEEPING
)

930  
çl£
;

932 
·th
[
pos
]) {

937 
	`move_ch¬
(
ch
, 
·th
[
pos
] - '0', 
çl£
);

941 
ch
->
pos™iÚ
 = 
POS_STANDING
;

942 
	`aù
("$Àawak’ ªd grßn loudly.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

946 
ch
->
pos™iÚ
 = 
POS_SLEEPING
;

947 
	`aù
("$Àl› dowÀªd f®l a¦“p.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

951 
	`aù
("$À§y 'H–lØHÚey!'", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

955 
	`aù
("$n says 'What‡ view! I must do something‡bouthat dump!'",

956 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

960 
	`aù
("$n says 'Vandals! Youngsters have‚o„espect for‡nything!'",

961 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

965 
	`aù
("$À§y 'Good day, c™iz’s!'", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

969 
	`aù
("$n says 'I hereby declarehe city of Midgaard open!'",

970 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

974 
	`aù
("$n says 'I hereby declarehe city of Midgaard closed!'",

975 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

980 
	`do_İ’
(
ch
, "gate");

984 
	`do_şo£
(
ch
, "gate");

989 
move
 = 
çl£
;

993 
pos
++;

994  
çl£
;

995 
	}
}

997 
boŞ
 
	$¥ec_poisÚ
(
Ch¬aù”
 *
ch
)

999 
Ch¬aù”
 *
viùim
;

1001 ià(
	`g‘_pos™iÚ
(
ch
è!ğ
POS_FIGHTING


1002 || (
viùim
 = 
ch
->
fightšg
è=ğ
nuÎ±r


1003 || 
	`numb”_³rûÁ
(è> 2 * 
ch
->
Ëv–
)

1004  
çl£
;

1006 
	`aù
("You b™$N!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1007 
	`aù
("$Àb™e $N!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

1008 
	`aù
("$Àb™e you!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

1009 
	`¥–l_poisÚ
(
skl
::
ty³
::
poisÚ
, 
ch
->
Ëv–
, ch, 
viùim
, 
TARGET_CHAR
, 
	`g‘_evŞutiÚ
(ch, skill::type::poison));

1010  
Œue
;

1011 
	}
}

1013 
boŞ
 
	$¥ec_th›f
(
Ch¬aù”
 *
ch
)

1015 
Ch¬aù”
 *
viùim
;

1016 
Ch¬aù”
 *
v_Ãxt
;

1017 
gŞd
, 
sv”
;

1019 ià(
	`g‘_pos™iÚ
(
ch
è< 
POS_STANDING
)

1020  
çl£
;

1022 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = 
v_Ãxt
) {

1023 
v_Ãxt
 = 
viùim
->
Ãxt_š_room
;

1025 ià(
viùim
->
	`is_Åc
()

1026 || 
	`IS_IMMORTAL
(
viùim
)

1027 || 
	`numb”_b™s
(5) != 0

1028 || !
	`ÿn_£e_ch¬
(
ch
, 
viùim
))

1031 ià(
	`IS_AWAKE
(
viùim
è&& 
	`numb”_¿nge
(0, 
ch
->
Ëv–
) == 0) {

1032 
	`aù
("You discover $n's hands in your wallet!",

1033 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

1034 
	`aù
("$N discovers $n's hands in $S wallet!",

1035 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

1036  
Œue
;

1039 
gŞd
 = 
viùim
->gŞd * 
¡d
::
	`mš
(
	`numb”_¿nge
(1, 20), 
ch
->
Ëv–
 / 2) / 100;

1040 
gŞd
 = 
¡d
::
	`mš
(gŞd, 
ch
->
Ëv–
 * ch->level * 10);

1041 
ch
->
gŞd
 += gold;

1042 
viùim
->
gŞd
 -= gold;

1043 
sv”
 = 
viùim
->sv” * 
¡d
::
	`mš
(
	`numb”_¿nge
(1, 20), 
ch
->
Ëv–
 / 2) / 100;

1044 
sv”
 = 
¡d
::
	`mš
(sv”, 
ch
->
Ëv–
 * ch->level * 25);

1045 
ch
->
sv”
 += silver;

1046 
viùim
->
sv”
 -= silver;

1047  
Œue
;

1051  
çl£
;

1052 
	}
}

1053 
	$do_id’tify
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1055 
Objeù
 *
obj
;

1056 
Ch¬aù”
 *
rch
;

1057 
buf
[
MAX_STRING_LENGTH
];

1059 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬gum’t
)è=ğ
nuÎ±r
) {

1060 
	`¡c
("You‡»‚Ù c¬ryšgh©.\n", 
ch
);

1064 
rch
 = 
ch
->
š_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
)

1065 ià(
rch
->
	`is_Åc
(è&&„ch->
¥ec_fun
 =ğ
	`¥ec_lookup
("spec_sage"))

1068 ià(!
rch
) {

1069 
	`¡c
("NØÚh”ha ªy cluwh©h© is.\n", 
ch
);

1072 ià((
ch
->
sv”
 + 100 * ch->
gŞd
è< 
obj
->
Ëv–
 * 10 + 50) {

1073 
	`aù
("$n goes‡bout his business‡nd ignores $p.",

1074 
rch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1078 
	`deduù_co¡
(
ch
, 
obj
->
Ëv–
 * 10 + 50);

1079 
FÜm©
::
	`¥rštf
(
buf
, "The identify on %s has cost you %d silver.\n",

1080 
obj
->
shÜt_desü
, obj->
Ëv–
 * 10 + 50);

1081 
	`¡c
(
buf
, 
ch
);

1084 
	`aù
("$n fondles $p‡nd…onders its…urpose.",

1085 
rch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1086 
	`¥–l_id’tify
(
skl
::
ty³
::
id’tify
, 0, 
ch
, 
obj
, 
TAR_OBJ_INV
, 1);

1087 
	}
}

1089 
boŞ
 
	$¥ec_ch¬m
(
Ch¬aù”
 *
ch
)

1091 
Ch¬aù”
 *
viùim
;

1092 
Ch¬aù”
 *
v_Ãxt
;

1094 ià(
	`g‘_pos™iÚ
(
ch
è!ğ
POS_FIGHTING
) {

1095 
	`numb”_¿nge
(0, 15)) {

1100 
	`do_Üd”
(
ch
, "all bth self");

1108 
	`do_Üd”
(
ch
, "all bonk self");

1112  
Œue
;

1115 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = 
v_Ãxt
) {

1116 
v_Ãxt
 = 
viùim
->
Ãxt_š_room
;

1118 ià(
viùim
->
fightšg
 =ğ
ch
 && 
	`numb”_b™s
(2) == 0)

1122 ià(
viùim
 =ğ
nuÎ±r
)

1123  
çl£
;

1125 
	`aù
("$n begins…laying‡‚ew, beautiful song.",

1126 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1127 
	`¥–l_ch¬m_³rsÚ
(
skl
::
ty³
::
ch¬m_³rsÚ
, 
ch
->
Ëv–
, ch, 
viùim
,

1128 
TAR_CHAR_OFFENSIVE
, 
	`g‘_evŞutiÚ
(
ch
, 
skl
::
ty³
::
ch¬m_³rsÚ
));

1130 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
viùim
,‡fãù::
ty³
::
ch¬m_³rsÚ
))

1131 
	`¡İ_fightšg
(
viùim
, 
Œue
);

1133  
Œue
;

1134 
	}
}

1135 
	$do_»·œ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1137 
iW—r
;

1138 
Objeù
 *
obj
;

1139 
buf
[
MAX_STRING_LENGTH
];

1141 ià(
¬gum’t
.
	`em±y
()) {

1142 
boŞ
 
‘ched
 = 
çl£
;

1143 
	`¡c
("{WI‹m you‡» w—ršg:\n", 
ch
);

1145 
iW—r
 = 0; iW—¸< 
MAX_WEAR
; iWear++) {

1146 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
iW—r
)è=ğ
nuÎ±r
)

1149 
‘ched
 = 
afãù
::
	`exi¡s_Ú_obj
(
obj
,‡fãù::
ty³
::
acid_b»©h
è? 
Œue
 : 
çl£
;

1151 
FÜm©
::
	`¥rštf
(
buf
, "{M[{V%14s{M] {x%s %s\n"

1152 , 
	`cÚd™iÚ_lookup
(
obj
->
cÚd™iÚ
),

1153 
obj
->
shÜt_desü
, (
‘ched
) ? "{G({HEtched{G){x" : "");

1154 
	`¡c
(
buf
, 
ch
);

1155 
‘ched
 = 
çl£
;

1161 ià(
¬gum’t
 == "all") {

1162 
iW—r
 = 0; iW—¸< 
MAX_WEAR
; iWear++) {

1163 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
iW—r
)è=ğ
nuÎ±r
)

1166 
	`obj_»·œ
(
ch
, 
obj
);

1172 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬gum’t
)è=ğ
nuÎ±r
) {

1173 
	`¡c
("You‡»‚Ù c¬ryšgh©.\n", 
ch
);

1177 
	`obj_»·œ
(
ch
, 
obj
);

1178 
	}
}

1180 
	$obj_»·œ
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
)

1182 
Ch¬aù”
 *
rch
;

1183 
buf
[
MAX_STRING_LENGTH
];

1184 
max
 = 100;

1186 
rch
 = 
ch
->
š_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
)

1187 ià(
rch
->
	`is_Åc
(è&&„ch->
¥ec_fun
 =ğ
	`¥ec_lookup
("spec_blacksmith"))

1190 ià(
obj
->
cÚd™iÚ
 == -1) {

1191 
	`¡c
("Th© objeù i šde¡ruùabË!\n", 
ch
);

1195 cÚ¡ 
afãù
::
Afãù
 *
·f
;

1196 ià((
·f
 = 
afãù
::
	`fšd_Ú_obj
(
obj
,‡fãù::
ty³
::
acid_b»©h
)è!ğ
nuÎ±r
)

1197 
max
 = 100 - (5 * 
·f
->
modif›r
);

1199 ià(
obj
->
cÚd™iÚ
 >ğ
max
) {

1200 
	`¡c
("Th© objeù cªnÙ b»·œed fu¹h”.\n", 
ch
);

1204 ià(!
rch
) {

1205 ià(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
»·œ
)) {

1206 ià(!
	`deduù_¡amša
(
ch
, 
skl
::
ty³
::
»·œ
))

1209 
	`WAIT_STATE
(
ch
, 
skl
::
	`lookup
(skl::
ty³
::
»·œ
).
b—ts
);

1211 ià(
	`numb”_³rûÁ
(è> 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
»·œ
)) {

1212 
	`¡c
("You‡ccid’Îy damag™ mÜe!\n", 
ch
);

1213 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
»·œ
, 
çl£
, 8);

1214 
obj
->
cÚd™iÚ
 -ğ
	`numb”_¿nge
(10, 15);

1216 ià(
obj
->
cÚd™iÚ
 < 0)

1217 
obj
->
cÚd™iÚ
 = 0;

1219 ià(
obj
->
cÚd™iÚ
 == 0) {

1220 
	`aù
("{W$p{x ha b“À{Wde¡royed{x!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1221 
	`de¡roy_obj
(
obj
);

1227 
FÜm©
::
	`¥rštf
(
buf
, "$n„epairs $po %s condition.",

1228 
	`cÚd™iÚ_lookup
(
obj
->
cÚd™iÚ
));

1229 
	`aù
(
buf
, 
rch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1230 
obj
->
cÚd™iÚ
 = 
max
;

1231 
FÜm©
::
	`¥rštf
(
buf
, "You„epair $po %s condition.",

1232 
	`cÚd™iÚ_lookup
(
obj
->
cÚd™iÚ
));

1233 
	`aù
(
buf
, 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

1234 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
»·œ
, 
Œue
, 8);

1238 
	`¡c
("NØÚh”ÿÀ»·œh© i‹m.\n", 
ch
);

1242 ià((
ch
->
sv”
 + 100 * ch->
gŞd
è< (
max
 - 
obj
->
cÚd™iÚ
) * 100) {

1243 
	`aù
("$n says, 'You don't haveƒnough moneyo„epair $p.",

1244 
rch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1248 
	`deduù_co¡
(
ch
, (
max
 - 
obj
->
cÚd™iÚ
) * 100);

1249 
FÜm©
::
	`¥rštf
(
buf
, "The„epairs on %s has cost you %d gold.\n",

1250 
obj
->
shÜt_desü
, (
max
 - obj->
cÚd™iÚ
));

1251 
	`¡c
(
buf
, 
ch
);

1254 
obj
->
cÚd™iÚ
 = 
max
;

1255 
FÜm©
::
	`¥rštf
(
buf
, "$n„epairs $po %s condition.",

1256 
	`cÚd™iÚ_lookup
(
obj
->
cÚd™iÚ
));

1257 
	`aù
(
buf
, 
rch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

1258 
	}
}

1260 
boŞ
 
	$¥ec_fight_şªgu¬d
(
Ch¬aù”
 *
ch
)

1262  
Œue
;

1263 
	}
}

1265 
boŞ
 
	$¥ec_şªgu¬d
(
Ch¬aù”
 *
ch
)

1267 
CÏn
 *
şª
;

1268 
Ch¬aù”
 *
viùim
, *
v_Ãxt
;

1269 
boŞ
 
found
 = 
çl£
;

1271 ià(!
ch
->
	`is_Åc
()

1272 || !
	`IS_AWAKE
(
ch
)

1273 || 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ÿlm
)

1274 || 
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
)

1275 || 
ch
->
š_room
 =ğ
nuÎ±r
)

1276  
çl£
;

1278 ià((
şª
 = 
	`şª_vnum_lookup
(
ch
->
pIndexD©a
->
vnum
)è=ğ
nuÎ±r
)

1279  
çl£
;

1281 ià(
ch
->
š_room
->
	`şª
(è!ğ
şª
)

1282  
çl£
;

1284 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = 
v_Ãxt
) {

1285 
v_Ãxt
 = 
viùim
->
Ãxt_š_room
;

1287 ià(
viùim
->
fightšg
 =ğ
ch
 || 
	`IS_IMMORTAL
(victim))

1290 ià(!
viùim
->
şª
 || viùim->şª =ğşª || viùim->
šv™”s
 == clan)

1293 ià(!
	`şª_İpÚ’ts
(
şª
, 
viùim
->clan))

1296 ià(!
found
) {

1297 
ch
->
comm_æags
 -ğ
COMM_NOCHANNELS
;

1298 
	`do_y–l
(
ch
, "Invaders! KILL THE INFIDELS!!");

1301 
	`muÉi_h™
(
ch
, 
viùim
, 
skl
::
ty³
::
unknown
);

1302 
found
 = 
Œue
;

1305 ià(
ch
->
fightšg
)

1306 
	`¥ec_fight_şªgu¬d
(
ch
);

1308  
found
;

1309 
	}
}

1324 
boŞ
 
	$IS_SPECIAL
(
Ch¬aù”
 *
ch
)

1326 ià(
ch
->
	`is_Åc
())

1327  
çl£
;

1329 ià(
ch
->
Çme
 == "Montrey"

1330 || 
ch
->
Çme
 == "Xenith"

1331 || 
ch
->
Çme
 == "Vegita")

1332  
Œue
;

1334  
çl£
;

1335 
	}
}

1345 
	$do_çmŸr
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1348 ià(
ch
->
	`is_Åc
())

1352 ià(
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
çmŸr
) < 1) {

1353 
	`¡c
("You dÚ'ˆknow howØü—‹‡ famŸr.\n", 
ch
);

1358 ià(
ch
->
pcd©a
->
çmŸr
) {

1359 
	`¡c
("You‡Ì—dy hav¨çmŸr.\n", 
ch
);

1364 ià(! 
ch
->
³t
) {

1365 
	`¡c
("You‚“d‡…‘ fœ¡.\n", 
ch
);

1369 
ch
->
pcd©a
->
çmŸr
 = 
Œue
;

1370 
	`¡c
("You f“È© oÃ w™h you¸³t.\n", 
ch
);

1371 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
çmŸr
, 
Œue
, 1);

1373 
	}
}

	@src/sqlite.cc

8 
	~<sql™e3.h
>

10 
	~"Game.hh
"

11 
	~"deş¬e.hh
"

12 
	~"FÏgs.hh
"

13 
	~"Loggšg.hh
"

14 
	~"sql.hh
"

15 
	~"SŒšg.hh
"

16 
	~"cÚ¡ªts.hh
"

18 
sql™e3
* 
	g_db
 = 
nuÎ±r
;

19 
sql™e3_¡mt
* 
	g_»suÉ
 = 
nuÎ±r
;

21 
	$db_İ’
()

23 
”rÜ
;

25 ià(
_db
)

26 
Loggšg
::
	`bug
("db_open: db is‚ot‚ullptr, opening‡nyway", 0);

28 
”rÜ
 = 
	`sql™e3_İ’_v2
(
DB_FILE
, &
_db
, 
SQLITE_OPEN_READWRITE
, 
nuÎ±r
);

30 ià(
”rÜ
 !ğ
SQLITE_OK
)

31 
	`db_”rÜ
("db_open");

32 
	}
}

34 
	$db_şo£
()

36 ià(
_db
 !ğ
nuÎ±r
) {

37 
	`sql™e3_şo£
(
_db
);

38 
_db
 = 
nuÎ±r
;

40 
	}
}

42 
	$db_”rÜ
(cÚ¡ 
SŒšg
& 
func
, cÚ¡ SŒšg& 
qu”y
)

44 ià(!
qu”y
.
	`em±y
())

45 
Loggšg
::
	`bugf
("%s: %s, oÀqu”y '%s'", 
func
, 
	`sql™e3_”rmsg
(
_db
), 
qu”y
);

47 
Loggšg
::
	`bugf
("%s: %s", 
func
, 
	`sql™e3_”rmsg
(
_db
));

49 ià(
Game
::
boÙšg
) {

50 
	`db_şo£
();

51 
	`ex™
(1);

53 
	}
}

55 
	$db_Ãxt_row
() {

56 
»t
 = 
	`sql™e3_¡•
(
_»suÉ
);

58 
»t
) {

59 
SQLITE_ROW
:

60  
SQL_OK
;

61 
SQLITE_BUSY
:

62 
SQLITE_DONE
:

63 
SQLITE_ERROR
:

64 
SQLITE_MISUSE
:

69  
SQL_ERROR
;

70 
	}
}

72 
	$db_g‘_cŞumn_št
(
šdex
) {

73  
	`sql™e3_cŞumn_št
(
_»suÉ
, 
šdex
);

74 
	}
}

76 cÚ¡ 
FÏgs
 
	$db_g‘_cŞumn_æags
(
šdex
) {

77  
	`FÏgs
(
	`sql™e3_cŞumn_št
(
_»suÉ
, 
šdex
));

78 
	}
}

80 cÚ¡ * 
	$db_g‘_cŞumn_¡r
(
šdex
) {

81  (*)
	`sql™e3_cŞumn_‹xt
(
_»suÉ
, 
šdex
);

82 
	}
}

85 
	$db_qu”y
(cÚ¡ 
SŒšg
& 
func
, cÚ¡ SŒšg& 
qu”y
)

87 
”rÜ
;

89 ià(
_db
 =ğ
nuÎ±r
)

90 
	`db_İ’
();

92 ià(
_»suÉ
 !ğ
nuÎ±r
) {

94 
	`sql™e3_fš®ize
(
_»suÉ
);

95 
_»suÉ
 = 
nuÎ±r
;

98 
”rÜ
 = 
	`sql™e3_´•¬e_v2
(
_db
, 
qu”y
.
	`c_¡r
(), -1, &
_»suÉ
, 
nuÎ±r
);

100 ià(
”rÜ
 !ğ
SQLITE_OK
) {

101 
	`db_”rÜ
("db_qu”y", 
qu”y
);

102  
SQL_ERROR
;

105  
SQL_OK
;

106 
	}
}

109 
	$db_commªd
(cÚ¡ 
SŒšg
& 
func
, cÚ¡ SŒšg& 
qu”y
)

111 
”rÜ
 = 
	`db_qu”y
(
func
, 
qu”y
);

113 ià(
”rÜ
 =ğ
SQL_OK
)

114 
”rÜ
 = 
	`db_Ãxt_row
();

116  
”rÜ
;

117 
	}
}

123 
	$db_couÁ
(cÚ¡ 
SŒšg
& 
func
, cÚ¡ SŒšg& 
qu”y
)

125 
”rÜ
 = 
	`db_commªd
(
func
, 
qu”y
);

127 ià(
”rÜ
 =ğ
SQL_OK
)

128  
	`db_g‘_cŞumn_št
(0);

131 
	}
}

133 
	$db_rows_afãùed
() {

134  
	`sql™e3_chªges
(
_db
);

135 
	}
}

138 
SŒšg
 
	$db_esc
(cÚ¡ 
SŒšg
& 
¡r
)

140 
SŒšg
 
buf
;

142 
c
 : 
¡r
) {

143 ià(
c
 == '\'')

144 
buf
 += '\'';

150 
buf
 +ğ
c
;

153  
buf
;

154 
	}
}

	@src/storage.cc

1 
	~"cÚ¡ªts.hh
"

2 
	~"deş¬e.hh
"

3 
	~"fe.hh
"

4 
	~"FÜm©.hh
"

5 
	~"Loggšg.hh
"

6 
	~"StÜedPÏy”.hh
"

7 
	~"SŒšg.hh
"

9 
»ad_lše
(
FILE
 *, 
StÜedPÏy”
 *);

10 
§ve_lše
(
FILE
 *, 
StÜedPÏy”
 *);

14 
StÜedPÏy”
 *
	g¡Üage_li¡_h—d
;

15 
StÜedPÏy”
 *
	g¡Üage_li¡_
;

19 
	$»ad_lše
(
FILE
 *
å
, 
StÜedPÏy”
 *
sd
)

21 
sd
->
Çme
 = 
	`ä—d_¡ršg
(
å
);

22 
sd
->
by_who
 = 
	`ä—d_¡ršg
(
å
);

23 
sd
->
d©e
 = 
	`ä—d_¡ršg
(
å
);

24 
	}
}

26 
	$§ve_lše
(
FILE
 *
å
, 
StÜedPÏy”
 *
sd
)

28 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
sd
->
Çme
);

29 
FÜm©
::
	`årštf
(
å
, "%s~\n", 
sd
->
by_who
);

30 
FÜm©
::
	`årštf
(
å
, "%s~\n\n", 
sd
->
d©e
);

31 
	}
}

33 
	$š£¹_¡Üaged©a
(
StÜedPÏy”
 *
Ãwd©a
)

35 
StÜedPÏy”
 *
i
;

36 
i
 = 
¡Üage_li¡_h—d
->
Ãxt
;

38 
i
 !ğ
¡Üage_li¡_
) {

39 ià(
	`¡rÿ£cmp
(
Ãwd©a
->
Çme
, 
i
->name) < 1) {

40 
Ãwd©a
->
´evious
 = 
i
->previous;

41 
Ãwd©a
->
´evious
->
Ãxt
 =‚ewdata;

42 
Ãwd©a
->
Ãxt
 = 
i
;

43 
i
->
´evious
 = 
Ãwd©a
;

47 
i
 = i->
Ãxt
;

50 
i
 = 
¡Üage_li¡_
->
´evious
;

51 
i
->
Ãxt
 = 
Ãwd©a
;

52 
Ãwd©a
->
´evious
 = 
i
;

53 
Ãwd©a
->
Ãxt
 = 
¡Üage_li¡_
;

54 
¡Üage_li¡_
->
´evious
 = 
Ãwd©a
;

56 
	}
}

58 
	$»move_¡Üaged©a
(
StÜedPÏy”
 *
Şdd©a
)

60 
StÜedPÏy”
 *
i
;

61 
i
 = 
¡Üage_li¡_h—d
->
Ãxt
;

63 
i
 !ğ
¡Üage_li¡_
) {

64 ià(!
	`¡rÿ£cmp
(
Şdd©a
->
Çme
, 
i
->name)) {

65 
StÜedPÏy”
 *
p
 = 
i
->
´evious
;

66 
StÜedPÏy”
 *
n
 = 
i
->
Ãxt
;

67 
p
->
Ãxt
 = 
n
;

68 
n
->
´evious
 = 
p
;

69 
d–‘e
 
i
;

73 
i
 = i->
Ãxt
;

75 
	}
}

77 
StÜedPÏy”
 *
	$lookup_¡Üage_d©a
(cÚ¡ 
SŒšg
& 
Çme
)

79 
StÜedPÏy”
 *
i
;

80 
i
 = 
¡Üage_li¡_h—d
->
Ãxt
;

82 
i
 !ğ
¡Üage_li¡_
) {

83 ià(!
	`¡rÿ£cmp
(
i
->
Çme
,‚ame))

84  
i
;

86 
i
 = i->
Ãxt
;

89  
nuÎ±r
;

90 
	}
}

92 
	$couÁ_¡Üed_ch¬aù”s
()

94 
StÜedPÏy”
 *
i
;

95 
couÁ
 = 0;

96 
i
 = 
¡Üage_li¡_h—d
->
Ãxt
;

98 
i
 !ğ
¡Üage_li¡_
) {

99 
couÁ
++;

100 
i
 = i->
Ãxt
;

103  
couÁ
;

104 
	}
}

106 
	$lßd_¡Üage_li¡
()

108 
FILE
 *
å
;

109 
couÁ
, 
i
;

110 
¡Üage_li¡_h—d
 = 
Ãw
 
StÜedPÏy”
;

111 
¡Üage_li¡_
 = 
Ãw
 
StÜedPÏy”
;

112 
¡Üage_li¡_h—d
->
Ãxt
 = 
¡Üage_li¡_
;

113 
¡Üage_li¡_
->
´evious
 = 
¡Üage_li¡_h—d
;

115 ià((
å
 = 
	`fİ’
(
STORAGE_FILE
, "r")è=ğ
nuÎ±r
) {

116 
Loggšg
::
	`bug
("load_storage_list: Cannot open STORAGE_FILE!", 0);

120 
	`fsÿnf
(
å
, "%d\n", &
couÁ
);

122 
i
 = 0; i < 
couÁ
; i++) {

123 
StÜedPÏy”
 *
ÃwD©a
 = 
Ãw
 StoredPlayer;

125 ià(
ÃwD©a
 =ğ
nuÎ±r
) {

126 
Loggšg
::
	`bug
("Failedo‡llocate memory for StoredPlayer!", 0);

130 
	`»ad_lše
(
å
, 
ÃwD©a
);

131 
	`š£¹_¡Üaged©a
(
ÃwD©a
);

134 
	`fşo£
(
å
);

135 
FÜm©
::
	`´štf
("%d ch¬aù” š stÜagfound.\n", 
couÁ
);

136 
	}
}

138 
	$§ve_¡Üage_li¡
()

140 
FILE
 *
å
;

141 
StÜedPÏy”
 *
i
;

143 ià((
å
 = 
	`fİ’
(
STORAGE_FILE
, "w")è=ğ
nuÎ±r
) {

144 
Loggšg
::
	`bug
("save_storage_list: Cannot open STORAGE_FILE!", 0);

148 
FÜm©
::
	`årštf
(
å
, "%d\n", 
	`couÁ_¡Üed_ch¬aù”s
());

149 
i
 = 
¡Üage_li¡_h—d
->
Ãxt
;

151 
i
 !ğ
¡Üage_li¡_
) {

152 
	`§ve_lše
(
å
, 
i
);

153 
i
 = i->
Ãxt
;

156 
	`fşo£
(
å
);

157 
	}
}

	@src/tables.cc

11 
	~"bËs.hh
"

13 
	~<veùÜ
>

15 
	~"FÏgs.hh
"

16 
	~"m”c.hh
"

17 
	~"SŒšg.hh
"

20 cÚ¡ 
SŒšg
 
	gMsyl1
[] = {

31 cÚ¡ 
SŒšg
 
	gMsyl2
[] = {

38 cÚ¡ 
SŒšg
 
	gMsyl3
[] = {

50 cÚ¡ 
SŒšg
 
	gFsyl1
[] = {

61 cÚ¡ 
SŒšg
 
	gFsyl2
[] = {

69 cÚ¡ 
SŒšg
 
	gFsyl3
[] = {

79 cÚ¡ 
	g¡d
::
veùÜ
<
MagT_ty³
> 
MagT_bË
 = {

103 cÚ¡ 
	g¡d
::
veùÜ
<
CËT_ty³
> 
CËT_bË
 = {

124 cÚ¡ 
	g¡d
::
veùÜ
<
ThiT_ty³
> 
ThiT_bË
 = {

149 cÚ¡ 
	g¡d
::
veùÜ
<
W¬T_ty³
> 
W¬T_bË
 = {

174 cÚ¡ 
	g¡d
::
veùÜ
<
chª_ty³
> 
chª_bË
 = {

177 
CSLOT_CHAN_GOSSIP
, 
COMM_NOGOSSIP
, 
REVOKE_GOSSIP


181 
CSLOT_CHAN_FLAME
, 
COMM_NOFLAME
, 
REVOKE_FLAME


185 
CSLOT_CHAN_QWEST
, 
COMM_NOQWEST
, 
REVOKE_QWEST


189 
CSLOT_CHAN_PRAY
, 
COMM_NOPRAY
, 
REVOKE_PRAY


193 
CSLOT_CHAN_CLAN
, 
COMM_NOCLAN
, 
REVOKE_CLAN


197 
CSLOT_CHAN_MUSIC
, 
COMM_NOMUSIC
, 
REVOKE_MUSIC


201 
CSLOT_CHAN_IC
, 
COMM_NOIC
, 
REVOKE_IC


205 
CSLOT_CHAN_GRATS
, 
COMM_NOGRATS
, 
REVOKE_GRATS


209 
CSLOT_CHAN_IMM
, 
COMM_NOWIZ
, 
REVOKE_NULL


213 
CSLOT_CHAN_QA
, 
COMM_NOQUESTION
, 
REVOKE_QA


217 
CSLOT_CHAN_AUCTION
, 
COMM_NOAUCTION
, 
REVOKE_AUCTION


221 cÚ¡ 
	g¡d
::
veùÜ
<
»voke_ty³
> 
»voke_bË
 = {

223 { "æameÚly", 
REVOKE_FLAMEONLY
, "abilityo use channels otherhan FLAME" },

224 { "nochªÃl", 
REVOKE_NOCHANNELS
, "channel…riviledges" },

225 { "´ay", 
REVOKE_PRAY
, "abilityo PRAY" },

226 { "goss", 
REVOKE_GOSSIP
, "abilityo GOSSIP" },

227 { "æame", 
REVOKE_FLAME
, "abilityo FLAME" },

228 { "qwe¡", 
REVOKE_QWEST
, "abilityo QWEST" },

229 { "auùiÚ", 
REVOKE_AUCTION
, "abilityo AUCTION" },

230 { "şªlk", 
REVOKE_CLAN
, "abilityo CLANTALK" },

231 { "music", 
REVOKE_MUSIC
, "abilityo MUSIC" },

232 { "que¡iÚ", 
REVOKE_QA
, "abilityo QUESTION‡nd ANSWER" },

233 { "ªsw”", 
REVOKE_QA
, "abilityo QUESTION‡nd ANSWER" },

234 { "ic", 
REVOKE_IC
, "abilityoalk IN CHARACTER" },

235 { "socŸl", 
REVOKE_SOCIAL
, "abilityo SOCIALize" },

236 { "g¿ts", 
REVOKE_GRATS
, "abilityo offer GRATS" },

237 { "·ge", 
REVOKE_PAGE
, "abilityo PAGE…eople" },

238 { "q‹Î", 
REVOKE_QTELL
, "abilityoalko your QUERY" },

239 { "§y", 
REVOKE_SAY
, "abilityo SAY‡nything" },

240 { "‹Î", 
REVOKE_TELL
, "abilityo send TELLs" },

241 { "emÙe", 
REVOKE_EMOTE
, "abilityo EMOTE" },

242 { "exp", 
REVOKE_EXP
, "abilityo†earn from your EXPeriences" },

243 { "nÙe", 
REVOKE_NOTE
, "abilityo write NOTEs" },

246 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
cgroup_æags
 = {

247 { "G’”®", 
GROUP_GEN
, 
Œue
 },

248 { "Que¡", 
GROUP_QUEST
, 
Œue
 },

249 { "Budšg", 
GROUP_BUILD
, 
Œue
 },

250 { "Cod”", 
GROUP_CODE
, 
Œue
 },

251 { "Secur™y", 
GROUP_SECURE
, 
Œue
 },

252 { "PÏy”", 
GROUP_PLAYER
, 
Œue
 },

253 { "Mobe", 
GROUP_MOBILE
, 
Œue
 },

254 { "CÏn", 
GROUP_CLAN
, 
Œue
 },

255 { "Av©¬", 
GROUP_AVATAR
, 
Œue
 },

256 { "H”o", 
GROUP_HERO
, 
Œue
 },

257 { "D•uty", 
GROUP_DEPUTY
, 
Œue
 },

258 { "L—d”", 
GROUP_LEADER
, 
Œue
 },

263 cÚ¡ 
	g¡d
::
veùÜ
<
wizÃt_ty³
> 
wizÃt_bË
 = {

264 { "wizÃt", 
WIZ_ON
, 
IMM
, "You will see wiznet messages." },

265 { "´efix", 
WIZ_PREFIX
, 
IMM
, "You will seehe {G<W{Hizne{Gt>{x…refix." },

266 { "logšs", 
WIZ_LOGINS
, 
IMM
, "You will be‚otified when…layers‡rrive‡nd depart." },

267 { "lšks", 
WIZ_LINKS
, 
IMM
, "You will be‚otified when…layers go†inkdead‡nd„eturn." },

268 { "Ãwb›s", 
WIZ_NEWBIE
, 
IMM
, "You will be‚otified of‚ew…layers." },

269 { "¥am", 
WIZ_SPAM
, 
IMM
, "You will be‚otified of spam." },

270 { "d—ths", 
WIZ_DEATHS
, 
IMM
, "You will be‚otified when‡…layer dies." },

271 { "³ÇÉ›s", 
WIZ_PENALTIES
, 
IMM
, "You will be‚otified of‚ochannels, bans, freezes,ƒtc." },

272 { "Ëv–s", 
WIZ_LEVELS
, 
IMM
, "You will be‚otified when…layers†evel." },

273 { "misc", 
WIZ_MISC
, 
IMM
, "You will be‚otified when…layers change PK or RP status." },

274 { "ch—‹rs", 
WIZ_CHEAT
, 
IMM
, "You will be‚otified when…layers‡ttemptoƒxploithe system." },

275 { "ma", 
WIZ_MAIL
, 
IMM
, "You will see who is…osting mail or changingheirƒmail‡ddress." },

276 { "auùiÚ", 
WIZ_AUCTION
, 
IMM
, "You will be‚otified of‡uction details." },

277 { "que¡s", 
WIZ_QUEST
, 
IMM
, "You will be‚otified of quest details." },

278 { "bugs", 
WIZ_BUGS
, 
IMM
, "You will see bugƒrror messages." },

279 { "æags", 
WIZ_FLAGS
, 
IMM
, "You will be‚otified of killer/thief flags." },

280 { "»£ts", 
WIZ_RESETS
, 
IMM
, "You will be‚otified when‡n‡rea„esets." },

281 { "mobd—ths", 
WIZ_MOBDEATHS
, 
IMM
, "You will be‚otified when‡n NPC dies." },

282 { "§ccšg", 
WIZ_SACCING
, 
IMM
, "You will be‚otified of sacrifices." },

283 { "»¡Ües", 
WIZ_RESTORE
, 
HED
, "You will see„estore commands." },

284 { "purges", 
WIZ_PURGE
, 
HED
, "You will see…urge commands." },

285 { "lßds", 
WIZ_LOAD
, 
HED
, "You will see†oad commands." },

286 { "sw™ches", 
WIZ_SWITCHES
, 
HED
, "You will see morphs." },

287 { "s™es", 
WIZ_SITES
, 
HED
, "You will seehe site‡ddress on connects." },

288 { "m®loc", 
WIZ_MALLOC
, 
IMP
, "You will see memory‡llocation spam." },

289 { "¢oİs", 
WIZ_SNOOPS
, 
IMP
, "You will see snoop commands." },

290 { "£cu»", 
WIZ_SECURE
, 
IMP
, "The catch‡ll of generic Imm commands." },

293 cÚ¡ 
¿fãùs
 
	g¿fãùs
[
MAX_RAFFECTS
] = {

411 "VSÏsh", 950, 900, 15, 
VULN_SLASH


415 "VP›rû", 901, 901, 15, 
VULN_PIERCE


419 "VBluÁ", 902, 902, 15, 
VULN_BASH


423 "VFœe", 903, 903, 15, 
VULN_FIRE


427 "VCŞd", 904, 904, 15, 
VULN_COLD


431 "VEËùric", 905, 905, 15, 
VULN_ELECTRICITY


435 "VAcid", 906, 906, 15, 
VULN_ACID


439 "VPoisÚ", 907, 907, 30, 
VULN_POISON


443 "VDi£a£", 908, 908, 30, 
VULN_DISEASE


447 "VNeg©ive", 909, 909, 30, 
VULN_NEGATIVE


451 "VHŞy", 910, 910, 30, 
VULN_HOLY


455 "VEÃrgy", 911, 911, 30, 
VULN_ENERGY


459 "VM’l", 912, 912, 30, 
VULN_MENTAL


463 "VDrownšg", 913, 913, 30, 
VULN_DROWNING


467 "VLight", 914, 914, 30, 
VULN_LIGHT


471 "VSound", 915, 915, 30, 
VULN_SOUND


478 "RSÏsh", 900, 950, 15, 
RES_SLASH


482 "RP›rû", 901, 951, 15, 
RES_PIERCE


486 "RBluÁ", 902, 952, 15, 
RES_BASH


490 "RFœe", 903, 953, 15, 
RES_FIRE


494 "RCŞd", 904, 954, 15, 
RES_COLD


498 "REËùric", 905, 955, 15, 
RES_ELECTRICITY


502 "RAcid", 906, 956, 15, 
RES_ACID


506 "RPoisÚ", 907, 957, 30, 
RES_POISON


510 "RDi£a£", 908, 958, 30, 
RES_DISEASE


514 "RNeg©ive", 909, 959, 30, 
RES_NEGATIVE


518 "RHŞy", 910, 960, 30, 
RES_HOLY


522 "REÃrgy", 911, 961, 30, 
RES_ENERGY


526 "RM’l", 912, 962, 30, 
RES_MENTAL


530 "RDrownšg", 913, 963, 30, 
RES_DROWNING


534 "RLight", 914, 964, 30, 
RES_LIGHT


538 "RSound", 915, 965, 30, 
RES_SOUND


543 cÚ¡ 
	g¡d
::
veùÜ
<
pos™iÚ_ty³
> 
pos™iÚ_bË
 = {

557 cÚ¡ 
	g¡d
::
veùÜ
<
£x_ty³
> 
£x_bË
 = {

562 cÚ¡ 
	g¡d
::
veùÜ
<
size_ty³
> 
size_bË
 = {

569 cÚ¡ 
SŒšg
 
	gf›ld_ÿnd
[] = {

580 cÚ¡ 
	g¡d
::
veùÜ
<
f›ld_ty³
> 
æag_f›lds
 = {

582 { "¶ay”", 
¶r_æags
, 
CAND_PLAYER
, 999, 
IMM
, 999, 
HED
 },

583 { "pcd©a", 
pcd©a_æags
, 
CAND_PLAYER
, 999, 
IMM
, 999, 
HED
 },

584 { "cgroup", 
cgroup_æags
, 
CAND_PLAYER
, 999, 
HED
, 999, 
IMP
 },

585 { "wizÃt", 
wiz_æags
, 
CAND_PLAYER
, 999, 
HED
, 999, 
IMP
 },

586 { "»voke", 
»voke_æags
, 
CAND_CHAR
, 
IMM
, IMM, IMM, 
HED
 },

587 { "ûnsÜ", 
ûnsÜ_æags
, 
CAND_CHAR
, 
IMM
, IMM, IMM, 
IMP
 },

588 { "communiÿtiÚs", 
comm_æags
, 
CAND_CHAR
, 
IMM
, IMM, IMM, 
HED
 },

589 { "aù", 
aù_æags
, 
CAND_MOB
, 
MTL
, 999, 
IMM
, 999 },

590 { "ofãnsive", 
off_æags
, 
CAND_MOB
, 
MTL
, 999, 
IMM
, 999 },

591 { "fÜm", 
fÜm_æags
, 
CAND_MOB
, 
MTL
, MTL, 
IMM
, 999 },

592 { "·¹s", 
·¹_æags
, 
CAND_MOB
, 
MTL
, MTL, 
IMM
, 999 },

593 { "group", 
group_æags
, 
CAND_MOB
, 
MTL
, 999, 
IMM
, 999 },

594 { "exŒa", 
exŒa_æags
, 
CAND_OBJ
, 
MTL
, 999, 
IMM
, 999 },

596 { "w—r", 
w—r_æags
, 
CAND_OBJ
, 
MTL
, 999, 
IMM
, 999 },

598 { "room", 
room_æags
, 
CAND_ROOM
, 
IMM
, 999, IMM, 999 },

601 cÚ¡ 
	g¡d
::
veùÜ
<
£ùÜ_ty³
> 
£ùÜ_bË
 = {

602 { "šdoÜs", 
SeùÜ
::
šside
 },

603 { "c™y", 
SeùÜ
::
c™y
 },

604 { "rßd", 
SeùÜ
::
rßd
 },

605 { "f›ld", 
SeùÜ
::
f›ld
 },

606 { "¥¬£ fÜe¡",
SeùÜ
::
fÜe¡_¥¬£
 },

607 { "fÜe¡", 
SeùÜ
::
fÜe¡_medium
 },

608 { "d’£ fÜe¡", 
SeùÜ
::
fÜe¡_d’£
 },

609 { "hls", 
SeùÜ
::
hls
 },

610 { "mouÁaš", 
SeùÜ
::
mouÁaš
 },

611 { "w©”", 
SeùÜ
::
w©”_swim
 },

612 { "oûª", 
SeùÜ
::
w©”_noswim
 },

613 { "aœ", 
SeùÜ
::
aœ
 },

614 { "de£¹", 
SeùÜ
::
de£¹
 },

615 { "¬’a", 
SeùÜ
::
¬’a
 },

616 { "şª‡»Ç", 
SeùÜ
::
şª¬’a
 },

617 { "¬—ƒÁ¿nû",
SeùÜ
::
¬—_’Œªû
 },

621 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
cÚt_æags
 = {

622 { "şo§bË", 
CONT_CLOSEABLE
, 
Œue
 },

623 { "pick´oof", 
CONT_PICKPROOF
, 
Œue
 },

624 { "şo£d", 
CONT_CLOSED
, 
Œue
 },

625 { "locked", 
CONT_LOCKED
, 
Œue
 },

628 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
aù_æags
 = {

629 { "nosummÚ", 
FÏgs
::
A
, 
Œue
 },

630 { "£Áš–", 
FÏgs
::
B
, 
Œue
 },

631 { "sÿv’g”", 
FÏgs
::
C
, 
Œue
 },

632 { "mÜph", 
FÏgs
::
E
, 
çl£
 },

633 { "agg»ssive", 
FÏgs
::
F
, 
Œue
 },

634 { "¡ay_¬—", 
FÏgs
::
G
, 
Œue
 },

635 { "wimpy", 
FÏgs
::
H
, 
Œue
 },

636 { "³t", 
FÏgs
::
I
, 
Œue
 },

637 { "Œaš", 
FÏgs
::
J
, 
Œue
 },

638 { "´aùiû", 
FÏgs
::
K
, 
Œue
 },

639 { "¡ay", 
FÏgs
::
L
, 
Œue
 },

640 { "und—d", 
FÏgs
::
O
, 
Œue
 },

641 { "ş”ic", 
FÏgs
::
Q
, 
Œue
 },

642 { "mage", 
FÏgs
::
R
, 
Œue
 },

643 { "th›f", 
FÏgs
::
S
, 
Œue
 },

644 { "w¬riÜ", 
FÏgs
::
T
, 
Œue
 },

645 { "nßlign", 
FÏgs
::
U
, 
Œue
 },

646 { "nİurge", 
FÏgs
::
V
, 
Œue
 },

647 { "outdoÜs", 
FÏgs
::
W
, 
Œue
 },

648 { "šdoÜs", 
FÏgs
::
Y
, 
Œue
 },

649 { "nİush", 
FÏgs
::
Z
, 
Œue
 },

650 { "h—Ër", 
FÏgs
::
a
, 
Œue
 },

651 { "gaš", 
FÏgs
::
b
, 
Œue
 },

652 { "chªg”", 
FÏgs
::
d
, 
Œue
 },

655 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
w—r_æags
 = {

656 { "ke", 
FÏgs
::
A
, 
Œue
 },

657 { "fšg”", 
FÏgs
::
B
, 
Œue
 },

658 { "Ãck", 
FÏgs
::
C
, 
Œue
 },

659 { "tÜso", 
FÏgs
::
D
, 
Œue
 },

660 { "h—d", 
FÏgs
::
E
, 
Œue
 },

661 { "Ëgs", 
FÏgs
::
F
, 
Œue
 },

662 { "ã‘", 
FÏgs
::
G
, 
Œue
 },

663 { "hªds", 
FÏgs
::
H
, 
Œue
 },

664 { "¬ms", 
FÏgs
::
I
, 
Œue
 },

665 { "sh›ld", 
FÏgs
::
J
, 
Œue
 },

666 { "body", 
FÏgs
::
K
, 
Œue
 },

667 { "wai¡", 
FÏgs
::
L
, 
Œue
 },

668 { "wri¡", 
FÏgs
::
M
, 
Œue
 },

669 { "w›ld", 
FÏgs
::
N
, 
Œue
 },

670 { "hŞd", 
FÏgs
::
O
, 
Œue
 },

671 { "no§c", 
FÏgs
::
P
, 
Œue
 },

672 { "æßtšg", 
FÏgs
::
Q
, 
Œue
 },

673 { "weddšgršg", 
FÏgs
::
R
, 
Œue
 },

676 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
¶r_æags
 = {

677 { "nosummÚ", 
FÏgs
::
A
, 
Œue
 },

678 { "lookšp™", 
FÏgs
::
B
, 
Œue
 },

679 { "autßssi¡", 
FÏgs
::
C
, 
Œue
 },

680 { "autÛx™", 
FÏgs
::
D
, 
Œue
 },

681 { "autŞoÙ", 
FÏgs
::
E
, 
Œue
 },

682 { "auto§c", 
FÏgs
::
F
, 
Œue
 },

683 { "autogŞd", 
FÏgs
::
G
, 
Œue
 },

684 { "auto¥l™", 
FÏgs
::
H
, 
Œue
 },

685 { "showdeãn£", 
FÏgs
::
I
, 
Œue
 },

686 { "autÜeÿÎ", 
FÏgs
::
J
, 
Œue
 },

687 { "que¡Ü", 
FÏgs
::
K
, 
Œue
 },

688 { "üazycŞÜ", 
FÏgs
::
L
, 
Œue
 },

689 { "vt100", 
FÏgs
::
M
, 
Œue
 },

690 { "makebag", 
FÏgs
::
O
, 
Œue
 },

691 { "ÿn_loÙ", 
FÏgs
::
P
, 
Œue
 },

692 { "nÚe", 
FÏgs
::
Q
, 
çl£
 },

693 { "nofŞlow", 
FÏgs
::
R
, 
çl£
 },

694 { "cŞÜ", 
FÏgs
::
S
, 
Œue
 },

695 { "³rm™", 
FÏgs
::
U
, 
Œue
 },

696 { "şo£dlock”", 
FÏgs
::
V
, 
Œue
 },

697 { "log", 
FÏgs
::
W
, 
Œue
 },

698 { "ä“ze", 
FÏgs
::
Y
, 
Œue
 },

699 { "th›f", 
FÏgs
::
Z
, 
Œue
 },

700 { "kËr", 
FÏgs
::
a
, 
Œue
 },

701 { "su³rwiz", 
FÏgs
::
b
, 
çl£
 },

702 { "autÙick", 
FÏgs
::
c
, 
Œue
 },

703 { "chªg”", 
FÏgs
::
d
, 
Œue
 },

704 { "Ëad”", 
FÏgs
::
e
, 
Œue
 },

707 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
pcd©a_æags
 = {

708 { "ooc", 
FÏgs
::
A
, 
Œue
 },

709 { "ch©mode", 
FÏgs
::
B
, 
Œue
 },

710 { "´iv©e", 
FÏgs
::
C
, 
Œue
 },

711 { "¡İüash", 
FÏgs
::
D
, 
Œue
 },

712 { "pk", 
FÏgs
::
E
, 
Œue
 },

713 { "»mÜt", 
FÏgs
::
F
, 
Œue
 },

714 { "showema", 
FÏgs
::
G
, 
Œue
 },

715 { "lškd—d", 
FÏgs
::
H
, 
Œue
 },

716 { "·štbow", 
FÏgs
::
I
, 
Œue
 },

717 { "¢oİ´oof", 
FÏgs
::
J
, 
Œue
 },

718 { "showlogš", 
FÏgs
::
K
, 
Œue
 },

719 { "autİ“k", 
FÏgs
::
M
, 
Œue
 },

720 { "h“dÇme", 
FÏgs
::
N
, 
Œue
 },

721 { "showlo¡", 
FÏgs
::
O
, 
Œue
 },

722 { "exŒaskl", 
FÏgs
::
P
, 
Œue
 },

723 { "show¿ff", 
FÏgs
::
Q
, 
Œue
 },

724 { "m¬r›d", 
FÏgs
::
R
, 
Œue
 },

725 { "sque¡Ü", 
FÏgs
::
S
, 
Œue
 },

728 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
wiz_æags
 = {

729 { "Ú", 
FÏgs
::
A
, 
Œue
 },

730 { "ticks", 
FÏgs
::
B
, 
Œue
 },

731 { "logšs", 
FÏgs
::
C
, 
Œue
 },

732 { "s™es", 
FÏgs
::
D
, 
Œue
 },

733 { "lšks", 
FÏgs
::
E
, 
Œue
 },

734 { "d—ths", 
FÏgs
::
F
, 
Œue
 },

735 { "»£ts", 
FÏgs
::
G
, 
Œue
 },

736 { "mobd—ths", 
FÏgs
::
H
, 
Œue
 },

737 { "æags", 
FÏgs
::
I
, 
Œue
 },

738 { "³ÇÉ›s", 
FÏgs
::
J
, 
Œue
 },

739 { "§ccšg", 
FÏgs
::
K
, 
Œue
 },

740 { "Ëv–s", 
FÏgs
::
L
, 
Œue
 },

741 { "£cu»", 
FÏgs
::
M
, 
Œue
 },

742 { "sw™ches", 
FÏgs
::
N
, 
Œue
 },

743 { "¢oİs", 
FÏgs
::
O
, 
Œue
 },

744 { "»¡Üe", 
FÏgs
::
P
, 
Œue
 },

745 { "lßd", 
FÏgs
::
Q
, 
Œue
 },

746 { "Ãwb›", 
FÏgs
::
R
, 
Œue
 },

747 { "´efix", 
FÏgs
::
S
, 
Œue
 },

748 { "¥am", 
FÏgs
::
T
, 
Œue
 },

749 { "misc", 
FÏgs
::
U
, 
Œue
 },

750 { "assi¡", 
FÏgs
::
Y
, 
Œue
 },

751 { "ch—t", 
FÏgs
::
W
, 
Œue
 },

752 { "ma", 
FÏgs
::
a
, 
Œue
 },

753 { "auùiÚ", 
FÏgs
::
b
, 
Œue
 },

754 { "que¡", 
FÏgs
::
c
, 
Œue
 },

755 { "m®loc", 
FÏgs
::
d
, 
Œue
 },

756 { "bugs", 
FÏgs
::
V
, 
Œue
 },

759 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
exŒa_æags
 = {

760 { "glowšg", 
FÏgs
::
A
, 
Œue
 },

761 { "hummšg", 
FÏgs
::
B
, 
Œue
 },

762 { "com·¹m’t", 
FÏgs
::
C
, 
Œue
 },

763 { "Œª¥¬’t", 
FÏgs
::
D
, 
Œue
 },

764 { "ev", 
FÏgs
::
E
, 
Œue
 },

765 { "švis", 
FÏgs
::
F
, 
Œue
 },

766 { "magic", 
FÏgs
::
G
, 
Œue
 },

767 { "nodrİ", 
FÏgs
::
H
, 
Œue
 },

768 { "bËss", 
FÏgs
::
I
, 
Œue
 },

769 { "ªtigood", 
FÏgs
::
J
, 
Œue
 },

770 { "ªt›v", 
FÏgs
::
K
, 
Œue
 },

771 { "ªtšeuŒ®", 
FÏgs
::
L
, 
Œue
 },

772 { "nÜemove", 
FÏgs
::
M
, 
Œue
 },

773 { "šv’tÜy", 
FÏgs
::
N
, 
Œue
 },

774 { "nİurge", 
FÏgs
::
O
, 
Œue
 },

775 { "rÙd—th", 
FÏgs
::
P
, 
Œue
 },

776 { "visd—th", 
FÏgs
::
Q
, 
Œue
 },

777 { "no§c", 
FÏgs
::
R
, 
Œue
 },

778 { "nÚm‘®", 
FÏgs
::
S
, 
Œue
 },

779 { "nŞoÿ‹", 
FÏgs
::
T
, 
Œue
 },

780 { "m–tdrİ", 
FÏgs
::
U
, 
Œue
 },

781 { "hadtim”", 
FÏgs
::
V
, 
Œue
 },

782 { "£ÎexŒaù", 
FÏgs
::
W
, 
Œue
 },

783 { "buº´oof", 
FÏgs
::
Y
, 
Œue
 },

784 { "nouncur£", 
FÏgs
::
Z
, 
Œue
 },

787 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
room_æags
 = {

788 { "d¬k", 
FÏgs
::
A
, 
Œue
 },

789 { "nŞight", 
FÏgs
::
B
, 
Œue
 },

790 { "nomob", 
FÏgs
::
C
, 
Œue
 },

791 { "šdoÜs", 
FÏgs
::
D
, 
Œue
 },

792 { "lock”", 
FÏgs
::
E
, 
Œue
 },

793 { "ãm®eÚly", 
FÏgs
::
F
, 
Œue
 },

794 { "m®eÚly", 
FÏgs
::
G
, 
Œue
 },

795 { "no¦“p", 
FÏgs
::
H
, 
Œue
 },

796 { "novisiÚ", 
FÏgs
::
I
, 
Œue
 },

797 { "´iv©e", 
FÏgs
::
J
, 
Œue
 },

798 { "§ã", 
FÏgs
::
K
, 
Œue
 },

799 { "sŞ™¬y", 
FÏgs
::
L
, 
Œue
 },

800 { "³tshİ", 
FÏgs
::
M
, 
çl£
 },

801 { "nÜeÿÎ", 
FÏgs
::
N
, 
Œue
 },

802 { "impÚly", 
FÏgs
::
O
, 
Œue
 },

803 { "godsÚly", 
FÏgs
::
P
, 
Œue
 },

804 { "h”ÛsÚly", 
FÏgs
::
Q
, 
Œue
 },

805 { "Ãwb›sÚly", 
FÏgs
::
R
, 
Œue
 },

806 { "Ïw", 
FÏgs
::
S
, 
Œue
 },

807 { "nowh”e", 
FÏgs
::
T
, 
Œue
 },

808 { "bªk", 
FÏgs
::
U
, 
Œue
 },

809 { "Ëad”Úly", 
FÏgs
::
V
, 
Œue
 },

810 { "‹ËpÜt", 
FÏgs
::
W
, 
Œue
 },

811 { "und”w©”", 
FÏgs
::
X
, 
Œue
 },

812 { "nİÜl", 
FÏgs
::
Y
, 
Œue
 },

813 { "»mÜtsÚly", 
FÏgs
::
Z
, 
Œue
 },

814 { "noque¡", 
FÏgs
::
a
, 
Œue
 },

815 { "s’t", 
FÏgs
::
b
, 
Œue
 },

818 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
afãù_æags
 = {

819 { "blšd", 
FÏgs
::
A
, 
Œue
 },

820 { "švisibË", 
FÏgs
::
B
, 
Œue
 },

821 { "d‘eù_ev", 
FÏgs
::
C
, 
Œue
 },

822 { "d‘eù_švis", 
FÏgs
::
D
, 
Œue
 },

823 { "d‘eù_magic", 
FÏgs
::
E
, 
Œue
 },

824 { "d‘eù_hidd’", 
FÏgs
::
F
, 
Œue
 },

825 { "d‘eù_good", 
FÏgs
::
G
, 
Œue
 },

826 { "§nùu¬y", 
FÏgs
::
H
, 
Œue
 },

827 { "ç”›_fœe", 
FÏgs
::
I
, 
Œue
 },

828 { "šä¬ed", 
FÏgs
::
J
, 
Œue
 },

829 { "cur£", 
FÏgs
::
K
, 
Œue
 },

830 { "ã¬", 
FÏgs
::
L
, 
Œue
 },

831 { "poisÚ", 
FÏgs
::
M
, 
Œue
 },

832 { "´Ùeù_ev", 
FÏgs
::
N
, 
Œue
 },

833 { "´Ùeù_good", 
FÏgs
::
O
, 
Œue
 },

834 { "¢—k", 
FÏgs
::
P
, 
Œue
 },

835 { "hide", 
FÏgs
::
Q
, 
Œue
 },

836 { "night_visiÚ", 
FÏgs
::
R
, 
Œue
 },

837 { "ch¬m", 
FÏgs
::
S
, 
Œue
 },

838 { "æyšg", 
FÏgs
::
T
, 
Œue
 },

839 { "·ss_doÜ", 
FÏgs
::
U
, 
Œue
 },

840 { "ha¡e", 
FÏgs
::
V
, 
Œue
 },

841 { "ÿlm", 
FÏgs
::
W
, 
Œue
 },

842 { "¶ague", 
FÏgs
::
X
, 
Œue
 },

843 { "¡“l_mi¡", 
FÏgs
::
Y
, 
Œue
 },

844 { "divš”eg’", 
FÏgs
::
Z
, 
Œue
 },

845 { "b”£rk", 
FÏgs
::
a
, 
Œue
 },

846 { "æamesh›ld", 
FÏgs
::
b
, 
Œue
 },

847 { "»g’”©iÚ", 
FÏgs
::
c
, 
Œue
 },

848 { "¦ow", 
FÏgs
::
d
, 
Œue
 },

849 { "lÚ", 
FÏgs
::
e
, 
Œue
 },

852 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
off_æags
 = {

853 { "¬—_©ck", 
FÏgs
::
A
, 
Œue
 },

854 { "back¡ab", 
FÏgs
::
B
, 
Œue
 },

855 { "bash", 
FÏgs
::
C
, 
Œue
 },

856 { "b”£rk", 
FÏgs
::
D
, 
Œue
 },

857 { "di§rm", 
FÏgs
::
E
, 
Œue
 },

858 { "dodge", 
FÏgs
::
F
, 
Œue
 },

859 { "ç¡", 
FÏgs
::
H
, 
Œue
 },

860 { "kick", 
FÏgs
::
I
, 
Œue
 },

861 { "dœt_kick", 
FÏgs
::
J
, 
Œue
 },

862 { "·¼y", 
FÏgs
::
K
, 
Œue
 },

863 { "»scue", 
FÏgs
::
L
, 
Œue
 },

864 { "Œ", 
FÏgs
::
N
, 
Œue
 },

865 { "üush", 
FÏgs
::
O
, 
Œue
 },

866 { "assi¡_®l", 
FÏgs
::
P
, 
Œue
 },

867 { "assi¡_®ign", 
FÏgs
::
Q
, 
Œue
 },

868 { "assi¡_¿û", 
FÏgs
::
R
, 
Œue
 },

869 { "assi¡_¶ay”s", 
FÏgs
::
S
, 
Œue
 },

870 { "assi¡_gu¬d", 
FÏgs
::
T
, 
Œue
 },

871 { "assi¡_vnum", 
FÏgs
::
U
, 
Œue
 },

874 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
fÜm_æags
 = {

875 { "edibË", 
FORM_EDIBLE
, 
Œue
 },

876 { "poisÚ", 
FORM_POISON
, 
Œue
 },

877 { "magiÿl", 
FORM_MAGICAL
, 
Œue
 },

878 { "š¡ªt_deÿy", 
FORM_INSTANT_DECAY
, 
Œue
 },

879 { "Ùh”", 
FORM_OTHER
, 
Œue
 },

880 { "ªim®", 
FORM_ANIMAL
, 
Œue
 },

881 { "£Á›Á", 
FORM_SENTIENT
, 
Œue
 },

882 { "und—d", 
FORM_UNDEAD
, 
Œue
 },

883 { "cÚ¡ruù", 
FORM_CONSTRUCT
, 
Œue
 },

884 { "mi¡", 
FORM_MIST
, 
Œue
 },

885 { "šngibË", 
FORM_INTANGIBLE
, 
Œue
 },

886 { "bed", 
FORM_BIPED
, 
Œue
 },

887 { "ûÁaur", 
FORM_CENTAUR
, 
Œue
 },

888 { "š£ù", 
FORM_INSECT
, 
Œue
 },

889 { "¥id”", 
FORM_SPIDER
, 
Œue
 },

890 { "üu¡aûª", 
FORM_CRUSTACEAN
, 
Œue
 },

891 { "wÜm", 
FORM_WORM
, 
Œue
 },

892 { "blob", 
FORM_BLOB
, 
Œue
 },

893 { "mamm®", 
FORM_MAMMAL
, 
Œue
 },

894 { "bœd", 
FORM_BIRD
, 
Œue
 },

895 { "»±e", 
FORM_REPTILE
, 
Œue
 },

896 { "¢ake", 
FORM_SNAKE
, 
Œue
 },

897 { "d¿gÚ", 
FORM_DRAGON
, 
Œue
 },

898 { "amphibŸn", 
FORM_AMPHIBIAN
, 
Œue
 },

899 { "fish", 
FORM_FISH
 , 
Œue
 },

900 { "cŞd_blood", 
FORM_COLD_BLOOD
, 
Œue
 },

903 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
·¹_æags
 = {

904 { "h—d", 
PART_HEAD
, 
Œue
 },

905 { "¬ms", 
PART_ARMS
, 
Œue
 },

906 { "Ëgs", 
PART_LEGS
, 
Œue
 },

907 { "h—¹", 
PART_HEART
, 
Œue
 },

908 { "b¿šs", 
PART_BRAINS
, 
Œue
 },

909 { "guts", 
PART_GUTS
, 
Œue
 },

910 { "hªds", 
PART_HANDS
, 
Œue
 },

911 { "ã‘", 
PART_FEET
, 
Œue
 },

912 { "fšg”s", 
PART_FINGERS
, 
Œue
 },

913 { "—r", 
PART_EAR
, 
Œue
 },

914 { "eye", 
PART_EYE
, 
Œue
 },

915 { "lÚg_tÚgue", 
PART_LONG_TONGUE
, 
Œue
 },

916 { "eye¡®ks", 
PART_EYESTALKS
, 
Œue
 },

917 { "‹Áaşes", 
PART_TENTACLES
, 
Œue
 },

918 { "fšs", 
PART_FINS
, 
Œue
 },

919 { "wšgs", 
PART_WINGS
, 
Œue
 },

920 { "", 
PART_TAIL
, 
Œue
 },

921 { "şaws", 
PART_CLAWS
, 
Œue
 },

922 { "çngs", 
PART_FANGS
, 
Œue
 },

923 { "hÜns", 
PART_HORNS
, 
Œue
 },

924 { "sÿËs", 
PART_SCALES
, 
Œue
 },

925 { "tusks", 
PART_TUSKS
, 
Œue
 },

928 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
group_æags
 = {

929 { "ŒŞls", 
GROUP_VNUM_TROLLS
, 
Œue
 },

930 { "og»s", 
GROUP_VNUM_OGRES
, 
Œue
 },

933 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
comm_æags
 = {

934 { "qu›t", 
COMM_QUIET
, 
Œue
 },

935 { "d—f", 
COMM_DEAF
, 
Œue
 },

936 { "nowiz", 
COMM_NOWIZ
, 
Œue
 },

937 { "nİ¿y", 
COMM_NOPRAY
, 
Œue
 },

938 { "½¿y", 
COMM_RPRAY
, 
Œue
 },

939 { "nßuùiÚ", 
COMM_NOAUCTION
, 
Œue
 },

940 { "nogoss", 
COMM_NOGOSSIP
, 
Œue
 },

941 { "noæame", 
COMM_NOFLAME
, 
Œue
 },

942 { "noque¡iÚ", 
COMM_NOQUESTION
, 
Œue
 },

943 { "nomusic", 
COMM_NOMUSIC
, 
Œue
 },

944 { "noşª", 
COMM_NOCLAN
, 
Œue
 },

945 { "com·ù", 
COMM_COMPACT
, 
Œue
 },

946 { "br›f", 
COMM_BRIEF
, 
Œue
 },

947 { "´om±", 
COMM_PROMPT
, 
Œue
 },

948 { "combše", 
COMM_COMBINE
, 
Œue
 },

949 { "show_afãùs", 
COMM_SHOW_AFFECTS
, 
Œue
 },

950 { "nog¿ts", 
COMM_NOGRATS
, 
Œue
 },

951 { "nßÂounû", 
COMM_NOANNOUNCE
, 
Œue
 },

952 { "nosocŸl", 
COMM_NOSOCIAL
, 
Œue
 },

953 { "noqu”y", 
COMM_NOQUERY
, 
Œue
 },

954 { "noqwe¡", 
COMM_NOQWEST
, 
Œue
 },

955 { "nİage", 
COMM_NOPAGE
, 
Œue
 },

956 { "nochªÃls", 
COMM_NOCHANNELS
, 
Œue
 },

957 { "afk", 
COMM_AFK
, 
Œue
 },

958 { "©b´om±", 
COMM_ATBPROMPT
, 
Œue
 },

961 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
ûnsÜ_æags
 = {

962 { "chªÃls", 
CENSOR_CHAN
, 
Œue
 },

963 { "¥am", 
CENSOR_SPAM
, 
Œue
 },

966 cÚ¡ 
	g¡d
::
veùÜ
<
æag_ty³
> 
»voke_æags
 = {

967 { "nochªÃls", 
REVOKE_NOCHANNELS
, 
Œue
 },

968 { "æame_Úly", 
REVOKE_FLAMEONLY
, 
Œue
 },

969 { "´ay", 
REVOKE_PRAY
, 
Œue
 },

970 { "goss", 
REVOKE_GOSSIP
, 
Œue
 },

971 { "æame", 
REVOKE_FLAME
, 
Œue
 },

972 { "qwe¡", 
REVOKE_QWEST
, 
Œue
 },

973 { "auùiÚ", 
REVOKE_AUCTION
, 
Œue
 },

974 { "şª", 
REVOKE_CLAN
, 
Œue
 },

975 { "ic", 
REVOKE_IC
, 
Œue
 },

976 { "music", 
REVOKE_MUSIC
, 
Œue
 },

977 { "q/a", 
REVOKE_QA
, 
Œue
 },

978 { "socŸl", 
REVOKE_SOCIAL
, 
Œue
 },

979 { "g¿ts", 
REVOKE_GRATS
, 
Œue
 },

980 { "·ge", 
REVOKE_PAGE
, 
Œue
 },

981 { "q‹Î", 
REVOKE_QTELL
, 
Œue
 },

984 cÚ¡ 
	g¡d
::
veùÜ
<
afãù_bË_ty³
> 
w—pÚ_afãùs
 = {

985 { "acidic", 
afãù
::
ty³
::
w—pÚ_acidic
, 
Œue
 },

986 { "æamšg", 
afãù
::
ty³
::
w—pÚ_æamšg
, 
Œue
 },

987 { "äo¡", 
afãù
::
ty³
::
w—pÚ_äo¡
, 
Œue
 },

988 { "vampœic", 
afãù
::
ty³
::
w—pÚ_vampœic
, 
Œue
 },

989 { "sh¬p", 
afãù
::
ty³
::
w—pÚ_sh¬p
, 
Œue
 },

990 { "vÜ·l", 
afãù
::
ty³
::
w—pÚ_vÜ·l
, 
Œue
 },

991 { "twohªded", 
afãù
::
ty³
::
w—pÚ_two_hªds
,
Œue
 },

992 { "shockšg", 
afãù
::
ty³
::
w—pÚ_shockšg
, 
Œue
 },

993 { "poisÚ", 
afãù
::
ty³
::
poisÚ
, 
Œue
 },

996 cÚ¡ 
	g¡d
::
veùÜ
<
cŞÜ_ty³
> 
cŞÜ_bË
 = {

997 { "bÏck", "{k", 
GREY
, 
NOBOLD
 },

998 { "ch¬cßl", "{c", 
GREY
, 
BOLD
 },

999 { "»d", "{R", 
RED
, 
NOBOLD
 },

1000 { "pšk", "{P", 
RED
, 
BOLD
 },

1001 { "huÁ”", "{H", 
GREEN
, 
NOBOLD
 },

1002 { "g»’", "{G", 
GREEN
, 
BOLD
 },

1003 { "brown", "{b", 
YELLOW
, 
NOBOLD
 },

1004 { "y–low", "{Y", 
YELLOW
, 
BOLD
 },

1005 { "Çvy", "{N", 
BLUE
, 
NOBOLD
 },

1006 { "blue", "{B", 
BLUE
, 
BOLD
 },

1007 { "m¬oÚ", "{M", 
PURPLE
, 
NOBOLD
 },

1008 { "viŞ‘", "{V", 
PURPLE
, 
BOLD
 },

1009 { "turquoi£", "{T", 
CYAN
, 
NOBOLD
 },

1010 { "cyª", "{C", 
CYAN
, 
BOLD
 },

1011 { "g»y", "{g", 
WHITE
, 
NOBOLD
 },

1012 { "wh™e", "{W", 
WHITE
, 
BOLD
 },

1018 cÚ¡ 
	g¡d
::
veùÜ
<
c£‰šg_ty³
> 
c£‰šg_bË
 = {

1020 { 
GREEN
, 
NOBOLD
, "Gossip" },

1021 { 
RED
, 
BOLD
, "Flame" },

1022 { 
YELLOW
, 
BOLD
, "Qwest" },

1023 { 
RED
, 
NOBOLD
, "Pray" },

1024 { 
YELLOW
, 
NOBOLD
, "Auction" },

1025 { 
WHITE
, 
BOLD
, "Announcements" },

1026 { 
BLUE
, 
BOLD
, "Music" },

1027 { 
CYAN
, 
BOLD
, "QA" },

1028 { 
GREEN
, 
NOBOLD
, "Socials" },

1029 { 
PURPLE
, 
BOLD
, "Grats" },

1030 { 
RED
, 
BOLD
, "Immtalk" },

1031 { 
RED
, 
NOBOLD
, "Page" },

1032 { 
CYAN
, 
BOLD
, "Tell" },

1033 { 
RED
, 
NOBOLD
, "Clantalk" },

1034 { 
WHITE
, 
BOLD
, "IC" },

1035 { 
WHITE
, 
NOBOLD
, "Say" },

1036 { 
PURPLE
, 
BOLD
, "GTell" },

1037 { 
PURPLE
, 
BOLD
, "QTell" },

1038 { 
YELLOW
, 
BOLD
, "Spousetalk" },

1050 { 
CYAN
, 
BOLD
, "Name" },

1051 { 
PURPLE
, 
NOBOLD
, "PKills" },

1052 { 
PURPLE
, 
BOLD
, "AKills" },

1053 { 
CYAN
, 
NOBOLD
, "Class" },

1054 { 
RED
, 
BOLD
, "Stats" },

1055 { 
BLUE
, 
BOLD
, "Armor" },

1056 { 
YELLOW
, 
BOLD
, "Points" },

1057 { 
GREEN
, 
NOBOLD
, "Weight" },

1058 { 
YELLOW
, 
NOBOLD
, "Gain" },

1059 { 
WHITE
, 
BOLD
, "Alignment" },

1060 { 
RED
, 
NOBOLD
, "Money" },

1061 { 
GREEN
, 
BOLD
, "Diceroll" },

1062 { 
YELLOW
, 
BOLD
, "QP" },

1063 { 
GREEN
, 
BOLD
, "SP" },

1064 { 
PURPLE
, 
BOLD
, "RPP" },

1070 { 
YELLOW
, 
NOBOLD
, "Torch" },

1071 { 
RED
, 
BOLD
, "Flame" },

1072 { 
YELLOW
, 
NOBOLD
, "Border" },

1073 { 
CYAN
, 
BOLD
, "Name" },

1074 { 
WHITE
, 
BOLD
, "Title" },

1075 { 
CYAN
, 
NOBOLD
, "Class" },

1076 { 
CYAN
, 
NOBOLD
, "Level" },

1077 { 
RED
, 
BOLD
, "Stats" },

1078 { 
RED
, 
NOBOLD
, "Trained" },

1079 { 
GREY
, 
BOLD
, "Healthname" },

1080 { 
WHITE
, 
NOBOLD
, "Healthnum" },

1081 { 
CYAN
, 
BOLD
, "Money" },

1082 { 
GREEN
, 
NOBOLD
, "Weight" },

1083 { 
PURPLE
, 
BOLD
, "Armor" },

1084 { 
GREEN
, 
BOLD
, "Dicename" },

1085 { 
YELLOW
, 
BOLD
, "Dicenum" },

1086 { 
BLUE
, 
BOLD
, "Pointname" },

1087 { 
CYAN
, 
BOLD
, "Pointnum" },

1088 { 
GREY
, 
BOLD
, "Alignment" },

1089 { 
WHITE
, 
BOLD
, "XPName" },

1090 { 
GREY
, 
BOLD
, "XPNum" },

1091 { 
GREEN
, 
NOBOLD
, "Position" },

1092 { 
RED
, 
NOBOLD
, "PKRecord" },

1093 { 
WHITE
, 
BOLD
, "PKRank" },

1100 { 
RED
, 
BOLD
, "Rooms" },

1101 { 
GREEN
, 
BOLD
, "Mobiles" },

1102 { 
YELLOW
, 
NOBOLD
, "Objects" },

1103 { 
PURPLE
, 
BOLD
, "Players" },

1104 { 
YELLOW
, 
NOBOLD
, "Inventory" },

1123 
æag_šdex_lookup
(cÚ¡ 
SŒšg
& 
Çme
, cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
>& 
æag_bË
)

1125 
æag
 = 0; 
	gæag
 < 
	gæag_bË
.
size
(); flag++) {

1126 ià(
tŞow”
(
Çme
[0]è=ğtŞow”(
æag_bË
[
æag
].name[0])

1127 && 
Çme
.
is_´efix_of
(
æag_bË
[
æag
].name))

1128  
æag
;

1134 
afãù_šdex_lookup
(cÚ¡ 
SŒšg
& 
Çme
, cÚ¡ 
¡d
::
veùÜ
<
afãù_bË_ty³
>& 
afãù_bË
)

1136 
i
 = 0; 
	gi
 < 
	gafãù_bË
.
size
(); i++) {

1137 ià(
tŞow”
(
Çme
[0]è=ğtŞow”(
afãù_bË
[
i
].name[0])

1138 && 
Çme
.
is_´efix_of
(
afãù_bË
[
i
].name))

1139  
i
;

	@src/typename.cc

1 
	~<veùÜ
>

3 
	~"Ch¬aù”.hh
"

4 
	~"deş¬e.hh
"

5 
	~"FÏgs.hh
"

6 
	~"Loggšg.hh
"

7 
	~"m”c.hh
"

8 
	~"Objeù.hh
"

9 
	~"PÏy”.hh
"

10 
	~"SŒšg.hh
"

11 
	~"bËs.hh
"

13 
SŒšg
 
	$™em_Çme
(
™em_ty³
)

15 cÚ¡‡uto& 
’Œy
 : 
™em_bË
)

16 ià(
™em_ty³
 =ğ
’Œy
.
ty³
)

17  
’Œy
.
Çme
;

20 
	}
}

22 
SŒšg
 
	$w—pÚ_Çme
(
w—pÚ_ty³
)

24 cÚ¡‡uto& 
’Œy
 : 
w—pÚ_bË
)

25 ià(
w—pÚ_ty³
 =ğ
’Œy
.
ty³
)

26  
’Œy
.
Çme
;

29 
	}
}

34 
SŒšg
 
	$™em_ty³_Çme
(
Objeù
 *
obj
)

36 
obj
->
™em_ty³
) {

37 
ITEM_LIGHT
:  "light";

39 
ITEM_SCROLL
:  "scroll";

41 
ITEM_WAND
:  "wand";

43 
ITEM_STAFF
:  "staff";

45 
ITEM_WEAPON
:  "weapon";

47 
ITEM_TREASURE
:  "treasure";

49 
ITEM_ARMOR
:  "armor";

51 
ITEM_CLOTHING
:  "clothing";

53 
ITEM_POTION
:  "potion";

55 
ITEM_FURNITURE
:  "furniture";

57 
ITEM_TRASH
:  "trash";

59 
ITEM_CONTAINER
:  "container";

61 
ITEM_DRINK_CON
:  "drink container";

63 
ITEM_KEY
:  "key";

65 
ITEM_FOOD
:  "food";

67 
ITEM_MONEY
:  "money";

69 
ITEM_BOAT
:  "boat";

71 
ITEM_CORPSE_NPC
:  "npc corpse";

73 
ITEM_CORPSE_PC
:  "pc corpse";

75 
ITEM_FOUNTAIN
:  "fountain";

77 
ITEM_PILL
:  "pill";

79 
ITEM_MAP
:  "map";

81 
ITEM_PORTAL
:  "portal";

83 
ITEM_WARP_STONE
:  "warp stone";

85 
ITEM_GEM
:  "gem";

87 
ITEM_JEWELRY
:  "jewelry";

89 
ITEM_JUKEBOX
:  "juke box";

91 
ITEM_MATERIAL
:  "material";

93 
ITEM_ANVIL
:  "anvil";

97 
ITEM_WEDDINGRING
:  "weddingring";

99 
ITEM_TOKEN
:  "token";

100 
ITEM_WARP_CRYSTAL
:  "warp crystal";

103 
Loggšg
::
	`bug
("I‹m_ty³_Çme: unknowÀty³ %d.", 
obj
->
™em_ty³
);

105 
	}
}

110 
SŒšg
 
	$dam_ty³_Çme
(
ty³
)

112 
ty³
) {

113 
DAM_NONE
 :  "(none)";

114 
DAM_CHARM
 :  "charm";

115 
DAM_BASH
 :  "bash";

116 
DAM_PIERCE
 :  "pierce";

117 
DAM_SLASH
 :  "slash";

118 
DAM_FIRE
 :  "fire";

119 
DAM_COLD
 :  "cold";

120 
DAM_ELECTRICITY
 :  "electricity";

121 
DAM_ACID
 :  "acid";

122 
DAM_POISON
 :  "poison";

123 
DAM_NEGATIVE
 :  "negative";

124 
DAM_HOLY
 :  "holy";

125 
DAM_ENERGY
 :  "energy";

126 
DAM_MENTAL
 :  "mental";

127 
DAM_DISEASE
 :  "disease";

128 
DAM_DROWNING
 :  "drowning";

129 
DAM_LIGHT
 :  "light";

130 
DAM_SOUND
 :  "sound";

131 
DAM_WOOD
 :  "wood";

132 
DAM_SILVER
 :  "silver";

133 
DAM_IRON
 :  "iron";

136 
Loggšg
::
	`bug
("dam_ty³_Çme: unknowÀty³ %d.", 
ty³
);

138 
	}
}

144 
SŒšg
 
	$afãù_loc_Çme
(
loÿtiÚ
)

146 
loÿtiÚ
) {

147 
APPLY_NONE
:  "none";

148 
APPLY_STR
:  "strength";

149 
APPLY_DEX
:  "dexterity";

150 
APPLY_INT
:  "intelligence";

151 
APPLY_WIS
:  "wisdom";

152 
APPLY_CON
:  "constitution";

153 
APPLY_CHR
:  "charisma";

154 
APPLY_SEX
:  "sex";

155 
APPLY_AGE
:  "age";

156 
APPLY_MANA
:  "maximum mana";

157 
APPLY_HIT
:  "maximum hp";

158 
APPLY_STAM
:  "maximum stamina";

159 
APPLY_GOLD
:  "gold gained";

160 
APPLY_EXP_PCT
:  "experience gained";

161 
APPLY_AC
:  "armor class";

162 
APPLY_HITROLL
:  "hit„oll";

163 
APPLY_DAMROLL
:  "damage„oll";

164 
APPLY_SAVES
:  "saves";

165 
APPLY_SAVING_ROD
:  "save vs„od";

166 
APPLY_SAVING_PETRI
:  "save vs…etrification";

167 
APPLY_SAVING_BREATH
:  "save vs breath";

168 
APPLY_SAVING_SPELL
:  "save vs spell";

169 
APPLY_QUESTPOINTS
:  "quest…oints gained";

170 
APPLY_SKILLPOINTS
:  "skill…oints gained";

171 
APPLY_MANA_COST_PCT
:  "spell mana cost";

172 
APPLY_STAM_COST_PCT
:  "skill stamina cost";

173 
APPLY_WPN_DAMAGE_PCT
:  "weapon damage dealt";

174 
APPLY_SPELL_DAMAGE_PCT
:  "spell damage dealt";

175 
APPLY_VAMP_BONUS_PCT
:  "vampiric weapon†eeching";

176 
APPLY_HP_BLOCK_PCT
:  "HP healed when blocking";

177 
APPLY_MANA_BLOCK_PCT
:  "MANA healed when blocking";

178 
APPLY_FORGE_UNIQUE
:  "increased forge success";

179 
APPLY_PRIESTESS_UNIQUE
:  "increased healing…ower";

180 
APPLY_BREW_UNIQUE
:  "increased brewing success";

181 
APPLY_SCRIBE_UNIQUE
:  "increased scribing success";

182 
APPLY_TANK_UNIQUE
:  "reduced damage„ecieved";

183 
APPLY_NECRO_PIERCE_UNIQUE
:  "on hit: chanceo inflict maladiction";

184 
APPLY_LIDDA_AURA_UNIQUE
:  "chance for‡urao„etaliate";

185 
SET_MAGE_INVOKER
:  "Pieces of Invoker Set worn";

186 
SET_WARRIOR_BESERKER
:  "Pieces of Beserker Set worn";

187 
SET_CLERIC_DIVINE
:  "Pieces of Divine Garb Set worn";

188 
SET_THIEF_CUTPURSE
:  "Pieces of Cutpurse Set worn";

189 
SET_PALADIN_GRACE
:  "Pieces of Mont's Grace Set worn";

192 
Loggšg
::
	`bug
("Afãù_loÿtiÚ_Çme: unknowÀloÿtiÚ %d.", 
loÿtiÚ
);

194 
	}
}

196 cÚ¡ 
SŒšg
 
´št_b™_Çmes
(cÚ¡ 
¡d
::
veùÜ
<
æag_ty³
> &
æag_bË
, cÚ¡ 
FÏgs
& 
æags
) {

197 
SŒšg
 
	gbuf
;

199 
æag_ty³
 
	gæag
: 
æag_bË
)

200 ià(
æags
.
has
(
æag
.
b™
)) {

201 
buf
 += " ";

202 
	gbuf
 +ğ
æag
.
Çme
;

205  
	gbuf
.
em±y
(è? "nÚe" : 
buf
.
sub¡r
(1);

211 cÚ¡ 
SŒšg
 
	$exŒa_b™_Çme
(cÚ¡ 
FÏgs
& 
æags
) {

212  
	`´št_b™_Çmes
(
exŒa_æags
, 
æags
);

213 
	}
}

215 cÚ¡ 
SŒšg
 
	$aù_b™_Çme
(cÚ¡ 
FÏgs
& 
æags
, 
boŞ
 
Åc
) {

216 ià(
Åc
è 
	`SŒšg
("Åø"è+ 
	`´št_b™_Çmes
(
aù_æags
, 
æags
);

217  
	`SŒšg
("¶ay” "è+ 
	`´št_b™_Çmes
(
¶r_æags
, 
æags
);

218 
	}
}

220 cÚ¡ 
SŒšg
 
	$comm_b™_Çme
(cÚ¡ 
FÏgs
& 
æags
) {

221  
	`´št_b™_Çmes
(
comm_æags
, 
æags
);

222 
	}
}

224 cÚ¡ 
SŒšg
 
	$»voke_b™_Çme
(cÚ¡ 
FÏgs
& 
æags
) {

225  
	`´št_b™_Çmes
(
»voke_æags
, 
æags
);

226 
	}
}

228 cÚ¡ 
SŒšg
 
	$cgroup_b™_Çme
(cÚ¡ 
FÏgs
& 
æags
) {

229  
	`´št_b™_Çmes
(
cgroup_æags
, 
æags
);

230 
	}
}

232 cÚ¡ 
SŒšg
 
	$ûnsÜ_b™_Çme
(cÚ¡ 
FÏgs
& 
æags
) {

233  
	`´št_b™_Çmes
(
ûnsÜ_æags
, 
æags
);

234 
	}
}

237 cÚ¡ 
SŒšg
 
	$¶r_b™_Çme
(cÚ¡ 
FÏgs
& 
æags
) {

238  
	`´št_b™_Çmes
(
pcd©a_æags
, 
æags
);

239 
	}
}

241 cÚ¡ 
SŒšg
 
	$room_b™_Çme
(cÚ¡ 
FÏgs
& 
æags
) {

242  
	`´št_b™_Çmes
(
room_æags
, 
æags
);

243 
	}
}

245 cÚ¡ 
SŒšg
 
	$w—r_b™_Çme
(cÚ¡ 
FÏgs
& 
æags
) {

246  
	`´št_b™_Çmes
(
w—r_æags
, 
æags
);

247 
	}
}

249 cÚ¡ 
SŒšg
 
	$fÜm_b™_Çme
(cÚ¡ 
FÏgs
& 
æags
) {

250  
	`´št_b™_Çmes
(
fÜm_æags
, 
æags
);

251 
	}
}

253 cÚ¡ 
SŒšg
 
	$·¹_b™_Çme
(cÚ¡ 
FÏgs
& 
æags
) {

254  
	`´št_b™_Çmes
(
·¹_æags
, 
æags
);

255 
	}
}

257 cÚ¡ 
SŒšg
 
	$cÚt_b™_Çme
(cÚ¡ 
FÏgs
& 
æags
) {

258  
	`´št_b™_Çmes
(
cÚt_æags
, 
æags
);

259 
	}
}

261 cÚ¡ 
SŒšg
 
	$off_b™_Çme
(cÚ¡ 
FÏgs
& 
æags
) {

262  
	`´št_b™_Çmes
(
off_æags
, 
æags
);

263 
	}
}

265 
SŒšg
 
	$wiz_b™_Çme
(cÚ¡ 
FÏgs
& 
æags
)

267 
SŒšg
 
buf
;

269 cÚ¡‡uto& 
’Œy
 : 
wizÃt_bË
)

270 ià(
æags
.
	`has
(
’Œy
.
æag
)) {

271 
buf
 += ' ';

272 
buf
 +ğ
’Œy
.
Çme
;

275  
buf
.
	`em±y
(è? "nÚe" : buf.
	`sub¡r
(1);

276 
	}
}

278 
SŒšg
 
	$g‘_cŞÜ_Çme
(
cŞÜ
, 
bŞd
)

280 cÚ¡‡uto& 
’Œy
 : 
cŞÜ_bË
)

281 ià(
’Œy
.
cŞÜ
 == color

282 && 
’Œy
.
bŞd
 == bold)

283  
’Œy
.
Çme
;

286 
	}
}

288 
SŒšg
 
	$g‘_cŞÜ_code
(
cŞÜ
, 
bŞd
)

290 cÚ¡‡uto& 
’Œy
 : 
cŞÜ_bË
)

291 ià(
’Œy
.
cŞÜ
 == color

292 && 
’Œy
.
bŞd
 == bold)

293  
’Œy
.
code
;

296 
	}
}

298 
SŒšg
 
	$g‘_cu¡om_cŞÜ_Çme
(
Ch¬aù”
 *
ch
, 
¦Ù
)

300 
cŞÜ
, 
bŞd
;

302 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
cŞÜ
[
¦Ù
] != 0) {

303 
cŞÜ
 = 
ch
->
pcd©a
->cŞÜ[
¦Ù
];

304 
bŞd
 = 
ch
->
pcd©a
->bŞd [
¦Ù
];

307 
cŞÜ
 = 
c£‰šg_bË
[
¦Ù
].color;

308 
bŞd
 = 
c£‰šg_bË
[
¦Ù
].bold;

311  
	`g‘_cŞÜ_Çme
(
cŞÜ
, 
bŞd
);

312 
	}
}

314 
SŒšg
 
	$g‘_cu¡om_cŞÜ_code
(
Ch¬aù”
 *
ch
, 
¦Ù
)

316 
cŞÜ
, 
bŞd
;

318 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
cŞÜ
[
¦Ù
] != 0) {

319 
cŞÜ
 = 
ch
->
pcd©a
->cŞÜ[
¦Ù
];

320 
bŞd
 = 
ch
->
pcd©a
->bŞd [
¦Ù
];

323 
cŞÜ
 = 
c£‰šg_bË
[
¦Ù
].color;

324 
bŞd
 = 
c£‰šg_bË
[
¦Ù
].bold;

327  
	`g‘_cŞÜ_code
(
cŞÜ
, 
bŞd
);

328 
	}
}

	@src/update.cc

28 
	~"aù.hh
"

29 
	~"afãù/Afãù.hh
"

30 
	~"A»a.hh
"

31 
	~"AuùiÚ.hh
"

32 
	~"chªÃls.hh
"

33 
	~"Ch¬aù”.hh
"

34 
	~"deş¬e.hh
"

35 
	~"DesütÜ.hh
"

36 
	~"FÏgs.hh
"

37 
	~"FÜm©.hh
"

38 
	~"Game.hh
"

39 
	~"GameTime.hh
"

40 
	~"š‹½.hh
"

41 
	~"Loggšg.hh
"

42 
	~"m”c.hh
"

43 
	~"music.hh
"

44 
	~"MobePrÙÙy³.hh
"

45 
	~"MobProg.hh
"

46 
	~"MobProgAùLi¡.hh
"

47 
	~"Objeù.hh
"

48 
	~"ObjeùV®ue.hh
"

49 
	~"PÏy”.hh
"

50 
	~"¿ndom.hh
"

51 
	~"Re£t.hh
"

52 
	~"Room.hh
"

53 
	~"SŒšg.hh
"

54 
	~"W—th”.hh
"

55 
	~"WÜld.hh
"

56 
	~"comm.hh
"

58 
sque¡mob_found
 
¬gs
((
Ch¬aù”
 *
ch
, Ch¬aù” *
mob
));

59 
time_t
 
»boÙ_time
;

64 
h™_gaš
 
¬gs
((
Ch¬aù”
 *
ch
));

65 
mªa_gaš
 
¬gs
((
Ch¬aù”
 *
ch
));

66 
¡am_gaš
 
¬gs
((
Ch¬aù”
 *
ch
));

67 
mobe_upd©e
 
¬gs
(());

68 
w—th”_upd©e
 
¬gs
(());

69 
ch¬_upd©e
 
¬gs
(());

70 
desü_upd©e
 
¬gs
(());

71 
obj_upd©e
 
¬gs
(());

72 
room_upd©e
 
¬gs
(());

73 
aggr_upd©e
 
¬gs
(());

74 
que¡_upd©e
 
¬gs
(());

75 
und”w©”_upd©e
 
¬gs
(());

76 
jª™Ü_upd©e
 
¬gs
(());

80 
	g§ve_numb”
 = 0;

82 
	$demÙe_Ëv–
(
Ch¬aù”
 *
ch
)

84 
sub_hp
, 
sub_mªa
, 
sub_¡am
, 
sub_´ac
, 
sub_Œaš
 = 1;

85 
ch
->
pcd©a
->
Ï¡_Ëv–
 = 
	`g‘_¶ay_hours
(ch);

86 
sub_hp
 = 
¡d
::
	`max
(1, 
cÚ_­p
[
	`GET_ATTR_CON
(
ch
)].
h™p
 + 
	`numb”_¿nge
(

87 
gud_bË
[
ch
->
gud
].
hp_mš
, gud_bË[ch->gud].
hp_max
));

88 
sub_mªa
 = 
¡d
::
	`max
(1, 
št_­p
[
	`GET_ATTR_INT
(
ch
)].
mª­
 + 
	`numb”_¿nge
(

89 
gud_bË
[
ch
->
gud
].
mªa_mš
, gud_bË[ch->gud].
mªa_max
));

90 
sub_¡am
 = 
¡d
::
	`max
(1, 
¡r_­p
[
	`GET_ATTR_STR
(
ch
)].
¡p
 + 
	`numb”_¿nge
(

91 
gud_bË
[
ch
->
gud
].
¡am_mš
, gud_bË[ch->gud].
¡am_max
));

92 
sub_´ac
 = 
wis_­p
[
	`GET_ATTR_WIS
(
ch
)].
´aùiû
;

94 ià(
chr_­p
[
	`GET_ATTR_CHR
(
ch
)].
chªû
 >ğ
	`numb”_³rûÁ
())

95 
sub_Œaš
 = 2;

97 
ch
->
´aùiû
 -ğ
sub_´ac
;

98 
ch
->
Œaš
 -ğ
sub_Œaš
;

99 
	`ATTR_BASE
(
ch
, 
APPLY_HIT
èğ
¡d
::
	`max
(20, ATTR_BASE(ch, APPLY_HITè- 
sub_hp
);

100 
	`ATTR_BASE
(
ch
, 
APPLY_MANA
èğ
¡d
::
	`max
(100, ATTR_BASE(ch, APPLY_MANAè- 
sub_mªa
);

101 
	`ATTR_BASE
(
ch
, 
APPLY_STAM
èğ
¡d
::
	`max
(100, ATTR_BASE(ch, APPLY_STAMè- 
sub_¡am
);

103 
	`±c
(
ch
, "{RYour†oss is: %d/%d hp, %d/%d ma, %d/%d stm, %d/%d…rac, %d/%drain.{x\n",

104 
sub_hp
, 
	`GET_MAX_HIT
(
ch
),

105 
sub_mªa
, 
	`GET_MAX_MANA
(
ch
),

106 
sub_¡am
, 
	`GET_MAX_STAM
(
ch
),

107 
sub_´ac
, 
ch
->
´aùiû
,

108 
sub_Œaš
, 
ch
->
Œaš
);

109 
	}
}

111 
	$advªû_Ëv–
(
Ch¬aù”
 *
ch
)

113 
add_hp
, 
add_mªa
, 
add_¡am
, 
add_´ac
, 
add_Œaš
 = 1;

114 
ch
->
pcd©a
->
Ï¡_Ëv–
 = 
	`g‘_¶ay_hours
(ch);

115 
add_hp
 = 
¡d
::
	`max
(1, 
cÚ_­p
[
	`GET_ATTR_CON
(
ch
)].
h™p
 + 
	`numb”_¿nge
(

116 
gud_bË
[
ch
->
gud
].
hp_mš
, gud_bË[ch->gud].
hp_max
));

117 
add_mªa
 = 
¡d
::
	`max
(1, 
št_­p
[
	`GET_ATTR_INT
(
ch
)].
mª­
 + 
	`numb”_¿nge
(

118 
gud_bË
[
ch
->
gud
].
mªa_mš
, gud_bË[ch->gud].
mªa_max
));

119 
add_¡am
 = 
¡d
::
	`max
(1, 
¡r_­p
[
	`GET_ATTR_STR
(
ch
)].
¡p
 + 
	`numb”_¿nge
(

120 
gud_bË
[
ch
->
gud
].
¡am_mš
, gud_bË[ch->gud].
¡am_max
));

121 
add_´ac
 = 
wis_­p
[
	`GET_ATTR_WIS
(
ch
)].
´aùiû
;

123 ià(
chr_­p
[
	`GET_ATTR_CHR
(
ch
)].
chªû
 >ğ
	`numb”_³rûÁ
())

124 
add_Œaš
 = 2;

130 
	`ATTR_BASE
(
ch
, 
APPLY_HIT
è+ğ
add_hp
;

131 
	`ATTR_BASE
(
ch
, 
APPLY_MANA
è+ğ
add_mªa
;

132 
	`ATTR_BASE
(
ch
, 
APPLY_STAM
è+ğ
add_¡am
;

133 
ch
->
´aùiû
 +ğ
add_´ac
;

134 
ch
->
Œaš
 +ğ
add_Œaš
;

135 
	`±c
(
ch
, "Your gain is: %d/%d hp, %d/%d ma, %d/%d stm, %d/%d…rac, %d/%drain.\n",

136 
add_hp
, 
	`GET_MAX_HIT
(
ch
),

137 
add_mªa
, 
	`GET_MAX_MANA
(
ch
),

138 
add_¡am
, 
	`GET_MAX_STAM
(
ch
),

139 
add_´ac
, 
ch
->
´aùiû
,

140 
add_Œaš
, 
ch
->
Œaš
);

141 
	}
}

148 
	$Åc_advªû_Ëv–
(
Ch¬aù”
 *
ch
)

150 
add_h™
, 
add_mªa
, 
add_¡am
;

152 ià(! 
ch
->
	`is_Åc
())

155 
add_h™
 = 
	`GET_ATTR_CON
(
ch
);

156 
add_mªa
 = 
	`GET_ATTR_INT
(
ch
);

157 
add_¡am
 = 
	`GET_ATTR_STR
(
ch
);

158 
	`ATTR_BASE
(
ch
, 
APPLY_HIT
è+ğ
add_h™
;

159 
	`ATTR_BASE
(
ch
, 
APPLY_MANA
è+ğ
add_mªa
;

160 
	`ATTR_BASE
(
ch
, 
APPLY_STAM
è+ğ
add_¡am
;

161 
	}
}

163 
	$gaš_exp
(
Ch¬aù”
 *
ch
, 
gaš
)

165 
buf
[
MSL
];

167 ià(
ch
->
	`is_Åc
())

170 ià(
ch
->
Ëv–
 >ğ
LEVEL_HERO
)

173 
ch
->
exp
 = 
¡d
::
	`max
(
	`exp_³r_Ëv–
(ch, ch->
pcd©a
->
pošts
), ch->ex°+ 
gaš
);

175 (
ch
->
exp
 >ğ
	`exp_³r_Ëv–
(ch, ch->
pcd©a
->
pošts
è* (ch->
Ëv–
 + 1))

176 && (
ch
->
Ëv–
 < 
LEVEL_HERO
)) {

177 
	`¡c
("{PG{RR{YA{bT{GZ{H! {BWay {NtØ{VËv–{M!!{x\n", 
ch
);

179 
ch
->
Ëv–
++;

181 ià(
ch
->
Ëv–
 =ğ
LEVEL_HERO
) {

182 
DesütÜ
 *
d
;

183 
Ch¬aù”
 *
viùim
;

184 *
msg
 =

191 
	`»¡Üe_ch¬
(
Ch¬aù”
 *, Character *);

192 
	`¡c
("{MG¿tz from‡ÎhImmÜl oàLegacy!{x\n\n", 
ch
);

194 
d
 = 
desütÜ_li¡
; d; d = d->
Ãxt
)

195 ià(
d
->
	`is_¶ayšg
()) {

196 
viùim
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

197 
	`¡c
(
msg
, 
viùim
);

198 
	`»¡Üe_ch¬
(
ch
, 
viùim
);

201 
ch
->
	`add_cgroup
(
GROUP_HERO
);

205 ià(
ch
->
Ëv–
 =ğ
LEVEL_AVATAR
)

206 
ch
->
	`add_cgroup
(
GROUP_AVATAR
);

208 
FÜm©
::
	`¥rštf
(
buf
, "% ha ©šed†ev– %d!", 
ch
->
Çme
, ch->
Ëv–
);

209 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_LEVELS
, 0, 0);

210 
	`do_£nd_ªnounû
(
ch
, 
buf
);

211 
	`advªû_Ëv–
(
ch
);

218 ià(
ch
->
³t
) {

219 ià((
ch
->
Ëv–
 > ch->
³t
->level) && (ch->level % 2)) {

220 
ch
->
³t
->
Ëv–
++;

221 
	`Åc_advªû_Ëv–
(
ch
->
³t
);

222 
	`¡c
("You¸³ˆgaš ¨Ëv–!\n", 
ch
);

226 
	`§ve_ch¬_obj
(
ch
);

228 
	}
}

233 
	$h™_gaš
(
Ch¬aù”
 *
ch
)

235 
gaš
;

236 
numb”
;

238 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

241 ià(
ch
->
	`is_Åc
()) {

242 
gaš
 = 5 + 
ch
->
Ëv–
;

244 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
»g’”©iÚ
))

245 
gaš
 *= 2;

247 
	`g‘_pos™iÚ
(
ch
)) {

248  : 
gaš
 /= 2; ;

250 
POS_SLEEPING
: 
gaš
 = 3 * gain / 2; ;

252 
POS_RESTING
: ;

254 
POS_FIGHTING
: 
gaš
 /= 3; ;

258 
gaš
 = 
¡d
::
	`max
(3, 
	`GET_ATTR_CON
(
ch
è- 3 + ch->
Ëv–
 / 2);

259 
gaš
 +ğ
gud_bË
[
ch
->
gud
].
hp_max
 - 10;

260 
numb”
 = 
	`numb”_³rûÁ
();

262 ià(
numb”
 < 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
ç¡_h—lšg
)) {

263 
gaš
 +ğ
numb”
 * gain / 100;

265 ià(
ch
->
h™
 < 
	`GET_MAX_HIT
(ch))

266 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
ç¡_h—lšg
, 
Œue
, 8);

269 
	`g‘_pos™iÚ
(
ch
)) {

270 : 
gaš
 /= 4; ;

272 
POS_SLEEPING
: ;

274 
POS_RESTING
: 
gaš
 /= 2; ;

276 
POS_FIGHTING
: 
gaš
 /= 6; ;

279 ià(
ch
->
pcd©a
->
cÚd™iÚ
[
COND_HUNGER
] == 0)

280 
gaš
 /= 2;

282 ià(
ch
->
pcd©a
->
cÚd™iÚ
[
COND_THIRST
] == 0)

283 
gaš
 /= 2;

286 
gaš
 = gaš * 
ch
->
š_room
->
	`h—l_¿‹
() / 100;

288 ià(
ch
->
Ú
 !ğ
nuÎ±r
 && ch->Ú->
™em_ty³
 =ğ
ITEM_FURNITURE
)

289 
gaš
 = gaš * 
ch
->
Ú
->
v®ue
[3] / 100;

291 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
poisÚ
))

292 
gaš
 /= 4;

294 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¶ague
))

295 
gaš
 /= 8;

297 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ha¡e
è&& ch->
¿û
 != 8)

298 
gaš
 /= 2 ;

300 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
))

301 
gaš
 *= 2 ;

303 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
»g’”©iÚ
))

304 
gaš
 *= 2;

306 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
divše_»g’”©iÚ
))

307 
gaš
 *= 4;

309  
¡d
::
	`mš
(
gaš
, 
	`GET_MAX_HIT
(
ch
è- ch->
h™
);

310 
	}
}

312 
	$mªa_gaš
(
Ch¬aù”
 *
ch
)

314 
gaš
, 
numb”
;

316 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

319 ià(
ch
->
	`is_Åc
()) {

320 
gaš
 = 5 + 
ch
->
Ëv–
;

322 
	`g‘_pos™iÚ
(
ch
)) {

323 : 
gaš
 /= 2; ;

325 
POS_SLEEPING
: 
gaš
 = 3 * gain / 2; ;

327 
POS_RESTING
: ;

329 
POS_FIGHTING
: 
gaš
 /= 3; ;

333 
gaš
 = (
	`GET_ATTR_WIS
(
ch
è+ 
	`GET_ATTR_INT
(chè+ ch->
Ëv–
) / 2;

334 
numb”
 = 
	`numb”_³rûÁ
();

336 ià(
numb”
 < 
	`g‘_skl_Ëv–
(
ch
, 
skl
::
ty³
::
med™©iÚ
)) {

337 
gaš
 +ğ
numb”
 * gain / 100;

339 ià(
ch
->
mªa
 < 
	`GET_MAX_MANA
(ch))

340 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
med™©iÚ
, 
Œue
, 8);

344 
gaš
 -ğgaš * (
gud_bË
[0].
mªa_max
 - gud_bË[
ch
->
gud
].mana_max)

345 / 
gud_bË
[0].
mªa_max
;

347 
	`g‘_pos™iÚ
(
ch
)) {

348 : 
gaš
 /= 4; ;

350 
POS_SLEEPING
: ;

352 
POS_RESTING
: 
gaš
 /= 2; ;

354 
POS_FIGHTING
: 
gaš
 /= 6; ;

357 ià(
ch
->
pcd©a
->
cÚd™iÚ
[
COND_HUNGER
] == 0)

358 
gaš
 /= 2;

360 ià(
ch
->
pcd©a
->
cÚd™iÚ
[
COND_THIRST
] == 0)

361 
gaš
 /= 2;

364 
gaš
 = gaš * 
ch
->
š_room
->
	`mªa_¿‹
() / 100;

366 ià(
ch
->
Ú
 !ğ
nuÎ±r
 && ch->Ú->
™em_ty³
 =ğ
ITEM_FURNITURE
)

367 
gaš
 = gaš * 
ch
->
Ú
->
v®ue
[4] / 100;

369 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
poisÚ
))

370 
gaš
 /= 4;

372 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¶ague
))

373 
gaš
 /= 8;

375 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ha¡e
è&& ch->
¿û
 != 8)

376 
gaš
 /= 2;

378 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
))

379 
gaš
 *= 2;

381 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
divše_»g’”©iÚ
))

382 
gaš
 *= 2;

384  
¡d
::
	`mš
(
gaš
, 
	`GET_MAX_MANA
(
ch
è- ch->
mªa
);

385 
	}
}

387 
	$¡am_gaš
(
Ch¬aù”
 *
ch
)

389 
gaš
;

391 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

394 ià(
ch
->
	`is_Åc
()) {

395 
gaš
 = 5 + 
ch
->
Ëv–
;

397 
	`g‘_pos™iÚ
(
ch
)) {

398 : 
gaš
 /= 2; ;

400 
POS_SLEEPING
: 
gaš
 = 3 * gain / 2; ;

402 
POS_RESTING
: ;

404 
POS_FIGHTING
: 
gaš
 /= 3; ;

408 
gaš
 = 
	`GET_ATTR_CON
(
ch
è+ 
	`GET_ATTR_DEX
(chè+ (ch->
Ëv–
 / 2);

410 
gaš
 -ğgaš * (
gud_bË
[3].
¡am_max
 - gud_bË[
ch
->
gud
].stam_max)

411 / 
gud_bË
[3].
¡am_max
;

413 
	`g‘_pos™iÚ
(
ch
)) {

414 : 
gaš
 /= 4; ;

416 
POS_SLEEPING
: ;

418 
POS_RESTING
: 
gaš
 /= 2; ;

420 
POS_FIGHTING
: 
gaš
 /= 6; ;

423 ià(
ch
->
pcd©a
->
cÚd™iÚ
[
COND_HUNGER
] == 0)

424 
gaš
 /= 2;

426 ià(
ch
->
pcd©a
->
cÚd™iÚ
[
COND_THIRST
] == 0)

427 
gaš
 /= 2;

430 
gaš
 = gaš * 
ch
->
š_room
->
	`h—l_¿‹
() / 100;

432 ià(
ch
->
Ú
 !ğ
nuÎ±r
 && ch->Ú->
™em_ty³
 =ğ
ITEM_FURNITURE
)

433 
gaš
 = gaš * 
ch
->
Ú
->
v®ue
[3] / 100;

435 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
poisÚ
))

436 
gaš
 /= 4;

438 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¶ague
))

439 
gaš
 /= 8;

441 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ha¡e
è&& ch->
¿û
 != 8)

442 
gaš
 /= 3;

444 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
))

445 
gaš
 *= 2;

447 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
»g’”©iÚ
))

448 
gaš
 *= 2;

450 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
divše_»g’”©iÚ
))

451 
gaš
 *= 2;

453  
¡d
::
	`mš
(
gaš
, 
	`GET_MAX_STAM
(
ch
è- ch->
¡am
);

454 
	}
}

456 
	$gaš_cÚd™iÚ
(
Ch¬aù”
 *
ch
, 
iCÚd
, 
v®ue
)

458 
cÚd™iÚ
;

460 ià(
v®ue
 =ğ0 || 
ch
->
	`is_Åc
(è|| ch->
pcd©a
 =ğ
nuÎ±r
)

463 ià(
	`IS_IMMORTAL
(
ch
)) {

464 ià(
iCÚd
 =ğ
COND_HUNGER
)

465 
ch
->
pcd©a
->
cÚd™iÚ
[
iCÚd
] = 100;

467 ià(
iCÚd
 =ğ
COND_THIRST
)

468 
ch
->
pcd©a
->
cÚd™iÚ
[
iCÚd
] = 100;

473 ià((
cÚd™iÚ
 = 
ch
->
pcd©a
->cÚd™iÚ[
iCÚd
]) == -1)

476 
ch
->
pcd©a
->
cÚd™iÚ
[
iCÚd
] = 
	`URANGE
(0, cÚd™iÚ + 
v®ue
, 48);

478 ià(!
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_CHATMODE
)) {

479 ià(
ch
->
pcd©a
->
cÚd™iÚ
[
iCÚd
] == 0) {

480 
iCÚd
) {

481 
COND_HUNGER
:

482 
	`¡c
("You‡» hungry.\n", 
ch
);

485 
COND_THIRST
:

486 
	`¡c
("You‡»hœ¡y.\n", 
ch
);

489 
COND_DRUNK
:

490 ià(
cÚd™iÚ
 != 0)

491 
	`¡c
("You‡» sob”.\n", 
ch
);

497 
	}
}

504 
	$mobe_upd©e
()

507 autØ
ch
 : 
Game
::
	`wÜld
().
ch¬_li¡
)

508 
ch
->
	`upd©e
();

509 
	}
}

513 
	$desü_upd©e
()

515 
DesütÜ
 *
d
, *
d_Ãxt
;

516 
Ch¬aù”
 *
ch
;

518 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = 
d_Ãxt
) {

519 
d_Ãxt
 = 
d
->
Ãxt
;

520 ++
d
->
tim”
;

522 ià(
d
->
	`is_¶ayšg
()) {

523 
ch
 = 
d
->
ch¬aù”
;

525 ià(
	`IS_IMMORTAL
(
ch
è|| 
	`g‘_du–
(ch)) {

526 ià(
d
->
tim”
 > 99)

527 
d
->
tim”
 = 99;

532 ià(
d
->
tim”
 >= 12) {

533 ià(
ch
->
was_š_room
 =ğ
nuÎ±r
 && ch->
š_room
 !=‚ullptr) {

534 
ch
->
was_š_room
 = ch->
š_room
;

536 ià(
ch
->
fightšg
 !ğ
nuÎ±r
)

537 
	`¡İ_fightšg
(
ch
, 
Œue
);

539 ià(!
ch
->
	`is_Åc
()){

540 
	`aù
("$Àdi§µ—r štØthvoid...", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

541 
	`¡c
("You di§µ—¸štØthvoid.\n", 
ch
);

543 ià(
ch
->
Ëv–
 > 1)

544 
	`§ve_ch¬_obj
(
ch
);

546 
	`ch¬_äom_room
(
ch
);

547 
	`ch¬_to_room
(
ch
, 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_LIMBO
))));

552 ià(
d
->
tim”
 == 7) {

553 ià(!
ch
->
comm_æags
.
	`has
(
COMM_AFK
è&& !ch->
	`is_Åc
()) {

554 
	`aù
("$Ài £ˆtØauto-afk...", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

555 
	`do_afk
(
ch
, "{CA{Tuto-{CA{Tfk by {BL{Ce{gg{Wa{Cc{By{x");

560 ià(
d
->
tim”
 > 30) {

561 
	`şo£_sock‘
(
d
);

565 
	}
}

570 
	$ch¬_upd©e
()

572 
Ch¬aù”
 *
ch_qu™
;

573 
ch_qu™
 = 
nuÎ±r
;

575 
§ve_numb”
++;

577 ià(
§ve_numb”
 > 29)

578 
§ve_numb”
 = 0;

580 autØ
ch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

581 ià(!
	`IS_IMMORTAL
(
ch
è&& !
	`ch¬_š_du–_room
(ch)) {

582 ià(
ch
->
desc
 !ğ
nuÎ±r
)

583 ià(
ch
->
desc
->
tim”
 > 30)

584 
ch_qu™
 = 
ch
;

586 ià(
ch
->
tim”
 > 30 && 
ch_qu™
 =ğ
nuÎ±r
)

587 
ch_qu™
 = 
ch
;

591 ià(!
ch
->
	`is_Åc
(è&& ch->
aù_æags
.
	`has
(
PLR_TICKS
))

592 
	`¡c
("{Btick...{x\n", 
ch
);

594 ià(
	`g‘_pos™iÚ
(
ch
è>ğ
POS_STUNNED
) {

596 ià(
ch
->
	`is_Åc
(è&& (ch->
Ãùim”
 > 0)) {

597 
ch
->
Ãùim”
 -= 1;

599 ià(
ch
->
Ãùim”
 <= 0) {

600 
	`aù
("$Àvªishe back iÁØthÃth” void.", 
ch
, 
nuÎ±r
,‚ullptr,

601 
TO_ROOM
);

602 
	`exŒaù_ch¬
(
ch
, 
Œue
);

611 ià(!
ch
->
	`is_Åc
(è&& ch->
pcd©a
->
çmŸr
) {

612 ià(! 
ch
->
³t
) {

613 
ch
->
pcd©a
->
çmŸr
 = 
çl£
;

619 ià(!
ch
->
	`is_Åc
(è&& ch->
gud
 =ğ
Gud
::
·Ïdš
) {

621 ià(
ch
->
pcd©a
->
Ïys
 > 10) ch->pcdata->lays = 10;

623 ià(
ch
->
pcd©a
->
Ïys
 < 0) ch->pcdata->lays = 0;

625 ià(
ch
->
pcd©a
->
Ãxt_Ïy_couÁdown
 > 
NEW_LAY_COUNTER
)

626 
ch
->
pcd©a
->
Ãxt_Ïy_couÁdown
 = 
NEW_LAY_COUNTER
;

628 
ch
->
pcd©a
->
Ãxt_Ïy_couÁdown
--;

630 ià(
ch
->
pcd©a
->
Ãxt_Ïy_couÁdown
 < 1) {

631 
ch
->
pcd©a
->
Ïys
 = (ch->
Ëv–
 / 10) + 1;

632 
ch
->
pcd©a
->
Ãxt_Ïy_couÁdown
 = 
NEW_LAY_COUNTER
;

636 ià(
ch
->
h™
 < 
	`GET_MAX_HIT
(ch))

637 
ch
->
h™
 +ğ
	`h™_gaš
(ch);

639 
ch
->
h™
 = 
	`GET_MAX_HIT
(ch);

641 ià(
ch
->
mªa
 < 
	`GET_MAX_MANA
(ch))

642 
ch
->
mªa
 +ğ
	`mªa_gaš
(ch);

644 
ch
->
mªa
 = 
	`GET_MAX_MANA
(ch);

646 ià(
ch
->
¡am
 < 
	`GET_MAX_STAM
(ch))

647 
ch
->
¡am
 +ğ
	`¡am_gaš
(ch);

649 
ch
->
¡am
 = 
	`GET_MAX_STAM
(ch);

652 ià(
	`g‘_pos™iÚ
(
ch
è=ğ
POS_STUNNED
)

653 
	`upd©e_pos
(
ch
);

655 ià(!
ch
->
	`is_Åc
(è&& !
	`IS_IMMORTAL
(ch)) {

656 
Objeù
 *
obj
;

658 ià((
obj
 = 
	`g‘_eq_ch¬
(
ch
, 
WEAR_LIGHT
)è!ğ
nuÎ±r


659 && 
obj
->
™em_ty³
 =ğ
ITEM_LIGHT


660 && 
obj
->
v®ue
[2] > 0) {

661 ià(--
obj
->
v®ue
[2] =ğ0 && 
ch
->
š_room
 !ğ
nuÎ±r
) {

662 ià(
ch
->
š_room
->
light
 > 0)

663 --
ch
->
š_room
->
light
;

665 
	`aù
("$°gÛ out. Hİyou'»‚Ù‡äaid oàthd¬k.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

666 
	`aù
("$°æick” ªd gÛ out.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

667 
	`de¡roy_obj
(
obj
);

669 ià(
obj
->
v®ue
[2] <ğ5 && 
ch
->
š_room
 !ğ
nuÎ±r
)

670 
	`aù
("$°his£ ªd s·rks.", 
ch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

674 ià(
ch
->
desc
 =ğ
nuÎ±r
) {

675 
ch
->
tim”
++;

677 ià(
	`IS_IMMORTAL
(
ch
è|| 
	`ch¬_š_du–_room
(ch)) {

678 ià(
ch
->
tim”
 > 99)

679 
ch
->
tim”
 = 99;

681 ià(
ch
->
tim”
 >ğ12 && ch->
was_š_room
 =ğ
nuÎ±r
 && ch->
š_room
 !=‚ullptr) {

682 
ch
->
was_š_room
 = ch->
š_room
;

684 ià(
ch
->
fightšg
 !ğ
nuÎ±r
)

685 
	`¡İ_fightšg
(
ch
, 
Œue
);

687 
	`aù
("$Àdi§µ—r štØthvoid...", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

688 
	`¡c
("You di§µ—¸štØthvoid.\n", 
ch
);

690 ià(
ch
->
Ëv–
 > 1)

691 
	`§ve_ch¬_obj
(
ch
);

693 
	`ch¬_äom_room
(
ch
);

694 
	`ch¬_to_room
(
ch
, 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_LIMBO
))));

698 
	`gaš_cÚd™iÚ
(
ch
, 
COND_DRUNK
, -1);

699 
	`gaš_cÚd™iÚ
(
ch
, 
COND_FULL
, ch->
size
 > 
SIZE_MEDIUM
 ? -4 : -3);

702 ià(
	`HAS_RAFF
(
ch
, 
RAFF_NOHUNGER
))

703 
	`gaš_cÚd™iÚ
(
ch
, 
COND_HUNGER
, 0);

704 ià(
	`HAS_RAFF
(
ch
, 
RAFF_EXTRAHUNGRY
))

705 
	`gaš_cÚd™iÚ
(
ch
, 
COND_HUNGER
, ch->
size
 > 
SIZE_MEDIUM
 ? -4 : -2);

707 
	`gaš_cÚd™iÚ
(
ch
, 
COND_HUNGER
, ch->
size
 > 
SIZE_MEDIUM
 ? -2 : -1);

709 ià(
	`HAS_RAFF
(
ch
, 
RAFF_NOTHIRST
))

710 
	`gaš_cÚd™iÚ
(
ch
, 
COND_THIRST
, 0);

711 ià(
	`HAS_RAFF
(
ch
, 
RAFF_EXTRATHIRSTY
))

712 
	`gaš_cÚd™iÚ
(
ch
, 
COND_THIRST
, -2);

714 
	`gaš_cÚd™iÚ
(
ch
, 
COND_THIRST
, -1);

717 ià(
ch
->
pcd©a
->
æag_kËr
 =ğ0 && ch->
aù_æags
.
	`has
(
PLR_KILLER
)) {

718 
ch
->
aù_æags
 -ğ
PLR_KILLER
;

719 
ch
->
aù_æags
 -ğ
PLR_NOPK
;

720 
	`¡c
("ThurgtØkÈdimishes.\n", 
ch
);

721 
	`¡c
("You‡»‚ØlÚg”‡ KILLER.\n", 
ch
);

722 
	`§ve_ch¬_obj
(
ch
);

724 ià(
ch
->
pcd©a
->
æag_kËr
 > 0 && ch->
aù_æags
.
	`has
(
PLR_KILLER
))

725 
ch
->
pcd©a
->
æag_kËr
--;

728 ià(
ch
->
pcd©a
->
æag_th›f
 =ğ0 && ch->
aù_æags
.
	`has
(
PLR_THIEF
)) {

729 
ch
->
aù_æags
 -ğ
PLR_THIEF
;

730 
ch
->
aù_æags
 -ğ
PLR_NOPK
;

731 
	`¡c
("ThurgtØ¡—Èdimishes.\n", 
ch
);

732 
	`¡c
("You‡»‚ØlÚg”‡ THIEF.\n", 
ch
);

733 
	`§ve_ch¬_obj
(
ch
);

735 ià(
ch
->
pcd©a
->
æag_th›f
 > 0 && ch->
aù_æags
.
	`has
(
PLR_THIEF
))

736 
ch
->
pcd©a
->
æag_th›f
--;

747 
afãù
::
	`sÜt_ch¬
(
ch
,‡fãù::
com·¿tÜ_du¿tiÚ
);

748 
afãù
::
	`sÜt_ch¬
(
ch
,‡fãù::
com·¿tÜ_ty³
);

750 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_ch¬
(
ch
);…af;…aàğ·f->
Ãxt
) {

751 ià(
·f
->
du¿tiÚ
 == 0) {

752 ià(
·f
->
Ãxt
 =ğ
nuÎ±r


753 || 
·f
->
Ãxt
->
ty³
 !=…af->type

754 || 
·f
->
Ãxt
->
du¿tiÚ
 > 0) {

755 ià(
·f
->
ty³
 >ğ
afãù
::ty³::
fœ¡
 && !afãù::
	`lookup
Õaf->ty³).
msg_off
.
	`em±y
())

756 
	`±c
(
ch
, "%s\n", 
afãù
::
	`lookup
(
·f
->
ty³
).
msg_off
);

762 
afãù
::
Afãù
 
·‰”n
;

763 
·‰”n
.
du¿tiÚ
 = 0;

764 
afãù
::
	`»move_m©chšg_äom_ch¬
(
ch
,‡fãù::
com·¿tÜ_du¿tiÚ
, &
·‰”n
);

770 
afãù
::
	`™”©e_ov”_ch¬
(
ch
,‡fãù::
â_çde_¥–l
, 
nuÎ±r
);

773 ià(
ch
->
	`is_Åc
()) {

774 
	`m´og_tick_Œigg”
(
ch
);

778 ià(
ch
->
	`is_g¬bage
())

788 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¶ague
)) {

789 cÚ¡ 
afãù
::
Afãù
 *
¶ague
 =‡fãù::
	`fšd_Ú_ch¬
(
ch
,‡fãù::
ty³
::plague);

791 
	`aù
("$n writhes in‡gony‡s…lague soresƒrupt from $s skin.",

792 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

793 
	`¡c
("You wr™hš‡gÚy fromh¶ague.\n", 
ch
);

795 
	`¥»ad_¶ague
(
ch
->
š_room
, 
¶ague
, 4);

798 
dam
 = 
¡d
::
	`mš
(
ch
->
Ëv–
, (
¶ague
 ?…lague->level : ch->level) / 5 + 1);

799 
ch
->
mªa
 -ğ
dam
;

800 
ch
->
¡am
 -ğ
dam
;

801 
	`damage
(
ch
->
fightšg
 ? ch->fightšg : ch, ch, 
dam
, 
skl
::
ty³
::
¶ague
, -1, 
DAM_DISEASE
, 
çl£
, 
Œue
);

804 ià(
ch
->
	`is_g¬bage
())

807 ià(
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
poisÚ
)

808 && !
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
¦ow
)) {

809 cÚ¡ 
afãù
::
Afãù
 *
poisÚ
 =‡fãù::
	`fšd_Ú_ch¬
(
ch
,‡fãù::
ty³
::poison);

811 ià(
poisÚ
 !ğ
nuÎ±r
) {

812 
	`aù
("$Àshiv” ªd sufãrs.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

813 
	`¡c
("You shiv”‡nd sufãr.\n", 
ch
);

814 
	`damage
(
ch
->
fightšg
 ? ch->fightšg : ch, ch, 
poisÚ
->
Ëv–
 / 10 + 1, 
skl
::
ty³
::poison,

815 -1, 
DAM_POISON
, 
çl£
, 
Œue
);

819 ià(
ch
->
	`is_g¬bage
())

823 ià(
	`g‘_pos™iÚ
(
ch
è=ğ
POS_INCAP
 && 
	`rŞl_chªû
(50))

824 
	`damage
(
ch
->
fightšg
 ? ch->fightšg : ch, ch, 1, 
skl
::
ty³
::
unknown
, -1, 
DAM_NONE
, 
çl£
, false);

825 ià(
	`g‘_pos™iÚ
(
ch
è=ğ
POS_MORTAL
)

826 
	`damage
(
ch
->
fightšg
 ? ch->fightšg : ch, ch, 1, 
skl
::
ty³
::
unknown
, -1, 
DAM_NONE
, 
çl£
, false);

833 autØ
ch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

834 ià(
ch
->
desc
 !ğ
nuÎ±r
 && ch->desc->
desütÜ
 % 30 =ğ
§ve_numb”
)

835 
	`§ve_ch¬_obj
(
ch
);

837 ià(
ch
 =ğ
ch_qu™
)

838 
	`do_qu™
(
ch
, "now");

842 
	}
}

848 
	$obj_upd©e
()

850 
Objeù
 *
obj
;

851 
Objeù
 *
obj_Ãxt
;

853 
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

854 
Ch¬aù”
 *
rch
;

855 *
mes§ge
;

856 
obj_Ãxt
 = 
obj
->
Ãxt
;

867 
afãù
::
	`sÜt_obj
(
obj
,‡fãù::
com·¿tÜ_du¿tiÚ
);

868 
afãù
::
	`sÜt_obj
(
obj
,‡fãù::
com·¿tÜ_ty³
);

870 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_obj
(
obj
);…af;…aàğ·f->
Ãxt
) {

871 ià(
·f
->
du¿tiÚ
 == 0) {

872 ià(
·f
->
Ãxt
 =ğ
nuÎ±r


873 || 
·f
->
Ãxt
->
ty³
 !=…af->type

874 || 
·f
->
Ãxt
->
du¿tiÚ
 > 0) {

876 ià(
·f
->
ty³
 =ğ
afãù
::ty³::
nÚe
) {

877 ià(
obj
->
ÿ¼›d_by
 !ğ
nuÎ±r
) {

878 
rch
 = 
obj
->
ÿ¼›d_by
;

879 
	`aù
("Thmagiøoà$°dimšishes.", 
rch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

882 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr) {

883 
rch
 = 
obj
->
š_room
->
³İË
;

884 
	`aù
("Thmagiøoà$°dimšishes.", 
rch
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

888 
SŒšg
 
mes§ge
 = 
afãù
::
	`lookup
(
·f
->
ty³
).
msg_obj
;

890 ià(!
mes§ge
.
	`em±y
()) {

891 ià(
obj
->
ÿ¼›d_by
 !ğ
nuÎ±r
) {

892 
rch
 = 
obj
->
ÿ¼›d_by
;

893 
	`aù
(
mes§ge
, 
rch
, 
obj
, 
nuÎ±r
, 
TO_CHAR
);

896 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && obj->š_room->
³İË
 !=‚ullptr) {

897 
rch
 = 
obj
->
š_room
->
³İË
;

898 
	`aù
(
mes§ge
, 
rch
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

906 
afãù
::
Afãù
 
·‰”n
;

907 
·‰”n
.
du¿tiÚ
 = 0;

908 
afãù
::
	`»move_m©chšg_äom_obj
(
obj
,‡fãù::
com·¿tÜ_du¿tiÚ
, &
·‰”n
);

914 
afãù
::
	`™”©e_ov”_obj
(
obj
,‡fãù::
â_çde_¥–l
, 
nuÎ±r
);

917 ià(
auùiÚ
.
	`is_·¹icªt
(
obj
))

920 ià(
obj
->
tim”
 <= 0 || --obj->timer > 0)

921 ià(
obj
->
ş—n_tim”
 <= 0 || --obj->clean_timer > 0)

926 
obj
->
™em_ty³
) {

927 : 
mes§ge
 = "$p crumbles into‡shes."; ;

929 
ITEM_FOUNTAIN
: 
mes§ge
 = "$purnso dust‡t your feet."; ;

931 
ITEM_CORPSE_NPC
: 
mes§ge
 = "$p decays into dust."; ;

933 
ITEM_CORPSE_PC
: 
mes§ge
 = "$p is carried off by„avenous vultures."; ;

935 ià(
obj
->
cÚšs
)

936 
mes§ge
 = "$p is carried off by„avenous vultures,†eaving its contents onhe ground.";

938 
mes§ge
 = "$p is carried off by„avenous vultures.";

942 
ITEM_FOOD
: 
mes§ge
 = "$p decays into‚othing."; ;

944 
ITEM_POTION
: 
mes§ge
 = "$p shatters, messily spilling its unused contents."; ;

946 
ITEM_PORTAL
: 
mes§ge
 = "$p implodes with‡„ush of‡ir‡nd is gone."; ;

948 
ITEM_CONTAINER
:

949 ià(
	`CAN_WEAR
(
obj
, 
ITEM_WEAR_FLOAT
))

950 
mes§ge
 = "$p flickers‡nd vanishes.";

952 
mes§ge
 = "$p crumbles into dust.";

957 ià(
obj
->
ÿ¼›d_by
 !ğ
nuÎ±r
) {

958 ià(
obj
->
ÿ¼›d_by
->
	`is_Åc
(è&& obj->ÿ¼›d_by->
pIndexD©a
->
pShİ
 !ğ
nuÎ±r
)

959 
obj
->
ÿ¼›d_by
->
sv”
 +ğobj->
co¡
 / 5;

960 ià(!
obj
->
š_obj
) {

961 
	`aù
(
mes§ge
, 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_CHAR
);

963 ià(
	`g‘_eq_ch¬
(
obj
->
ÿ¼›d_by
, 
WEAR_FLOAT
) == obj) {

964 
	`aù
(
mes§ge
, 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ROOM
);

966 ià(
obj
->
cÚšs
)

967 
	`aù
("$°¥l ™ cÚ‹Á Úhground.", 
obj
->
ÿ¼›d_by
, obj, 
nuÎ±r
, 
TO_ALL
);

971 ià(
obj
->
š_room
 !ğ
nuÎ±r
 && (
rch
 = obj->š_room->
³İË
è!ğnuÎ±¸&& !obj->
š_obj
)

972 
	`aù
(
mes§ge
, 
rch
, 
obj
, 
nuÎ±r
, 
TO_ALL
);

975 ià(
obj
->
™em_ty³
 !ğ
ITEM_CORPSE_NPC
 && obj->
cÚšs
) {

976 
Objeù
 *
t_obj
, *
Ãxt_obj
;

978 
t_obj
 = 
obj
->
cÚšs
;_obj !ğ
nuÎ±r
;_obj = 
Ãxt_obj
) {

979 
Ãxt_obj
 = 
t_obj
->
Ãxt_cÚ‹Á
;

980 
	`obj_äom_obj
(
t_obj
);

982 ià(
obj
->
š_obj
)

983 
	`obj_to_obj
(
t_obj
, 
obj
->
š_obj
);

984 ià(
obj
->
ÿ¼›d_by
) {

985 ià(
	`g‘_eq_ch¬
(
obj
->
ÿ¼›d_by
, 
WEAR_FLOAT
) == obj) {

986 ià(
obj
->
ÿ¼›d_by
->
š_room
 =ğ
nuÎ±r
)

987 
	`exŒaù_obj
(
t_obj
);

989 
	`obj_to_room
(
t_obj
, 
obj
->
ÿ¼›d_by
->
š_room
);

992 
	`obj_to_ch¬
(
t_obj
, 
obj
->
ÿ¼›d_by
);

994 ià(
obj
->
š_room
 =ğ
nuÎ±r
)

995 
	`exŒaù_obj
(
t_obj
);

997 
	`obj_to_room
(
t_obj
, 
obj
->
š_room
);

1001 
	`exŒaù_obj
(
obj
);

1003 
	}
}

1006 
	$room_upd©e
() {

1007 auto& 
¬—_·œ
 : 
Game
::
	`wÜld
().
¬—s
) {

1008 auto& 
·œ
 : 
¬—_·œ
.
£cÚd
->
rooms
) {

1009 
Room
 *
room
 = 
·œ
.
£cÚd
;

1017 
afãù
::
	`sÜt_room
(
room
,‡fãù::
com·¿tÜ_du¿tiÚ
);

1018 
afãù
::
	`sÜt_room
(
room
,‡fãù::
com·¿tÜ_ty³
);

1020 cÚ¡ 
afãù
::
Afãù
 *
·f
 =‡fãù::
	`li¡_room
(
room
);…af;…aàğ·f->
Ãxt
) {

1021 ià(
·f
->
du¿tiÚ
 == 0) {

1022 ià(
·f
->
Ãxt
 =ğ
nuÎ±r


1023 || 
·f
->
Ãxt
->
ty³
 !=…af->type

1024 || 
·f
->
Ãxt
->
du¿tiÚ
 > 0) {

1026 ià(!
room
->
³İË
)

1033 
SŒšg
 
mes§ge
 = 
afãù
::
	`lookup
(
·f
->
ty³
).
msg_obj
;

1035 ià(!
mes§ge
.
	`em±y
())

1036 
	`aù
(
mes§ge
, 
nuÎ±r
,‚uÎ±r,‚uÎ±r, 
TO_ALL
);

1042 
afãù
::
Afãù
 
·‰”n
;

1043 
·‰”n
.
du¿tiÚ
 = 0;

1044 
afãù
::
	`»move_m©chšg_äom_room
(
room
,‡fãù::
com·¿tÜ_du¿tiÚ
, &
·‰”n
);

1050 
afãù
::
	`™”©e_ov”_room
(
room
,‡fãù::
â_çde_¥–l
, 
nuÎ±r
);

1053 
	}
}

1070 
boŞ
 
	$–igibË_agg»ssÜ
(
Ch¬aù”
 *
ch
)

1072  (
ch
->
	`is_Åc
()

1073 && 
	`IS_AWAKE
(
ch
)

1074 && 
ch
->
aù_æags
.
	`has_ªy_of
(
ACT_AGGRESSIVE
 | 
ACT_AGGR_ALIGN
)

1075 && 
ch
->
fightšg
 =ğ
nuÎ±r


1076 && !
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ÿlm
)

1077 && !
afãù
::
	`exi¡s_Ú_ch¬
(
ch
,‡fãù::
ty³
::
ch¬m_³rsÚ
)

1079 
	}
}

1081 
boŞ
 
	$–igibË_viùim
(
Ch¬aù”
 *
ch
)

1083 ià(
ch
->
	`is_Åc
())

1084  
çl£
;

1086 ià(
	`IS_IMMORTAL
(
ch
))

1087  
çl£
;

1092  
Œue
;

1093 
	}
}

1095 
	$aggr_upd©e
()

1097 
DesütÜ
 *
d
;

1098 
¶ay”_couÁ
;

1099 
jroom
, 
room_couÁ
;

1100 
jviùim
, 
viùim_couÁ
, 
viùim_num
;

1101 
jmob
, 
mob_couÁ
, 
mob_num
;

1102 
Room
 *
room
;

1103 
Ch¬aù”
 *
ch
, *
¶r
, *
mob
, *
viùim
;

1104 
boŞ
 
du¶iÿ‹
;

1107 
¶ay”_couÁ
 = 0;

1109 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
)

1110 
¶ay”_couÁ
++;

1113 
Room
 *
room_li¡
[
¶ay”_couÁ
];

1115 
jroom
 = 0; jroom < 
¶ay”_couÁ
; jroom++)

1116 
room_li¡
[
jroom
] = 
nuÎ±r
;

1119 
room_couÁ
 = 0;

1121 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

1122 ià(!
d
->
	`is_¶ayšg
() ||

1123 
d
->
Üigš®
 !ğ
nuÎ±r
)

1126 
¶r
 = 
d
->
ch¬aù”
;

1128 ià(
¶r
->
	`is_Åc
() ||

1129 
¶r
->
š_room
 =ğ
nuÎ±r
)

1132 
du¶iÿ‹
 = 
çl£
;

1134 
jroom
 = 0; jroom < 
room_couÁ
; jroom++)

1135 ià(
room_li¡
[
jroom
] =ğ
¶r
->
š_room
)

1136 
du¶iÿ‹
 = 
Œue
;

1138 ià(
du¶iÿ‹
 =ğ
çl£
)

1139 
room_li¡
[
room_couÁ
++] = 
¶r
->
š_room
;

1143 
jroom
 = 0; jroom < 
room_couÁ
; jroom++) {

1144 
room
 = 
room_li¡
[
jroom
];

1150 
ch
 = 
room
->
³İË
; ch !ğ
nuÎ±r
; ch = ch->
Ãxt_š_room
) {

1151 ià(
	`IS_SQUESTOR
(
ch
)

1152 && 
ch
->
pcd©a
->
sque¡mob
 !ğ
nuÎ±r


1153 && 
ch
->
pcd©a
->
sque¡obj
 =ğ
nuÎ±r
) {

1155 
mob
 = 
room
->
³İË
; mob !ğ
nuÎ±r
; mob = mob->
Ãxt_š_room
) {

1156 ià(
mob
->
	`is_Åc
(è&& mob =ğ
ch
->
pcd©a
->
sque¡mob
 && 
	`ÿn_£e_ch¬
(mob, ch)) {

1157 
	`sque¡mob_found
(
ch
, 
mob
);

1167 
ch
 = 
room
->
³İË
; ch !ğ
nuÎ±r
; ch = ch->
Ãxt_š_room
) {

1168 ià(
ch
->
	`is_Åc
(è&& ch->
m·ù
 !ğ
nuÎ±r
) {

1172 
MobProgAùLi¡
 *
¡¬t
 = 
ch
->
m·ù
;

1173 
ch
->
m·ù
 = 
nuÎ±r
;

1175 
MobProgAùLi¡
 *
tmp_aù
 = 
¡¬t
;mp_aù !ğ
nuÎ±r
;mp_aù =mp_aù->
Ãxt
) {

1176 
	`m´og_wÜdli¡_check
(
tmp_aù
->
buf
, 
ch
,mp_act->ch,

1177 
tmp_aù
->
obj
,mp_aù->
vo
, 
ACT_PROG
);

1181 
¡¬t
 !ğ
nuÎ±r
) {

1182 
MobProgAùLi¡
 *
tmp_aù
 = 
¡¬t
->
Ãxt
;

1183 
d–‘e
 
¡¬t
;

1184 
¡¬t
 = 
tmp_aù
;

1190 ià(
room
->
	`æags
().
	`has
(
ROOM_SAFE
)

1191 || 
room
->
	`æags
().
	`has
(
ROOM_LAW
))

1196 
mob_couÁ
 = 0;

1197 
viùim_couÁ
 = 0;

1199 
ch
 = 
room
->
³İË
; ch !ğ
nuÎ±r
; ch = ch->
Ãxt_š_room
)

1200 ià(
	`–igibË_agg»ssÜ
(
ch
))

1201 
mob_couÁ
++;

1202 ià(
	`–igibË_viùim
(
ch
))

1203 
viùim_couÁ
++;

1206 ià(
mob_couÁ
 =ğ0 || 
viùim_couÁ
 == 0)

1210 
mob_num
 = 
	`numb”_¿nge
(1, 
mob_couÁ
);

1211 
viùim_num
 = 
	`numb”_¿nge
(1, 
viùim_couÁ
);

1213 
jmob
 = 0;

1214 
mob
 = 
nuÎ±r
;

1215 
jviùim
 = 0;

1216 
viùim
 = 
nuÎ±r
;

1218 
ch
 = 
room
->
³İË
; ch !ğ
nuÎ±r
; ch = ch->
Ãxt_š_room
) {

1219 ià(
	`–igibË_agg»ssÜ
(
ch
)) {

1220 ià(++
jmob
 =ğ
mob_num
)

1221 
mob
 = 
ch
;

1223 ià(
	`–igibË_viùim
(
ch
)) {

1224 ià(++
jviùim
 =ğ
viùim_num
)

1225 
viùim
 = 
ch
;

1229 ià(
mob
 =ğ
nuÎ±r
 || 
viùim
 ==‚ullptr) {

1230 
Loggšg
::
	`bug
("aggr_update: mob or victim‚ullptr!", 0);

1235 ià((
mob
->
aù_æags
.
	`has
(
ACT_WIMPY
è&& 
	`IS_AWAKE
(
viùim
))

1236 || !
	`ÿn_£e_ch¬
(
mob
, 
viùim
))

1239 ià(
mob
->
Ëv–
 < 
viùim
->level - 5)

1242 ià(
mob
->
aù_æags
.
	`has
(
ACT_AGGR_ALIGN
)) {

1243 ià(
	`IS_NEUTRAL
(
viùim
))

1246 ià(
	`IS_GOOD
(
mob
è&& !
	`IS_EVIL
(
viùim
))

1249 ià(
	`IS_EVIL
(
mob
è&& !
	`IS_GOOD
(
viùim
))

1263 ià(
	`numb”_¿nge
(0, 29 - 
	`GET_ATTR_CHR
(
viùim
)) > 3)

1267 
	`muÉi_h™
(
mob
, 
viùim
, 
skl
::
ty³
::
unknown
);

1269 
	}
}

1271 
	$‹Ë_upd©e
()

1273 
Room
 *
room
;

1275 autØ
ch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

1276 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

1279 ià(
ch
->
š_room
->
	`æags
().
	`has
(
ROOM_TELEPORT
)) {

1280 
	`do_look
(
ch
, "tele");

1282 ià(!
ch
->
š_room
->
	`‹Ë_de¡
().
	`is_v®id
())

1283 
room
 = 
	`g‘_¿ndom_room
(
ch
);

1285 
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
ch
->
š_room
->
	`‹Ë_de¡
());

1287 
	`ch¬_äom_room
(
ch
);

1288 
	`ch¬_to_room
(
ch
, 
room
);

1289 
	`aù
("$À¦owly fade štØexi¡’û.\n", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

1290 
	`do_look
(
ch
, "auto");

1293 
	}
}

1302 
	$age_upd©e
()

1304 
DesütÜ
 *
d
;

1305 
Ch¬aù”
 *
wch
;

1308 ià(
Game
::
que¡_doubË
)

1309 
Game
::
que¡_doubË
++;

1311 
d
 = 
desütÜ_li¡
; d; d = d->
Ãxt
) {

1312 ià(!
d
->
	`is_¶ayšg
())

1315 
wch
 = (
d
->
Üigš®
 !ğ
nuÎ±r
è? d->Üigš® : d->
ch¬aù”
;

1317 ià(!
wch
->
	`is_Åc
())

1318 
wch
->
pcd©a
->
¶ayed
++;

1323 
	}
}

1339 
	$wa™_upd©e
()

1341 autØ
ch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

1342 ià(
ch
->
daze
 > 0) --ch->daze;

1344 ià(
ch
->
wa™
 > 0) --ch->wait;

1346 
	}
}

1353 
	$upd©e_hªdËr
()

1355 
pul£_que¡
,

1356 
pul£_mobe
,

1357 
pul£_viŞ’û
,

1358 
pul£_pošt
,

1359 
pul£_music
,

1360 
pul£_‹Ë
,

1361 
pul£_und”w©”
,

1362 
pul£_age
,

1364 
pul£_du–
,

1365 
pul£_jª™Ü
;

1368 
Game
::
	`wÜld
().
	`upd©e
();

1370 ià(--
pul£_que¡
 <ğ0è{…ul£_que¡ = 
PULSE_QUEST
; 
	`que¡_upd©e
(); }

1372 ià(--
pul£_music
 <ğ0è{…ul£_musiøğ
PULSE_MUSIC
; 
	`sÚg_upd©e
(); }

1376 ià(--
pul£_mobe
 <ğ0è{…ul£_mobğ
PULSE_MOBILE
; 
	`mobe_upd©e
();}

1378 ià(--
pul£_viŞ’û
 <ğ0è{…ul£_viŞ’û = 
PULSE_VIOLENCE
; 
	`viŞ’û_upd©e
();}

1380 ià(--
pul£_du–
 <ğ0è{…ul£_du– = 
PULSE_PER_SECOND
; 
	`du–_upd©e
();}

1382 ià(--
pul£_‹Ë
 <ğ0è{…ul£_‹Ë = 
PULSE_TELEPORT
; 
	`‹Ë_upd©e
(); }

1384 ià(--
pul£_und”w©”
 <ğ0è{…ul£_und”w©” = 
PULSE_UNDERWATER
; 
	`und”w©”_upd©e
();}

1386 ià(--
pul£_age
 <ğ0è{…ul£_agğ
PULSE_PER_SECOND
; 
	`age_upd©e
(); }

1388 ià(--
pul£_jª™Ü
 <ğ0è{…ul£_jª™Ü = 
PULSE_JANITOR
; 
	`jª™Ü_upd©e
();}

1392 ià(--
pul£_pošt
 <= 0) {

1393 
pul£_pošt
 = 
PULSE_TICK
;

1394 
Game
::
	`wÜld
().
time
.
	`upd©e
();

1395 
Game
::
	`wÜld
().
w—th”
.
	`upd©e
();

1396 
	`ch¬_upd©e
();

1397 
	`desü_upd©e
();

1398 
	`obj_upd©e
();

1399 
	`room_upd©e
();

1401 ià(
»boÙ_time
 != 0) {

1402 ià(
Game
::
cu¼’t_time
 =ğ
»boÙ_time
) {

1403 
couÁ
 = 0;

1404 
DesütÜ
 *
d
;

1406 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
)

1407 ià(
d
->
	`is_¶ayšg
())

1408 
couÁ
++;

1410 ià(
couÁ
 == 0) {

1411 
DesütÜ
 *
d_Ãxt
;

1412 
boŞ
 
m”c_down
;

1413 
Loggšg
::
	`log
("AUTO-REBOOT");

1415 
m”c_down
 = 
Œue
;

1417 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = 
d_Ãxt
) {

1418 
d_Ãxt
 = 
d
->
Ãxt
;

1419 
	`§ve_ch¬_obj
(
d
->
ch¬aù”
);

1420 
	`şo£_sock‘
(
d
);

1424 
»boÙ_time
 += 300;

1429 
	`wa™_upd©e
();

1430 
auùiÚ
.
	`upd©e
();

1431 
	`aggr_upd©e
();

1432 
	}
}

1435 
	$jª™Ü_upd©e
()

1437 
Ch¬aù”
 *
rch
;

1438 
Objeù
 *
obj
;

1440 ià(
Game
::
pÜt
 !ğ
DIZZYPORT
)

1443 
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj; obj = obj->
Ãxt
) {

1444 ià(!
obj
->
š_room


1445 || 
obj
->
cÚšs


1446 || 
obj
->
tim”


1447 || 
obj
->
ş—n_tim”
)

1450 ià(
obj
->
»£t
 && obj->»£t->
commªd
 == 'O')

1451 ià(
	`LoÿtiÚ
(()
obj
->
»£t
->
¬g3
è=ğobj->
š_room
->
loÿtiÚ
)

1454 
rch
 = 
obj
->
š_room
->
³İË
;„ch;„ch =„ch->
Ãxt_š_room
)

1455 ià(!
rch
->
	`is_Åc
())

1458 ià(
rch
)

1461 
obj
->
™em_ty³
) {

1462 
ITEM_FURNITURE
:

1463 
ITEM_MONEY
:

1464 
ITEM_CORPSE_PC
:

1465 
ITEM_FOUNTAIN
:

1466 
ITEM_PORTAL
:

1467 
ITEM_JUKEBOX
:

1468 
ITEM_ANVIL
:

1470 
ITEM_WEDDINGRING
:

1471 
ITEM_TOKEN
:

1475 ià(
	`rŞl_chªû
(10))

1476 
obj
->
ş—n_tim”
 = 
	`numb”_¿nge
(80, 240);

1480 
	`obj¡©e_§ve_™ems
();

1481 
	}
}

1483 
	$und”w©”_upd©e
()

1485 
skl
, 
dam
;

1487 autØ
ch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

1488 ià(!
ch
->
	`is_Åc
(è&& ch->
š_room
->
	`æags
().
	`has
(
ROOM_UNDER_WATER
)) {

1489 
skl
 = 
	`g‘_skl_Ëv–
(
ch
, skl::
ty³
::
swimmšg
);

1491 ià(
skl
 == 100)

1492 
	`¡c
("You would b{Cdrownšg{x iànÙ fÜ you¸und”w©” b»©hšg skl.\n", 
ch
);

1495 
	`gaš_cÚd™iÚ
(
ch
, 
COND_THIRST
,

1496 
liq_bË
[0].
afãù
[4] *†iq_bË[0].afãù[
COND_THIRST
] / 10);

1497 
	`gaš_cÚd™iÚ
(
ch
, 
COND_FULL
,

1498 
liq_bË
[0].
afãù
[4] *†iq_bË[0].afãù[
COND_FULL
] / 4);

1499 
dam
 = (
ch
->
h™
 * (100 - 
skl
)) / 400;

1501 ià(
ch
->
h™
 > 100) {

1502 
	`¡c
("{CYou‡» drownšg!!!{x\n", 
ch
);

1504 ià(
skl
 > 0) {

1505 
	`¡c
("{HYou¸skÈh–p ¦ow you¸drownšg.{x\n", 
ch
);

1506 
	`check_im´ove
(
ch
, 
skl
::
ty³
::
swimmšg
, 
Œue
, 1);

1509 
	`damage
(
ch
->
fightšg
 ? ch->fightšg : ch, ch, 
dam
, 
skl
::
ty³
::
swimmšg
, -1, 
DAM_WATER
, 
çl£
, 
Œue
);

1512 
	`¡c
("{PYou cªnÙ hŞd you¸b»©h‡ny mÜe!{x\n", 
ch
);

1513 
	`¡c
("{CYou¸lung fÈw™h w©”‡nd you†o£ cÚsciou¢ess...{x\n", 
ch
);

1514 
	`damage
(
ch
->
fightšg
 ? ch->fightšg : ch, ch, ch->
h™
 + 15, 
skl
::
ty³
::
swimmšg
, -1, 
DAM_WATER
, 
çl£
, 
Œue
);

1519 
	}
}

1521 
	$que¡_upd©e
()

1523 
DesütÜ
 *
d
;

1524 
Ch¬aù”
 *
ch
;

1526 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

1527 ià(
d
->
	`is_¶ayšg
()) {

1528 
ch
 = 
d
->
ch¬aù”
;

1530 ià(
ch
->
	`is_Åc
())

1533 ià(
ch
->
pcd©a
->
Ãxtque¡
 > 0) {

1534 
ch
->
pcd©a
->
Ãxtque¡
--;

1536 ià(
ch
->
pcd©a
->
Ãxtque¡
 == 0)

1537 
	`¡c
("You may‚ow que¡‡gaš.\n", 
ch
);

1539 ià(
	`IS_QUESTOR
(
ch
)) {

1540 ià(--
ch
->
pcd©a
->
couÁdown
 <= 0) {

1541 
ch
->
pcd©a
->
Ãxtque¡
 = 0;

1542 
	`¡c
("You havruÀouˆoàtimfÜ you¸que¡!\nYou may‚ow que¡‡gaš.\n", 
ch
);

1543 
	`que¡_ş—nup
(
ch
);

1546 ià(
ch
->
pcd©a
->
couÁdown
 > 0 && ch->pcdata->countdown < 6)

1547 
	`¡c
("B‘‹¸hu¼y, you'»‡lmo¡ ouˆoàtimfÜ you¸que¡!\n", 
ch
);

1551 ià(
ch
->
pcd©a
->
Ãxtsque¡
 > 0) {

1552 
ch
->
pcd©a
->
Ãxtsque¡
--;

1554 ià(
ch
->
pcd©a
->
Ãxtsque¡
 == 0)

1555 
	`¡c
("You may‚ow skÈque¡‡gaš.\n", 
ch
);

1557 ià(
	`IS_SQUESTOR
(
ch
)) {

1558 ià(--
ch
->
pcd©a
->
sqcouÁdown
 <= 0) {

1559 
ch
->
pcd©a
->
Ãxtsque¡
 = 0;

1560 
	`¡c
("You have„un out ofime for your skill quest!\n"

1561 "You may‚ow skÈque¡‡gaš.\n", 
ch
);

1562 
	`sq_ş—nup
(
ch
);

1565 ià(
ch
->
pcd©a
->
sqcouÁdown
 > 0 && ch->pcdata->sqcountdown < 6)

1566 
	`¡c
("B‘‹¸hu¼y, you'»‡lmo¡ ouˆoàtimfÜ you¸skÈque¡!\n", 
ch
);

1570 
	}
}

	@src/util/Image.cc

19 
	~<¡dlib.h
>

20 
	~<¡dio.h
>

21 
	~<²g.h
>

23 
	~"ut/Image.hh
"

24 
	~"SŒšg.hh
"

26 
Çme¥aû
 
	gut
 {

28 
boŞ
 
	gImage
::
lßd
(cÚ¡ 
SŒšg
& 
f’ame
) {

29 
FILE
 *
å
 = 
fİ’
(
f’ame
.
c_¡r
(), "rb");

31 ià(
	gå
 =ğ
nuÎ±r
)

32  
çl£
;

34 
²g_¡ruùp
 
	g²g
 = 
²g_ü—‹_»ad_¡ruù
(
PNG_LIBPNG_VER_STRING
, 
NULL
, NULL, NULL);

36 ià(
	g²g
 =ğ
nuÎ±r
)

37  
çl£
;

39 
²g_šfİ
 
	gšfo
 = 
²g_ü—‹_šfo_¡ruù
(
²g
);

41 ià(
	gšfo
 =ğ
nuÎ±r
)

42  
çl£
;

44 ià(
£tjmp
(
²g_jmpbuf
(
²g
)))

45  
	gçl£
;

47 
²g_š™_io
(
²g
, 
å
);

48 
²g_»ad_šfo
(
²g
, 
šfo
);

50 
width
(
²g_g‘_image_width
(
²g
, 
šfo
));

51 
height
(
²g_g‘_image_height
(
²g
, 
šfo
));

52 
²g_by‹
 
	gcŞÜ_ty³
 = 
²g_g‘_cŞÜ_ty³
(
²g
, 
šfo
);

53 
²g_by‹
 
	gb™_d•th
 = 
²g_g‘_b™_d•th
(
²g
, 
šfo
);

58 if(
	gb™_d•th
 == 16)

59 
²g_£t_¡r_16
(
²g
);

61 if(
	gcŞÜ_ty³
 =ğ
PNG_COLOR_TYPE_PALETTE
)

62 
²g_£t_·Ë‰e_to_rgb
(
²g
);

65 if(
	gcŞÜ_ty³
 =ğ
PNG_COLOR_TYPE_GRAY
 && 
b™_d•th
 < 8)

66 
²g_£t_ex·nd_g¿y_1_2_4_to_8
(
²g
);

68 if(
²g_g‘_v®id
(
²g
, 
šfo
, 
PNG_INFO_tRNS
))

69 
²g_£t_tRNS_to_®pha
(
²g
);

72 if(
	gcŞÜ_ty³
 =ğ
PNG_COLOR_TYPE_RGB
 ||

73 
cŞÜ_ty³
 =ğ
PNG_COLOR_TYPE_GRAY
 ||

74 
cŞÜ_ty³
 =ğ
PNG_COLOR_TYPE_PALETTE
)

75 
²g_£t_fËr
(
²g
, 0xFF, 
PNG_FILLER_AFTER
);

77 if(
	gcŞÜ_ty³
 =ğ
PNG_COLOR_TYPE_GRAY
 ||

78 
cŞÜ_ty³
 =ğ
PNG_COLOR_TYPE_GRAY_ALPHA
)

79 
²g_£t_g¿y_to_rgb
(
²g
);

81 
²g_»ad_upd©e_šfo
(
²g
, 
šfo
);

83 
	grows
 = 
Ãw
 
²g_by‹p
 [
height
()];

85 
	gy
 = 0; y < 
height
(); y++) {

86 
	grows
[
y
] = 
Ãw
 
²g_by‹
 [
²g_g‘_rowby‹s
(
²g
,
šfo
)];

89 
²g_»ad_image
(
²g
, 
rows
);

90 
²g_de¡roy_»ad_¡ruù
(&
²g
, &
šfo
, 
nuÎ±r
);

92 
fşo£
(
å
);

93  
	gŒue
;

96 
	gImage
::

97 ~
Image
() {

98 ià(
rows
 !ğ
nuÎ±r
) {

99 
h
 = 0; 
	gh
 < 
height
(); h++)

100 
	gd–‘e
[] 
	grows
[
h
];

102 
	gd–‘e
[] 
	grows
;

106 
	gImage
::

107 
v®ue
(
ChªÃl
 
rgb
, 
x
, 
y
) const {

108 ià(
	grows
 =ğ
nuÎ±r
 || 
x
 > 
width
(è|| 
y
 > 
height
())

111  
	grows
[
y
][
x
*4+
rgb
];

	@src/wiz_admin.cc

	@src/wiz_build.cc

17 
	~"¬gum’t.hh
"

18 
	~"A»a.hh
"

19 
	~"Ch¬aù”.hh
"

20 
	~"deş¬e.hh
"

21 
	~"Ex™.hh
"

22 
	~"FÜm©.hh
"

23 
	~"Game.hh
"

24 
	~"memÜy.hh
"

25 
	~"m”c.hh
"

26 
	~"MobePrÙÙy³.hh
"

27 
	~"ObjeùPrÙÙy³.hh
"

28 
	~"RoomPrÙÙy³.hh
"

29 
	~"Room.hh
"

30 
	~"SŒšg.hh
"

31 
	~"WÜld.hh
"

34 cÚ¡ 
	gİpos™e_dœ
 [6] =

35 { 
DIR_SOUTH
, 
DIR_WEST
, 
DIR_NORTH
, 
DIR_EAST
, 
DIR_DOWN
, 
DIR_UP
 };

37 ’um {
	mex™_äom
, 
	mex™_to
, 
	mex™_bÙh
} 
	tex™_¡©us
;

40 
SŒšg
 
	$room_·œ
(
Room
 *
Ëá
, Room *
right
, 
ex™_¡©us
 
ex
) {

41 
SŒšg
 
sEx™
;

43 
ex
) {

45 
sEx™
 = "??"; ;

47 
ex™_äom
:

48 
sEx™
 = "< "; ;

50 
ex™_to
:

51 
sEx™
 = " >"; ;

53 
ex™_bÙh
:

54 
sEx™
 = "<>"; ;

57 
SŒšg
 
ËáÇme
 = 
Ëá
->
	`Çme
().
	`uncŞÜ
();

58 
SŒšg
 
righŠame
 = 
right
->
	`Çme
().
	`uncŞÜ
();

59  
FÜm©
::
	`fÜm©
("%9s %-26.26s %s%9s %-26.26s(%-8.8s)\n",

60 
Ëá
->
loÿtiÚ
.
	`to_¡ršg
(
çl£
), 
ËáÇme
,

61 
sEx™
,

62 
right
->
loÿtiÚ
.
	`to_¡ršg
(
çl£
), 
righŠame
,

63 
right
->
	`¬—
().
Çme
);

64 
	}
}

68 
SŒšg
 
	$checkex™s
(
Room
 *
room
, cÚ¡ 
A»a
 *
pA»a
) {

69 
SŒšg
 
buf
;

71 
i
 = 0; i < 6; i++) {

72 
Ex™
 *
ex™
 = 
room
->ex™[
i
];

74 ià(!
ex™
)

77 
Room
 *
to_room
 = 
ex™
->to_room;

79 ià(
to_room
) {

80 ià((
room
->
	`¬—
(è=ğ*
pA»a
è&& (
to_room
->area() != *pArea)) {

83 ià(
to_room
->
ex™
[
İpos™e_dœ
[
i
]] &&

84 
to_room
->
ex™
[
İpos™e_dœ
[
i
]]->to_room =ğ
room
)

85 
buf
 +ğ
	`room_·œ
(
room
, 
to_room
, 
ex™_bÙh
);

87 
buf
 +ğ
	`room_·œ
(
room
, 
to_room
, 
ex™_to
);

89 ià((
room
->
	`¬—
(è!ğ*
pA»a
è&& (
ex™
->
to_room
->area() == *pArea)) {

91 ià(!(
to_room
->
ex™
[
İpos™e_dœ
[
i
]] &&

92 
to_room
->
ex™
[
İpos™e_dœ
[
i
]]->to_room =ğ
room
))

95 
buf
 +ğ
	`room_·œ
(
to_room
, 
room
, 
ex™_äom
);

101  
buf
;

102 
	}
}

105 
	$do_exli¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

107 cÚ¡ 
A»a
 *
to_¬—
 = &
ch
->
š_room
->
	`¬—
();

110 cÚ¡‡uto& 
äom_¬—
 : 
Game
::
	`wÜld
().
¬—s
)

111 cÚ¡‡uto& 
·œ
 : 
äom_¬—
.
£cÚd
->
rooms
)

112 
	`¡c
(
	`checkex™s
(
·œ
.
£cÚd
, 
to_¬—
), 
ch
);

113 
	}
}

117 
SŒšg
 
	$checkex™¡Üoom
(
Room
 *
room
, Room *
de¡
)

119 
SŒšg
 
buf
;

121 
i
 = 0; i < 6; i++) {

122 
Ex™
 *
ex™
 = 
room
->ex™[
i
];

124 ià(!
ex™
)

127 
Room
 *
to_room
 = 
ex™
->to_room;

129 ià(
to_room
) {

130 ià(
room
 =ğ
de¡
) {

133 ià(
to_room
->
ex™
[
İpos™e_dœ
[
i
]] &&

134 
to_room
->
ex™
[
İpos™e_dœ
[
i
]]->to_room =ğ
room
)

135 
buf
 +ğ
	`room_·œ
(
room
, 
to_room
, 
ex™_bÙh
);

137 
buf
 +ğ
	`room_·œ
(
room
, 
to_room
, 
ex™_to
);

139 ià(
to_room
 =ğ
de¡
) {

140 ià(!(
to_room
->
ex™
[
İpos™e_dœ
[
i
]] &&

141 
to_room
->
ex™
[
İpos™e_dœ
[
i
]]->to_room =ğ
room
))

144 
buf
 +ğ
	`room_·œ
(
to_room
, 
room
, 
ex™_äom
);

150  
buf
;

151 
	}
}

154 
	$do_roomex™s
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

156 
Room
 *
de¡
 = 
ch
->
š_room
;

158 cÚ¡‡uto& 
äom_¬—
 : 
Game
::
	`wÜld
().
¬—s
)

159 cÚ¡‡uto& 
·œ
 : 
äom_¬—
.
£cÚd
->
rooms
)

160 
	`¡c
(
	`checkex™¡Üoom
(
·œ
.
£cÚd
, 
de¡
), 
ch
);

161 
	}
}

164 
	$do_pock‘
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

166 
vnum
, 
couÁ
 = 0, 
size
 = 50;

168 
SŒšg
 
¬g1
;

169 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

171 ià(!
¬g1
.
	`em±y
(è&&‡rg1.
	`is_numb”
())

172 
size
 = 
	`©oi
(
¬g1
);

174 ià(
size
 < 20) {

175 
	`¡c
("Mšimum siztØ£¬ch fÜ i 20.\n", 
ch
);

179 
vnum
 = 1; vnum < 32600; vnum++) {

181 cÚ¡‡uto& 
¬—_·œ
: 
Game
::
	`wÜld
().
¬—s
) {

182 cÚ¡‡utØ
¬—
 = 
¬—_·œ
.
£cÚd
;

184 ià(
¬—
->
mš_vnum
 <ğ
vnum
 &&‡»a->
max_vnum
 >= vnum) {

185 ià(
couÁ
 >ğ
size
)

186 
	`±c
(
ch
, "%5dØ%5d, siz%d\n", 
vnum
 - (
couÁ
 - 1), vnum - 1, count - 1);

188 
couÁ
 = 0;

193 
couÁ
++;

195 
	}
}

198 
	$do_roomli¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

200 
fœ¡
, 
Ï¡
, 
couÁ”
;

201 
boŞ
 
found
 = 
çl£
;

202 
Room
 *
room
;

203 
SŒšg
 
bufãr
;

205 
SŒšg
 
¬g
;

206 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

208 ià(
¬g
.
	`em±y
(è|| 
¬gum’t
.empty()) {

209 
	`¡c
("SyÁax:„oomli¡ <¡¬tšg vnum> <’dšg vnum>\n", 
ch
);

213 ià(!
¬g
.
	`is_numb”
(è|| !
¬gum’t
.is_number()) {

214 
	`¡c
("V®ue mu¡ bnum”ic\n", 
ch
);

218 
fœ¡
 = 
	`©oi
(
¬g
);

219 
Ï¡
 = 
	`©oi
(
¬gum’t
);

221 ià((
fœ¡
 < 0è|| (fœ¡ > 99999è|| (
Ï¡
 < 0) || (last > 99999)) {

222 
	`¡c
("V®ue mu¡ bb‘w“À0‡nd 99999.\n", 
ch
);

226 ià(
fœ¡
 >ğ
Ï¡
) {

227 
	`¡c
("SecÚd v®umu¡ bg»©”hª fœ¡.\n", 
ch
);

231 
couÁ”
 = 
fœ¡
; couÁ” <ğ
Ï¡
; counter++) {

232 ià((
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
couÁ”
)))è!ğ
nuÎ±r
) {

233 
FÜm©
::
	`¥rštf
(
¬g
, "[%5d] (%s{x) %s{X\n",

234 
room
->
´ÙÙy³
.
vnum
.
	`v®ue
(),„oom->
	`¬—
().
Çme
,

235 
room
->
	`Çme
());

236 
bufãr
 +ğ
¬g
;

237 
found
 = 
Œue
;

241 ià(!
found
)

242 
	`¡c
("NØroom w”found w™hšh¿nggiv’.\n", 
ch
);

244 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

247 
	}
}

249 
	$do_vli¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

251 
buf
[
MAX_STRING_LENGTH
];

252 
SŒšg
 
tÙ®buf
;

253 
SŒšg
 
bufãr
;

254 
vnum
, 
begvnum
, 
’dvnum
;

255 
MobePrÙÙy³
 *
mobe
;

256 
ObjeùPrÙÙy³
 *
objeù
;

257 
boŞ
 
found
 = 
çl£
,

258 
´š‹d
 = 
çl£
,

259 
foundmobe
 = 
çl£
,

260 
foundd©a
 = 
çl£
;

262 
SŒšg
 
¬g
;

263 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

265 ià(!
¬g
.
	`is_numb”
()) {

266 
	`¡c
("SyÁax: vli¡ [beg vnum] [’d vnum]\n", 
ch
);

270 
begvnum
 = 
	`©oi
(
¬g
);

272 ià(!
¬gum’t
.
	`em±y
()) {

273 ià(!
¬gum’t
.
	`is_numb”
()) {

274 
	`¡c
("SyÁax: vli¡ [beg vnum] [’d vnum]\n", 
ch
);

278 
’dvnum
 = 
	`©oi
(
¬gum’t
);

281 
’dvnum
 = 
begvnum
;

283 ià((
begvnum
 < 0) || (begvnum > 99999)

284 || (
’dvnum
 < 0) || (endvnum > 99999)) {

285 
	`¡c
("V®ue mu¡ bb‘w“À0‡nd 99999.\n", 
ch
);

289 ià(
begvnum
 > 
’dvnum
) {

290 
	`¡c
("SecÚd v®umu¡ bg»©”hª fœ¡.\n", 
ch
);

295 
vnum
 = 
begvnum
; vnum <ğ
’dvnum
; vnum++) {

296 
found
 = 
çl£
;

297 
foundmobe
 = 
çl£
;

298 
tÙ®buf
 = 
FÜm©
::
	`fÜm©
("[%5d] ", 
vnum
);

300 ià((
mobe
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
vnum
)è!ğ
nuÎ±r
) {

301 ià(!
´š‹d
)

302 
	`¡c
("[ Vnum] Mob Objeù\n", 
ch
);

304 
FÜm©
::
	`¥rštf
(
buf
, "%s%*s", 
mobe
->
shÜt_desü
,

305 30 - 
mobe
->
shÜt_desü
.
	`uncŞÜ
().
	`size
(), " ");

307 
tÙ®buf
 +ğ
buf
;

308 
found
 = 
Œue
;

309 
foundmobe
 = 
Œue
;

310 
´š‹d
 = 
Œue
;

311 
foundd©a
 = 
Œue
;

314 ià((
objeù
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
vnum
)è!ğ
nuÎ±r
) {

315 ià(!
´š‹d
)

316 
	`¡c
("[ Vnum] Mob Objeù\n", 
ch
);

318 ià(
foundmobe
)

319 
FÜm©
::
	`¥rštf
(
buf
, "%-30 ", 
objeù
->
shÜt_desü
);

321 
FÜm©
::
	`¥rštf
(
buf
, "NONE %s", 
objeù
->
shÜt_desü
);

323 
tÙ®buf
 +ğ
buf
;

324 
found
 = 
Œue
;

325 
´š‹d
 = 
Œue
;

326 
foundd©a
 = 
Œue
;

328 ià(
foundmobe
) {

329 
FÜm©
::
	`¥rštf
(
buf
, "NONE");

330 
tÙ®buf
 +ğ
buf
;

336 ià(
found
) {

337 
tÙ®buf
 += "\n";

338 
bufãr
 +ğ
tÙ®buf
;

342 ià(!
foundd©a
)

343 
	`¡c
("NÙhšg wa found iÀth© vnum„ªge.\n", 
ch
);

345 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

347 
	}
}

	@src/wiz_coder.cc

17 
	~<veùÜ
>

19 
	~"¬gum’t.hh
"

20 
	~"afãù/Afãù.hh
"

21 
	~"A»a.hh
"

22 
	~"chªÃls.hh
"

23 
	~"Ch¬aù”.hh
"

24 
	~"CÏn.hh
"

25 
	~"deş¬e.hh
"

26 
	~"DesütÜ.hh
"

27 
	~"Ex™.hh
"

28 
	~"ExŒaDesü.hh
"

29 
	~"fe.hh
"

30 
	~"fšd.hh
"

31 
	~"FÏgs.hh
"

32 
	~"FÜm©.hh
"

33 
	~"Game.hh
"

34 
	~"š‹½.hh
"

35 
	~"memÜy.hh
"

36 
	~"m”c.hh
"

37 
	~"MobePrÙÙy³.hh
"

38 
	~"Objeù.hh
"

39 
	~"ObjeùPrÙÙy³.hh
"

40 
	~"PÏy”.hh
"

41 
	~"Re£t.hh
"

42 
	~"Room.hh
"

43 
	~"Shİ.hh
"

44 
	~"SocŸl.hh
"

45 
	~"SŒšg.hh
"

46 
	~"comm.hh
"

47 
	~"WÜld.hh
"

49 
time_t
 
»boÙ_time
;

50 
tİ_ex™
;

53 
Objeù
 *
obj_ä“
;

54 
Ch¬aù”
 *
ch¬_ä“
;

55 
DesütÜ
 *
desütÜ_ä“
;

56 
PÏy”
 *
pcd©a_ä“
;

57 
afãù
::
Afãù
 *
afãù_ä“
;

59 
	$do_autoboÙ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

61 
buf
[
MSL
];

62 
»boÙtime
, 
hours
 = 0, 
mšu‹s
 = 0;

63 
tm
 *tm;

65 ià(
¬gum’t
.
	`em±y
()) {

66 ià(
»boÙ_time
 != 0)

67 
	`±c
(
ch
, "Legacy i scheduËdØ»boÙ‡ˆ%s\n", (*è
	`ùime
(&
»boÙ_time
));

69 
	`¡c
("Legacy i nÙ scheduËdØb»boÙed.\n", 
ch
);

71 
	`¡c
("Syntax:\n"

72 "‡utÜeboÙ <num”iøtime>\n", 
ch
);

76 ià(!
¬gum’t
.
	`is_numb”
()) {

77 
	`¡c
("Timmu¡ bnum”ic, i.e. 1330 i 1:30…m.\n", 
ch
);

81 
»boÙtime
 = 
	`©oi
(
¬gum’t
);

83 ià(
»boÙtime
 < 0 ||„eboottime > 2359) {

84 
	`¡c
("Timi ouˆoà¿nge.\n", 
ch
);

88 
mšu‹s
 = 
»boÙtime
; mšu‹ >ğ59; mšu‹ -ğ100, 
hours
 += 1)

91 ià(
mšu‹s
 < 0) {

92 
	`¡c
("Thmšu‹ mu¡ bund” 60.\n", 
ch
);

96 
tm
 = 
	`loÿÉime
(&
Game
::
cu¼’t_time
);

98 ià((
hours
 < 
tm
->
tm_hour
è|| (hour =ğtm->tm_hou¸&& 
mšu‹s
 <m->
tm_mš
)) {

99 
	`¡c
("Thatime has‡lready…assed.\n"

100 "Thmud wÈassumyou wªˆth»boÙomÜrow.\n", 
ch
);

101 
hours
 = hours + 24;

104 
»boÙ_time
 = 
Game
::
cu¼’t_time
;

105 
»boÙ_time
 =„eboÙ_tim+ ((
hours
 - 
tm
->
tm_hour
) * 3600);

106 
»boÙ_time
 =„eboÙ_tim+ ((
mšu‹s
 - 
tm
->
tm_mš
) * 60);

107 
	`±c
(
ch
, "Legacy i now scheduËdØ»boÙ‡ˆ%s\n", (*)
	`ùime
(&
»boÙ_time
));

108 
FÜm©
::
	`¥rštf
(
buf
, "% ÿÎed fÜ‡uto-»boÙ‡ˆ%s\n", 
ch
->
Çme
, (*)
	`ùime
(&
»boÙ_time
));

109 
	`çµ’d
(
SHUTDOWN_FILE
, 
buf
);

110 
	}
}

112 *
	$fg‘f
(*
s
, 
n
, 
FILE
 *
iİ
)

114 
c
;

115 *
cs
;

116 
c
 = '\0';

117 
cs
 = 
s
;

119 --
n
 > 0 && (
c
 = 
	`g‘c
(
iİ
)è!ğ
EOF
)

120 ià((*
cs
++ = 
c
) == '\0')

123 *
cs
 = '\0';

124  ((
c
 =ğ
EOF
 && 
cs
 =ğ
s
è? 
nuÎ±r
 : s);

125 
	}
}

128 
	$do_pe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

130 
buf
[5000];

131 
FILE
 *
å
;

132 
å
 = 
	`pİ’
(
¬gum’t
.
	`c_¡r
(), "r");

133 
	`fg‘f
(
buf
, 5000, 
å
);

134 
	`·ge_to_ch¬
(
buf
, 
ch
);

135 
	`pşo£
(
å
);

137 
	}
}

233 
	$do_»boo
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

235 
	`¡c
("{NTØREBOOT, you mu¡ s³Îh’tœwÜd.{x\n", 
ch
);

236 
	}
}

238 
	$do_»boÙ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

240 
buf
[
MSL
];

241 
boŞ
 
m”c_down
;

242 
DesütÜ
 *
d
, *
d_Ãxt
;

244 ià(
¬gum’t
.
	`em±y
()) {

245 
	`¡c
("You mu¡…rovid¨»asÚ fÜ‡„eboÙ.\n", 
ch
);

249 
	`£t_cŞÜ
(
ch
, 
YELLOW
, 
BOLD
);

250 
FÜm©
::
	`¥rštf
(
buf
, "% ha ÿÎed fÜ‡ REBOOT. Back iÀ60 secÚd Ü†ess!\n", 
ch
->
Çme
);

251 
	`do_echo
(
ch
, 
buf
);

252 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

253 
	`do_®l§ve
(
ch
, "");

254 
	`do_§ve
(
ch
, "");

255 
m”c_down
 = 
Œue
;

257 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = 
d_Ãxt
) {

258 
d_Ãxt
 = 
d
->
Ãxt
;

259 
	`şo£_sock‘
(
d
);

261 
	}
}

263 
	$do_shutdow
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

265 
	`¡c
("{NTØSHUTDOWN, you mu¡ s³Îh’tœwÜd.{x\n", 
ch
);

266 
	}
}

268 
	$do_shutdown
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

270 
buf
[
MSL
], 
buf2
[MSL];

271 *
¡¹ime
;

272 
boŞ
 
m”c_down
;

273 
DesütÜ
 *
d
, *
d_Ãxt
;

275 ià(
Game
::
pÜt
 =ğ
DIZZYPORT
 && !
	`IS_IMP
(
ch
)) {

276 
	`¡c
("You mu¡ bª im¶em’tÜØshutdowÀLegacy.\n", 
ch
);

280 ià(
¬gum’t
.
	`em±y
()) {

281 
	`¡c
("You mu¡…rovid¨»asÚ fÜ‡ shutdown.\n", 
ch
);

285 
FÜm©
::
	`¥rštf
(
buf
, "% ha SHUTDOWNhsy¡em. Back‡á”he£ mes§ges!\n", 
ch
->
Çme
);

286 
	`do_echo
(
ch
, 
buf
);

288 ià(
Game
::
pÜt
 =ğ
DIZZYPORT
) {

289 
¡¹ime
 = 
	`ùime
(&
Game
::
cu¼’t_time
);

290 
¡¹ime
[
	`¡¾’
(strtime) - 1] = '\0';

291 
FÜm©
::
	`¥rštf
(
buf2
, "% :SHUTDOWN", 
¡¹ime
);

292 
	`çµ’d
(
SHUTDOWN_FILE
, 
buf2
);

293 
	`çµ’d
(
SHUTDOWN_FILE
, 
¬gum’t
);

296 
	`do_®l§ve
(
ch
, "");

297 
	`do_§ve
(
ch
, "");

298 
m”c_down
 = 
Œue
;

300 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = 
d_Ãxt
) {

301 
d_Ãxt
 = 
d
->
Ãxt
;

302 
	`şo£_sock‘
(
d
);

304 
	}
}

306 
	$do_¦ookup
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

308 
skl
::
ty³
 
¢
;

310 ià(
¬gum’t
.
	`em±y
()) {

311 
	`¡c
("Syntax:\n"

313 "¦ooku°<skÈÜ s³Î‚ame>\n", 
ch
);

317 
SŒšg
 
¬g
;

318 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

320 ià(
¬g
 == "all") {

321 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

322 
skl
::
ty³
y³ = 
·œ
.
fœ¡
;

323 cÚ¡‡uto& 
’Œy
 = 
·œ
.
£cÚd
;

325 ià(
ty³
 =ğ
skl
::ty³::
unknown
)

328 
	`±c
(
ch
, "Sn: %3d Skill/spell: '%s'\n",

329 ()
ty³
,

330 
’Œy
.
Çme
);

336 ià((
¢
 = 
skl
::
	`lookup
(
¬g
)è=ğskl::
ty³
::
unknown
) {

337 
	`¡c
("NØsuch skÈÜ s³Î.\n", 
ch
);

341 
	`±c
(
ch
, "Sn: %3d Skill/spell: '%s'\n",

342 
¢
,

343 
skl
::
	`lookup
(
¢
).
Çme
);

344 
	}
}

346 
	$do_advªû
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

348 
Ch¬aù”
 *
viùim
;

349 
Ëv–
, 
iLev–
;

351 
SŒšg
 
¬g1
, 
¬g2
;

352 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

353 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

355 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.em±y(è|| !¬g2.
	`is_numb”
()) {

356 
	`¡c
("Syntax:\n"

357 "‡dvªû <¶ay”> <Ëv–>\n", 
ch
);

361 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g1
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

362 
	`¡c
("They‡»‚Ù…Ïyšg.\n", 
ch
);

366 
Ëv–
 = 
	`©oi
(
¬g2
);

368 ià(
Ëv–
 < 1 ||†ev– > 
MAX_LEVEL
) {

369 
	`±c
(
ch
, "Lev– mu¡ b1Ø%d.\n", 
MAX_LEVEL
);

373 ià(
Ëv–
 =ğ
viùim
->level) {

374 
	`¡c
("Iˆwould‡ccom¶ish‚Ùhšg!\n", 
ch
);

378 ià(
viùim
 !ğ
ch
) {

379 ià(
	`IS_IMMORTAL
(
viùim
è&& !
	`IS_IMP
(
ch
)) {

380 
	`¡c
("You mu¡ bª im¶em’tÜØdØth©Ø¨ãÎow immÜl.\n", 
ch
);

385 ià(
Ëv–
 < 
viùim
->level) {

386 
	`¡c
("You„evokthËv– oàth¶ay”.\n", 
ch
);

387 
	`¡c
("**** D'OH! D'OH! D'OH! ****\n", 
viùim
);

389 
iLev–
 = 
viùim
->
Ëv–
; iLevel >†evel; iLevel--) {

390 
	`¡c
("==> ", 
viùim
);

391 
viùim
->
Ëv–
--;

392 
	`demÙe_Ëv–
(
viùim
);

394 ià(!
	`IS_IMMORTAL
(
viùim
è&& !
	`IS_REMORT
(victim)) {

395 ià(
viùim
->
Ëv–
 =ğ(
LEVEL_AVATAR
 - 1))

396 
viùim
->
	`»move_cgroup
(
GROUP_AVATAR
);

398 ià(
viùim
->
Ëv–
 =ğ(
LEVEL_HERO
 - 1))

399 
viùim
->
	`»move_cgroup
(
GROUP_HERO
);

404 
	`¡c
("You be¡ow you¸Lev–…ow” upÚhch¬aù”.\n", 
ch
);

405 
	`¡c
("**** WoOhOo! WoOhOo! WoOhOo! ****\n", 
viùim
);

407 
iLev–
 = 
viùim
->
Ëv–
; iLevel <†evel; iLevel++) {

408 
	`¡c
("==> ", 
viùim
);

409 
viùim
->
Ëv–
 += 1;

410 
	`advªû_Ëv–
(
viùim
);

412 ià(
viùim
->
Ëv–
 =ğ
LEVEL_AVATAR
)

413 
viùim
->
	`add_cgroup
(
GROUP_AVATAR
);

415 ià(
viùim
->
Ëv–
 =ğ
LEVEL_HERO
)

416 
viùim
->
	`add_cgroup
(
GROUP_HERO
);

420 
viùim
->
exp
 = 
	`exp_³r_Ëv–
(viùim, viùim->
pcd©a
->
pošts
è* 
¡d
::
	`max
(1, viùim->
Ëv–
);

421 
	`§ve_ch¬_obj
(
viùim
);

422 
	}
}

424 
	$do_wizlock
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

426 
Game
::
wizlock
 = !Game::wizlock;

428 ià(
Game
::
wizlock
) {

429 
	`wizÃt
("$N ha wizlockedhgame.", 
ch
, 
nuÎ±r
, 0, 0, 0);

430 
	`¡c
("Gamwizlocked.\n", 
ch
);

433 
	`wizÃt
("$N„emove thcu¼’ˆwizlock.", 
ch
, 
nuÎ±r
, 0, 0, 0);

434 
	`¡c
("Gamun-wizlocked.\n", 
ch
);

436 
	}
}

438 
	$do_»Ëv–
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

440 ià(
ch
->
	`is_Åc
(è|| !
	`IS_SPECIAL
(ch)) {

441 
	`do_huh
(
ch
);

445 
ch
->
pcd©a
->
cgroup_æags
 = 
GROUP_CLAN
 | 
GROUP_AVATAR
 | 
GROUP_HERO
 | 
GROUP_LEADER


446 | 
GROUP_GEN
 | 
GROUP_QUEST
 | 
GROUP_BUILD
 | 
GROUP_CODE
 | 
GROUP_SECURE
;

447 
ch
->
Ëv–
 = 
MAX_LEVEL
;

448 
ch
->
h™
 = 
	`ATTR_BASE
(ch, 
APPLY_HIT
) = 30000;

449 
ch
->
mªa
 = 
	`ATTR_BASE
(ch, 
APPLY_MANA
) = 30000;

450 
ch
->
¡am
 = 
	`ATTR_BASE
(ch, 
APPLY_STAM
) = 30000;

451 
	`¡c
("DÚe.\n", 
ch
);

452 
	}
}

454 
	$do_addex™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

456 
	`¡c
("SÜry,‡ddšg‡nd„emovšgƒx™ i cu¼’y di§bËd.\n", 
ch
);

503 
	}
}

505 
	$do_»mex™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

507 
	`¡c
("SÜry,‡ddšg‡nd„emovšgƒx™ i cu¼’y di§bËd.\n", 
ch
);

545 
	}
}

547 
	$do_memÜy
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

549 
	`±c
(
ch
, "Afãù %5d‡Îoÿ‹d, %5d f»e, %5d Bƒach\n", 
afãù
::
Afãù
::
	`poŞ_®loÿ‹d
(),‡fãù::Afãù::
	`poŞ_ä“
(), (affect::Affect));

550 
	`±c
(
ch
, "A»a  %5d, %5d Bƒach\n", 
Game
::
	`wÜld
().
¬—s
.
	`size
(), (
A»a
));

551 
	`±c
(
ch
, "ExDe  %5d‡Îoÿ‹d, %5d f»e, %5d Bƒach\n", 
ExŒaDesü
::
	`poŞ_®loÿ‹d
(), ExŒaDesü::
	`poŞ_ä“
(), (ExtraDescr));

552 
	`±c
(
ch
, "Ex™  %5d, %5d Bƒach\n", 
tİ_ex™
, (
Ex™
));

553 
	`±c
(
ch
, "SocŸl %5d, %5d Bƒach\n", 
	`couÁ_socŸls
(), (
SocŸl
));

554 
	`±c
(
ch
, "Ch¬  %5d‡Îoÿ‹d, %5d f»e, %5d Bƒach\n", 
Ch¬aù”
::
	`poŞ_®loÿ‹d
(), Ch¬aù”::
	`poŞ_ä“
(), (Character));

555 
	`±c
(
ch
, "Desü  %5d‡Îoÿ‹d, %5d f»e, %5d Bƒach\n", 
DesütÜ
::
	`poŞ_®loÿ‹d
(), DesütÜ::
	`poŞ_ä“
(), (Descriptor));

556 
	`±c
(
ch
, "Obj  %5d‡Îoÿ‹d, %5d f»e, %5d Bƒach\n", 
Objeù
::
	`poŞ_®loÿ‹d
(), Objeù::
	`poŞ_ä“
(), (Object));

557 
	`±c
(
ch
, "Re£t  %5d, %5d Bƒach\n", 
tİ_»£t
, (
Re£t
));

558 
	`±c
(
ch
, "Room  %5d, %5d Bƒach\n", 
tİ_room
, (
Room
));

559 
	`±c
(
ch
, "Shİ  %5d, %5d Bƒach\n", 
tİ_shİ
, (
Shİ
));

560 
	`±c
(
ch
, "CÏn  %5d, %5d Bƒach\n", 
	`couÁ_şªs
(), (
CÏn
));

561 
	`±c
(
ch
, "Ch¬aù” š stÜag %5d\n", 
	`couÁ_¡Üed_ch¬aù”s
());

563 
	}
}

565 
	$do_dump
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

567 
couÁ
, 
num_pcs
, 
aff_couÁ
;

568 
MobePrÙÙy³
 *
pMobIndex
;

569 
Objeù
 *
obj
;

570 
ObjeùPrÙÙy³
 *
pObjIndex
;

571 
Room
 *
room
;

572 
Ex™
 *
ex™
;

573 
DesütÜ
 *
d
;

574 
FILE
 *
å
;

575 
vnum
, 
nM©ch
 = 0;

577 
å
 = 
	`fİ’
("mem.dmp", "w");

579 
num_pcs
 = 0;

580 
aff_couÁ
 = 0;

582 
FÜm©
::
	`årštf
(
å
, "MobProt %4d (%8ld bytes)\n",

583 
tİ_mob_šdex
,İ_mob_šdex * ((*
pMobIndex
)));

585 
couÁ
 = 0;

587 autØ
fch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

588 
couÁ
++;

590 ià(
fch
->
pcd©a
 !ğ
nuÎ±r
)

591 
num_pcs
++;

593 cÚ¡ 
afãù
::
Afãù
 *
af
 =‡fãù::
	`li¡_ch¬
(
fch
);‡à!ğ
nuÎ±r
;‡àğaf->
Ãxt
)

594 
aff_couÁ
++;

597 
FÜm©
::
	`årštf
(
å
, "Mobs %4d (%8ld bytes)\n",

598 
couÁ
, couÁ * ((
Ch¬aù”
)));

601 
FÜm©
::
	`årštf
(
å
, "Pcdata %4d (%8ld bytes)\n",

602 
num_pcs
,‚um_pc * ((
PÏy”
)));

604 
couÁ
 = 0;

606 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
)

607 
couÁ
++;

609 
FÜm©
::
	`årštf
(
å
, "Descs %4d (%8ld bytes)\n",

610 
couÁ
, couÁ * ((*
d
)));

613 
vnum
 = 0; 
nM©ch
 < 
tİ_obj_šdex
; vnum++)

614 ià((
pObjIndex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
vnum
)è!ğ
nuÎ±r
) {

615 cÚ¡ 
afãù
::
Afãù
 *
af
 = 
pObjIndex
->
afãùed
;‡à!ğ
nuÎ±r
;‡àğaf->
Ãxt
)

616 
aff_couÁ
++;

618 
nM©ch
++;

621 
FÜm©
::
	`årštf
(
å
, "ObjProt %4d (%8ld bytes)\n",

622 
tİ_obj_šdex
,İ_obj_šdex * ((*
pObjIndex
)));

624 
couÁ
 = 0;

626 
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt
) {

627 
couÁ
++;

629 cÚ¡ 
afãù
::
Afãù
 *
af
 =‡fãù::
	`li¡_obj
(
obj
);‡à!ğ
nuÎ±r
;‡àğaf->
Ãxt
)

630 
aff_couÁ
++;

633 
FÜm©
::
	`årštf
(
å
, "Objs %4d (%8ld bytes)\n",

634 
couÁ
, couÁ * ((*
obj
)));

636 
FÜm©
::
	`årštf
(
å
, "Affects %4d (%8ld bytes)\n",

637 
aff_couÁ
,‡ff_couÁ * ((
afãù
::
Afãù
)));

639 
FÜm©
::
	`årštf
(
å
, "Rooms %4d (%8ld bytes)\n",

640 
tİ_room
,İ_room * ((*
room
)));

642 
FÜm©
::
	`årštf
(
å
, "Exits %4d (%8ld bytes)\n",

643 
tİ_ex™
,İ_ex™ * ((*
ex™
)));

644 
	`fşo£
(
å
);

646 
å
 = 
	`fİ’
("mob.dmp", "w");

647 
FÜm©
::
	`årštf
(
å
, "\nMobile Analysis\n");

648 
FÜm©
::
	`årštf
(
å
, "---------------\n");

649 
nM©ch
 = 0;

651 
vnum
 = 0; 
nM©ch
 < 
tİ_mob_šdex
; vnum++)

652 ià((
pMobIndex
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
vnum
)è!ğ
nuÎ±r
) {

653 
nM©ch
++;

654 
FÜm©
::
	`årštf
(
å
, "#%-4d %3d‡ctive %3d killed %s\n",

655 
pMobIndex
->
vnum
,…MobIndex->
couÁ
,

656 
pMobIndex
->
kËd
,…MobIndex->
shÜt_desü
);

659 
	`fşo£
(
å
);

661 
å
 = 
	`fİ’
("obj.dmp", "w");

662 
FÜm©
::
	`årštf
(
å
, "\nObject Analysis\n");

663 
FÜm©
::
	`årštf
(
å
, "---------------\n");

664 
nM©ch
 = 0;

666 
vnum
 = 0; 
nM©ch
 < 
tİ_obj_šdex
; vnum++)

667 ià((
pObjIndex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
vnum
)è!ğ
nuÎ±r
) {

668 
nM©ch
++;

669 
FÜm©
::
	`årštf
(
å
, "#%-4d %3d‡ctive %3d„eset %s\n",

670 
pObjIndex
->
vnum
,…ObjIndex->
couÁ
,

671 
pObjIndex
->
»£t_num
,…ObjIndex->
shÜt_desü
);

675 
	`fşo£
(
å
);

676 
	}
}

	@src/wiz_gen.cc

17 
	~<veùÜ
>

19 
	~"aù.hh
"

20 
	~"¬gum’t.hh
"

21 
	~"afãù/Afãù.hh
"

22 
	~"A»a.hh
"

23 
	~"chªÃls.hh
"

24 
	~"Ch¬aù”.hh
"

25 
	~"CÏn.hh
"

26 
	~"DesütÜ.hh
"

27 
	~"ExŒaDesü.hh
"

28 
	~"fšd.hh
"

29 
	~"FÏgs.hh
"

30 
	~"FÜm©.hh
"

31 
	~"Game.hh
"

32 
	~"š‹½.hh
"

33 
	~"lookup.hh
"

34 
	~"Loggšg.hh
"

35 
	~"memÜy.hh
"

36 
	~"m”c.hh
"

37 
	~"MobePrÙÙy³.hh
"

38 
	~"Objeù.hh
"

39 
	~"ObjeùPrÙÙy³.hh
"

40 
	~"PÏy”.hh
"

41 
	~"¿ndom.hh
"

42 
	~"Room.hh
"

43 
	~"sql.hh
"

44 
	~"StÜedPÏy”.hh
"

45 
	~"SŒšg.hh
"

46 
	~"bËs.hh
"

47 
	~"ty³Çme.hh
"

48 
	~"comm.hh
"

49 
	~"cÚn/S‹.hh
"

50 
	~"WÜld.hh
"

53 
boŞ
 
sw—rcheck
 
¬gs
((cÚ¡ 
SŒšg
& 
¬gum’t
));

54 
boŞ
 
check_·r£_Çme
(cÚ¡ 
SŒšg
& 
Çme
);

56 
	$do_adju¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

58 
Ch¬aù”
 *
viùim
;

59 
buf
 [ 
MAX_STRING_LENGTH
 ];

60 
v®ue
;

62 
SŒšg
 
¬g1
, 
¬g2
;

63 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

64 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

66 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.em±y(è|| !¬g2.
	`is_numb”
()) {

67 
	`¡c
("SyÁax: Adju¡ <ch¬> <Exp>.\n", 
ch
);

71 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g1
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

72 
	`¡c
("Th© PÏy” i nÙ h”e.\n", 
ch
);

76 ià(
viùim
->
	`is_Åc
()) {

77 
	`¡c
("NÙ oÀNPC's.\n", 
ch
);

81 ià(
	`IS_IMMORTAL
(
viùim
)) {

82 
	`¡c
("You cª'ˆadju¡ immÜls.\n", 
ch
);

86 
v®ue
 = 
	`©oi
(
¬g2
);

88 ià(
v®ue
 == 0) {

89 
	`¡c
("Thv®umu¡‚Ù bequ®Ø0.\n", 
ch
);

93 
	`gaš_exp
(
viùim
, 
v®ue
);

94 
FÜm©
::
	`¥rštf
(
buf
, "You have‡djustedheƒxp of %s by %dƒxperience…oints.\n",

95 
viùim
->
Çme
, 
v®ue
);

96 
	`¡c
(
buf
, 
ch
);

98 ià(
v®ue
 > 0) {

99 
FÜm©
::
	`¥rštf
(
buf
, "You havb“ÀbÚu£d %dƒx³r›nû…ošts.\n", 
v®ue
);

100 
	`¡c
(
buf
, 
viùim
);

103 
FÜm©
::
	`¥rštf
(
buf
, "You havb“À³Çlized %dƒx³r›nû…ošts.\n", 
v®ue
);

104 
	`¡c
(
buf
, 
viùim
);

108 
	}
}

111 
	$do_®l§ve
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

113 
DesütÜ
 *
d
;

114 
Ch¬aù”
 *
wch
;

115 
	`¡c
("Savšg‡Î…Ïy”s... ", 
ch
);

117 
d
 = 
desütÜ_li¡
; d; d = d->
Ãxt
) {

118 
wch
 = (
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
);

119 
	`§ve_ch¬_obj
(
wch
);

122 
	`¡c
("dÚe.\n", 
ch
);

123 
	}
}

125 
	$do_®‹º©e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

127 
SŒšg
 
qu”y
;

128 
cŞÜs™e
[
MSL
], *
p
, *
q
;

129 
SŒšg
 
ouut
;

130 
sÜ‹d_couÁ
 = 0, 
i
;

131 
	s®ts
 {

132 
Çme
[20];

133 
s™e
[100];

134 
boŞ
 
´š‹d
;

136 
®ts
 
»suÉs_sÜ‹d
[500];

138 
SŒšg
 
¬g1
, 
¬g2
;

139 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

140 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g2
);

142 ià(
¬g1
.
	`em±y
(è|| (¬g1 =ğ"s™e" && 
¬g2
.empty())) {

143 
	`¡c
("Syntax:\n"

146 " {cÓx. *.t¡c.edu, o¸208.238.145.242){x\n", 
ch
);

150 ià(
¬g1
 == "site") {

151 
s™e
[
MSL
];

152 
boŞ
 
´efix
 = 
çl£
, 
suffix
 = false;

153 
	`¡rıy
(
s™e
, 
¬g2
);

154 
p
 = 
s™e
;

162 
qu”y
 = "SELECT‚ame, site, (DATE() -†astlog) FROM sites "

165 ià(*
p
 == '*') {

166 
´efix
 = 
Œue
;

167 
p
++;

170 
q
 = 
p
; * (q + 1); q++);

172 ià(*
q
 == '*') {

173 
suffix
 = 
Œue
;

174 *
q
 = '\0';

177 
FÜm©
::
	`¥rštf
(
cŞÜs™e
, "{Y%s{W", 
p
);

179 ià(
´efix
)

180 
qu”y
 += "\%";

182 
qu”y
 +ğ
p
;

184 ià(
suffix
)

185 
qu”y
 += "\%";

187 
qu”y
 += "' ORDER BY‚ame, (DATE() -†astlog)";

188 
Loggšg
::
	`bug
(
qu”y
, 0);

190 ià(
	`db_qu”y
("do_®‹º©e", 
qu”y
è!ğ
SQL_OK
)

193 
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

194 ià(
sÜ‹d_couÁ
 >= 500) {

195 
Loggšg
::
	`bug
("do_alternate: WARNING: maximum sorted structure size„eached", 0);

201 ià(
sÜ‹d_couÁ
 && 
	`db_g‘_cŞumn_št
(2) >= 10000)

204 
	`¡rıy
(
»suÉs_sÜ‹d
[
sÜ‹d_couÁ
].
Çme
, 
	`db_g‘_cŞumn_¡r
(0));

205 
	`¡rıy
(
»suÉs_sÜ‹d
[
sÜ‹d_couÁ
].
s™e
,

206 
	`SŒšg
(
	`db_g‘_cŞumn_¡r
(1)).
	`»¶aû
(
p
, 
cŞÜs™e
));

207 
sÜ‹d_couÁ
++;

210 ià(
sÜ‹d_couÁ
 == 0) {

211 
	`¡c
("S™nÙ found - maksu» you¸¥ecif›d s™i nÙoØlim™šg.\n", 
ch
);

216 
boŞ
 
Şd_ch¬
 = 
çl£
;

217 
	ss™es
 {

218 
s™e
[100];

219 
ss™e
[100];

221 
s™es
 
s™–i¡
[50];

222 
®ts
 
»suÉs_to_sÜt
[500];

223 
x
, 
to_sÜt_couÁ
 = 0, 
s™ecouÁ
 = 0;

225 ià(
	`db_qu”yf
("do_alternate",

227 "WHERE‚amLIKE '%s' ORDER BY (DATE(è-†a¡log)", 
¬g1
è!ğ
SQL_OK
)

230 
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

231 ià(
s™ecouÁ
 >= 50) {

232 
Loggšg
::
	`bug
("do_alternate: WARNING: maximum site structure size„eached", 0);

237 ià(
	`db_g‘_cŞumn_št
(2) >= 10000) {

238 ià(!
Şd_ch¬
 && 
s™ecouÁ
)

241 
Şd_ch¬
 = 
Œue
;

244 
	`¡rıy
(
s™–i¡
[
s™ecouÁ
].
s™e
, 
	`db_g‘_cŞumn_¡r
(0));

245 
	`¡rıy
(
s™–i¡
[
s™ecouÁ
].
ss™e
, 
	`db_g‘_cŞumn_¡r
(1));

246 
s™ecouÁ
++;

249 ià(
s™ecouÁ
 == 0) {

250 
	`¡c
("PÏy”‚Ù found - maksu»Ø£¬ch byƒxaù‚ame.\n", 
ch
);

254 
i
 = 0; i < 
s™ecouÁ
; i++) {

257 
FÜm©
::
	`¥rštf
(
qu”y
, "SELECT‚ame, site FROM sites WHERE ");

259 ià(!
Şd_ch¬
)

260 
qu”y
 += "lastlog >= DATE('now', '-1 year') AND ";

262 
qu”y
 += "ssite='%s'";

264 ià(
	`db_qu”yf
("do_®‹º©e", 
qu”y
, 
	`db_esc
(
s™–i¡
[
i
].
ss™e
)è!ğ
SQL_OK
)

267 
FÜm©
::
	`¥rštf
(
cŞÜs™e
, "{Y%s{W", 
s™–i¡
[
i
].
ss™e
);

269 
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

270 
SŒšg
 
Çme
 = 
	`db_g‘_cŞumn_¡r
(0);

272 ià(
Çme
 =ğ
¬g1
) {

273 ià(
sÜ‹d_couÁ
 >= 500) {

274 
Loggšg
::
	`bug
("do_alternate: WARNING: maximum sorted structure size„eached", 0);

278 
	`¡rıy
(
»suÉs_sÜ‹d
[
sÜ‹d_couÁ
].
Çme
,‚ame);

279 
	`¡rıy
(
»suÉs_sÜ‹d
[
sÜ‹d_couÁ
].
s™e
,

280 
	`SŒšg
(
	`db_g‘_cŞumn_¡r
(1)).
	`»¶aû
(
s™–i¡
[
i
].
ss™e
, 
cŞÜs™e
));

281 
»suÉs_sÜ‹d
[
sÜ‹d_couÁ
].
´š‹d
 = 
çl£
;

282 
sÜ‹d_couÁ
++;

285 ià(
to_sÜt_couÁ
 >= 500) {

286 
Loggšg
::
	`bug
("do_alternate: WARNING: maximum unsorted structure size„eached", 0);

290 
	`¡rıy
(
»suÉs_to_sÜt
[
to_sÜt_couÁ
].
Çme
,‚ame);

291 
	`¡rıy
(
»suÉs_to_sÜt
[
to_sÜt_couÁ
].
s™e
,

292 
	`SŒšg
(
	`db_g‘_cŞumn_¡r
(1)).
	`»¶aû
(
s™–i¡
[
i
].
ss™e
, 
cŞÜs™e
));

293 
»suÉs_to_sÜt
[
to_sÜt_couÁ
].
´š‹d
 = 
çl£
;

294 
to_sÜt_couÁ
++;

299 
x
 = 'A'; x <= 'Z'; x++) {

301 
cuºame
 = -1;

302 
boŞ
 
Ë‰”m©ch
 = 
çl£
;

304 
i
 = 0; i < 
to_sÜt_couÁ
; i++) {

305 ià(
»suÉs_to_sÜt
[
i
].
´š‹d


306 || 
»suÉs_to_sÜt
[
i
].
Çme
[0] !ğ
x
)

309 ià(
cuºame
 == -1)

310 
cuºame
 = 
i
;

311 ià(
»suÉs_to_sÜt
[
cuºame
].
Çme
 !ğ»suÉs_to_sÜt[
i
].name)

314 
	`¡rıy
(
»suÉs_sÜ‹d
[
sÜ‹d_couÁ
].
Çme
, 
»suÉs_to_sÜt
[
i
].name);

315 
	`¡rıy
(
»suÉs_sÜ‹d
[
sÜ‹d_couÁ
].
s™e
, 
»suÉs_to_sÜt
[
i
].site);

316 
sÜ‹d_couÁ
++;

317 
»suÉs_to_sÜt
[
i
].
´š‹d
 = 
Œue
;

318 
Ë‰”m©ch
 = 
Œue
;

321 ià(!
Ë‰”m©ch
)

327 
ouut
 += "{GMatching characters/sites:{x\n";

328 
ouut
 += "{G=================================================================={x\n";

330 
f¡r
[25];

331 
	`¡rıy
(
f¡r
, "{G[{W%12s%s%54s{G]{x\n");

332 
ouut
 +ğ
FÜm©
::
	`fÜm©
(
f¡r
, 
»suÉs_sÜ‹d
[0].
Çme
, " {G-{W",„esuÉs_sÜ‹d[0].
s™e
);

334 
i
 = 1; i < 
sÜ‹d_couÁ
; i++)

335 
ouut
 +ğ
FÜm©
::
	`fÜm©
(
f¡r
,

336 
»suÉs_sÜ‹d
[
i
].
Çme
 !=„esults_sorted[i - 1].name ?„esults_sorted[i].name : "",

337 
»suÉs_sÜ‹d
[
i
].
Çme
 !=„esults_sorted[i - 1].name ? " {G-{W" : " ",

338 
»suÉs_sÜ‹d
[
i
].
s™e
);

340 
ouut
 += "{G=================================================================={x\n";

341 
	`·ge_to_ch¬
(
ouut
, 
ch
);

342 
	}
}

344 
	$do_©
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

346 
Room
 *
loÿtiÚ
;

347 
Room
 *
Üigš®
;

348 
Objeù
 *
Ú
;

350 
SŒšg
 
¬g
;

351 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

353 ià(
¬g
.
	`em±y
(è|| 
¬gum’t
.empty()) {

354 
	`¡c
("Aˆwh”ªd wh©?\n", 
ch
);

358 ià((
loÿtiÚ
 = 
	`fšd_loÿtiÚ
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

359 
	`¡c
("NØsuch†oÿtiÚ.\n", 
ch
);

363 ià(!
	`is_room_owÃr
(
ch
, 
loÿtiÚ
è&&†oÿtiÚ->
	`is_´iv©e
()

364 && !
	`IS_IMP
(
ch
)) {

365 
	`¡c
("Th©„oom i ´iv©e.\n", 
ch
);

369 
Üigš®
 = 
ch
->
š_room
;

370 
Ú
 = 
ch
->on;

371 
	`ch¬_äom_room
(
ch
);

372 
	`ch¬_to_room
(
ch
, 
loÿtiÚ
);

373 
	`š‹½»t
(
ch
, 
¬gum’t
);

379 ià(
ch
->
	`is_g¬bage
())

382 
	`ch¬_äom_room
(
ch
);

383 
	`ch¬_to_room
(
ch
, 
Üigš®
);

384 
ch
->
Ú
 = on;

385 
	}
}

388 
	$do_check
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

390 
buf
[
MAX_STRING_LENGTH
];

391 
boŞ
 
SHOWIMM
 = 
çl£
;

392 
SŒšg
 
bufãr
;

394 
SŒšg
 
¬g
;

395 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

397 ià(
¬g
 =ğ"gods" || 
¬gum’t
 == "gods")

398 
SHOWIMM
 = 
Œue
;

400 ià(
¬g
.
	`em±y
(è||‡rg.
	`is_´efix_of
("gods")) {

402 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

403 ià(
viùim
->
	`is_Åc
(è|| !
	`ÿn_£e_ch¬
(
ch
, victim))

406 ià(!
SHOWIMM
 && 
	`IS_IMMORTAL
(
viùim
))

409 
FÜm©
::
	`¥rštf
(
buf
, "{W[%12s] Level {C%3d{W connected since %d hours {C(%dotal hours){x\n",

410 
viùim
->
Çme
, viùim->
Ëv–
,

411 (()(
Game
::
cu¼’t_time
 - 
viùim
->
logÚ
)) / 3600,

412 (
	`g‘_¶ay_£cÚds
(
viùim
è+ ()(
Game
::
cu¼’t_time
 - viùim->
logÚ
)) / 3600);

413 
bufãr
 +ğ
buf
;

416 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

420 ià(
¬g
.
	`is_´efix_of
("stats")) {

422 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

423 ià(
viùim
->
	`is_Åc
(è|| !
	`ÿn_£e_ch¬
(
ch
, victim))

426 ià(!
SHOWIMM
 && 
	`IS_IMMORTAL
(
viùim
))

429 
FÜm©
::
	`¥rštf
(
buf
,

431 
viùim
->
Çme
,

432 
	`GET_MAX_HIT
(
viùim
), 
	`GET_MAX_MANA
(viùim), 
	`ATTR_BASE
(viùim, 
APPLY_STR
),

433 
	`ATTR_BASE
(
viùim
, 
APPLY_INT
), ATTR_BASE(viùim, 
APPLY_WIS
),

434 
	`ATTR_BASE
(
viùim
, 
APPLY_DEX
), ATTR_BASE(viùim, 
APPLY_CON
),

435 
	`ATTR_BASE
(
viùim
, 
APPLY_CHR
),

436 
viùim
->
gŞd
 + viùim->
sv”
 / 100,

437 
viùim
->
pcd©a
->
que¡pošts
,

438 !
viùim
->
	`is_Åc
(è? viùim->
pcd©a
->
skÍošts
 : 0);

439 
bufãr
 +ğ
buf
;

442 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

446 ià(
¬g
.
	`is_´efix_of
("eq")) {

448 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

449 ià(
viùim
->
	`is_Åc
()

450 || !
	`ÿn_£e_ch¬
(
ch
, 
viùim
))

453 ià(!
SHOWIMM
 && 
	`IS_IMMORTAL
(
viùim
))

456 
FÜm©
::
	`¥rštf
(
buf
,

458 
viùim
->
Çme
, 
	`g‘_ÿ¼y_numb”
(viùim), 
	`g‘_ÿ¼y_weight
(victim),

459 
	`GET_ATTR_HITROLL
(
viùim
), 
	`GET_ATTR_DAMROLL
(viùim), 
	`GET_ATTR_SAVES
(victim),

460 
	`GET_AC
(
viùim
, 
AC_PIERCE
), GET_AC(viùim, 
AC_BASH
),

461 
	`GET_AC
(
viùim
, 
AC_SLASH
), GET_AC(viùim, 
AC_EXOTIC
));

462 
bufãr
 +ğ
buf
;

465 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

469 ià(
¬g
.
	`is_´efix_of
("absorb")) {

471 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

472 ià(
viùim
->
	`is_Åc
(è|| !
	`ÿn_£e_ch¬
(
ch
, victim))

475 ià(!
SHOWIMM
 && 
	`IS_IMMORTAL
(
viùim
))

478 
FÜm©
::
	`¥rštf
(
buf
,

480 
viùim
->
Çme
, 
	`´št_deãn£_modif›rs
(viùim, 
TO_ABSORB
));

481 
bufãr
 +ğ
buf
;

484 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

488 ià(
¬g
.
	`is_´efix_of
("immune")) {

490 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

491 ià(
viùim
->
	`is_Åc
(è|| !
	`ÿn_£e_ch¬
(
ch
, victim))

494 ià(!
SHOWIMM
 && 
	`IS_IMMORTAL
(
viùim
))

497 
FÜm©
::
	`¥rštf
(
buf
,

499 
viùim
->
Çme
,

500 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_IMMUNE
));

501 
bufãr
 +ğ
buf
;

504 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

508 ià(
¬g
.
	`is_´efix_of
("resistance")) {

510 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

511 ià(
viùim
->
	`is_Åc
(è|| !
	`ÿn_£e_ch¬
(
ch
, victim))

514 ià(!
SHOWIMM
 && 
	`IS_IMMORTAL
(
viùim
))

517 
FÜm©
::
	`¥rštf
(
buf
,

519 
viùim
->
Çme
,

520 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_RESIST
));

521 
bufãr
 +ğ
buf
;

524 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

528 ià(
¬g
.
	`is_´efix_of
("vulnerable")) {

530 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

531 ià(
viùim
->
	`is_Åc
(è|| !
	`ÿn_£e_ch¬
(
ch
, victim))

534 ià(!
SHOWIMM
 && 
	`IS_IMMORTAL
(
viùim
))

537 
FÜm©
::
	`¥rštf
(
buf
,

539 
viùim
->
Çme
,

540 
	`´št_deãn£_modif›rs
(
viùim
, 
TO_VULN
));

541 
bufãr
 +ğ
buf
;

544 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

548 ià(
¬g
.
	`is_´efix_of
("snoop")) {

549 ià(!
	`IS_IMP
(
ch
)) {

550 
	`¡c
("You cª'ˆu£hi check o±iÚ.\n", 
ch
);

554 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

555 ià(
viùim
->
	`is_Åc
()

556 || 
viùim
->
desc
 =ğ
nuÎ±r


557 || !
viùim
->
desc
->
	`is_¶ayšg
())

560 ià(!
SHOWIMM
 && 
	`IS_IMMORTAL
(
viùim
))

563 
FÜm©
::
	`¥rštf
(
buf
, "{W[%12s] i bešg snoİed by {G%s\n", 
viùim
->
Çme
,

564 (
viùim
->
desc
->
¢oİ_by
 !ğ
nuÎ±r
è? viùim->desc->¢oİ_by->
ch¬aù”
->
Çme
 : "nobody");

565 
bufãr
 +ğ
buf
;

568 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

572 
	`¡c
("Th© i nÙ‡ v®id o±iÚ.\n", 
ch
);

574 
	}
}

576 
	$do_chown
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

578 
Ch¬aù”
 *
viùim
;

579 
Objeù
 *
obj
;

581 
SŒšg
 
¬g1
, 
¬g2
;

582 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

583 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

585 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.empty()) {

586 
	`¡c
("G‘ wh© from whom?\n", 
ch
);

590 ià((
viùim
 = 
	`g‘_ch¬_h”e
(
ch
, 
¬g2
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

591 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

595 ià(!
	`OUTRANKS
(
ch
, 
viùim
)) {

596 
	`¡c
("I dÚ'ˆthškhey'd†ikth©oØmuch.\n", 
ch
);

601 ià((
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬g1
, 
viùim
->
ÿ¼yšg
)è=ğ
nuÎ±r
) {

602 
	`¡c
("They dØnÙ havth© i‹m.\n", 
ch
);

606 
	`obj_äom_ch¬
(
obj
);

607 
	`obj_to_ch¬
(
obj
, 
ch
);

608 
	`aù
("$Àmake ¨magiÿÈge¡u»‡nd $°æ› äom $NØ$n.", 
ch
, 
obj
, 
viùim
, 
TO_NOTVICT
);

609 
	`aù
("$Àmake ¨magiÿÈge¡u»‡nd $°æ› äom you¸bodyØ$s.", 
ch
, 
obj
, 
viùim
, 
TO_VICT
);

610 
	`aù
("$°æ› äom $NØyou.", 
ch
, 
obj
, 
viùim
, 
TO_CHAR
);

611 
	}
}

614 
	$»cursive_şÚe
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, Objeù *
şÚe
)

616 
Objeù
 *
c_obj
, *
t_obj
;

618 
c_obj
 = 
obj
->
cÚšs
; c_obj !ğ
nuÎ±r
; c_obj = c_obj->
Ãxt_cÚ‹Á
) {

619 
t_obj
 = 
	`ü—‹_objeù
(
c_obj
->
pIndexD©a
, 0);

621 ià(! 
t_obj
) {

622 
Loggšg
::
	`bug
("Error creating object in„ecursive_clone.", 0);

626 
	`şÚe_objeù
(
c_obj
, 
t_obj
);

627 
	`obj_to_obj
(
t_obj
, 
şÚe
);

628 
	`»cursive_şÚe
(
ch
, 
c_obj
, 
t_obj
);

630 
	}
}

633 
	$do_şÚe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

635 cÚ¡ *
»¡
;

636 
Ch¬aù”
 *
mob
;

637 
Objeù
 *
obj
;

638 
j
;

639 
numb”
;

641 
SŒšg
 
¬g
, 
which
;

642 
»¡
 = 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

644 ià(
¬g
.
	`em±y
()) {

645 
	`¡c
("ClÚwh©?\n", 
ch
);

649 ià(
¬g
.
	`is_´efix_of
("object")) {

650 
numb”
 = 
	`muÉ_¬gum’t
(
»¡
, 
which
);

651 
mob
 = 
nuÎ±r
;

652 
obj
 = 
	`g‘_obj_h”e
(
ch
, 
which
);

654 ià(
obj
 =ğ
nuÎ±r
) {

655 
	`¡c
("You dÚ'ˆ£th© h”e.\n", 
ch
);

659 ià(
¬g
.
	`is_´efix_of
("mobile") ||‡rg.is_prefix_of("character")) {

660 
numb”
 = 
	`muÉ_¬gum’t
(
»¡
, 
which
);

661 
obj
 = 
nuÎ±r
;

662 
mob
 = 
	`g‘_ch¬_h”e
(
ch
, 
which
, 
VIS_CHAR
);

664 ià(
mob
 =ğ
nuÎ±r
) {

665 
	`¡c
("You dÚ'ˆ£th© h”e.\n", 
ch
);

670 
numb”
 = 
	`muÉ_¬gum’t
(
¬gum’t
, 
which
);

671 
mob
 = 
	`g‘_ch¬_h”e
(
ch
, 
which
, 
VIS_CHAR
);

672 
obj
 = 
	`g‘_obj_h”e
(
ch
, 
which
);

674 ià(
mob
 =ğ
nuÎ±r
 && 
obj
 ==‚ullptr) {

675 
	`¡c
("You dÚ'ˆ£th© h”e.\n", 
ch
);

680 ià(
numb”
 < 1) {

681 
	`¡c
("Nowh©' ¨sly‚umb”ØwªˆtØşÚe.\n", 
ch
);

685 ià(
numb”
 > 99) {

686 
	`¡c
("SÜry, you cª'ˆşÚth© mªy.\n", 
ch
);

691 ià(
obj
 !ğ
nuÎ±r
) {

692 
Objeù
 *
şÚe
 = 
nuÎ±r
;

694 
j
 = 1; j <ğ
numb”
; j++) {

695 
şÚe
 = 
	`ü—‹_objeù
(
obj
->
pIndexD©a
, 0);

697 ià(! 
şÚe
) {

698 
Loggšg
::
	`bug
("Error creating object in do_clone", 0);

702 
	`şÚe_objeù
(
obj
, 
şÚe
);

704 ià(
obj
->
ÿ¼›d_by
 !ğ
nuÎ±r
)

705 
	`obj_to_ch¬
(
şÚe
, 
ch
);

707 
	`obj_to_room
(
şÚe
, 
ch
->
š_room
);

709 
	`»cursive_şÚe
(
ch
, 
obj
, 
şÚe
);

712 ià(
numb”
 == 1) {

713 
	`aù
("$ÀşÚe $p.", 
ch
, 
şÚe
, 
nuÎ±r
, 
TO_ROOM
);

714 
	`aù
("You clÚ$p.", 
ch
, 
şÚe
, 
nuÎ±r
, 
TO_CHAR
);

715 
	`wizÃt
("$N ha şÚed: $p.", 
ch
, 
şÚe
, 
WIZ_LOAD
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

718 
FÜm©
::
	`¥rštf
(
¬g
, "$ÀşÚe $p[%d].", 
numb”
);

719 
	`aù
(
¬g
, 
ch
, 
şÚe
, 
nuÎ±r
, 
TO_ROOM
);

720 
FÜm©
::
	`¥rštf
(
¬g
, "You clÚ$p[%d].", 
numb”
);

721 
	`aù
(
¬g
, 
ch
, 
şÚe
, 
nuÎ±r
, 
TO_CHAR
);

722 
FÜm©
::
	`¥rštf
(
¬g
, "$N ha şÚed: $p[%d].", 
numb”
);

723 
	`wizÃt
(
¬g
, 
ch
, 
şÚe
, 
WIZ_LOAD
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

728 ià(
mob
 !ğ
nuÎ±r
) {

729 
Ch¬aù”
 *
şÚe
;

730 
Objeù
 *
Ãw_obj
;

731 
buf
[
MAX_STRING_LENGTH
];

733 ià(!
mob
->
	`is_Åc
()) {

734 
	`¡c
("You cª oÆy clÚmobes.\n", 
ch
);

738 
şÚe
 = 
	`ü—‹_mobe
(
mob
->
pIndexD©a
);

741 ià(! 
şÚe
) {

742 
Loggšg
::
	`bug
("Memoryƒrror in do_clone().", 0);

743 
	`¡c
("E¼Ü whşÚšg mob.\n", 
ch
);

747 
	`şÚe_mobe
(
mob
, 
şÚe
);

749 
obj
 = 
mob
->
ÿ¼yšg
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt_cÚ‹Á
) {

750 
Ãw_obj
 = 
	`ü—‹_objeù
(
obj
->
pIndexD©a
, 0);

752 ià(! 
Ãw_obj
) {

753 
Loggšg
::
	`bug
("Error creating object in do_clone", 0);

757 
	`şÚe_objeù
(
obj
, 
Ãw_obj
);

758 
	`»cursive_şÚe
(
ch
, 
obj
, 
Ãw_obj
);

759 
	`obj_to_ch¬
(
Ãw_obj
, 
şÚe
);

760 
Ãw_obj
->
w—r_loc
 = 
obj
->wear_loc;

763 
	`ch¬_to_room
(
şÚe
, 
ch
->
š_room
);

764 
	`aù
("$ÀşÚe $N.", 
ch
, 
nuÎ±r
, 
şÚe
, 
TO_ROOM
);

765 
	`aù
("You clÚ$N.", 
ch
, 
nuÎ±r
, 
şÚe
, 
TO_CHAR
);

766 
FÜm©
::
	`¥rštf
(
buf
, "$N ha şÚed: %s.", 
şÚe
->
shÜt_desü
);

767 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_LOAD
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

770 
	}
}

773 
	$do_oşÚe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

775 
buf
[
MAX_STRING_LENGTH
];

776 
Ch¬aù”
 *
viùim
;

777 
Objeù
 *
obj
;

779 
SŒšg
 
¬g1
, 
¬g2
;

780 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

781 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

783 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.empty()) {

784 
	`¡c
("SyÁax: oşÚ<objeù> <³rsÚ whØha objeù>\n", 
ch
);

788 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g2
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

789 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

794 ià((
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬g1
, 
viùim
->
ÿ¼yšg
)è=ğ
nuÎ±r
) {

795 
FÜm©
::
	`¥rštf
(
buf
, "% dÛ¢'ˆ£emØhav¨%s.\n", 
viùim
->
Çme
, 
¬g1
);

796 
	`¡c
(
buf
, 
ch
);

801 ià(
obj
 !ğ
nuÎ±r
) {

802 
Objeù
 *
şÚe
;

803 
şÚe
 = 
	`ü—‹_objeù
(
obj
->
pIndexD©a
, 0);

805 ià(! 
şÚe
) {

806 
Loggšg
::
	`bug
("Error cloning‡n object.", 0);

810 
	`şÚe_objeù
(
obj
, 
şÚe
);

812 ià(
obj
->
ÿ¼›d_by
 !ğ
nuÎ±r
)

813 
	`obj_to_ch¬
(
şÚe
, 
ch
);

815 
	`obj_to_room
(
şÚe
, 
ch
->
š_room
);

817 
	`»cursive_şÚe
(
ch
, 
obj
, 
şÚe
);

818 
	`aù
("$Àha şÚedh$°$N has.", 
ch
, 
şÚe
, 
viùim
, 
TO_NOTVICT
);

819 
	`aù
("$Àha ü—‹d‡ cİy oàyou¸$p.", 
ch
, 
şÚe
, 
viùim
, 
TO_VICT
);

820 
	`aù
("You clÚ¨cİy oàth$°$N has.", 
ch
, 
şÚe
, 
viùim
, 
TO_CHAR
);

823 
	}
}

825 
	$do_d•¬‹dli¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

827 
SŒšg
 
¬g
;

828 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

830 ià(
¬g
.
	`em±y
(è|| 
¬gum’t
.empty()) {

831 
	`¡c
("Syntax:\n"

833 " d•¬‹dli¡„emov<immÜl>\n", 
ch
);

837 ià(
¬g
 == "add") {

838 ià(
	`has_d•¬‹d
(
¬gum’t
)) {

839 
	`±c
(
ch
, "'%s'‡Ì—dy d•¬‹d Legacy!\n", 
¬gum’t
);

843 
	`š£¹_d•¬‹d
(
¬gum’t
);

844 
	`§ve_d•¬‹d_li¡
();

845 
	`±c
(
ch
, "'%s' wa sucûssfuÎy‡dded‡ ¨d•¬‹d immÜl.\n", 
¬gum’t
);

849 ià(
¬g
 == "remove") {

850 ià(!
	`has_d•¬‹d
(
¬gum’t
)) {

851 
	`±c
(
ch
, "BuˆnØÚÇmed '%s'ƒv” d•¬‹d!\n", 
¬gum’t
);

855 
	`»move_d•¬‹d
(
¬gum’t
);

856 
	`§ve_d•¬‹d_li¡
();

857 
	`±c
(
ch
, "'%s' wa sucûssfuÎy„emoved‡ ¨d•¬‹d immÜl.\n", 
¬gum’t
);

860 
	}
}

862 
	$do_Ëad”
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

864 
Ch¬aù”
 *
viùim
;

869 
SŒšg
 
¬g
;

870 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

872 ià(
¬g
.
	`em±y
()) {

873 
	`¡c
("Whom dØyou wishØmak¨şª†—d”?\n", 
ch
);

877 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

878 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

882 ià(
viùim
->
şª
 =ğ
nuÎ±r
 && !
	`IS_IMMORTAL
(victim)) {

883 
	`¡c
("They'»‚Ù iÀ¨şª.\n", 
ch
);

887 ià(!
	`IS_IMMORTAL
(
viùim
è&& viùim->
şª
->
šd•’d’t
) {

888 
	`¡c
("Theœ cÏÀÿÂÙ havËad”s.\n", 
ch
);

892 ià(
	`IS_IMMORTAL
(
viùim
)) {

893 ià(!
	`IS_IMP
(
ch
)) {

894 
	`¡c
("OÆy im¶em’tÜ may‡µošˆÙh” im¶em’tÜs.\n", 
ch
);

898 ià(
viùim
->
	`has_cgroup
(
GROUP_LEADER
)) {

899 
viùim
->
	`»move_cgroup
(
GROUP_LEADER
);

900 
	`¡c
("You‡»‚ØlÚg”‡Àim¶em’tÜ.\n", 
viùim
);

901 
	`¡c
("L—d” fÏg„emoved.\n", 
ch
);

904 ià(
viùim
->
	`has_cgroup
(
GROUP_DEPUTY
)) {

905 
viùim
->
	`»move_cgroup
(
GROUP_DEPUTY
);

906 
	`¡c
("You havb“À´omÙedØim¶em’tÜ.\n", 
viùim
);

907 
	`¡c
("D•uty fÏg„emoved.\n", 
ch
);

910 
	`¡c
("You‡»‚ow‡Àim¶em’tÜ.\n", 
viùim
);

912 
viùim
->
	`add_cgroup
(
GROUP_LEADER
);

913 
	`¡c
("L—d” fÏg‡dded.\n", 
ch
);

932 ià(
viùim
->
	`has_cgroup
(
GROUP_LEADER
)) {

933 
viùim
->
	`»move_cgroup
(
GROUP_LEADER
);

934 
	`¡c
("You‡»‚ØlÚg”‡ cÏÀËad”.\n", 
viùim
);

935 
	`¡c
("L—d” fÏg„emoved.\n", 
ch
);

938 ià(
viùim
->
	`has_cgroup
(
GROUP_DEPUTY
)) {

939 
viùim
->
	`»move_cgroup
(
GROUP_DEPUTY
);

940 
	`¡c
("You havb“À´omÙedØşª†—d”.\n", 
viùim
);

941 
	`¡c
("D•uty fÏg„emoved.\n", 
ch
);

944 
	`¡c
("You‡»‚ow‡ cÏÀËad”.\n", 
viùim
);

946 
viùim
->
	`add_cgroup
(
GROUP_LEADER
);

947 
	`¡c
("L—d” fÏg‡dded.\n", 
ch
);

949 
	}
}

951 
	$do_d•utize
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

953 
Ch¬aù”
 *
viùim
;

954 
couÁ
 = 0, 
d•couÁ
 = 0;

956 
SŒšg
 
¬g
;

957 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

959 ià(
¬g
.
	`em±y
()) {

960 
	`¡c
("Whom dØyou wishØmak¨şª d•uty?\n", 
ch
);

964 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

965 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

969 ià(
viùim
->
şª
 =ğ
nuÎ±r
 && !
	`IS_IMMORTAL
(victim)) {

970 
	`¡c
("They'»‚Ù iÀ¨şª.\n", 
ch
);

974 ià(!
	`IS_IMMORTAL
(
viùim
è&& viùim->
şª
->
šd•’d’t
) {

975 
	`¡c
("Theœ cÏÀÿÂÙ havd•ut›s.\n", 
ch
);

979 ià(
	`IS_IMMORTAL
(
viùim
)) {

980 ià(!
	`IS_IMP
(
ch
)) {

981 
	`¡c
("OÆy im¶em’tÜ may‡µošˆh—d oàd•¬tm’ts.\n", 
ch
);

985 ià(
viùim
->
	`has_cgroup
(
GROUP_DEPUTY
)) {

986 
viùim
->
	`»move_cgroup
(
GROUP_DEPUTY
);

987 
	`¡c
("You‡»‚ØlÚg”‡ h—d oàyou¸d•¬tm’t.\n", 
viùim
);

988 
	`¡c
("D•uty fÏg„emoved.\n", 
ch
);

991 ià(
viùim
->
	`has_cgroup
(
GROUP_LEADER
)) {

992 
viùim
->
	`»move_cgroup
(
GROUP_LEADER
);

993 
	`¡c
("You havb“ÀdemÙedØd•¬tm’ˆh—d.\n", 
viùim
);

994 
	`¡c
("L—d” fÏg„emoved.\n", 
ch
);

997 
	`¡c
("You‡»‚ow‡ h—d oàyou¸d•¬tm’t.\n", 
viùim
);

999 
viùim
->
	`add_cgroup
(
GROUP_DEPUTY
);

1000 
	`¡c
("D•uty fÏg‡dded.\n", 
ch
);

1006 
couÁ
 = 
	`couÁ_şª_memb”s
(
viùim
->
şª
, 0);

1007 
d•couÁ
 = 
	`couÁ_şª_memb”s
(
viùim
->
şª
, 
GROUP_DEPUTY
);

1009 ià(
d•couÁ
 >ğ5 || d•couÁ > 
couÁ
 / 5) {

1010 
	`¡c
("Th© cÏÀÿÂÙ havªy mÜd•ut›s.\n", 
ch
);

1014 ià(
viùim
->
	`has_cgroup
(
GROUP_DEPUTY
)) {

1015 
viùim
->
	`»move_cgroup
(
GROUP_DEPUTY
);

1016 
	`¡c
("You‡»‚ØlÚg”‡ cÏÀd•uty.\n", 
viùim
);

1017 
	`¡c
("D•uty fÏg„emoved.\n", 
ch
);

1020 ià(
viùim
->
	`has_cgroup
(
GROUP_LEADER
)) {

1021 
viùim
->
	`»move_cgroup
(
GROUP_LEADER
);

1022 
	`¡c
("You havb“ÀdemÙedØşª d•uty.\n", 
viùim
);

1023 
	`¡c
("L—d” fÏg„emoved.\n", 
ch
);

1026 
	`¡c
("You‡»‚ow‡ cÏÀd•uty.\n", 
viùim
);

1028 
viùim
->
	`add_cgroup
(
GROUP_DEPUTY
);

1029 
	`¡c
("D•uty fÏg‡dded.\n", 
ch
);

1031 
	}
}

1033 
	$do_de¥–l
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1035 
Objeù
 *
obj
;

1037 
SŒšg
 
¬g
;

1038 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1040 ià(
¬g
.
	`em±y
()) {

1041 
	`¡c
("SyÁax: \n", 
ch
);

1042 
	`¡c
("de¥–È<objeù‚ame>\n", 
ch
);

1046 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g
)è=ğ
nuÎ±r
) {

1047 
	`¡c
("NØsuch i‹m.\n", 
ch
);

1051 
	`¡c
("I‹m cË¬ed oà®È¥–ls.\n", 
ch
);

1053 
	}
}

1055 
	$do_discÚÃù
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1057 
DesütÜ
 *
d
;

1058 
desc
;

1059 
buf
[
MAX_INPUT_LENGTH
];

1061 ià(
¬gum’t
.
	`em±y
()) {

1062 
	`¡c
("Disconnect which socket? (type SOCKETS for†ist)\n",

1063 
ch
);

1067 
SŒšg
 
¬g
;

1068 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1070 ià(!
¬g
.
	`is_numb”
()) {

1071 
	`¡c
("Sock‘ mu¡ bnum”ic!\n", 
ch
);

1075 ià(
¬g
.
	`em±y
()) {

1076 
	`¡c
("DiscÚÃù whom?\n", 
ch
);

1080 
desc
 = 
	`©oi
(
¬g
);

1082 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

1083 ià(
d
->
desütÜ
 =ğ
desc
) {

1084 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
¶ayšg
) {

1085 
FÜm©
::
	`¥rštf
(
buf
,

1087 
d
->
Üigš®
 ? d->Üigš®->
Çme
 : d->
ch¬aù”
->name);

1088 
	`¡c
(
buf
, 
ch
);

1092 
	`şo£_sock‘
(
d
);

1093 
	`¡c
("Thch¬aù” ha b“ÀdiscÚÃùed.\n", 
ch
);

1098 
FÜm©
::
	`¥rštf
(
buf
,

1100 
desc
);

1101 
	`¡c
(
buf
, 
ch
);

1102 
	}
}

1106 
	$do_dßs
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1108 
Ch¬aù”
 *
viùim
;

1109 
DesütÜ
 *
Üig
;

1111 
SŒšg
 
¬g
;

1112 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1114 ià(
¬g
.
	`em±y
(è|| 
¬gum’t
.empty()) {

1115 
	`¡c
("SyÁax: dß <viùim> <commªd>\n", 
ch
);

1119 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

1120 
	`¡c
("You couldn'ˆfšdhem.\n", 
ch
);

1124 ià(
viùim
 =ğ
ch
) {

1125 
	`¡c
("You'»oØÏzyØmakyour£làdØsom‘hšg.\n", 
ch
);

1129 ià(
¬gum’t
.
	`is_´efix_of
("quit") ||‡rgument.is_prefix_of("delete") ||‡rgument.is_prefix_of("switch")) {

1130 
	`¡c
("DÚ'ˆdØth©.\n", 
ch
);

1134 
Üig
 = 
viùim
->
desc
;

1135 
viùim
->
desc
 = 
ch
->desc;

1136 
	`š‹½»t
(
viùim
, 
¬gum’t
);

1138 ià(!
viùim
->
	`is_g¬bage
())

1139 
viùim
->
desc
 = 
Üig
;

1140 
	}
}

1142 
	$do_echo
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1144 
DesütÜ
 *
d
;

1146 ià(
¬gum’t
.
	`em±y
()) {

1147 
	`¡c
("Glob®ƒchØwh©?\n", 
ch
);

1151 ià(
	`sw—rcheck
(
¬gum’t
)) {

1152 
	`±c
(
ch
, "Thou sh®ˆnÙ sw—¸Ú gecho, %s.\n", ch->
Çme
);

1156 
d
 = 
desütÜ_li¡
; d; d = d->
Ãxt
) {

1157 ià(
d
->
	`is_¶ayšg
()) {

1158 ià(
	`IS_IMMORTAL
(
d
->
ch¬aù”
))

1159 
	`¡c
("glob®> ", 
d
->
ch¬aù”
);

1161 
	`¡c
(
¬gum’t
, 
d
->
ch¬aù”
);

1162 
	`¡c
("\n", 
d
->
ch¬aù”
);

1165 
	}
}

1167 
	$do_»cho
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1169 
DesütÜ
 *
d
;

1171 ià(
¬gum’t
.
	`em±y
()) {

1172 
	`¡c
("LoÿÈechØwh©?\n", 
ch
);

1176 
d
 = 
desütÜ_li¡
; d; d = d->
Ãxt
) {

1177 ià(
d
->
	`is_¶ayšg
()

1178 && 
d
->
ch¬aù”
->
š_room
 =ğ
ch
->in_room) {

1179 ià(
	`IS_IMMORTAL
(
d
->
ch¬aù”
))

1180 
	`¡c
("loÿl> ", 
d
->
ch¬aù”
);

1182 
	`¡c
(
¬gum’t
, 
d
->
ch¬aù”
);

1183 
	`¡c
("\n", 
d
->
ch¬aù”
);

1188 
	}
}

1190 
	$do_zecho
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1192 
DesütÜ
 *
d
;

1194 ià(
¬gum’t
.
	`em±y
()) {

1195 
	`¡c
("ZÚechØwh©?\n", 
ch
);

1199 
d
 = 
desütÜ_li¡
; d; d = d->
Ãxt
) {

1200 ià(
d
->
	`is_¶ayšg
()

1201 && 
d
->
ch¬aù”
->
š_room
 !ğ
nuÎ±r
 && 
ch
->in_room !=‚ullptr

1202 && 
d
->
ch¬aù”
->
š_room
->
	`¬—
(è=ğ
ch
->in_room->area()) {

1203 ià(
	`IS_IMMORTAL
(
d
->
ch¬aù”
))

1204 
	`¡c
("zÚe> ", 
d
->
ch¬aù”
);

1206 
	`¡c
(
¬gum’t
, 
d
->
ch¬aù”
);

1207 
	`¡c
("\n", 
d
->
ch¬aù”
);

1210 
	}
}

1212 
	$do_³cho
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1214 
Ch¬aù”
 *
viùim
;

1216 
SŒšg
 
¬g
;

1217 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

1219 ià(
¬gum’t
.
	`em±y
(è|| 
¬g
.empty()) {

1220 
	`¡c
("P”sÚ®ƒchØwh©?\n", 
ch
);

1224 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

1225 
	`¡c
("SÜry,hrg‘ wa nÙ found.\n", 
ch
);

1229 ià(
	`IS_IMMORTAL
(
viùim
è&& !
	`IS_IMP
(
ch
))

1230 
	`¡c
("³rsÚ®> ", 
viùim
);

1232 
	`¡c
(
¬gum’t
, 
viùim
);

1233 
	`¡c
("\n", 
viùim
);

1234 
	`¡c
("³rsÚ®> ", 
ch
);

1235 
	`¡c
(
¬gum’t
, 
ch
);

1236 
	`¡c
("\n", 
ch
);

1237 
	}
}

1240 
	$do_fe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1242 
FILE
 *
»q_fe
;

1243 
num_lšes
 = 0, 
»q_lšes
 = 0, 
cur_lše
 = 0, 
i
;

1244 
buf
[
MSL
], 
¡r§ve
[50];

1245 
SŒšg
 
bufãr
;

1246 
	sfe_¡ruù
 {

1247 *
cmd
;

1248 *
fe
;

1250 
f›lds
[] = {

1263 { 
nuÎ±r
,‚ullptr }

1266 
SŒšg
 
f›ld
, 
v®ue
;

1267 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
f›ld
);

1268 
	`Úe_¬gum’t
(
¬gum’t
, 
v®ue
);

1270 ià(
f›ld
.
	`em±y
()) {

1271 
	`¡c
("Accessible files:\n\n"

1272 "Name: P©h:\n", 
ch
);

1274 
i
 = 0; 
f›lds
[i].
cmd
; i++)

1275 
	`±c
(
ch
, "%-14s[%s%-14s]\n", 
f›lds
[
i
].
cmd
, 
MISC_DIR
, f›lds[i].
fe
);

1277 
	`¡c
("\nSyntax:\n"

1278 " {Rfe{x <Çme> <lšes>\n", 
ch
);

1282 
i
 = 0; 
f›lds
[i].
cmd
; i++)

1283 ià(
f›ld
.
	`is_´efix_of
(
f›lds
[
i
].
cmd
))

1286 ià(!
f›lds
[
i
].
cmd
) {

1287 
	`¡c
("Inv®id fÇme.\n", 
ch
);

1291 ià(
v®ue
.
	`em±y
())

1292 
»q_lšes
 = 150;

1294 
»q_lšes
 = 
	`URANGE
(1, 
	`©oi
(
v®ue
), 150);

1296 
FÜm©
::
	`¥rštf
(
¡r§ve
, "%s%s", 
MISC_DIR
, 
f›lds
[
i
].
fe
);

1298 ià((
»q_fe
 = 
	`fİ’
(
¡r§ve
, "r")è=ğ
nuÎ±r
) {

1299 
	`¡c
("Th© fdÛ nÙƒxi¡.\n", 
ch
);

1304 
	`fg‘s
(
buf
, 
MIL
, 
»q_fe
è!ğ
nuÎ±r
)

1305 
num_lšes
++;

1307 
	`fşo£
(
»q_fe
);

1310 ià(
»q_lšes
 > 
num_lšes
)

1311 
»q_lšes
 = 
num_lšes
;

1313 ià(
num_lšes
 <= 0) {

1314 
	`¡c
("Th© fi em±y.\n", 
ch
);

1318 ià((
»q_fe
 = 
	`fİ’
(
¡r§ve
, "r")è=ğ
nuÎ±r
) {

1319 
Loggšg
::
	`bug
("do_file: file does‚otƒxist on second‡ttempt", 0);

1320 
	`¡c
("Th© fdÛ nÙƒxi¡.\n", 
ch
);

1326 
	`fg‘s
(
buf
, 
MIL
, 
»q_fe
è!ğ
nuÎ±r
)

1327 ià(++
cur_lše
 > (
num_lšes
 - 
»q_lšes
))

1328 
bufãr
 +ğ
buf
;

1330 
	`fşo£
(
»q_fe
);

1331 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

1332 
	}
}

1334 
	$do_fŞlow”li¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1336 
SŒšg
 
qu”y
, 
de™y
;

1338 ià(
¬gum’t
.
	`em±y
())

1339 
de™y
 = 
ch
->
Çme
;

1341 
	`Úe_¬gum’t
(
¬gum’t
, 
de™y
);

1343 
qu”y
 = "SELECT‚ame, deity FROM…c_index WHERE deity_nocol LIKE '";

1344 
qu”y
 += "%";

1345 
qu”y
 +ğ
de™y
;

1346 
qu”y
 += "%'";

1348 ià(
	`db_qu”y
("do_fŞlow”li¡", 
qu”y
è!ğ
SQL_OK
)

1351 
SŒšg
 
bufãr
;

1352 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("{GFŞlow” oà%s{G:{x\n", 
de™y
);

1353 
bufãr
 += "{G=================================================================={x\n";

1355 
couÁ
 = 0;

1356 
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

1357 
couÁ
++;

1358 
¥aû
 = 50 - 
	`SŒšg
(
	`db_g‘_cŞumn_¡r
(1)).
	`uncŞÜ
().
	`size
();

1359 
SŒšg
 
de™yblock
 = "{W";

1361 
¥aû
-- >= 0)

1362 
de™yblock
 += " ";

1364 
de™yblock
 +ğ
	`db_g‘_cŞumn_¡r
(1);

1365 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("{G[{W%12s{G][%s{G]{x\n", 
	`db_g‘_cŞumn_¡r
(0), 
de™yblock
);

1368 ià(
couÁ
 == 0)

1369 
	`±c
(
ch
, "NØÚfŞlow %s.\n", 
de™y
);

1371 
bufãr
 += "{G=================================================================={x\n";

1372 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("{WThere %s %d follower%s of %s{x.\n",

1373 
couÁ
 =ğ1 ? "is" : "¬e", couÁ, couÁ =ğ1 ? "" : "s", 
de™y
);

1374 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

1377 
	}
}

1383 cÚ¡ 
SŒšg
 
	$Çme_ex·nd
(
Ch¬aù”
 *
ch
)

1385 
couÁ
 = 1;

1386 
Ch¬aù”
 *
rch
;

1388 ià(!
ch
->
	`is_Åc
())

1389  
ch
->
Çme
;

1391 
SŒšg
 
Çme
;

1392 
	`Úe_¬gum’t
(
ch
->
Çme
,‚ame);

1394 ià(
Çme
.
	`em±y
()) {

1395  
Çme
;

1398 
rch
 = 
ch
->
š_room
->
³İË
;„ch && (rch !ğch);„ch =„ch->
Ãxt_š_room
)

1399 ià(
rch
->
Çme
.
	`has_wÜds
(name))

1400 
couÁ
++;

1402  
FÜm©
::
	`fÜm©
("%d.%s", 
couÁ
, 
Çme
);

1403 
	}
}

1405 
	$do_fÜ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1407 
Room
 *
Şd_room
 = 
nuÎ±r
;

1408 
boŞ
 
fGods
 = 
çl£
, 
fMÜls
 = f®£, 
fRoom
 = f®£, 
found
;

1410 
SŒšg
 
¿nge
;

1411 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¿nge
);

1413 ià(
¿nge
.
	`em±y
(è|| 
¬gum’t
.empty()) {

1414 
	`¡c
("Syntax:\n"

1418 " fÜ„oom <aùiÚ>\n", 
ch
);

1422 ià(
¬gum’t
.
	`has_´efix
("slay")

1423 || 
¬gum’t
.
	`has_´efix
("purge")

1424 || 
¬gum’t
.
	`has_´efix
("quit")

1425 || 
¬gum’t
.
	`has_´efix
("for ")

1426 || 
¬gum’t
.
	`has_´efix
("delete")

1427 || 
¬gum’t
.
	`has_´efix
("who")) {

1428 
	`¡c
("I dÚ'ˆthšk sØTim!\n", 
ch
);

1432 ià(
¿nge
.
	`is_´efix_of
("all")) {

1433 
fMÜls
 = 
Œue
;

1434 
fGods
 = 
Œue
;

1436 ià(
¿nge
.
	`is_´efix_of
("gods"))

1437 
fGods
 = 
Œue
;

1438 ià(
¿nge
.
	`is_´efix_of
("mortals"))

1439 
fMÜls
 = 
Œue
;

1440 ià(
¿nge
.
	`is_´efix_of
("room"))

1441 
fRoom
 = 
Œue
;

1443 
	`¡c
("Syntax:\n"

1447 " fÜ„oom <aùiÚ>\n", 
ch
);

1451 ià(
	`¡rchr
(
¬gum’t
, '#')) {

1452 autØ
p
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

1453 
found
 = 
çl£
;

1455 ià(!(
p
->
š_room
è|| (°=ğ
ch
è|| (p->š_room->
	`is_´iv©e
(è&& 
	`IS_IMMORTAL
(p)))

1457 ià(
p
->
	`is_Åc
(è&& !
fRoom
)

1459 ià(!
	`IS_IMMORTAL
(
p
è&& 
fMÜls
)

1460 
found
 = 
Œue
;

1461 ià(
	`IS_IMMORTAL
(
p
è&& 
fGods
)

1462 
found
 = 
Œue
;

1463 ià(
p
->
š_room
 =ğ
ch
->š_room && 
fRoom
)

1464 
found
 = 
Œue
;

1466 ià(!
found
)

1469 
SŒšg
 
Çme
 = 
	`Çme_ex·nd
(
p
);

1471 ià(
Çme
.
	`em±y
())

1474 
SŒšg
 
buf
 = 
¬gum’t
.
	`»¶aû
("#", 
Çme
);

1477 ià(!
fRoom
) {

1478 
Şd_room
 = 
ch
->
š_room
;

1479 
	`ch¬_äom_room
(
ch
);

1480 
	`ch¬_to_room
(
ch
, 
p
->
š_room
);

1483 
	`š‹½»t
(
ch
, 
buf
);

1485 ià(!
ch
->
	`is_g¬bage
(è&& !
fRoom
) {

1486 
	`ch¬_äom_room
(
ch
);

1487 
	`ch¬_to_room
(
ch
, 
Şd_room
);

1492 ià(
fRoom
) {

1493 
	`š‹½»t
(
ch
, 
¬gum’t
);

1497 cÚ¡‡uto& 
äom_¬—
 : 
Game
::
	`wÜld
().
¬—s
) {

1498 cÚ¡‡uto& 
·œ
 : 
äom_¬—
.
£cÚd
->
rooms
) {

1500 
Room
 *
room
 = 
·œ
.
£cÚd
;

1501 
found
 = 
çl£
;

1504 ià(!
room
->
³İË
)

1508 
Ch¬aù”
 *
p
 = 
room
->
³İË
;…;… =…->
Ãxt_š_room
) {

1509 ià(!(
p
->
š_room
è|| (°=ğ
ch
è|| (p->š_room->
	`is_´iv©e
(è&& 
	`IS_IMMORTAL
(p)))

1511 ià(
p
->
	`is_Åc
(è&& !
fRoom
)

1513 ià(
	`IS_IMMORTAL
(
p
è&& 
fGods
)

1514 
found
 = 
Œue
;

1515 ià(!
	`IS_IMMORTAL
(
p
è&& 
fMÜls
)

1516 
found
 = 
Œue
;

1519 ià(
found
) {

1520 
Şd_room
 = 
ch
->
š_room
;

1521 
	`ch¬_äom_room
(
ch
);

1522 
	`ch¬_to_room
(
ch
, 
room
);

1523 
	`š‹½»t
(
ch
, 
¬gum’t
);

1525 ià(!
ch
->
	`is_g¬bage
()) {

1526 
	`ch¬_äom_room
(
ch
);

1527 
	`ch¬_to_room
(
ch
, 
Şd_room
);

1533 
	}
}

1535 
	$do_gÙo
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1537 
Room
 *
loÿtiÚ
 = 
nuÎ±r
;

1538 
Ch¬aù”
 *
rch
;

1539 
Objeù
 *
obj
;

1540 
couÁ
 = 0;

1541 
boŞ
 
gÙo_³t
 = 
çl£
;

1543 ià(
¬gum’t
.
	`em±y
()) {

1544 
	`¡c
("Syntax:\n"

1547 " gÙØobj <objeù‚ame>\n", 
ch
);

1551 
SŒšg
 
¬g
;

1552 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1555 
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
¬gum’t
));

1557 ià(
loÿtiÚ
 =ğ
nuÎ±r
) {

1558 ià((
rch
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬gum’t
, 
VIS_CHAR
)è!ğ
nuÎ±r
)

1559 
loÿtiÚ
 = 
rch
->
š_room
;

1561 ià(
¬g
.
	`is_´efix_of
("objeù"è|| 
loÿtiÚ
 =ğ
nuÎ±r
) {

1562 
loÿtiÚ
 = 
nuÎ±r
;

1564 ià((
obj
 = 
	`g‘_obj_wÜld
(
ch
, 
¬gum’t
)è!ğ
nuÎ±r
)

1565 ià(
obj
->
š_room
)

1566 
loÿtiÚ
 = 
obj
->
š_room
;

1570 ià(
loÿtiÚ
 =ğ
nuÎ±r
) {

1571 
	`¡c
("NØsuch†oÿtiÚ.\n", 
ch
);

1575 
rch
 = 
loÿtiÚ
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
)

1576 
couÁ
++;

1578 ià(!
	`is_room_owÃr
(
ch
, 
loÿtiÚ
è&&†oÿtiÚ->
	`is_´iv©e
()

1579 && (
couÁ
 > 1 || !
	`IS_IMP
(
ch
))) {

1580 
	`¡c
("Th©„oom i ´iv©e.\n", 
ch
);

1584 ià(
ch
->
fightšg
 !ğ
nuÎ±r
)

1585 
	`¡İ_fightšg
(
ch
, 
Œue
);

1587 
rch
 = 
ch
->
š_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
) {

1588 ià(
	`ÿn_£e_ch¬
(
rch
, 
ch
)) {

1589 ià(
ch
->
pcd©a
 !ğ
nuÎ±r
 && !ch->pcd©a->
bamfout
.
	`em±y
())

1590 
	`aù
("$t", 
ch
, ch->
pcd©a
->
bamfout
, 
rch
, 
TO_VICT
);

1592 
	`aù
("$Àw¬p ofàtØdi¡ªˆÏnd š‡ bur¡ oà–eùriø’”gy.", 
ch
, 
nuÎ±r
, 
rch
, 
TO_VICT
);

1596 ià(
ch
->
³t
 !ğ
nuÎ±r
 && ch->
š_room
 =ğch->³t->š_room && !ch->³t->
aù_æags
.
	`has
(
ACT_STAY
))

1597 
gÙo_³t
 = 
Œue
;

1599 
	`ch¬_äom_room
(
ch
);

1600 
	`ch¬_to_room
(
ch
, 
loÿtiÚ
);

1602 
rch
 = 
ch
->
š_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
) {

1603 ià(
	`ÿn_£e_ch¬
(
rch
, 
ch
)) {

1604 ià(
ch
->
pcd©a
 !ğ
nuÎ±r
 && !ch->pcd©a->
bamfš
.
	`em±y
())

1605 
	`aù
("$t", 
ch
, ch->
pcd©a
->
bamfš
, 
rch
, 
TO_VICT
);

1607 
	`aù
("$Àm©”Ÿlize š‡ bur¡ oà–eùriø’”gy.", 
ch
, 
nuÎ±r
, 
rch
, 
TO_VICT
);

1611 
	`do_look
(
ch
, "auto");

1613 ià(
gÙo_³t
) {

1614 
	`ch¬_äom_room
(
ch
->
³t
);

1615 
	`ch¬_to_room
(
ch
->
³t
, 
loÿtiÚ
);

1616 
	`do_look
(
ch
->
³t
, "auto");

1618 
	}
}

1625 
	$do_grou¶i¡
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1627 
	sgroup_d©a
 {

1628 
Ch¬aù”
 *
Ëad”
;

1629 
group_d©a
 *
Ãxt
;

1631 
group_d©a
 
	tGROUP_DATA
;

1632 
DesütÜ
 *
d
;

1633 
GROUP_DATA
 *
Ëad”s
 = 
nuÎ±r
;

1634 
GROUP_DATA
 *
Ãwnode
, *
cuºode
, *
ÃxŠode
;

1635 
Ch¬aù”
 *
viùim
;

1636 
boŞ
 
du³
;

1637 
couÁ”
 = 0;

1638 
SŒšg
 
buf
;

1643 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

1644 
viùim
 = (
d
->
Üigš®
 !ğ
nuÎ±r
è? d->Üigš® : d->
ch¬aù”
;

1646 ià(
viùim
 =ğ
nuÎ±r
)

1649 ià(
viùim
->
Ëad”
 =ğ
nuÎ±r
)

1653 
du³
 = 
çl£
;

1655 
cuºode
 = 
Ëad”s
; cuºod!ğ
nuÎ±r
; cuºodğcuºode->
Ãxt
) {

1656 ià(
cuºode
->
Ëad”
 =ğ
viùim
->leader) {

1657 
du³
 = 
Œue
;

1662 ià(!
du³
) {

1663 
Ãwnode
 = 
Ãw
 
GROUP_DATA
;

1664 
Ãwnode
->
Ëad”
 = 
viùim
->leader;

1665 
Ãwnode
->
Ãxt
 = 
Ëad”s
;

1666 
Ëad”s
 = 
Ãwnode
;

1671 
cuºode
 = 
Ëad”s
; cuºod!ğ
nuÎ±r
; cuºodğcuºode->
Ãxt
) {

1672 
FÜm©
::
	`¥rštf
(
buf
, "{G<G%d> {Y%s{x", ++
couÁ”
, 
cuºode
->
Ëad”
->
Çme
);

1675 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

1676 
viùim
 = (
d
->
Üigš®
 !ğ
nuÎ±r
è? d->Üigš® : d->
ch¬aù”
;

1678 ià(
viùim
 !ğ
nuÎ±r


1679 && 
viùim
->
Ëad”
 != victim

1680 && 
viùim
->
Ëad”
 =ğ
cuºode
->leader) {

1681 
buf
 += " ";

1682 
buf
 +ğ
viùim
->
Çme
;

1686 
buf
 += "\n";

1687 
	`¡c
(
buf
, 
ch
);

1691 ià(
Ëad”s
 =ğ
nuÎ±r
) {

1692 
	`¡c
("NØgroup found.\n", 
ch
);

1697 
Ëad”s
 !ğ
nuÎ±r
) {

1698 
ÃxŠode
 = 
Ëad”s
->
Ãxt
;

1699 
d–‘e
 
Ëad”s
;

1700 
Ëad”s
 = 
ÃxŠode
;

1702 
	}
}

1704 
	$do_gud
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1706 
Ch¬aù”
 *
viùim
;

1707 
CÏn
 *
şª
;

1709 
SŒšg
 
¬g1
, 
¬g2
;

1710 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

1711 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

1713 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.empty()) {

1714 
	`¡c
("SyÁax: gud <ch¬> <şª‚ame>\n", 
ch
);

1719 
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g1
, 
VIS_PLR
);

1721 ià(
viùim
 =ğ
nuÎ±r
)

1722 
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g1
, 
VIS_PLR
);

1724 ià(
viùim
 =ğ
nuÎ±r
) {

1725 
	`¡c
("Thch¬aù” i nÙ†ogged iÀth»®m.\n", 
ch
);

1729 ià(
¬g2
.
	`is_´efix_of
("none")) {

1730 
	`¡c
("Thch¬aù” i now cÏÆess.\n", 
ch
);

1731 
	`¡c
("You‡»‚ow cÏÆess.\n", 
viùim
);

1733 ià(!
	`IS_IMMORTAL
(
viùim
)) {

1735 
viùim
->
	`»move_cgroup
(
GROUP_LEADER
);

1736 
viùim
->
	`»move_cgroup
(
GROUP_DEPUTY
);

1737 
viùim
->
	`»move_cgroup
(
GROUP_CLAN
);

1740 
viùim
->
şª
 = 
nuÎ±r
;

1742 ià(!
viùim
->
	`is_Åc
()) {

1743 
viùim
->
pcd©a
->
que¡pošts_dÚ©ed
 = 0;

1744 
viùim
->
pcd©a
->
gŞd_dÚ©ed
 = 0;

1747 
	`§ve_ch¬_obj
(
viùim
);

1751 
şª
 = 
	`şª_lookup
(
¬g2
);

1753 ià(
şª
 =ğ
nuÎ±r
) {

1754 
	`¡c
("NØsuch cÏÀexi¡s.\n", 
ch
);

1758 ià(
ch
 !ğ
viùim
)

1759 
	`±c
(
ch
, "Thch¬aù” i now‡ memb” oà%s.\n", 
şª
->
şªÇme
);

1761 
	`±c
(
viùim
, "You havnow becom¨memb” oà%s.\n", 
şª
->
şªÇme
);

1763 ià(!
	`IS_IMMORTAL
(
viùim
)) {

1765 
viùim
->
	`»move_cgroup
(
GROUP_LEADER
);

1766 
viùim
->
	`»move_cgroup
(
GROUP_DEPUTY
);

1769 
viùim
->
	`add_cgroup
(
GROUP_CLAN
);

1770 
viùim
->
şª
 = clan;

1772 ià(!
viùim
->
	`is_Åc
()) {

1773 
viùim
->
pcd©a
->
que¡pošts_dÚ©ed
 = 0;

1774 
viùim
->
pcd©a
->
gŞd_dÚ©ed
 = 0;

1777 
	`§ve_ch¬_obj
(
viùim
);

1778 
	}
}

1782 
	$do_h“d
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1784 
buf
[100 + 
MIL
];

1785 
Ch¬aù”
 *
viùim
, *
Œueviùim
 = 
nuÎ±r
;

1786 
DesütÜ
 *
d
;

1788 
SŒšg
 
¬g1
;

1789 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

1791 ià(
¬g1
.
	`em±y
()) {

1792 ià(
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_HEEDNAME
)) {

1793 
	`¡c
("You¸ÇmwÈnÙ bshowÀš h“ds.\n", 
ch
);

1794 
ch
->
pcd©a
->
¶r_æags
 -ğ
PLR_HEEDNAME
;

1797 
	`¡c
("You¸ÇmwÈnow bshowÀš h“ds.\n", 
ch
);

1798 
ch
->
pcd©a
->
¶r_æags
 +ğ
PLR_HEEDNAME
;

1805 autØ
c
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

1806 ià(
c
->
	`is_Åc
())

1809 ià(
c
->
Çme
.
	`has_wÜds
(
¬g1
)) {

1810 
Œueviùim
 = 
c
;

1815 ià(
Œueviùim
 =ğ
nuÎ±r
) {

1816 
	`±c
(
ch
, "NØ¶ay” c®Ëd \"%s\" i šhgame!\n", 
¬g1
);

1821 ià(
Œueviùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_LINK_DEAD
)) {

1822 
	`±c
(
ch
, "% i lškd—d‡ˆthi time.\n", 
Œueviùim
->
Çme
);

1827 
viùim
 = 
Œueviùim
;

1829 ià(
viùim
->
desc
 =ğ
nuÎ±r
) {

1830 
viùim
 = 
nuÎ±r
;

1832 
d
 = 
desütÜ_li¡
; d; d = d->
Ãxt
) {

1833 ià(
d
->
Üigš®
 =ğ
Œueviùim
) {

1834 
viùim
 = 
d
->
ch¬aù”
;

1839 ià(!
viùim
) {

1840 
	`±c
(
ch
, "% i uÇvaabË‡ˆthmom’t.\n", 
Œueviùim
->
Çme
);

1846 ià(
¬gum’t
.
	`em±y
()) {

1847 
	`±c
(
ch
, "HEED % w™h wh© mes§ge?\n", 
Œueviùim
->
Çme
);

1852 
	`Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_PRAY
);

1853 
	`±c
(
viùim
, "%sƒnlightens you with:\n \"%s\"\n",

1854 
ch
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_HEEDNAME
è? ch->
Çme
 : "AÀImmÜl", 
¬gum’t
);

1855 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

1858 cÚ¡ 
SŒšg
& 
wizÇme
 = 
ch
->
desc
 && ch->desc->
Üigš®
 ? ch->desc->Üigš®->
Çme
 : ch->name;

1860 ià(
viùim
 !ğ
Œueviùim
)

1861 
FÜm©
::
	`¥rštf
(
buf
, "% HEED % (%s): %s\n", 
wizÇme
, 
Œueviùim
->
Çme
, 
viùim
->Çme, 
¬gum’t
);

1863 
FÜm©
::
	`¥rštf
(
buf
, "% HEED %s: %s\n", 
wizÇme
, 
Œueviùim
->
Çme
, 
¬gum’t
);

1866 
d
 = 
desütÜ_li¡
; d; d = d->
Ãxt
) {

1867 ià(
d
->
	`is_¶ayšg
()) {

1868 
viùim
 = 
d
->
ch¬aù”
;

1869 
Œueviùim
 = 
d
->
Üigš®
 ? d->Üigš® : 
viùim
;

1871 ià(
	`IS_IMMORTAL
(
Œueviùim
)

1872 && !
Œueviùim
->
comm_æags
.
	`has
(
COMM_NOPRAY
)

1873 && !
Œueviùim
->
comm_æags
.
	`has
(
COMM_QUIET
)) {

1874 
	`Ãw_cŞÜ
(
viùim
, 
CSLOT_CHAN_PRAY
);

1875 
	`¡c
(
buf
, 
viùim
);

1876 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

1880 
	}
}

1882 
	$do_lšklßd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1884 
Ch¬aù”
 *
viùim
;

1885 
buf
[
MAX_STRING_LENGTH
];

1886 
DesütÜ
 *
dÃw
;

1887 
DesütÜ
 *
d
;

1888 
desc
 = 5;

1890 
SŒšg
 
¬g
;

1891 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1893 ià(
¬g
.
	`em±y
()) {

1894 
	`¡c
("Whom dØyou wªˆtØlšklßd?\n", 
ch
);

1898 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
)

1899 
desc
++;

1901 
desc
++;

1903 ià(!
	`check_·r£_Çme
(
¬g
)) {

1904 
	`¡c
("Th© i nÙ‡ v®id…Ïy”‚ame.\n", 
ch
);

1908 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g
, 
VIS_CHAR
)è!ğ
nuÎ±r
) {

1909 ià(!
viùim
->
	`is_Åc
()) {

1910 
	`¡c
("They‡»‡Ì—dy…Ïyšg o¸lßded.\n", 
ch
);

1915 
dÃw
 = 
Ãw
 
	`DesütÜ
();

1916 
dÃw
->
desütÜ
 = 
desc
;

1917 
dÃw
->
¡©e
 = &
cÚn
::
S‹
::
¶ayšg
;

1919 
úame
[
MIL
];

1920 
	`¡rıy
(
úame
, 
¬gum’t
);

1921 
úame
[0] = 
	`touµ”
(cname[0]);

1923 ià(
	`lßd_ch¬_obj
(
dÃw
, 
úame
è=ğ
Œue
) {

1924 
viùim
 = 
dÃw
->
ch¬aù”
;

1925 
Game
::
	`wÜld
().
	`add_ch¬
(
viùim
);

1926 
viùim
->
desc
 = 
nuÎ±r
;

1928 ià(
	`OUTRANKS
(
viùim
, 
ch
)) {

1929 
	`aù
("You'»‚Ù highƒnough†ev–Ølšklßd $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

1930 
	`exŒaù_ch¬
(
viùim
, 
Œue
);

1933 
FÜm©
::
	`¥rštf
(
buf
, "You„each intohe…file‡nd†ink-load %s from„oom %s.\n",

1934 
viùim
->
Çme
, viùim->
š_room
->
loÿtiÚ
.
	`to_¡ršg
());

1935 
	`¡c
(
buf
, 
ch
);

1936 
	`aù
("$À»ache štØthpfe ªd†šk-lßd $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

1937 
FÜm©
::
	`¥rštf
(
buf
, "$N ha lšk-lßded % äom„oom %s.", 
viùim
->
Çme
, viùim->
š_room
->
loÿtiÚ
.
	`to_¡ršg
());

1938 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_LOAD
, 
WIZ_SECURE
, 0);

1939 
	`ch¬_to_room
(
viùim
, 
ch
->
š_room
);

1941 ià(
viùim
->
³t
 !ğ
nuÎ±r
)

1942 
	`ch¬_to_room
(
viùim
->
³t
, 
ch
->
š_room
);

1944 
viùim
->
pcd©a
->
¶r_æags
 +ğ
PLR_LINK_DEAD
;

1948 
	`¡c
("NØsuch…Ïy”ƒxi¡ šhpfes.\n", 
ch
);

1949 
d–‘e
 
dÃw
->
ch¬aù”
;

1952 
d–‘e
 
dÃw
;

1953 
	}
}

1955 
	$do_mlßd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1957 
MobePrÙÙy³
 *
pMobIndex
;

1958 
Ch¬aù”
 *
viùim
;

1959 
buf
[
MAX_STRING_LENGTH
];

1961 
SŒšg
 
¬g
;

1962 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1964 ià(
¬g
.
	`em±y
(è|| !¬g.
	`is_numb”
()) {

1965 
	`¡c
("SyÁax:†ßd mob <vnum>.\n", 
ch
);

1969 ià((
pMobIndex
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
	`©oi
(
¬g
))è=ğ
nuÎ±r
) {

1970 
	`¡c
("NØmob ha th© vnum.\n", 
ch
);

1974 
viùim
 = 
	`ü—‹_mobe
(
pMobIndex
);

1976 ià(! 
viùim
) {

1977 
Loggšg
::
	`bug
("Memoryƒrror while creating mob.", 0);

1978 
	`¡c
("Could‚Ù c»©mob.\n", 
ch
);

1982 
	`ch¬_to_room
(
viùim
, 
ch
->
š_room
);

1983 
	`aù
("$Àü—‹ $N!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_ROOM
);

1984 
FÜm©
::
	`¥rštf
(
buf
, "$N†ßd %s.", 
viùim
->
shÜt_desü
);

1985 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_LOAD
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

1986 
	`¡c
("Sucûss.\n", 
ch
);

1988 
	}
}

1990 
	$do_Şßd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1992 
ObjeùPrÙÙy³
 *
pObjIndex
;

1993 
Objeù
 *
obj
;

1995 
SŒšg
 
¬g1
;

1996 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

1998 ià(
¬g1
.
	`em±y
(è|| !¬g1.
	`is_numb”
()) {

1999 
	`¡c
("SyÁax:†ßd obj <vnum>.\n", 
ch
);

2003 ià((
pObjIndex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
	`©oi
(
¬g1
))è=ğ
nuÎ±r
) {

2004 
	`¡c
("NØobjeù ha th© vnum.\n", 
ch
);

2008 
obj
 = 
	`ü—‹_objeù
(
pObjIndex
, 0);

2010 ià(! 
obj
) {

2011 
	`¡c
("You w”uÇbËØü—‹h© i‹m.\n", 
ch
);

2012 
Loggšg
::
	`bug
("Error creating object in do_oload.\n", 0);

2016 ià(
	`CAN_WEAR
(
obj
, 
ITEM_TAKE
))

2017 
	`obj_to_ch¬
(
obj
, 
ch
);

2019 
	`obj_to_room
(
obj
, 
ch
->
š_room
);

2021 
	`aù
("$Àha ü—‹d $p!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

2022 
	`wizÃt
("$N†ßd $p.", 
ch
, 
obj
, 
WIZ_LOAD
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

2023 
	`¡c
("Sucûss.\n", 
ch
);

2025 
	}
}

2027 
	$do_lßd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2029 
SŒšg
 
¬g
;

2030 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

2032 ià(
¬g
.
	`em±y
()) {

2033 
	`¡c
("SyÁax:\n", 
ch
);

2034 
	`¡c
("†ßd mob <vnum>\n", 
ch
);

2035 
	`¡c
("†ßd obj <vnum>\n", 
ch
);

2039 ià(
¬g
 == "mob" ||‡rg == "char") {

2040 
	`do_mlßd
(
ch
, 
¬gum’t
);

2044 ià(
¬g
 == "obj") {

2045 
	`do_Şßd
(
ch
, 
¬gum’t
);

2050 
	`do_lßd
(
ch
, "");

2051 
	}
}

2053 
	$do_low”
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2055 
buf
[
MAX_STRING_LENGTH
];

2056 
Objeù
 *
obj
;

2057 
Ch¬aù”
 *
viùim
;

2058 
x
;

2059 
qp
 = 0;

2060 
	sque¡_¡ruù
 {

2061 
Ëv–
;

2062 
co¡
;

2063 } 
que¡
[] = {

2064 { 
LEVEL_IMMORTAL
+2, 175 },

2065 { 
LEVEL_IMMORTAL
+1, 150 },

2066 { 
LEVEL_IMMORTAL
, 125 },

2070 
SŒšg
 
wh©
;

2071 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
wh©
);

2073 ià(
wh©
.
	`em±y
()) {

2074 
	`¡c
("Which i‹m dØyou wishØlow”?\n", 
ch
);

2078 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
wh©
)è=ğ
nuÎ±r
) {

2079 
	`aù
("You'»‚Ù c¬ryšg‡Òè$t.", 
ch
, 
wh©
, 
nuÎ±r
, 
TO_CHAR
,

2080 
POS_DEAD
, 
çl£
);

2084 ià(
¬gum’t
.
	`em±y
()) {

2085 
	`aù
("Whom dØyou wªˆtØlow” $ˆfÜ?", 
ch
,

2086 
obj
->
shÜt_desü
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

2090 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬gum’t
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

2091 
	`aù
("SÜry,‚Ø¶ay” c®Ëd '$t' i šhgame!", 
ch
,

2092 
¬gum’t
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

2096 ià(
viùim
->
Ëv–
 < 
LEVEL_HERO
) {

2097 
	`aù
("SÜry, $ˆmu¡ bËv– 91Øhavª i‹m†ow”ed.", 
ch
,

2098 
viùim
->
Çme
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

2102 ià(
obj
->
exŒa_desü
 !ğ
nuÎ±r
) {

2103 
ExŒaDesü
 *
ed_Ãxt
;

2104 
ExŒaDesü
 *
ed
;

2106 
ed
 = 
obj
->
exŒa_desü
;ƒd !ğ
nuÎ±r
;ƒd = 
ed_Ãxt
) {

2107 
ed_Ãxt
 = 
ed
->
Ãxt
;

2109 ià(
ed
->
keywÜd
 =ğ
KEYWD_OWNER
) {

2110 
¡r
[
MAX_STRING_LENGTH
];

2111 
	`¡rıy
(
¡r
, 
ed
->
desütiÚ
);

2112 
¡r
[
	`¡¾’
(strip) - 2] = '\0';

2113 
FÜm©
::
	`¥rštf
(
buf
, "Thi ™em i ®»ady owÃd by %s.\n", 
¡r
);

2114 
	`¡c
(
buf
, 
ch
);

2120 
x
 = 0; 
que¡
[x].
Ëv–
 != 0; x++) {

2121 ià(
obj
->
Ëv–
 >ğ
que¡
[
x
].level) {

2122 
qp
 = 
que¡
[
x
].
co¡
;

2127 ià(
qp
 == 0) {

2128 
	`aù
("Buˆ$ˆi ®»ady†ow”hª†ev– 92.", 
ch
,

2129 
obj
->
shÜt_desü
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

2133 ià(
qp
 > 
viùim
->
pcd©a
->
que¡pošts
 && !
	`IS_IMMORTAL
(victim)) {

2134 
	`¡c
("They do‚ot haveƒnough quest…oints forhat.\n"

2135 , 
ch
);

2139 ià(!
	`IS_IMMORTAL
(
viùim
)) {

2140 
FÜm©
::
	`¥rštf
(
buf
, "% %s", 
wh©
, 
viùim
->
Çme
);

2141 
	`do_owÃr
(
ch
, 
buf
);

2142 
FÜm©
::
	`¥rštf
(
buf
, "deduù % %d", 
viùim
->
Çme
, 
qp
);

2143 
	`do_que¡
(
ch
, 
buf
);

2146 
obj
->
Ëv–
 = 
LEVEL_HERO
;

2147 
	`aù
("$ˆha b“ÀsucûssfuÎy†ow”edØËv– 91.", 
ch
,

2148 
obj
->
shÜt_desü
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

2149 
	}
}

2151 
	$do_lurk
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2153 ià(
ch
->
lurk_Ëv–
) {

2154 
ch
->
lurk_Ëv–
 = 0;

2155 
	`aù
("$Ài nØlÚg” clßked.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2156 
	`¡c
("You‡»‚ØlÚg” clßked.\n", 
ch
);

2159 
ch
->
lurk_Ëv–
 = 
LEVEL_IMMORTAL
;

2160 
	`aù
("$Àşßk $ ´e£nûØtho£ outsidthroom.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

2161 
	`¡c
("You clßk you¸´e£nûØtho£ outsidthroom.\n", 
ch
);

2163 
	}
}

2166 
	$do_ma¡”
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2168 
Ch¬aù”
 *
viùim
;

2169 
Ch¬aù”
 *
³t
;

2171 
SŒšg
 
¬g1
;

2172 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

2174 ià(
¬g1
.
	`em±y
(è|| 
¬gum’t
.empty()) {

2175 
	`¡c
("Ma¡” wh© mobtØwhom?\n", 
ch
);

2179 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g1
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

2180 
	`¡c
("Th©…Ïy” i nÙ h”e.\n", 
ch
);

2184 ià((
³t
 = 
	`g‘_ch¬_h”e
(
viùim
, 
¬gum’t
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

2185 
	`¡c
("Th© mobi nÙ‚—¸th¶ay”.\n", 
ch
);

2190 ià(
viùim
->
	`is_Åc
(è|| !
³t
->is_npc()) {

2191 
	`¡c
("Th© i nÙ‡Îowed!\n", 
ch
);

2195 ià(
viùim
->
Ëv–
 < 
³t
->Ëv– && !
	`IS_IMMORTAL
(victim)) {

2196 
	`¡c
("Th©…‘ i toØpow”fuÈfÜh©…Ïy”.\n", 
ch
);

2200 ià(
viùim
->
³t
 !ğ
nuÎ±r
) {

2201 
	`¡c
("They hav¨³ˆ®»ady!\n", 
ch
);

2205 ià(
³t
->
ma¡”
 !ğ
nuÎ±r
) {

2206 
	`¡c
("Th© mob®»ady ha ¨ma¡”.\n", 
ch
);

2210 
	`make_³t
(
viùim
, 
³t
);

2214 
	`¡c
("You may wªˆtØcÚsid”„evokšgh³t' chªÃls!\n", 
ch
);

2216 
	`¡c
("You hav£ˆth¶ay” w™h‡…‘.\n", 
ch
);

2217 
	`¡c
("You havb“À£ˆw™h‡‚ew…‘.\n", 
viùim
);

2218 
	`¡c
("You havb“Àtuºed iÁØ¨³t!\n", 
³t
);

2219 
	}
}

2222 
	$do_Şev–
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2224 
tİ_obj_šdex
;

2225 
buf
[
MAX_STRING_LENGTH
];

2226 
tmpbuf
[80];

2227 
SŒšg
 
bufãr
;

2228 
ObjeùPrÙÙy³
 *
pObjIndex
;

2229 
vnum
, 
bËv–
, 
–ev–
;

2230 
nM©ch
, 
m©ches
;

2231 
boŞ
 
found
, 
w™h_w—r
;

2234 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
;

2235 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

2237 ià(!
¬g1
.
	`is_numb”
()) {

2238 
	`¡c
("SyÁax: oËv– [beg†ev–] [’d†ev–] [w—¸ty³]\n", 
ch
);

2242 
bËv–
 = 
	`©oi
(
¬g1
);

2243 
–ev–
 = 
bËv–
;

2244 
FÏgs
::
B™
 
w—r_loc
 = FÏgs::
®l
;

2245 
w™h_w—r
 = 
çl£
;

2248 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

2250 ià(!
¬g2
.
	`em±y
()) {

2251 ià(!
¬g2
.
	`is_numb”
()) {

2253 
w™h_w—r
 = 
Œue
;

2256 
–ev–
 = 
	`©oi
(
¬g2
);

2257 
w™h_w—r
 = 
çl£
;

2261 ià((
bËv–
 < 0è|| (bËv– > 120è|| (
–ev–
 < blevel) || (elevel > 120)) {

2262 
	`¡c
("V®ue mu¡ bb‘w“À0‡nd 120.\n", 
ch
);

2263 
	`¡c
("SecÚd v®umu¡ bg»©”hª fœ¡.\n", 
ch
);

2268 ià(
w™h_w—r
)

2269 
¬g3
 = 
¬g2
;

2271 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g3
);

2273 
boŞ
 
¥ecif›d_w—r_loc
 = 
çl£
;

2275 ià(!
¬g3
.
	`em±y
()) {

2276 ià(
¬g3
.
	`is_´efix_of
("take"))

2277 
w—r_loc
 = 
ITEM_TAKE
;

2278 ià(
¬g3
.
	`is_´efix_of
("finger"))

2279 
w—r_loc
 = 
ITEM_WEAR_FINGER
;

2280 ià(
¬g3
.
	`is_´efix_of
("neck"))

2281 
w—r_loc
 = 
ITEM_WEAR_NECK
;

2282 ià(
¬g3
.
	`is_´efix_of
("body"))

2283 
w—r_loc
 = 
ITEM_WEAR_BODY
;

2284 ià(
¬g3
.
	`is_´efix_of
("head"))

2285 
w—r_loc
 = 
ITEM_WEAR_HEAD
;

2286 ià(
¬g3
.
	`is_´efix_of
("legs"))

2287 
w—r_loc
 = 
ITEM_WEAR_LEGS
;

2288 ià(
¬g3
.
	`is_´efix_of
("feet"))

2289 
w—r_loc
 = 
ITEM_WEAR_FEET
;

2290 ià(
¬g3
.
	`is_´efix_of
("hands"))

2291 
w—r_loc
 = 
ITEM_WEAR_HANDS
;

2292 ià(
¬g3
.
	`is_´efix_of
("arms"))

2293 
w—r_loc
 = 
ITEM_WEAR_ARMS
;

2294 ià(
¬g3
.
	`is_´efix_of
("shield"))

2295 
w—r_loc
 = 
ITEM_WEAR_SHIELD
;

2296 ià(
¬g3
.
	`is_´efix_of
("about"))

2297 
w—r_loc
 = 
ITEM_WEAR_ABOUT
;

2298 ià(
¬g3
.
	`is_´efix_of
("waist"))

2299 
w—r_loc
 = 
ITEM_WEAR_WAIST
;

2300 ià(
¬g3
.
	`is_´efix_of
("wrist"))

2301 
w—r_loc
 = 
ITEM_WEAR_WRIST
;

2302 ià(
¬g3
.
	`is_´efix_of
("wield"))

2303 
w—r_loc
 = 
ITEM_WIELD
;

2304 ià(
¬g3
.
	`is_´efix_of
("hold"))

2305 
w—r_loc
 = 
ITEM_HOLD
;

2306 ià(
¬g3
.
	`is_´efix_of
("float"))

2307 
w—r_loc
 = 
ITEM_WEAR_FLOAT
;

2308 ià(
¬g3
.
	`is_´efix_of
("none"))

2309 
w—r_loc
 = 
FÏgs
::
nÚe
;

2311 
	`¡c
("Th© i nÙ‡ su™abË w—¸loÿtiÚ.\n", 
ch
);

2315 
¥ecif›d_w—r_loc
 = 
Œue
;

2318 
found
 = 
çl£
;

2319 
nM©ch
 = 0;

2320 
m©ches
 = 0;

2322 
vnum
 = 0; 
nM©ch
 < 
tİ_obj_šdex
; vnum++) {

2323 ià((
pObjIndex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
vnum
)è!ğ
nuÎ±r
) {

2324 
nM©ch
++;

2325 
found
 = 
çl£
;

2327 ià((
bËv–
 <ğ
pObjIndex
->
Ëv–
è&& (
–ev–
 >=…ObjIndex->level)) {

2328 ià(!
¥ecif›d_w—r_loc
)

2329 
found
 = 
Œue
;

2331 ià(
pObjIndex
->
w—r_æags
.
	`has
(
w—r_loc
))

2332 
found
 = 
Œue
;

2337 ià(
found
) {

2338 
FÜm©
::
	`¥rštf
(
tmpbuf
, "[%%4d][%%5d] %%-%zus{x [%%s]\n",

2339 45 + (
	`¡¾’
(
pObjIndex
->
shÜt_desü
è-…ObjIndex->shÜt_desü.
	`uncŞÜ
().
	`size
()));

2340 
FÜm©
::
	`¥rštf
(
buf
, 
tmpbuf
, 
pObjIndex
->
Ëv–
,…ObjIndex->
vnum
,

2341 
pObjIndex
->
shÜt_desü
, 
	`w—r_b™_Çme
ÕObjIndex->
w—r_æags
));

2342 
bufãr
 +ğ
buf
;

2343 
m©ches
++;

2344 
found
 = 
çl£
;

2348 ià(
m©ches
 == 0)

2349 
	`¡c
("NØobjeù byh©†ev–.\n", 
ch
);

2351 ià(
bËv–
 < 
–ev–
)

2352 
FÜm©
::
	`¥rštf
(
buf
, "Objeù Ëv–„ªge: %dØ%d.\n", 
bËv–
, 
–ev–
);

2354 
FÜm©
::
	`¥rštf
(
buf
, "Objeù Ëv–: %d\n", 
bËv–
);

2356 
	`¡c
(
buf
, 
ch
);

2357 
	`¡c
("Lev– Vnum Nam W—¸Loc.\n", 
ch
);

2358 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

2359 
FÜm©
::
	`¥rštf
(
buf
, "%d m©ch% found.\n", 
m©ches
, (matches > 0) ? "es" : "");

2360 
	`¡c
(
buf
, 
ch
);

2364 
	}
}

2366 
	$do_mËv–
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2368 
tİ_mob_šdex
;

2369 
buf
[
MAX_STRING_LENGTH
];

2370 
tmpbuf
[80];

2371 
SŒšg
 
bufãr
;

2372 
MobePrÙÙy³
 *
pMobIndex
;

2373 
vnum
, 
bËv–
, 
–ev–
;

2374 
nM©ch
;

2375 
boŞ
 
found
;

2377 
SŒšg
 
¬g
;

2378 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

2380 ià(!
¬g
.
	`is_numb”
()) {

2381 
	`¡c
("SyÁax: mËv– [beg†ev–] [’d†ev–]\n", 
ch
);

2385 
bËv–
 = 
	`©oi
(
¬g
);

2387 ià(!
¬gum’t
.
	`em±y
()) {

2388 ià(!
¬gum’t
.
	`is_numb”
()) {

2389 
	`¡c
("SyÁax: oËv– [beg†ev–] [’d†ev–]\n", 
ch
);

2393 
–ev–
 = 
	`©oi
(
¬gum’t
);

2396 
–ev–
 = 
bËv–
;

2398 ià((
bËv–
 < 0è|| (bËv– > 120è|| (
–ev–
 < blevel) || (elevel > 120)) {

2399 
	`¡c
("V®ue mu¡ bb‘w“À0‡nd 120.\n", 
ch
);

2400 
	`¡c
("SecÚd v®umu¡ bg»©”hª fœ¡.\n", 
ch
);

2404 
found
 = 
çl£
;

2405 
nM©ch
 = 0;

2407 
vnum
 = 0; 
nM©ch
 < 
tİ_mob_šdex
; vnum++) {

2408 ià((
pMobIndex
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
vnum
)è!ğ
nuÎ±r
) {

2409 
nM©ch
++;

2411 ià((
bËv–
 <ğ
pMobIndex
->
Ëv–
è&& (
–ev–
 >=…MobIndex->level)) {

2412 
found
 = 
Œue
;

2413 
FÜm©
::
	`¥rštf
(
tmpbuf
, "[%%3d][%%5d] %%-%zus (Align: %%d)\n",

2414 40 + (
	`¡¾’
(
pMobIndex
->
shÜt_desü
è-…MobIndex->shÜt_desü.
	`uncŞÜ
().
	`size
()));

2415 
FÜm©
::
	`¥rštf
(
buf
, 
tmpbuf
,

2416 
pMobIndex
->
Ëv–
,…MobIndex->
vnum
,

2417 
pMobIndex
->
shÜt_desü
,…MobIndex->
®ignm’t
);

2418 
bufãr
 +ğ
buf
;

2423 ià(!
found
)

2424 
	`¡c
("NØmobe byh©†ev–.\n", 
ch
);

2426 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

2429 
	}
}

2431 
	$do_mÙd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2433 
SŒšg
 
buf
;

2435 ià(!
¬gum’t
.
	`em±y
()) {

2436 ià(
¬gum’t
 == "clear") {

2437 
Game
::
mÙd
.
	`”a£
();

2438 
	`¡c
("MOTD cË¬ed.\n", 
ch
);

2442 ià(
¬gum’t
[0] == '-') {

2443 
Ën
;

2444 
boŞ
 
found
 = 
çl£
;

2446 ià(
Game
::
mÙd
.
	`em±y
()) {

2447 
	`¡c
("NØlše ËáØ»move.\n", 
ch
);

2451 
buf
 = 
Game
::
mÙd
;

2453 
Ën
 = 
	`¡¾’
(
buf
);†en > 0;†en--) {

2454 ià(
buf
[
Ën
] == '\n') {

2455 ià(!
found
) {

2456 ià(
Ën
 > 0)

2457 
Ën
--;

2459 
found
 = 
Œue
;

2462 
buf
[
Ën
 + 1] = '\0';

2463 
Game
::
mÙd
 = 
buf
;

2464 
	`£t_cŞÜ
(
ch
, 
GREEN
, 
NOBOLD
);

2465 
	`¡c
("ThMOTD is:\n", 
ch
);

2466 
	`¡c
(!
Game
::
mÙd
.
	`em±y
() ? Game::motd :

2467 "(NÚe).\n", 
ch
);

2468 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2474 
Game
::
mÙd
.
	`”a£
();

2475 
	`¡c
("MOTD cË¬ed.\n", 
ch
);

2479 ià(
¬gum’t
[0] == '+') {

2480 
buf
 +ğ
Game
::
mÙd
;

2481 
¬gum’t
 =‡rgum’t.
	`sub¡r
(1).
	`l¡r
();

2484 ià(
	`¡¾’
(
buf
è+ sŒËn(
¬gum’t
è>ğ
MAX_STRING_LENGTH
 - 2) {

2485 
	`¡c
("MOTDoØlÚg.\n", 
ch
);

2489 
buf
 +ğ
¬gum’t
;

2490 
buf
 += "\n";

2491 
Game
::
mÙd
 = 
buf
;

2494 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
BOLD
);

2495 
	`¡c
("ThMOTD is:\n", 
ch
);

2496 
	`¡c
(!
Game
::
mÙd
.
	`em±y
(è? Game::mÙd : "(NÚe).\n", 
ch
);

2497 
	`£t_cŞÜ
(
ch
, 
WHITE
, 
NOBOLD
);

2499 
	}
}

2501 
	$do_owh”e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2503 
buf
[
MSL
];

2504 
SŒšg
 
ouut
;

2505 
Objeù
 *
obj
, *
š_obj
;

2506 
couÁ
 = 1, 
vnum
 = 0;

2507 
boŞ
 
fGround
 = 
çl£
;

2508 
LoÿtiÚ
 
¶aû_Ï¡_found
;

2509 
Vnum
 
™em_Ï¡_found
 = 0;

2511 
SŒšg
 
¬g
, 
¬g2
;

2512 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

2513 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g2
);

2515 ià(
¬g
.
	`em±y
()) {

2516 
	`¡c
("Syntax:\n"

2517 " owh”<objeù o¸vnum> <£cÚd keywÜd,†ev–, o¸'ground'>\n", 
ch
);

2521 ià(
¬g
.
	`is_numb”
())

2522 
vnum
 = 
	`©oi
(
¬g
);

2524 ià(
¬g2
.
	`is_´efix_of
("ground"))

2525 
fGround
 = 
Œue
;

2527 
ouut
 += "{VCount {YRoom {GObject{x\n";

2530 
obj
 = 
Game
::
	`wÜld
().
objeù_li¡
; obj !ğ
nuÎ±r
; obj = obj->
Ãxt
) {

2531 ià(
fGround
 && !
obj
->
š_room
)

2534 ià(
vnum
 > 0) {

2535 ià(
obj
->
pIndexD©a
->
vnum
 != vnum)

2538 ià(!
obj
->
Çme
.
	`has_wÜds
(
¬g
))

2541 ià(!
¬gum’t
.
	`em±y
(è&& !
fGround
) {

2542 ià(
¬g2
.
	`is_numb”
()) {

2543 ià(
	`©oi
(
¬g2
è!ğ
obj
->
Ëv–
)

2546 ià(
vnum
 > 0 || !
obj
->
Çme
.
	`has_wÜds
(
¬gum’t
))

2550 
š_obj
 = 
obj
; in_obj->š_obj !ğ
nuÎ±r
; in_obj = in_obj->in_obj)

2553 ià(
š_obj
->
ÿ¼›d_by
) {

2554 ià(
š_obj
->
ÿ¼›d_by
->
š_room
 =ğ
nuÎ±r


2555 || !
	`ÿn_£e_room
(
ch
, 
š_obj
->
ÿ¼›d_by
->
š_room
)

2556 || !
	`ÿn_£e_ch¬
(
ch
, 
š_obj
->
ÿ¼›d_by
))

2562 ià((
¶aû_Ï¡_found
 =ğ
š_obj
->
ÿ¼›d_by
->
š_room
->
loÿtiÚ
) &&

2563 (
™em_Ï¡_found
 =ğ
obj
->
pIndexD©a
->
vnum
))

2566 
FÜm©
::
	`¥rštf
(
buf
, "{M[{V%3d{M]{b[{Y%9s{b]{H[{G%5d{H]{x %s{x is carried by %s.\n",

2567 
couÁ
,

2568 
š_obj
->
ÿ¼›d_by
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(
çl£
),

2569 
obj
->
pIndexD©a
->
vnum
,

2570 
obj
->
shÜt_desü
,

2571 
	`PERS
(
š_obj
->
ÿ¼›d_by
, 
ch
, 
VIS_PLR
));

2573 
¶aû_Ï¡_found
 = 
š_obj
->
ÿ¼›d_by
->
š_room
->
loÿtiÚ
;

2574 
™em_Ï¡_found
 = 
obj
->
pIndexD©a
->
vnum
;

2576 ià(
š_obj
->
š_lock”
) {

2577 ià(
š_obj
->
š_lock”
->
š_room
 =ğ
nuÎ±r


2578 || !
	`ÿn_£e_room
(
ch
, 
š_obj
->
š_lock”
->
š_room
)

2579 || !
	`ÿn_£e_ch¬
(
ch
, 
š_obj
->
š_lock”
))

2585 ià((
¶aû_Ï¡_found
 =ğ
š_obj
->
š_lock”
->
š_room
->
loÿtiÚ
) &&

2586 (
™em_Ï¡_found
 =ğ
obj
->
pIndexD©a
->
vnum
))

2589 
FÜm©
::
	`¥rštf
(
buf
, "{M[{V%3d{M]{b[{Y%9s{b]{H[{G%5d{H]{x %s{x is in %s's†ocker.\n",

2590 
couÁ
,

2591 
š_obj
->
š_lock”
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(
çl£
),

2592 
obj
->
pIndexD©a
->
vnum
,

2593 
obj
->
shÜt_desü
,

2594 
	`PERS
(
š_obj
->
š_lock”
, 
ch
, 
VIS_PLR
));

2596 
¶aû_Ï¡_found
 = 
š_obj
->
š_lock”
->
š_room
->
loÿtiÚ
;

2597 
™em_Ï¡_found
 = 
obj
->
pIndexD©a
->
vnum
;

2599 ià(
š_obj
->
š_¡rÚgbox
) {

2600 ià(
š_obj
->
š_¡rÚgbox
->
š_room
 =ğ
nuÎ±r


2601 || !
	`ÿn_£e_room
(
ch
, 
š_obj
->
š_¡rÚgbox
->
š_room
)

2602 || !
	`ÿn_£e_ch¬
(
ch
, 
š_obj
->
š_¡rÚgbox
))

2608 ià((
¶aû_Ï¡_found
 =ğ
š_obj
->
š_¡rÚgbox
->
š_room
->
loÿtiÚ
) &&

2609 (
™em_Ï¡_found
 =ğ
obj
->
pIndexD©a
->
vnum
))

2612 
FÜm©
::
	`¥rštf
(
buf
, "{M[{V%3d{M]{b[{Y%9s{b]{H[{G%5d{H]{x %s{x is in %s's strongbox.\n",

2613 
couÁ
,

2614 
š_obj
->
š_¡rÚgbox
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(
çl£
),

2615 
obj
->
pIndexD©a
->
vnum
,

2616 
obj
->
shÜt_desü
,

2617 
	`PERS
(
š_obj
->
š_¡rÚgbox
, 
ch
, 
VIS_PLR
));

2619 
¶aû_Ï¡_found
 = 
š_obj
->
š_¡rÚgbox
->
š_room
->
loÿtiÚ
;

2620 
™em_Ï¡_found
 = 
obj
->
pIndexD©a
->
vnum
;

2622 ià(
š_obj
->
š_room
) {

2623 ià(!
	`ÿn_£e_room
(
ch
, 
š_obj
->
š_room
))

2627 ià((
¶aû_Ï¡_found
 =ğ
š_obj
->
š_room
->
loÿtiÚ
) &&

2628 (
™em_Ï¡_found
 =ğ
obj
->
pIndexD©a
->
vnum
))

2631 
FÜm©
::
	`¥rštf
(
buf
, "{M[{V%3d{M]{b[{Y%9s{b]{H[{G%5d{H]{x %s{x in %s.\n",

2632 
couÁ
,

2633 
š_obj
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(
çl£
),

2634 
obj
->
pIndexD©a
->
vnum
,

2635 
obj
->
shÜt_desü
,

2636 
š_obj
->
š_room
->
	`Çme
());

2638 
¶aû_Ï¡_found
 = 
š_obj
->
š_room
->
loÿtiÚ
;

2639 
™em_Ï¡_found
 = 
obj
->
pIndexD©a
->
vnum
;

2645 ià(++
couÁ
 <= 400)

2646 
ouut
 +ğ
buf
;

2649 ià(--
couÁ
 == 0)

2650 
	`¡c
("You found‚Ø™em†ikth©.\n", 
ch
);

2652 
FÜm©
::
	`¥rštf
(
buf
, "You found %d matching item%s%s%s.\n",

2653 
couÁ
,

2654 
couÁ
 > 1 ? "s" : "",

2655 
fGround
 ? "†ying‡round" : "",

2656 
couÁ
 > 400 ? ", of which 400‡re shown" : "");

2657 
ouut
 +ğ
buf
;

2658 
	`·ge_to_ch¬
(
ouut
, 
ch
);

2661 
	}
}

2663 
	$do_mwh”e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2665 
buf
[
MAX_STRING_LENGTH
];

2666 
SŒšg
 
ouut
;

2667 
boŞ
 
found
;

2669 
SŒšg
 
¬g
, 
¬g2
;

2670 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

2671 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g2
);

2673 ià(
¬g
.
	`em±y
()) {

2674 
	`¡c
("SyÁax: mwh”<mob‚amÜ vnum> <£cÚd keywÜd o¸Ëv–>\n", 
ch
);

2678 
found
 = 
çl£
;

2680 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

2681 ià(!
viùim
->
	`is_Åc
(è|| viùim->
š_room
 =ğ
nuÎ±r
)

2684 ià(
¬g
.
	`is_numb”
()) {

2685 ià(
	`©oi
(
¬g
è!ğ
viùim
->
pIndexD©a
->
vnum
)

2688 ià(!
viùim
->
Çme
.
	`has_wÜds
(
¬g
))

2691 ià(!
¬g2
.
	`em±y
()) {

2692 ià(
¬g2
.
	`is_numb”
()) {

2693 ià(
	`©oi
(
¬g2
è!ğ
viùim
->
Ëv–
)

2696 ià(!
viùim
->
Çme
.
	`has_wÜds
(
¬g2
))

2700 
found
 = 
Œue
;

2701 
FÜm©
::
	`¥rštf
(
buf
, "[%5d] %s%*s[%9s] %s\n",

2702 
viùim
->
pIndexD©a
->
vnum
,

2703 
viùim
->
shÜt_desü
,

2704 28 - 
viùim
->
shÜt_desü
.
	`uncŞÜ
().
	`size
(),

2706 
viùim
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
(
çl£
),

2707 
viùim
->
š_room
->
	`Çme
());

2708 
ouut
 +ğ
buf
;

2711 
	`·ge_to_ch¬
(
ouut
, 
ch
);

2713 ià(!
found
) {

2714 ià(
¬g
.
	`is_numb”
())

2715 
	`±c
(
ch
, "You did‚Ù fšd‡ moboàvnum %d.", 
	`©oi
(
¬g
));

2717 
	`aù
("You did‚Ù fšd: $T.", 
ch
, 
nuÎ±r
, 
¬g
, 
TO_CHAR
);

2721 
	}
}

2724 
	$do_rwh”e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2726 
SŒšg
 
dbuf
, 
rbuf
;

2727 
buf
[
MAX_INPUT_LENGTH
], 
âame
[MAX_INPUT_LENGTH];

2728 *
ı
;

2729 
boŞ
 
found
 = 
çl£
;

2731 ià(
¬gum’t
.
	`em±y
()) {

2732 
	`¡c
("rwh”which„oom?\n", 
ch
);

2736 cÚ¡‡uto& 
¬—_·œ
: 
Game
::
	`wÜld
().
¬—s
) {

2737 cÚ¡‡uto& 
·œ
 : 
¬—_·œ
.
£cÚd
->
rooms
) {

2738 cÚ¡ 
RoomID
& 
loÿtiÚ
 = 
·œ
.
fœ¡
;

2739 cÚ¡ 
Room
 *
room
 = 
·œ
.
£cÚd
;

2741 
rbuf
 = 
room
->
	`Çme
();

2743 ià(
rbuf
.
	`uncŞÜ
().
	`has_wÜds
(
¬gum’t
)) {

2744 
found
 = 
Œue
;

2745 
	`¡rıy
(
âame
, 
room
->
	`¬—
().
fe_Çme
);

2746 
ı
 = 
	`¡rchr
(
âame
, '.');

2748 ià(
ı
 !ğ
nuÎ±r
)

2749 *
ı
 = '\0';

2751 
FÜm©
::
	`¥rštf
(
buf
, "[%s] <%-8.8s> %s{x\n", 
loÿtiÚ
.
	`to_¡ršg
(
çl£
), 
âame
, 
room
->
	`Çme
());

2752 
dbuf
 +ğ
buf
;

2757 ià(!
found
)

2758 
dbuf
 += "No matching„ooms found.\n";

2760 
	`·ge_to_ch¬
(
dbuf
, 
ch
);

2761 
	}
}

2763 
	$do_mfšd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2765 
tİ_mob_šdex
;

2766 
buf
[
MAX_STRING_LENGTH
];

2767 
SŒšg
 
ouut
;

2768 
MobePrÙÙy³
 *
pMobIndex
;

2769 
vnum
;

2770 
nM©ch
;

2771 
boŞ
 
fAÎ
;

2772 
boŞ
 
found
;

2774 
SŒšg
 
¬g
;

2775 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

2777 ià(
¬g
.
	`em±y
()) {

2778 
	`¡c
("Fšd whom?\n", 
ch
);

2782 
fAÎ
 = 
çl£
;

2783 
found
 = 
çl£
;

2784 
nM©ch
 = 0;

2792 
vnum
 = 0; 
nM©ch
 < 
tİ_mob_šdex
; vnum++) {

2793 ià((
pMobIndex
 = 
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
vnum
)è!ğ
nuÎ±r
) {

2794 
nM©ch
++;

2796 ià(
fAÎ
 || 
pMobIndex
->
¶ay”_Çme
.
	`has_wÜds
(
¬gum’t
)) {

2797 
found
 = 
Œue
;

2798 
FÜm©
::
	`¥rštf
(
buf
, "M (%3d) [%5d] %s\n",

2799 
pMobIndex
->
Ëv–
,…MobIndex->
vnum
,…MobIndex->
shÜt_desü
);

2800 
ouut
 +ğ
buf
;

2805 
	`·ge_to_ch¬
(
ouut
, 
ch
);

2807 ià(!
found
)

2808 
	`¡c
("NØmobe byh©‚ame.\n", 
ch
);

2811 
	}
}

2813 
	$do_ofšd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2815 
tİ_obj_šdex
;

2816 
buf
[
MAX_STRING_LENGTH
];

2817 
ObjeùPrÙÙy³
 *
pObjIndex
;

2818 
SŒšg
 
ouut
;

2819 
vnum
;

2820 
nM©ch
;

2821 
boŞ
 
fAÎ
;

2822 
boŞ
 
found
;

2824 
SŒšg
 
¬g
;

2825 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

2827 ià(
¬g
.
	`em±y
()) {

2828 
	`¡c
("Fšd wh© objeù?\n", 
ch
);

2833 
fAÎ
 = 
çl£
;

2834 
found
 = 
çl£
;

2835 
nM©ch
 = 0;

2843 
vnum
 = 0; 
nM©ch
 < 
tİ_obj_šdex
; vnum++) {

2844 ià((
pObjIndex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
vnum
)è!ğ
nuÎ±r
) {

2845 
nM©ch
++;

2847 ià(
fAÎ
 || 
pObjIndex
->
Çme
.
	`has_wÜds
(
¬gum’t
)) {

2848 
found
 = 
Œue
;

2849 
FÜm©
::
	`¥rštf
(
buf
, "O (%3d) [%5d] %s\n",

2850 
pObjIndex
->
Ëv–
,…ObjIndex->
vnum
,…ObjIndex->
shÜt_desü
);

2851 
ouut
 +ğ
buf
;

2856 
	`·ge_to_ch¬
(
ouut
, 
ch
);

2858 ià(!
found
)

2859 
	`¡c
("NØobjeù byh©‚ame.\n", 
ch
);

2862 
	}
}

2865 
	$do_vnum
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2867 
SŒšg
 
¬g
;

2868 cÚ¡ *
¡ršg
 = 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

2870 ià(
¬g
.
	`em±y
()) {

2871 
	`¡c
("SyÁax:\n", 
ch
);

2872 
	`¡c
(" vnum obj <Çme>\n", 
ch
);

2873 
	`¡c
(" vnum mob <Çme>\n", 
ch
);

2874 
	`¡c
(" vnum skÈ<skÈÜ s³Î>\n", 
ch
);

2878 ià(
¬g
 == "obj") {

2879 
	`do_ofšd
(
ch
, 
¡ršg
);

2883 ià(
¬g
 == "mob" ||‡rg == "char") {

2884 
	`do_mfšd
(
ch
, 
¡ršg
);

2888 ià(
¬g
 == "skill" ||‡rg == "spell") {

2889 
	`do_¦ookup
(
ch
, 
¡ršg
);

2894 
	`do_mfšd
(
ch
, 
¬gum’t
);

2895 
	`do_ofšd
(
ch
, 
¬gum’t
);

2896 
	}
}

2898 
	$do_ÿnmakebag
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2900 
Ch¬aù”
 *
viùim
;

2902 
SŒšg
 
¬g
;

2903 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

2905 ià(
¬g
.
	`em±y
()) {

2906 
	`¡c
("ChªgÃwb› h–³¸æag oÀwho?", 
ch
);

2910 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

2911 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

2915 ià(
viùim
->
aù_æags
.
	`has
(
PLR_MAKEBAG
)) {

2916 
	`¡c
("You‡»‚ØlÚg”‡ Newb› H–³r.\n", 
viùim
);

2917 
	`¡c
("They‡»‚ØlÚg”‡‚ewb› h–³r.\n", 
ch
);

2918 
viùim
->
aù_æags
 -ğ
PLR_MAKEBAG
;

2922 
	`¡c
("You‡»‚ow‡ Newb› H–³r!! WooWoo!!.\n", 
viùim
);

2923 
	`¡c
("They‡»‚ow‡‚ewb› h–³r.\n", 
ch
);

2924 
viùim
->
aù_æags
 +ğ
PLR_MAKEBAG
;

2927 
	}
}

2930 
	$do_nÜ•ly
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2932 ià(
ch
->
	`is_Åc
())

2935 autØ
wch
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

2936 ià(! 
	`¡rÿ£cmp
(
wch
->
»¶y
, 
ch
->
Çme
))

2937 
wch
->
»¶y
.
	`ş—r
();

2940 
	`¡c
("Nobody cª„•lyØyou‚ow.\n", 
ch
);

2942 
	}
}

2954 
	$do_owÃr
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

2956 
Objeù
 *
™em
;

2957 
Ch¬aù”
 *
¶ay”
 = 
nuÎ±r
;

2958 
ExŒaDesü
 *
ed
;

2960 
SŒšg
 
wh©
, 
whom
;

2961 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
wh©
);

2962 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
whom
);

2964 ià(
wh©
.
	`em±y
()) {

2965 
	`¡c
("Which i‹m dØyou wªˆtØ³rsÚ®ize?\n", 
ch
);

2969 ià((
™em
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
wh©
)è=ğ
nuÎ±r
) {

2970 
	`¡c
("You‡»‚Ù c¬ryšgh©.\n", 
ch
);

2974 ià(
whom
.
	`em±y
()) {

2975 
	`±c
(
ch
, "Whom dØyou wªˆtØ³rsÚ®izth% to?\n", 
™em
->
pIndexD©a
->
shÜt_desü
);

2976 
	`±c
(
ch
, "Ty³ 'owÃ¸% nÚe' iàyou wªˆtØmak™…ublic.\n", 
wh©
);

2980 ià(
whom
 != "none") {

2981 ià((
¶ay”
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
whom
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

2982 
	`¡c
("Th”i nØÚbyh©‚amšh»®m.\n", 
ch
);

2987 ià(
whom
 == "none") {

2988 ià(
™em
->
exŒa_desü
 !ğ
nuÎ±r
) {

2989 
ExŒaDesü
 *
ed_Ãxt
, *
ed_´ev
 = 
nuÎ±r
;

2991 
ed
 = 
™em
->
exŒa_desü
;ƒd !ğ
nuÎ±r
;ƒd = 
ed_Ãxt
) {

2992 
ed_Ãxt
 = 
ed
->
Ãxt
;

2994 ià(
ed
->
keywÜd
 =ğ
KEYWD_OWNER
) {

2995 ià(
ed
 =ğ
™em
->
exŒa_desü
)

2996 
™em
->
exŒa_desü
 = 
ed_Ãxt
;

2998 
ed_´ev
->
Ãxt
 = 
ed_Ãxt
;

3000 
d–‘e
 
ed
;

3003 
ed_´ev
 = 
ed
;

3007 
	`aù
("OK, $ˆnow b–Úg tØnØÚš…¬ticuÏr.", 
ch
, 
™em
->
shÜt_desü
, 
nuÎ±r
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

3012 ià(
™em
->
exŒa_desü
 !ğ
nuÎ±r
) {

3013 
ExŒaDesü
 *
ed_Ãxt
;

3015 
ed
 = 
™em
->
exŒa_desü
;ƒd !ğ
nuÎ±r
;ƒd = 
ed_Ãxt
) {

3016 
ed_Ãxt
 = 
ed
->
Ãxt
;

3018 ià(
ed
->
keywÜd
 =ğ
KEYWD_OWNER
) {

3019 
	`±c
(
ch
, "Thi ™em i ®»ady owÃd by %s.\n", 
ed
->
desütiÚ
);

3025 
	`aù
("OK, $ˆnow b–Úg tØ$N.", 
ch
, 
™em
->
shÜt_desü
, 
¶ay”
, 
TO_CHAR
, 
POS_DEAD
, 
çl£
);

3026 
ed
 = 
Ãw
 
	`ExŒaDesü
(
KEYWD_OWNER
, 
¶ay”
->
Çme
);

3027 
ed
->
Ãxt
 = 
™em
->
exŒa_desü
;

3028 
™em
->
exŒa_desü
 = 
ed
;

3029 
	}
}

3031 
	$do_³aû
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3033 
Ch¬aù”
 *
rch
;

3035 
rch
 = 
ch
->
š_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
) {

3036 ià(
rch
->
fightšg
 !ğ
nuÎ±r
)

3037 
	`¡İ_fightšg
(
rch
, 
Œue
);

3039 ià(
rch
->
	`is_Åc
(è&&„ch->
aù_æags
.
	`has
(
ACT_AGGRESSIVE
))

3040 
rch
->
aù_æags
 -ğ
ACT_AGGRESSIVE
;

3043 
	`¡c
("Throom i sudd’ly¿nqu.\n", 
ch
);

3045 
	}
}

3047 
	$do_purge
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3049 
buf
[
MAX_STRING_LENGTH
];

3050 
Ch¬aù”
 *
viùim
;

3051 
Objeù
 *
obj
;

3052 
DesütÜ
 *
d
;

3054 
SŒšg
 
¬g
;

3055 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

3057 ià(
¬g
.
	`em±y
()) {

3058 
Ch¬aù”
 *
vÃxt
;

3059 
Objeù
 *
obj_Ãxt
;

3061 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = 
vÃxt
) {

3062 
vÃxt
 = 
viùim
->
Ãxt_š_room
;

3064 ià(
viùim
->
	`is_Åc
()

3065 && !
viùim
->
aù_æags
.
	`has
(
ACT_NOPURGE
)

3066 && 
viùim
 !ğ
ch
)

3067 
	`exŒaù_ch¬
(
viùim
, 
Œue
);

3070 
obj
 = 
ch
->
š_room
->
cÚ‹Ás
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

3071 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

3073 ià(!
	`IS_OBJ_STAT
(
obj
, 
ITEM_NOPURGE
))

3074 
	`exŒaù_obj
(
obj
);

3077 
FÜm©
::
	`¥rštf
(
buf
, "$N ha purged„oom: %s.", 
ch
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
());

3078 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_PURGE
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

3079 
	`aù
("$Àpurge throom oà®Èobjeùs!", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3080 
	`¡c
("Throom ha b“Àpurged.\n", 
ch
);

3084 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

3085 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

3089 ià(!
viùim
->
	`is_Åc
()) {

3090 ià(
ch
 =ğ
viùim
) {

3091 
	`¡c
("'Qu™' usu®ly wÜk b‘‹r.\n", 
ch
);

3095 ià(!
	`OUTRANKS
(
ch
, 
viùim
è&& !viùim->
pcd©a
->
¶r_æags
.
	`has
(
PLR_LINK_DEAD
)) {

3096 
FÜm©
::
	`¥rštf
(
buf
, "$N ha Œ›dØpurgthimmÜl: %s", 
viùim
->
Çme
);

3097 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_PURGE
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

3098 
	`¡c
("Maybth© wa¢'ˆ¨good id—...\n", 
ch
);

3099 
	`±c
(
viùim
, "% ju¡r›dØpurgyou!\n", 
ch
->
Çme
);

3103 
FÜm©
::
	`¥rštf
(
buf
, "$N ha purgedh¶ay”: %s", 
viùim
->
Çme
);

3104 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_PURGE
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

3105 
	`aù
("$Àdisš‹g¿‹ $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

3106 
	`aù
("You disš‹g¿‹ $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3108 ià(
viùim
->
Ëv–
 > 1)

3109 
	`§ve_ch¬_obj
(
viùim
);

3111 
d
 = 
viùim
->
desc
;

3112 
	`exŒaù_ch¬
(
viùim
, 
Œue
);

3114 ià(
d
 !ğ
nuÎ±r
)

3115 
	`şo£_sock‘
(
d
);

3120 ià(
	`g‘_mob_h”e
(
ch
, 
viùim
->
Çme
, 
VIS_CHAR
è=ğ
nuÎ±r
) {

3121 
	`¡c
("Th”¬nØmobe šhi room byh©‚ame.\n", 
ch
);

3125 
FÜm©
::
	`¥rštf
(
buf
, "$N ha purgedhmobe: %s", 
viùim
->
shÜt_desü
);

3126 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_PURGE
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

3127 
	`aù
("$Àdisš‹g¿‹ $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

3128 
	`aù
("You disš‹g¿‹ $N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3129 
	`exŒaù_ch¬
(
viùim
, 
Œue
);

3130 
	}
}

3132 
	$has_’ough_qps
(
Ch¬aù”
 *
ch
, 
numb”_of
)

3134 ià(
ch
->
	`is_Åc
())

3137 ià(
ch
->
pcd©a
->
que¡pošts
 >ğ
numb”_of
 || 
	`IS_IMMORTAL
(ch))

3141 
	}
}

3143 
	$do_qpcÚv
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3145 
numb”_of
 = 0, 
qpco¡
 = 0, 
wh©
 = 0;

3146 
bufãr
[1024];

3147 
Ch¬aù”
 *
viùim
;

3149 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
;

3150 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

3151 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

3152 
¬g3
 = 
¬gum’t
;

3154 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.em±y(è|| 
¬g3
.empty()) {

3155 
	`¡c
("SyÁax: qpcÚv <ch¬aù”> <Œaš|´ac> <numb” of>.\n", 
ch
);

3159 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g1
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

3160 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

3164 ià(
viùim
->
	`is_Åc
()) {

3165 
	`¡c
("NÙ oÀNPC's.\n", 
ch
);

3169 
numb”_of
 = 
	`©oi
(
¬g3
);

3171 ià(
numb”_of
 <= 0) {

3172 
	`¡c
("Try‡‚umb” g»©”h’ 0.\n", 
ch
);

3176 ià(
numb”_of
 > 10) {

3177 
	`¡c
("G‘„—l!\n", 
ch
);

3181 ià(
¬g2
 == "train") {

3182 
qpco¡
 = 
numb”_of
 * 
QPS_PER_TRAIN
;

3183 
wh©
 = 1;

3186 ià(
¬g2
 == "practice") {

3187 
qpco¡
 = 
numb”_of
 * 
QPS_PER_PRAC
;

3188 
wh©
 = 2;

3191 ià(
wh©
 == 0) {

3192 
	`¡c
("{x I dÚ'ˆund”¡ªd wh© you‡»ryšgØcÚv”t.. u£ 'Œaš' o¸'´aùiû'.\n", 
ch
);

3196 ià(
	`has_’ough_qps
(
viùim
, 
qpco¡
) == 0) {

3197 
FÜm©
::
	`¥rštf
(
bufãr
, "{x% dÛ¢'ˆ£emØhav’oughh»quœed %d que¡pošts.\n", 
viùim
->
Çme
, 
qpco¡
);

3198 
	`¡c
(
bufãr
, 
ch
);

3202 ià(!
	`IS_IMMORTAL
(
ch
))

3203 
viùim
->
pcd©a
->
que¡pošts
 -ğ
qpco¡
;

3205 
wh©
) {

3207 
viùim
->
Œaš
 +ğ
numb”_of
;

3211 
viùim
->
´aùiû
 +ğ
numb”_of
;

3215 
FÜm©
::
	`¥rštf
(
bufãr
, "{x%d que¡pošt deduùed, %d %s%§dded.\n", 
qpco¡
, 
numb”_of
, (
wh©
 == 1) ? "train" : "practice",

3216 (
numb”_of
) > 1 ? "s " : " ");

3217 
	`¡c
(
bufãr
, 
viùim
);

3218 
	`¡c
("{xCÚv”siÚ wa sucûssful.\n", 
ch
);

3220 
	}
}

3222 
	$»¡Üe_ch¬
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
)

3224 
afãù
::
	`»move_ty³_äom_ch¬
(
viùim
,‡fãù::
ty³
::
¶ague
);

3225 
afãù
::
	`»move_ty³_äom_ch¬
(
viùim
,‡fãù::
ty³
::
poisÚ
);

3226 
afãù
::
	`»move_ty³_äom_ch¬
(
viùim
,‡fãù::
ty³
::
blšdÃss
);

3227 
afãù
::
	`»move_ty³_äom_ch¬
(
viùim
,‡fãù::
ty³
::
dœt_kickšg
);

3228 
afãù
::
	`»move_ty³_äom_ch¬
(
viùim
,‡fãù::
ty³
::
fœe_b»©h
);

3229 
afãù
::
	`»move_ty³_äom_ch¬
(
viùim
,‡fãù::
ty³
::
¦“p
);

3230 
afãù
::
	`»move_ty³_äom_ch¬
(
viùim
,‡fãù::
ty³
::
cur£
);

3231 
afãù
::
	`»move_ty³_äom_ch¬
(
viùim
,‡fãù::
ty³
::
ã¬
);

3232 
viùim
->
h™
 = 
	`GET_MAX_HIT
(victim);

3233 
viùim
->
mªa
 = 
	`GET_MAX_MANA
(victim);

3234 
viùim
->
¡am
 = 
	`GET_MAX_STAM
(victim);

3235 
	`upd©e_pos
(
viùim
);

3236 
	`aù
("$Àha »¡Üed you.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
, 
POS_SLEEPING
, 
çl£
);

3237 
	}
}

3239 
	$do_»¡Üe
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3241 
buf
[
MAX_STRING_LENGTH
];

3242 
Ch¬aù”
 *
viùim
;

3243 
DesütÜ
 *
d
;

3245 
SŒšg
 
¬g
;

3246 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

3248 ià(
¬g
.
	`em±y
() ||‡rg == "room") {

3250 
viùim
 = 
ch
->
š_room
->
³İË
; viùim !ğ
nuÎ±r
; viùim = viùim->
Ãxt_š_room
)

3251 
	`»¡Üe_ch¬
(
ch
, 
viùim
);

3253 
FÜm©
::
	`¥rštf
(
buf
, "$N ha »¡Üed„oom: %s.", 
ch
->
š_room
->
loÿtiÚ
.
	`to_¡ršg
());

3254 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_RESTORE
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

3255 
	`¡c
("Room„e¡Üed.\n", 
ch
);

3259 ià(
¬g
 == "all") {

3261 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
)

3262 ià(
d
->
ch¬aù”
 !ğ
nuÎ±r
 && !d->ch¬aù”->
	`is_Åc
())

3263 
	`»¡Üe_ch¬
(
ch
, 
d
->
ch¬aù”
);

3265 
	`¡c
("AÎ…Ïy” »¡Üed.\n", 
ch
);

3266 
	`wizÃt
("$N ha »¡Üed‡Î.", 
ch
, 
nuÎ±r
, 
WIZ_RESTORE
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

3270 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

3271 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

3275 
	`»¡Üe_ch¬
(
ch
, 
viùim
);

3276 
FÜm©
::
	`¥rštf
(
buf
, "$N ha »¡Üed: %s", 
viùim
->
	`is_Åc
(è? viùim->
shÜt_desü
 : viùim->
Çme
);

3277 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_RESTORE
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

3278 
	`¡c
("Th¶ay” ha b“À»¡Üed.\n", 
ch
);

3279 
	}
}

3282 
	$do_£cu»
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3284 
SŒšg
 
¬g
;

3285 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

3287 ià(
¬g
.
	`em±y
(è||‡rg.
	`is_´efix_of
("immortal")) {

3288 
ch
->
£cu»_Ëv–
 = 
RANK_IMM
;

3289 
	`¡c
("AÎ immÜl ÿÀ£you¸immlk now.\n", 
ch
);

3291 ià(
¬g
.
	`is_´efix_of
("head") ||‡rg.is_prefix_of("deputy")) {

3292 
ch
->
£cu»_Ëv–
 = 
RANK_HEAD
;

3293 
	`¡c
("OÆy h—d oàd•¬tm’t ªd im¶em’tÜ ÿÀ£you¸immlk now.\n", 
ch
);

3295 ià(
¬g
.
	`is_´efix_of
("im¶em’tÜ"è&& 
	`IS_IMP
(
ch
)) {

3296 
ch
->
£cu»_Ëv–
 = 
RANK_IMP
;

3297 
	`¡c
("OÆy im¶em’tÜ ÿÀ£you¸immlk now.\n", 
ch
);

3300 
	`¡c
("Syntax:\n"

3302 " secu» h—d\n", 
ch
);

3304 ià(
	`IS_IMP
(
ch
))

3305 
	`¡c
(" secu» imp\n", 
ch
);

3307 
	}
}

3310 
	$£tgamešout
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
, cÚ¡ SŒšg& 
’Œyex™
, 
æag
)

3312 
Ch¬aù”
 *
viùim
;

3313 
SŒšg
 *
msg±r
;

3315 
SŒšg
 
¬g
;

3316 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

3318 ià(
¬g
.
	`em±y
()) {

3319 
	`aù
("S‘ gam$ˆmes§gfÜ whom?", 
ch
, 
’Œyex™
, 
nuÎ±r
, 
TO_CHAR
);

3323 
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
);

3325 ià(
viùim
 =ğ
nuÎ±r
) {

3326 
	`aù
("NØ¶ay”‚amed '$t' found iÀthgame!", 
ch
, 
¬g
, 
nuÎ±r
, 
TO_CHAR
);

3330 ià(
æag
 == 'I')

3331 
msg±r
 = &
viùim
->
pcd©a
->
gameš
;

3333 
msg±r
 = &
viùim
->
pcd©a
->
gameout
;

3335 ià(
¬gum’t
.
	`em±y
()) {

3336 
msg±r
->
	`”a£
();

3337 
	`aù
("OK, $N‚o†onger has‡ game $t string",

3338 
ch
, 
’Œyex™
, 
viùim
, 
TO_CHAR
);

3340 ià(
¬gum’t
.
	`uncŞÜ
().
	`size
() > 70) {

3341 
	`aù
("This message isoo†ong. Pleaseryohink of something shorter!",

3342 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_CHAR
);

3343 
	`¡c
("THIS i how†Úghmes§gi ®lowedØbe:\n", 
ch
);

3344 
	`aù
("setgamein $N -----------------------------------"

3345 "-----------------------------------", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

3349 *
msg±r
 = 
¬gum’t
;

3350 
	`aù
("OK, gam$ˆmes§g£t", 
ch
, 
’Œyex™
, 
nuÎ±r
, 
TO_CHAR
);

3352 
	}
}

3355 
	$do_£tgameš
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3357 
	`£tgamešout
(
ch
, 
¬gum’t
, "entry", 'I');

3358 
	}
}

3361 
	$do_£tgameout
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3363 
	`£tgamešout
(
ch
, 
¬gum’t
, "exit", 'O');

3364 
	}
}

3367 
	$wr™e_smack
(
Ch¬aù”
 *
viùim
)

3369 ià(
viùim
->
aù_æags
.
	`has
(
PLR_COLOR
)) {

3370 
	`£t_cŞÜ
(
viùim
, 
RED
, 
NOBOLD
);

3371 
	`£t_cŞÜ
(
viùim
, 
GREY
, 
REVERSE
);

3372 
	`¡c
("Oh C¿p!! You'vgÚªd…is£d ofàthImm =).\n", 
viùim
);

3373 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

3374 
	`¡c
("\n", 
viùim
);

3375 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
BLINK
);

3376 
	`£t_cŞÜ
(
viùim
, 
RED
, 
BOLD
);

3377 
	`¡c
(" SSSS MMMM MMMM AAAA CCCC KK KK |||\n", 
viùim
);

3378 
	`£t_cŞÜ
(
viùim
, 
YELLOW
, 
BOLD
);

3379 
	`¡c
("SSS SS MMMMMMMMMMMM AAAAAA CCCCCC KK KK |||\n", 
viùim
);

3380 
	`£t_cŞÜ
(
viùim
, 
GREEN
, 
BOLD
);

3381 
	`¡c
("SSS MM MM MM AA AA CC KKKK |||\n", 
viùim
);

3382 
	`£t_cŞÜ
(
viùim
, 
CYAN
, 
BOLD
);

3383 
	`¡c
(" SSS MM MM MM AAAAAA CC KKKK |||\n", 
viùim
);

3384 
	`£t_cŞÜ
(
viùim
, 
BLUE
, 
BOLD
);

3385 
	`¡c
("SS SSS MM MM MM AA AA CCCCCC KK KK |||\n", 
viùim
);

3386 
	`£t_cŞÜ
(
viùim
, 
PURPLE
, 
BOLD
);

3387 
	`¡c
(" SSSS MM MM MM AA AA CCCC KK KK OOO\n", 
viùim
);

3388 
	`£t_cŞÜ
(
viùim
, 
WHITE
, 
NOBOLD
);

3390 
	`¡c
("Oh C¿p!! You'vgÚªd…is£d ofàthImm =).\n", 
viùim
);

3391 
	`¡c
("\n", 
viùim
);

3392 
	`¡c
(" SSSS MMMM MMMM AAAA CCCC KK KK |||\n", 
viùim
);

3393 
	`¡c
("SSS SS MMMMMMMMMMMM AAAAAA CCCCCC KK KK |||\n", 
viùim
);

3394 
	`¡c
("SSS MM MM MM AA AA CC KKKK |||\n", 
viùim
);

3395 
	`¡c
(" SSS MM MM MM AAAAAA CC KKKK |||\n", 
viùim
);

3396 
	`¡c
("SS SSS MM MM MM AA AA CCCCCC KK KK |||\n", 
viùim
);

3397 
	`¡c
(" SSSS MM MM MM AA A CCCC KK KK OOO\n", 
viùim
);

3400 
	}
}

3404 
	$do_sm™e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3406 
Ch¬aù”
 *
viùim
;

3408 ià(
¬gum’t
.
	`em±y
()) {

3409 
	`¡c
("WhØde£rve tØbsm™‹n?.\n", 
ch
);

3412 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬gum’t
, 
Œue
)è=ğ
nuÎ±r
) {

3413 
	`¡c
("They‡»‚Ù h”e, *sigh*.\n", 
ch
);

3422 ià(
viùim
->
fightšg
 !ğ
nuÎ±r
)

3423 
	`¡İ_fightšg
(
viùim
, 
Œue
);

3425 
	`aù
("$Àsmack thü­ ouˆoà$N.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

3426 
	`aù
("$Àsmack thü­ ouˆoàyou!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

3428 
	`wr™e_smack
(
viùim
);

3429 
	`¡c
("Ouch!! Th© hadØhu¹!\n", 
ch
);

3431 
viùim
->
pos™iÚ
 = 
POS_RESTING
;

3433 
SŒšg
 
Çme
 = 
viùim
->
	`is_Åc
(è? viùim->
shÜt_desü
 : victim->name;

3434 
Objeù
 *
doo
 = 
	`ü—‹_objeù
(
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
OBJ_VNUM_DOO
), 0);

3435 
doo
->
tim”
 = 
	`numb”_¿nge
(8, 14);

3436 
doo
->
v®ue
[3] = 1;

3438 
doo
->
shÜt_desü
 = 
FÜm©
::
	`fÜm©
(doo->shÜt_desü, 
Çme
);

3439 
doo
->
desütiÚ
 = 
FÜm©
::
	`fÜm©
(doo->desütiÚ, 
Çme
);

3441 
	`obj_to_room
(
doo
, 
viùim
->
š_room
);

3442 
	}
}

3444 
	$do_sock‘s
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3446 
DesütÜ
 *
d
, *
dmuÉ
;

3447 
SŒšg
 
bufãr
;

3448 
s
[100];

3449 
boŞ
 
muÉÏy
 = 
çl£
;

3450 
couÁ
 = 0, 
ldcouÁ
 = 0;

3452 
SŒšg
 
¬g
;

3453 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

3454 
bufãr
 += "\n{PNum{x|{YConnected_State{x| {BLogin{x |{CIdl{x|{GPlayer Name{x|{WHost{x\n";

3455 
bufãr
 += "---|---------------|-------|---|------------|-------------------------\n";

3457 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

3458 
SŒšg
 
¡©us
;

3459 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
¶ayšg
è
¡©us
 = " Playing ";

3460 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
g‘Name
è
¡©us
 = " Ask Name ";

3461 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
g‘OldPass
è
¡©us
 = " Ask Password ";

3462 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
cÚfœmNewName
è
¡©us
 = " Confirm Name ";

3463 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
g‘MudExp
è
¡©us
 = " Ask Exp ";

3464 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
g‘NewPass
è
¡©us
 = " Ask New Pass ";

3465 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
cÚfœmNewPass
è
¡©us
 = " Confirm Pass ";

3466 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
g‘Raû
è
¡©us
 = " Ask Race ";

3467 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
rŞlSts
è
¡©us
 = " Roll Stats ";

3468 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
g‘Sex
è
¡©us
 = " Ask Sex ";

3469 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
g‘Gud
è
¡©us
 = " Ask Class ";

3470 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
g‘Alignm’t
è
¡©us
 = " Ask Align ";

3471 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
g‘De™y
è
¡©us
 = " Ask Deity ";

3472 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
g‘W—pÚ
è
¡©us
 = " Pick Weapon ";

3473 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
»adIMOTD
è
¡©us
 = " Imotd ";

3474 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
»adMOTD
è
¡©us
 = " Motd ";

3475 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
»adNewMOTD
è
¡©us
 = " New Motd ";

3476 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
b»akCÚÃù
è
¡©us
 = " Break Connect ";

3477 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
cİyov”Recov”
è
¡©us
 = " Copyover ";

3478 
¡©us
 = " Unknown ";

3480 ià(
d
->
ch¬aù”
 =ğ
nuÎ±r
) {

3482 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("{P%3d{x|{Y%s{x| |{C%2d{x |{G%-12s{x|{W%s{x\n",

3483 
d
->
desütÜ
,

3484 
¡©us
,

3485 
¡d
::
	`max
(0, 
d
->
tim”
),

3486 
d
->
Üigš®
 ? d->Üigš®->
Çme
 :

3487 
d
->
ch¬aù”
 ? d->ch¬aù”->
Çme
 : "(none)",

3488 
d
->
ho¡
);

3490 ià(
	`ÿn_£e_ch¬
(
ch
, 
d
->
ch¬aù”
)

3491 && (
¬g
.
	`em±y
()

3492 || 
d
->
ch¬aù”
->
Çme
.
	`has_wÜds
(
¬g
)

3493 || (
d
->
Üigš®
 && d->Üigš®->
Çme
.
	`has_wÜds
(
¬g
)))) {

3494 
couÁ
++;

3496 
muÉÏy
 = 
çl£
;

3498 ià(
d
->
¡©e
 =ğ&
cÚn
::
S‹
::
¶ayšg
)

3499 
dmuÉ
 = 
desütÜ_li¡
; dmuÉ !ğ
nuÎ±r
; dmuÉ = dmuÉ->
Ãxt
) {

3500 ià(
dmuÉ
 =ğ
d
 || dmuÉ->
¡©e
 !ğ&
cÚn
::
S‹
::
¶ayšg
)

3503 ià(
dmuÉ
->
ho¡
 =ğ
d
->host)

3504 
muÉÏy
 = 
Œue
;

3508 
Ch¬aù”
 *
vch
 = 
d
->
Üigš®
 ? d->Üigš® : d->
ch¬aù”
;

3509 
	`¡ráime
(
s
, 100, "%I:%M%p", 
	`loÿÉime
(&
vch
->
logÚ
));

3510 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("{P%3d{x|{Y%s{x|{B%7s{x|{C%2d{x |{G%-12s{x%s%s{x\n",

3511 
d
->
desütÜ
,

3512 
¡©us
,

3513 
s
,

3514 
¡d
::
	`max
(0, 
d
->
tim”
),

3515 
d
->
Üigš®
 ? d->Üigš®->
Çme
 :

3516 
d
->
ch¬aù”
 ? d->ch¬aù”->
Çme
 : "(none)",

3517 
muÉÏy
 ? "|{P" : "|{W",

3518 
d
->
ho¡
);

3522 
bufãr
 += "---|---------------|-------|---|------------|-------------------------\n";

3525 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

3526 ià(!
viùim
->
	`is_Åc
()

3527 && 
viùim
 !ğ
ch


3528 && 
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_LINK_DEAD
)

3529 && 
	`ÿn_£e_ch¬
(
ch
, 
viùim
)

3530 && (
¬g
.
	`em±y
()

3531 || 
viùim
->
Çme
.
	`has_wÜds
(
¬g
))) {

3532 
	`¡ráime
(
s
, 100, "%I:%M%p", 
	`loÿÉime
(&
viùim
->
logÚ
));

3533 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("{P---{x|{Y Linkdead {x|{B%7s{x|{C%-2d{x |{G%-12s{x|{W%s{x\n",

3534 
s
,

3535 
¡d
::
	`max
(0, 
viùim
->
desc
 =ğ
nuÎ±r
 ? viùim->
tim”
 : victim->desc->timer),

3536 
viùim
->
Çme
,

3537 
viùim
->
pcd©a
->
Ï¡_ls™e
);

3538 
ldcouÁ
++;

3542 ià(
ldcouÁ
)

3543 
bufãr
 += "---|---------------|-------|---|------------|-------------------------\n";

3545 ià(!
couÁ
 && !
ldcouÁ
) {

3546 ià(
¬g
.
	`em±y
())

3547 
	`¡c
("NØÚi cÚÃùed...\n", 
ch
);

3549 
	`¡c
("NØÚbyh©‚ami cÚÃùed.\n", 
ch
);

3554 
bufãr
 +ğ
FÜm©
::
	`fÜm©
("%d u£r% cÚÃùed", 
couÁ
, count == 1 ? "" : "s");

3556 ià(
ldcouÁ
)

3557 
bufãr
 +ğ
FÜm©
::
	`fÜm©
(", %d u£r% lškd—d.\n", 
ldcouÁ
,†dcount == 1 ? "" : "s");

3559 
bufãr
 += ".\n";

3561 
	`·ge_to_ch¬
(
bufãr
, 
ch
);

3562 
	}
}

3564 
	$do_¡Üage
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3566 
StÜedPÏy”
 *
i
;

3568 ià(
¬gum’t
.
	`em±y
()) {

3569 
	`¡c
("Syntax:\n"

3572 " stÜag»Œ›v<¶ay”> (»Œ›ve ¨ch¬aù” from stÜage)\n", 
ch
);

3576 
SŒšg
 
¬g1
;

3577 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

3579 ià(
¬g1
 == "list") {

3580 
	`¡c
("Currently in storage‡re:\n"

3583 "--------------------+--------------------+------------------------\n", 
ch
);

3584 
i
 = 
¡Üage_li¡_h—d
->
Ãxt
;

3586 
i
 !ğ
¡Üage_li¡_
) {

3587 
	`±c
(
ch
, "%20s|%20s|%s\n", 
i
->
Çme
,

3588 
i
->
by_who
,

3589 
i
->
d©e
);

3590 
i
 = i->
Ãxt
;

3596 ià(
¬g1
 == "store") {

3597 
pfe_buf
[128];

3598 
¡Üage_buf
[128];

3599 
commªd_buf
[255];

3600 
FILE
 *
å
;

3601 
StÜedPÏy”
 *
Ãwd©a
;

3603 ià(
¬gum’t
.
	`em±y
()) {

3604 
	`¡c
("StÜwho?\n", 
ch
);

3608 ià(
	`lookup_¡Üage_d©a
(
¬gum’t
è!ğ
nuÎ±r
) {

3609 
	`¡c
("Th© ch¬aù” i ®»ady iÀ¡Üage!\n", 
ch
);

3613 
FÜm©
::
	`¥rštf
(
pfe_buf
, "%s%s", 
PLAYER_DIR
, 
¬gum’t
.
	`low”ÿ£
().
	`ÿp™®ize
());

3614 
FÜm©
::
	`¥rštf
(
¡Üage_buf
, "%s%s", 
STORAGE_DIR
, 
¬gum’t
.
	`low”ÿ£
().
	`ÿp™®ize
());

3616 ià((
å
 = 
	`fİ’
(
pfe_buf
, "r")è=ğ
nuÎ±r
) {

3617 
	`¡c
("NØsuch ch¬aù”!\n", 
ch
);

3621 
	`fşo£
(
å
);

3622 
FÜm©
::
	`¥rštf
(
commªd_buf
, "mv % %s", 
pfe_buf
, 
¡Üage_buf
);

3624 ià(
	`sy¡em
(
commªd_buf
) != 0) {

3625 
	`±c
(
ch
, "E¼ÜryšgØmov% štØ¡Üage!.\n", 
¬gum’t
);

3629 
Ãwd©a
 = 
Ãw
 
StÜedPÏy”
;

3630 
Ãwd©a
->
Çme
 = 
¬gum’t
.
	`ÿp™®ize
();

3631 
Ãwd©a
->
by_who
 = 
ch
->
Çme
;

3632 
Ãwd©a
->
d©e
 = 
	`ùime
(&
Game
::
cu¼’t_time
);

3633 
Ãwd©a
->
d©e
[
	`¡¾’
(newdata->date) - 1] = '\0';

3634 
	`š£¹_¡Üaged©a
(
Ãwd©a
);

3635 
	`§ve_¡Üage_li¡
();

3636 
	`±c
(
ch
, "Ch¬aù” % sucûssfuÎy…uˆštØ¡Üage.\n", 
¬gum’t
.
	`ÿp™®ize
());

3640 ià(
¬g1
 == "retrieve") {

3641 
pfe_buf
[128];

3642 
¡Üage_buf
[128];

3643 
commªd_buf
[255];

3644 
StÜedPÏy”
 *
Şdd©a
;

3646 ià(
¬gum’t
.
	`em±y
()) {

3647 
	`¡c
("StÜwho?\n", 
ch
);

3651 
Şdd©a
 = 
	`lookup_¡Üage_d©a
(
¬gum’t
);

3653 ià(
Şdd©a
 =ğ
nuÎ±r
) {

3654 
	`¡c
("NØsuch ch¬aù” i cu¼’y iÀ¡Üage!\n", 
ch
);

3658 
FÜm©
::
	`¥rštf
(
pfe_buf
, "%s%s", 
PLAYER_DIR
, 
¬gum’t
.
	`low”ÿ£
().
	`ÿp™®ize
());

3659 
FÜm©
::
	`¥rštf
(
¡Üage_buf
, "%s%s", 
STORAGE_DIR
, 
¬gum’t
.
	`low”ÿ£
().
	`ÿp™®ize
());

3660 
FÜm©
::
	`¥rštf
(
commªd_buf
, "mv % %s", 
¡Üage_buf
, 
pfe_buf
);

3662 ià(
	`sy¡em
(
commªd_buf
) == 0) {

3663 
	`±c
(
ch
, "% ha sucûssfuÎy b“À»moved from stÜage.\n", 
¬gum’t
.
	`ÿp™®ize
());

3664 
	`»move_¡Üaged©a
(
Şdd©a
);

3665 
	`§ve_¡Üage_li¡
();

3668 
	`±c
(
ch
, "E¼Ü whŒyšgØ»Œ›v'%s'.\n", 
¬gum’t
.
	`ÿp™®ize
());

3673 
	`do_¡Üage
(
ch
, "");

3674 
	}
}

3676 
	$do_švis
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3679 ià(
ch
->
švis_Ëv–
) {

3680 
ch
->
švis_Ëv–
 = 0;

3681 
	`aù
("$À¦owly fade štØexi¡’û.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3682 
	`¡c
("You slowly fadback iÁØexi¡’û.\n", 
ch
);

3685 
ch
->
švis_Ëv–
 = 
LEVEL_IMMORTAL
;

3686 
	`aù
("$À¦owly fade štØthš‡œ.", 
ch
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3687 
	`¡c
("You slowly vªish iÁØthš‡œ.\n", 
ch
);

3689 
	}
}

3691 
	$do_su³rwiz
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3693 ià(
ch
->
aù_æags
.
	`has
(
PLR_SUPERWIZ
)) {

3694 
	`¡c
("You„‘uºØ»®™y.\n", 
ch
);

3695 
ch
->
aù_æags
 -ğ
PLR_SUPERWIZ
;

3698 
	`¡c
("You vªish fromƒxi¡’û.\n", 
ch
);

3699 
ch
->
aù_æags
 +ğ
PLR_SUPERWIZ
;

3701 
	}
}

3703 
Room
 *
	$fšd_loÿtiÚ
(
Ch¬aù”
 *
ch
, cÚ¡ 
SŒšg
& 
¬g
)

3705 
Ch¬aù”
 *
viùim
;

3706 
Objeù
 *
obj
;

3708 
Room
 *
room
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
¬g
));

3710 ià(
room
 !ğ
nuÎ±r
)

3711  
room
;

3713 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g
, 
VIS_CHAR
)è!ğ
nuÎ±r
)

3714  
viùim
->
š_room
;

3716 ià((
obj
 = 
	`g‘_obj_wÜld
(
ch
, 
¬g
)è!ğ
nuÎ±r
)

3717  
obj
->
š_room
;

3719  
nuÎ±r
;

3720 
	}
}

3722 
	$do_Œªsãr
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3724 
Room
 *
loÿtiÚ
;

3725 
DesütÜ
 *
d
;

3726 
Ch¬aù”
 *
viùim
;

3728 
SŒšg
 
¬g1
, 
¬g2
;

3729 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

3730 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

3732 ià(
¬g1
.
	`em±y
()) {

3733 
	`¡c
("T¿nsã¸whom (ªd wh”e)?\n", 
ch
);

3737 ià(
¬g1
 == "all") {

3738 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

3739 ià(
d
->
	`is_¶ayšg
()

3740 && 
d
->
ch¬aù”
 !ğ
ch


3741 && 
d
->
ch¬aù”
->
š_room
 !ğ
nuÎ±r


3742 && 
	`ÿn_£e_ch¬
(
ch
, 
d
->
ch¬aù”
)) {

3743 
buf
[
MAX_STRING_LENGTH
];

3744 
FÜm©
::
	`¥rštf
(
buf
, "% %s", 
d
->
ch¬aù”
->
Çme
, 
¬g2
);

3745 
	`do_Œªsãr
(
ch
, 
buf
);

3755 ià(
¬g2
.
	`em±y
())

3756 
loÿtiÚ
 = 
ch
->
š_room
;

3758 ià((
loÿtiÚ
 = 
	`fšd_loÿtiÚ
(
ch
, 
¬g2
)è=ğ
nuÎ±r
) {

3759 
	`¡c
("NØsuch†oÿtiÚ.\n", 
ch
);

3763 ià(!
	`is_room_owÃr
(
ch
, 
loÿtiÚ
è&&†oÿtiÚ->
	`is_´iv©e
()

3764 && !
	`IS_IMP
(
ch
)) {

3765 
	`¡c
("Th©„oom i ´iv©e.\n", 
ch
);

3770 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g1
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

3771 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

3775 ià(!
viùim
->
	`is_Åc
(è&& 
	`IS_IMMORTAL
(viùimè&& !
	`IS_IMP
(
ch
)) {

3776 
	`¡c
("They wouldn'ˆlikth©.\n", 
ch
);

3780 ià(
viùim
->
š_room
 =ğ
nuÎ±r
) {

3781 
	`¡c
("They‡» iÀlimbo.\n", 
ch
);

3785 ià(
viùim
->
fightšg
 !ğ
nuÎ±r
)

3786 
	`¡İ_fightšg
(
viùim
, 
Œue
);

3788 
	`aù
("$Àsü—m a $i sucked ofàštØthşouds.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3789 
	`ch¬_äom_room
(
viùim
);

3790 
	`ch¬_to_room
(
viùim
, 
loÿtiÚ
);

3791 
	`aù
("$Àb»ak throughhşoud ªd c¿sh†ªd © you¸ã‘.", 
viùim
, 
nuÎ±r
,‚uÎ±r, 
TO_ROOM
);

3793 ià(
ch
 !ğ
viùim
)

3794 
	`±c
(
viùim
, "% ha Œª¥Ü‹d you.\n", 
	`PERS
(
ch
, viùim, 
VIS_CHAR
).
	`ÿp™®ize
());

3796 
	`do_look
(
viùim
, "auto");

3797 
	`¡c
("T¿nsã¸Sucûssful.\n", 
ch
);

3798 
	}
}

3800 
	$do_viŞ©e
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3802 
Objeù
 *
obj
;

3803 
Room
 *
loÿtiÚ
 = 
nuÎ±r
;

3804 
Ch¬aù”
 *
rch
;

3806 ià(
¬gum’t
.
	`em±y
()) {

3807 
	`¡c
("Which…riv©room dØyou wishØviŞ©e?\n", 
ch
);

3811 
SŒšg
 
¬g
;

3812 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

3814 
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
¬gum’t
));

3816 ià(
loÿtiÚ
 =ğ
nuÎ±r
) {

3817 ià((
rch
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬gum’t
, 
VIS_CHAR
)è!ğ
nuÎ±r
)

3818 
loÿtiÚ
 = 
rch
->
š_room
;

3820 ià(
¬g
.
	`is_´efix_of
("objeù"è|| 
loÿtiÚ
 =ğ
nuÎ±r
) {

3821 
loÿtiÚ
 = 
nuÎ±r
;

3823 ià((
obj
 = 
	`g‘_obj_wÜld
(
ch
, 
¬gum’t
)è!ğ
nuÎ±r
)

3824 ià(
obj
->
š_room
)

3825 
loÿtiÚ
 = 
obj
->
š_room
;

3829 ià(
loÿtiÚ
 =ğ
nuÎ±r
) {

3830 
	`¡c
("NØsuch†oÿtiÚ.\n", 
ch
);

3834 ià(!
loÿtiÚ
->
	`is_´iv©e
()) {

3835 
	`¡c
("Th©„oom i¢'ˆ´iv©e, u£ GÙo.\n", 
ch
);

3839 ià(
ch
->
fightšg
 !ğ
nuÎ±r
)

3840 
	`¡İ_fightšg
(
ch
, 
Œue
);

3842 
rch
 = 
ch
->
š_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
) {

3843 ià(
	`ÿn_£e_ch¬
(
rch
, 
ch
)) {

3844 ià(
ch
->
pcd©a
 !ğ
nuÎ±r
 && !ch->pcd©a->
bamfout
.
	`em±y
())

3845 
	`aù
("$t", 
ch
, ch->
pcd©a
->
bamfout
, 
rch
, 
TO_VICT
);

3847 
	`aù
("$Àw¬p ofàtØdi¡ªˆÏnd š‡ bur¡ oà–eùriø’”gy.", 
ch
, 
nuÎ±r
, 
rch
, 
TO_VICT
);

3851 
	`ch¬_äom_room
(
ch
);

3852 
	`ch¬_to_room
(
ch
, 
loÿtiÚ
);

3854 
rch
 = 
ch
->
š_room
->
³İË
;„ch !ğ
nuÎ±r
;„ch =„ch->
Ãxt_š_room
) {

3855 ià(
	`ÿn_£e_ch¬
(
rch
, 
ch
)) {

3856 ià(
ch
->
pcd©a
 !ğ
nuÎ±r
 && !ch->pcd©a->
bamfš
.
	`em±y
())

3857 
	`aù
("$t", 
ch
, ch->
pcd©a
->
bamfš
, 
rch
, 
TO_VICT
);

3859 
	`aù
("$Àm©”Ÿlize š‡ bur¡ oà–eùriø’”gy.", 
ch
, 
nuÎ±r
, 
rch
, 
TO_VICT
);

3863 
	`do_look
(
ch
, "auto");

3865 
	}
}

3868 
	$do_wizgroup
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3870 
Ch¬aù”
 *
viùim
;

3871 
boŞ
 
add
 = 
çl£
, 
®l
 = f®£, 
found
 = false;

3873 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
;

3874 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

3875 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

3876 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g3
);

3878 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.em±y(è|| 
¬g3
.empty()) {

3879 
	`¡c
("wizgrou°<add/»move> <¶ay”> <group>\n", 
ch
);

3880 
	`¡c
("V®id group ¬e:\n", 
ch
);

3881 
	`¡c
(" general quest build code security\n"

3882 "…Ïy” cÏÀav©¬ h”ØËad”\n", 
ch
);

3886 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g2
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

3887 
	`¡c
("PÏy”‚Ù found.\n", 
ch
);

3891 ià(
¬g1
.
	`is_´efix_of
("add"))

3892 
add
 = 
Œue
;

3893 ià(
¬g1
.
	`is_´efix_of
("remove"))

3894 
add
 = 
çl£
;

3896 
	`do_wizgroup
(
ch
, "");

3900 ià(
¬g3
 == "all") {

3901 
	`¡c
("Th`®l' o±iÚ i nØlÚg”ƒÇbËd.\n", 
ch
);

3906 cÚ¡‡uto& 
’Œy
 : 
cgroup_æags
) {

3907 ià(
¬g3
.
	`is_´efix_of
(
’Œy
.
Çme
è|| 
®l
) {

3908 
found
 = 
Œue
;

3910 ià(
add
)

3911 
viùim
->
	`add_cgroup
(
’Œy
.
b™
);

3913 
viùim
->
	`»move_cgroup
(
’Œy
.
b™
);

3915 
	`±c
(
ch
, "%s group %sed for %s.\n",

3916 
’Œy
.
Çme
, 
add
 ? "add" : "»mov", 
viùim
->name);

3918 ià(!
®l
)

3923 ià(!
found
)

3924 
	`do_wizgroup
(
ch
, "");

3925 
	}
}

3928 
	$do_wizify
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3930 
¡r§ve
[
MAX_INPUT_LENGTH
];

3931 
FILE
 *
å
;

3932 
Ch¬aù”
 *
viùim
;

3934 
SŒšg
 
¬g1
;

3935 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g1
);

3937 ià(
¬g1
.
	`em±y
()) {

3938 
	`¡c
("You mu¡…rovid¨Çme.\n", 
ch
);

3942 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g1
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

3943 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

3947 ià(
viùim
->
	`is_Åc
()) {

3948 
	`¡c
("Thi commªd cª oÆy bu£d oÀPC's.\n", 
ch
);

3952 ià(
	`IS_IMMORTAL
(
viùim
)) {

3953 
	`¡c
("They‡»‡Ì—dy‡ÀimmÜl.\n", 
ch
);

3958 
FÜm©
::
	`¥rštf
(
¡r§ve
, "%s%s%s", 
BACKUP_DIR
, 
viùim
->
Çme
.
	`ÿp™®ize
(), "GOD.gz");

3960 ià((
å
 = 
	`fİ’
(
¡r§ve
, "r")è!ğ
nuÎ±r
)

3961 
	`fşo£
(
å
);

3963 
	`backup_ch¬_obj
(
ch
);

3964 
	`¡c
("You¸pfha b“Àbacked up.\n", 
viùim
);

3965 
SŒšg
 
ÿ²ame
 = 
viùim
->
Çme
.
	`ÿp™®ize
();

3966 
FÜm©
::
	`¥rštf
(
¡r§ve
, "mv %s%s.gz %s%sGOD.gz",

3967 
BACKUP_DIR
, 
ÿ²ame
, BACKUP_DIR, capname);

3968 
	`sy¡em
(
¡r§ve
);

3971 
viùim
->
Ëv–
 = 
MAX_LEVEL
;

3972 
viùim
->
h™
 = 
	`ATTR_BASE
(viùim, 
APPLY_HIT
) = 30000;

3973 
viùim
->
mªa
 = 
	`ATTR_BASE
(viùim, 
APPLY_MANA
) = 30000;

3974 
viùim
->
¡am
 = 
	`ATTR_BASE
(viùim, 
APPLY_STAM
) = 30000;

3976 
¡©
 = 0; sˆ< 
MAX_STATS
; stat++)

3977 
	`ATTR_BASE
(
viùim
, 
	`¡©_to_©Œ
(
¡©
)) = 25;

3979 cÚ¡‡uto& 
·œ
 : 
skl_bË
) {

3980 ià(
·œ
.
fœ¡
 =ğ
skl
::
ty³
::
unknown
)

3983 
	`£t_Ë¬Ãd
(
viùim
, 
·œ
.
fœ¡
, 100);

3986 
viùim
->
	`»move_cgroup
(
GROUP_LEADER
);

3987 
viùim
->
	`»move_cgroup
(
GROUP_DEPUTY
);

3988 
viùim
->
şª
 = 
nuÎ±r
;

3989 
	`upd©e_pos
(
viùim
);

3990 
	`¡c
("You havü—‹d‡ god.\n", 
ch
);

3991 
	`¡c
("You sudd’ly f“Èlik¨GOD!\n", 
viùim
);

3992 
	`§ve_ch¬_obj
(
viùim
);

3993 
	}
}

3996 
	$do_au¿
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

3998 
Ch¬aù”
 *
viùim
;

4000 
SŒšg
 
¬g1
;

4001 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

4003 ià(
ch
->
	`is_Åc
()) {

4004 
	`do_huh
(
ch
);

4008 ià(
¬g1
.
	`em±y
()) {

4009 ià(
ch
->
pcd©a
->
au¿
.
	`em±y
())

4010 
	`¡c
("You havnØau¿ s‘.\n", 
ch
);

4012 
	`±c
(
ch
, "You¸au¿ i cu¼’y {W(%s{W){x.\n", ch->
pcd©a
->
au¿
);

4017 ià(!
	`IS_IMMORTAL
(
ch
)) {

4018 
	`¡c
("OÆy Imm ÿÀ£ˆyou¸au¿.\n", 
ch
);

4022 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g1
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

4023 
	`¡c
("Th©…Ïy” i nÙ†ogged on.\n", 
ch
);

4027 ià(
¬gum’t
.
	`em±y
()) {

4028 
	`±c
(
ch
, "Theœ‡u¿ i cu¼’y {W(%s{W){x.\n", 
viùim
->
pcd©a
->
au¿
);

4032 ià(
¬gum’t
 == "none") {

4033 
	`¡c
("Au¿„emoved.\n", 
ch
);

4034 
	`¡c
("You¸au¿ ha b“À»moved.\n", 
viùim
);

4035 
viùim
->
pcd©a
->
au¿
.
	`”a£
();

4039 ià(
¬gum’t
.
	`uncŞÜ
().
	`size
() > 30) {

4040 
	`¡c
("AÀau¿ cªnÙ blÚg”hª 30…rš‹d ch¬aù”s.\n", 
ch
);

4044 ià(
	`¡¾’
(
¬gum’t
) > 100) {

4045 
	`¡c
("AÀau¿ cªnÙ blÚg”hª 100Ù® ch¬aù”s.\n", 
ch
);

4049 
viùim
->
pcd©a
->
au¿
 = 
¬gum’t
;

4050 
	`±c
(
viùim
, "You¸au¿ i now {W(%s{W){x.\n", viùim->
pcd©a
->
au¿
);

4051 
	`±c
(
ch
, "Theœ‡u¿ i now {W(%s{W){x.\n", 
viùim
->
pcd©a
->
au¿
);

4052 
	}
}

4054 
	$do_bamfš
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4056 ià(
¬gum’t
.
	`em±y
()) {

4057 
	`±c
(
ch
, "You¸poofš i cu¼’y: %s\n", ch->
pcd©a
->
bamfš
);

4061 ià(!
¬gum’t
.
	`uncŞÜ
().
	`has_exaù_wÜds
(
ch
->
Çme
)) {

4062 
	`¡c
("You mu¡ inşudyou¸Çmš‡…oofš.\n", 
ch
);

4066 ià(
	`¡¾’
(
¬gum’t
) > 100) {

4067 
	`¡c
("Poofš ÿÂÙ blÚg”hª 100…rš‹d ch¬aù”s.\n", 
ch
);

4071 ià(
¬gum’t
.
	`uncŞÜ
().
	`size
() > 300) {

4072 
	`¡c
("Poofš ÿÂÙ blÚg”hª 300 ch¬aù”s, couÁšg cŞÜ codes.\n", 
ch
);

4076 
ch
->
pcd©a
->
bamfš
 = 
¬gum’t
;

4077 
	`±c
(
ch
, "You¸poofš i now: %s\n", ch->
pcd©a
->
bamfš
);

4078 
	}
}

4080 
	$do_bamfout
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4082 ià(
¬gum’t
.
	`em±y
()) {

4083 
	`±c
(
ch
, "You¸poofouˆi cu¼’y: %s\n", ch->
pcd©a
->
bamfout
);

4087 ià(!
¬gum’t
.
	`uncŞÜ
().
	`has_exaù_wÜds
(
ch
->
Çme
)) {

4088 
	`¡c
("You mu¡ inşudyou¸Çmš‡…oofout.\n", 
ch
);

4092 ià(
	`¡¾’
(
¬gum’t
) > 100) {

4093 
	`¡c
("Poofout ÿÂÙ blÚg”hª 100…rš‹d ch¬aù”s.\n", 
ch
);

4097 ià(
¬gum’t
.
	`uncŞÜ
().
	`size
() > 300) {

4098 
	`¡c
("Poofout ÿÂÙ blÚg”hª 300 ch¬aù”s, couÁšg cŞÜ codes.\n", 
ch
);

4102 
ch
->
pcd©a
->
bamfout
 = 
¬gum’t
;

4103 
	`±c
(
ch
, "You¸poofouˆi now: %s\n", ch->
pcd©a
->
bamfout
);

4104 
	}
}

4106 
	$do_şªqp
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

4108 
buf
[
MSL
];

4109 
CÏn
 *
rg‘
;

4110 
qp_amouÁ
 = 0;

4112 ià(
¬gum’t
.
	`em±y
()) {

4113 
	`do_şªšfo
(
ch
, 
¬gum’t
);

4117 ià(!
	`IS_IMMORTAL
(
ch
)) {

4118 ià(!
ch
->
şª
) {

4119 
	`¡c
("You'»‚Ùƒv’ iÀ¨şª!\n", 
ch
);

4123 ià(
ch
->
şª
->
šd•’d’t
) {

4124 
	`¡c
("You¸şª dÛ¢'ˆsuµÜˆthi ã©u»!\n", 
ch
);

4129 ià(
¬gum’t
.
	`em±y
()) {

4130 
	`¡c
("S“ 'h–°şªqp' oÀhowhi commªd wÜks!\n", 
ch
);

4134 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
;

4135 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

4136 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

4137 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g3
);

4139 ià(!
	`IS_IMMORTAL
(
ch
))

4140 
rg‘
 = 
ch
->
şª
;

4142 
rg‘
 = (
¬g3
.
	`em±y
(è? 
ch
->
şª
 : 
	`şª_lookup
(arg3));

4144 ià(!
rg‘
) {

4145 
	`¡c
("Th”i nØsuch cÏn.\n", 
ch
);

4149 ià(
rg‘
->
šd•’d’t
) {

4150 
	`¡c
("You cª'ˆdÚ©que¡pošt tØth© cÏn!\n", 
ch
);

4154 ià(!
¬g2
.
	`is_numb”
()) {

4155 
	`¡c
("You mu¡ s³cify‡ÀamouÁ oàque¡pošts.\n", 
ch
);

4159 ià((
qp_amouÁ
 = 
	`©oi
(
¬g2
)) < 1 || qp_amount > 30000) {

4160 
	`¡c
("Thnumb” oàque¡pošt mu¡ bb‘w“À1‡nd 30000.\n", 
ch
);

4164 ià(
¬g1
.
	`is_´efix_of
("donate")) {

4165 ià(!
	`IS_IMMORTAL
(
ch
)) {

4166 ià(
	`has_’ough_qps
(
ch
, 
qp_amouÁ
) == 0) {

4167 
	`¡c
("PËa£ry‡gaš wh’ you hav’ough que¡pošts!\n", 
ch
);

4171 
ch
->
pcd©a
->
que¡pošts
 -ğ
qp_amouÁ
;

4172 
ch
->
pcd©a
->
que¡pošts_dÚ©ed
 +ğ
qp_amouÁ
;

4175 
rg‘
->
şªqp
 +ğ
qp_amouÁ
;

4176 
	`§ve_şª_bË
();

4177 
	`§ve_ch¬_obj
(
ch
);

4179 ià(
ch
->
şª
 !ğ
rg‘
)

4180 
	`±c
(
ch
, "The %s{x is‚ow %d questpoint%s„icher!\n",

4181 
rg‘
->
şªÇme
, 
qp_amouÁ
, qp_amount > 1 ? "s" : "");

4183 
FÜm©
::
	`¥rštf
(
buf
, "{W[ %s just donated %d questpoint%sohe clan! ]{x\n",

4184 
ch
->
Çme
, 
qp_amouÁ
, qp_amount > 1 ? "s" : "");

4185 
	`£nd_to_şª
(
ch
, 
rg‘
, 
buf
);

4186 
	`±c
(
ch
, "You donate %d questpoint%sohe clan.\n",

4187 
qp_amouÁ
, qp_amount > 1 ? "s" : "");

4193 ià(
¬g1
.
	`is_´efix_of
("withdraw") ||‡rg1.is_prefix_of("deduct")) {

4194 ià(!
	`IS_IMMORTAL
(
ch
)) {

4195 
	`¡c
("OÆy immÜl ¬®lowedØdØth©!\n", 
ch
);

4199 ià(
¬gum’t
.
	`em±y
()) {

4200 
	`¡c
("You havtØ´ovid¨»asÚ!\n", 
ch
);

4204 ià(
rg‘
->
şªqp
 < 
qp_amouÁ
) {

4205 
	`¡c
("Thşª i nÙ„ichƒnough!\n", 
ch
);

4209 
rg‘
->
şªqp
 -ğ
qp_amouÁ
;

4210 
FÜm©
::
	`¥rštf
(
buf
, "{W[ %s has deducted %d questpoint%s for %s ]\n",

4211 
ch
->
Çme
, 
qp_amouÁ
, qp_amouÁ > 1 ? "s" : "", 
¬gum’t
);

4212 
	`£nd_to_şª
(
ch
, 
rg‘
, 
buf
);

4213 
	`±c
(
ch
, "You deduù %d que¡pošt äomh%s{x.\n", 
qp_amouÁ
, 
rg‘
->
şªÇme
);

4214 
	`§ve_şª_bË
();

4218 
	`¡c
("S“ 'h–°şªqp' oÀhowhi commªd wÜks!\n", 
ch
);

4219 
	}
}

	@src/wiz_quest.cc

16 
	~<veùÜ
>

18 
	~"aù.hh
"

19 
	~"¬gum’t.hh
"

20 
	~"afãù/Afãù.hh
"

21 
	~"A»a.hh
"

22 
	~"chªÃls.hh
"

23 
	~"Ch¬aù”.hh
"

24 
	~"deş¬e.hh
"

25 
	~"DesütÜ.hh
"

26 
	~"ExŒaDesü.hh
"

27 
	~"fšd.hh
"

28 
	~"FÏgs.hh
"

29 
	~"FÜm©.hh
"

30 
	~"Game.hh
"

31 
	~"š‹½.hh
"

32 
	~"Loggšg.hh
"

33 
	~"memÜy.hh
"

34 
	~"m”c.hh
"

35 
	~"MobePrÙÙy³.hh
"

36 
	~"Objeù.hh
"

37 
	~"PÏy”.hh
"

38 
	~"Que¡A»a.hh
"

39 
	~"¿ndom.hh
"

40 
	~"Room.hh
"

41 
	~"SŒšg.hh
"

42 
	~"WÜld.hh
"

43 
	~"RoomPrÙÙy³.hh
"

45 
	$do_add­¶y
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

47 
Objeù
 *
obj
;

48 
afãù_modify
 = 1, 
’chªt_ty³
, 
du¿tiÚ
 = -1;

50 
SŒšg
 
¬g1
, 
¬g2
, 
¬g3
, 
¬g4
;

51 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

52 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

53 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g3
);

54 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g4
);

56 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.em±y(è|| 
¬g3
.empty()) {

57 
	`¡c
("SyÁax:‡dd­¶y <objeù> <­¶y> <v®ue> [du¿tiÚ]\n", 
ch
);

58 
	`¡c
(" Aµl› ÿÀbof:\n", 
ch
);

59 
	`¡c
(" h°mª¨¡amš¨¡¸dex iÁ wi cÚ chr\n", 
ch
);

60 
	`¡c
("‡gaøh™rŞÈdamrŞÈ§ves\n", 
ch
);

64 
obj
 = 
	`g‘_obj_wÜld
(
ch
, 
¬g1
);

66 ià(
obj
 =ğ
nuÎ±r
) {

67 
	`¡c
("NØsuch objeùƒxi¡s!\n", 
ch
);

71 ià(
¬g2
 =ğ"hp"è
’chªt_ty³
 = 
APPLY_HIT
;

72 ià(
¬g2
 =ğ"mªa"è
’chªt_ty³
 = 
APPLY_MANA
;

73 ià(
¬g2
 =ğ"¡amša"è
’chªt_ty³
 = 
APPLY_STAM
;

74 ià(
¬g2
 =ğ"¡r"è
’chªt_ty³
 = 
APPLY_STR
;

75 ià(
¬g2
 =ğ"dex"è
’chªt_ty³
 = 
APPLY_DEX
;

76 ià(
¬g2
 =ğ"št"è
’chªt_ty³
 = 
APPLY_INT
;

77 ià(
¬g2
 =ğ"wis"è
’chªt_ty³
 = 
APPLY_WIS
;

78 ià(
¬g2
 =ğ"cÚ"è
’chªt_ty³
 = 
APPLY_CON
;

79 ià(
¬g2
 =ğ"chr"è
’chªt_ty³
 = 
APPLY_CHR
;

80 ià(
¬g2
 =ğ"£x"è
’chªt_ty³
 = 
APPLY_SEX
;

81 ià(
¬g2
 =ğ"age"è
’chªt_ty³
 = 
APPLY_AGE
;

82 ià(
¬g2
 =ğ"ac"è
’chªt_ty³
 = 
APPLY_AC
;

83 ià(
¬g2
 =ğ"h™rŞl"è
’chªt_ty³
 = 
APPLY_HITROLL
;

84 ià(
¬g2
 =ğ"damrŞl"è
’chªt_ty³
 = 
APPLY_DAMROLL
;

85 ià(
¬g2
 =ğ"§ves"è
’chªt_ty³
 = 
APPLY_SAVES
;

87 
	`¡c
("Th©‡µly i nÙ…ossibË!\n", 
ch
);

91 ià(!
¬g3
.
	`is_numb”
()) {

92 
	`¡c
("Aµl› »quœ¨v®ue.\n", 
ch
);

96 ià(
	`©oi
(
¬g3
) < -30000 ||‡toi(arg3) > 30000) {

97 
	`¡c
("V®umu¡ bb‘w“À-30000‡nd 30000.\n", 
ch
);

101 
afãù_modify
 = 
	`©oi
(
¬g3
);

103 ià(
¬g4
.
	`em±y
())

104 
du¿tiÚ
 = -1;

105 ià(!
¬g4
.
	`is_numb”
())

106 
du¿tiÚ
 = -1;

107 ià(
	`©oi
(
¬g4
) < -1 ||‡toi(arg4) > 998)

108 
du¿tiÚ
 = -1;

110 
du¿tiÚ
 = 
	`©oi
(
¬g4
);

112 
	`¡c
("Ok.\n", 
ch
);

114 
afãù
::
Afãù
 
af
;

115 
af
.
wh”e
 = 
TO_OBJECT
;

116 
af
.
ty³
 = 
afãù
::ty³::
nÚe
;

117 
af
.
Ëv–
 = 
ch
->level;

118 
af
.
du¿tiÚ
 = duration;

119 
af
.
loÿtiÚ
 = 
’chªt_ty³
;

120 
af
.
modif›r
 = 
afãù_modify
;

121 
af
.
	`b™veùÜ
(0);

122 
af
.
evŞutiÚ
 = 1;

123 
afãù
::
	`još_to_obj
(
obj
, &
af
);

124 
	}
}

127 
	$do_mÜph
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

129 
Ch¬aù”
 *
viùim
;

130 
Ch¬aù”
 *
mÜph
;

131 
Ch¬aù”
 *
mobe
;

133 
SŒšg
 
¬g1
;

134 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

136 ià(
¬g1
.
	`em±y
()) {

137 
	`¡c
("MÜph Whom?\n", 
ch
);

141 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g1
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

142 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

146 ià(
viùim
->
desc
 =ğ
nuÎ±r
) {

147 
	`¡c
("You cª oÆy mÜph cÚÃùed…Ïy”s.\n", 
ch
);

151 ià(
viùim
->
desc
->
Üigš®
 !ğ
nuÎ±r
) {

152 
	`¡c
("They‡» cu¼’y mÜphed‡Ì—dy.\n", 
ch
);

156 
SŒšg
 
¬g2
;

157 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

159 ià(
¬g2
.
	`em±y
()) {

160 
	`¡c
("MÜphhem iÁØwh©?\n", 
ch
);

164 ià((
mÜph
 = 
	`g‘_mob_wÜld
(
ch
, 
¬g2
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

165 
	`¡c
("Th© mobdÛ nÙƒxi¡.\n", 
ch
);

169 
mobe
 = 
	`ü—‹_mobe
(
Game
::
	`wÜld
().
	`g‘_mob_´ÙÙy³
(
mÜph
->
pIndexD©a
->
vnum
));

171 ià(!
mobe
) {

172 
Loggšg
::
	`bug
("Memoryƒrror creating mob in do_morph().", 0);

173 
	`¡c
("Could‚Ù mÜph.\n", 
ch
);

177 
mobe
->
aù_æags
 -ğ
ACT_AGGRESSIVE
;

178 
mobe
->
aù_æags
 +ğ
PLR_COLOR
;

179 
mobe
->
aù_æags
 +ğ
ACT_MORPH
;

180 
	`ch¬_to_room
(
mobe
, 
viùim
->
š_room
);

181 
	`do_sw™ch
(
viùim
, 
mobe
->
Çme
);

182 
	`ch¬_äom_room
(
viùim
);

183 
	`ch¬_to_room
(
viùim
, 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_LIMBO
))));

184 
	`¡c
("SucûssfuÈMÜph!\n", 
ch
);

185 
	}
}

187 
	$do_½·w¬d
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

189 
Ch¬aù”
 *
viùim
;

190 
buf
[
MAX_STRING_LENGTH
];

191 
SŒšg
 
ouut
;

192 
DesütÜ
 *
d
;

193 
½pošt
;

195 ià(
¬gum’t
.
	`em±y
()) {

196 
	`¡c
("Nam RPPs\n", 
ch
);

197 
	`¡c
("--------------------\n", 
ch
);

199 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
) {

200 ià(!
d
->
	`is_¶ayšg
(è|| !
	`ÿn_£e_ch¬
(
ch
, d->
ch¬aù”
))

203 
viùim
 = (
d
->
Üigš®
 !ğ
nuÎ±r
è? d->Üigš® : d->
ch¬aù”
;

205 ià(!
	`ÿn_£e_ch¬
(
ch
, 
viùim
))

208 
FÜm©
::
	`¥rštf
(
buf
, "%-14 {V%5d{x\n", 
viùim
->
Çme
, viùim->
pcd©a
->
rŞ•ošts
);

209 
ouut
 +ğ
buf
;

212 
	`·ge_to_ch¬
(
ouut
, 
ch
);

216 
SŒšg
 
¬g1
, 
¬g2
;

217 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

218 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

220 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.em±y(è|| 
¬gum’t
.empty()) {

221 
	`¡c
("SyÁax:\n", 
ch
);

222 
	`¡c
("„µ <aw¬d|deduù> <viùim> <amouÁ>\n", 
ch
);

226 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g2
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

227 
	`¡c
("PÏy”‚Ù found.\n", 
ch
);

231 ià(!
¬gum’t
.
	`is_numb”
()) {

232 
	`¡c
("V®umu¡ bnum”ic.\n", 
ch
);

236 
½pošt
 = 
	`©oi
(
¬gum’t
);

238 ià(
½pošt
 < 0 ||„ppoint > 50) {

239 
	`¡c
("V®umu¡ bb‘w“À0‡nd 50.\n", 
ch
);

243 ià(
¬g1
 == "award") {

244 
viùim
->
pcd©a
->
rŞ•ošts
 +ğ
½pošt
;

245 
	`±c
(
ch
, "You havaw¬dedhem %d„Ş¶ayšg…ošts.\n", 
½pošt
);

246 
	`±c
(
viùim
, "You havb“Àaw¬ded %d„Ş¶ayšg…ošts.\n", 
½pošt
);

247 
FÜm©
::
	`¥rštf
(
buf
, "% aw¬ded %d„µØ%s.", 
ch
->
Çme
, 
½pošt
, 
viùim
->name);

248 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 0, 0, 0);

252 ià(
¬g1
 == "deduct") {

253 ià(
½pošt
 > 
viùim
->
pcd©a
->
rŞ•ošts
) {

254 
	`¡c
("They dØnÙ hav’ough„Ş¶ayšg…ošt fÜh©.\n", 
ch
);

258 
viùim
->
pcd©a
->
rŞ•ošts
 -ğ
½pošt
;

259 
FÜm©
::
	`¥rštf
(
buf
, "%d„ole…laying…oints have been deducted, %d„emaining.\n",

260 
½pošt
, 
viùim
->
pcd©a
->
rŞ•ošts
);

261 
	`¡c
(
buf
, 
ch
);

262 
	`¡c
(
buf
, 
viùim
);

263 
FÜm©
::
	`¥rštf
(
buf
, "%s deducted %d„pp from %s [%d„emaining].",

264 
ch
->
Çme
, 
½pošt
, 
viùim
->Çme, viùim->
pcd©a
->
rŞ•ošts
);

265 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_SECURE
, 
WIZ_QUEST
, 
	`GET_RANK
(ch));

269 
	`¡c
("U£ 'deduù' o¸'aw¬d'.\n", 
ch
);

270 
	}
}

272 
Room
 *
	$g‘_sÿ‰”_room
(
Ch¬aù”
 *
ch
)

274 
pick
 = 0, 
·ss
 = 1;

276 
·ss
 <= 2) {

277 
couÁ
 = 0;

279 auto& 
¬—_·œ
 : 
Game
::
	`wÜld
().
¬—s
) {

280 auto& 
’Œy
 : 
¬—_·œ
.
£cÚd
->
rooms
) {

282 
Room
 *
room
 = 
’Œy
.
£cÚd
;

284 ià(
room
 =ğ
nuÎ±r


285 || 
room
 =ğ
ch
->
š_room


286 || !
	`ÿn_£e_room
(
ch
, 
room
)

287 || 
room
->
	`¬—
(è=ğ
Game
::
	`wÜld
().
que¡
.area()

288 || (
room
->
	`¬—
().
mš_vnum
 >= 24000

289 && 
room
->
	`¬—
().
mš_vnum
 <= 26999)

290 || 
room
->
	`gud
(è!ğ
Gud
::
nÚe


291 || 
room
->
	`¬—
().
Çme
 == "Playpen"

292 || 
room
->
	`¬—
().
Çme
 == "IMM-Zone"

293 || 
room
->
	`¬—
().
Çme
 == "Limbo"

294 || 
room
->
	`¬—
().
Çme
 == "Eilyndrae"

295 || 
room
->
	`¬—
().
Çme
 == "Torayna Cri"

296 || 
room
->
	`¬—
().
Çme
 == "Battle Arenas"

297 || 
room
->
	`£ùÜ_ty³
(è=ğ
SeùÜ
::
¬’a


298 || 
room
->
	`æags
().
	`has_ªy_of
(

299 
ROOM_MALE_ONLY


300 | 
ROOM_FEMALE_ONLY


301 | 
ROOM_PRIVATE


302 | 
ROOM_SOLITARY


303 | 
ROOM_NOQUEST


304 | 
ROOM_PET_SHOP
))

308 
Room
 *
´ev
;

309 ià((
´ev
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
room
->
´ÙÙy³
.
vnum
.
	`v®ue
(è- 1)))è!ğ
nuÎ±r
)

310 ià(
´ev
->
	`æags
().
	`has
(
ROOM_PET_SHOP
))

313 ià(
·ss
 =ğ2 && 
couÁ
 =ğ
pick
)

314  
room
;

316 
couÁ
++;

320 ià(
·ss
++ =ğ2 || 
couÁ
 == 0)

323 
pick
 = 
	`numb”_¿nge
(0, 
couÁ
-1);

326  
nuÎ±r
;

327 
	}
}

330 
	$do_sÿ‰”
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

332 
Objeù
 *
obj
, *
obj_Ãxt
;

333 
Room
 *
room
;

334 
boŞ
 
sÿ‰”ed
 = 
çl£
;

336 ià(
ch
->
š_room
 =ğ
nuÎ±r
)

339 
obj
 = 
ch
->
š_room
->
cÚ‹Ás
; obj !ğ
nuÎ±r
; obj = 
obj_Ãxt
) {

340 
obj_Ãxt
 = 
obj
->
Ãxt_cÚ‹Á
;

342 ià(!
	`CAN_WEAR
(
obj
, 
ITEM_TAKE
))

345 
room
 = 
	`g‘_sÿ‰”_room
(
ch
);

346 
	`obj_äom_room
(
obj
);

347 
	`obj_to_room
(
obj
, 
room
);

348 
sÿ‰”ed
 = 
Œue
;

351 ià(!
sÿ‰”ed
)

352 
	`¡c
("You s“‚ÙhšgØsÿ‰”.\n", 
ch
);

354 
	`¡c
("DÚe.\n", 
ch
);

355 
	}
}

357 
	$do_¡ršg
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

359 
SŒšg
 
buf
;

360 
Ch¬aù”
 *
viùim
;

361 
Objeù
 *
obj
;

363 
SŒšg
 
ty³
, 
¬g1
, 
¬g2
, 
¬g3
;

364 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
ty³
);

365 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

366 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

367 
¬g3
 = 
¬gum’t
;

369 ià(
ty³
.
	`em±y
(è|| 
¬g1
.em±y(è|| 
¬g2
.em±y(è|| 
¬g3
.empty()) {

370 
	`¡c
("SyÁax:\n", 
ch
);

371 
	`¡c
(" sŒšg ch¬ <Çme> <f›ld> <¡ršg>\n", 
ch
);

372 
	`¡c
(" f›lds:‚amshÜˆlÚg desøt™Ë s³øde™y stu ¥ou£\n", 
ch
);

373 
	`¡c
(" sŒšg obj <Çme> <f›ld> <¡ršg>\n", 
ch
);

374 
	`¡c
(" f›lds:‚amshÜˆlÚg m©”ŸÈex‹nded mÜe\n", 
ch
);

375 
	`¡c
(" sŒšg„oom <numb”> <f›ld> <¡ršg>\n", 
ch
);

376 
	`¡c
(" f›lds:‚ame\n", 
ch
);

380 ià(
ty³
.
	`is_´efix_of
("character") ||ype.is_prefix_of("mobile")) {

381 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g1
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

382 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

386 ià(
	`IS_IMP
(
viùim
è&& !IS_IMP(
ch
)) {

387 
	`¡c
("They wouÊ'ˆlikth©.\n", 
ch
);

393 ià(
¬g2
.
	`is_´efix_of
("spouse")) {

394 ià(
viùim
->
	`is_Åc
()) {

395 
	`¡c
("NÙ‡ good id—.\n", 
ch
);

399 ià(
¬g3
 == "none") {

400 
viùim
->
pcd©a
->
¥ou£
.
	`”a£
();

403 
viùim
->
pcd©a
->
¥ou£
 = 
¬g3
;

406 
FÜm©
::
	`¥rštf
(
buf
, "%s' ¥ou£ ha b“ÀchªgedØ%s.\n", 
viùim
->
Çme
, 
¬g3
);

407 
	`¡c
(
buf
, 
ch
);

411 ià(
¬g2
.
	`is_´efix_of
("name")) {

412 ià(!
viùim
->
	`is_Åc
()) {

413 
	`¡c
("You cª'ˆchªg¨¶ay”' Çme!\n", 
ch
);

417 
FÜm©
::
	`¥rštf
(
buf
, "%s' Çmha b“ÀchªgedØ%s.\n", 
viùim
->
Çme
, 
¬g3
);

418 
viùim
->
Çme
 = 
¬g3
;

419 
	`¡c
(
buf
, 
ch
);

423 ià(
¬g2
.
	`is_´efix_of
("description")) {

424 
viùim
->
desütiÚ
 = 
¬g3
;

425 
FÜm©
::
	`¥rštf
(
buf
, "%s' desütiÚ ha b“ÀchªgedØ%s.\n", 
viùim
->
Çme
, 
¬g3
);

426 
	`¡c
(
buf
, 
ch
);

430 ià(
¬g2
.
	`is_´efix_of
("short")) {

431 
viùim
->
shÜt_desü
 = 
¬g3
;

432 
FÜm©
::
	`¥rštf
(
buf
, "%s' shÜˆdesütiÚ ha b“ÀchªgedØ%s.\n", 
viùim
->
Çme
, 
¬g3
);

433 
	`¡c
(
buf
, 
ch
);

437 ià(
¬g2
.
	`is_´efix_of
("long")) {

438 
¬g3
 += "\n";

439 
viùim
->
lÚg_desü
 = 
¬g3
;

440 
FÜm©
::
	`¥rštf
(
buf
, "%s' lÚg desütiÚ ha b“ÀchªgedØ%s", 
viùim
->
Çme
, 
¬g3
);

441 
	`¡c
(
buf
, 
ch
);

445 ià(
¬g2
.
	`is_´efix_of
("title")) {

446 ià(
viùim
->
	`is_Åc
()) {

447 
	`¡c
("Mobe dÚ'ˆhav¨t™Ë, sly!\n", 
ch
);

451 
	`£t_t™Ë
(
viùim
, 
¬g3
);

452 
FÜm©
::
	`¥rštf
(
buf
, "%s' t™Ë ha b“ÀchªgedØ%s.\n", 
viùim
->
Çme
, 
¬g3
);

453 
	`¡c
(
buf
, 
ch
);

457 ià(
¬g2
.
	`is_´efix_of
("spec")) {

458 ià(!
viùim
->
	`is_Åc
()) {

459 
	`¡c
("PÏy” dÚ'ˆhav¥ecfuns, sly!\n", 
ch
);

463 ià((
viùim
->
¥ec_fun
 = 
	`¥ec_lookup
(
¬g3
)) == 0) {

464 
FÜm©
::
	`¥rštf
(
buf
, "% i nÙ‡ v®id s³øfun.\n", 
¬g3
);

465 
	`¡c
(
buf
, 
ch
);

469 
FÜm©
::
	`¥rštf
(
buf
, "%s' ¥eøfuÀv®u£ˆtØ%s.\n", 
viùim
->
Çme
, 
¬g3
);

470 
	`¡c
(
buf
, 
ch
);

474 ià(
¬g2
.
	`is_´efix_of
("deity")) {

475 ià(
viùim
->
	`is_Åc
()) {

476 
	`¡c
("Mobe ¬®È©hei¡s!\n", 
ch
);

480 
viùim
->
pcd©a
->
de™y
 = 
¬g3
;

481 
FÜm©
::
	`¥rštf
(
buf
, "%s' de™y sŒšg ha b“ÀchªgedØ%s.\n", 
viùim
->
Çme
, 
¬g3
);

482 
	`¡c
(
buf
, 
ch
);

486 ià(
¬g2
.
	`is_´efix_of
("status")) {

487 ià(
viùim
->
	`is_Åc
()) {

488 
	`¡c
("A mobha nØ¡©u tØchªge!\n", 
ch
);

492 
viùim
->
pcd©a
->
¡©us
 = 
¬g3
;

493 
FÜm©
::
	`¥rštf
(
buf
, "%s' ¡©u ¡ršg ha b“ÀchªgedØ%s.\n", 
viùim
->
Çme
, 
¬g3
);

494 
	`¡c
(
buf
, 
ch
);

499 ià(
ty³
.
	`is_´efix_of
("object")) {

501 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬g1
)è=ğ
nuÎ±r


502 && (
obj
 = 
	`g‘_obj_w—r
(
ch
, 
¬g1
)è=ğ
nuÎ±r


503 && (
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬g1
, ch->
š_room
->
cÚ‹Ás
)è=ğ
nuÎ±r
) {

504 
FÜm©
::
	`¥rštf
(
buf
, "Aá” s—rchšghwhŞmud, you could‚Ù fšd %s.\n", 
¬g1
);

505 
	`¡c
(
buf
, 
ch
);

509 ià(
¬g2
.
	`is_´efix_of
("name")) {

510 
FÜm©
::
	`¥rštf
(
buf
, "% i now knowÀa %s.\n", 
obj
->
Çme
, 
¬g3
);

511 
obj
->
Çme
 = 
¬g3
;

512 
	`¡c
(
buf
, 
ch
);

516 ià(
¬g2
.
	`is_´efix_of
("short")) {

517 
FÜm©
::
	`¥rštf
(
buf
, "%s' shÜˆdesütiÚ ha b“ÀchªgedØ%s.\n", 
obj
->
shÜt_desü
, 
¬g3
);

518 
obj
->
shÜt_desü
 = 
¬g3
;

519 
	`¡c
(
buf
, 
ch
);

523 ià(
¬g2
.
	`is_´efix_of
("long")) {

524 
FÜm©
::
	`¥rštf
(
buf
, "%s' lÚg desütiÚ ha b“ÀchªgedØ%s.\n", 
obj
->
shÜt_desü
, 
¬g3
);

525 
obj
->
desütiÚ
 = 
¬g3
;

526 
	`¡c
(
buf
, 
ch
);

530 ià(
¬g2
.
	`is_´efix_of
("material")) {

531 
FÜm©
::
	`¥rštf
(
buf
, "%s suddenly warps into %s‡s %s glows brightly.\n",

532 
obj
->
m©”Ÿl
, 
¬g3
, obj->
shÜt_desü
);

533 
obj
->
m©”Ÿl
 = 
¬g3
;

534 
	`¡c
(
buf
, 
ch
);

538 ià(
¬g2
 =ğ"ed" ||‡rg2.
	`is_´efix_of
("extended")) {

539 
ExŒaDesü
 *
ed
;

540 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g3
);

542 ià(
¬gum’t
.
	`em±y
()) {

543 
	`¡c
("SyÁax: s‘ obj <objeù>ƒd <keywÜd> <¡ršg>\n", 
ch
);

547 ià(
obj
->
exŒa_desü
 !ğ
nuÎ±r
) {

548 
ExŒaDesü
 *
ed_Ãxt
;

549 
ExŒaDesü
 *
ed_´ev
 = 
nuÎ±r
;

551 
ed
 = 
obj
->
exŒa_desü
;ƒd !ğ
nuÎ±r
;ƒd = 
ed_Ãxt
) {

552 
ed_Ãxt
 = 
ed
->
Ãxt
;

554 ià(
ed
->
keywÜd
 =ğ
¬g3
) {

555 ià(
ed
 =ğ
obj
->
exŒa_desü
)

556 
obj
->
exŒa_desü
 = 
ed_Ãxt
;

558 
ed_´ev
->
Ãxt
 = 
ed_Ãxt
;

560 
d–‘e
 
ed
;

563 
ed_´ev
 = 
ed
;

567 ià(
¬gum’t
 == "none")

570 
desc
[
MIL
];

571 
FÜm©
::
	`¥rštf
(
desc
, "%s\n", 
¬gum’t
);

573 
ed
 = 
Ãw
 
	`ExŒaDesü
(
¬g3
, 
desc
);

574 
ed
->
Ãxt
 = 
obj
->
exŒa_desü
;

575 
obj
->
exŒa_desü
 = 
ed
;

576 
	`±c
(
ch
, "Ex‹nded desütiÚ s‘o:\n%s\n", 
¬g3
);

580 ià(
¬g2
.
	`is_´efix_of
("more")) {

581 
ExŒaDesü
 *
ed
;

582 
buf
.
	`”a£
();

583 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g3
);

585 ià(
¬gum’t
.
	`em±y
()) {

586 
	`¡c
("SyÁax: sŒšg obj <obj> mÜ<keywÜd> <¡ršg>\n", 
ch
);

590 ià(
obj
->
exŒa_desü
 !ğ
nuÎ±r
) {

591 
ExŒaDesü
 *
ed_Ãxt
;

592 
ExŒaDesü
 *
ed_´ev
 = 
nuÎ±r
;

594 
ed
 = 
obj
->
exŒa_desü
;ƒd !ğ
nuÎ±r
;ƒd = 
ed_Ãxt
) {

595 
ed_Ãxt
 = 
ed
->
Ãxt
;

597 ià(
ed
->
keywÜd
 =ğ
¬g3
) {

598 
buf
 = 
ed
->
desütiÚ
;

600 ià(
ed
 =ğ
obj
->
exŒa_desü
)

601 
obj
->
exŒa_desü
 = 
ed_Ãxt
;

603 
ed_´ev
->
Ãxt
 = 
ed_Ãxt
;

605 
d–‘e
 
ed
;

608 
ed_´ev
 = 
ed
;

612 
buf
 +ğ
¬gum’t
;

613 
buf
 += "\n";

614 
ed
 = 
Ãw
 
	`ExŒaDesü
(
¬g3
, 
buf
);

615 
ed
->
Ãxt
 = 
obj
->
exŒa_desü
;

616 
obj
->
exŒa_desü
 = 
ed
;

617 
	`±c
(
ch
, "AddedØex‹nded desütiÚ:\n%s\n", 
¬g3
);

623 ià(
ty³
.
	`is_´efix_of
("room")) {

624 
	`¡c
("SÜry,„oom sŒšgšg i ‹mpÜ¬y di§bËd.\n", 
ch
);

645 
	`do_¡ršg
(
ch
, "");

646 
	}
}

648 
	$do_sw™ch
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

650 
buf
[
MAX_STRING_LENGTH
];

651 
Ch¬aù”
 *
viùim
;

653 ià(
ch
->
	`is_Åc
(è|| ch->
desc
 =ğ
nuÎ±r
) {

654 
	`¡c
("You'»‚Ù‡„—Èliv¶ay”, you cªnÙ sw™ch.\n", 
ch
);

658 ià(
ch
->
desc
->
Üigš®
 !ğ
nuÎ±r
) {

659 
	`¡c
("You‡» cu¼’y sw™ched‡Ì—dy.\n", 
ch
);

663 
SŒšg
 
¬g
;

664 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

666 ià(
¬g
.
	`em±y
()) {

667 
	`¡c
("Sw™ch iÁØwhom?\n", 
ch
);

671 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

672 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

676 ià(!
viùim
->
	`is_Åc
()) {

677 
	`¡c
("You cª oÆy sw™ch iÁØmobes.\n", 
ch
);

681 ià(!
	`is_room_owÃr
(
ch
, 
viùim
->
š_room
) && ch->in_room != victim->in_room

682 && 
viùim
->
š_room
->
	`is_´iv©e
(è&& !
	`IS_IMP
(
ch
)) {

683 
	`¡c
("Th© ch¬aù” i š‡…riv©room.\n", 
ch
);

687 ià(
viùim
->
desc
 !ğ
nuÎ±r
) {

688 
	`¡c
("SÜry, Ch¬aù” iÀu£.\n", 
ch
);

692 
FÜm©
::
	`¥rštf
(
buf
, "$N ha sw™ched iÁo: %s", 
viùim
->
shÜt_desü
);

694 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_SWITCHES
, 0, 0);

695 
ch
->
desc
->
ch¬aù”
 = 
viùim
;

696 
ch
->
desc
->
Üigš®
 = ch;

697 
viùim
->
desc
 = 
ch
->desc;

698 
ch
->
desc
 = 
nuÎ±r
;

701 
viùim
->
´om±
 = 
ch
->prompt;

703 
viùim
->
comm_æags
 = 
ch
->comm_flags;

704 
viùim
->
ûnsÜ_æags
 = 
ch
->censor_flags;

705 
viùim
->
lšes
 = 
ch
->lines;

706 
	`¡c
("You havb“ÀmÜphed.\n", 
viùim
);

708 
	}
}

710 
	$do_»tuº
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

712 
buf
[
MAX_STRING_LENGTH
];

713 
Room
 *
loÿtiÚ
;

715 ià(
ch
->
desc
 =ğ
nuÎ±r
)

718 ià(
ch
->
desc
->
Üigš®
 =ğ
nuÎ±r
) {

719 
	`¡c
("You‡»‚Ù cu¼’y mÜphed.\n", 
ch
);

723 
	`¡c
("You„‘uºØyou¸Üigš® body.\n", 
ch
);

725 
ch
->
´om±
.
	`”a£
();

727 
FÜm©
::
	`¥rštf
(
buf
, "$N ha »tuºed from: %s.", 
ch
->
shÜt_desü
);

728 
	`wizÃt
(
buf
, 
ch
->
desc
->
Üigš®
, 0, 
WIZ_SWITCHES
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

730 ià(
ch
->
desc
->
ch¬aù”
->
aù_æags
.
	`has
(
ACT_MORPH
)) {

731 ià(
ch
->
desc
->
ch¬aù”
->
š_room
 =ğ
nuÎ±r
)

732 
loÿtiÚ
 = 
Game
::
	`wÜld
().
	`g‘_room
(
	`LoÿtiÚ
(
	`Vnum
(
ROOM_VNUM_MORGUE
)));

734 
loÿtiÚ
 = 
ch
->
desc
->
ch¬aù”
->
š_room
;

736 
	`ch¬_äom_room
(
ch
->
desc
->
Üigš®
);

737 
	`ch¬_to_room
(
ch
->
desc
->
Üigš®
, 
loÿtiÚ
);

740 
ch
->
desc
->
ch¬aù”
 = ch->desc->
Üigš®
;

741 
ch
->
desc
->
Üigš®
 = 
nuÎ±r
;

742 
ch
->
desc
->
ch¬aù”
->desc = ch->desc;

744 ià(!
ch
->
desc
->
ch¬aù”
->
	`is_Åc
())

745 ià(!
ch
->
desc
->
ch¬aù”
->
pcd©a
->
bufãr
.
	`em±y
())

746 
	`¡c
("You havmes§ges: Ty³ '»¶ay'\n", 
ch
);

748 
ch
->
desc
 = 
nuÎ±r
;

750 ià(
ch
->
aù_æags
.
	`has
(
ACT_MORPH
è&& ch->
š_room
 !ğ
nuÎ±r
)

751 
	`exŒaù_ch¬
(
ch
, 
Œue
);

754 
	}
}

757 
boŞ
 
	$£tup_obj
(
Ch¬aù”
 *
ch
, 
Objeù
 *
obj
, 
SŒšg
 
¬gum’t
)

759 
SŒšg
 
¬g1
;

760 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

762 
obj
->
™em_ty³
) {

763 
ITEM_TOKEN
:

815 
ITEM_LIGHT
:

816 
ITEM_JUKEBOX
:

817 
ITEM_SCROLL
:

818 
ITEM_WAND
:

819 
ITEM_STAFF
:

820 
ITEM_WEAPON
:

821 
ITEM_ARMOR
:

822 
ITEM_POTION
:

823 
ITEM_PILL
:

824 
ITEM_MONEY
:

826 
ITEM_ANVIL
:

827 
ITEM_FURNITURE
:

828 
ITEM_TRASH
:

829 
ITEM_CONTAINER
:

830 
ITEM_DRINK_CON
:

831 
ITEM_KEY
:

832 
ITEM_FOOD
:

833 
ITEM_BOAT
:

834 
ITEM_CORPSE_NPC
:

835 
ITEM_CORPSE_PC
:

836 
ITEM_FOUNTAIN
:

837 
ITEM_MAP
:

838 
ITEM_PBTUBE
:

839 
ITEM_PBGUN
:

840 
ITEM_MATERIAL
:

841 
ITEM_CLOTHING
:

842 
ITEM_PORTAL
:

843 
ITEM_TREASURE
:

844 
ITEM_WARP_STONE
:

845 
ITEM_GEM
:

846 
ITEM_JEWELRY
:

847 
ITEM_WEDDINGRING
:

848 
ITEM_WARP_CRYSTAL
:

853  
Œue
;

854 
	}
}

856 
	$do_ü—‹
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

858 
buf
[100];

859 
ObjeùPrÙÙy³
 *
pObjIndex
;

860 
Objeù
 *
obj
;

862 ià(!
	`IS_IMMORTAL
(
ch
))

865 ià(
¬gum’t
.
	`em±y
()) {

866 
	`¡c
("SyÁax:\n", 
ch
);

867 
	`¡c
(" c»©obj <ty³>\n", 
ch
);

871 
SŒšg
 
¬g1
, 
¬g2
;

872 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

873 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

875 ià(
¬g1
 == "object") {

876 ià(
¬g2
.
	`em±y
()) {

877 
	`¡c
("V®id i‹my³ ¬e:\n", 
ch
);

879 cÚ¡‡uto& 
’Œy
 : 
™em_bË
)

880 
	`±c
(
ch
, "%s\n", 
’Œy
.
Çme
);

885 ià(
¬g2
 == "npc_corpse"

886 || 
¬g2
 == "pc_corpse") {

888 
	`¡c
("You cªnÙ c»©Úoàtho£.\n", 
ch
);

892 cÚ¡‡uto& 
’Œy
 : 
™em_bË
) {

893 ià(
¬g2
 =ğ
’Œy
.
Çme
) {

894 
pObjIndex
 = 
Game
::
	`wÜld
().
	`g‘_obj_´ÙÙy³
(
’Œy
.
ty³
 + 100);

896 ià(
pObjIndex
 =ğ
nuÎ±r
) {

897 
FÜm©
::
	`¥rštf
(
buf
, "[ü—‹] CªnÙ fšd i‹m vnum %d.\n", 
’Œy
.
ty³
 + 100);

898 
Loggšg
::
	`bug
(
buf
, 0);

899 
	`¡c
("Th© i‹m s“m tØbmissšg.\n", 
ch
);

903 
obj
 = 
	`ü—‹_objeù
(
pObjIndex
, 0);

905 ià(! 
obj
) {

906 
Loggšg
::
	`bug
("Memoryƒrror creating object in do_create.", 0);

910 ià(!
	`£tup_obj
(
ch
, 
obj
, 
¬gum’t
)) {

911 
	`exŒaù_obj
(
obj
);

915 
	`obj_to_ch¬
(
obj
, 
ch
);

916 
	`aù
("$Àha ü—‹d $p!", 
ch
, 
obj
, 
nuÎ±r
, 
TO_ROOM
);

917 
	`¡c
("Sucûss.\n", 
ch
);

923 
	`do_ü—‹
(
ch
, "obj");

927 
	`do_ü—‹
(
ch
, "");

929 
	}
}

937 
	$do_skÍošt
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

939 
Ch¬aù”
 *
viùim
;

940 
Ãw_pošts
;

941 
bufãr
[
MAX_INPUT_LENGTH
];

943 
SŒšg
 
ch¬_Çme
, 
give_Ü_ke
;

944 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
give_Ü_ke
);

945 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
ch¬_Çme
);

947 ià((
give_Ü_ke
.
	`em±y
()è|| (
ch¬_Çme
.em±y()è|| (
¬gum’t
.empty())) {

948 
	`¡c
("SyÁax: skÍošˆ<aw¬d|deduù> <¶ay”> <amouÁ>\n", 
ch
);

952 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
ch¬_Çme
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

953 
	`¡c
("PÏy”‚Ù found.\n", 
ch
);

957 ià(
	`IS_IMMORTAL
(
viùim
)) {

958 
	`¡c
("ImmÜl ÿÀhªdËheœ owÀskÈpošts.\n", 
ch
);

962 ià(!
¬gum’t
.
	`is_numb”
()) {

963 
	`¡c
("V®umu¡ bnum”ic.\n", 
ch
);

967 
Ãw_pošts
 = 
	`©oi
(
¬gum’t
);

970 ià((
Ãw_pošts
 < 1) || (new_points > 50)) {

971 
	`¡c
("PËa£ giv¨v®uäom 1Ø50.\n", 
ch
);

976 ià(!
	`¡rcmp
(
give_Ü_ke
, "award")) {

977 
viùim
->
pcd©a
->
skÍošts
 +ğ
Ãw_pošts
;

978 
FÜm©
::
	`¥rštf
(
bufãr
, "%d skill…oints‡wardedo %s. Total: %d.\n",

979 
Ãw_pošts
, 
viùim
->
Çme
, viùim->
pcd©a
->
skÍošts
);

980 
	`¡c
(
bufãr
, 
ch
);

981 
	`¡c
(
bufãr
, 
viùim
);

984 ià(!
	`¡rcmp
(
give_Ü_ke
, "deduct")) {

985 ià(
viùim
->
pcd©a
->
skÍošts
 < 
Ãw_pošts
) {

986 
	`¡c
("Th©…Ïy” dÛ nÙ havth© mªy skÈpošts.\n", 
ch
);

990 
viùim
->
pcd©a
->
skÍošts
 -ğ
Ãw_pošts
;

991 
FÜm©
::
	`¥rštf
(
bufãr
, "%d skill…oints deducted from %s. %d„emaining.\n",

992 
Ãw_pošts
, 
viùim
->
Çme
, viùim->
pcd©a
->
skÍošts
);

993 
	`¡c
(
bufãr
, 
ch
);

994 
	`¡c
(
bufãr
, 
viùim
);

999 
	`¡c
("SyÁax: skÍošˆ<aw¬d|deduù> <¶ay”> <amouÁ>\n", 
ch
);

1000 
	}
}

	@src/wiz_secure.cc

16 
	~<uni¡d.h
>

17 
	~<veùÜ
>

19 
	~"aù.hh
"

20 
	~"¬gum’t.hh
"

21 
	~"chªÃls.hh
"

22 
	~"Ch¬aù”.hh
"

23 
	~"deş¬e.hh
"

24 
	~"DesütÜ.hh
"

25 
	~"fšd.hh
"

26 
	~"FÏgs.hh
"

27 
	~"FÜm©.hh
"

28 
	~"Game.hh
"

29 
	~"š‹½.hh
"

30 
	~"m”c.hh
"

31 
	~"Objeù.hh
"

32 
	~"PÏy”.hh
"

33 
	~"sql.hh
"

34 
	~"SŒšg.hh
"

35 
	~"bËs.hh
"

36 
	~"Ta.hh
"

37 
	~"WÜld.hh
"

38 
	~"Room.hh
"

40 
show_li¡_to_ch¬
 
¬gs
((
Objeù
 *
li¡
, 
Ch¬aù”
 *
ch
, 
boŞ
 
fShÜt
, boŞ 
fShowNÙhšg
, boŞ 
šsidecÚt
));

42 
	$do_fod
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

44 
buf
[
MSL
];

45 
Ch¬aù”
 *
viùim
 = 
nuÎ±r
;

46 *
msg
 = "Inhe distance you hearhehundering„oar of‡ Finger Of Death!";

47 
Room
 *
ch_room
, *
viùim_room
;

48 
Objeù
 *
Ú
;

50 ià(
¬gum’t
.
	`em±y
()) {

51 
	`glob®_aù
(
ch
, 
msg
, 
Œue
, 
YELLOW
, 
COMM_QUIET
 | 
COMM_NOSOCIAL
);

52 
	`¡c
("You¸FOD„ev”b”©e throughhwÜld‡ ¨w¬nšgØ®l.\n", 
ch
);

56 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬gum’t
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

57 
	`¡c
("They‡»‚Ù…Ïyšg.\n", 
ch
);

61 ià(!
	`OUTRANKS
(
ch
, 
viùim
)) {

62 
	`¡c
("They wouldn'ˆlikth©.\n", 
ch
);

66 ià(
viùim
->
desc
 !ğ
nuÎ±r
 && viùim->desc->
Üigš®
 !=‚ullptr) {

67 
	`¡c
("You¸viùim i mÜphed o¸sw™ched -‚ØÿÀdo!\n", 
ch
);

71 ià(
viùim
->
fightšg
)

72 
	`¡İ_fightšg
(
viùim
, 
Œue
);

75 
ch_room
 = 
ch
->
š_room
;

76 
viùim_room
 = 
viùim
->
š_room
;

78 ià(
ch_room
 && 
viùim_room
 && ch_room != victim_room) {

79 
Ú
 = 
ch
->on;

80 
	`ch¬_äom_room
(
ch
);

81 
	`ch¬_to_room
(
ch
, 
viùim_room
);

85 
	`glob®_aù
(
ch
, 
msg
, 
Œue
, 
YELLOW
, 
COMM_QUIET
 | 
COMM_NOSOCIAL
);

86 
	`aù
("You sŒik$N dowÀw™h you¸{YFšg” oà{RD—th{x!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

87 
	`aù
("$À¡rike $N dowÀw™h‡ {YFšg” oà{RD—th{x!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

88 
	`aù
("$À¡rike you dowÀw™h‡ {YFšg” oà{RD—th{x!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

89 
FÜm©
::
	`¥rštf
(
buf
, "$Àha ¡ruck dowÀ%s!", 
viùim
->
Çme
);

90 
	`glob®_aù
(
ch
, 
buf
, 
Œue
, 
YELLOW
, 
COMM_QUIET
 | 
COMM_NOSOCIAL
);

91 
	`aù
("You f®ÈtØthground, dazed.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

92 
viùim
->
pos™iÚ
 = 
POS_RESTING
;

93 
	`WAIT_STATE
(
viùim
, 15 * 
PULSE_PER_SECOND
);

96 ià(
ch_room
 && 
viùim_room
 && ch_room != victim_room) {

97 
	`ch¬_äom_room
(
ch
);

98 
	`ch¬_to_room
(
ch
, 
ch_room
);

99 
ch
->
Ú
 = on;

101 
	}
}

103 
	$do_fÜû
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

105 
buf
[
MSL
];

107 
SŒšg
 
¬g
;

108 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

110 ià(
¬g
.
	`em±y
(è|| 
¬gum’t
.empty()) {

111 
	`¡c
("Syntax:\n"

112 " fÜû <¶ay”> <commªd>\n", 
ch
);

114 ià(
	`IS_IMP
(
ch
))

115 
	`¡c
(" force‡ll <command>\n"

117 " fÜû god  <commªd>\n", 
ch
);

122 
SŒšg
 
¬g2
;

123 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g2
);

125 ià(
¬g2
 == "delete") {

126 
	`¡c
("DØNOT dØth©.\n", 
ch
);

130 
SŒšg
 
¬g3
;

131 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g3
);

132 
FÜm©
::
	`¥rštf
(
buf
, "$ÀfÜû youØ%s.", 
¬gum’t
);

134 ià(
	`IS_IMP
(
ch
)) {

135 
boŞ
 
found
 = 
çl£
;

137 ià(
¬g
 == "all") {

138 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

139 ià(
viùim
->
	`is_Åc
())

142 ià(
viùim
 !ğ
ch
) {

143 
found
 = 
Œue
;

144 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

145 
	`š‹½»t
(
viùim
, 
¬gum’t
);

149 ià(!
found
)

150 
	`¡c
("You found‚ØÚtØfÜû.\n", 
ch
);

154 ià(
¬g
 == "players") {

155 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

156 ià(
viùim
->
	`is_Åc
())

159 ià(
viùim
 !ğ
ch
 && !
	`IS_IMMORTAL
(victim)) {

160 
found
 = 
Œue
;

161 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

162 
	`š‹½»t
(
viùim
, 
¬gum’t
);

166 ià(!
found
)

167 
	`¡c
("You found‚ØÚtØfÜû.\n", 
ch
);

171 ià(
¬g
 == "gods") {

172 autØ
viùim
 : 
Game
::
	`wÜld
().
ch¬_li¡
) {

173 ià(
viùim
->
	`is_Åc
())

176 ià(
viùim
 !ğ
ch
 && 
	`IS_IMMORTAL
(viùimè&& !
	`IS_IMP
(victim)) {

177 
found
 = 
Œue
;

178 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

179 
	`š‹½»t
(
viùim
, 
¬gum’t
);

183 ià(!
found
)

184 
	`¡c
("You found‚ØÚtØfÜû.\n", 
ch
);

190 
Ch¬aù”
 *
viùim
;

192 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

193 
	`¡c
("They‡»‚Ù…Ïyšg.\n", 
ch
);

197 ià(
viùim
 =ğ
ch
) {

198 
	`¡c
("Try fÜcšg your£làtØdØyou¸homewÜk buddy!\n", 
ch
);

202 ià(!
	`is_room_owÃr
(
ch
, 
viùim
->
š_room
)

203 && 
ch
->
š_room
 !ğ
viùim
->in_room

204 && 
viùim
->
š_room
->
	`is_´iv©e
()

205 && !
	`IS_IMP
(
ch
)) {

206 
	`¡c
("Th© ch¬aù” i š‡…riv©room.\n", 
ch
);

210 ià(
	`IS_IMMORTAL
(
viùim
)

211 && !
	`IS_IMP
(
ch
)

212 && !
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_LINK_DEAD
)

213 && !
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_SNOOP_PROOF
)) {

214 
	`¡c
("NÙ‡ˆyou¸Ëv–!\n", 
ch
);

218 
	`aù
(
buf
, 
ch
, 
nuÎ±r
, 
viùim
, 
TO_VICT
);

219 
	`š‹½»t
(
viùim
, 
¬gum’t
);

220 
	`¡c
("You sucûed.\n", 
ch
);

221 
	}
}

223 
	$do_ä“ze
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

225 
buf
[
MSL
];

226 
Ch¬aù”
 *
viùim
;

228 ià(
¬gum’t
.
	`em±y
()) {

229 
	`¡c
("Syntax:\n"

230 " f»ez<¶ay”>\n", 
ch
);

234 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬gum’t
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

235 
	`¡c
("They‡»‚Ù…Ïyšg.\n", 
ch
);

239 ià(
viùim
 =ğ
ch
) {

240 
	`¡c
("Nowh©' ju¡ sly.\n", 
ch
);

244 ià((
	`IS_IMMORTAL
(
viùim
è&& !
	`IS_IMP
(
ch
)) || IS_IMP(victim)) {

245 
	`¡c
("You shršk iÀcom·risÚØthpow” oàyou¸viùim.\n", 
ch
);

249 ià(
viùim
->
aù_æags
.
	`has
(
PLR_FREEZE
)) {

250 
viùim
->
aù_æags
 -ğ
PLR_FREEZE
;

251 
	`¡c
("H—ˆ’v–İ you¸blood.\n", 
viùim
);

252 
	`¡c
("FREEZE„emoved.\n", 
ch
);

253 
FÜm©
::
	`¥rštf
(
buf
, "$N ha unäoz’: %s.", 
viùim
->
Çme
);

254 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_PENALTIES
, 
WIZ_SECURE
, 0);

257 
viùim
->
aù_æags
 +ğ
PLR_FREEZE
;

258 
	`¡c
("A cry¡® blush“ˆoàiû immobize you¸body!\n", 
viùim
);

259 
	`¡c
("FREEZE s‘.\n", 
ch
);

260 
FÜm©
::
	`¥rštf
(
buf
, "$N…ut % šhd“°ä“ze.", 
viùim
->
Çme
);

261 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_PENALTIES
, 
WIZ_SECURE
, 0);

264 
	`§ve_ch¬_obj
(
viùim
);

265 
	}
}

267 
	$do_äy
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

269 
¡r§ve
[
MIL
];

270 
Ch¬aù”
 *
viùim
;

272 
SŒšg
 
¬g
;

273 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

276 ià(
¬g
.
	`em±y
()) {

277 
	`¡c
("Syntax:\n"

278 " fry <¶ay”>\n", 
ch
);

282 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

283 
	`¡c
("They‡»‚Ù…Ïyšg.\n", 
ch
);

287 ià(
	`IS_IMMORTAL
(
viùim
)) {

288 
	`¡c
("Th©' nÙ‡ good id—.\n", 
ch
);

292 
	`aù
("You {Pde¡roy{x $N‡nd„emov$M from Legacy!", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_CHAR
);

293 
	`aù
("A hugbŞˆoà{WlighŠšg{x sŒike $N, u‰”ly {Pde¡royšg{x $M.", 
ch
, 
nuÎ±r
, 
viùim
, 
TO_NOTVICT
);

294 
	`aù
("You†ook up, ju¡ iÀtimtØ£th{Pæamšg{x {WlighŠšg{x bŞˆ¡rikyou¸h—d. C-ya!", 
ch
, 
nuÎ±r
, 
viùim
,

295 
TO_VICT
);

296 
FÜm©
::
	`¥rštf
(
¡r§ve
, "%s%s", 
PLAYER_DIR
, 
viùim
->
Çme
.
	`low”ÿ£
().
	`ÿp™®ize
());

297 
	`do_echo
(
ch
, "You hearhe„umble ofhunder inhe distance.");

298 
	`upd©e_pc_šdex
(
viùim
, 
Œue
);

299 
	`do_fuckoff
(
viùim
, "");

300 
	`uÆšk
(
¡r§ve
);

301 
	}
}

303 
	$do_lock”
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

305 
Ch¬aù”
 *
viùim
;

306 
Objeù
 *
obj
;

308 ià(
¬gum’t
.
	`em±y
()) {

309 
	`¡c
("Syntax:\n"

310 "†ock” <viùim> <g‘|put> <objeù>\n", 
ch
);

314 
SŒšg
 
¬g1
;

315 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

317 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g1
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

318 
	`¡c
("They mu¡ bÚlštØexamštheœ†ock”.\n", 
ch
);

322 ià(
¬gum’t
.
	`em±y
()) {

323 
	`±c
(
ch
, "%s' lock” cÚšs:\n", 
viùim
->
Çme
);

324 
	`show_li¡_to_ch¬
(
viùim
->
pcd©a
->
lock”
, 
ch
, 
Œue
,rue,rue);

328 
SŒšg
 
¬g2
;

329 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

331 ià(
¬g2
.
	`em±y
(è|| 
¬gum’t
.empty()) {

332 
	`¡c
("Syntax:\n"

333 "†ock” <¶ay”> <g‘|put> <objeù>\n", 
ch
);

337 ià(
¬g2
.
	`is_´efix_of
("get")) {

338 ià((
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬gum’t
, 
viùim
->
pcd©a
->
lock”
)è=ğ
nuÎ±r
) {

339 
	`¡c
("You dØnÙ s“h© iÀtheœ†ock”.\n", 
ch
);

343 
	`obj_äom_lock”
(
obj
);

344 
	`obj_to_ch¬
(
obj
, 
ch
);

345 
	`±c
(
ch
, "You g‘ % äom %s' lock”.\n", 
obj
->
shÜt_desü
, 
viùim
->
Çme
);

349 ià(
¬g2
.
	`is_´efix_of
("put")) {

350 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬gum’t
)è=ğ
nuÎ±r
) {

351 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

355 
	`obj_äom_ch¬
(
obj
);

356 
	`obj_to_lock”
(
obj
, 
viùim
);

357 
	`±c
(
ch
, "You…uˆ% š %s' lock”.\n", 
obj
->
shÜt_desü
, 
viùim
->
Çme
);

361 
	`¡c
("Syntax:\n"

362 "†ock” <¶ay”> <g‘|put> <objeù>\n", 
ch
);

363 
	}
}

365 
	$do_¡rÚgbox
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

367 
Ch¬aù”
 *
viùim
;

368 
Objeù
 *
obj
;

370 ià(
¬gum’t
.
	`em±y
()) {

371 
	`¡c
("Syntax:\n"

372 " sŒÚgbox <viùim> <g‘|put> <objeù>\n", 
ch
);

376 
SŒšg
 
¬g1
, 
¬g2
;

377 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

379 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g1
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

380 
	`¡c
("They mu¡ bÚlštØexamštheœ sŒÚgbox.\n", 
ch
);

384 ià(!
	`IS_HEROIC
(
viùim
)) {

385 
	`¡c
("OÆy h”Û ªd„emÜt hav¡rÚgboxes.\n", 
ch
);

389 ià(
¬gum’t
.
	`em±y
()) {

390 
	`±c
(
ch
, "%s' ¡rÚgbox cÚšs:\n", 
viùim
->
Çme
);

391 
	`show_li¡_to_ch¬
(
viùim
->
pcd©a
->
¡rÚgbox
, 
ch
, 
Œue
,rue,rue);

395 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

397 ià(
¬g2
.
	`em±y
(è|| 
¬gum’t
.empty()) {

398 
	`¡c
("Syntax:\n"

399 " sŒÚgbox <¶ay”> <g‘|put> <objeù>\n", 
ch
);

403 ià(
¬g2
.
	`is_´efix_of
("get")) {

404 ià((
obj
 = 
	`g‘_obj_li¡
(
ch
, 
¬gum’t
, 
viùim
->
pcd©a
->
¡rÚgbox
)è=ğ
nuÎ±r
) {

405 
	`¡c
("You dØnÙ s“h© iÀtheœ sŒÚgbox.\n", 
ch
);

409 
	`obj_äom_¡rÚgbox
(
obj
);

410 
	`obj_to_ch¬
(
obj
, 
ch
);

411 
	`±c
(
ch
, "You g‘ % äom %s' ¡rÚgbox.\n", 
obj
->
shÜt_desü
, 
viùim
->
Çme
);

415 ià(
¬g2
.
	`is_´efix_of
("put")) {

416 ià((
obj
 = 
	`g‘_obj_ÿ¼y
(
ch
, 
¬gum’t
)è=ğ
nuÎ±r
) {

417 
	`¡c
("You dØnÙ havth© i‹m.\n", 
ch
);

421 
	`obj_äom_ch¬
(
obj
);

422 
	`obj_to_¡rÚgbox
(
obj
, 
viùim
);

423 
	`±c
(
ch
, "You…uˆ% š %s' ¡rÚgbox.\n", 
obj
->
shÜt_desü
, 
viùim
->
Çme
);

427 
	`¡c
("Syntax:\n"

428 " sŒÚgbox <¶ay”> <g‘|put> <objeù>\n", 
ch
);

429 
	}
}

431 
	$do_log
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

433 
Ch¬aù”
 *
viùim
;

435 ià(
¬gum’t
.
	`em±y
()) {

436 
	`¡c
("Syntax:\n"

438 "†og‡Î\n", 
ch
);

442 
SŒšg
 
¬g
;

443 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

445 ià(
¬g
 == "all") {

446 
Game
::
log_®l
 = !Game::log_all;

447 
	`±c
(
ch
, "Log ALL %s.\n", 
Game
::
log_®l
 ? "on" : "off");

451 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

452 
	`¡c
("They‡»‚Ù…Ïyšg.\n", 
ch
);

456 ià(
viùim
->
aù_æags
.
	`has
(
PLR_LOG
))

457 
viùim
->
aù_æags
 -ğ
PLR_LOG
;

459 
viùim
->
aù_æags
 +ğ
PLR_LOG
;

461 
	`±c
(
ch
, "LOG %s.\n", 
viùim
->
aù_æags
.
	`has
(
PLR_LOG
) ? "set" : "removed");

462 
	}
}

464 
	$do_Ãwlock
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

466 
Game
::
Ãwlock
 = !Game::newlock;

468 ià(
Game
::
Ãwlock
) {

469 
	`wizÃt
("$N†ock ouˆÃw ch¬aù”s.", 
ch
, 
nuÎ±r
, 0, 0, 0);

470 
	`¡c
("New ch¬aù” havb“Àlocked out.\n", 
ch
);

473 
	`wizÃt
("$N‡Îow Ãw ch¬aù” back in.", 
ch
, 
nuÎ±r
, 0, 0, 0);

474 
	`¡c
("Newlock„emoved.\n", 
ch
);

476 
	}
}

478 
	$do_Ãw·sswd
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

480 
buf
[
MSL
];

481 
Ch¬aù”
 *
viùim
;

483 ià(
¬gum’t
.
	`em±y
()) {

484 
	`¡c
("Syntax:\n"

485 "‚ew·sswd <¶ay”> <·sswd>\n", 
ch
);

489 
SŒšg
 
¬g
;

490 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

492 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

493 
	`¡c
("They‡»‚Ù…Ïyšg.\n", 
ch
);

497 ià(
	`IS_IMMORTAL
(
viùim
è&& !
	`IS_IMP
(
ch
)) {

498 
	`¡c
("You‡»‚Ù highƒnough†ev–Øchªgtheœ…asswÜd.\n", 
ch
);

502 ià(
	`¡¾’
(
¬gum’t
) < 5) {

503 
	`¡c
("PasswÜd mu¡ b©†—¡ fivch¬aù” lÚg.\n", 
ch
);

507 
viùim
->
pcd©a
->
pwd
 = 
¬gum’t
;

508 
	`±c
(
ch
, "%s' Ãw…asswÜd is: %s\n", 
viùim
->
Çme
, 
¬gum’t
);

509 
	`§ve_ch¬_obj
(
viùim
);

510 
FÜm©
::
	`¥rštf
(
buf
, "$N ha chªged %s' ·sswÜd.", 
viùim
->
Çme
);

511 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_LOAD
, 
WIZ_SECURE
, 0);

512 
	}
}

514 
	$do_·rdÚ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

516 
Ch¬aù”
 *
viùim
;

518 
SŒšg
 
¬g1
, 
¬g2
;

519 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

520 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

522 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.empty()) {

523 
	`¡c
("Syntax:\n"

524 "…¬dÚ <¶ay”> <kËr|th›f>\n", 
ch
);

528 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g1
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

529 
	`¡c
("They‡»‚Ù…Ïyšg.\n", 
ch
);

533 ià(
¬g2
 == "killer") {

534 ià(
viùim
->
aù_æags
.
	`has
(
PLR_KILLER
)) {

535 
viùim
->
aù_æags
 -ğ
PLR_KILLER
;

536 
	`¡c
("Theœ kË¸æag ha b“À»moved.\n", 
ch
);

537 
	`¡c
("You‡»‚ØlÚg”‡ KILLER.\n", 
viùim
);

538 
viùim
->
aù_æags
 -ğ
PLR_NOPK
;

541 
	`¡c
("They dØnÙ hav¨kË¸æag s‘.\n", 
ch
);

543 
ch
->
pcd©a
->
æag_kËr
 = 0;

545 ià(
¬g2
 == "thief") {

546 ià(
viùim
->
aù_æags
.
	`has
(
PLR_THIEF
)) {

547 
viùim
->
aù_æags
 -ğ
PLR_THIEF
;

548 
	`¡c
("Theœh›àæag ha b“À»moved.\n", 
ch
);

549 
	`¡c
("You‡»‚ØlÚg”‡ THIEF.\n", 
viùim
);

550 
viùim
->
aù_æags
 -ğ
PLR_NOPK
;

553 
	`¡c
("They dØnÙ hav¨th›àæag s‘.\n", 
ch
);

555 
ch
->
pcd©a
->
æag_th›f
 = 0;

558 
	`¡c
("Syntax:\n"

559 "…¬dÚ <¶ay”> <kËr|th›f>\n", 
ch
);

560 
	}
}

562 
	$do_´Ùeù
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

564 
Ch¬aù”
 *
viùim
;

566 ià(
¬gum’t
.
	`em±y
()) {

567 
	`¡c
("Syntax:\n"

568 "…rÙeù <¶ay”>\n", 
ch
);

572 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬gum’t
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

573 
	`¡c
("You cª'ˆfšdhem.\n", 
ch
);

577 ià(
viùim
->
pcd©a
->
¶r_æags
.
	`has
(
PLR_SNOOP_PROOF
)) {

578 
	`±c
(
ch
, "% i nØlÚg”…rÙeùed from snoİšg.\n", 
viùim
->
Çme
);

579 
viùim
->
pcd©a
->
¶r_æags
 -ğ
PLR_SNOOP_PROOF
;

582 
	`±c
(
ch
, "You…rÙeù % äom snoİšg.\n", 
viùim
->
Çme
);

583 
viùim
->
pcd©a
->
¶r_æags
 +ğ
PLR_SNOOP_PROOF
;

585 
	}
}

587 
	$do_»voke
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

589 
buf1
[
MSL
], 
buf2
[MSL];

590 
Ch¬aù”
 *
viùim
;

592 
SŒšg
 
¬g1
, 
¬g2
;

593 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g1
);

594 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

596 ià(
¬g1
.
	`em±y
(è|| 
¬g2
.empty()) {

597 
FÏgs
 
´š‹d
;

600 
	`¡c
("Cu¼’ˆREVOKE o±iÚs:\n\n", 
ch
);

602 cÚ¡‡uto& 
’Œy
 : 
»voke_bË
) {

604 ià(
´š‹d
.
	`has
(
’Œy
.
b™
))

607 
	`±c
(
ch
, " %s\n", 
’Œy
.
Çme
);

608 
´š‹d
 +ğ
’Œy
.
b™
;

611 
	`¡c
("\nSyntax:\n"

612 "„evok<ch¬aù”> <İtiÚ>\n", 
ch
);

616 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g1
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

617 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

621 ià(
	`IS_IMMORTAL
(
viùim
è&& !
	`IS_IMP
(
ch
)) {

622 
	`¡c
("You havçed.\n", 
ch
);

626 cÚ¡‡uto& 
’Œy
 : 
»voke_bË
) {

627 ià(!
¬g2
.
	`is_´efix_of
(
’Œy
.
Çme
))

630 ià(
viùim
->
»voke_æags
.
	`has
(
’Œy
.
b™
)) {

631 
viùim
->
»voke_æags
 -ğ
’Œy
.
b™
;

632 
FÜm©
::
	`¥rštf
(
buf1
, "restore");

635 
viùim
->
»voke_æags
 +ğ
’Œy
.
b™
;

636 
FÜm©
::
	`¥rštf
(
buf1
, "revoke");

639 
	`±c
(
viùim
, "ThGod hav%sd you¸%s.\n", 
buf1
, 
’Œy
.
mes§ge
);

640 
	`±c
(
ch
, "You % theœ %s.\n", 
buf1
, 
’Œy
.
mes§ge
);

641 
FÜm©
::
	`¥rštf
(
buf2
, "$N ha %sd %s' %s", 
buf1
, 
viùim
->
Çme
, 
’Œy
.
mes§ge
);

642 
	`wizÃt
(
buf2
, 
ch
, 
nuÎ±r
, 
WIZ_PENALTIES
, 
WIZ_SECURE
, 0);

646 
	`¡c
("RevokWHAT?\n", 
ch
);

647 
	}
}

650 
	$£t_
(
Ch¬aù”
 *
ch
, Ch¬aù” *
viùim
, 
FÏgs
 
_æags
)

652 
Ta
 *
td
;

655 ià(
viùim
 =ğ
nuÎ±r
) {

656 
couÁ
 = 0;

658 autØ
wch
 : 
Game
::
	`wÜld
().
ch¬_li¡
)

659 ià(
wch
->

)

660 
couÁ
 +ğ
	`£t_
(
ch
, 
wch
, 
TAIL_NONE
);

662  
couÁ
;

666 ià(!
_æags
.
	`has
(
TAIL_NONE
)) {

668 
td
 = 
viùim
->

;d;d =d->
Ãxt
)

669 ià(
td
->
ed_by
 =ğ
ch
)

673 ià(!
td
) {

674 
td
 = 
Ãw
 
Ta
;

675 
td
->
ed_by
 = 
ch
;

676 
td
->
”_Çme
 = 
ch
->
Çme
;

677 
td
->
æags
.
	`ş—r
();

678 
td
->
Ãxt
 = 
viùim
->

;

679 
viùim
->

 = 
td
;

682 
td
->
æags
 +ğ
_æags
;

683 
	`±c
(
ch
, "You‡re‚owailing %s:%s\n",

684 
	`PERS
(
viùim
, 
ch
, 
VIS_PLR
),

685 (
td
->
æags
.
	`has
(
TAIL_ACT
)) ? " ACT" : "");

690 ià(
viùim
->

 =ğ
nuÎ±r
)

694 
td
 = 
viùim
->

;d;d =d->
Ãxt
)

695 ià(
td
->
ed_by
 =ğ
ch
)

699 ià(
td
) {

700 ià(
td
 !ğ
viùim
->

) {

702 
td
->
ed_by
 = 
viùim
->

->tailed_by;

703 
td
->
”_Çme
 = 
viùim
->

->tailer_name;

704 
td
->
æags
 = 
viùim
->

->flags;

705 
td
 = 
viùim
->

;

709 
viùim
->

 = 
td
->
Ãxt
;

710 
d–‘e
 
td
;

712 
	`±c
(
ch
, "You hav¡İ³dašg %s.\n", 
	`PERS
(
viùim
, ch, 
VIS_PLR
));

718 
	}
}

720 
	$do_
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

722 
buf
[
MSL
];

723 
Ch¬aù”
 *
viùim
 = 
nuÎ±r
;

725 ià(
ch
->
	`is_Åc
()) {

726 
	`¡c
("PËa£„‘uºØyou¸body befÜšg.\n", 
ch
);

730 ià(
¬gum’t
.
	`em±y
()) {

731 
	`¡c
("Syntax:\n"

734 "a stİ\n", 
ch
);

738 
SŒšg
 
¬g
;

739 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

741 ià(
¬g
 == "stop") {

742 ià(!
	`£t_
(
ch
, 
nuÎ±r
, 
TAIL_NONE
))

743 
	`¡c
("You w”’'ˆšg‡nyÚe.\n", 
ch
);

745 
ch
->
pcd©a
->
šg
 = 
çl£
;

749 ià((
viùim
 = 
	`g‘_ch¬_wÜld
(
ch
, 
¬g
, 
VIS_CHAR
)è=ğ
nuÎ±r
) {

750 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

754 ià(
viùim
 =ğ
ch
) {

755 
	`¡c
("PËa£ dÚ'ˆŒyØ your£là-- you'Î g‘ dizzy!\n", 
ch
);

759 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g
);

761 ià(
¬g
.
	`em±y
()) {

762 
	`do_
(
ch
, "");

766 ià(
¬g
.
	`is_´efix_of
("stop")) {

767 ià(!
	`£t_
(
ch
, 
viùim
, 
TAIL_NONE
))

768 
	`¡c
("You w”nÙašghem.\n", 
ch
);

770 ià(
¬g
.
	`is_´efix_of
("actions")) {

771 
	`£t_
(
ch
, 
viùim
, 
TAIL_ACT
);

772 
ch
->
pcd©a
->
šg
 = 
Œue
;

773 
FÜm©
::
	`¥rštf
(
buf
, "$N ha beguÀšg %s.", 
	`PERS
(
viùim
, 
ch
, 
VIS_PLR
));

774 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_SNOOPS
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

777 
	`do_
(
ch
, "");

778 
	}
}

780 
	$do_¢oİ
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

782 
buf
[
MSL
];

783 
DesütÜ
 *
d
;

784 
Ch¬aù”
 *
viùim
;

786 
SŒšg
 
¬g
;

787 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

789 ià(
¬gum’t
.
	`em±y
()) {

790 
	`¡c
("Syntax:\n"

791 " snoİ <¶ay”>\n", 
ch
);

795 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

797 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

798 
	`¡c
("They‡»n'ˆh”e.\n", 
ch
);

802 ià(
viùim
->
desc
 =ğ
nuÎ±r
) {

803 
	`¡c
("NØdesütÜØ¢oİ.\n", 
ch
);

807 ià(
viùim
 =ğ
ch
) {

808 
	`¡c
("AÎ snoİ š…rog»s havb“ÀÿnûÎed.\n", 
ch
);

809 
	`wizÃt
("$N ha ÿnûÎed‡Î snoİs.", 
ch
, 
nuÎ±r
, 
WIZ_SNOOPS
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

811 
d
 = 
desütÜ_li¡
; d !ğ
nuÎ±r
; d = d->
Ãxt
)

812 ià(
d
->
¢oİ_by
 =ğ
ch
->
desc
)

813 
d
->
¢oİ_by
 = 
nuÎ±r
;

818 ià(
viùim
->
desc
->
¢oİ_by
 !ğ
nuÎ±r
) {

819 
	`¡c
("Th© ch¬aù” i ®»ady bešg snoİed.\n", 
ch
);

823 ià(!
	`is_room_owÃr
(
ch
, 
viùim
->
š_room
)

824 && 
ch
->
š_room
 !ğ
viùim
->in_room

825 && 
viùim
->
š_room
->
	`is_´iv©e
()

826 && !
	`IS_IMP
(
ch
)) {

827 
	`¡c
("Th© ch¬aù” i š‡…riv©room.\n", 
ch
);

831 ià((
	`IS_IMMORTAL
(
viùim
è|| viùim->
pcd©a
->
¶r_æags
.
	`has
(
PLR_SNOOP_PROOF
)è&& !
	`IS_IMP
(
ch
)) {

832 
	`¡c
("They wouldn'ˆlikth©!\n", 
ch
);

836 ià((! 
	`¡rÿ£cmp
(
viùim
->
Çme
, "teotwawki")) ||

837 (! 
	`¡rÿ£cmp
(
viùim
->
Çme
, "outsider"))) {

838 
	`¡c
("They would‚Ù†ikth©.\n", 
ch
);

842 ià(
ch
->
desc
 !ğ
nuÎ±r
) {

843 
d
 = 
ch
->
desc
->
¢oİ_by
; d !ğ
nuÎ±r
; d = d->snoop_by) {

844 ià(
d
->
ch¬aù”
 =ğ
viùim
 || d->
Üigš®
 == victim) {

845 
	`¡c
("SÜry, wdÚ'ˆ®low snoİ†oİs.\n", 
ch
);

851 
viùim
->
desc
->
¢oİ_by
 = 
ch
->desc;

852 
FÜm©
::
	`¥rštf
(
buf
, "$N ha beguÀ¨¢oİ oÀ%s.", 
viùim
->
Çme
);

853 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_SNOOPS
, 
WIZ_SECURE
, 
	`GET_RANK
(ch));

854 
	`¡c
("You‚ow v›whwÜldhroughh¶ay” eyes.\n", 
ch
);

855 
	}
}

857 
	$do_bª
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

859 ià(
¬gum’t
.
	`em±y
()) {

860 
SŒšg
 
s™e
;

861 
SŒšg
 
ouut
;

862 
boŞ
 
found
 = 
çl£
;

864 ià(
	`db_qu”y
("do_bª", "SELECT s™e,‚ame, fÏgs,„—sÚ FROM bªs"è!ğ
SQL_OK
)

867 
ouut
 += "Banned Sites {T|{xBanned by {T|{xType {T|{xReason\n";

868 
ouut
 += "{T------------------------------+---------------+-------+-----------------------------{x\n";

870 
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

871 
found
 = 
Œue
;

872 
FÏgs
 
	`æags
(
	`db_g‘_cŞumn_št
(2));

874 
FÜm©
::
	`¥rštf
(
s™e
, "%s%s%s",

875 
æags
.
	`has
(
BAN_PREFIX
) ? "*" : "",

876 
	`db_g‘_cŞumn_¡r
(0),

877 
æags
.
	`has
(
BAN_SUFFIX
) ? "*" : "");

878 
ouut
 +ğ
FÜm©
::
	`fÜm©
("%-30s{T|{x%-15s{T|{x%s{T|{x%s\n",

879 
s™e
,

880 
	`db_g‘_cŞumn_¡r
(1),

881 
æags
.
	`has
(
BAN_PERMIT
) ? "PERMIT " :

882 
æags
.
	`has
(
BAN_ALL
) ? " ALL " :

883 
æags
.
	`has
(
BAN_NEWBIES
) ? "NEWBIES" : " ",

884 
	`db_g‘_cŞumn_¡r
(3));

887 ià(
found
)

888 
	`·ge_to_ch¬
(
ouut
, 
ch
);

890 
	`¡c
("Th”¬nØbªÃd ho¡s.\n", 
ch
);

899 
SŒšg
 
¬g1
, 
¬g2
;

900 
¬gum’t
 = 
	`Úe_¬gum’t
(
	`db_esc
×rgum’t), 
¬g1
);

901 
¬gum’t
 = 
	`Úe_¬gum’t
×rgum’t, 
¬g2
);

903 ià(
	`¡¾’
(
¬g1
) < 5 || strlen(arg1) > 30) {

904 
	`¡c
("Ths™mu¡ bb‘w“À5‡nd 30 ch¬aù” lÚg.\n", 
ch
);

908 ià(
¬g2
.
	`em±y
()) {

909 
	`¡c
("You mu¡ s³cify‡ bªy³.\n", 
ch
);

913 ià(
¬gum’t
.
	`em±y
()) {

914 
	`¡c
("You mu¡…rovid¨»asÚ.\n", 
ch
);

918 ià(
	`¡¾’
(
¬gum’t
) > 45) {

919 
	`¡c
("PËa£†im™h»asÚØ45 ch¬aù” Ü†ess.\n", 
ch
);

923 
FÏgs
 
æags
;

925 ià(
¬g2
 =ğ"®l"è
æags
 +ğ
BAN_ALL
;

926 ià(
¬g2
 =ğ"Ãwb›s"è
æags
 +ğ
BAN_NEWBIES
;

928 
	`¡c
("Ty³ mu¡ bALL o¸NEWBIES.\n", 
ch
);

932 
SŒšg
 
s™e
 = 
¬g1
;

934 ià(
s™e
.
	`äÚt
() == '*') {

935 
s™e
.
	`”a£
(0, 1);

936 
æags
 +ğ
BAN_PREFIX
;

939 ià(
s™e
.
	`back
() == '*') {

940 
s™e
.
	`”a£
(s™e.
	`size
()-1);

941 
æags
 +ğ
BAN_SUFFIX
;

944 ià(
	`db_couÁf
("do_ban", "SELECT COUNT(*) FROM bans WHERE site LIKE '%s' AND (flags-((flags>>4)<<4))=%d",

945 
s™e
, 
æags
.
	`to_ulÚg
()) > 0)

946 
	`±c
(
ch
, "% i ®»ady bªÃd.\n", 
¬g1
);

948 
	`db_commªdf
("do_ban", "INSERT INTO bans VALUES('%s','%s',%d,'%s')",

949 
	`db_esc
(
s™e
), db_esc(
ch
->
Çme
), 
æags
.
	`to_ulÚg
(), db_esc(
¬gum’t
));

950 
	`±c
(
ch
, "% ha b“ÀbªÃd.\n", 
¬g1
);

952 
	}
}

954 
	$do_®low
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

956 
FÏgs
 
wdæags
;

958 
SŒšg
 
¬g
;

959 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

961 ià(
¬g
.
	`em±y
()) {

962 
	`¡c
("Removwhich s™äomhbª†i¡?\n", 
ch
);

966 ià(
	`¡¾’
(
¬g
) < 5) {

967 
	`¡c
("BªÃd s™e ¬nØshÜ‹¸thª fivch¬aù”s.\n", 
ch
);

971 
SŒšg
 
s™e
 = 
¬g
;

973 ià(
s™e
.
	`äÚt
() == '*') {

974 
s™e
.
	`”a£
(0, 1);

975 
wdæags
 +ğ
BAN_PREFIX
;

978 ià(
s™e
.
	`back
() == '*') {

979 
s™e
.
	`”a£
(s™e.
	`size
()-1);

980 
wdæags
 +ğ
BAN_SUFFIX
;

983 
	`db_commªdf
("do_allow", "DELETE FROM bans WHERE site LIKE '%s' AND (flags-((flags>>2)<<2))=%d",

984 
	`db_esc
(
s™e
), 
wdæags
.
	`to_ulÚg
());

986 ià(
	`db_rows_afãùed
() > 0)

987 
	`±c
(
ch
, "Bª oÀ% liáed.\n", 
¬g
);

989 
	`¡c
("Th© s™i nÙ bªÃd.\n", 
ch
);

990 
	}
}

992 
	$do_³rm™
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

994 
FÏgs
 
wdæags
;

995 
boŞ
 
found
 = 
çl£
;

997 
SŒšg
 
¬g
;

998 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1000 ià(
¬g
.
	`em±y
()) {

1001 
	`¡c
("Syntax:\n"

1003 "…”m™…Ïy” <Çme>\n", 
ch
);

1007 ià(
¬g
 == "player") {

1008 
Ch¬aù”
 *
¶r
;

1010 ià((
¶r
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

1011 
	`¡c
("They‡»‚Ù…Ïyšg o¸lßded.\n", 
ch
);

1015 ià(
	`GET_RANK
(
ch
è< GET_RANK(
¶r
)) {

1016 
	`¡c
("They‡» beyÚd you¸pow”s.\n", 
ch
);

1020 ià(
¶r
->
aù_æags
.
	`has
(
PLR_PERMIT
)) {

1021 
	`¡c
("They‡»‚ØlÚg”…”m™‹dØby·s bªÃd s™es.\n", 
ch
);

1022 
¶r
->
aù_æags
 -ğ
PLR_PERMIT
;

1025 
	`¡c
("They‡»‚ow…”m™‹dØby·s bªÃd s™es.\n", 
ch
);

1026 
¶r
->
aù_æags
 +ğ
PLR_PERMIT
;

1032 ià(
	`¡¾’
(
¬g
) < 5) {

1033 
	`¡c
("BªÃd s™e ¬nØshÜ‹¸thª fivch¬aù”s.\n", 
ch
);

1037 
SŒšg
 
s™e
 = 
¬g
;

1039 ià(
s™e
.
	`äÚt
() == '*') {

1040 
s™e
.
	`”a£
(0, 1);

1041 
wdæags
 +ğ
BAN_PREFIX
;

1044 ià(
s™e
.
	`back
() == '*') {

1045 
s™e
.
	`”a£
(s™e.
	`size
()-1);

1046 
wdæags
 +ğ
BAN_SUFFIX
;

1049 ià(
	`db_qu”yf
("do_permit",

1051 
	`db_esc
(
s™e
), 
wdæags
.
	`to_ulÚg
()è!ğ
SQL_OK
)

1054 !
found
 && 
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

1055 
FÏgs
 
	`rowæags
(
	`db_g‘_cŞumn_št
(0));

1057 ià(
rowæags
.
	`has
(
BAN_PERMIT
)) {

1058 
	`±c
(
ch
, "P”m™ fÏg„emoved oÀ%s.\n", 
¬g
);

1059 
rowæags
 -ğ
BAN_PERMIT
;

1062 
	`±c
(
ch
, "P”m™ fÏg s‘ oÀ%s.\n", 
¬g
);

1063 
rowæags
 +ğ
BAN_PERMIT
;

1066 
	`db_commªdf
("do_permit", "UPDATE bans SET flags=%d WHERE site LIKE '%s' AND flags=%d",

1067 
rowæags
.
	`to_ulÚg
(), 
	`db_esc
(
	`db_g‘_cŞumn_¡r
(1)), 
	`db_g‘_cŞumn_št
(0));

1068 
found
 = 
Œue
;

1071 ià(!
found
)

1072 
	`¡c
("Th© s™i nÙ bªÃd.\n", 
ch
);

1073 
	}
}

1075 
	$do_d’y
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1077 
Ch¬aù”
 *
viùim
;

1079 ià(
¬gum’t
.
	`em±y
()) {

1080 
SŒšg
 
ouut
;

1081 
boŞ
 
found
 = 
çl£
;

1083 ià(
	`db_qu”y
("do_d’y", "SELECT‚ame, d’›r,„—sÚ FROM d’›s"è!ğ
SQL_OK
)

1086 
ouut
 += "Denied Players {T|{xDenied by {T|{xReason\n";

1087 
ouut
 += "{T---------------+---------------+-------------------------------------------{x\n";

1089 
	`db_Ãxt_row
(è=ğ
SQL_OK
) {

1090 
found
 = 
Œue
;

1091 
ouut
 +ğ
FÜm©
::
	`fÜm©
("%-15s{T|{x%-15s{T|{x%s\n",

1092 
	`db_g‘_cŞumn_¡r
(0),

1093 
	`db_g‘_cŞumn_¡r
(1),

1094 
	`db_g‘_cŞumn_¡r
(2)

1098 ià(
found
)

1099 
	`·ge_to_ch¬
(
ouut
, 
ch
);

1101 
	`¡c
("Th”¬nØd’›d…Ïy”s.\n", 
ch
);

1106 
SŒšg
 
¬g1
;

1107 
¬gum’t
 = 
	`Úe_¬gum’t
(
	`db_esc
×rgum’t), 
¬g1
);

1109 ià(
¬gum’t
.
	`em±y
()) {

1110 
	`¡c
("You mu¡…rovid¨»asÚ.\n", 
ch
);

1114 ià((
viùim
 = 
	`g‘_¶ay”_wÜld
(
ch
, 
¬g1
, 
VIS_PLR
)è=ğ
nuÎ±r
) {

1115 
	`¡c
("They‡»‚Ù…Ïyšg.\n", 
ch
);

1119 ià(
viùim
 =ğ
ch
) {

1120 
	`¡c
("But, but, wÃed you!!\n", 
ch
);

1124 ià(
	`IS_IMMORTAL
(
viùim
è&& !
	`IS_IMP
(
ch
)) {

1125 
	`¡c
("You havçed.\n", 
ch
);

1129 ià(
	`db_couÁf
("do_d’y", "SELECT COUNT(*èFROM d’› WHERE‚amLIKE '%s'", 
viùim
->
Çme
) > 0)

1130 
	`±c
(
ch
, "% i ®»ady d’›d.\n", 
viùim
->
Çme
);

1132 
buf
[
MSL
];

1133 
	`db_commªdf
("do_deny", "INSERT INTO denies VALUES('%s','%s','%s')",

1134 
	`db_esc
(
viùim
->
Çme
), db_esc(
ch
->Çme), db_esc(
¬gum’t
));

1135 
	`¡c
("You havb“Àd’›d‡cûss!\n", 
viùim
);

1136 
FÜm©
::
	`¥rštf
(
buf
, "$N ha d’›d‡cûs tØ%s", 
viùim
->
Çme
);

1137 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_PENALTIES
, 
WIZ_SECURE
, 0);

1138 
	`±c
(
ch
, "% ha b“Àd’›d‡cûss.\n", 
¬g1
);

1139 
	`§ve_ch¬_obj
(
viùim
);

1140 
	`¡İ_fightšg
(
viùim
, 
Œue
);

1141 
	`do_qu™
(
viùim
, "now");

1143 
	}
}

1145 
	$do_und’y
(
Ch¬aù”
 *
ch
, 
SŒšg
 
¬gum’t
)

1147 
SŒšg
 
¬g
;

1148 
	`Úe_¬gum’t
(
¬gum’t
, 
¬g
);

1150 ià(
¬g
.
	`em±y
()) {

1151 
	`¡c
("Und’y which…Ïy”?\n", 
ch
);

1155 
	`db_commªdf
("do_und’y", "DELETE FROM d’› WHERE‚amLIKE '%s'", 
	`db_esc
(
¬g
));

1157 ià(
	`db_rows_afãùed
() > 0) {

1158 
buf
[
MSL
];

1159 
	`±c
(
ch
, "% ha b“Àg¿Áed‡cûs tØLegacy.\n", 
¬g
);

1160 
FÜm©
::
	`¥rštf
(
buf
, "$N ha und’›d %s", 
¬g
);

1161 
	`wizÃt
(
buf
, 
ch
, 
nuÎ±r
, 
WIZ_PENALTIES
, 
WIZ_SECURE
, 0);

1164 
	`¡c
("Th©…Ïy” i nÙ d’›d.\n", 
ch
);

1165 
	}
}

	@src/worldmap/Coordinate.cc

1 
	~"wÜldm­/CoÜdš©e.hh
"

2 
	~"SŒšg.hh
"

3 
	~"FÜm©.hh
"

5 cÚ¡ 
SŒšg
 
	gwÜldm­
::
CoÜdš©e
::

6 
	$to_¡ršg
(
boŞ
 
shÜt_loc
) const {

7 ià(!
	`is_v®id
())

10 
SŒšg
 
buf
;

12 ià(
shÜt_loc
)

13 
buf
 +ğ
FÜm©
::
	`fÜm©
("%d,%d", 
x
, 
y
);

15 
buf
 +ğ
FÜm©
::
	`fÜm©
("%4d,%4d", 
x
, 
y
);

17  
buf
;

18 
	}
}

	@src/worldmap/Region.cc

1 
	~"wÜldm­/RegiÚ.hh
"

2 
	~"fe.hh
"

3 
	~"A»a.hh
"

4 
	~"Room.hh
"

5 
	~"Loggšg.hh
"

6 
	~"WÜld.hh
"

7 
	~"RoomPrÙÙy³.hh
"

9 
Çme¥aû
 
	gwÜldm­
 {

11 
	gRegiÚ
::
RegiÚ
(
A»a
& 
¬—
, 
FILE
 *
å
) :‡rea(area) {

12 
SŒšg
 
rooms_fe
 = 
ä—d_¡ršg
(
å
);

14 
	gimage
.
lßd
(
SŒšg
(
WORLDMAP_DIR
è+ 
rooms_fe
);

16 
	g_®ign_x
 = 
ä—d_numb”
(
å
);

17 
	g_®ign_y
 = 
ä—d_numb”
(
å
);

20 
	gË‰”
;

21 ià((
	gË‰”
 = 
ä—d_Ë‰”
(
å
)) == 'S')

24 ià(
	gË‰”
 == '*') {

25 
ä—d_to_eŞ
(
å
);

29 ià(
	gË‰”
 == 'M') {

30 
num
;

32 (
	gnum
 = 
ä—d_numb”
(
å
)) != 0)

33 
®lowed_mob_»£ts
.
š£¹
(
num
);

38 ià(
	gË‰”
 == 'R') {

39 
num
;

41 (
	gnum
 = 
ä—d_numb”
(
å
)) != 0)

42 
®lowed_room_»£ts
.
š£¹
(
num
);

47 ià(
	gË‰”
 == 'C') {

48 
vnum
 = 
ä—d_numb”
(
å
);

49 
	g»d
 = 
ä—d_numb”
(
å
);

50 
	gg»’
 = 
ä—d_numb”
(
å
);

51 
	gblue
 = 
ä—d_numb”
(
å
);

53 
M­CŞÜ
 
cŞÜ
(
»d
, 
g»’
, 
blue
);

55 ià(
	g_´ÙÙy³_cŞÜ_m­
.
fšd
(
vnum
è!ğ
_´ÙÙy³_cŞÜ_m­
.
ûnd
()) {

56 
Loggšg
::
bugf
("lßd_»giÚ(): vnum %d„edefšed w™h‡nÙh”…ix– cŞÜ", 
vnum
);

60 
	g_´ÙÙy³_cŞÜ_m­
.
em¶aû
(
vnum
, 
M­CŞÜ
(
»d
, 
g»’
, 
blue
));

67 cÚ¡‡uto& 
	g·œ1
 : 
_´ÙÙy³_cŞÜ_m­
) {

68 cÚ¡‡uto& 
·œ2
 : 
_´ÙÙy³_cŞÜ_m­
) {

69 ià(
·œ1
.
fœ¡
 =ğ
·œ2
.first)

71 ià(
	g·œ1
.
	g£cÚd
 =ğ
·œ2
.
£cÚd
) {

72 
Loggšg
::
bugf
("load_region(): multiple definition of color with vnums %d‡nd %d",

73 
·œ1
.
fœ¡
, 
·œ2
.first);

80 cÚ¡ 
	gM­CŞÜ
& 
	gRegiÚ
::
vnum_to_cŞÜ
(cÚ¡ 
Vnum
& 
vnum
) const {

81 cÚ¡‡utØ
·œ
 = 
_´ÙÙy³_cŞÜ_m­
.
fšd
(
vnum
);

83 ià(
	g·œ
 =ğ
_´ÙÙy³_cŞÜ_m­
.
ûnd
())

84  
M­CŞÜ
::
uncŞÜed
;

86  
	g·œ
->
	g£cÚd
;

89 cÚ¡ 
Vnum
 
	gRegiÚ
::
cŞÜ_to_vnum
(cÚ¡ 
M­CŞÜ
& 
cŞÜ
) const {

90 ià(
cŞÜ
 =ğ
M­CŞÜ
::
uncŞÜed
)

93 cÚ¡‡uto& 
	g·œ
 : 
_´ÙÙy³_cŞÜ_m­
)

94 ià(
·œ
.
£cÚd
 =ğ
cŞÜ
)

95  
·œ
.
fœ¡
;

100 cÚ¡ 
M­CŞÜ
 
	gRegiÚ
::
g‘_cŞÜ
(
x
, 
y
) const {

101 ià(
	gimage
.
v®ue
(
ut
::
Image
::
®pha
, 
x
, 
y
) > 0) {

102  
M­CŞÜ
(

103 
image
.
v®ue
(
ut
::
Image
::
»d
, 
x
, 
y
),

104 
image
.
v®ue
(
ut
::
Image
::
g»’
, 
x
, 
y
),

105 
image
.
v®ue
(
ut
::
Image
::
blue
, 
x
, 
y
)

109  
	gM­CŞÜ
::
uncŞÜed
;

112 cÚ¡ 
Vnum
 
	gRegiÚ
::
g‘_vnum
(
x
, 
y
) const {

113  
cŞÜ_to_vnum
(
g‘_cŞÜ
(
x
, 
y
));

116 
	gRegiÚ
::

117 
ü—‹_rooms
() const {

118 
y
 = 0; 
	gy
 < 
	gimage
.
height
(); y++) {

119 
	gx
 = 0; x < 
	gimage
.
width
(); x++) {

120 
M­CŞÜ
 
	gcŞÜ
 = 
g‘_cŞÜ
(
x
, 
y
);

121 
Vnum
 
	gvnum
 = 
cŞÜ_to_vnum
(
cŞÜ
);

123 ià(
	gvnum
 == 0) {

127 ià(
	gvnum
 == -1) {

128 
Loggšg
::
bugf
("load_region():‡rea %s has undefined„egion…ixel‡t %d,%d with color %d,%d,%d",

129 
¬—
.
fe_Çme
, 
x
, 
y
, 
cŞÜ
.
»d
, cŞÜ.
g»’
, cŞÜ.
blue
);

133 cÚ¡‡uto& 
	g·œ
 = 
¬—
.
room_´ÙÙy³s
.
fšd
(
vnum
);

135 ià(
	g·œ
 =ğ
¬—
.
room_´ÙÙy³s
.
ûnd
()) {

136 
Loggšg
::
bugf
("load_region():‡rea %s has‚o…rototype defined for vnum %d‡t„egion…ixel %d,%d",

137 
¬—
.
fe_Çme
, 
vnum
, 
x
, 
y
);

141 autØ
	g´ÙÙy³
 = 
·œ
->
£cÚd
;

143 ià(
	g´ÙÙy³
->
	gcouÁ
 > (1 << 14)-1) {

144 
	gLoggšg
::
bugf
("load_region():…rototype vnum %d has morehan %d„ooms",

145 
´ÙÙy³
->
vnum
, (1 << 14)-1);

146 
ex™
(1);

149 
Room
 *
	groom
 = 
Ãw
 Room(*
´ÙÙy³
);

150 
	groom
->
	gloÿtiÚ
.
	gcoÜd
 = 
CoÜdš©e
(
®ign_x
()+
x
, 
®ign_y
()+
y
);

151 
	g¬—
.
	grooms
.
em¶aû
(
room
->
loÿtiÚ
.
room_id
,„oom);

152 
	g¬—
.
	gwÜld
.
	gm­Œ“
.
put
(
room
,„oom->
loÿtiÚ
.
coÜd
);

	@src/worldmap/Worldmap.cc

1 
	~<m­
>

3 
	~"cÚ¡ªts.hh
"

4 
	~"wÜldm­/M­CŞÜ.hh
"

5 
	~"wÜldm­/WÜldm­.hh
"

6 
	~"ut/Image.hh
"

7 
	~"deş¬e.hh
"

8 
	~"SeùÜ.hh
"

9 
	~"Loggšg.hh
"

10 
	~"wÜldm­/CoÜdš©e.hh
"

12 
Çme¥aû
 
	gwÜldm­
 {

14 cÚ¡ 
M­CŞÜ
 
	gM­CŞÜ
::
uncŞÜed
(0,0,0);

16 cÚ¡ 
	g¡d
::
m­
<
M­CŞÜ
, 
	gSeùÜ
> 
	gcŞÜ_£ùÜ_m­
 = {

18 { 
M­CŞÜ
Ğ0, 0, 0), 
SeùÜ
::
nÚe
 },

19 { 
M­CŞÜ
{255, 255, 255}, 
SeùÜ
::
c™y
 },

20 { 
M­CŞÜ
Ğ0, 255, 0), 
SeùÜ
::
f›ld
 },

21 { 
M­CŞÜ
Ğ0, 199, 12), 
SeùÜ
::
fÜe¡_¥¬£
 },

22 { 
M­CŞÜ
Ğ0, 148, 5), 
SeùÜ
::
fÜe¡_medium
 },

23 { 
M­CŞÜ
Ğ0, 102, 0), 
SeùÜ
::
fÜe¡_d’£
 },

24 { 
M­CŞÜ
(203, 98, 12), 
SeùÜ
::
rßd
 },

25 { 
M­CŞÜ
(255, 0, 153), 
SeùÜ
::
¬—_’Œªû
 },

26 { 
M­CŞÜ
Ğ0, 0, 255), 
SeùÜ
::
w©”_noswim
 },

27 { 
M­CŞÜ
Ğ51, 153, 255), 
SeùÜ
::
w©”_swim
 },

30 
	gWÜldm­
::

31 
WÜldm­
() {

32 
ut
::
Image
 
image
;

34 ià(!
	gimage
.
lßd
(
WORLDMAP_IMAGE_FILE
)) {

35 
	gLoggšg
::
bugf
("WÜldm­(): faedØlßd imagf%s.", 
WORLDMAP_IMAGE_FILE
);

39 
	g_height
 = 
image
.
height
();

40 
	g_width
 = 
image
.
width
();

42 ià(
height
(è> 0 && 
width
() > 0) {

43 
	grows
 = 
Ãw
 *[
height
()];

45 
	gy
 = 0; y < 
height
(); y++) {

46 
	grows
[
y
] = 
Ãw
 [
width
()];

48 
	gx
 = 0; x < 
width
(); x++) {

49 
SeùÜ
 
£ùÜ
(SeùÜ::
nÚe
);

51 ià(
	gimage
.
v®ue
(
ut
::
Image
::
ChªÃl
::
®pha
, 
x
, 
y
) > 0) {

52 
M­CŞÜ
 
cŞÜ
(

53 
image
.
v®ue
(
ut
::
Image
::
ChªÃl
::
»d
, 
x
, 
y
),

54 
image
.
v®ue
(
ut
::
Image
::
ChªÃl
::
g»’
, 
x
, 
y
),

55 
image
.
v®ue
(
ut
::
Image
::
ChªÃl
::
blue
, 
x
, 
y
)

58 
	g£ùÜ
 = 
cŞÜ_to_£ùÜ
(
cŞÜ
);

60 ià(
	g£ùÜ
 =ğ
SeùÜ
::
unknown
) {

61 
Loggšg
::
bugf
("color_to_sector: unknown sector for color %d,%d,%d.",

62 
cŞÜ
.
»d
, cŞÜ.
g»’
, cŞÜ.
blue
);

63 
	g£ùÜ
 = 
SeùÜ
::
nÚe
;

67 
	grows
[
y
][
x
] = 
¡©ic_ÿ¡
<>(
£ùÜ
);

73 
	gWÜldm­
::

74 ~
WÜldm­
() {

75 ià(
rows
 !ğ
nuÎ±r
) {

76 
h
 = 0; 
	gh
 < 
height
(); h++)

77 
	gd–‘e
[] 
	grows
[
h
];

79 
	gd–‘e
[] 
	grows
;

83 cÚ¡ 
SeùÜ
 
	gWÜldm­
::

84 
g‘_£ùÜ
(cÚ¡ 
CoÜdš©e
& 
coÜd
) const {

85 
»t
 = 0;

87 ià(
	gcoÜd
.
is_v®id
()

88 && ()
	gcoÜd
.
	gx
 < 
width
()

89 && ()
	gcoÜd
.
	gy
 < 
height
())

90 
	g»t
 = 
rows
[
coÜd
.
y
][coÜd.
x
];

92  
	g¡©ic_ÿ¡
<
	gSeùÜ
>(
	g»t
);

95 cÚ¡ 
SeùÜ
 
	gWÜldm­
::

96 
cŞÜ_to_£ùÜ
(cÚ¡ 
M­CŞÜ
& 
cŞÜ
) const {

97 cÚ¡‡uto& 
·œ
 = 
cŞÜ_£ùÜ_m­
.
fšd
(
cŞÜ
);

99 ià(
	g·œ
 =ğ
cŞÜ_£ùÜ_m­
.
ûnd
()) {

100 
Loggšg
::
bugf
("color_to_sector: unknown sector for color %d,%d,%d.",

101 
cŞÜ
.
»d
, cŞÜ.
g»’
, cŞÜ.
blue
);

102  
	gSeùÜ
::
unknown
;

105  
	g·œ
->
	g£cÚd
;

	@
1
.
0
221
4522
src/.cproject
src/Area.cc
src/Auction.cc
src/Battle.cc
src/Character.cc
src/Descriptor.cc
src/Disabled.cc
src/Exit.cc
src/ExitPrototype.cc
src/Flags.cc
src/Game.cc
src/GameTime.cc
src/JSON/cJSON.cc
src/Logging.cc
src/MobProg.cc
src/MobilePrototype.cc
src/Note.cc
src/Object.cc
src/ObjectPrototype.cc
src/ObjectValue.cc
src/Player.cc
src/QuestArea.cc
src/Reset.cc
src/Room.cc
src/RoomID.cc
src/RoomPrototype.cc
src/Shop.cc
src/String.cc
src/War.cc
src/Weather.cc
src/World.cc
src/act.cc
src/act_comm.cc
src/act_info.cc
src/act_move.cc
src/act_obj.cc
src/affect/affect.cc
src/affect/affect_cache_array.cc
src/affect/affect_char.cc
src/affect/affect_list.cc
src/affect/affect_obj.cc
src/affect/affect_room.cc
src/affect/affect_table.cc
src/alias.cc
src/area_handler.cc
src/argument.cc
src/attribute.cc
src/bank.cc
src/channels.cc
src/clan-edit.cc
src/comm.cc
src/config.cc
src/conn/BreakConnectState.cc
src/conn/ClosedState.cc
src/conn/ConfirmNewNameState.cc
src/conn/ConfirmNewPassState.cc
src/conn/CopyoverRecoverState.cc
src/conn/GetAlignmentState.cc
src/conn/GetDeityState.cc
src/conn/GetGuildState.cc
src/conn/GetMudExpState.cc
src/conn/GetNameState.cc
src/conn/GetNewPassState.cc
src/conn/GetOldPassState.cc
src/conn/GetRaceState.cc
src/conn/GetSexState.cc
src/conn/GetWeaponState.cc
src/conn/PlayingState.cc
src/conn/ReadIMOTDState.cc
src/conn/ReadMOTDState.cc
src/conn/ReadNewMOTDState.cc
src/conn/RollStatsState.cc
src/conn/State.cc
src/const.cc
src/debug.cc
src/departed.cc
src/deps/cJSON/cJSON.c
src/deps/cJSON/cJSON.h
src/dispel.cc
src/duel.cc
src/edit.cc
src/effects.cc
src/event/Dispatcher.cc
src/fight.cc
src/file.cc
src/find.cc
src/flag.cc
src/gem/gem.cc
src/handler.cc
src/help.cc
src/hunt.cc
src/ignore.cc
src/include/Actable.hh
src/include/Area.hh
src/include/Auction.hh
src/include/Battle.hh
src/include/Character.hh
src/include/Clan.hh
src/include/DepartedPlayer.hh
src/include/Descriptor.hh
src/include/Disabled.hh
src/include/Duel.hh
src/include/EQSocket.hh
src/include/Edit.hh
src/include/Exit.hh
src/include/ExitPrototype.hh
src/include/ExtraDescr.hh
src/include/Flags.hh
src/include/Format.hh
src/include/Game.hh
src/include/GameTime.hh
src/include/Garbage.hh
src/include/GarbageCollectingList.hh
src/include/Guild.hh
src/include/JSON/cJSON.hh
src/include/Location.hh
src/include/Logging.hh
src/include/MobProg.hh
src/include/MobProgActList.hh
src/include/MobilePrototype.hh
src/include/Note.hh
src/include/Object.hh
src/include/ObjectPrototype.hh
src/include/ObjectValue.hh
src/include/Player.hh
src/include/Pooled.hh
src/include/QuestArea.hh
src/include/Reset.hh
src/include/Room.hh
src/include/RoomID.hh
src/include/RoomPrototype.hh
src/include/Sector.hh
src/include/Shop.hh
src/include/Social.hh
src/include/StoredPlayer.hh
src/include/String.hh
src/include/Tail.hh
src/include/Vnum.hh
src/include/War.hh
src/include/Weather.hh
src/include/World.hh
src/include/act.hh
src/include/affect/Affect.hh
src/include/affect/Type.hh
src/include/affect/affect_int.hh
src/include/affect/affect_list.hh
src/include/argument.hh
src/include/channels.hh
src/include/comm.hh
src/include/conn/State.hh
src/include/constants.hh
src/include/declare.hh
src/include/dispel.hh
src/include/event/Dispatcher.hh
src/include/event/Handler.hh
src/include/event/event.hh
src/include/file.hh
src/include/find.hh
src/include/gem/gem.hh
src/include/interp.hh
src/include/lookup.hh
src/include/lootv2.hh
src/include/macros.hh
src/include/magic.hh
src/include/memory.hh
src/include/merc.hh
src/include/music.hh
src/include/random.hh
src/include/skill/Type.hh
src/include/skill/skill.hh
src/include/sql.hh
src/include/tables.hh
src/include/telnet.hh
src/include/typename.hh
src/include/util/Image.hh
src/include/vt100.hh
src/include/worldmap/Coordinate.hh
src/include/worldmap/MapColor.hh
src/include/worldmap/Quadtree.hh
src/include/worldmap/Region.hh
src/include/worldmap/Worldmap.hh
src/interp.cc
src/load_config.cc
src/lookup.cc
src/loot_tables.cc
src/lootv2.cc
src/magic.cc
src/marry.cc
src/memory.cc
src/mob_commands.cc
src/mob_prog.cc
src/mobiles.cc
src/music.cc
src/objstate.cc
src/paint.cc
src/quest.cc
src/random.cc
src/remort.cc
src/rmagic.cc
src/save.cc
src/scan.cc
src/set-stat.cc
src/skill/skill_table.cc
src/skills.cc
src/social.cc
src/special.cc
src/sqlite.cc
src/storage.cc
src/tables.cc
src/typename.cc
src/update.cc
src/util/Image.cc
src/wiz_admin.cc
src/wiz_build.cc
src/wiz_coder.cc
src/wiz_gen.cc
src/wiz_quest.cc
src/wiz_secure.cc
src/worldmap/Coordinate.cc
src/worldmap/Region.cc
src/worldmap/Worldmap.cc
